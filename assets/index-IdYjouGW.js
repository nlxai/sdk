var tv={},Ck=Object.defineProperty,ky=n=>{throw TypeError(n)},Sk=(n,e,t)=>e in n?Ck(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ct=(n,e,t)=>Sk(n,typeof e!="symbol"?e+"":e,t),Cf=(n,e,t)=>e.has(n)||ky("Cannot "+t),Br=(n,e,t)=>(Cf(n,e,"read from private field"),e.get(n)),Nl=(n,e,t)=>e.has(n)?ky("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),id=(n,e,t,r)=>(Cf(n,e,"write to private field"),e.set(n,t),t),nv=(n,e,t)=>(Cf(n,e,"access private method"),t);function Cy(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var rv={exports:{}},jl={},iv={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function Tk(){if(av)return ut;av=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),C=Symbol.iterator;function x(L){return L===null||typeof L!="object"?null:(L=C&&L[C]||L["@@iterator"],typeof L=="function"?L:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,A={};function W(L,se,Ge){this.props=L,this.context=se,this.refs=A,this.updater=Ge||T}W.prototype.isReactComponent={},W.prototype.setState=function(L,se){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,se,"setState")},W.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function U(){}U.prototype=W.prototype;function G(L,se,Ge){this.props=L,this.context=se,this.refs=A,this.updater=Ge||T}var F=G.prototype=new U;F.constructor=G,V(F,W.prototype),F.isPureReactComponent=!0;var O=Array.isArray,D=Object.prototype.hasOwnProperty,Q={current:null},ie={key:!0,ref:!0,__self:!0,__source:!0};function Y(L,se,Ge){var xe,Ue={},Ne=null,Ze=null;if(se!=null)for(xe in se.ref!==void 0&&(Ze=se.ref),se.key!==void 0&&(Ne=""+se.key),se)D.call(se,xe)&&!ie.hasOwnProperty(xe)&&(Ue[xe]=se[xe]);var ze=arguments.length-2;if(ze===1)Ue.children=Ge;else if(1<ze){for(var dt=Array(ze),Ot=0;Ot<ze;Ot++)dt[Ot]=arguments[Ot+2];Ue.children=dt}if(L&&L.defaultProps)for(xe in ze=L.defaultProps,ze)Ue[xe]===void 0&&(Ue[xe]=ze[xe]);return{$$typeof:n,type:L,key:Ne,ref:Ze,props:Ue,_owner:Q.current}}function z(L,se){return{$$typeof:n,type:L.type,key:se,ref:L.ref,props:L.props,_owner:L._owner}}function K(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function X(L){var se={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(Ge){return se[Ge]})}var he=/\/+/g;function je(L,se){return typeof L=="object"&&L!==null&&L.key!=null?X(""+L.key):se.toString(36)}function ce(L,se,Ge,xe,Ue){var Ne=typeof L;(Ne==="undefined"||Ne==="boolean")&&(L=null);var Ze=!1;if(L===null)Ze=!0;else switch(Ne){case"string":case"number":Ze=!0;break;case"object":switch(L.$$typeof){case n:case e:Ze=!0}}if(Ze)return Ze=L,Ue=Ue(Ze),L=xe===""?"."+je(Ze,0):xe,O(Ue)?(Ge="",L!=null&&(Ge=L.replace(he,"$&/")+"/"),ce(Ue,se,Ge,"",function(Ot){return Ot})):Ue!=null&&(K(Ue)&&(Ue=z(Ue,Ge+(!Ue.key||Ze&&Ze.key===Ue.key?"":(""+Ue.key).replace(he,"$&/")+"/")+L)),se.push(Ue)),1;if(Ze=0,xe=xe===""?".":xe+":",O(L))for(var ze=0;ze<L.length;ze++){Ne=L[ze];var dt=xe+je(Ne,ze);Ze+=ce(Ne,se,Ge,dt,Ue)}else if(dt=x(L),typeof dt=="function")for(L=dt.call(L),ze=0;!(Ne=L.next()).done;)Ne=Ne.value,dt=xe+je(Ne,ze++),Ze+=ce(Ne,se,Ge,dt,Ue);else if(Ne==="object")throw se=String(L),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.");return Ze}function de(L,se,Ge){if(L==null)return L;var xe=[],Ue=0;return ce(L,xe,"","",function(Ne){return se.call(Ge,Ne,Ue++)}),xe}function Me(L){if(L._status===-1){var se=L._result;se=se(),se.then(function(Ge){(L._status===0||L._status===-1)&&(L._status=1,L._result=Ge)},function(Ge){(L._status===0||L._status===-1)&&(L._status=2,L._result=Ge)}),L._status===-1&&(L._status=0,L._result=se)}if(L._status===1)return L._result.default;throw L._result}var Re={current:null},le={transition:null},Ee={ReactCurrentDispatcher:Re,ReactCurrentBatchConfig:le,ReactCurrentOwner:Q};function ke(){throw Error("act(...) is not supported in production builds of React.")}return ut.Children={map:de,forEach:function(L,se,Ge){de(L,function(){se.apply(this,arguments)},Ge)},count:function(L){var se=0;return de(L,function(){se++}),se},toArray:function(L){return de(L,function(se){return se})||[]},only:function(L){if(!K(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},ut.Component=W,ut.Fragment=t,ut.Profiler=a,ut.PureComponent=G,ut.StrictMode=r,ut.Suspense=h,ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ee,ut.act=ke,ut.cloneElement=function(L,se,Ge){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var xe=V({},L.props),Ue=L.key,Ne=L.ref,Ze=L._owner;if(se!=null){if(se.ref!==void 0&&(Ne=se.ref,Ze=Q.current),se.key!==void 0&&(Ue=""+se.key),L.type&&L.type.defaultProps)var ze=L.type.defaultProps;for(dt in se)D.call(se,dt)&&!ie.hasOwnProperty(dt)&&(xe[dt]=se[dt]===void 0&&ze!==void 0?ze[dt]:se[dt])}var dt=arguments.length-2;if(dt===1)xe.children=Ge;else if(1<dt){ze=Array(dt);for(var Ot=0;Ot<dt;Ot++)ze[Ot]=arguments[Ot+2];xe.children=ze}return{$$typeof:n,type:L.type,key:Ue,ref:Ne,props:xe,_owner:Ze}},ut.createContext=function(L){return L={$$typeof:l,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:s,_context:L},L.Consumer=L},ut.createElement=Y,ut.createFactory=function(L){var se=Y.bind(null,L);return se.type=L,se},ut.createRef=function(){return{current:null}},ut.forwardRef=function(L){return{$$typeof:u,render:L}},ut.isValidElement=K,ut.lazy=function(L){return{$$typeof:g,_payload:{_status:-1,_result:L},_init:Me}},ut.memo=function(L,se){return{$$typeof:f,type:L,compare:se===void 0?null:se}},ut.startTransition=function(L){var se=le.transition;le.transition={};try{L()}finally{le.transition=se}},ut.unstable_act=ke,ut.useCallback=function(L,se){return Re.current.useCallback(L,se)},ut.useContext=function(L){return Re.current.useContext(L)},ut.useDebugValue=function(){},ut.useDeferredValue=function(L){return Re.current.useDeferredValue(L)},ut.useEffect=function(L,se){return Re.current.useEffect(L,se)},ut.useId=function(){return Re.current.useId()},ut.useImperativeHandle=function(L,se,Ge){return Re.current.useImperativeHandle(L,se,Ge)},ut.useInsertionEffect=function(L,se){return Re.current.useInsertionEffect(L,se)},ut.useLayoutEffect=function(L,se){return Re.current.useLayoutEffect(L,se)},ut.useMemo=function(L,se){return Re.current.useMemo(L,se)},ut.useReducer=function(L,se,Ge){return Re.current.useReducer(L,se,Ge)},ut.useRef=function(L){return Re.current.useRef(L)},ut.useState=function(L){return Re.current.useState(L)},ut.useSyncExternalStore=function(L,se,Ge){return Re.current.useSyncExternalStore(L,se,Ge)},ut.useTransition=function(){return Re.current.useTransition()},ut.version="18.3.1",ut}var ov;function Sf(){return ov||(ov=1,iv.exports=Tk()),iv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv;function xk(){if(sv)return jl;sv=1;var n=Sf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(u,h,f){var g,C={},x=null,T=null;f!==void 0&&(x=""+f),h.key!==void 0&&(x=""+h.key),h.ref!==void 0&&(T=h.ref);for(g in h)r.call(h,g)&&!s.hasOwnProperty(g)&&(C[g]=h[g]);if(u&&u.defaultProps)for(g in h=u.defaultProps,h)C[g]===void 0&&(C[g]=h[g]);return{$$typeof:e,type:u,key:x,ref:T,props:C,_owner:a.current}}return jl.Fragment=t,jl.jsx=l,jl.jsxs=l,jl}var lv;function Ek(){return lv||(lv=1,rv.exports=xk()),rv.exports}var R=Ek(),ve=Sf();const Mo=Cy(ve);var Au={},rp={exports:{}},cr={},cv={exports:{}},uv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv;function _k(){return dv||(dv=1,function(n){function e(le,Ee){var ke=le.length;le.push(Ee);e:for(;0<ke;){var L=ke-1>>>1,se=le[L];if(0<a(se,Ee))le[L]=Ee,le[ke]=se,ke=L;else break e}}function t(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var Ee=le[0],ke=le.pop();if(ke!==Ee){le[0]=ke;e:for(var L=0,se=le.length,Ge=se>>>1;L<Ge;){var xe=2*(L+1)-1,Ue=le[xe],Ne=xe+1,Ze=le[Ne];if(0>a(Ue,ke))Ne<se&&0>a(Ze,Ue)?(le[L]=Ze,le[Ne]=ke,L=Ne):(le[L]=Ue,le[xe]=ke,L=xe);else if(Ne<se&&0>a(Ze,ke))le[L]=Ze,le[Ne]=ke,L=Ne;else break e}}return Ee}function a(le,Ee){var ke=le.sortIndex-Ee.sortIndex;return ke!==0?ke:le.id-Ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var h=[],f=[],g=1,C=null,x=3,T=!1,V=!1,A=!1,W=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(le){for(var Ee=t(f);Ee!==null;){if(Ee.callback===null)r(f);else if(Ee.startTime<=le)r(f),Ee.sortIndex=Ee.expirationTime,e(h,Ee);else break;Ee=t(f)}}function O(le){if(A=!1,F(le),!V)if(t(h)!==null)V=!0,Me(D);else{var Ee=t(f);Ee!==null&&Re(O,Ee.startTime-le)}}function D(le,Ee){V=!1,A&&(A=!1,U(Y),Y=-1),T=!0;var ke=x;try{for(F(Ee),C=t(h);C!==null&&(!(C.expirationTime>Ee)||le&&!X());){var L=C.callback;if(typeof L=="function"){C.callback=null,x=C.priorityLevel;var se=L(C.expirationTime<=Ee);Ee=n.unstable_now(),typeof se=="function"?C.callback=se:C===t(h)&&r(h),F(Ee)}else r(h);C=t(h)}if(C!==null)var Ge=!0;else{var xe=t(f);xe!==null&&Re(O,xe.startTime-Ee),Ge=!1}return Ge}finally{C=null,x=ke,T=!1}}var Q=!1,ie=null,Y=-1,z=5,K=-1;function X(){return!(n.unstable_now()-K<z)}function he(){if(ie!==null){var le=n.unstable_now();K=le;var Ee=!0;try{Ee=ie(!0,le)}finally{Ee?je():(Q=!1,ie=null)}}else Q=!1}var je;if(typeof G=="function")je=function(){G(he)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,de=ce.port2;ce.port1.onmessage=he,je=function(){de.postMessage(null)}}else je=function(){W(he,0)};function Me(le){ie=le,Q||(Q=!0,je())}function Re(le,Ee){Y=W(function(){le(n.unstable_now())},Ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){V||T||(V=!0,Me(D))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(le){switch(x){case 1:case 2:case 3:var Ee=3;break;default:Ee=x}var ke=x;x=Ee;try{return le()}finally{x=ke}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,Ee){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var ke=x;x=le;try{return Ee()}finally{x=ke}},n.unstable_scheduleCallback=function(le,Ee,ke){var L=n.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?L+ke:L):ke=L,le){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=ke+se,le={id:g++,callback:Ee,priorityLevel:le,startTime:ke,expirationTime:se,sortIndex:-1},ke>L?(le.sortIndex=ke,e(f,le),t(h)===null&&le===t(f)&&(A?(U(Y),Y=-1):A=!0,Re(O,ke-L))):(le.sortIndex=se,e(h,le),V||T||(V=!0,Me(D))),le},n.unstable_shouldYield=X,n.unstable_wrapCallback=function(le){var Ee=x;return function(){var ke=x;x=Ee;try{return le.apply(this,arguments)}finally{x=ke}}}}(uv)),uv}var hv;function Pk(){return hv||(hv=1,cv.exports=_k()),cv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pv;function Rk(){if(pv)return cr;pv=1;var n=Sf(),e=Pk();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function s(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(a[i]=o,i=0;i<o.length;i++)r.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},C={};function x(i){return h.call(C,i)?!0:h.call(g,i)?!1:f.test(i)?C[i]=!0:(g[i]=!0,!1)}function T(i,o,c,m){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return m?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function V(i,o,c,m){if(o===null||typeof o>"u"||T(i,o,c,m))return!0;if(m)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function A(i,o,c,m,b,w,_){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=m,this.attributeNamespace=b,this.mustUseProperty=c,this.propertyName=i,this.type=o,this.sanitizeURL=w,this.removeEmptyString=_}var W={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){W[i]=new A(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];W[o]=new A(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){W[i]=new A(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){W[i]=new A(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){W[i]=new A(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){W[i]=new A(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){W[i]=new A(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){W[i]=new A(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){W[i]=new A(i,5,!1,i.toLowerCase(),null,!1,!1)});var U=/[\-:]([a-z])/g;function G(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(U,G);W[o]=new A(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(U,G);W[o]=new A(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(U,G);W[o]=new A(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){W[i]=new A(i,1,!1,i.toLowerCase(),null,!1,!1)}),W.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){W[i]=new A(i,1,!1,i.toLowerCase(),null,!0,!0)});function F(i,o,c,m){var b=W.hasOwnProperty(o)?W[o]:null;(b!==null?b.type!==0:m||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(V(o,c,b,m)&&(c=null),m||b===null?x(o)&&(c===null?i.removeAttribute(o):i.setAttribute(o,""+c)):b.mustUseProperty?i[b.propertyName]=c===null?b.type===3?!1:"":c:(o=b.attributeName,m=b.attributeNamespace,c===null?i.removeAttribute(o):(b=b.type,c=b===3||b===4&&c===!0?"":""+c,m?i.setAttributeNS(m,o,c):i.setAttribute(o,c))))}var O=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),Q=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),X=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),Me=Symbol.for("react.lazy"),Re=Symbol.for("react.offscreen"),le=Symbol.iterator;function Ee(i){return i===null||typeof i!="object"?null:(i=le&&i[le]||i["@@iterator"],typeof i=="function"?i:null)}var ke=Object.assign,L;function se(i){if(L===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);L=o&&o[1]||""}return`
`+L+i}var Ge=!1;function xe(i,o){if(!i||Ge)return"";Ge=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(oe){var m=oe}Reflect.construct(i,[],o)}else{try{o.call()}catch(oe){m=oe}i.call(o.prototype)}else{try{throw Error()}catch(oe){m=oe}i()}}catch(oe){if(oe&&m&&typeof oe.stack=="string"){for(var b=oe.stack.split(`
`),w=m.stack.split(`
`),_=b.length-1,N=w.length-1;1<=_&&0<=N&&b[_]!==w[N];)N--;for(;1<=_&&0<=N;_--,N--)if(b[_]!==w[N]){if(_!==1||N!==1)do if(_--,N--,0>N||b[_]!==w[N]){var H=`
`+b[_].replace(" at new "," at ");return i.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",i.displayName)),H}while(1<=_&&0<=N);break}}}finally{Ge=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?se(i):""}function Ue(i){switch(i.tag){case 5:return se(i.type);case 16:return se("Lazy");case 13:return se("Suspense");case 19:return se("SuspenseList");case 0:case 2:case 15:return i=xe(i.type,!1),i;case 11:return i=xe(i.type.render,!1),i;case 1:return i=xe(i.type,!0),i;default:return""}}function Ne(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ie:return"Fragment";case Q:return"Portal";case z:return"Profiler";case Y:return"StrictMode";case je:return"Suspense";case ce:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case X:return(i.displayName||"Context")+".Consumer";case K:return(i._context.displayName||"Context")+".Provider";case he:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case de:return o=i.displayName||null,o!==null?o:Ne(i.type)||"Memo";case Me:o=i._payload,i=i._init;try{return Ne(i(o))}catch{}}return null}function Ze(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ne(o);case 8:return o===Y?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ze(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function dt(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ot(i){var o=dt(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),m=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var b=c.get,w=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return b.call(this)},set:function(_){m=""+_,w.call(this,_)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return m},setValue:function(_){m=""+_},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Wt(i){i._valueTracker||(i._valueTracker=Ot(i))}function er(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),m="";return i&&(m=dt(i)?i.checked?"true":"false":i.value),i=m,i!==c?(o.setValue(i),!0):!1}function bn(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Sr(i,o){var c=o.checked;return ke({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function Tr(i,o){var c=o.defaultValue==null?"":o.defaultValue,m=o.checked!=null?o.checked:o.defaultChecked;c=ze(o.value!=null?o.value:c),i._wrapperState={initialChecked:m,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function oa(i,o){o=o.checked,o!=null&&F(i,"checked",o,!1)}function Ai(i,o){oa(i,o);var c=ze(o.value),m=o.type;if(c!=null)m==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(m==="submit"||m==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?yn(i,o.type,c):o.hasOwnProperty("defaultValue")&&yn(i,o.type,ze(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Uo(i,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var m=o.type;if(!(m!=="submit"&&m!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,c||o===i.value||(i.value=o),i.defaultValue=o}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function yn(i,o,c){(o!=="number"||bn(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var Li=Array.isArray;function Un(i,o,c,m){if(i=i.options,o){o={};for(var b=0;b<c.length;b++)o["$"+c[b]]=!0;for(c=0;c<i.length;c++)b=o.hasOwnProperty("$"+i[c].value),i[c].selected!==b&&(i[c].selected=b),b&&m&&(i[c].defaultSelected=!0)}else{for(c=""+ze(c),o=null,b=0;b<i.length;b++){if(i[b].value===c){i[b].selected=!0,m&&(i[b].defaultSelected=!0);return}o!==null||i[b].disabled||(o=i[b])}o!==null&&(o.selected=!0)}}function Ni(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return ke({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Bo(i,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(t(92));if(Li(c)){if(1<c.length)throw Error(t(93));c=c[0]}o=c}o==null&&(o=""),c=o}i._wrapperState={initialValue:ze(c)}}function P(i,o){var c=ze(o.value),m=ze(o.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),o.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),m!=null&&(i.defaultValue=""+m)}function y(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function S(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function M(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?S(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var J,ue=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,m,b){MSApp.execUnsafeLocalFunction(function(){return i(o,c,m,b)})}:i}(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(J=J||document.createElement("div"),J.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=J.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function be(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var Je={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},at=["Webkit","ms","Moz","O"];Object.keys(Je).forEach(function(i){at.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Je[o]=Je[i]})});function De(i,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||Je.hasOwnProperty(i)&&Je[i]?(""+o).trim():o+"px"}function st(i,o){i=i.style;for(var c in o)if(o.hasOwnProperty(c)){var m=c.indexOf("--")===0,b=De(c,o[c],m);c==="float"&&(c="cssFloat"),m?i.setProperty(c,b):i[c]=b}}var Tt=ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zt(i,o){if(o){if(Tt[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function xt(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bn=null;function Pn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var wn=null,en=null,rn=null;function xr(i){if(i=wl(i)){if(typeof wn!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Kc(o),wn(i.stateNode,i.type,o))}}function et(i){en?rn?rn.push(i):rn=[i]:en=i}function Er(){if(en){var i=en,o=rn;if(rn=en=null,xr(i),o)for(i=0;i<o.length;i++)xr(o[i])}}function Vn(i,o){return i(o)}function ht(){}var Hn=!1;function Cc(i,o,c){if(Hn)return i(o,c);Hn=!0;try{return Vn(i,o,c)}finally{Hn=!1,(en!==null||rn!==null)&&(ht(),Er())}}function Wr(i,o){var c=i.stateNode;if(c===null)return null;var m=Kc(c);if(m===null)return null;c=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(t(231,o,typeof c));return c}var Vo=!1;if(u)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){Vo=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch{Vo=!1}function $s(i,o,c,m,b,w,_,N,H){var oe=Array.prototype.slice.call(arguments,3);try{o.apply(c,oe)}catch(we){this.onError(we)}}var pr=!1,qa=null,Wa=!1,sa=null,Sc={onError:function(i){pr=!0,qa=i}};function Tc(i,o,c,m,b,w,_,N,H){pr=!1,qa=null,$s.apply(Sc,arguments)}function Ho(i,o,c,m,b,w,_,N,H){if(Tc.apply(this,arguments),pr){if(pr){var oe=qa;pr=!1,qa=null}else throw Error(t(198));Wa||(Wa=!0,sa=oe)}}function di(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function xc(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function zr(i){if(di(i)!==i)throw Error(t(188))}function Ec(i){var o=i.alternate;if(!o){if(o=di(i),o===null)throw Error(t(188));return o!==i?null:i}for(var c=i,m=o;;){var b=c.return;if(b===null)break;var w=b.alternate;if(w===null){if(m=b.return,m!==null){c=m;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===c)return zr(b),i;if(w===m)return zr(b),o;w=w.sibling}throw Error(t(188))}if(c.return!==m.return)c=b,m=w;else{for(var _=!1,N=b.child;N;){if(N===c){_=!0,c=b,m=w;break}if(N===m){_=!0,m=b,c=w;break}N=N.sibling}if(!_){for(N=w.child;N;){if(N===c){_=!0,c=w,m=b;break}if(N===m){_=!0,m=w,c=b;break}N=N.sibling}if(!_)throw Error(t(189))}}if(c.alternate!==m)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?i:o}function _c(i){return i=Ec(i),i!==null?qo(i):null}function qo(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=qo(i);if(o!==null)return o;i=i.sibling}return null}var Ks=e.unstable_scheduleCallback,tr=e.unstable_cancelCallback,Wo=e.unstable_shouldYield,Js=e.unstable_requestPaint,Ut=e.unstable_now,zo=e.unstable_getCurrentPriorityLevel,Go=e.unstable_ImmediatePriority,Ys=e.unstable_UserBlockingPriority,za=e.unstable_NormalPriority,Ga=e.unstable_LowPriority,$o=e.unstable_IdlePriority,_r=null,Rn=null;function Ko(i){if(Rn&&typeof Rn.onCommitFiberRoot=="function")try{Rn.onCommitFiberRoot(_r,i,void 0,(i.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:Jo,Gr=Math.log,Pc=Math.LN2;function Jo(i){return i>>>=0,i===0?32:31-(Gr(i)/Pc|0)|0}var $a=64,Cn=4194304;function Pr(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function rt(i,o){var c=i.pendingLanes;if(c===0)return 0;var m=0,b=i.suspendedLanes,w=i.pingedLanes,_=c&268435455;if(_!==0){var N=_&~b;N!==0?m=Pr(N):(w&=_,w!==0&&(m=Pr(w)))}else _=c&~b,_!==0?m=Pr(_):w!==0&&(m=Pr(w));if(m===0)return 0;if(o!==0&&o!==m&&(o&b)===0&&(b=m&-m,w=o&-o,b>=w||b===16&&(w&4194240)!==0))return o;if((m&4)!==0&&(m|=c&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=m;0<o;)c=31-kn(o),b=1<<c,m|=i[c],o&=~b;return m}function fr(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rr(i,o){for(var c=i.suspendedLanes,m=i.pingedLanes,b=i.expirationTimes,w=i.pendingLanes;0<w;){var _=31-kn(w),N=1<<_,H=b[_];H===-1?((N&c)===0||(N&m)!==0)&&(b[_]=fr(N,o)):H<=o&&(i.expiredLanes|=N),w&=~N}}function Yo(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Xs(){var i=$a;return $a<<=1,($a&4194240)===0&&($a=64),i}function Xo(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function Et(i,o,c){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-kn(o),i[o]=c}function Ka(i,o){var c=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var m=i.eventTimes;for(i=i.expirationTimes;0<c;){var b=31-kn(c),w=1<<b;o[b]=0,m[b]=-1,i[b]=-1,c&=~w}}function Ja(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var m=31-kn(c),b=1<<m;b&o|i[m]&o&&(i[m]|=o),c&=~b}}var gt=0;function Ir(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Qo,$r,Qs,la,Ya,Xa=!1,Qa=[],Kr=null,Jr=null,hi=null,ca=new Map,pi=new Map,mr=[],ua="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Za(i,o){switch(i){case"focusin":case"focusout":Kr=null;break;case"dragenter":case"dragleave":Jr=null;break;case"mouseover":case"mouseout":hi=null;break;case"pointerover":case"pointerout":ca.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":pi.delete(o.pointerId)}}function Yr(i,o,c,m,b,w){return i===null||i.nativeEvent!==w?(i={blockedOn:o,domEventName:c,eventSystemFlags:m,nativeEvent:w,targetContainers:[b]},o!==null&&(o=wl(o),o!==null&&$r(o)),i):(i.eventSystemFlags|=m,o=i.targetContainers,b!==null&&o.indexOf(b)===-1&&o.push(b),i)}function eo(i,o,c,m,b){switch(o){case"focusin":return Kr=Yr(Kr,i,o,c,m,b),!0;case"dragenter":return Jr=Yr(Jr,i,o,c,m,b),!0;case"mouseover":return hi=Yr(hi,i,o,c,m,b),!0;case"pointerover":var w=b.pointerId;return ca.set(w,Yr(ca.get(w)||null,i,o,c,m,b)),!0;case"gotpointercapture":return w=b.pointerId,pi.set(w,Yr(pi.get(w)||null,i,o,c,m,b)),!0}return!1}function ji(i){var o=po(i.target);if(o!==null){var c=di(o);if(c!==null){if(o=c.tag,o===13){if(o=xc(c),o!==null){i.blockedOn=o,Ya(i.priority,function(){Qs(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Di(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=nl(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var m=new c.constructor(c.type,c);Bn=m,c.target.dispatchEvent(m),Bn=null}else return o=wl(c),o!==null&&$r(o),i.blockedOn=c,!1;o.shift()}return!0}function In(i,o,c){Di(i)&&c.delete(o)}function Zo(){Xa=!1,Kr!==null&&Di(Kr)&&(Kr=null),Jr!==null&&Di(Jr)&&(Jr=null),hi!==null&&Di(hi)&&(hi=null),ca.forEach(In),pi.forEach(In)}function to(i,o){i.blockedOn===o&&(i.blockedOn=null,Xa||(Xa=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Zo)))}function Mn(i){function o(b){return to(b,i)}if(0<Qa.length){to(Qa[0],i);for(var c=1;c<Qa.length;c++){var m=Qa[c];m.blockedOn===i&&(m.blockedOn=null)}}for(Kr!==null&&to(Kr,i),Jr!==null&&to(Jr,i),hi!==null&&to(hi,i),ca.forEach(o),pi.forEach(o),c=0;c<mr.length;c++)m=mr[c],m.blockedOn===i&&(m.blockedOn=null);for(;0<mr.length&&(c=mr[0],c.blockedOn===null);)ji(c),c.blockedOn===null&&mr.shift()}var fi=O.ReactCurrentBatchConfig,gr=!0;function Zs(i,o,c,m){var b=gt,w=fi.transition;fi.transition=null;try{gt=1,tl(i,o,c,m)}finally{gt=b,fi.transition=w}}function el(i,o,c,m){var b=gt,w=fi.transition;fi.transition=null;try{gt=4,tl(i,o,c,m)}finally{gt=b,fi.transition=w}}function tl(i,o,c,m){if(gr){var b=nl(i,o,c,m);if(b===null)Kd(i,o,m,Fi,c),Za(i,m);else if(eo(b,i,o,c,m))m.stopPropagation();else if(Za(i,m),o&4&&-1<ua.indexOf(i)){for(;b!==null;){var w=wl(b);if(w!==null&&Qo(w),w=nl(i,o,c,m),w===null&&Kd(i,o,m,Fi,c),w===b)break;b=w}b!==null&&m.stopPropagation()}else Kd(i,o,m,null,c)}}var Fi=null;function nl(i,o,c,m){if(Fi=null,i=Pn(m),i=po(i),i!==null)if(o=di(i),o===null)i=null;else if(c=o.tag,c===13){if(i=xc(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Fi=i,null}function Rc(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zo()){case Go:return 1;case Ys:return 4;case za:case Ga:return 16;case $o:return 536870912;default:return 16}default:return 16}}var mi=null,vr=null,no=null;function ro(){if(no)return no;var i,o=vr,c=o.length,m,b="value"in mi?mi.value:mi.textContent,w=b.length;for(i=0;i<c&&o[i]===b[i];i++);var _=c-i;for(m=1;m<=_&&o[c-m]===b[w-m];m++);return no=b.slice(i,1<m?1-m:void 0)}function io(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function es(){return!0}function an(){return!1}function On(i){function o(c,m,b,w,_){this._reactName=c,this._targetInst=b,this.type=m,this.nativeEvent=w,this.target=_,this.currentTarget=null;for(var N in i)i.hasOwnProperty(N)&&(c=i[N],this[N]=c?c(w):w[N]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?es:an,this.isPropagationStopped=an,this}return ke(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=es)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=es)},persist:function(){},isPersistent:es}),o}var An={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},da=On(An),gi=ke({},An,{view:0,detail:0}),Ic=On(gi),ao,rl,Ui,ts=ke({},gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ns,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ui&&(Ui&&i.type==="mousemove"?(ao=i.screenX-Ui.screenX,rl=i.screenY-Ui.screenY):rl=ao=0,Ui=i),ao)},movementY:function(i){return"movementY"in i?i.movementY:rl}}),Mc=On(ts),Oc=ke({},ts,{dataTransfer:0}),Fd=On(Oc),Ud=ke({},gi,{relatedTarget:0}),il=On(Ud),Bd=ke({},An,{animationName:0,elapsedTime:0,pseudoElement:0}),Vd=On(Bd),Hd=ke({},An,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),qd=On(Hd),al=ke({},An,{data:0}),oo=On(al),Wd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ac={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ol(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Ac[i])?!!o[i]:!1}function ns(){return ol}var Lc=ke({},gi,{key:function(i){if(i.key){var o=Wd[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=io(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?zd[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ns,charCode:function(i){return i.type==="keypress"?io(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?io(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Nc=On(Lc),so=ke({},ts,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nr=On(so),rs=ke({},gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ns}),lo=On(rs),ha=ke({},An,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mr=On(ha),is=ke({},ts,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Yt=On(is),jc=[9,13,27,32],Xt=u&&"CompositionEvent"in window,vi=null;u&&"documentMode"in document&&(vi=document.documentMode);var Gd=u&&"TextEvent"in window&&!vi,as=u&&(!Xt||vi&&8<vi&&11>=vi),Dc=" ",co=!1;function br(i,o){switch(i){case"keyup":return jc.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sl(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var bi=!1;function Fc(i,o){switch(i){case"compositionend":return sl(o);case"keypress":return o.which!==32?null:(co=!0,Dc);case"textInput":return i=o.data,i===Dc&&co?null:i;default:return null}}function ll(i,o){if(bi)return i==="compositionend"||!Xt&&br(i,o)?(i=ro(),no=vr=mi=null,bi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return as&&o.locale!=="ko"?null:o.data;default:return null}}var cl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pa(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!cl[i.type]:o==="textarea"}function Uc(i,o,c,m){et(m),o=zc(o,"onChange"),0<o.length&&(c=new da("onChange","change",null,c,m),i.push({event:c,listeners:o}))}var yi=null,fa=null;function Bc(i){gm(i,0)}function Bi(i){var o=us(i);if(er(o))return i}function Vc(i,o){if(i==="change")return o}var ul=!1;if(u){var dl;if(u){var os="oninput"in document;if(!os){var hl=document.createElement("div");hl.setAttribute("oninput","return;"),os=typeof hl.oninput=="function"}dl=os}else dl=!1;ul=dl&&(!document.documentMode||9<document.documentMode)}function uo(){yi&&(yi.detachEvent("onpropertychange",pe),fa=yi=null)}function pe(i){if(i.propertyName==="value"&&Bi(fa)){var o=[];Uc(o,fa,i,Pn(i)),Cc(Bc,o)}}function pl(i,o,c){i==="focusin"?(uo(),yi=o,fa=c,yi.attachEvent("onpropertychange",pe)):i==="focusout"&&uo()}function Hc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Bi(fa)}function Xr(i,o){if(i==="click")return Bi(o)}function ss(i,o){if(i==="input"||i==="change")return Bi(o)}function qc(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var rr=typeof Object.is=="function"?Object.is:qc;function ma(i,o){if(rr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),m=Object.keys(o);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var b=c[m];if(!h.call(o,b)||!rr(i[b],o[b]))return!1}return!0}function fl(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ml(i,o){var c=fl(i);i=0;for(var m;c;){if(c.nodeType===3){if(m=i+c.textContent.length,i<=o&&m>=o)return{node:c,offset:o-i};i=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=fl(c)}}function ho(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?ho(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function gl(){for(var i=window,o=bn();o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=bn(i.document)}return o}function d(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function p(i){var o=gl(),c=i.focusedElem,m=i.selectionRange;if(o!==c&&c&&c.ownerDocument&&ho(c.ownerDocument.documentElement,c)){if(m!==null&&d(c)){if(o=m.start,i=m.end,i===void 0&&(i=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(i,c.value.length);else if(i=(o=c.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var b=c.textContent.length,w=Math.min(m.start,b);m=m.end===void 0?w:Math.min(m.end,b),!i.extend&&w>m&&(b=m,m=w,w=b),b=ml(c,w);var _=ml(c,m);b&&_&&(i.rangeCount!==1||i.anchorNode!==b.node||i.anchorOffset!==b.offset||i.focusNode!==_.node||i.focusOffset!==_.offset)&&(o=o.createRange(),o.setStart(b.node,b.offset),i.removeAllRanges(),w>m?(i.addRange(o),i.extend(_.node,_.offset)):(o.setEnd(_.node,_.offset),i.addRange(o)))}}for(o=[],i=c;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)i=o[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var v=u&&"documentMode"in document&&11>=document.documentMode,k=null,E=null,I=null,B=!1;function $(i,o,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;B||k==null||k!==bn(m)||(m=k,"selectionStart"in m&&d(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),I&&ma(I,m)||(I=m,m=zc(E,"onSelect"),0<m.length&&(o=new da("onSelect","select",null,o,c),i.push({event:o,listeners:m}),o.target=k)))}function ae(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var Z={animationend:ae("Animation","AnimationEnd"),animationiteration:ae("Animation","AnimationIteration"),animationstart:ae("Animation","AnimationStart"),transitionend:ae("Transition","TransitionEnd")},Te={},Oe={};u&&(Oe=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function Ve(i){if(Te[i])return Te[i];if(!Z[i])return i;var o=Z[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in Oe)return Te[i]=o[c];return i}var te=Ve("animationend"),fe=Ve("animationiteration"),Ie=Ve("animationstart"),$e=Ve("transitionend"),Ye=new Map,tt="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vt(i,o){Ye.set(i,o),s(o,[i])}for(var It=0;It<tt.length;It++){var At=tt[It],_t=At.toLowerCase(),Qr=At[0].toUpperCase()+At.slice(1);vt(_t,"on"+Qr)}vt(te,"onAnimationEnd"),vt(fe,"onAnimationIteration"),vt(Ie,"onAnimationStart"),vt("dblclick","onDoubleClick"),vt("focusin","onFocus"),vt("focusout","onBlur"),vt($e,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Aw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vi));function mm(i,o,c){var m=i.type||"unknown-event";i.currentTarget=c,Ho(m,o,void 0,i),i.currentTarget=null}function gm(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var m=i[c],b=m.event;m=m.listeners;e:{var w=void 0;if(o)for(var _=m.length-1;0<=_;_--){var N=m[_],H=N.instance,oe=N.currentTarget;if(N=N.listener,H!==w&&b.isPropagationStopped())break e;mm(b,N,oe),w=H}else for(_=0;_<m.length;_++){if(N=m[_],H=N.instance,oe=N.currentTarget,N=N.listener,H!==w&&b.isPropagationStopped())break e;mm(b,N,oe),w=H}}}if(Wa)throw i=sa,Wa=!1,sa=null,i}function Lt(i,o){var c=o[eh];c===void 0&&(c=o[eh]=new Set);var m=i+"__bubble";c.has(m)||(vm(o,i,2,!1),c.add(m))}function $d(i,o,c){var m=0;o&&(m|=4),vm(c,i,m,o)}var Wc="_reactListening"+Math.random().toString(36).slice(2);function vl(i){if(!i[Wc]){i[Wc]=!0,r.forEach(function(c){c!=="selectionchange"&&(Aw.has(c)||$d(c,!1,i),$d(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Wc]||(o[Wc]=!0,$d("selectionchange",!1,o))}}function vm(i,o,c,m){switch(Rc(o)){case 1:var b=Zs;break;case 4:b=el;break;default:b=tl}c=b.bind(null,o,c,i),b=void 0,!Vo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(b=!0),m?b!==void 0?i.addEventListener(o,c,{capture:!0,passive:b}):i.addEventListener(o,c,!0):b!==void 0?i.addEventListener(o,c,{passive:b}):i.addEventListener(o,c,!1)}function Kd(i,o,c,m,b){var w=m;if((o&1)===0&&(o&2)===0&&m!==null)e:for(;;){if(m===null)return;var _=m.tag;if(_===3||_===4){var N=m.stateNode.containerInfo;if(N===b||N.nodeType===8&&N.parentNode===b)break;if(_===4)for(_=m.return;_!==null;){var H=_.tag;if((H===3||H===4)&&(H=_.stateNode.containerInfo,H===b||H.nodeType===8&&H.parentNode===b))return;_=_.return}for(;N!==null;){if(_=po(N),_===null)return;if(H=_.tag,H===5||H===6){m=w=_;continue e}N=N.parentNode}}m=m.return}Cc(function(){var oe=w,we=Pn(c),Ce=[];e:{var ye=Ye.get(i);if(ye!==void 0){var Be=da,qe=i;switch(i){case"keypress":if(io(c)===0)break e;case"keydown":case"keyup":Be=Nc;break;case"focusin":qe="focus",Be=il;break;case"focusout":qe="blur",Be=il;break;case"beforeblur":case"afterblur":Be=il;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Be=Mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Be=Fd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Be=lo;break;case te:case fe:case Ie:Be=Vd;break;case $e:Be=Mr;break;case"scroll":Be=Ic;break;case"wheel":Be=Yt;break;case"copy":case"cut":case"paste":Be=qd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Be=nr}var We=(o&4)!==0,Qt=!We&&i==="scroll",ee=We?ye!==null?ye+"Capture":null:ye;We=[];for(var q=oe,re;q!==null;){re=q;var Pe=re.stateNode;if(re.tag===5&&Pe!==null&&(re=Pe,ee!==null&&(Pe=Wr(q,ee),Pe!=null&&We.push(bl(q,Pe,re)))),Qt)break;q=q.return}0<We.length&&(ye=new Be(ye,qe,null,c,we),Ce.push({event:ye,listeners:We}))}}if((o&7)===0){e:{if(ye=i==="mouseover"||i==="pointerover",Be=i==="mouseout"||i==="pointerout",ye&&c!==Bn&&(qe=c.relatedTarget||c.fromElement)&&(po(qe)||qe[Hi]))break e;if((Be||ye)&&(ye=we.window===we?we:(ye=we.ownerDocument)?ye.defaultView||ye.parentWindow:window,Be?(qe=c.relatedTarget||c.toElement,Be=oe,qe=qe?po(qe):null,qe!==null&&(Qt=di(qe),qe!==Qt||qe.tag!==5&&qe.tag!==6)&&(qe=null)):(Be=null,qe=oe),Be!==qe)){if(We=Mc,Pe="onMouseLeave",ee="onMouseEnter",q="mouse",(i==="pointerout"||i==="pointerover")&&(We=nr,Pe="onPointerLeave",ee="onPointerEnter",q="pointer"),Qt=Be==null?ye:us(Be),re=qe==null?ye:us(qe),ye=new We(Pe,q+"leave",Be,c,we),ye.target=Qt,ye.relatedTarget=re,Pe=null,po(we)===oe&&(We=new We(ee,q+"enter",qe,c,we),We.target=re,We.relatedTarget=Qt,Pe=We),Qt=Pe,Be&&qe)t:{for(We=Be,ee=qe,q=0,re=We;re;re=ls(re))q++;for(re=0,Pe=ee;Pe;Pe=ls(Pe))re++;for(;0<q-re;)We=ls(We),q--;for(;0<re-q;)ee=ls(ee),re--;for(;q--;){if(We===ee||ee!==null&&We===ee.alternate)break t;We=ls(We),ee=ls(ee)}We=null}else We=null;Be!==null&&bm(Ce,ye,Be,We,!1),qe!==null&&Qt!==null&&bm(Ce,Qt,qe,We,!0)}}e:{if(ye=oe?us(oe):window,Be=ye.nodeName&&ye.nodeName.toLowerCase(),Be==="select"||Be==="input"&&ye.type==="file")var Ke=Vc;else if(pa(ye))if(ul)Ke=ss;else{Ke=Hc;var Xe=pl}else(Be=ye.nodeName)&&Be.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&(Ke=Xr);if(Ke&&(Ke=Ke(i,oe))){Uc(Ce,Ke,c,we);break e}Xe&&Xe(i,ye,oe),i==="focusout"&&(Xe=ye._wrapperState)&&Xe.controlled&&ye.type==="number"&&yn(ye,"number",ye.value)}switch(Xe=oe?us(oe):window,i){case"focusin":(pa(Xe)||Xe.contentEditable==="true")&&(k=Xe,E=oe,I=null);break;case"focusout":I=E=k=null;break;case"mousedown":B=!0;break;case"contextmenu":case"mouseup":case"dragend":B=!1,$(Ce,c,we);break;case"selectionchange":if(v)break;case"keydown":case"keyup":$(Ce,c,we)}var Qe;if(Xt)e:{switch(i){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else bi?br(i,c)&&(nt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(nt="onCompositionStart");nt&&(as&&c.locale!=="ko"&&(bi||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&bi&&(Qe=ro()):(mi=we,vr="value"in mi?mi.value:mi.textContent,bi=!0)),Xe=zc(oe,nt),0<Xe.length&&(nt=new oo(nt,i,null,c,we),Ce.push({event:nt,listeners:Xe}),Qe?nt.data=Qe:(Qe=sl(c),Qe!==null&&(nt.data=Qe)))),(Qe=Gd?Fc(i,c):ll(i,c))&&(oe=zc(oe,"onBeforeInput"),0<oe.length&&(we=new oo("onBeforeInput","beforeinput",null,c,we),Ce.push({event:we,listeners:oe}),we.data=Qe))}gm(Ce,o)})}function bl(i,o,c){return{instance:i,listener:o,currentTarget:c}}function zc(i,o){for(var c=o+"Capture",m=[];i!==null;){var b=i,w=b.stateNode;b.tag===5&&w!==null&&(b=w,w=Wr(i,c),w!=null&&m.unshift(bl(i,w,b)),w=Wr(i,o),w!=null&&m.push(bl(i,w,b))),i=i.return}return m}function ls(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function bm(i,o,c,m,b){for(var w=o._reactName,_=[];c!==null&&c!==m;){var N=c,H=N.alternate,oe=N.stateNode;if(H!==null&&H===m)break;N.tag===5&&oe!==null&&(N=oe,b?(H=Wr(c,w),H!=null&&_.unshift(bl(c,H,N))):b||(H=Wr(c,w),H!=null&&_.push(bl(c,H,N)))),c=c.return}_.length!==0&&i.push({event:o,listeners:_})}var Lw=/\r\n?/g,Nw=/\u0000|\uFFFD/g;function ym(i){return(typeof i=="string"?i:""+i).replace(Lw,`
`).replace(Nw,"")}function Gc(i,o,c){if(o=ym(o),ym(i)!==o&&c)throw Error(t(425))}function $c(){}var Jd=null,Yd=null;function Xd(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Qd=typeof setTimeout=="function"?setTimeout:void 0,jw=typeof clearTimeout=="function"?clearTimeout:void 0,wm=typeof Promise=="function"?Promise:void 0,Dw=typeof queueMicrotask=="function"?queueMicrotask:typeof wm<"u"?function(i){return wm.resolve(null).then(i).catch(Fw)}:Qd;function Fw(i){setTimeout(function(){throw i})}function Zd(i,o){var c=o,m=0;do{var b=c.nextSibling;if(i.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(m===0){i.removeChild(b),Mn(o);return}m--}else c!=="$"&&c!=="$?"&&c!=="$!"||m++;c=b}while(c);Mn(o)}function ga(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function km(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}var cs=Math.random().toString(36).slice(2),wi="__reactFiber$"+cs,yl="__reactProps$"+cs,Hi="__reactContainer$"+cs,eh="__reactEvents$"+cs,Uw="__reactListeners$"+cs,Bw="__reactHandles$"+cs;function po(i){var o=i[wi];if(o)return o;for(var c=i.parentNode;c;){if(o=c[Hi]||c[wi]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=km(i);i!==null;){if(c=i[wi])return c;i=km(i)}return o}i=c,c=i.parentNode}return null}function wl(i){return i=i[wi]||i[Hi],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function us(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Kc(i){return i[yl]||null}var th=[],ds=-1;function va(i){return{current:i}}function Nt(i){0>ds||(i.current=th[ds],th[ds]=null,ds--)}function Mt(i,o){ds++,th[ds]=i.current,i.current=o}var ba={},Ln=va(ba),ir=va(!1),fo=ba;function hs(i,o){var c=i.type.contextTypes;if(!c)return ba;var m=i.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===o)return m.__reactInternalMemoizedMaskedChildContext;var b={},w;for(w in c)b[w]=o[w];return m&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=b),b}function ar(i){return i=i.childContextTypes,i!=null}function Jc(){Nt(ir),Nt(Ln)}function Cm(i,o,c){if(Ln.current!==ba)throw Error(t(168));Mt(Ln,o),Mt(ir,c)}function Sm(i,o,c){var m=i.stateNode;if(o=o.childContextTypes,typeof m.getChildContext!="function")return c;m=m.getChildContext();for(var b in m)if(!(b in o))throw Error(t(108,Ze(i)||"Unknown",b));return ke({},c,m)}function Yc(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ba,fo=Ln.current,Mt(Ln,i),Mt(ir,ir.current),!0}function Tm(i,o,c){var m=i.stateNode;if(!m)throw Error(t(169));c?(i=Sm(i,o,fo),m.__reactInternalMemoizedMergedChildContext=i,Nt(ir),Nt(Ln),Mt(Ln,i)):Nt(ir),Mt(ir,c)}var qi=null,Xc=!1,nh=!1;function xm(i){qi===null?qi=[i]:qi.push(i)}function Vw(i){Xc=!0,xm(i)}function ya(){if(!nh&&qi!==null){nh=!0;var i=0,o=gt;try{var c=qi;for(gt=1;i<c.length;i++){var m=c[i];do m=m(!0);while(m!==null)}qi=null,Xc=!1}catch(b){throw qi!==null&&(qi=qi.slice(i+1)),Ks(Go,ya),b}finally{gt=o,nh=!1}}return null}var ps=[],fs=0,Qc=null,Zc=0,Or=[],Ar=0,mo=null,Wi=1,zi="";function go(i,o){ps[fs++]=Zc,ps[fs++]=Qc,Qc=i,Zc=o}function Em(i,o,c){Or[Ar++]=Wi,Or[Ar++]=zi,Or[Ar++]=mo,mo=i;var m=Wi;i=zi;var b=32-kn(m)-1;m&=~(1<<b),c+=1;var w=32-kn(o)+b;if(30<w){var _=b-b%5;w=(m&(1<<_)-1).toString(32),m>>=_,b-=_,Wi=1<<32-kn(o)+b|c<<b|m,zi=w+i}else Wi=1<<w|c<<b|m,zi=i}function rh(i){i.return!==null&&(go(i,1),Em(i,1,0))}function ih(i){for(;i===Qc;)Qc=ps[--fs],ps[fs]=null,Zc=ps[--fs],ps[fs]=null;for(;i===mo;)mo=Or[--Ar],Or[Ar]=null,zi=Or[--Ar],Or[Ar]=null,Wi=Or[--Ar],Or[Ar]=null}var yr=null,wr=null,jt=!1,Zr=null;function _m(i,o){var c=Dr(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=i,o=i.deletions,o===null?(i.deletions=[c],i.flags|=16):o.push(c)}function Pm(i,o){switch(i.tag){case 5:var c=i.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,yr=i,wr=ga(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,yr=i,wr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=mo!==null?{id:Wi,overflow:zi}:null,i.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=Dr(18,null,null,0),c.stateNode=o,c.return=i,i.child=c,yr=i,wr=null,!0):!1;default:return!1}}function ah(i){return(i.mode&1)!==0&&(i.flags&128)===0}function oh(i){if(jt){var o=wr;if(o){var c=o;if(!Pm(i,o)){if(ah(i))throw Error(t(418));o=ga(c.nextSibling);var m=yr;o&&Pm(i,o)?_m(m,c):(i.flags=i.flags&-4097|2,jt=!1,yr=i)}}else{if(ah(i))throw Error(t(418));i.flags=i.flags&-4097|2,jt=!1,yr=i}}}function Rm(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;yr=i}function eu(i){if(i!==yr)return!1;if(!jt)return Rm(i),jt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Xd(i.type,i.memoizedProps)),o&&(o=wr)){if(ah(i))throw Im(),Error(t(418));for(;o;)_m(i,o),o=ga(o.nextSibling)}if(Rm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(o===0){wr=ga(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}i=i.nextSibling}wr=null}}else wr=yr?ga(i.stateNode.nextSibling):null;return!0}function Im(){for(var i=wr;i;)i=ga(i.nextSibling)}function ms(){wr=yr=null,jt=!1}function sh(i){Zr===null?Zr=[i]:Zr.push(i)}var Hw=O.ReactCurrentBatchConfig;function kl(i,o,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var m=c.stateNode}if(!m)throw Error(t(147,i));var b=m,w=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===w?o.ref:(o=function(_){var N=b.refs;_===null?delete N[w]:N[w]=_},o._stringRef=w,o)}if(typeof i!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,i))}return i}function tu(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Mm(i){var o=i._init;return o(i._payload)}function Om(i){function o(ee,q){if(i){var re=ee.deletions;re===null?(ee.deletions=[q],ee.flags|=16):re.push(q)}}function c(ee,q){if(!i)return null;for(;q!==null;)o(ee,q),q=q.sibling;return null}function m(ee,q){for(ee=new Map;q!==null;)q.key!==null?ee.set(q.key,q):ee.set(q.index,q),q=q.sibling;return ee}function b(ee,q){return ee=_a(ee,q),ee.index=0,ee.sibling=null,ee}function w(ee,q,re){return ee.index=re,i?(re=ee.alternate,re!==null?(re=re.index,re<q?(ee.flags|=2,q):re):(ee.flags|=2,q)):(ee.flags|=1048576,q)}function _(ee){return i&&ee.alternate===null&&(ee.flags|=2),ee}function N(ee,q,re,Pe){return q===null||q.tag!==6?(q=Xh(re,ee.mode,Pe),q.return=ee,q):(q=b(q,re),q.return=ee,q)}function H(ee,q,re,Pe){var Ke=re.type;return Ke===ie?we(ee,q,re.props.children,Pe,re.key):q!==null&&(q.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Me&&Mm(Ke)===q.type)?(Pe=b(q,re.props),Pe.ref=kl(ee,q,re),Pe.return=ee,Pe):(Pe=xu(re.type,re.key,re.props,null,ee.mode,Pe),Pe.ref=kl(ee,q,re),Pe.return=ee,Pe)}function oe(ee,q,re,Pe){return q===null||q.tag!==4||q.stateNode.containerInfo!==re.containerInfo||q.stateNode.implementation!==re.implementation?(q=Qh(re,ee.mode,Pe),q.return=ee,q):(q=b(q,re.children||[]),q.return=ee,q)}function we(ee,q,re,Pe,Ke){return q===null||q.tag!==7?(q=To(re,ee.mode,Pe,Ke),q.return=ee,q):(q=b(q,re),q.return=ee,q)}function Ce(ee,q,re){if(typeof q=="string"&&q!==""||typeof q=="number")return q=Xh(""+q,ee.mode,re),q.return=ee,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case D:return re=xu(q.type,q.key,q.props,null,ee.mode,re),re.ref=kl(ee,null,q),re.return=ee,re;case Q:return q=Qh(q,ee.mode,re),q.return=ee,q;case Me:var Pe=q._init;return Ce(ee,Pe(q._payload),re)}if(Li(q)||Ee(q))return q=To(q,ee.mode,re,null),q.return=ee,q;tu(ee,q)}return null}function ye(ee,q,re,Pe){var Ke=q!==null?q.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return Ke!==null?null:N(ee,q,""+re,Pe);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case D:return re.key===Ke?H(ee,q,re,Pe):null;case Q:return re.key===Ke?oe(ee,q,re,Pe):null;case Me:return Ke=re._init,ye(ee,q,Ke(re._payload),Pe)}if(Li(re)||Ee(re))return Ke!==null?null:we(ee,q,re,Pe,null);tu(ee,re)}return null}function Be(ee,q,re,Pe,Ke){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return ee=ee.get(re)||null,N(q,ee,""+Pe,Ke);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case D:return ee=ee.get(Pe.key===null?re:Pe.key)||null,H(q,ee,Pe,Ke);case Q:return ee=ee.get(Pe.key===null?re:Pe.key)||null,oe(q,ee,Pe,Ke);case Me:var Xe=Pe._init;return Be(ee,q,re,Xe(Pe._payload),Ke)}if(Li(Pe)||Ee(Pe))return ee=ee.get(re)||null,we(q,ee,Pe,Ke,null);tu(q,Pe)}return null}function qe(ee,q,re,Pe){for(var Ke=null,Xe=null,Qe=q,nt=q=0,mn=null;Qe!==null&&nt<re.length;nt++){Qe.index>nt?(mn=Qe,Qe=null):mn=Qe.sibling;var yt=ye(ee,Qe,re[nt],Pe);if(yt===null){Qe===null&&(Qe=mn);break}i&&Qe&&yt.alternate===null&&o(ee,Qe),q=w(yt,q,nt),Xe===null?Ke=yt:Xe.sibling=yt,Xe=yt,Qe=mn}if(nt===re.length)return c(ee,Qe),jt&&go(ee,nt),Ke;if(Qe===null){for(;nt<re.length;nt++)Qe=Ce(ee,re[nt],Pe),Qe!==null&&(q=w(Qe,q,nt),Xe===null?Ke=Qe:Xe.sibling=Qe,Xe=Qe);return jt&&go(ee,nt),Ke}for(Qe=m(ee,Qe);nt<re.length;nt++)mn=Be(Qe,ee,nt,re[nt],Pe),mn!==null&&(i&&mn.alternate!==null&&Qe.delete(mn.key===null?nt:mn.key),q=w(mn,q,nt),Xe===null?Ke=mn:Xe.sibling=mn,Xe=mn);return i&&Qe.forEach(function(Pa){return o(ee,Pa)}),jt&&go(ee,nt),Ke}function We(ee,q,re,Pe){var Ke=Ee(re);if(typeof Ke!="function")throw Error(t(150));if(re=Ke.call(re),re==null)throw Error(t(151));for(var Xe=Ke=null,Qe=q,nt=q=0,mn=null,yt=re.next();Qe!==null&&!yt.done;nt++,yt=re.next()){Qe.index>nt?(mn=Qe,Qe=null):mn=Qe.sibling;var Pa=ye(ee,Qe,yt.value,Pe);if(Pa===null){Qe===null&&(Qe=mn);break}i&&Qe&&Pa.alternate===null&&o(ee,Qe),q=w(Pa,q,nt),Xe===null?Ke=Pa:Xe.sibling=Pa,Xe=Pa,Qe=mn}if(yt.done)return c(ee,Qe),jt&&go(ee,nt),Ke;if(Qe===null){for(;!yt.done;nt++,yt=re.next())yt=Ce(ee,yt.value,Pe),yt!==null&&(q=w(yt,q,nt),Xe===null?Ke=yt:Xe.sibling=yt,Xe=yt);return jt&&go(ee,nt),Ke}for(Qe=m(ee,Qe);!yt.done;nt++,yt=re.next())yt=Be(Qe,ee,nt,yt.value,Pe),yt!==null&&(i&&yt.alternate!==null&&Qe.delete(yt.key===null?nt:yt.key),q=w(yt,q,nt),Xe===null?Ke=yt:Xe.sibling=yt,Xe=yt);return i&&Qe.forEach(function(kk){return o(ee,kk)}),jt&&go(ee,nt),Ke}function Qt(ee,q,re,Pe){if(typeof re=="object"&&re!==null&&re.type===ie&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case D:e:{for(var Ke=re.key,Xe=q;Xe!==null;){if(Xe.key===Ke){if(Ke=re.type,Ke===ie){if(Xe.tag===7){c(ee,Xe.sibling),q=b(Xe,re.props.children),q.return=ee,ee=q;break e}}else if(Xe.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Me&&Mm(Ke)===Xe.type){c(ee,Xe.sibling),q=b(Xe,re.props),q.ref=kl(ee,Xe,re),q.return=ee,ee=q;break e}c(ee,Xe);break}else o(ee,Xe);Xe=Xe.sibling}re.type===ie?(q=To(re.props.children,ee.mode,Pe,re.key),q.return=ee,ee=q):(Pe=xu(re.type,re.key,re.props,null,ee.mode,Pe),Pe.ref=kl(ee,q,re),Pe.return=ee,ee=Pe)}return _(ee);case Q:e:{for(Xe=re.key;q!==null;){if(q.key===Xe)if(q.tag===4&&q.stateNode.containerInfo===re.containerInfo&&q.stateNode.implementation===re.implementation){c(ee,q.sibling),q=b(q,re.children||[]),q.return=ee,ee=q;break e}else{c(ee,q);break}else o(ee,q);q=q.sibling}q=Qh(re,ee.mode,Pe),q.return=ee,ee=q}return _(ee);case Me:return Xe=re._init,Qt(ee,q,Xe(re._payload),Pe)}if(Li(re))return qe(ee,q,re,Pe);if(Ee(re))return We(ee,q,re,Pe);tu(ee,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,q!==null&&q.tag===6?(c(ee,q.sibling),q=b(q,re),q.return=ee,ee=q):(c(ee,q),q=Xh(re,ee.mode,Pe),q.return=ee,ee=q),_(ee)):c(ee,q)}return Qt}var gs=Om(!0),Am=Om(!1),nu=va(null),ru=null,vs=null,lh=null;function ch(){lh=vs=ru=null}function uh(i){var o=nu.current;Nt(nu),i._currentValue=o}function dh(i,o,c){for(;i!==null;){var m=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),i===c)break;i=i.return}}function bs(i,o){ru=i,lh=vs=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(or=!0),i.firstContext=null)}function Lr(i){var o=i._currentValue;if(lh!==i)if(i={context:i,memoizedValue:o,next:null},vs===null){if(ru===null)throw Error(t(308));vs=i,ru.dependencies={lanes:0,firstContext:i}}else vs=vs.next=i;return o}var vo=null;function hh(i){vo===null?vo=[i]:vo.push(i)}function Lm(i,o,c,m){var b=o.interleaved;return b===null?(c.next=c,hh(o)):(c.next=b.next,b.next=c),o.interleaved=c,Gi(i,m)}function Gi(i,o){i.lanes|=o;var c=i.alternate;for(c!==null&&(c.lanes|=o),c=i,i=i.return;i!==null;)i.childLanes|=o,c=i.alternate,c!==null&&(c.childLanes|=o),c=i,i=i.return;return c.tag===3?c.stateNode:null}var wa=!1;function ph(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nm(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function $i(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function ka(i,o,c){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,(bt&2)!==0){var b=m.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),m.pending=o,Gi(i,c)}return b=m.interleaved,b===null?(o.next=o,hh(m)):(o.next=b.next,b.next=o),m.interleaved=o,Gi(i,c)}function iu(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var m=o.lanes;m&=i.pendingLanes,c|=m,o.lanes=c,Ja(i,c)}}function jm(i,o){var c=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var b=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var _={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};w===null?b=w=_:w=w.next=_,c=c.next}while(c!==null);w===null?b=w=o:w=w.next=o}else b=w=o;c={baseState:m.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:m.shared,effects:m.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}function au(i,o,c,m){var b=i.updateQueue;wa=!1;var w=b.firstBaseUpdate,_=b.lastBaseUpdate,N=b.shared.pending;if(N!==null){b.shared.pending=null;var H=N,oe=H.next;H.next=null,_===null?w=oe:_.next=oe,_=H;var we=i.alternate;we!==null&&(we=we.updateQueue,N=we.lastBaseUpdate,N!==_&&(N===null?we.firstBaseUpdate=oe:N.next=oe,we.lastBaseUpdate=H))}if(w!==null){var Ce=b.baseState;_=0,we=oe=H=null,N=w;do{var ye=N.lane,Be=N.eventTime;if((m&ye)===ye){we!==null&&(we=we.next={eventTime:Be,lane:0,tag:N.tag,payload:N.payload,callback:N.callback,next:null});e:{var qe=i,We=N;switch(ye=o,Be=c,We.tag){case 1:if(qe=We.payload,typeof qe=="function"){Ce=qe.call(Be,Ce,ye);break e}Ce=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=We.payload,ye=typeof qe=="function"?qe.call(Be,Ce,ye):qe,ye==null)break e;Ce=ke({},Ce,ye);break e;case 2:wa=!0}}N.callback!==null&&N.lane!==0&&(i.flags|=64,ye=b.effects,ye===null?b.effects=[N]:ye.push(N))}else Be={eventTime:Be,lane:ye,tag:N.tag,payload:N.payload,callback:N.callback,next:null},we===null?(oe=we=Be,H=Ce):we=we.next=Be,_|=ye;if(N=N.next,N===null){if(N=b.shared.pending,N===null)break;ye=N,N=ye.next,ye.next=null,b.lastBaseUpdate=ye,b.shared.pending=null}}while(!0);if(we===null&&(H=Ce),b.baseState=H,b.firstBaseUpdate=oe,b.lastBaseUpdate=we,o=b.shared.interleaved,o!==null){b=o;do _|=b.lane,b=b.next;while(b!==o)}else w===null&&(b.shared.lanes=0);wo|=_,i.lanes=_,i.memoizedState=Ce}}function Dm(i,o,c){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var m=i[o],b=m.callback;if(b!==null){if(m.callback=null,m=c,typeof b!="function")throw Error(t(191,b));b.call(m)}}}var Cl={},ki=va(Cl),Sl=va(Cl),Tl=va(Cl);function bo(i){if(i===Cl)throw Error(t(174));return i}function fh(i,o){switch(Mt(Tl,o),Mt(Sl,i),Mt(ki,Cl),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:M(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=M(o,i)}Nt(ki),Mt(ki,o)}function ys(){Nt(ki),Nt(Sl),Nt(Tl)}function Fm(i){bo(Tl.current);var o=bo(ki.current),c=M(o,i.type);o!==c&&(Mt(Sl,i),Mt(ki,c))}function mh(i){Sl.current===i&&(Nt(ki),Nt(Sl))}var Bt=va(0);function ou(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var gh=[];function vh(){for(var i=0;i<gh.length;i++)gh[i]._workInProgressVersionPrimary=null;gh.length=0}var su=O.ReactCurrentDispatcher,bh=O.ReactCurrentBatchConfig,yo=0,Vt=null,on=null,pn=null,lu=!1,xl=!1,El=0,qw=0;function Nn(){throw Error(t(321))}function yh(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!rr(i[c],o[c]))return!1;return!0}function wh(i,o,c,m,b,w){if(yo=w,Vt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,su.current=i===null||i.memoizedState===null?$w:Kw,i=c(m,b),xl){w=0;do{if(xl=!1,El=0,25<=w)throw Error(t(301));w+=1,pn=on=null,o.updateQueue=null,su.current=Jw,i=c(m,b)}while(xl)}if(su.current=du,o=on!==null&&on.next!==null,yo=0,pn=on=Vt=null,lu=!1,o)throw Error(t(300));return i}function kh(){var i=El!==0;return El=0,i}function Ci(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Vt.memoizedState=pn=i:pn=pn.next=i,pn}function Nr(){if(on===null){var i=Vt.alternate;i=i!==null?i.memoizedState:null}else i=on.next;var o=pn===null?Vt.memoizedState:pn.next;if(o!==null)pn=o,on=i;else{if(i===null)throw Error(t(310));on=i,i={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},pn===null?Vt.memoizedState=pn=i:pn=pn.next=i}return pn}function _l(i,o){return typeof o=="function"?o(i):o}function Ch(i){var o=Nr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var m=on,b=m.baseQueue,w=c.pending;if(w!==null){if(b!==null){var _=b.next;b.next=w.next,w.next=_}m.baseQueue=b=w,c.pending=null}if(b!==null){w=b.next,m=m.baseState;var N=_=null,H=null,oe=w;do{var we=oe.lane;if((yo&we)===we)H!==null&&(H=H.next={lane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),m=oe.hasEagerState?oe.eagerState:i(m,oe.action);else{var Ce={lane:we,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null};H===null?(N=H=Ce,_=m):H=H.next=Ce,Vt.lanes|=we,wo|=we}oe=oe.next}while(oe!==null&&oe!==w);H===null?_=m:H.next=N,rr(m,o.memoizedState)||(or=!0),o.memoizedState=m,o.baseState=_,o.baseQueue=H,c.lastRenderedState=m}if(i=c.interleaved,i!==null){b=i;do w=b.lane,Vt.lanes|=w,wo|=w,b=b.next;while(b!==i)}else b===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function Sh(i){var o=Nr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var m=c.dispatch,b=c.pending,w=o.memoizedState;if(b!==null){c.pending=null;var _=b=b.next;do w=i(w,_.action),_=_.next;while(_!==b);rr(w,o.memoizedState)||(or=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),c.lastRenderedState=w}return[w,m]}function Um(){}function Bm(i,o){var c=Vt,m=Nr(),b=o(),w=!rr(m.memoizedState,b);if(w&&(m.memoizedState=b,or=!0),m=m.queue,Th(qm.bind(null,c,m,i),[i]),m.getSnapshot!==o||w||pn!==null&&pn.memoizedState.tag&1){if(c.flags|=2048,Pl(9,Hm.bind(null,c,m,b,o),void 0,null),fn===null)throw Error(t(349));(yo&30)!==0||Vm(c,o,b)}return b}function Vm(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=Vt.updateQueue,o===null?(o={lastEffect:null,stores:null},Vt.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function Hm(i,o,c,m){o.value=c,o.getSnapshot=m,Wm(o)&&zm(i)}function qm(i,o,c){return c(function(){Wm(o)&&zm(i)})}function Wm(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!rr(i,c)}catch{return!0}}function zm(i){var o=Gi(i,1);o!==null&&ri(o,i,1,-1)}function Gm(i){var o=Ci();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:i},o.queue=i,i=i.dispatch=Gw.bind(null,Vt,i),[o.memoizedState,i]}function Pl(i,o,c,m){return i={tag:i,create:o,destroy:c,deps:m,next:null},o=Vt.updateQueue,o===null?(o={lastEffect:null,stores:null},Vt.updateQueue=o,o.lastEffect=i.next=i):(c=o.lastEffect,c===null?o.lastEffect=i.next=i:(m=c.next,c.next=i,i.next=m,o.lastEffect=i)),i}function $m(){return Nr().memoizedState}function cu(i,o,c,m){var b=Ci();Vt.flags|=i,b.memoizedState=Pl(1|o,c,void 0,m===void 0?null:m)}function uu(i,o,c,m){var b=Nr();m=m===void 0?null:m;var w=void 0;if(on!==null){var _=on.memoizedState;if(w=_.destroy,m!==null&&yh(m,_.deps)){b.memoizedState=Pl(o,c,w,m);return}}Vt.flags|=i,b.memoizedState=Pl(1|o,c,w,m)}function Km(i,o){return cu(8390656,8,i,o)}function Th(i,o){return uu(2048,8,i,o)}function Jm(i,o){return uu(4,2,i,o)}function Ym(i,o){return uu(4,4,i,o)}function Xm(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Qm(i,o,c){return c=c!=null?c.concat([i]):null,uu(4,4,Xm.bind(null,o,i),c)}function xh(){}function Zm(i,o){var c=Nr();o=o===void 0?null:o;var m=c.memoizedState;return m!==null&&o!==null&&yh(o,m[1])?m[0]:(c.memoizedState=[i,o],i)}function eg(i,o){var c=Nr();o=o===void 0?null:o;var m=c.memoizedState;return m!==null&&o!==null&&yh(o,m[1])?m[0]:(i=i(),c.memoizedState=[i,o],i)}function tg(i,o,c){return(yo&21)===0?(i.baseState&&(i.baseState=!1,or=!0),i.memoizedState=c):(rr(c,o)||(c=Xs(),Vt.lanes|=c,wo|=c,i.baseState=!0),o)}function Ww(i,o){var c=gt;gt=c!==0&&4>c?c:4,i(!0);var m=bh.transition;bh.transition={};try{i(!1),o()}finally{gt=c,bh.transition=m}}function ng(){return Nr().memoizedState}function zw(i,o,c){var m=xa(i);if(c={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null},rg(i))ig(o,c);else if(c=Lm(i,o,c,m),c!==null){var b=Wn();ri(c,i,m,b),ag(c,o,m)}}function Gw(i,o,c){var m=xa(i),b={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null};if(rg(i))ig(o,b);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var _=o.lastRenderedState,N=w(_,c);if(b.hasEagerState=!0,b.eagerState=N,rr(N,_)){var H=o.interleaved;H===null?(b.next=b,hh(o)):(b.next=H.next,H.next=b),o.interleaved=b;return}}catch{}finally{}c=Lm(i,o,b,m),c!==null&&(b=Wn(),ri(c,i,m,b),ag(c,o,m))}}function rg(i){var o=i.alternate;return i===Vt||o!==null&&o===Vt}function ig(i,o){xl=lu=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function ag(i,o,c){if((c&4194240)!==0){var m=o.lanes;m&=i.pendingLanes,c|=m,o.lanes=c,Ja(i,c)}}var du={readContext:Lr,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},$w={readContext:Lr,useCallback:function(i,o){return Ci().memoizedState=[i,o===void 0?null:o],i},useContext:Lr,useEffect:Km,useImperativeHandle:function(i,o,c){return c=c!=null?c.concat([i]):null,cu(4194308,4,Xm.bind(null,o,i),c)},useLayoutEffect:function(i,o){return cu(4194308,4,i,o)},useInsertionEffect:function(i,o){return cu(4,2,i,o)},useMemo:function(i,o){var c=Ci();return o=o===void 0?null:o,i=i(),c.memoizedState=[i,o],i},useReducer:function(i,o,c){var m=Ci();return o=c!==void 0?c(o):o,m.memoizedState=m.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},m.queue=i,i=i.dispatch=zw.bind(null,Vt,i),[m.memoizedState,i]},useRef:function(i){var o=Ci();return i={current:i},o.memoizedState=i},useState:Gm,useDebugValue:xh,useDeferredValue:function(i){return Ci().memoizedState=i},useTransition:function(){var i=Gm(!1),o=i[0];return i=Ww.bind(null,i[1]),Ci().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,c){var m=Vt,b=Ci();if(jt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=o(),fn===null)throw Error(t(349));(yo&30)!==0||Vm(m,o,c)}b.memoizedState=c;var w={value:c,getSnapshot:o};return b.queue=w,Km(qm.bind(null,m,w,i),[i]),m.flags|=2048,Pl(9,Hm.bind(null,m,w,c,o),void 0,null),c},useId:function(){var i=Ci(),o=fn.identifierPrefix;if(jt){var c=zi,m=Wi;c=(m&~(1<<32-kn(m)-1)).toString(32)+c,o=":"+o+"R"+c,c=El++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=qw++,o=":"+o+"r"+c.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},Kw={readContext:Lr,useCallback:Zm,useContext:Lr,useEffect:Th,useImperativeHandle:Qm,useInsertionEffect:Jm,useLayoutEffect:Ym,useMemo:eg,useReducer:Ch,useRef:$m,useState:function(){return Ch(_l)},useDebugValue:xh,useDeferredValue:function(i){var o=Nr();return tg(o,on.memoizedState,i)},useTransition:function(){var i=Ch(_l)[0],o=Nr().memoizedState;return[i,o]},useMutableSource:Um,useSyncExternalStore:Bm,useId:ng,unstable_isNewReconciler:!1},Jw={readContext:Lr,useCallback:Zm,useContext:Lr,useEffect:Th,useImperativeHandle:Qm,useInsertionEffect:Jm,useLayoutEffect:Ym,useMemo:eg,useReducer:Sh,useRef:$m,useState:function(){return Sh(_l)},useDebugValue:xh,useDeferredValue:function(i){var o=Nr();return on===null?o.memoizedState=i:tg(o,on.memoizedState,i)},useTransition:function(){var i=Sh(_l)[0],o=Nr().memoizedState;return[i,o]},useMutableSource:Um,useSyncExternalStore:Bm,useId:ng,unstable_isNewReconciler:!1};function ei(i,o){if(i&&i.defaultProps){o=ke({},o),i=i.defaultProps;for(var c in i)o[c]===void 0&&(o[c]=i[c]);return o}return o}function Eh(i,o,c,m){o=i.memoizedState,c=c(m,o),c=c==null?o:ke({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var hu={isMounted:function(i){return(i=i._reactInternals)?di(i)===i:!1},enqueueSetState:function(i,o,c){i=i._reactInternals;var m=Wn(),b=xa(i),w=$i(m,b);w.payload=o,c!=null&&(w.callback=c),o=ka(i,w,b),o!==null&&(ri(o,i,b,m),iu(o,i,b))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var m=Wn(),b=xa(i),w=$i(m,b);w.tag=1,w.payload=o,c!=null&&(w.callback=c),o=ka(i,w,b),o!==null&&(ri(o,i,b,m),iu(o,i,b))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=Wn(),m=xa(i),b=$i(c,m);b.tag=2,o!=null&&(b.callback=o),o=ka(i,b,m),o!==null&&(ri(o,i,m,c),iu(o,i,m))}};function og(i,o,c,m,b,w,_){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,w,_):o.prototype&&o.prototype.isPureReactComponent?!ma(c,m)||!ma(b,w):!0}function sg(i,o,c){var m=!1,b=ba,w=o.contextType;return typeof w=="object"&&w!==null?w=Lr(w):(b=ar(o)?fo:Ln.current,m=o.contextTypes,w=(m=m!=null)?hs(i,b):ba),o=new o(c,w),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=hu,i.stateNode=o,o._reactInternals=i,m&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=b,i.__reactInternalMemoizedMaskedChildContext=w),o}function lg(i,o,c,m){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,m),o.state!==i&&hu.enqueueReplaceState(o,o.state,null)}function _h(i,o,c,m){var b=i.stateNode;b.props=c,b.state=i.memoizedState,b.refs={},ph(i);var w=o.contextType;typeof w=="object"&&w!==null?b.context=Lr(w):(w=ar(o)?fo:Ln.current,b.context=hs(i,w)),b.state=i.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Eh(i,o,w,c),b.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(o=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),o!==b.state&&hu.enqueueReplaceState(b,b.state,null),au(i,c,b,m),b.state=i.memoizedState),typeof b.componentDidMount=="function"&&(i.flags|=4194308)}function ws(i,o){try{var c="",m=o;do c+=Ue(m),m=m.return;while(m);var b=c}catch(w){b=`
Error generating stack: `+w.message+`
`+w.stack}return{value:i,source:o,stack:b,digest:null}}function Ph(i,o,c){return{value:i,source:null,stack:c??null,digest:o??null}}function Rh(i,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var Yw=typeof WeakMap=="function"?WeakMap:Map;function cg(i,o,c){c=$i(-1,c),c.tag=3,c.payload={element:null};var m=o.value;return c.callback=function(){yu||(yu=!0,qh=m),Rh(i,o)},c}function ug(i,o,c){c=$i(-1,c),c.tag=3;var m=i.type.getDerivedStateFromError;if(typeof m=="function"){var b=o.value;c.payload=function(){return m(b)},c.callback=function(){Rh(i,o)}}var w=i.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(c.callback=function(){Rh(i,o),typeof m!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var _=o.stack;this.componentDidCatch(o.value,{componentStack:_!==null?_:""})}),c}function dg(i,o,c){var m=i.pingCache;if(m===null){m=i.pingCache=new Yw;var b=new Set;m.set(o,b)}else b=m.get(o),b===void 0&&(b=new Set,m.set(o,b));b.has(c)||(b.add(c),i=uk.bind(null,i,o,c),o.then(i,i))}function hg(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function pg(i,o,c,m,b){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=$i(-1,1),o.tag=2,ka(c,o,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=b,i)}var Xw=O.ReactCurrentOwner,or=!1;function qn(i,o,c,m){o.child=i===null?Am(o,null,c,m):gs(o,i.child,c,m)}function fg(i,o,c,m,b){c=c.render;var w=o.ref;return bs(o,b),m=wh(i,o,c,m,w,b),c=kh(),i!==null&&!or?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~b,Ki(i,o,b)):(jt&&c&&rh(o),o.flags|=1,qn(i,o,m,b),o.child)}function mg(i,o,c,m,b){if(i===null){var w=c.type;return typeof w=="function"&&!Yh(w)&&w.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=w,gg(i,o,w,m,b)):(i=xu(c.type,null,m,o,o.mode,b),i.ref=o.ref,i.return=o,o.child=i)}if(w=i.child,(i.lanes&b)===0){var _=w.memoizedProps;if(c=c.compare,c=c!==null?c:ma,c(_,m)&&i.ref===o.ref)return Ki(i,o,b)}return o.flags|=1,i=_a(w,m),i.ref=o.ref,i.return=o,o.child=i}function gg(i,o,c,m,b){if(i!==null){var w=i.memoizedProps;if(ma(w,m)&&i.ref===o.ref)if(or=!1,o.pendingProps=m=w,(i.lanes&b)!==0)(i.flags&131072)!==0&&(or=!0);else return o.lanes=i.lanes,Ki(i,o,b)}return Ih(i,o,c,m,b)}function vg(i,o,c){var m=o.pendingProps,b=m.children,w=i!==null?i.memoizedState:null;if(m.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mt(Cs,kr),kr|=c;else{if((c&1073741824)===0)return i=w!==null?w.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Mt(Cs,kr),kr|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:c,Mt(Cs,kr),kr|=m}else w!==null?(m=w.baseLanes|c,o.memoizedState=null):m=c,Mt(Cs,kr),kr|=m;return qn(i,o,b,c),o.child}function bg(i,o){var c=o.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function Ih(i,o,c,m,b){var w=ar(c)?fo:Ln.current;return w=hs(o,w),bs(o,b),c=wh(i,o,c,m,w,b),m=kh(),i!==null&&!or?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~b,Ki(i,o,b)):(jt&&m&&rh(o),o.flags|=1,qn(i,o,c,b),o.child)}function yg(i,o,c,m,b){if(ar(c)){var w=!0;Yc(o)}else w=!1;if(bs(o,b),o.stateNode===null)fu(i,o),sg(o,c,m),_h(o,c,m,b),m=!0;else if(i===null){var _=o.stateNode,N=o.memoizedProps;_.props=N;var H=_.context,oe=c.contextType;typeof oe=="object"&&oe!==null?oe=Lr(oe):(oe=ar(c)?fo:Ln.current,oe=hs(o,oe));var we=c.getDerivedStateFromProps,Ce=typeof we=="function"||typeof _.getSnapshotBeforeUpdate=="function";Ce||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(N!==m||H!==oe)&&lg(o,_,m,oe),wa=!1;var ye=o.memoizedState;_.state=ye,au(o,m,_,b),H=o.memoizedState,N!==m||ye!==H||ir.current||wa?(typeof we=="function"&&(Eh(o,c,we,m),H=o.memoizedState),(N=wa||og(o,c,N,m,ye,H,oe))?(Ce||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(o.flags|=4194308)):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=H),_.props=m,_.state=H,_.context=oe,m=N):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{_=o.stateNode,Nm(i,o),N=o.memoizedProps,oe=o.type===o.elementType?N:ei(o.type,N),_.props=oe,Ce=o.pendingProps,ye=_.context,H=c.contextType,typeof H=="object"&&H!==null?H=Lr(H):(H=ar(c)?fo:Ln.current,H=hs(o,H));var Be=c.getDerivedStateFromProps;(we=typeof Be=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(N!==Ce||ye!==H)&&lg(o,_,m,H),wa=!1,ye=o.memoizedState,_.state=ye,au(o,m,_,b);var qe=o.memoizedState;N!==Ce||ye!==qe||ir.current||wa?(typeof Be=="function"&&(Eh(o,c,Be,m),qe=o.memoizedState),(oe=wa||og(o,c,oe,m,ye,qe,H)||!1)?(we||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(m,qe,H),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(m,qe,H)),typeof _.componentDidUpdate=="function"&&(o.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof _.componentDidUpdate!="function"||N===i.memoizedProps&&ye===i.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||N===i.memoizedProps&&ye===i.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=qe),_.props=m,_.state=qe,_.context=H,m=oe):(typeof _.componentDidUpdate!="function"||N===i.memoizedProps&&ye===i.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||N===i.memoizedProps&&ye===i.memoizedState||(o.flags|=1024),m=!1)}return Mh(i,o,c,m,w,b)}function Mh(i,o,c,m,b,w){bg(i,o);var _=(o.flags&128)!==0;if(!m&&!_)return b&&Tm(o,c,!1),Ki(i,o,w);m=o.stateNode,Xw.current=o;var N=_&&typeof c.getDerivedStateFromError!="function"?null:m.render();return o.flags|=1,i!==null&&_?(o.child=gs(o,i.child,null,w),o.child=gs(o,null,N,w)):qn(i,o,N,w),o.memoizedState=m.state,b&&Tm(o,c,!0),o.child}function wg(i){var o=i.stateNode;o.pendingContext?Cm(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Cm(i,o.context,!1),fh(i,o.containerInfo)}function kg(i,o,c,m,b){return ms(),sh(b),o.flags|=256,qn(i,o,c,m),o.child}var Oh={dehydrated:null,treeContext:null,retryLane:0};function Ah(i){return{baseLanes:i,cachePool:null,transitions:null}}function Cg(i,o,c){var m=o.pendingProps,b=Bt.current,w=!1,_=(o.flags&128)!==0,N;if((N=_)||(N=i!==null&&i.memoizedState===null?!1:(b&2)!==0),N?(w=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(b|=1),Mt(Bt,b&1),i===null)return oh(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(_=m.children,i=m.fallback,w?(m=o.mode,w=o.child,_={mode:"hidden",children:_},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=_):w=Eu(_,m,0,null),i=To(i,m,c,null),w.return=o,i.return=o,w.sibling=i,o.child=w,o.child.memoizedState=Ah(c),o.memoizedState=Oh,i):Lh(o,_));if(b=i.memoizedState,b!==null&&(N=b.dehydrated,N!==null))return Qw(i,o,_,m,N,b,c);if(w){w=m.fallback,_=o.mode,b=i.child,N=b.sibling;var H={mode:"hidden",children:m.children};return(_&1)===0&&o.child!==b?(m=o.child,m.childLanes=0,m.pendingProps=H,o.deletions=null):(m=_a(b,H),m.subtreeFlags=b.subtreeFlags&14680064),N!==null?w=_a(N,w):(w=To(w,_,c,null),w.flags|=2),w.return=o,m.return=o,m.sibling=w,o.child=m,m=w,w=o.child,_=i.child.memoizedState,_=_===null?Ah(c):{baseLanes:_.baseLanes|c,cachePool:null,transitions:_.transitions},w.memoizedState=_,w.childLanes=i.childLanes&~c,o.memoizedState=Oh,m}return w=i.child,i=w.sibling,m=_a(w,{mode:"visible",children:m.children}),(o.mode&1)===0&&(m.lanes=c),m.return=o,m.sibling=null,i!==null&&(c=o.deletions,c===null?(o.deletions=[i],o.flags|=16):c.push(i)),o.child=m,o.memoizedState=null,m}function Lh(i,o){return o=Eu({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function pu(i,o,c,m){return m!==null&&sh(m),gs(o,i.child,null,c),i=Lh(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Qw(i,o,c,m,b,w,_){if(c)return o.flags&256?(o.flags&=-257,m=Ph(Error(t(422))),pu(i,o,_,m)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(w=m.fallback,b=o.mode,m=Eu({mode:"visible",children:m.children},b,0,null),w=To(w,b,_,null),w.flags|=2,m.return=o,w.return=o,m.sibling=w,o.child=m,(o.mode&1)!==0&&gs(o,i.child,null,_),o.child.memoizedState=Ah(_),o.memoizedState=Oh,w);if((o.mode&1)===0)return pu(i,o,_,null);if(b.data==="$!"){if(m=b.nextSibling&&b.nextSibling.dataset,m)var N=m.dgst;return m=N,w=Error(t(419)),m=Ph(w,m,void 0),pu(i,o,_,m)}if(N=(_&i.childLanes)!==0,or||N){if(m=fn,m!==null){switch(_&-_){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(m.suspendedLanes|_))!==0?0:b,b!==0&&b!==w.retryLane&&(w.retryLane=b,Gi(i,b),ri(m,i,b,-1))}return Jh(),m=Ph(Error(t(421))),pu(i,o,_,m)}return b.data==="$?"?(o.flags|=128,o.child=i.child,o=dk.bind(null,i),b._reactRetry=o,null):(i=w.treeContext,wr=ga(b.nextSibling),yr=o,jt=!0,Zr=null,i!==null&&(Or[Ar++]=Wi,Or[Ar++]=zi,Or[Ar++]=mo,Wi=i.id,zi=i.overflow,mo=o),o=Lh(o,m.children),o.flags|=4096,o)}function Sg(i,o,c){i.lanes|=o;var m=i.alternate;m!==null&&(m.lanes|=o),dh(i.return,o,c)}function Nh(i,o,c,m,b){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:b}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=c,w.tailMode=b)}function Tg(i,o,c){var m=o.pendingProps,b=m.revealOrder,w=m.tail;if(qn(i,o,m.children,c),m=Bt.current,(m&2)!==0)m=m&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Sg(i,c,o);else if(i.tag===19)Sg(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}m&=1}if(Mt(Bt,m),(o.mode&1)===0)o.memoizedState=null;else switch(b){case"forwards":for(c=o.child,b=null;c!==null;)i=c.alternate,i!==null&&ou(i)===null&&(b=c),c=c.sibling;c=b,c===null?(b=o.child,o.child=null):(b=c.sibling,c.sibling=null),Nh(o,!1,b,c,w);break;case"backwards":for(c=null,b=o.child,o.child=null;b!==null;){if(i=b.alternate,i!==null&&ou(i)===null){o.child=b;break}i=b.sibling,b.sibling=c,c=b,b=i}Nh(o,!0,c,null,w);break;case"together":Nh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function fu(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Ki(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),wo|=o.lanes,(c&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,c=_a(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=_a(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function Zw(i,o,c){switch(o.tag){case 3:wg(o),ms();break;case 5:Fm(o);break;case 1:ar(o.type)&&Yc(o);break;case 4:fh(o,o.stateNode.containerInfo);break;case 10:var m=o.type._context,b=o.memoizedProps.value;Mt(nu,m._currentValue),m._currentValue=b;break;case 13:if(m=o.memoizedState,m!==null)return m.dehydrated!==null?(Mt(Bt,Bt.current&1),o.flags|=128,null):(c&o.child.childLanes)!==0?Cg(i,o,c):(Mt(Bt,Bt.current&1),i=Ki(i,o,c),i!==null?i.sibling:null);Mt(Bt,Bt.current&1);break;case 19:if(m=(c&o.childLanes)!==0,(i.flags&128)!==0){if(m)return Tg(i,o,c);o.flags|=128}if(b=o.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Mt(Bt,Bt.current),m)break;return null;case 22:case 23:return o.lanes=0,vg(i,o,c)}return Ki(i,o,c)}var xg,jh,Eg,_g;xg=function(i,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},jh=function(){},Eg=function(i,o,c,m){var b=i.memoizedProps;if(b!==m){i=o.stateNode,bo(ki.current);var w=null;switch(c){case"input":b=Sr(i,b),m=Sr(i,m),w=[];break;case"select":b=ke({},b,{value:void 0}),m=ke({},m,{value:void 0}),w=[];break;case"textarea":b=Ni(i,b),m=Ni(i,m),w=[];break;default:typeof b.onClick!="function"&&typeof m.onClick=="function"&&(i.onclick=$c)}zt(c,m);var _;c=null;for(oe in b)if(!m.hasOwnProperty(oe)&&b.hasOwnProperty(oe)&&b[oe]!=null)if(oe==="style"){var N=b[oe];for(_ in N)N.hasOwnProperty(_)&&(c||(c={}),c[_]="")}else oe!=="dangerouslySetInnerHTML"&&oe!=="children"&&oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&oe!=="autoFocus"&&(a.hasOwnProperty(oe)?w||(w=[]):(w=w||[]).push(oe,null));for(oe in m){var H=m[oe];if(N=b!=null?b[oe]:void 0,m.hasOwnProperty(oe)&&H!==N&&(H!=null||N!=null))if(oe==="style")if(N){for(_ in N)!N.hasOwnProperty(_)||H&&H.hasOwnProperty(_)||(c||(c={}),c[_]="");for(_ in H)H.hasOwnProperty(_)&&N[_]!==H[_]&&(c||(c={}),c[_]=H[_])}else c||(w||(w=[]),w.push(oe,c)),c=H;else oe==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,N=N?N.__html:void 0,H!=null&&N!==H&&(w=w||[]).push(oe,H)):oe==="children"?typeof H!="string"&&typeof H!="number"||(w=w||[]).push(oe,""+H):oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&(a.hasOwnProperty(oe)?(H!=null&&oe==="onScroll"&&Lt("scroll",i),w||N===H||(w=[])):(w=w||[]).push(oe,H))}c&&(w=w||[]).push("style",c);var oe=w;(o.updateQueue=oe)&&(o.flags|=4)}},_g=function(i,o,c,m){c!==m&&(o.flags|=4)};function Rl(i,o){if(!jt)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function jn(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,m=0;if(o)for(var b=i.child;b!==null;)c|=b.lanes|b.childLanes,m|=b.subtreeFlags&14680064,m|=b.flags&14680064,b.return=i,b=b.sibling;else for(b=i.child;b!==null;)c|=b.lanes|b.childLanes,m|=b.subtreeFlags,m|=b.flags,b.return=i,b=b.sibling;return i.subtreeFlags|=m,i.childLanes=c,o}function ek(i,o,c){var m=o.pendingProps;switch(ih(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(o),null;case 1:return ar(o.type)&&Jc(),jn(o),null;case 3:return m=o.stateNode,ys(),Nt(ir),Nt(Ln),vh(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(i===null||i.child===null)&&(eu(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Zr!==null&&(Gh(Zr),Zr=null))),jh(i,o),jn(o),null;case 5:mh(o);var b=bo(Tl.current);if(c=o.type,i!==null&&o.stateNode!=null)Eg(i,o,c,m,b),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!m){if(o.stateNode===null)throw Error(t(166));return jn(o),null}if(i=bo(ki.current),eu(o)){m=o.stateNode,c=o.type;var w=o.memoizedProps;switch(m[wi]=o,m[yl]=w,i=(o.mode&1)!==0,c){case"dialog":Lt("cancel",m),Lt("close",m);break;case"iframe":case"object":case"embed":Lt("load",m);break;case"video":case"audio":for(b=0;b<Vi.length;b++)Lt(Vi[b],m);break;case"source":Lt("error",m);break;case"img":case"image":case"link":Lt("error",m),Lt("load",m);break;case"details":Lt("toggle",m);break;case"input":Tr(m,w),Lt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},Lt("invalid",m);break;case"textarea":Bo(m,w),Lt("invalid",m)}zt(c,w),b=null;for(var _ in w)if(w.hasOwnProperty(_)){var N=w[_];_==="children"?typeof N=="string"?m.textContent!==N&&(w.suppressHydrationWarning!==!0&&Gc(m.textContent,N,i),b=["children",N]):typeof N=="number"&&m.textContent!==""+N&&(w.suppressHydrationWarning!==!0&&Gc(m.textContent,N,i),b=["children",""+N]):a.hasOwnProperty(_)&&N!=null&&_==="onScroll"&&Lt("scroll",m)}switch(c){case"input":Wt(m),Uo(m,w,!0);break;case"textarea":Wt(m),y(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=$c)}m=b,o.updateQueue=m,m!==null&&(o.flags|=4)}else{_=b.nodeType===9?b:b.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=S(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=_.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof m.is=="string"?i=_.createElement(c,{is:m.is}):(i=_.createElement(c),c==="select"&&(_=i,m.multiple?_.multiple=!0:m.size&&(_.size=m.size))):i=_.createElementNS(i,c),i[wi]=o,i[yl]=m,xg(i,o,!1,!1),o.stateNode=i;e:{switch(_=xt(c,m),c){case"dialog":Lt("cancel",i),Lt("close",i),b=m;break;case"iframe":case"object":case"embed":Lt("load",i),b=m;break;case"video":case"audio":for(b=0;b<Vi.length;b++)Lt(Vi[b],i);b=m;break;case"source":Lt("error",i),b=m;break;case"img":case"image":case"link":Lt("error",i),Lt("load",i),b=m;break;case"details":Lt("toggle",i),b=m;break;case"input":Tr(i,m),b=Sr(i,m),Lt("invalid",i);break;case"option":b=m;break;case"select":i._wrapperState={wasMultiple:!!m.multiple},b=ke({},m,{value:void 0}),Lt("invalid",i);break;case"textarea":Bo(i,m),b=Ni(i,m),Lt("invalid",i);break;default:b=m}zt(c,b),N=b;for(w in N)if(N.hasOwnProperty(w)){var H=N[w];w==="style"?st(i,H):w==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&ue(i,H)):w==="children"?typeof H=="string"?(c!=="textarea"||H!=="")&&be(i,H):typeof H=="number"&&be(i,""+H):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(a.hasOwnProperty(w)?H!=null&&w==="onScroll"&&Lt("scroll",i):H!=null&&F(i,w,H,_))}switch(c){case"input":Wt(i),Uo(i,m,!1);break;case"textarea":Wt(i),y(i);break;case"option":m.value!=null&&i.setAttribute("value",""+ze(m.value));break;case"select":i.multiple=!!m.multiple,w=m.value,w!=null?Un(i,!!m.multiple,w,!1):m.defaultValue!=null&&Un(i,!!m.multiple,m.defaultValue,!0);break;default:typeof b.onClick=="function"&&(i.onclick=$c)}switch(c){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return jn(o),null;case 6:if(i&&o.stateNode!=null)_g(i,o,i.memoizedProps,m);else{if(typeof m!="string"&&o.stateNode===null)throw Error(t(166));if(c=bo(Tl.current),bo(ki.current),eu(o)){if(m=o.stateNode,c=o.memoizedProps,m[wi]=o,(w=m.nodeValue!==c)&&(i=yr,i!==null))switch(i.tag){case 3:Gc(m.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Gc(m.nodeValue,c,(i.mode&1)!==0)}w&&(o.flags|=4)}else m=(c.nodeType===9?c:c.ownerDocument).createTextNode(m),m[wi]=o,o.stateNode=m}return jn(o),null;case 13:if(Nt(Bt),m=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(jt&&wr!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Im(),ms(),o.flags|=98560,w=!1;else if(w=eu(o),m!==null&&m.dehydrated!==null){if(i===null){if(!w)throw Error(t(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[wi]=o}else ms(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;jn(o),w=!1}else Zr!==null&&(Gh(Zr),Zr=null),w=!0;if(!w)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=c,o):(m=m!==null,m!==(i!==null&&i.memoizedState!==null)&&m&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(Bt.current&1)!==0?sn===0&&(sn=3):Jh())),o.updateQueue!==null&&(o.flags|=4),jn(o),null);case 4:return ys(),jh(i,o),i===null&&vl(o.stateNode.containerInfo),jn(o),null;case 10:return uh(o.type._context),jn(o),null;case 17:return ar(o.type)&&Jc(),jn(o),null;case 19:if(Nt(Bt),w=o.memoizedState,w===null)return jn(o),null;if(m=(o.flags&128)!==0,_=w.rendering,_===null)if(m)Rl(w,!1);else{if(sn!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(_=ou(i),_!==null){for(o.flags|=128,Rl(w,!1),m=_.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),o.subtreeFlags=0,m=c,c=o.child;c!==null;)w=c,i=m,w.flags&=14680066,_=w.alternate,_===null?(w.childLanes=0,w.lanes=i,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=_.childLanes,w.lanes=_.lanes,w.child=_.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=_.memoizedProps,w.memoizedState=_.memoizedState,w.updateQueue=_.updateQueue,w.type=_.type,i=_.dependencies,w.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return Mt(Bt,Bt.current&1|2),o.child}i=i.sibling}w.tail!==null&&Ut()>Ss&&(o.flags|=128,m=!0,Rl(w,!1),o.lanes=4194304)}else{if(!m)if(i=ou(_),i!==null){if(o.flags|=128,m=!0,c=i.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),Rl(w,!0),w.tail===null&&w.tailMode==="hidden"&&!_.alternate&&!jt)return jn(o),null}else 2*Ut()-w.renderingStartTime>Ss&&c!==1073741824&&(o.flags|=128,m=!0,Rl(w,!1),o.lanes=4194304);w.isBackwards?(_.sibling=o.child,o.child=_):(c=w.last,c!==null?c.sibling=_:o.child=_,w.last=_)}return w.tail!==null?(o=w.tail,w.rendering=o,w.tail=o.sibling,w.renderingStartTime=Ut(),o.sibling=null,c=Bt.current,Mt(Bt,m?c&1|2:c&1),o):(jn(o),null);case 22:case 23:return Kh(),m=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==m&&(o.flags|=8192),m&&(o.mode&1)!==0?(kr&1073741824)!==0&&(jn(o),o.subtreeFlags&6&&(o.flags|=8192)):jn(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function tk(i,o){switch(ih(o),o.tag){case 1:return ar(o.type)&&Jc(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return ys(),Nt(ir),Nt(Ln),vh(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return mh(o),null;case 13:if(Nt(Bt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));ms()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Nt(Bt),null;case 4:return ys(),null;case 10:return uh(o.type._context),null;case 22:case 23:return Kh(),null;case 24:return null;default:return null}}var mu=!1,Dn=!1,nk=typeof WeakSet=="function"?WeakSet:Set,He=null;function ks(i,o){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(m){Gt(i,o,m)}else c.current=null}function Pg(i,o,c){try{c()}catch(m){Gt(i,o,m)}}var Rg=!1;function rk(i,o){if(Jd=gr,i=gl(),d(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var b=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var _=0,N=-1,H=-1,oe=0,we=0,Ce=i,ye=null;t:for(;;){for(var Be;Ce!==c||b!==0&&Ce.nodeType!==3||(N=_+b),Ce!==w||m!==0&&Ce.nodeType!==3||(H=_+m),Ce.nodeType===3&&(_+=Ce.nodeValue.length),(Be=Ce.firstChild)!==null;)ye=Ce,Ce=Be;for(;;){if(Ce===i)break t;if(ye===c&&++oe===b&&(N=_),ye===w&&++we===m&&(H=_),(Be=Ce.nextSibling)!==null)break;Ce=ye,ye=Ce.parentNode}Ce=Be}c=N===-1||H===-1?null:{start:N,end:H}}else c=null}c=c||{start:0,end:0}}else c=null;for(Yd={focusedElem:i,selectionRange:c},gr=!1,He=o;He!==null;)if(o=He,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,He=i;else for(;He!==null;){o=He;try{var qe=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(qe!==null){var We=qe.memoizedProps,Qt=qe.memoizedState,ee=o.stateNode,q=ee.getSnapshotBeforeUpdate(o.elementType===o.type?We:ei(o.type,We),Qt);ee.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var re=o.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Pe){Gt(o,o.return,Pe)}if(i=o.sibling,i!==null){i.return=o.return,He=i;break}He=o.return}return qe=Rg,Rg=!1,qe}function Il(i,o,c){var m=o.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var b=m=m.next;do{if((b.tag&i)===i){var w=b.destroy;b.destroy=void 0,w!==void 0&&Pg(o,c,w)}b=b.next}while(b!==m)}}function gu(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&i)===i){var m=c.create;c.destroy=m()}c=c.next}while(c!==o)}}function Dh(i){var o=i.ref;if(o!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof o=="function"?o(i):o.current=i}}function Ig(i){var o=i.alternate;o!==null&&(i.alternate=null,Ig(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[wi],delete o[yl],delete o[eh],delete o[Uw],delete o[Bw])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Mg(i){return i.tag===5||i.tag===3||i.tag===4}function Og(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Mg(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Fh(i,o,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(i,o):c.insertBefore(i,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(i,c)):(o=c,o.appendChild(i)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=$c));else if(m!==4&&(i=i.child,i!==null))for(Fh(i,o,c),i=i.sibling;i!==null;)Fh(i,o,c),i=i.sibling}function Uh(i,o,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(m!==4&&(i=i.child,i!==null))for(Uh(i,o,c),i=i.sibling;i!==null;)Uh(i,o,c),i=i.sibling}var Sn=null,ti=!1;function Ca(i,o,c){for(c=c.child;c!==null;)Ag(i,o,c),c=c.sibling}function Ag(i,o,c){if(Rn&&typeof Rn.onCommitFiberUnmount=="function")try{Rn.onCommitFiberUnmount(_r,c)}catch{}switch(c.tag){case 5:Dn||ks(c,o);case 6:var m=Sn,b=ti;Sn=null,Ca(i,o,c),Sn=m,ti=b,Sn!==null&&(ti?(i=Sn,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):Sn.removeChild(c.stateNode));break;case 18:Sn!==null&&(ti?(i=Sn,c=c.stateNode,i.nodeType===8?Zd(i.parentNode,c):i.nodeType===1&&Zd(i,c),Mn(i)):Zd(Sn,c.stateNode));break;case 4:m=Sn,b=ti,Sn=c.stateNode.containerInfo,ti=!0,Ca(i,o,c),Sn=m,ti=b;break;case 0:case 11:case 14:case 15:if(!Dn&&(m=c.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){b=m=m.next;do{var w=b,_=w.destroy;w=w.tag,_!==void 0&&((w&2)!==0||(w&4)!==0)&&Pg(c,o,_),b=b.next}while(b!==m)}Ca(i,o,c);break;case 1:if(!Dn&&(ks(c,o),m=c.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=c.memoizedProps,m.state=c.memoizedState,m.componentWillUnmount()}catch(N){Gt(c,o,N)}Ca(i,o,c);break;case 21:Ca(i,o,c);break;case 22:c.mode&1?(Dn=(m=Dn)||c.memoizedState!==null,Ca(i,o,c),Dn=m):Ca(i,o,c);break;default:Ca(i,o,c)}}function Lg(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new nk),o.forEach(function(m){var b=hk.bind(null,i,m);c.has(m)||(c.add(m),m.then(b,b))})}}function ni(i,o){var c=o.deletions;if(c!==null)for(var m=0;m<c.length;m++){var b=c[m];try{var w=i,_=o,N=_;e:for(;N!==null;){switch(N.tag){case 5:Sn=N.stateNode,ti=!1;break e;case 3:Sn=N.stateNode.containerInfo,ti=!0;break e;case 4:Sn=N.stateNode.containerInfo,ti=!0;break e}N=N.return}if(Sn===null)throw Error(t(160));Ag(w,_,b),Sn=null,ti=!1;var H=b.alternate;H!==null&&(H.return=null),b.return=null}catch(oe){Gt(b,o,oe)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Ng(o,i),o=o.sibling}function Ng(i,o){var c=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ni(o,i),Si(i),m&4){try{Il(3,i,i.return),gu(3,i)}catch(We){Gt(i,i.return,We)}try{Il(5,i,i.return)}catch(We){Gt(i,i.return,We)}}break;case 1:ni(o,i),Si(i),m&512&&c!==null&&ks(c,c.return);break;case 5:if(ni(o,i),Si(i),m&512&&c!==null&&ks(c,c.return),i.flags&32){var b=i.stateNode;try{be(b,"")}catch(We){Gt(i,i.return,We)}}if(m&4&&(b=i.stateNode,b!=null)){var w=i.memoizedProps,_=c!==null?c.memoizedProps:w,N=i.type,H=i.updateQueue;if(i.updateQueue=null,H!==null)try{N==="input"&&w.type==="radio"&&w.name!=null&&oa(b,w),xt(N,_);var oe=xt(N,w);for(_=0;_<H.length;_+=2){var we=H[_],Ce=H[_+1];we==="style"?st(b,Ce):we==="dangerouslySetInnerHTML"?ue(b,Ce):we==="children"?be(b,Ce):F(b,we,Ce,oe)}switch(N){case"input":Ai(b,w);break;case"textarea":P(b,w);break;case"select":var ye=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!w.multiple;var Be=w.value;Be!=null?Un(b,!!w.multiple,Be,!1):ye!==!!w.multiple&&(w.defaultValue!=null?Un(b,!!w.multiple,w.defaultValue,!0):Un(b,!!w.multiple,w.multiple?[]:"",!1))}b[yl]=w}catch(We){Gt(i,i.return,We)}}break;case 6:if(ni(o,i),Si(i),m&4){if(i.stateNode===null)throw Error(t(162));b=i.stateNode,w=i.memoizedProps;try{b.nodeValue=w}catch(We){Gt(i,i.return,We)}}break;case 3:if(ni(o,i),Si(i),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Mn(o.containerInfo)}catch(We){Gt(i,i.return,We)}break;case 4:ni(o,i),Si(i);break;case 13:ni(o,i),Si(i),b=i.child,b.flags&8192&&(w=b.memoizedState!==null,b.stateNode.isHidden=w,!w||b.alternate!==null&&b.alternate.memoizedState!==null||(Hh=Ut())),m&4&&Lg(i);break;case 22:if(we=c!==null&&c.memoizedState!==null,i.mode&1?(Dn=(oe=Dn)||we,ni(o,i),Dn=oe):ni(o,i),Si(i),m&8192){if(oe=i.memoizedState!==null,(i.stateNode.isHidden=oe)&&!we&&(i.mode&1)!==0)for(He=i,we=i.child;we!==null;){for(Ce=He=we;He!==null;){switch(ye=He,Be=ye.child,ye.tag){case 0:case 11:case 14:case 15:Il(4,ye,ye.return);break;case 1:ks(ye,ye.return);var qe=ye.stateNode;if(typeof qe.componentWillUnmount=="function"){m=ye,c=ye.return;try{o=m,qe.props=o.memoizedProps,qe.state=o.memoizedState,qe.componentWillUnmount()}catch(We){Gt(m,c,We)}}break;case 5:ks(ye,ye.return);break;case 22:if(ye.memoizedState!==null){Fg(Ce);continue}}Be!==null?(Be.return=ye,He=Be):Fg(Ce)}we=we.sibling}e:for(we=null,Ce=i;;){if(Ce.tag===5){if(we===null){we=Ce;try{b=Ce.stateNode,oe?(w=b.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(N=Ce.stateNode,H=Ce.memoizedProps.style,_=H!=null&&H.hasOwnProperty("display")?H.display:null,N.style.display=De("display",_))}catch(We){Gt(i,i.return,We)}}}else if(Ce.tag===6){if(we===null)try{Ce.stateNode.nodeValue=oe?"":Ce.memoizedProps}catch(We){Gt(i,i.return,We)}}else if((Ce.tag!==22&&Ce.tag!==23||Ce.memoizedState===null||Ce===i)&&Ce.child!==null){Ce.child.return=Ce,Ce=Ce.child;continue}if(Ce===i)break e;for(;Ce.sibling===null;){if(Ce.return===null||Ce.return===i)break e;we===Ce&&(we=null),Ce=Ce.return}we===Ce&&(we=null),Ce.sibling.return=Ce.return,Ce=Ce.sibling}}break;case 19:ni(o,i),Si(i),m&4&&Lg(i);break;case 21:break;default:ni(o,i),Si(i)}}function Si(i){var o=i.flags;if(o&2){try{e:{for(var c=i.return;c!==null;){if(Mg(c)){var m=c;break e}c=c.return}throw Error(t(160))}switch(m.tag){case 5:var b=m.stateNode;m.flags&32&&(be(b,""),m.flags&=-33);var w=Og(i);Uh(i,w,b);break;case 3:case 4:var _=m.stateNode.containerInfo,N=Og(i);Fh(i,N,_);break;default:throw Error(t(161))}}catch(H){Gt(i,i.return,H)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function ik(i,o,c){He=i,jg(i)}function jg(i,o,c){for(var m=(i.mode&1)!==0;He!==null;){var b=He,w=b.child;if(b.tag===22&&m){var _=b.memoizedState!==null||mu;if(!_){var N=b.alternate,H=N!==null&&N.memoizedState!==null||Dn;N=mu;var oe=Dn;if(mu=_,(Dn=H)&&!oe)for(He=b;He!==null;)_=He,H=_.child,_.tag===22&&_.memoizedState!==null?Ug(b):H!==null?(H.return=_,He=H):Ug(b);for(;w!==null;)He=w,jg(w),w=w.sibling;He=b,mu=N,Dn=oe}Dg(i)}else(b.subtreeFlags&8772)!==0&&w!==null?(w.return=b,He=w):Dg(i)}}function Dg(i){for(;He!==null;){var o=He;if((o.flags&8772)!==0){var c=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Dn||gu(5,o);break;case 1:var m=o.stateNode;if(o.flags&4&&!Dn)if(c===null)m.componentDidMount();else{var b=o.elementType===o.type?c.memoizedProps:ei(o.type,c.memoizedProps);m.componentDidUpdate(b,c.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=o.updateQueue;w!==null&&Dm(o,w,m);break;case 3:var _=o.updateQueue;if(_!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}Dm(o,_,c)}break;case 5:var N=o.stateNode;if(c===null&&o.flags&4){c=N;var H=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&c.focus();break;case"img":H.src&&(c.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var oe=o.alternate;if(oe!==null){var we=oe.memoizedState;if(we!==null){var Ce=we.dehydrated;Ce!==null&&Mn(Ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Dn||o.flags&512&&Dh(o)}catch(ye){Gt(o,o.return,ye)}}if(o===i){He=null;break}if(c=o.sibling,c!==null){c.return=o.return,He=c;break}He=o.return}}function Fg(i){for(;He!==null;){var o=He;if(o===i){He=null;break}var c=o.sibling;if(c!==null){c.return=o.return,He=c;break}He=o.return}}function Ug(i){for(;He!==null;){var o=He;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{gu(4,o)}catch(H){Gt(o,c,H)}break;case 1:var m=o.stateNode;if(typeof m.componentDidMount=="function"){var b=o.return;try{m.componentDidMount()}catch(H){Gt(o,b,H)}}var w=o.return;try{Dh(o)}catch(H){Gt(o,w,H)}break;case 5:var _=o.return;try{Dh(o)}catch(H){Gt(o,_,H)}}}catch(H){Gt(o,o.return,H)}if(o===i){He=null;break}var N=o.sibling;if(N!==null){N.return=o.return,He=N;break}He=o.return}}var ak=Math.ceil,vu=O.ReactCurrentDispatcher,Bh=O.ReactCurrentOwner,jr=O.ReactCurrentBatchConfig,bt=0,fn=null,tn=null,Tn=0,kr=0,Cs=va(0),sn=0,Ml=null,wo=0,bu=0,Vh=0,Ol=null,sr=null,Hh=0,Ss=1/0,Ji=null,yu=!1,qh=null,Sa=null,wu=!1,Ta=null,ku=0,Al=0,Wh=null,Cu=-1,Su=0;function Wn(){return(bt&6)!==0?Ut():Cu!==-1?Cu:Cu=Ut()}function xa(i){return(i.mode&1)===0?1:(bt&2)!==0&&Tn!==0?Tn&-Tn:Hw.transition!==null?(Su===0&&(Su=Xs()),Su):(i=gt,i!==0||(i=window.event,i=i===void 0?16:Rc(i.type)),i)}function ri(i,o,c,m){if(50<Al)throw Al=0,Wh=null,Error(t(185));Et(i,c,m),((bt&2)===0||i!==fn)&&(i===fn&&((bt&2)===0&&(bu|=c),sn===4&&Ea(i,Tn)),lr(i,m),c===1&&bt===0&&(o.mode&1)===0&&(Ss=Ut()+500,Xc&&ya()))}function lr(i,o){var c=i.callbackNode;Rr(i,o);var m=rt(i,i===fn?Tn:0);if(m===0)c!==null&&tr(c),i.callbackNode=null,i.callbackPriority=0;else if(o=m&-m,i.callbackPriority!==o){if(c!=null&&tr(c),o===1)i.tag===0?Vw(Vg.bind(null,i)):xm(Vg.bind(null,i)),Dw(function(){(bt&6)===0&&ya()}),c=null;else{switch(Ir(m)){case 1:c=Go;break;case 4:c=Ys;break;case 16:c=za;break;case 536870912:c=$o;break;default:c=za}c=Jg(c,Bg.bind(null,i))}i.callbackPriority=o,i.callbackNode=c}}function Bg(i,o){if(Cu=-1,Su=0,(bt&6)!==0)throw Error(t(327));var c=i.callbackNode;if(Ts()&&i.callbackNode!==c)return null;var m=rt(i,i===fn?Tn:0);if(m===0)return null;if((m&30)!==0||(m&i.expiredLanes)!==0||o)o=Tu(i,m);else{o=m;var b=bt;bt|=2;var w=qg();(fn!==i||Tn!==o)&&(Ji=null,Ss=Ut()+500,Co(i,o));do try{lk();break}catch(N){Hg(i,N)}while(!0);ch(),vu.current=w,bt=b,tn!==null?o=0:(fn=null,Tn=0,o=sn)}if(o!==0){if(o===2&&(b=Yo(i),b!==0&&(m=b,o=zh(i,b))),o===1)throw c=Ml,Co(i,0),Ea(i,m),lr(i,Ut()),c;if(o===6)Ea(i,m);else{if(b=i.current.alternate,(m&30)===0&&!ok(b)&&(o=Tu(i,m),o===2&&(w=Yo(i),w!==0&&(m=w,o=zh(i,w))),o===1))throw c=Ml,Co(i,0),Ea(i,m),lr(i,Ut()),c;switch(i.finishedWork=b,i.finishedLanes=m,o){case 0:case 1:throw Error(t(345));case 2:So(i,sr,Ji);break;case 3:if(Ea(i,m),(m&130023424)===m&&(o=Hh+500-Ut(),10<o)){if(rt(i,0)!==0)break;if(b=i.suspendedLanes,(b&m)!==m){Wn(),i.pingedLanes|=i.suspendedLanes&b;break}i.timeoutHandle=Qd(So.bind(null,i,sr,Ji),o);break}So(i,sr,Ji);break;case 4:if(Ea(i,m),(m&4194240)===m)break;for(o=i.eventTimes,b=-1;0<m;){var _=31-kn(m);w=1<<_,_=o[_],_>b&&(b=_),m&=~w}if(m=b,m=Ut()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*ak(m/1960))-m,10<m){i.timeoutHandle=Qd(So.bind(null,i,sr,Ji),m);break}So(i,sr,Ji);break;case 5:So(i,sr,Ji);break;default:throw Error(t(329))}}}return lr(i,Ut()),i.callbackNode===c?Bg.bind(null,i):null}function zh(i,o){var c=Ol;return i.current.memoizedState.isDehydrated&&(Co(i,o).flags|=256),i=Tu(i,o),i!==2&&(o=sr,sr=c,o!==null&&Gh(o)),i}function Gh(i){sr===null?sr=i:sr.push.apply(sr,i)}function ok(i){for(var o=i;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var m=0;m<c.length;m++){var b=c[m],w=b.getSnapshot;b=b.value;try{if(!rr(w(),b))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ea(i,o){for(o&=~Vh,o&=~bu,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var c=31-kn(o),m=1<<c;i[c]=-1,o&=~m}}function Vg(i){if((bt&6)!==0)throw Error(t(327));Ts();var o=rt(i,0);if((o&1)===0)return lr(i,Ut()),null;var c=Tu(i,o);if(i.tag!==0&&c===2){var m=Yo(i);m!==0&&(o=m,c=zh(i,m))}if(c===1)throw c=Ml,Co(i,0),Ea(i,o),lr(i,Ut()),c;if(c===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,So(i,sr,Ji),lr(i,Ut()),null}function $h(i,o){var c=bt;bt|=1;try{return i(o)}finally{bt=c,bt===0&&(Ss=Ut()+500,Xc&&ya())}}function ko(i){Ta!==null&&Ta.tag===0&&(bt&6)===0&&Ts();var o=bt;bt|=1;var c=jr.transition,m=gt;try{if(jr.transition=null,gt=1,i)return i()}finally{gt=m,jr.transition=c,bt=o,(bt&6)===0&&ya()}}function Kh(){kr=Cs.current,Nt(Cs)}function Co(i,o){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,jw(c)),tn!==null)for(c=tn.return;c!==null;){var m=c;switch(ih(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Jc();break;case 3:ys(),Nt(ir),Nt(Ln),vh();break;case 5:mh(m);break;case 4:ys();break;case 13:Nt(Bt);break;case 19:Nt(Bt);break;case 10:uh(m.type._context);break;case 22:case 23:Kh()}c=c.return}if(fn=i,tn=i=_a(i.current,null),Tn=kr=o,sn=0,Ml=null,Vh=bu=wo=0,sr=Ol=null,vo!==null){for(o=0;o<vo.length;o++)if(c=vo[o],m=c.interleaved,m!==null){c.interleaved=null;var b=m.next,w=c.pending;if(w!==null){var _=w.next;w.next=b,m.next=_}c.pending=m}vo=null}return i}function Hg(i,o){do{var c=tn;try{if(ch(),su.current=du,lu){for(var m=Vt.memoizedState;m!==null;){var b=m.queue;b!==null&&(b.pending=null),m=m.next}lu=!1}if(yo=0,pn=on=Vt=null,xl=!1,El=0,Bh.current=null,c===null||c.return===null){sn=1,Ml=o,tn=null;break}e:{var w=i,_=c.return,N=c,H=o;if(o=Tn,N.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var oe=H,we=N,Ce=we.tag;if((we.mode&1)===0&&(Ce===0||Ce===11||Ce===15)){var ye=we.alternate;ye?(we.updateQueue=ye.updateQueue,we.memoizedState=ye.memoizedState,we.lanes=ye.lanes):(we.updateQueue=null,we.memoizedState=null)}var Be=hg(_);if(Be!==null){Be.flags&=-257,pg(Be,_,N,w,o),Be.mode&1&&dg(w,oe,o),o=Be,H=oe;var qe=o.updateQueue;if(qe===null){var We=new Set;We.add(H),o.updateQueue=We}else qe.add(H);break e}else{if((o&1)===0){dg(w,oe,o),Jh();break e}H=Error(t(426))}}else if(jt&&N.mode&1){var Qt=hg(_);if(Qt!==null){(Qt.flags&65536)===0&&(Qt.flags|=256),pg(Qt,_,N,w,o),sh(ws(H,N));break e}}w=H=ws(H,N),sn!==4&&(sn=2),Ol===null?Ol=[w]:Ol.push(w),w=_;do{switch(w.tag){case 3:w.flags|=65536,o&=-o,w.lanes|=o;var ee=cg(w,H,o);jm(w,ee);break e;case 1:N=H;var q=w.type,re=w.stateNode;if((w.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(Sa===null||!Sa.has(re)))){w.flags|=65536,o&=-o,w.lanes|=o;var Pe=ug(w,N,o);jm(w,Pe);break e}}w=w.return}while(w!==null)}zg(c)}catch(Ke){o=Ke,tn===c&&c!==null&&(tn=c=c.return);continue}break}while(!0)}function qg(){var i=vu.current;return vu.current=du,i===null?du:i}function Jh(){(sn===0||sn===3||sn===2)&&(sn=4),fn===null||(wo&268435455)===0&&(bu&268435455)===0||Ea(fn,Tn)}function Tu(i,o){var c=bt;bt|=2;var m=qg();(fn!==i||Tn!==o)&&(Ji=null,Co(i,o));do try{sk();break}catch(b){Hg(i,b)}while(!0);if(ch(),bt=c,vu.current=m,tn!==null)throw Error(t(261));return fn=null,Tn=0,sn}function sk(){for(;tn!==null;)Wg(tn)}function lk(){for(;tn!==null&&!Wo();)Wg(tn)}function Wg(i){var o=Kg(i.alternate,i,kr);i.memoizedProps=i.pendingProps,o===null?zg(i):tn=o,Bh.current=null}function zg(i){var o=i;do{var c=o.alternate;if(i=o.return,(o.flags&32768)===0){if(c=ek(c,o,kr),c!==null){tn=c;return}}else{if(c=tk(c,o),c!==null){c.flags&=32767,tn=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{sn=6,tn=null;return}}if(o=o.sibling,o!==null){tn=o;return}tn=o=i}while(o!==null);sn===0&&(sn=5)}function So(i,o,c){var m=gt,b=jr.transition;try{jr.transition=null,gt=1,ck(i,o,c,m)}finally{jr.transition=b,gt=m}return null}function ck(i,o,c,m){do Ts();while(Ta!==null);if((bt&6)!==0)throw Error(t(327));c=i.finishedWork;var b=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var w=c.lanes|c.childLanes;if(Ka(i,w),i===fn&&(tn=fn=null,Tn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||wu||(wu=!0,Jg(za,function(){return Ts(),null})),w=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||w){w=jr.transition,jr.transition=null;var _=gt;gt=1;var N=bt;bt|=4,Bh.current=null,rk(i,c),Ng(c,i),p(Yd),gr=!!Jd,Yd=Jd=null,i.current=c,ik(c),Js(),bt=N,gt=_,jr.transition=w}else i.current=c;if(wu&&(wu=!1,Ta=i,ku=b),w=i.pendingLanes,w===0&&(Sa=null),Ko(c.stateNode),lr(i,Ut()),o!==null)for(m=i.onRecoverableError,c=0;c<o.length;c++)b=o[c],m(b.value,{componentStack:b.stack,digest:b.digest});if(yu)throw yu=!1,i=qh,qh=null,i;return(ku&1)!==0&&i.tag!==0&&Ts(),w=i.pendingLanes,(w&1)!==0?i===Wh?Al++:(Al=0,Wh=i):Al=0,ya(),null}function Ts(){if(Ta!==null){var i=Ir(ku),o=jr.transition,c=gt;try{if(jr.transition=null,gt=16>i?16:i,Ta===null)var m=!1;else{if(i=Ta,Ta=null,ku=0,(bt&6)!==0)throw Error(t(331));var b=bt;for(bt|=4,He=i.current;He!==null;){var w=He,_=w.child;if((He.flags&16)!==0){var N=w.deletions;if(N!==null){for(var H=0;H<N.length;H++){var oe=N[H];for(He=oe;He!==null;){var we=He;switch(we.tag){case 0:case 11:case 15:Il(8,we,w)}var Ce=we.child;if(Ce!==null)Ce.return=we,He=Ce;else for(;He!==null;){we=He;var ye=we.sibling,Be=we.return;if(Ig(we),we===oe){He=null;break}if(ye!==null){ye.return=Be,He=ye;break}He=Be}}}var qe=w.alternate;if(qe!==null){var We=qe.child;if(We!==null){qe.child=null;do{var Qt=We.sibling;We.sibling=null,We=Qt}while(We!==null)}}He=w}}if((w.subtreeFlags&2064)!==0&&_!==null)_.return=w,He=_;else e:for(;He!==null;){if(w=He,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Il(9,w,w.return)}var ee=w.sibling;if(ee!==null){ee.return=w.return,He=ee;break e}He=w.return}}var q=i.current;for(He=q;He!==null;){_=He;var re=_.child;if((_.subtreeFlags&2064)!==0&&re!==null)re.return=_,He=re;else e:for(_=q;He!==null;){if(N=He,(N.flags&2048)!==0)try{switch(N.tag){case 0:case 11:case 15:gu(9,N)}}catch(Ke){Gt(N,N.return,Ke)}if(N===_){He=null;break e}var Pe=N.sibling;if(Pe!==null){Pe.return=N.return,He=Pe;break e}He=N.return}}if(bt=b,ya(),Rn&&typeof Rn.onPostCommitFiberRoot=="function")try{Rn.onPostCommitFiberRoot(_r,i)}catch{}m=!0}return m}finally{gt=c,jr.transition=o}}return!1}function Gg(i,o,c){o=ws(c,o),o=cg(i,o,1),i=ka(i,o,1),o=Wn(),i!==null&&(Et(i,1,o),lr(i,o))}function Gt(i,o,c){if(i.tag===3)Gg(i,i,c);else for(;o!==null;){if(o.tag===3){Gg(o,i,c);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Sa===null||!Sa.has(m))){i=ws(c,i),i=ug(o,i,1),o=ka(o,i,1),i=Wn(),o!==null&&(Et(o,1,i),lr(o,i));break}}o=o.return}}function uk(i,o,c){var m=i.pingCache;m!==null&&m.delete(o),o=Wn(),i.pingedLanes|=i.suspendedLanes&c,fn===i&&(Tn&c)===c&&(sn===4||sn===3&&(Tn&130023424)===Tn&&500>Ut()-Hh?Co(i,0):Vh|=c),lr(i,o)}function $g(i,o){o===0&&((i.mode&1)===0?o=1:(o=Cn,Cn<<=1,(Cn&130023424)===0&&(Cn=4194304)));var c=Wn();i=Gi(i,o),i!==null&&(Et(i,o,c),lr(i,c))}function dk(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),$g(i,c)}function hk(i,o){var c=0;switch(i.tag){case 13:var m=i.stateNode,b=i.memoizedState;b!==null&&(c=b.retryLane);break;case 19:m=i.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(o),$g(i,c)}var Kg;Kg=function(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps||ir.current)or=!0;else{if((i.lanes&c)===0&&(o.flags&128)===0)return or=!1,Zw(i,o,c);or=(i.flags&131072)!==0}else or=!1,jt&&(o.flags&1048576)!==0&&Em(o,Zc,o.index);switch(o.lanes=0,o.tag){case 2:var m=o.type;fu(i,o),i=o.pendingProps;var b=hs(o,Ln.current);bs(o,c),b=wh(null,o,m,i,b,c);var w=kh();return o.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ar(m)?(w=!0,Yc(o)):w=!1,o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,ph(o),b.updater=hu,o.stateNode=b,b._reactInternals=o,_h(o,m,i,c),o=Mh(null,o,m,!0,w,c)):(o.tag=0,jt&&w&&rh(o),qn(null,o,b,c),o=o.child),o;case 16:m=o.elementType;e:{switch(fu(i,o),i=o.pendingProps,b=m._init,m=b(m._payload),o.type=m,b=o.tag=fk(m),i=ei(m,i),b){case 0:o=Ih(null,o,m,i,c);break e;case 1:o=yg(null,o,m,i,c);break e;case 11:o=fg(null,o,m,i,c);break e;case 14:o=mg(null,o,m,ei(m.type,i),c);break e}throw Error(t(306,m,""))}return o;case 0:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),Ih(i,o,m,b,c);case 1:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),yg(i,o,m,b,c);case 3:e:{if(wg(o),i===null)throw Error(t(387));m=o.pendingProps,w=o.memoizedState,b=w.element,Nm(i,o),au(o,m,null,c);var _=o.memoizedState;if(m=_.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){b=ws(Error(t(423)),o),o=kg(i,o,m,c,b);break e}else if(m!==b){b=ws(Error(t(424)),o),o=kg(i,o,m,c,b);break e}else for(wr=ga(o.stateNode.containerInfo.firstChild),yr=o,jt=!0,Zr=null,c=Am(o,null,m,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(ms(),m===b){o=Ki(i,o,c);break e}qn(i,o,m,c)}o=o.child}return o;case 5:return Fm(o),i===null&&oh(o),m=o.type,b=o.pendingProps,w=i!==null?i.memoizedProps:null,_=b.children,Xd(m,b)?_=null:w!==null&&Xd(m,w)&&(o.flags|=32),bg(i,o),qn(i,o,_,c),o.child;case 6:return i===null&&oh(o),null;case 13:return Cg(i,o,c);case 4:return fh(o,o.stateNode.containerInfo),m=o.pendingProps,i===null?o.child=gs(o,null,m,c):qn(i,o,m,c),o.child;case 11:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),fg(i,o,m,b,c);case 7:return qn(i,o,o.pendingProps,c),o.child;case 8:return qn(i,o,o.pendingProps.children,c),o.child;case 12:return qn(i,o,o.pendingProps.children,c),o.child;case 10:e:{if(m=o.type._context,b=o.pendingProps,w=o.memoizedProps,_=b.value,Mt(nu,m._currentValue),m._currentValue=_,w!==null)if(rr(w.value,_)){if(w.children===b.children&&!ir.current){o=Ki(i,o,c);break e}}else for(w=o.child,w!==null&&(w.return=o);w!==null;){var N=w.dependencies;if(N!==null){_=w.child;for(var H=N.firstContext;H!==null;){if(H.context===m){if(w.tag===1){H=$i(-1,c&-c),H.tag=2;var oe=w.updateQueue;if(oe!==null){oe=oe.shared;var we=oe.pending;we===null?H.next=H:(H.next=we.next,we.next=H),oe.pending=H}}w.lanes|=c,H=w.alternate,H!==null&&(H.lanes|=c),dh(w.return,c,o),N.lanes|=c;break}H=H.next}}else if(w.tag===10)_=w.type===o.type?null:w.child;else if(w.tag===18){if(_=w.return,_===null)throw Error(t(341));_.lanes|=c,N=_.alternate,N!==null&&(N.lanes|=c),dh(_,c,o),_=w.sibling}else _=w.child;if(_!==null)_.return=w;else for(_=w;_!==null;){if(_===o){_=null;break}if(w=_.sibling,w!==null){w.return=_.return,_=w;break}_=_.return}w=_}qn(i,o,b.children,c),o=o.child}return o;case 9:return b=o.type,m=o.pendingProps.children,bs(o,c),b=Lr(b),m=m(b),o.flags|=1,qn(i,o,m,c),o.child;case 14:return m=o.type,b=ei(m,o.pendingProps),b=ei(m.type,b),mg(i,o,m,b,c);case 15:return gg(i,o,o.type,o.pendingProps,c);case 17:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),fu(i,o),o.tag=1,ar(m)?(i=!0,Yc(o)):i=!1,bs(o,c),sg(o,m,b),_h(o,m,b,c),Mh(null,o,m,!0,i,c);case 19:return Tg(i,o,c);case 22:return vg(i,o,c)}throw Error(t(156,o.tag))};function Jg(i,o){return Ks(i,o)}function pk(i,o,c,m){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(i,o,c,m){return new pk(i,o,c,m)}function Yh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function fk(i){if(typeof i=="function")return Yh(i)?1:0;if(i!=null){if(i=i.$$typeof,i===he)return 11;if(i===de)return 14}return 2}function _a(i,o){var c=i.alternate;return c===null?(c=Dr(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function xu(i,o,c,m,b,w){var _=2;if(m=i,typeof i=="function")Yh(i)&&(_=1);else if(typeof i=="string")_=5;else e:switch(i){case ie:return To(c.children,b,w,o);case Y:_=8,b|=8;break;case z:return i=Dr(12,c,o,b|2),i.elementType=z,i.lanes=w,i;case je:return i=Dr(13,c,o,b),i.elementType=je,i.lanes=w,i;case ce:return i=Dr(19,c,o,b),i.elementType=ce,i.lanes=w,i;case Re:return Eu(c,b,w,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case K:_=10;break e;case X:_=9;break e;case he:_=11;break e;case de:_=14;break e;case Me:_=16,m=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=Dr(_,c,o,b),o.elementType=i,o.type=m,o.lanes=w,o}function To(i,o,c,m){return i=Dr(7,i,m,o),i.lanes=c,i}function Eu(i,o,c,m){return i=Dr(22,i,m,o),i.elementType=Re,i.lanes=c,i.stateNode={isHidden:!1},i}function Xh(i,o,c){return i=Dr(6,i,null,o),i.lanes=c,i}function Qh(i,o,c){return o=Dr(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function mk(i,o,c,m,b){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xo(0),this.expirationTimes=Xo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xo(0),this.identifierPrefix=m,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function Zh(i,o,c,m,b,w,_,N,H){return i=new mk(i,o,c,N,H),o===1?(o=1,w===!0&&(o|=8)):o=0,w=Dr(3,null,null,o),i.current=w,w.stateNode=i,w.memoizedState={element:m,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},ph(w),i}function gk(i,o,c){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Q,key:m==null?null:""+m,children:i,containerInfo:o,implementation:c}}function Yg(i){if(!i)return ba;i=i._reactInternals;e:{if(di(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ar(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var c=i.type;if(ar(c))return Sm(i,c,o)}return o}function Xg(i,o,c,m,b,w,_,N,H){return i=Zh(c,m,!0,i,b,w,_,N,H),i.context=Yg(null),c=i.current,m=Wn(),b=xa(c),w=$i(m,b),w.callback=o??null,ka(c,w,b),i.current.lanes=b,Et(i,b,m),lr(i,m),i}function _u(i,o,c,m){var b=o.current,w=Wn(),_=xa(b);return c=Yg(c),o.context===null?o.context=c:o.pendingContext=c,o=$i(w,_),o.payload={element:i},m=m===void 0?null:m,m!==null&&(o.callback=m),i=ka(b,o,_),i!==null&&(ri(i,b,_,w),iu(i,b,_)),_}function Pu(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Qg(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function ep(i,o){Qg(i,o),(i=i.alternate)&&Qg(i,o)}function vk(){return null}var Zg=typeof reportError=="function"?reportError:function(i){console.error(i)};function tp(i){this._internalRoot=i}Ru.prototype.render=tp.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));_u(i,o,null,null)},Ru.prototype.unmount=tp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;ko(function(){_u(null,i,null,null)}),o[Hi]=null}};function Ru(i){this._internalRoot=i}Ru.prototype.unstable_scheduleHydration=function(i){if(i){var o=la();i={blockedOn:null,target:i,priority:o};for(var c=0;c<mr.length&&o!==0&&o<mr[c].priority;c++);mr.splice(c,0,i),c===0&&ji(i)}};function np(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Iu(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function ev(){}function bk(i,o,c,m,b){if(b){if(typeof m=="function"){var w=m;m=function(){var oe=Pu(_);w.call(oe)}}var _=Xg(o,m,i,0,null,!1,!1,"",ev);return i._reactRootContainer=_,i[Hi]=_.current,vl(i.nodeType===8?i.parentNode:i),ko(),_}for(;b=i.lastChild;)i.removeChild(b);if(typeof m=="function"){var N=m;m=function(){var oe=Pu(H);N.call(oe)}}var H=Zh(i,0,!1,null,null,!1,!1,"",ev);return i._reactRootContainer=H,i[Hi]=H.current,vl(i.nodeType===8?i.parentNode:i),ko(function(){_u(o,H,c,m)}),H}function Mu(i,o,c,m,b){var w=c._reactRootContainer;if(w){var _=w;if(typeof b=="function"){var N=b;b=function(){var H=Pu(_);N.call(H)}}_u(o,_,i,b)}else _=bk(c,o,i,b,m);return Pu(_)}Qo=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var c=Pr(o.pendingLanes);c!==0&&(Ja(o,c|1),lr(o,Ut()),(bt&6)===0&&(Ss=Ut()+500,ya()))}break;case 13:ko(function(){var m=Gi(i,1);if(m!==null){var b=Wn();ri(m,i,1,b)}}),ep(i,1)}},$r=function(i){if(i.tag===13){var o=Gi(i,134217728);if(o!==null){var c=Wn();ri(o,i,134217728,c)}ep(i,134217728)}},Qs=function(i){if(i.tag===13){var o=xa(i),c=Gi(i,o);if(c!==null){var m=Wn();ri(c,i,o,m)}ep(i,o)}},la=function(){return gt},Ya=function(i,o){var c=gt;try{return gt=i,o()}finally{gt=c}},wn=function(i,o,c){switch(o){case"input":if(Ai(i,c),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var m=c[o];if(m!==i&&m.form===i.form){var b=Kc(m);if(!b)throw Error(t(90));er(m),Ai(m,b)}}}break;case"textarea":P(i,c);break;case"select":o=c.value,o!=null&&Un(i,!!c.multiple,o,!1)}},Vn=$h,ht=ko;var yk={usingClientEntryPoint:!1,Events:[wl,us,Kc,et,Er,$h]},Ll={findFiberByHostInstance:po,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wk={bundleType:Ll.bundleType,version:Ll.version,rendererPackageName:Ll.rendererPackageName,rendererConfig:Ll.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=_c(i),i===null?null:i.stateNode},findFiberByHostInstance:Ll.findFiberByHostInstance||vk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ou.isDisabled&&Ou.supportsFiber)try{_r=Ou.inject(wk),Rn=Ou}catch{}}return cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yk,cr.createPortal=function(i,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!np(o))throw Error(t(200));return gk(i,o,null,c)},cr.createRoot=function(i,o){if(!np(i))throw Error(t(299));var c=!1,m="",b=Zg;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=Zh(i,1,!1,null,null,c,!1,m,b),i[Hi]=o.current,vl(i.nodeType===8?i.parentNode:i),new tp(o)},cr.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=_c(o),i=i===null?null:i.stateNode,i},cr.flushSync=function(i){return ko(i)},cr.hydrate=function(i,o,c){if(!Iu(o))throw Error(t(200));return Mu(null,i,o,!0,c)},cr.hydrateRoot=function(i,o,c){if(!np(i))throw Error(t(405));var m=c!=null&&c.hydratedSources||null,b=!1,w="",_=Zg;if(c!=null&&(c.unstable_strictMode===!0&&(b=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onRecoverableError!==void 0&&(_=c.onRecoverableError)),o=Xg(o,null,i,1,c??null,b,!1,w,_),i[Hi]=o.current,vl(i),m)for(i=0;i<m.length;i++)c=m[i],b=c._getVersion,b=b(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,b]:o.mutableSourceEagerHydrationData.push(c,b);return new Ru(o)},cr.render=function(i,o,c){if(!Iu(o))throw Error(t(200));return Mu(null,i,o,!1,c)},cr.unmountComponentAtNode=function(i){if(!Iu(i))throw Error(t(40));return i._reactRootContainer?(ko(function(){Mu(null,null,i,!1,function(){i._reactRootContainer=null,i[Hi]=null})}),!0):!1},cr.unstable_batchedUpdates=$h,cr.unstable_renderSubtreeIntoContainer=function(i,o,c,m){if(!Iu(c))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return Mu(i,o,c,!1,m)},cr.version="18.3.1-next-f1338f8080-20240426",cr}var fv;function Ik(){if(fv)return rp.exports;fv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),rp.exports=Rk(),rp.exports}var mv;function Mk(){if(mv)return Au;mv=1;var n=Ik();return Au.createRoot=n.createRoot,Au.hydrateRoot=n.hydrateRoot,Au}var Ok=Mk(),Sy=function(n,e,t,r){var a;e[0]=0;for(var s=1;s<e.length;s++){var l=e[s++],u=e[s]?(e[0]|=l?1:2,t[e[s++]]):e[++s];l===3?r[0]=u:l===4?r[1]=Object.assign(r[1]||{},u):l===5?(r[1]=r[1]||{})[e[++s]]=u:l===6?r[1][e[++s]]+=u+"":l?(a=n.apply(u,Sy(n,u,t,["",null])),r.push(a),u[0]?e[0]|=2:(e[s-2]=0,e[s]=a)):r.push(u)}return r},gv=new Map;function Ak(n){var e=gv.get(this);return e||(e=new Map,gv.set(this,e)),(e=Sy(this,e.get(n)||(e.set(n,e=function(t){for(var r,a,s=1,l="",u="",h=[0],f=function(x){s===1&&(x||(l=l.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?h.push(0,x,l):s===3&&(x||l)?(h.push(3,x,l),s=2):s===2&&l==="..."&&x?h.push(4,x,0):s===2&&l&&!x?h.push(5,0,!0,l):s>=5&&((l||!x&&s===5)&&(h.push(s,0,l,a),s=6),x&&(h.push(s,x,0,a),s=6)),l=""},g=0;g<t.length;g++){g&&(s===1&&f(),f(g));for(var C=0;C<t[g].length;C++)r=t[g][C],s===1?r==="<"?(f(),h=[h],s=3):l+=r:s===4?l==="--"&&r===">"?(s=1,l=""):l=r+l[0]:u?r===u?u="":l+=r:r==='"'||r==="'"?u=r:r===">"?(f(),s=1):s&&(r==="="?(s=5,a=l,l=""):r==="/"&&(s<5||t[g][C+1]===">")?(f(),s===3&&(h=h[0]),s=h,(h=h[0]).push(2,0,s),s=0):r===" "||r==="	"||r===`
`||r==="\r"?(f(),s=2):l+=r),s===3&&l==="!--"&&(s=4,h=h[0])}return f(),h}(n)),e),arguments,[])).length>1?e:e[0]}function Rs(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function Ns(n){return function e(t){return arguments.length===0||Rs(t)?e:n.apply(this,arguments)}}function Tf(n){return function e(t,r){switch(arguments.length){case 0:return e;case 1:return Rs(t)?e:Ns(function(a){return n(t,a)});default:return Rs(t)&&Rs(r)?e:Rs(t)?Ns(function(a){return n(a,r)}):Rs(r)?Ns(function(a){return n(t,a)}):n(t,r)}}}const Lk=Array.isArray||function(n){return n!=null&&n.length>=0&&Object.prototype.toString.call(n)==="[object Array]"};function Nk(n){return n!=null&&typeof n["@@transducer/step"]=="function"}function Ty(n,e,t){return function(){if(arguments.length===0)return t();var r=arguments[arguments.length-1];if(!Lk(r)){for(var a=0;a<n.length;){if(typeof r[n[a]]=="function")return r[n[a]].apply(r,Array.prototype.slice.call(arguments,0,-1));a+=1}if(Nk(r)){var s=e.apply(null,Array.prototype.slice.call(arguments,0,-1));return s(r)}}return t.apply(this,arguments)}}const Rp={init:function(){return this.xf["@@transducer/init"]()},result:function(n){return this.xf["@@transducer/result"](n)}};function vv(n){for(var e=[],t;!(t=n.next()).done;)e.push(t.value);return e}function bv(n,e,t){for(var r=0,a=t.length;r<a;){if(n(e,t[r]))return!0;r+=1}return!1}function jk(n){var e=String(n).match(/^function (\w*)/);return e==null?"":e[1]}function ad(n,e){return Object.prototype.hasOwnProperty.call(e,n)}function Dk(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}const ip=typeof Object.is=="function"?Object.is:Dk;var yv=Object.prototype.toString,Fk=function(){return yv.call(arguments)==="[object Arguments]"?function(n){return yv.call(n)==="[object Arguments]"}:function(n){return ad("callee",n)}}(),Uk=!{toString:null}.propertyIsEnumerable("toString"),wv=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],kv=function(){return arguments.propertyIsEnumerable("length")}(),Bk=function(n,e){for(var t=0;t<n.length;){if(n[t]===e)return!0;t+=1}return!1},Cv=Ns(typeof Object.keys=="function"&&!kv?function(n){return Object(n)!==n?[]:Object.keys(n)}:function(n){if(Object(n)!==n)return[];var e,t,r=[],a=kv&&Fk(n);for(e in n)ad(e,n)&&(!a||e!=="length")&&(r[r.length]=e);if(Uk)for(t=wv.length-1;t>=0;)e=wv[t],ad(e,n)&&!Bk(r,e)&&(r[r.length]=e),t-=1;return r}),Sv=Ns(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)});function Tv(n,e,t,r){var a=vv(n),s=vv(e);function l(u,h){return xf(u,h,t.slice(),r.slice())}return!bv(function(u,h){return!bv(l,h,u)},s,a)}function xf(n,e,t,r){if(ip(n,e))return!0;var a=Sv(n);if(a!==Sv(e))return!1;if(typeof n["fantasy-land/equals"]=="function"||typeof e["fantasy-land/equals"]=="function")return typeof n["fantasy-land/equals"]=="function"&&n["fantasy-land/equals"](e)&&typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](n);if(typeof n.equals=="function"||typeof e.equals=="function")return typeof n.equals=="function"&&n.equals(e)&&typeof e.equals=="function"&&e.equals(n);switch(a){case"Arguments":case"Array":case"Object":if(typeof n.constructor=="function"&&jk(n.constructor)==="Promise")return n===e;break;case"Boolean":case"Number":case"String":if(!(typeof n==typeof e&&ip(n.valueOf(),e.valueOf())))return!1;break;case"Date":if(!ip(n.valueOf(),e.valueOf()))return!1;break;case"Error":return n.name===e.name&&n.message===e.message;case"RegExp":if(!(n.source===e.source&&n.global===e.global&&n.ignoreCase===e.ignoreCase&&n.multiline===e.multiline&&n.sticky===e.sticky&&n.unicode===e.unicode))return!1;break}for(var s=t.length-1;s>=0;){if(t[s]===n)return r[s]===e;s-=1}switch(a){case"Map":return n.size!==e.size?!1:Tv(n.entries(),e.entries(),t.concat([n]),r.concat([e]));case"Set":return n.size!==e.size?!1:Tv(n.values(),e.values(),t.concat([n]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var l=Cv(n);if(l.length!==Cv(e).length)return!1;var u=t.concat([n]),h=r.concat([e]);for(s=l.length-1;s>=0;){var f=l[s];if(!(ad(f,e)&&xf(e[f],n[f],u,h)))return!1;s-=1}return!0}var Ef=Tf(function(n,e){return xf(n,e,[],[])});function Vk(n,e,t){var r,a;if(typeof n.indexOf=="function")switch(typeof e){case"number":if(e===0){for(r=1/e;t<n.length;){if(a=n[t],a===0&&1/a===r)return t;t+=1}return-1}else if(e!==e){for(;t<n.length;){if(a=n[t],typeof a=="number"&&a!==a)return t;t+=1}return-1}return n.indexOf(e,t);case"string":case"boolean":case"function":case"undefined":return n.indexOf(e,t);case"object":if(e===null)return n.indexOf(e,t)}for(;t<n.length;){if(Ef(n[t],e))return t;t+=1}return-1}function xv(n,e){return Vk(e,n,0)>=0}function Hk(n){return n}var qk=Ns(Hk),xy=function(){function n(){this._nativeSet=typeof Set=="function"?new Set:null,this._items={}}return n.prototype.add=function(e){return!Ev(e,!0,this)},n.prototype.has=function(e){return Ev(e,!1,this)},n}();function Ev(n,e,t){var r=typeof n,a,s;switch(r){case"string":case"number":return n===0&&1/n===-1/0?t._items["-0"]?!0:(e&&(t._items["-0"]=!0),!1):t._nativeSet!==null?e?(a=t._nativeSet.size,t._nativeSet.add(n),s=t._nativeSet.size,s===a):t._nativeSet.has(n):r in t._items?n in t._items[r]?!0:(e&&(t._items[r][n]=!0),!1):(e&&(t._items[r]={},t._items[r][n]=!0),!1);case"boolean":if(r in t._items){var l=n?1:0;return t._items[r][l]?!0:(e&&(t._items[r][l]=!0),!1)}else return e&&(t._items[r]=n?[!1,!0]:[!0,!1]),!1;case"function":return t._nativeSet!==null?e?(a=t._nativeSet.size,t._nativeSet.add(n),s=t._nativeSet.size,s===a):t._nativeSet.has(n):r in t._items?xv(n,t._items[r])?!0:(e&&t._items[r].push(n),!1):(e&&(t._items[r]=[n]),!1);case"undefined":return t._items[r]?!0:(e&&(t._items[r]=!0),!1);case"object":if(n===null)return t._items.null?!0:(e&&(t._items.null=!0),!1);default:return r=Object.prototype.toString.call(n),r in t._items?xv(n,t._items[r])?!0:(e&&t._items[r].push(n),!1):(e&&(t._items[r]=[n]),!1)}}var Wk=function(){function n(e,t){this.xf=t,this.f=e,this.idx=-1,this.lastIdx=-1}return n.prototype["@@transducer/init"]=Rp.init,n.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](e,this.lastIdx))},n.prototype["@@transducer/step"]=function(e,t){return this.idx+=1,this.f(t)&&(this.lastIdx=this.idx),e},n}();function zk(n){return function(e){return new Wk(n,e)}}var _v=Tf(Ty([],zk,function(n,e){for(var t=e.length-1;t>=0;){if(n(e[t]))return t;t-=1}return-1})),Gk=function(){function n(e,t){this.xf=t,this.f=e,this.set=new xy}return n.prototype["@@transducer/init"]=Rp.init,n.prototype["@@transducer/result"]=Rp.result,n.prototype["@@transducer/step"]=function(e,t){return this.set.add(this.f(t))?this.xf["@@transducer/step"](e,t):e},n}();function $k(n){return function(e){return new Gk(n,e)}}var Kk=Tf(Ty([],$k,function(n,e){for(var t=new xy,r=[],a=0,s,l;a<e.length;)l=e[a],s=n(l),t.add(s)&&r.push(l),a+=1;return r})),Jk=Kk(qk);const Yk="1.2.4-alpha.4",Xk={version:Yk};var En=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},Gn={searchParams:"URLSearchParams"in En,iterable:"Symbol"in En&&"iterator"in Symbol,blob:"FileReader"in En&&"Blob"in En&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in En,arrayBuffer:"ArrayBuffer"in En};function Qk(n){return n&&DataView.prototype.isPrototypeOf(n)}if(Gn.arrayBuffer)var Zk=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],eC=ArrayBuffer.isView||function(n){return n&&Zk.indexOf(Object.prototype.toString.call(n))>-1};function zs(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(n)||n==="")throw new TypeError('Invalid character in header field name: "'+n+'"');return n.toLowerCase()}function _f(n){return typeof n!="string"&&(n=String(n)),n}function Pf(n){var e={next:function(){var t=n.shift();return{done:t===void 0,value:t}}};return Gn.iterable&&(e[Symbol.iterator]=function(){return e}),e}function hn(n){this.map={},n instanceof hn?n.forEach(function(e,t){this.append(t,e)},this):Array.isArray(n)?n.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(e){this.append(e,n[e])},this)}hn.prototype.append=function(n,e){n=zs(n),e=_f(e);var t=this.map[n];this.map[n]=t?t+", "+e:e};hn.prototype.delete=function(n){delete this.map[zs(n)]};hn.prototype.get=function(n){return n=zs(n),this.has(n)?this.map[n]:null};hn.prototype.has=function(n){return this.map.hasOwnProperty(zs(n))};hn.prototype.set=function(n,e){this.map[zs(n)]=_f(e)};hn.prototype.forEach=function(n,e){for(var t in this.map)this.map.hasOwnProperty(t)&&n.call(e,this.map[t],t,this)};hn.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),Pf(n)};hn.prototype.values=function(){var n=[];return this.forEach(function(e){n.push(e)}),Pf(n)};hn.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),Pf(n)};Gn.iterable&&(hn.prototype[Symbol.iterator]=hn.prototype.entries);function ap(n){if(!n._noBody){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}}function Ey(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function tC(n){var e=new FileReader,t=Ey(e);return e.readAsArrayBuffer(n),t}function nC(n){var e=new FileReader,t=Ey(e),r=/charset=([A-Za-z0-9_-]+)/.exec(n.type),a=r?r[1]:"utf-8";return e.readAsText(n,a),t}function rC(n){for(var e=new Uint8Array(n),t=new Array(e.length),r=0;r<e.length;r++)t[r]=String.fromCharCode(e[r]);return t.join("")}function Pv(n){if(n.slice)return n.slice(0);var e=new Uint8Array(n.byteLength);return e.set(new Uint8Array(n)),e.buffer}function _y(){return this.bodyUsed=!1,this._initBody=function(n){this.bodyUsed=this.bodyUsed,this._bodyInit=n,n?typeof n=="string"?this._bodyText=n:Gn.blob&&Blob.prototype.isPrototypeOf(n)?this._bodyBlob=n:Gn.formData&&FormData.prototype.isPrototypeOf(n)?this._bodyFormData=n:Gn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)?this._bodyText=n.toString():Gn.arrayBuffer&&Gn.blob&&Qk(n)?(this._bodyArrayBuffer=Pv(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Gn.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||eC(n))?this._bodyArrayBuffer=Pv(n):this._bodyText=n=Object.prototype.toString.call(n):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Gn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Gn.blob&&(this.blob=function(){var n=ap(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var n=ap(this);return n||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(Gn.blob)return this.blob().then(tC);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var n=ap(this);if(n)return n;if(this._bodyBlob)return nC(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(rC(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Gn.formData&&(this.formData=function(){return this.text().then(oC)}),this.json=function(){return this.text().then(JSON.parse)},this}var iC=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function aC(n){var e=n.toUpperCase();return iC.indexOf(e)>-1?e:n}function Oo(n,e){if(!(this instanceof Oo))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var t=e.body;if(n instanceof Oo){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url,this.credentials=n.credentials,e.headers||(this.headers=new hn(n.headers)),this.method=n.method,this.mode=n.mode,this.signal=n.signal,!t&&n._bodyInit!=null&&(t=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new hn(e.headers)),this.method=aC(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in En){var s=new AbortController;return s.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&t)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(t),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var a=/\?/;this.url+=(a.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}Oo.prototype.clone=function(){return new Oo(this,{body:this._bodyInit})};function oC(n){var e=new FormData;return n.trim().split("&").forEach(function(t){if(t){var r=t.split("="),a=r.shift().replace(/\+/g," "),s=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(a),decodeURIComponent(s))}}),e}function sC(n){var e=new hn,t=n.replace(/\r?\n[\t ]+/g," ");return t.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var a=r.split(":"),s=a.shift().trim();if(s){var l=a.join(":").trim();try{e.append(s,l)}catch(u){console.warn("Response "+u.message)}}}),e}_y.call(Oo.prototype);function Ri(n,e){if(!(this instanceof Ri))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new hn(e.headers),this.url=e.url||"",this._initBody(n)}_y.call(Ri.prototype);Ri.prototype.clone=function(){return new Ri(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new hn(this.headers),url:this.url})};Ri.error=function(){var n=new Ri(null,{status:200,statusText:""});return n.ok=!1,n.status=0,n.type="error",n};var lC=[301,302,303,307,308];Ri.redirect=function(n,e){if(lC.indexOf(e)===-1)throw new RangeError("Invalid status code");return new Ri(null,{status:e,headers:{location:n}})};var Ro=En.DOMException;try{new Ro}catch{Ro=function(n,e){this.message=n,this.name=e;var t=Error(n);this.stack=t.stack},Ro.prototype=Object.create(Error.prototype),Ro.prototype.constructor=Ro}function Py(n,e){return new Promise(function(t,r){var a=new Oo(n,e);if(a.signal&&a.signal.aborted)return r(new Ro("Aborted","AbortError"));var s=new XMLHttpRequest;function l(){s.abort()}s.onload=function(){var f={statusText:s.statusText,headers:sC(s.getAllResponseHeaders()||"")};a.url.indexOf("file://")===0&&(s.status<200||s.status>599)?f.status=200:f.status=s.status,f.url="responseURL"in s?s.responseURL:f.headers.get("X-Request-URL");var g="response"in s?s.response:s.responseText;setTimeout(function(){t(new Ri(g,f))},0)},s.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},s.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},s.onabort=function(){setTimeout(function(){r(new Ro("Aborted","AbortError"))},0)};function u(f){try{return f===""&&En.location.href?En.location.href:f}catch{return f}}if(s.open(a.method,u(a.url),!0),a.credentials==="include"?s.withCredentials=!0:a.credentials==="omit"&&(s.withCredentials=!1),"responseType"in s&&(Gn.blob?s.responseType="blob":Gn.arrayBuffer&&(s.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof hn||En.Headers&&e.headers instanceof En.Headers)){var h=[];Object.getOwnPropertyNames(e.headers).forEach(function(f){h.push(zs(f)),s.setRequestHeader(f,_f(e.headers[f]))}),a.headers.forEach(function(f,g){h.indexOf(g)===-1&&s.setRequestHeader(g,f)})}else a.headers.forEach(function(f,g){s.setRequestHeader(g,f)});a.signal&&(a.signal.addEventListener("abort",l),s.onreadystatechange=function(){s.readyState===4&&a.signal.removeEventListener("abort",l)}),s.send(typeof a._bodyInit>"u"?null:a._bodyInit)})}Py.polyfill=!0;En.fetch||(En.fetch=Py,En.Headers=hn,En.Request=Oo,En.Response=Ri);var Rv,Iv;function cC(){return Iv||(Iv=1,Rv=self.fetch.bind(self)),Rv}var uC=cC();const Yl=Cy(uC);function Ht(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function Io(n){return function e(t){return arguments.length===0||Ht(t)?e:n.apply(this,arguments)}}function xs(n){return function e(t,r){switch(arguments.length){case 0:return e;case 1:return Ht(t)?e:Io(function(a){return n(t,a)});default:return Ht(t)&&Ht(r)?e:Ht(t)?Io(function(a){return n(a,r)}):Ht(r)?Io(function(a){return n(t,a)}):n(t,r)}}}function dC(n,e){n=n||[],e=e||[];var t,r=n.length,a=e.length,s=[];for(t=0;t<r;)s[s.length]=n[t],t+=1;for(t=0;t<a;)s[s.length]=e[t],t+=1;return s}function hC(n){return function e(t,r,a){switch(arguments.length){case 0:return e;case 1:return Ht(t)?e:xs(function(s,l){return n(t,s,l)});case 2:return Ht(t)&&Ht(r)?e:Ht(t)?xs(function(s,l){return n(s,r,l)}):Ht(r)?xs(function(s,l){return n(t,s,l)}):Io(function(s){return n(t,r,s)});default:return Ht(t)&&Ht(r)&&Ht(a)?e:Ht(t)&&Ht(r)?xs(function(s,l){return n(s,l,a)}):Ht(t)&&Ht(a)?xs(function(s,l){return n(s,r,l)}):Ht(r)&&Ht(a)?xs(function(s,l){return n(t,s,l)}):Ht(t)?Io(function(s){return n(s,r,a)}):Ht(r)?Io(function(s){return n(t,s,a)}):Ht(a)?Io(function(s){return n(t,r,s)}):n(t,r,a)}}}var Mv=hC(function(n,e,t){var r=t.length;if(n>=r||n<-r)return t;var a=(r+n)%r,s=dC(t);return s[a]=e(t[a]),s});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ip=function(n,e){return Ip=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])},Ip(n,e)};function Ry(n,e){Ip(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function pC(n){var e=typeof Symbol=="function"&&n[Symbol.iterator],t=0;return e?e.call(n):{next:function(){return n&&t>=n.length&&(n=void 0),{value:n&&n[t++],done:!n}}}}function fC(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),a,s=[],l;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)s.push(a.value)}catch(u){l={error:u}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(l)throw l.error}}return s}function mC(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(fC(arguments[e]));return n}var Iy=function(){function n(e,t){this.target=t,this.type=e}return n}(),gC=function(n){Ry(e,n);function e(t,r){var a=n.call(this,"error",r)||this;return a.message=t.message,a.error=t,a}return e}(Iy),vC=function(n){Ry(e,n);function e(t,r,a){t===void 0&&(t=1e3),r===void 0&&(r="");var s=n.call(this,"close",a)||this;return s.wasClean=!0,s.code=t,s.reason=r,s}return e}(Iy);/*!
 * Reconnecting WebSocket
 * by Pedro Ladaria <pedro.ladaria@gmail.com>
 * https://github.com/pladaria/reconnecting-websocket
 * License MIT
 */var bC=function(){if(typeof WebSocket<"u")return WebSocket},yC=function(n){return typeof n<"u"&&!!n&&n.CLOSING===2},xo={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+Math.random()*4e3,minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},op=function(){function n(e,t,r){var a=this;r===void 0&&(r={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(s){a._debug("open event");var l=a._options.minUptime,u=l===void 0?xo.minUptime:l;clearTimeout(a._connectTimeout),a._uptimeTimeout=setTimeout(function(){return a._acceptOpen()},u),a._ws.binaryType=a._binaryType,a._messageQueue.forEach(function(h){return a._ws.send(h)}),a._messageQueue=[],a.onopen&&a.onopen(s),a._listeners.open.forEach(function(h){return a._callEventListener(s,h)})},this._handleMessage=function(s){a._debug("message event"),a.onmessage&&a.onmessage(s),a._listeners.message.forEach(function(l){return a._callEventListener(s,l)})},this._handleError=function(s){a._debug("error event",s.message),a._disconnect(void 0,s.message==="TIMEOUT"?"timeout":void 0),a.onerror&&a.onerror(s),a._debug("exec error listeners"),a._listeners.error.forEach(function(l){return a._callEventListener(s,l)}),a._connect()},this._handleClose=function(s){a._debug("close event"),a._clearTimeouts(),a._shouldReconnect&&a._connect(),a.onclose&&a.onclose(s),a._listeners.close.forEach(function(l){return a._callEventListener(s,l)})},this._url=e,this._protocols=t,this._options=r,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(n,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CONNECTING",{get:function(){return n.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OPEN",{get:function(){return n.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CLOSING",{get:function(){return n.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CLOSED",{get:function(){return n.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bufferedAmount",{get:function(){var e=this._messageQueue.reduce(function(t,r){return typeof r=="string"?t+=r.length:r instanceof Blob?t+=r.size:t+=r.byteLength,t},0);return e+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?n.CLOSED:n.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),n.prototype.close=function(e,t){if(e===void 0&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(e,t)},n.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,!this._ws||this._ws.readyState===this.CLOSED?this._connect():(this._disconnect(e,t),this._connect())},n.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,r=t===void 0?xo.maxEnqueuedMessages:t;this._messageQueue.length<r&&(this._debug("enqueue",e),this._messageQueue.push(e))}},n.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},n.prototype.dispatchEvent=function(e){var t,r,a=this._listeners[e.type];if(a)try{for(var s=pC(a),l=s.next();!l.done;l=s.next()){var u=l.value;this._callEventListener(e,u)}}catch(h){t={error:h}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return!0},n.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(r){return r!==t}))},n.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,mC(["RWS>"],e))},n.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,r=t===void 0?xo.reconnectionDelayGrowFactor:t,a=e.minReconnectionDelay,s=a===void 0?xo.minReconnectionDelay:a,l=e.maxReconnectionDelay,u=l===void 0?xo.maxReconnectionDelay:l,h=0;return this._retryCount>0&&(h=s*Math.pow(r,this._retryCount-1),h>u&&(h=u)),this._debug("next delay",h),h},n.prototype._wait=function(){var e=this;return new Promise(function(t){setTimeout(t,e._getNextDelay())})},n.prototype._getNextUrl=function(e){if(typeof e=="string")return Promise.resolve(e);if(typeof e=="function"){var t=e();if(typeof t=="string")return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},n.prototype._connect=function(){var e=this;if(!(this._connectLock||!this._shouldReconnect)){this._connectLock=!0;var t=this._options,r=t.maxRetries,a=r===void 0?xo.maxRetries:r,s=t.connectionTimeout,l=s===void 0?xo.connectionTimeout:s,u=t.WebSocket,h=u===void 0?bC():u;if(this._retryCount>=a){this._debug("max retries reached",this._retryCount,">=",a);return}if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!yC(h))throw Error("No valid WebSocket class provided");this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(f){e._closeCalled||(e._debug("connect",{url:f,protocols:e._protocols}),e._ws=e._protocols?new h(f,e._protocols):new h(f),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},l))})}},n.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new gC(Error("TIMEOUT"),this))},n.prototype._disconnect=function(e,t){if(e===void 0&&(e=1e3),this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new vC(e,t,this))}catch{}}},n.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},n.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},n.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},n.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},n.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},n}();let Lu;const wC=new Uint8Array(16);function kC(){if(!Lu&&(Lu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Lu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Lu(wC)}const xn=[];for(let n=0;n<256;++n)xn.push((n+256).toString(16).slice(1));function CC(n,e=0){return xn[n[e+0]]+xn[n[e+1]]+xn[n[e+2]]+xn[n[e+3]]+"-"+xn[n[e+4]]+xn[n[e+5]]+"-"+xn[n[e+6]]+xn[n[e+7]]+"-"+xn[n[e+8]]+xn[n[e+9]]+"-"+xn[n[e+10]]+xn[n[e+11]]+xn[n[e+12]]+xn[n[e+13]]+xn[n[e+14]]+xn[n[e+15]]}const SC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ov={randomUUID:SC};function Av(n,e,t){if(Ov.randomUUID&&!n)return Ov.randomUUID();n=n||{};const r=n.random||(n.rng||kC)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,CC(r)}var TC="1.2.4-alpha.4",od={version:TC};const Eo=console;var Kn;(function(n){n.Application="bot",n.User="user",n.Failure="failure"})(Kn||(Kn={}));const Lv="NLX.Welcome",xC="We encountered an issue. Please try again soon.",My=n=>Array.isArray(n)?n:Object.entries(n).map(([e,t])=>({slotId:e,value:t})),Nv=n=>({...n,intentId:n.flowId??n.intentId,slots:n.slots!=null?My(n.slots):n.slots}),jv=n=>n.responses,sp=n=>{try{return JSON.parse(n)}catch{return null}},Oy=n=>{var e;return((e=n.match(/(bots\.dev\.studio\.nlx\.ai|bots\.studio\.nlx\.ai|apps\.nlx\.ai|dev\.apps\.nlx\.ai)/g))==null?void 0:e[0])??"apps.nlx.ai"},EC=n=>{if(Oa(n))return n;const e=Oy(n),t=new URL(n).pathname.split("/"),r=t[2],a=t[3];return`wss://us-east-1-ws.${e}?deploymentKey=${r}&channelKey=${a}`},Dv=n=>{if(!Oa(n))return n;const e=Oy(n),t=new URL(n),r=new URLSearchParams(t.search),a=r.get("channelKey"),s=r.get("deploymentKey");return`https://${e}/c/${s}/${a}`},Oa=n=>n.indexOf("wss://")===0,_C=async({fullApplicationUrl:n,headers:e,body:t,stream:r,eventListeners:a})=>{const s=async l=>{const u=await Yl(n,{method:"POST",headers:{...e,"Content-Type":"application/json","nlx-sdk-version":od.version},body:JSON.stringify({...l,stream:!0})});if(!u.ok||u.body==null)throw new Error(`HTTP Error: ${u.status}`);const h=u.body.getReader(),f=new TextDecoder;let g="";const C=[];let x={};for(;;){const{done:T,value:V}=await h.read();if(T)break;for(g+=f.decode(V,{stream:!0});;){const A=g.indexOf("{");if(A===-1)break;let W=!1;for(let U=0;U<g.length;U++)if(g[U]==="}"){const G=g.substring(A,U+1);try{const F=JSON.parse(G);if(F.type==="interim"){const O=F.text;typeof O=="string"&&a.interimMessage.forEach(D=>{D(O)})}else F.type==="message"?C.push({text:F.text,choices:F.choices??[],messageId:F.messageId,metadata:F.metadata}):F.type==="final_response"&&(x=F.data);g=g.substring(U+1),W=!0;break}catch{}}if(!W)break}}return a.interimMessage.forEach(T=>{T(void 0)}),{...x,messages:C}};if(r)return await s(t);{const l=await Yl(n,{method:"POST",headers:{...e??{},Accept:"application/json","Content-Type":"application/json","nlx-sdk-version":od.version},body:JSON.stringify(t)});if(!l.ok||l.body==null)throw new Error(`HTTP Error: ${l.status}`);return await l.json()}};function PC(n){let e,t=[],r=null,a,s=[],l=null;const u=n.applicationUrl??"";/[-|_][a-z]{2,}[-|_][A-Z]{2,}$/.test(u)&&Eo.warn("Since v1.0.0, the language code is no longer added at the end of the application URL. Please remove the modifier (e.g. '-en-US') from the URL, and specify it in the `languageCode` parameter instead.");const h={voicePlusCommand:[],interimMessage:[]},f=n.conversationId??Av();let g={responses:n.responses??[],languageCode:n.languageCode,userId:n.userId,conversationId:f};const C=()=>{var ce;return`${Dv(u)}${((ce=n.experimental)==null?void 0:ce.completeApplicationUrl)===!0?"":`-${g.languageCode}`}`},x=(ce,de)=>{g={...g,...ce},G.forEach(Me=>{Me(jv(g),de)})},T=()=>{const ce={type:Kn.Failure,receivedAt:new Date().getTime(),payload:{text:n.failureMessage??xC}};x({responses:[...g.responses,ce]},ce)},V=ce=>{if((ce==null?void 0:ce.messages.length)>0){const de={type:Kn.Application,receivedAt:new Date().getTime(),payload:{...ce,messages:ce.messages.map(Me=>({nodeId:Me.nodeId,messageId:Me.messageId,text:Me.text,choices:Me.choices??[]}))}};x({responses:[...g.responses,de]},de),ce.metadata.hasPendingDataRequest&&(z({poll:!0}),setTimeout(()=>{U({request:{structured:{poll:!0}}})},1500))}else Eo.warn("Invalid message structure, expected object with field 'messages'."),T()};let A;const W=ce=>{(a==null?void 0:a.readyState)===1?a.send(JSON.stringify(ce)):s=[...s,ce]},U=async ce=>{var de,Me;if(A!=null){A(ce,le=>{Eo.warn("Using the second argument in `setRequestOverride` is deprecated. Use `conversationHandler.appendMessageToTranscript` instead.");const Ee={type:Kn.Application,receivedAt:new Date().getTime(),payload:le};x({responses:[...g.responses,Ee]},Ee)});return}const Re={userId:g.userId,conversationId:g.conversationId,...ce,languageCode:g.languageCode,channelType:(de=n.experimental)==null?void 0:de.channelType,environment:n.environment};if(Oa(u))(e==null?void 0:e.readyState)===1?e.send(JSON.stringify(Re)):t=[...t,Re];else try{const le=await _C({fullApplicationUrl:C(),headers:n.headers??{},stream:((Me=n.experimental)==null?void 0:Me.streamHttp)??!0,eventListeners:h,body:Re});V(le)}catch(le){Eo.warn(le),T()}};let G=[];const F=async()=>{(e==null?void 0:e.readyState)===1&&t[0]!=null&&(await U(t[0]),t=t.slice(1))},O=()=>{(a==null?void 0:a.readyState)===1&&s[0]!=null&&(W(s[0]),s=s.slice(1))},D=()=>{var ce;ie();const de=new URL(u);((ce=n.experimental)==null?void 0:ce.completeApplicationUrl)!==!0&&(de.searchParams.set("languageCode",g.languageCode),de.searchParams.set("channelKey",`${de.searchParams.get("channelKey")??""}-${g.languageCode}`)),de.searchParams.set("conversationId",g.conversationId),e=new op(de.href),r=setInterval(()=>{F()},500),e.onmessage=function(Me){typeof(Me==null?void 0:Me.data)=="string"&&V(sp(Me.data))},de.searchParams.set("voice-plus","true"),a=new op(de.href),l=setInterval(()=>{O()},500),a.onmessage=Me=>{if(typeof(Me==null?void 0:Me.data)=="string"){const Re=sp(Me.data);Re!=null&&h.voicePlusCommand.forEach(le=>{le(Re)})}}},Q=()=>{var ce;if(Y(),n.bidirectional!==!0)return;const de=new URL(EC(u));((ce=n.experimental)==null?void 0:ce.completeApplicationUrl)!==!0&&(de.searchParams.set("languageCode",g.languageCode),de.searchParams.set("channelKey",`${de.searchParams.get("channelKey")??""}-${g.languageCode}`)),de.searchParams.set("conversationId",g.conversationId),de.searchParams.set("type","voice-plus");const Me=n.headers["nlx-api-key"];!Oa(u)&&Me!=null&&de.searchParams.set("apiKey",Me),a=new op(de.href),l=setInterval(()=>{O()},500),a.onmessage=Re=>{if(typeof(Re==null?void 0:Re.data)=="string"){const le=sp(Re.data);le!=null&&h.voicePlusCommand.forEach(Ee=>{Ee(le)})}}},ie=()=>{r!=null&&clearInterval(r),e!=null&&(e.onmessage=null,e.close(),e=void 0)},Y=()=>{l!=null&&clearInterval(l),a!=null&&(a.onmessage=null,a.close(),a=void 0)};Oa(u)&&D(),Q();const z=(ce,de)=>{const Me={type:Kn.User,receivedAt:new Date().getTime(),payload:{type:"structured",...Nv(ce),context:de}};x({responses:[...g.responses,Me]},Me)},K=(ce,de)=>{z({intentId:ce},de),U({context:de,request:{structured:{intentId:ce}}})},X=(ce,de)=>{const Me={type:Kn.User,receivedAt:new Date().getTime(),payload:{type:"text",text:ce,context:de}};x({responses:[...g.responses,Me]},Me),U({context:de,request:{unstructured:{text:ce}}})},he=(ce,de,Me)=>{let Re=[...g.responses];const le={type:Kn.User,receivedAt:new Date().getTime(),payload:{type:"choice",choiceId:ce}},Ee=(Me==null?void 0:Me.responseIndex)??-1,ke=(Me==null?void 0:Me.messageIndex)??-1;Ee>-1&&ke>-1&&(Re=Mv(Ee,L=>L.type===Kn.Application?{...L,payload:{...L.payload,messages:Mv(ke,se=>({...se,selectedChoiceId:ce}),L.payload.messages)}}:L,Re)),Re=[...Re,le],x({responses:Re},le),U({context:de,request:{structured:{nodeId:Me==null?void 0:Me.nodeId,intentId:Me==null?void 0:Me.intentId,choiceId:ce}}})},je=ce=>{G=G.filter(de=>de!==ce)};return{sendText:X,sendContext:async ce=>{const de=await Yl(`${C()}/context`,{method:"POST",headers:{...n.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":g.conversationId,"nlx-sdk-version":od.version},body:JSON.stringify({languageCode:g.languageCode,conversationId:g.conversationId,userId:g.userId,context:ce})});if(de.status>=400)throw new Error(`Responded with ${de.status}`)},appendMessageToTranscript:ce=>{const de={...ce,receivedAt:ce.receivedAt??new Date().getTime()};x({responses:[...g.responses,de]},de)},sendStructured:(ce,de)=>{z(ce,de),U({context:de,request:{structured:Nv(ce)}})},sendSlots:(ce,de)=>{z({slots:ce},de),U({context:de,request:{structured:{slots:My(ce)}}})},sendFlow:K,sendIntent:(ce,de)=>{Eo.warn("Calling `sendIntent` is deprecated and will be removed in a future version of the SDK. Use `sendFlow` instead."),K(ce,de)},sendWelcomeFlow:ce=>{K(Lv,ce)},sendWelcomeIntent:ce=>{Eo.warn("Calling `sendWelcomeIntent` is deprecated and will be removed in a future version of the SDK. Use `sendWelcomeFlow` instead."),K(Lv,ce)},sendChoice:he,submitFeedback:async(ce,de)=>{const Me=await Yl(ce,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({languageCode:g.languageCode,conversationId:g.conversationId,userId:g.userId,...de})});if(Me.status>=400)throw new Error(`Responded with ${Me.status}`)},currentConversationId:()=>g.conversationId,setLanguageCode:ce=>{if(ce===g.languageCode){Eo.warn("Attempted to set language code to the one already active.");return}Oa(u)&&D(),Q(),x({languageCode:ce})},currentLanguageCode:()=>g.languageCode,getVoiceCredentials:async(ce,de)=>{const Me=Dv(u),Re=await Yl(`${Me}-${g.languageCode}/requestToken`,{method:"POST",headers:{...n.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":g.conversationId,"nlx-sdk-version":od.version},body:JSON.stringify({languageCode:g.languageCode,conversationId:g.conversationId,userId:g.userId,requestToken:!0,context:ce,autoTriggerWelcomeFlow:(de==null?void 0:de.autoTriggerWelcomeFlow)??!0})});if(Re.status>=400)throw new Error(`Responded with ${Re.status}`);const le=await Re.json();if((le==null?void 0:le.url)==null)throw new Error("Invalid response");return le},subscribe:ce=>(G=[...G,ce],ce(jv(g)),()=>{je(ce)}),unsubscribe:je,unsubscribeAll:()=>{G=[]},reset:ce=>{x({conversationId:Av(),responses:(ce==null?void 0:ce.clearResponses)===!0?[]:g.responses}),Oa(u)&&D(),Q()},destroy:()=>{G=[],Oa(u)&&ie(),Y()},setRequestOverride:ce=>{A=ce},addEventListener:(ce,de)=>{h[ce]=[...h[ce],de]},removeEventListener:(ce,de)=>{h[ce]=h[ce].filter(Me=>Me!==de)},sendVoicePlusContext:ce=>{W({context:ce})}}}const RC=n=>(n.applicationUrl??"").length>0;function Ay(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var a=n.length;for(e=0;e<a;e++)n[e]&&(t=Ay(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function it(){for(var n,e,t=0,r="",a=arguments.length;t<a;t++)(n=arguments[t])&&(e=Ay(n))&&(r&&(r+=" "),r+=e);return r}const ot=n=>({width:n.size!=null?`${n.size}px`:"100%",height:n.size!=null?`${n.size}px`:"100%",className:n.className}),IC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M11 21H10L11 14H7.5C6.92 14 6.93 13.68 7.12 13.34C7.31 13 7.17 13.26 7.19 13.22C8.48 10.94 10.42 7.54 13 3H14L13 10H16.5C16.99 10 17.06 10.33 16.97 10.51L16.9 10.66C12.96 17.55 11 21 11 21Z",fill:"currentColor"})}),oc=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...ot(n),children:[R.jsx("path",{d:"M13.5562 5.34835C12.2796 6.62498 12.4866 8.90179 14.0186 10.4337C14.3377 10.7529 14.5571 11.134 14.6767 11.5383C14.8007 11.9572 14.8177 12.4011 14.7277 12.8268C14.6656 13.1203 14.5526 13.4051 14.3887 13.6672C14.3259 13.7677 14.2557 13.865 14.1778 13.9581C14.1279 14.018 14.0747 14.0761 14.0186 14.1322C13.3341 14.8166 12.3641 15.0421 11.4917 14.8092L11.4728 14.8042C9.38654 14.2543 7.32235 15.2129 6.85652 16.9516C6.5761 17.9979 5.50065 18.6188 4.45431 18.3385C3.40798 18.0581 2.787 16.9826 3.06729 15.9363C3.34209 14.9111 4.38012 14.2942 5.40615 14.5335L5.40666 14.5317C5.42748 14.5378 5.44842 14.5437 5.46962 14.5493C7.21342 15.0166 9.08173 13.699 9.64244 11.6062C9.64857 11.5835 9.65521 11.5608 9.66185 11.5383C9.7815 11.134 10.0009 10.7529 10.32 10.4337L10.332 10.4214C10.339 10.4142 10.346 10.407 10.3533 10.4C11.8549 8.86865 12.0496 6.61566 10.7824 5.34835C10.0163 4.58237 10.0163 3.34047 10.7824 2.57449C11.5483 1.8085 12.7903 1.8085 13.5562 2.57449C14.3066 3.32501 14.3218 4.53237 13.6016 5.30135L13.6029 5.30263C13.5872 5.3177 13.5716 5.33289 13.5562 5.34835Z",fill:"currentColor"}),R.jsx("path",{d:"M19.327 6.83185C20.0311 6.83185 20.6019 7.40264 20.6019 8.10675C20.6019 8.81087 20.0311 9.38166 19.327 9.38166C18.6229 9.38166 18.0521 8.81087 18.0521 8.10675C18.0521 7.40264 18.6229 6.83185 19.327 6.83185Z",fill:"currentColor"}),R.jsx("path",{d:"M21.3237 16.4754C21.3237 15.3741 20.4309 14.4813 19.3297 14.4813C18.2284 14.4813 17.3356 15.3741 17.3356 16.4754C17.3356 17.5767 18.2284 18.4695 19.3297 18.4695C20.4309 18.4695 21.3237 17.5767 21.3237 16.4754Z",fill:"currentColor"}),R.jsx("path",{d:"M12.1025 19.3194C12.8246 19.3194 13.4101 19.9195 13.4101 20.6597C13.4101 21.4 12.8246 22 12.1025 22C11.3804 22 10.7949 21.4 10.7949 20.6597C10.7949 19.9195 11.3804 19.3194 12.1025 19.3194Z",fill:"currentColor"}),R.jsx("path",{d:"M6.28367 8.13944C6.28367 7.41726 5.68363 6.83185 4.94339 6.83185C4.20314 6.83185 3.6031 7.41726 3.6031 8.13944C3.6031 8.86163 4.20314 9.44704 4.94339 9.44704C5.68363 9.44704 6.28367 8.86163 6.28367 8.13944Z",fill:"currentColor"})]}),MC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M6 13C5.45 13 5 13.45 5 14C5 14.55 5.45 15 6 15C6.55 15 7 14.55 7 14C7 13.45 6.55 13 6 13ZM6 17C5.45 17 5 17.45 5 18C5 18.55 5.45 19 6 19C6.55 19 7 18.55 7 18C7 17.45 6.55 17 6 17ZM6 9C5.45 9 5 9.45 5 10C5 10.55 5.45 11 6 11C6.55 11 7 10.55 7 10C7 9.45 6.55 9 6 9ZM3 9.5C2.72 9.5 2.5 9.72 2.5 10C2.5 10.28 2.72 10.5 3 10.5C3.28 10.5 3.5 10.28 3.5 10C3.5 9.72 3.28 9.5 3 9.5ZM6 5C5.45 5 5 5.45 5 6C5 6.55 5.45 7 6 7C6.55 7 7 6.55 7 6C7 5.45 6.55 5 6 5ZM21 10.5C21.28 10.5 21.5 10.28 21.5 10C21.5 9.72 21.28 9.5 21 9.5C20.72 9.5 20.5 9.72 20.5 10C20.5 10.28 20.72 10.5 21 10.5ZM14 7C14.55 7 15 6.55 15 6C15 5.45 14.55 5 14 5C13.45 5 13 5.45 13 6C13 6.55 13.45 7 14 7ZM14 3.5C14.28 3.5 14.5 3.28 14.5 3C14.5 2.72 14.28 2.5 14 2.5C13.72 2.5 13.5 2.72 13.5 3C13.5 3.28 13.72 3.5 14 3.5ZM3 13.5C2.72 13.5 2.5 13.72 2.5 14C2.5 14.28 2.72 14.5 3 14.5C3.28 14.5 3.5 14.28 3.5 14C3.5 13.72 3.28 13.5 3 13.5ZM10 20.5C9.72 20.5 9.5 20.72 9.5 21C9.5 21.28 9.72 21.5 10 21.5C10.28 21.5 10.5 21.28 10.5 21C10.5 20.72 10.28 20.5 10 20.5ZM10 3.5C10.28 3.5 10.5 3.28 10.5 3C10.5 2.72 10.28 2.5 10 2.5C9.72 2.5 9.5 2.72 9.5 3C9.5 3.28 9.72 3.5 10 3.5ZM10 7C10.55 7 11 6.55 11 6C11 5.45 10.55 5 10 5C9.45 5 9 5.45 9 6C9 6.55 9.45 7 10 7ZM10 12.5C9.17 12.5 8.5 13.17 8.5 14C8.5 14.83 9.17 15.5 10 15.5C10.83 15.5 11.5 14.83 11.5 14C11.5 13.17 10.83 12.5 10 12.5ZM18 13C17.45 13 17 13.45 17 14C17 14.55 17.45 15 18 15C18.55 15 19 14.55 19 14C19 13.45 18.55 13 18 13ZM18 17C17.45 17 17 17.45 17 18C17 18.55 17.45 19 18 19C18.55 19 19 18.55 19 18C19 17.45 18.55 17 18 17ZM18 9C17.45 9 17 9.45 17 10C17 10.55 17.45 11 18 11C18.55 11 19 10.55 19 10C19 9.45 18.55 9 18 9ZM18 5C17.45 5 17 5.45 17 6C17 6.55 17.45 7 18 7C18.55 7 19 6.55 19 6C19 5.45 18.55 5 18 5ZM21 13.5C20.72 13.5 20.5 13.72 20.5 14C20.5 14.28 20.72 14.5 21 14.5C21.28 14.5 21.5 14.28 21.5 14C21.5 13.72 21.28 13.5 21 13.5ZM14 17C13.45 17 13 17.45 13 18C13 18.55 13.45 19 14 19C14.55 19 15 18.55 15 18C15 17.45 14.55 17 14 17ZM14 20.5C13.72 20.5 13.5 20.72 13.5 21C13.5 21.28 13.72 21.5 14 21.5C14.28 21.5 14.5 21.28 14.5 21C14.5 20.72 14.28 20.5 14 20.5ZM10 8.5C9.17 8.5 8.5 9.17 8.5 10C8.5 10.83 9.17 11.5 10 11.5C10.83 11.5 11.5 10.83 11.5 10C11.5 9.17 10.83 8.5 10 8.5ZM10 17C9.45 17 9 17.45 9 18C9 18.55 9.45 19 10 19C10.55 19 11 18.55 11 18C11 17.45 10.55 17 10 17ZM14 12.5C13.17 12.5 12.5 13.17 12.5 14C12.5 14.83 13.17 15.5 14 15.5C14.83 15.5 15.5 14.83 15.5 14C15.5 13.17 14.83 12.5 14 12.5ZM14 8.5C13.17 8.5 12.5 9.17 12.5 10C12.5 10.83 13.17 11.5 14 11.5C14.83 11.5 15.5 10.83 15.5 10C15.5 9.17 14.83 8.5 14 8.5Z",fill:"currentColor"})}),OC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z",fill:"currentColor"})}),Ly=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12 15.41L6 9.40997L7.41 7.99997L12 12.58L16.59 7.99997L18 9.40997L12 15.41Z",fill:"currentColor"})}),Mp=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M7.59001 12L13.59 18L15 16.59L10.42 12L15 7.41002L13.59 6.00002L7.59001 12Z",fill:"currentColor"})}),Ny=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M15 12L9.00005 18L7.59005 16.59L12.17 12L7.59005 7.41002L9.00005 6.00002L15 12Z",fill:"currentColor"})}),AC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12 8L6 14L7.41 15.41L12 10.83L16.59 15.41L18 14L12 8Z",fill:"currentColor"})}),Ed=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z",fill:"currentColor"})}),Op=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M18.5 16H7C4.79 16 3 14.21 3 12C3 9.79 4.79 8 7 8H19.5C20.88 8 22 9.12 22 10.5C22 11.88 20.88 13 19.5 13H9C8.45 13 8 12.55 8 12C8 11.45 8.45 11 9 11H18.5V9.5H9C7.62 9.5 6.5 10.62 6.5 12C6.5 13.38 7.62 14.5 9 14.5H19.5C21.71 14.5 23.5 12.71 23.5 10.5C23.5 8.29 21.71 6.5 19.5 6.5H7C3.96 6.5 1.5 8.96 1.5 12C1.5 15.04 3.96 17.5 7 17.5H18.5V16Z",fill:"currentColor"})}),jy=n=>R.jsx("svg",{viewBox:"0 0 12 12",...ot(n),children:R.jsx("path",{d:"M10 1H2C1.45 1 1.005 1.45 1.005 2L1 11L3 9H10C10.55 9 11 8.55 11 8V2C11 1.45 10.55 1 10 1ZM6 7H3V6H6V7ZM9 5.5H3V4.5H9V5.5ZM9 4H3V3H9V4Z",fill:"currentColor"})}),LC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...ot(n),children:[R.jsx("path",{d:"M12 15.2C13.7673 15.2 15.2 13.7673 15.2 12C15.2 10.2327 13.7673 8.8 12 8.8C10.2327 8.8 8.8 10.2327 8.8 12C8.8 13.7673 10.2327 15.2 12 15.2Z",fill:"currentColor"}),R.jsx("path",{d:"M9 2L7.17 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4H16.83L15 2H9ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z",fill:"currentColor"})]}),Rf=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M8.99991 16.17L4.82991 12L3.40991 13.41L8.99991 19L20.9999 7L19.5899 5.59L8.99991 16.17Z",fill:"currentColor"})}),sc=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z",fill:"currentColor"})}),NC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z",fill:"currentColor"})}),Dy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3.01 4.9 3.01 6L3 20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM19 20H5V9H19V20Z",fill:"currentColor"})}),Fy=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...ot(n),children:[R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 21C6.9 21 6 20.1 6 19V7H18V19C18 20.1 17.1 21 16 21H8ZM9.33337 9H8V19H9.33337V9ZM11.3334 9V19H12.6666V9H11.3334ZM16 19H14.6666V9H16V19Z",fill:"currentColor"}),R.jsx("path",{d:"M15.5 4H19V6H5V4H8.5L9.5 3H14.5L15.5 4Z",fill:"currentColor"})]}),Uy=n=>R.jsx("svg",{viewBox:"0 0 16 16",...ot(n),children:R.jsx("path",{d:"M2 11.5002V14.0002H4.5L11.8733 6.62687L9.37333 4.12687L2 11.5002ZM13.8067 4.69354C14.0667 4.43354 14.0667 4.01354 13.8067 3.75354L12.2467 2.19354C11.9867 1.93354 11.5667 1.93354 11.3067 2.19354L10.0867 3.41354L12.5867 5.91354L13.8067 4.69354V4.69354Z",fill:"currentColor"})}),By=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...ot(n),children:[R.jsx("path",{d:"M21 12.22C21 6.73 16.74 3 12 3C7.31 3 3 6.65 3 12.28C2.4 12.62 2 13.26 2 14V16C2 17.1 2.9 18 4 18H5V11.9C5 8.03 8.13 4.9 12 4.9C15.87 4.9 19 8.03 19 11.9V19H11V21H19C20.1 21 21 20.1 21 19V17.78C21.59 17.47 22 16.86 22 16.14V13.84C22 13.14 21.59 12.53 21 12.22Z",fill:"currentColor"}),R.jsx("path",{d:"M9 14C9.55228 14 10 13.5523 10 13C10 12.4477 9.55228 12 9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14Z",fill:"currentColor"}),R.jsx("path",{d:"M15 14C15.5523 14 16 13.5523 16 13C16 12.4477 15.5523 12 15 12C14.4477 12 14 12.4477 14 13C14 13.5523 14.4477 14 15 14Z",fill:"currentColor"}),R.jsx("path",{d:"M18 11.03C17.52 8.18 15.04 6 12.05 6C9.02 6 5.76 8.51 6.02 12.45C8.49 11.44 10.35 9.24 10.88 6.56C12.19 9.19 14.88 11 18 11.03Z",fill:"currentColor"})]}),Ap=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z",fill:"currentColor"})}),jC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M7 14H5V19H10V17H7V14ZM5 10H7V7H10V5H5V10ZM17 17H14V19H19V14H17V17ZM14 5V7H17V10H19V5H14Z",fill:"currentColor"})}),sd=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12 15C13.66 15 14.99 13.66 14.99 12L15 6C15 4.34 13.66 3 12 3C10.34 3 9 4.34 9 6V12C9 13.66 10.34 15 12 15ZM17.3 12C17.3 15 14.76 17.1 12 17.1C9.24 17.1 6.7 15 6.7 12H5C5 15.42 7.72 18.23 11 18.72V22H13V18.72C16.28 18.24 19 15.42 19 12H17.3Z",fill:"currentColor"})}),If=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"currentColor"})}),DC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})}),ld=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M3 9.99999V14C3 14.55 3.45 15 4 15H7L10.29 18.29C10.92 18.92 12 18.47 12 17.58V6.40999C12 5.51999 10.92 5.06999 10.29 5.69999L7 8.99999H4C3.45 8.99999 3 9.44999 3 9.99999ZM16.5 12C16.5 10.23 15.48 8.70999 14 7.96999V16.02C15.48 15.29 16.5 13.77 16.5 12ZM14 4.44999V4.64999C14 5.02999 14.25 5.35999 14.6 5.49999C17.18 6.52999 19 9.05999 19 12C19 14.94 17.18 17.47 14.6 18.5C14.24 18.64 14 18.97 14 19.35V19.55C14 20.18 14.63 20.62 15.21 20.4C18.6 19.11 21 15.84 21 12C21 8.15999 18.6 4.88999 15.21 3.59999C14.63 3.36999 14 3.81999 14 4.44999Z",fill:"currentColor"})}),Mf=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M16.5 12C16.5 10.23 15.48 8.71 14 7.97V10.18L16.45 12.63C16.48 12.43 16.5 12.22 16.5 12ZM19 12C19 12.94 18.8 13.82 18.46 14.64L19.97 16.15C20.63 14.91 21 13.5 21 12C21 7.72 18.01 4.14 14 3.23V5.29C16.89 6.15 19 8.83 19 12ZM4.27 3L3 4.27L7.73 9H3V15H7L12 20V13.27L16.25 17.52C15.58 18.04 14.83 18.45 14 18.7V20.76C15.38 20.45 16.63 19.81 17.69 18.95L19.73 21L21 19.73L12 10.73L4.27 3ZM12 4L9.91 6.09L12 8.18V4Z",fill:"currentColor"})}),FC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12.87 15.07L10.33 12.56L10.36 12.53C12.1 10.59 13.34 8.36 14.07 6H17V4H10V2H8V4H1V5.99H12.17C11.5 7.92 10.44 9.75 9 11.35C8.07 10.32 7.3 9.19 6.69 8H4.69C5.42 9.63 6.42 11.17 7.67 12.56L2.58 17.58L4 19L9 14L12.11 17.11L12.87 15.07ZM18.5 10H16.5L12 22H14L15.12 19H19.87L21 22H23L18.5 10ZM15.88 17L17.5 12.67L19.12 17H15.88Z",fill:"currentColor"})}),UC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M19 19H5V5H12V3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V12H19V19ZM14 3V5H17.59L7.76 14.83L9.17 16.24L19 6.41V10H21V3H14Z",fill:"currentColor"})}),BC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M8 5V19L19 12L8 5Z",fill:"currentColor"})}),VC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...ot(n),children:[R.jsx("path",{d:"M13 14.5C13 15.3284 12.3284 16 11.5 16C10.6716 16 10 15.3284 10 14.5C10 13.6716 10.6716 13 11.5 13C12.3284 13 13 13.6716 13 14.5Z",fill:"currentColor"}),R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 2H14L20 8V20C20 21.1 19.1 22 18 22H5.99C4.89 22 4 21.1 4 20V4C4 2.9 4.9 2 6 2ZM13.16 17.57L15.04 19.45L16.45 18.04L14.57 16.16C15.29 14.83 15.1 13.15 13.98 12.03C12.61 10.66 10.4 10.66 9.03 12.03C7.66 13.4 7.66 15.61 9.03 16.98C10.15 18.1 11.83 18.28 13.16 17.57ZM13 3.5V9H18.5L13 3.5Z",fill:"currentColor"})]}),HC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M3 15H21V13H3V15ZM3 19H21V17H3V19ZM3 11H21V9H3V11ZM3 5V7H21V5H3Z",fill:"currentColor"})}),lc=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M10 3C14.97 3 19 7.03 19 12H22L18.11 15.89L18.04 16.03L14 12H17C17 8.13 13.87 5 10 5C6.13 5 3 8.13 3 12C3 15.87 6.13 19 10 19V21C5.03 21 1 16.97 1 12C1 7.03 5.03 3 10 3Z",fill:"currentColor"})}),Vy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M19.1064 12.9302C19.1459 12.6333 19.1657 12.3266 19.1657 12C19.1657 11.6833 19.1459 11.3667 19.0965 11.0698L21.1053 9.50625C21.2834 9.36771 21.3329 9.10052 21.2241 8.9026L19.3241 5.61719C19.2053 5.39948 18.9579 5.33021 18.7402 5.39948L16.3751 6.34948C15.8803 5.97344 15.3558 5.65677 14.772 5.41927L14.4157 2.90573C14.3761 2.66823 14.1782 2.5 13.9407 2.5H10.1407C9.90323 2.5 9.71521 2.66823 9.67563 2.90573L9.31938 5.41927C8.73552 5.65677 8.20115 5.98333 7.71625 6.34948L5.35115 5.39948C5.13344 5.32031 4.88604 5.39948 4.7673 5.61719L2.87719 8.9026C2.75844 9.11042 2.79802 9.36771 2.99594 9.50625L5.00479 11.0698C4.95532 11.3667 4.91573 11.6932 4.91573 12C4.91573 12.3068 4.93552 12.6333 4.985 12.9302L2.97615 14.4938C2.79802 14.6323 2.74855 14.8995 2.8574 15.0974L4.7574 18.3828C4.87615 18.6005 5.12354 18.6698 5.34125 18.6005L7.70636 17.6505C8.20115 18.0266 8.72563 18.3432 9.30948 18.5807L9.66573 21.0943C9.71521 21.3318 9.90323 21.5 10.1407 21.5H13.9407C14.1782 21.5 14.3761 21.3318 14.4058 21.0943L14.7621 18.5807C15.3459 18.3432 15.8803 18.0266 16.3652 17.6505L18.7303 18.6005C18.948 18.6797 19.1954 18.6005 19.3142 18.3828L21.2142 15.0974C21.3329 14.8797 21.2834 14.6323 21.0954 14.4938L19.1064 12.9302ZM12.0407 15.5625C10.0814 15.5625 8.47823 13.9594 8.47823 12C8.47823 10.0406 10.0814 8.4375 12.0407 8.4375C14.0001 8.4375 15.6032 10.0406 15.6032 12C15.6032 13.9594 14.0001 15.5625 12.0407 15.5625Z",fill:"currentColor"})}),qC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z",fill:"currentColor"})}),WC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),Hy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M1 21H23L12 2L1 21ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z",fill:"currentColor"})}),qy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M15 3H6C5.17 3 4.46 3.5 4.16 4.22L1.14 11.27C1.05 11.5 1 11.74 1 12V14C1 15.1 1.9 16 3 16H9.31L8.36 20.57L8.33 20.89C8.33 21.3 8.5 21.68 8.77 21.95L9.83 23L16.42 16.41C16.78 16.05 17 15.55 17 15V5C17 3.9 16.1 3 15 3ZM19 3V15H23V3H19Z",fill:"currentColor"})}),Wy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M1 21H5V9H1V21ZM23 10C23 8.9 22.1 8 21 8H14.69L15.64 3.43L15.67 3.11C15.67 2.7 15.5 2.32 15.23 2.05L14.17 1L7.59 7.59C7.22 7.95 7 8.45 7 9V19C7 20.1 7.9 21 9 21H18C18.83 21 19.54 20.5 19.84 19.78L22.86 12.73C22.95 12.5 23 12.26 23 12V10Z",fill:"currentColor"})}),zC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...ot(n),children:[R.jsx("path",{d:"M11 7H12.5V12.25L17 14.92L16.25 16.15L11 13V7Z",fill:"currentColor"}),R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47997 6.47 1.99997 11.99 1.99997C17.52 1.99997 22 6.47997 22 12C22 17.52 17.52 22 11.99 22C6.47 22 2 17.52 2 12ZM4 12C4 16.42 7.58 20 12 20C16.42 20 20 16.42 20 12C20 7.57997 16.42 3.99997 12 3.99997C7.58 3.99997 4 7.57997 4 12Z",fill:"currentColor"})]}),zy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M13 3C8.03 3 4 7.03 4 12H1L4.89 15.89L4.96 16.03L9 12H6C6 8.13 9.13 5 13 5C16.87 5 20 8.13 20 12C20 15.87 16.87 19 13 19V21C17.97 21 22 16.97 22 12C22 7.03 17.97 3 13 3Z",fill:"currentColor"})}),GC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M12 4V1L8 5L12 9V6C15.31 6 18 8.69 18 12C18 13.01 17.75 13.97 17.3 14.8L18.76 16.26C19.54 15.03 20 13.57 20 12C20 7.58 16.42 4 12 4ZM12 18C8.69 18 6 15.31 6 12C6 10.99 6.25 10.03 6.7 9.2L5.24 7.74C4.46 8.97 4 10.43 4 12C4 16.42 7.58 20 12 20V23L16 19L12 15V18Z",fill:"currentColor"})}),$C=n=>R.jsx("svg",{viewBox:"0 0 24 24",...ot(n),children:R.jsx("path",{d:"M11 18H13V16H11V18ZM12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 12 11 11.75 11 15H13C13 12.75 16 12.5 16 10C16 7.79 14.21 6 12 6Z",fill:"currentColor"})}),Gy=n=>R.jsxs("svg",{viewBox:"0 0 16 16",...ot(n),fill:"currentColor",children:[R.jsx("path",{d:"M12.6667 7.33326V12.6666H3.33333V3.33326H8.66667V1.99992H3.33333C2.6 1.99992 2 2.59992 2 3.33326V12.6666C2 13.3999 2.6 13.9999 3.33333 13.9999H12.6667C13.4 13.9999 14 13.3999 14 12.6666V7.33326H12.6667Z"}),R.jsx("path",{d:"M14.0183 1.97412L10.0699 1.97412L11.5506 3.45477L7.66668 7.33327L8.65378 8.32037L12.5377 4.44188L14.0183 5.92253V1.97412Z"})]}),KC=Object.freeze(Object.defineProperty({__proto__:null,Action:IC,Add:OC,ArrowDown:Ly,ArrowForward:Ed,ArrowLeft:Mp,ArrowRight:Ny,ArrowUp:AC,AssistantOld:MC,Attachment:Op,BotMessage:jy,Camera:LC,Check:Rf,Close:sc,Copy:NC,Date:Dy,Delete:Fy,Edit:Uy,Error:Ap,Escalate:By,FullScreen:jC,Help:$C,Location:DC,Mic:sd,MicOff:If,OpenInNew:UC,OpenLink:Gy,Play:BC,Preview:VC,Refresh:GC,Reorder:HC,Restart:lc,Search:qC,Settings:Vy,Share:WC,ThumbDown:qy,ThumbUp:Wy,Time:zC,Touchpoint:oc,Translate:FC,Undo:zy,Volume:ld,VolumeOff:Mf,Warning:Hy},Symbol.toStringTag,{value:"Module"})),JC=n=>{const{Custom:e}=n;return e!=null?R.jsx(e,{className:n.className,onClick:n.onClick}):R.jsxs("button",{className:it("p-3 w-fit bg-background text-primary-80 rounded-outer","after:content-[''] after:rounded-outer after:absolute after:inset-0 after:pointer-events-none","hover:after:bg-primary-10",n.className),disabled:n.onClick==null,onClick:n.onClick,children:[R.jsx("span",{className:"block flex-none w-8 h-8",children:n.iconUrl==null?R.jsx(oc,{}):R.jsx("img",{src:n.iconUrl,className:"w-8 h-8"})}),n.showLabel??!1?R.jsx("span",{children:n.label}):null]})},$y="p-3 w-10 h-10 transition-colors rounded-inner relative z-10 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent focus:outline-0",Ky="bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40",Jy="bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20",Yy="bg-accent text-secondary-80 enabled:hover:before:bg-primary-40 focus:before:bg-primary-40 enabled:active:before:bg-secondary-10 disabled:bg-accent-20",Xy="bg-secondary-60 backdrop-blur-sm text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",Qy="bg-background backdrop-blur-sm text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",Zy="bg-error-primary text-secondary-80 enabled:hover:before:bg-primary-10",YC=({type:n,Icon:e})=>R.jsx("span",{className:it($y,"block",n==="main"?Ky:null,n==="ghost"?Jy:null,n==="activated"?Yy:null,n==="coverup"?Xy:null,n==="overlay"?Qy:null,n==="error"?Zy:null),children:R.jsx(e,{})}),un=({onClick:n,type:e,label:t,className:r,Icon:a})=>{const s=n==null;return R.jsx("button",{onClick:s?void 0:n,disabled:s,"aria-label":t,className:it($y,e==="main"?Ky:null,e==="ghost"?Jy:null,e==="activated"?Yy:null,e==="coverup"?Xy:null,e==="overlay"?Qy:null,e==="error"?Zy:null,r),children:R.jsx(a,{})})};function XC(n){const e=ve.useRef(n);return e.current=n,ve.useMemo(()=>Object.freeze({get current(){return e.current}}),[])}function QC(n){const e=XC(n);ve.useEffect(()=>()=>{e.current()},[])}function ZC(n,e,t,r=0){const a=ve.useRef(),s=ve.useRef(),l=ve.useRef(n),u=ve.useRef(),h=()=>{a.current&&(clearTimeout(a.current),a.current=void 0),s.current&&(clearTimeout(s.current),s.current=void 0)};return QC(h),ve.useEffect(()=>{l.current=n},e),ve.useMemo(()=>{const f=()=>{if(h(),!u.current)return;const C=u.current;u.current=void 0,l.current.apply(C.this,C.args)},g=function(...C){a.current&&clearTimeout(a.current),u.current={args:C,this:this},a.current=setTimeout(f,t),r>0&&!s.current&&(s.current=setTimeout(f,r))};return Object.defineProperties(g,{length:{value:n.length},name:{value:`${n.name||"anonymous"}__debounced__${t}`}}),g},[t,r,...e])}const eS=typeof globalThis<"u"&&typeof navigator<"u"&&typeof document<"u";function Fv(n,e,t=0){const[r,a]=ve.useState(n);return[r,ZC(a,[],e,t)]}const Hs=new Map,e0=n=>{const e=matchMedia(n),t=new Set,r=()=>{for(const a of t)a(e.matches)};return e.addEventListener("change",r,{passive:!0}),{mql:e,dispatchers:t,listener:r}},tS=(n,e)=>{let t=Hs.get(n);t||(t=e0(n),Hs.set(n,t)),t.dispatchers.add(e),e(t.mql.matches)},nS=(n,e)=>{const t=Hs.get(n);if(t){const{mql:r,dispatchers:a,listener:s}=t;a.delete(e),a.size===0&&(Hs.delete(n),r.removeEventListener?r.removeEventListener("change",s):r.removeListener(s))}};function rS(n,e={}){let{initializeWithValue:t=!0}=e;eS||(t=!1);const[r,a]=ve.useState(()=>{if(t){let s=Hs.get(n);return s||(s=e0(n),Hs.set(n,s)),s.mql.matches}});return ve.useEffect(()=>(tS(n,a),()=>{nS(n,a)}),[n]),r}const t0=n=>{let e;switch(n){case"sm":e="(min-width: 640px)";break;case"md":e="(min-width: 768px)";break;case"lg":e="(min-width: 1024px)";break}return rS(e)},iS=({windowSize:n,renderCollapse:e,errorThemedCloseButton:t,speakerControls:r,collapse:a,toggleSettings:s,isSettingsOpen:l,brandIcon:u,reset:h,enabled:f})=>{const g=n==="half",C=t0("md"),x=g&&C?"overlay":"ghost";return R.jsxs("div",{className:it("flex p-2 md:p-3 items-center justify-between gap-2",{"md:absolute md:w-fit md:flex-col md:left-0 md:transform md:-translate-x-full md:translate-y-0":n==="half","@3xl/main:absolute @3xl/main:left-0 @3xl/main:right-0 @3xl/main:top-0":n==="full"||n==="embedded"}),children:[u!=null?R.jsx("img",{className:"w-10 h-10 block flex-none",src:u,role:"presentation"}):null,R.jsx(un,{label:"Reset",type:x,className:u==null?"":"ml-auto",onClick:f?()=>{h()}:void 0,Icon:zy}),s!=null?R.jsx(un,{className:u!=null?"":"ml-auto",Icon:Vy,label:"Settings",type:l?"activated":x,onClick:f?s:void 0}):null,r!=null?R.jsx(un,{Icon:r.enabled?ld:Mf,label:"Speakers",type:r.enabled?"activated":x,onClick:()=>{r.setEnabled(T=>!T)}}):null,e?R.jsx(un,{label:"Collapse",type:t??!1?"error":x,className:it(s==null?"ml-auto":"",g?"md:-order-1":""),onClick:f?()=>{a(new Event("collapse"))}:void 0,Icon:sc}):null]})},n0=()=>R.jsxs("div",{className:it("grow flex flex-col items-center justify-center gap-6 text-primary-80","fullscreen-error"),children:[R.jsx(oc,{className:"w-20 h-20 text-primary-20"}),R.jsxs("div",{className:"text-center",children:[R.jsx("h3",{className:"text-xl mb-2",children:"Oops!"}),R.jsx("p",{children:"Something went wrong."}),R.jsx("p",{children:"Try again later."})]})]}),Nu=({k:n,className:e,style:t})=>{const r=a=>`${a}s`;return R.jsx("div",{className:it("bg-current animate-ping absolute inset-0",e),style:{animationDelay:r(-1.5*n),animationDuration:r(1.5),...t??{}}})},cc=({className:n,style:e})=>{const t=it("text-accent-20",n);return R.jsxs(R.Fragment,{children:[R.jsx(Nu,{k:.12,className:t,style:e}),R.jsx(Nu,{k:.24,className:t,style:e}),R.jsx(Nu,{k:.36,className:t,style:e}),R.jsx(Nu,{k:.48,className:t,style:e})]})},aS=30,Dl=17,oS=n=>n<.5?2*n*n:1-Math.pow(-2*n+2,2)/2,Lp=990,sS=300,ju=Lp+sS,lS=({d:n})=>{const e=Math.PI/2,t=n/Dl/2.8,r=e*Math.min(t,1),a=t<1?(n-Math.sin(r))/Math.cos(r)*.5:0,s=-n,l=n,u=n-Dl*Math.sin(r),h=Dl*Math.cos(r),f=u-a*Math.cos(r),g=h-a*Math.sin(r);return R.jsxs(R.Fragment,{children:[R.jsx("circle",{cx:s,cy:"0",r:Dl}),R.jsx("circle",{cx:l,cy:"0",r:Dl}),t<.45?R.jsx("path",{d:`
            M${-u},${h} 
            C${-f},${g} ${f},${g} ${u},${h} L${u},${-h}
            C${f},${-g} ${-f},${-g} ${-u},${-h} Z
          `}):null]})},cS=n=>n<1/3?n*3:n<2/3?1:3-n*3,Uv=n=>n<1/3?0:n<2/3?(n-1/3)*3:1,r0=()=>{const[n,e]=ve.useState(null),t=ve.useRef(!1);if(ve.useEffect(()=>{const C=x=>{e(T=>T==null?{start:x,current:x}:{...T,current:x}),t.current||requestAnimationFrame(C)};t.current||requestAnimationFrame(C)},[t,e]),n==null)return null;let r,a;const s=n.current-n.start,l=s%ju,u=Math.floor(s/ju);if(l<Lp){const C=s/ju,x=Math.floor(C),T=oS((C-x)*(ju/Lp));r=cS(T),a=u%2?Uv(T):1+Uv(T)}else r=0,a=0;const h=r>.2?0:5*(.2-r)/.2,f=.3,g=r>f?1-.25*(r-f)/(1-f):1;return R.jsx("svg",{viewBox:"0 0 100 100",stroke:"none",fill:"currentColor",style:{filter:`drop-shadow(0 0 ${h}px var(--accent))`},children:R.jsx("g",{transform:`translate(50 50) rotate(${a*90})`,opacity:g,children:R.jsx(lS,{d:aS*r})})})},i0=({label:n,className:e})=>R.jsx("div",{className:it("h-full w-full flex items-center justify-center",e),children:R.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[R.jsx("div",{className:it("w-8 h-8 block text-accent"),children:R.jsx(r0,{})}),n!=null?R.jsx("p",{className:"text-primary-60 max-w-sm text-center",children:n}):null]})}),ra=({onClick:n,label:e,type:t="ghost",Icon:r,className:a})=>R.jsxs("button",{onClick:n,disabled:n==null,className:it("relative z-10 w-full px-5 py-4 transition-colors rounded-outer flex justify-between items-center focus:outline-0 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",{"bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40":t==="main","bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-5 focus:before:bg-primary-5 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20":t==="ghost"},a),children:[e,R.jsx(r,{size:16})]});function uS(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}var dS=Object.defineProperty,hS=(n,e,t)=>e in n?dS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Bv=(n,e,t)=>hS(n,typeof e!="symbol"?e+"":e,t);class Xn{constructor(){Bv(this,"_locking"),Bv(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(a=>e=()=>{this._locks-=1,a()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),r}}function Kt(n,e){if(!n)throw new Error(e)}const pS=34028234663852886e22,fS=-34028234663852886e22,mS=4294967295,gS=2147483647,vS=-2147483648;function qu(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>gS||n<vS)throw new Error("invalid int 32: "+n)}function Np(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>mS||n<0)throw new Error("invalid uint 32: "+n)}function a0(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>pS||n<fS))throw new Error("invalid float 32: "+n)}const o0=Symbol("@bufbuild/protobuf/enum-type");function bS(n){const e=n[o0];return Kt(e,"missing enum type on enum object"),e}function s0(n,e,t,r){n[o0]=l0(e,t.map(a=>({no:a.no,name:a.name,localName:n[a.no]})))}function l0(n,e,t){const r=Object.create(null),a=Object.create(null),s=[];for(const l of e){const u=c0(l);s.push(u),r[l.name]=u,a[l.no]=u}return{typeName:n,values:s,findName(l){return r[l]},findNumber(l){return a[l]}}}function yS(n,e,t){const r={};for(const a of e){const s=c0(a);r[s.localName]=s.no,r[s.no]=s.localName}return s0(r,n,e),r}function c0(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class Of{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),a=r.runtime.bin,s=a.makeReadOptions(t);return a.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,t){const r=this.getType(),a=r.runtime.json,s=a.makeReadOptions(t);return a.readMessage(r,e,s,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(a){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(a instanceof Error?a.message:String(a)))}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,a=r.makeWriteOptions(e),s=a.writerFactory();return r.writeMessage(this,s,a),s.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,a=r.makeWriteOptions(e);return r.writeMessage(this,a)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function wS(n,e,t,r){var a;const s=(a=r==null?void 0:r.localName)!==null&&a!==void 0?a:e.substring(e.lastIndexOf(".")+1),l={[s]:function(u){n.util.initFields(this),n.util.initPartial(u,this)}}[s];return Object.setPrototypeOf(l.prototype,new Of),Object.assign(l,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(u,h){return new l().fromBinary(u,h)},fromJson(u,h){return new l().fromJson(u,h)},fromJsonString(u,h){return new l().fromJsonString(u,h)},equals(u,h){return n.util.equals(l,u,h)}}),l}function kS(){let n=0,e=0;for(let r=0;r<28;r+=7){let a=this.buf[this.pos++];if(n|=(a&127)<<r,(a&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let a=this.buf[this.pos++];if(e|=(a&127)<<r,(a&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function lp(n,e,t){for(let s=0;s<28;s=s+7){const l=n>>>s,u=!(!(l>>>7)&&e==0),h=(u?l|128:l)&255;if(t.push(h),!u)return}const r=n>>>28&15|(e&7)<<4,a=e>>3!=0;if(t.push((a?r|128:r)&255),!!a){for(let s=3;s<31;s=s+7){const l=e>>>s,u=!!(l>>>7),h=(u?l|128:l)&255;if(t.push(h),!u)return}t.push(e>>>31&1)}}const Wu=4294967296;function Vv(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,a=0;function s(l,u){const h=Number(n.slice(l,u));a*=t,r=r*t+h,r>=Wu&&(a=a+(r/Wu|0),r=r%Wu)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?d0(r,a):Af(r,a)}function CS(n,e){let t=Af(n,e);const r=t.hi&2147483648;r&&(t=d0(t.lo,t.hi));const a=u0(t.lo,t.hi);return r?"-"+a:a}function u0(n,e){if({lo:n,hi:e}=SS(n,e),e<=2097151)return String(Wu*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,a=e>>16&65535;let s=t+r*6777216+a*6710656,l=r+a*8147497,u=a*2;const h=1e7;return s>=h&&(l+=Math.floor(s/h),s%=h),l>=h&&(u+=Math.floor(l/h),l%=h),u.toString()+Hv(l)+Hv(s)}function SS(n,e){return{lo:n>>>0,hi:e>>>0}}function Af(n,e){return{lo:n|0,hi:e|0}}function d0(n,e){return e=~e,n?n=~n+1:e+=1,Af(n,e)}const Hv=n=>{const e=String(n);return"0000000".slice(e.length)+e};function qv(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function TS(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function xS(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof tv!="object"||tv.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),a=BigInt("9223372036854775807"),s=BigInt("0"),l=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(u){const h=typeof u=="bigint"?u:BigInt(u);if(h>a||h<r)throw new Error("int64 invalid: ".concat(u));return h},uParse(u){const h=typeof u=="bigint"?u:BigInt(u);if(h>l||h<s)throw new Error("uint64 invalid: ".concat(u));return h},enc(u){return n.setBigInt64(0,this.parse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(u){return n.setBigInt64(0,this.uParse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(u,h){return n.setInt32(0,u,!0),n.setInt32(4,h,!0),n.getBigInt64(0,!0)},uDec(u,h){return n.setInt32(0,u,!0),n.setInt32(4,h,!0),n.getBigUint64(0,!0)}}}const e=r=>Kt(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),t=r=>Kt(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),e(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),t(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),e(r),Vv(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),t(r),Vv(r)},dec(r,a){return CS(r,a)},uDec(r,a){return u0(r,a)}}}const Ft=xS();var ge;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(ge||(ge={}));var Ua;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(Ua||(Ua={}));function Ra(n,e,t){if(e===t)return!0;if(n==ge.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return e==t}return!1}function qs(n,e){switch(n){case ge.BOOL:return!1;case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return e==0?Ft.zero:"0";case ge.DOUBLE:case ge.FLOAT:return 0;case ge.BYTES:return new Uint8Array(0);case ge.STRING:return"";default:return 0}}function h0(n,e){switch(n){case ge.BOOL:return e===!1;case ge.STRING:return e==="";case ge.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Zt;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Zt||(Zt={}));class ES{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let a=0;a<this.chunks.length;a++)e+=this.chunks[a].length;let t=new Uint8Array(e),r=0;for(let a=0;a<this.chunks.length;a++)t.set(this.chunks[a],r),r+=this.chunks[a].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Np(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return qu(e),qv(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){a0(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Np(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){qu(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return qu(e),e=(e<<1^e>>31)>>>0,qv(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),a=Ft.enc(e);return r.setInt32(0,a.lo,!0),r.setInt32(4,a.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),a=Ft.uEnc(e);return r.setInt32(0,a.lo,!0),r.setInt32(4,a.hi,!0),this.raw(t)}int64(e){let t=Ft.enc(e);return lp(t.lo,t.hi,this.buf),this}sint64(e){let t=Ft.enc(e),r=t.hi>>31,a=t.lo<<1^r,s=(t.hi<<1|t.lo>>>31)^r;return lp(a,s,this.buf),this}uint64(e){let t=Ft.uEnc(e);return lp(t.lo,t.hi,this.buf),this}}class _S{constructor(e,t){this.varint64=kS,this.uint32=TS,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case Zt.Varint:for(;this.buf[this.pos++]&128;);break;case Zt.Bit64:this.pos+=4;case Zt.Bit32:this.pos+=4;break;case Zt.LengthDelimited:let a=this.uint32();this.pos+=a;break;case Zt.StartGroup:for(;;){const[s,l]=this.tag();if(l===Zt.EndGroup){if(t!==void 0&&s!==t)throw new Error("invalid end group tag");break}this.skip(l,s)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ft.dec(...this.varint64())}uint64(){return Ft.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,Ft.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ft.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ft.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function PS(n,e,t,r){let a;return{typeName:e,extendee:t,get field(){if(!a){const s=typeof r=="function"?r():r;s.name=e.split(".").pop(),s.jsonName="[".concat(e,"]"),a=n.util.newFieldList([s]).list()[0]}return a},runtime:n}}function p0(n){const e=n.field.localName,t=Object.create(null);return t[e]=RS(n),[t,()=>t[e]]}function RS(n){const e=n.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return qs(e.T,e.L);case"message":const t=e.T,r=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function IS(n,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=n.length-1;t>=0;--t)if(n[t].no==e.no)return[n[t]];return[]}return n.filter(t=>t.no===e.no)}let Qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),_d=[];for(let n=0;n<Qi.length;n++)_d[Qi[n].charCodeAt(0)]=n;_d[45]=Qi.indexOf("+");_d[95]=Qi.indexOf("/");const f0={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,a=0,s,l=0;for(let u=0;u<n.length;u++){if(s=_d[n.charCodeAt(u)],s===void 0)switch(n[u]){case"=":a=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:l=s,a=1;break;case 1:t[r++]=l<<2|(s&48)>>4,l=s,a=2;break;case 2:t[r++]=(l&15)<<4|(s&60)>>2,l=s,a=3;break;case 3:t[r++]=(l&3)<<6|s,a=0;break}}if(a==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,a=0;for(let s=0;s<n.length;s++)switch(r=n[s],t){case 0:e+=Qi[r>>2],a=(r&3)<<4,t=1;break;case 1:e+=Qi[a|r>>4],a=(r&15)<<2,t=2;break;case 2:e+=Qi[a|r>>6],e+=Qi[r&63],t=0;break}return t&&(e+=Qi[a],e+="=",t==1&&(e+="=")),e}};function MS(n,e,t){g0(e,n);const r=e.runtime.bin.makeReadOptions(t),a=IS(n.getType().runtime.bin.listUnknownFields(n),e.field),[s,l]=p0(e);for(const u of a)e.runtime.bin.readField(s,r.readerFactory(u.data),e.field,u.wireType,r);return l()}function OS(n,e,t,r){g0(e,n);const a=e.runtime.bin.makeReadOptions(r),s=e.runtime.bin.makeWriteOptions(r);if(m0(n,e)){const f=n.getType().runtime.bin.listUnknownFields(n).filter(g=>g.no!=e.field.no);n.getType().runtime.bin.discardUnknownFields(n);for(const g of f)n.getType().runtime.bin.onUnknownField(n,g.no,g.wireType,g.data)}const l=s.writerFactory();let u=e.field;!u.opt&&!u.repeated&&(u.kind=="enum"||u.kind=="scalar")&&(u=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(u,t,l,s);const h=a.readerFactory(l.finish());for(;h.pos<h.len;){const[f,g]=h.tag(),C=h.skip(g,f);n.getType().runtime.bin.onUnknownField(n,f,g,C)}}function m0(n,e){const t=n.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(n).find(r=>r.no==e.field.no)}function g0(n,e){Kt(n.extendee.typeName==e.getType().typeName,"extension ".concat(n.typeName," can only be applied to message ").concat(n.extendee.typeName))}function v0(n,e){const t=n.localName;if(n.repeated)return e[t].length>0;if(n.oneof)return e[n.oneof.localName].case===t;switch(n.kind){case"enum":case"scalar":return n.opt||n.req?e[t]!==void 0:n.kind=="enum"?e[t]!==n.T.values[0].no:!h0(n.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function Wv(n,e){const t=n.localName,r=!n.opt&&!n.req;if(n.repeated)e[t]=[];else if(n.oneof)e[n.oneof.localName]={case:void 0};else switch(n.kind){case"map":e[t]={};break;case"enum":e[t]=r?n.T.values[0].no:void 0;break;case"scalar":e[t]=r?qs(n.T,n.L):void 0;break;case"message":e[t]=void 0;break}}function Zi(n,e){if(n===null||typeof n!="object"||!Object.getOwnPropertyNames(Of.prototype).every(r=>r in n&&typeof n[r]=="function"))return!1;const t=n.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function b0(n,e){return Zi(e)||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}ge.DOUBLE,ge.FLOAT,ge.INT64,ge.UINT64,ge.INT32,ge.UINT32,ge.BOOL,ge.STRING,ge.BYTES;const zv={ignoreUnknownFields:!1},Gv={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function AS(n){return n?Object.assign(Object.assign({},zv),n):zv}function LS(n){return n?Object.assign(Object.assign({},Gv),n):Gv}const cd=Symbol(),zu=Symbol();function NS(){return{makeReadOptions:AS,makeWriteOptions:LS,readMessage(n,e,t,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(Ei(e)));r=r??new n;const a=new Map,s=t.typeRegistry;for(const[l,u]of Object.entries(e)){const h=n.fields.findJsonName(l);if(h){if(h.oneof){if(u===null&&h.kind=="scalar")continue;const f=a.get(h.oneof);if(f!==void 0)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(h.oneof.name,'" present: "').concat(f,'", "').concat(l,'"'));a.set(h.oneof,l)}$v(r,u,h,t,n)}else{let f=!1;if(s!=null&&s.findExtension&&l.startsWith("[")&&l.endsWith("]")){const g=s.findExtension(l.substring(1,l.length-1));if(g&&g.extendee.typeName==n.typeName){f=!0;const[C,x]=p0(g);$v(C,u,g.field,t,g),OS(r,g,x(),t)}}if(!f&&!t.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(l,'" is unknown'))}}return r},writeMessage(n,e){const t=n.getType(),r={};let a;try{for(a of t.fields.byNumber()){if(!v0(a,n)){if(a.req)throw"required field not set";if(!e.emitDefaultValues||!DS(a))continue}const l=a.oneof?n[a.oneof.localName].value:n[a.localName],u=Kv(a,l,e);u!==void 0&&(r[e.useProtoFieldName?a.name:a.jsonName]=u)}const s=e.typeRegistry;if(s!=null&&s.findExtensionFor)for(const l of t.runtime.bin.listUnknownFields(n)){const u=s.findExtensionFor(t.typeName,l.no);if(u&&m0(n,u)){const h=MS(n,u,e),f=Kv(u.field,h,e);f!==void 0&&(r[u.field.jsonName]=f)}}}catch(s){const l=a?"cannot encode field ".concat(t.typeName,".").concat(a.name," to JSON"):"cannot encode message ".concat(t.typeName," to JSON"),u=s instanceof Error?s.message:String(s);throw new Error(l+(u.length>0?": ".concat(u):""))}return r},readScalar(n,e,t){return Xl(n,e,t??Ua.BIGINT,!0)},writeScalar(n,e,t){if(e!==void 0&&(t||h0(n,e)))return Gu(n,e)},debug:Ei}}function Ei(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function $v(n,e,t,r,a){let s=t.localName;if(t.repeated){if(Kt(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Ei(e)));const l=n[s];for(const u of e){if(u===null)throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Ei(u)));switch(t.kind){case"message":l.push(t.T.fromJson(u,r));break;case"enum":const h=cp(t.T,u,r.ignoreUnknownFields,!0);h!==zu&&l.push(h);break;case"scalar":try{l.push(Xl(t.T,u,t.L,!0))}catch(f){let g="cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Ei(u));throw f instanceof Error&&f.message.length>0&&(g+=": ".concat(f.message)),new Error(g)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Ei(e)));const l=n[s];for(const[u,h]of Object.entries(e)){if(h===null)throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: map value null"));let f;try{f=jS(t.K,u)}catch(g){let C="cannot decode map key for field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Ei(e));throw g instanceof Error&&g.message.length>0&&(C+=": ".concat(g.message)),new Error(C)}switch(t.V.kind){case"message":l[f]=t.V.T.fromJson(h,r);break;case"enum":const g=cp(t.V.T,h,r.ignoreUnknownFields,!0);g!==zu&&(l[f]=g);break;case"scalar":try{l[f]=Xl(t.V.T,h,Ua.BIGINT,!0)}catch(C){let x="cannot decode map value for field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Ei(e));throw C instanceof Error&&C.message.length>0&&(x+=": ".concat(C.message)),new Error(x)}break}}}else switch(t.oneof&&(n=n[t.oneof.localName]={case:s},s="value"),t.kind){case"message":const l=t.T;if(e===null&&l.typeName!="google.protobuf.Value")return;let u=n[s];Zi(u)?u.fromJson(e,r):(n[s]=u=l.fromJson(e,r),l.fieldWrapper&&!t.oneof&&(n[s]=l.fieldWrapper.unwrapField(u)));break;case"enum":const h=cp(t.T,e,r.ignoreUnknownFields,!1);switch(h){case cd:Wv(t,n);break;case zu:break;default:n[s]=h;break}break;case"scalar":try{const f=Xl(t.T,e,t.L,!1);switch(f){case cd:Wv(t,n);break;default:n[s]=f;break}}catch(f){let g="cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Ei(e));throw f instanceof Error&&f.message.length>0&&(g+=": ".concat(f.message)),new Error(g)}break}}function jS(n,e){if(n===ge.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Xl(n,e,Ua.BIGINT,!0).toString()}function Xl(n,e,t,r){if(e===null)return r?qs(n,t):cd;switch(n){case ge.DOUBLE:case ge.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const a=Number(e);if(Number.isNaN(a)||!Number.isFinite(a))break;return n==ge.FLOAT&&a0(a),a;case ge.INT32:case ge.FIXED32:case ge.SFIXED32:case ge.SINT32:case ge.UINT32:let s;if(typeof e=="number"?s=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(s=Number(e)),s===void 0)break;return n==ge.UINT32||n==ge.FIXED32?Np(s):qu(s),s;case ge.INT64:case ge.SFIXED64:case ge.SINT64:if(typeof e!="number"&&typeof e!="string")break;const l=Ft.parse(e);return t?l.toString():l;case ge.FIXED64:case ge.UINT64:if(typeof e!="number"&&typeof e!="string")break;const u=Ft.uParse(e);return t?u.toString():u;case ge.BOOL:if(typeof e!="boolean")break;return e;case ge.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case ge.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return f0.dec(e)}throw new Error}function cp(n,e,t,r){if(e===null)return n.typeName=="google.protobuf.NullValue"?0:r?n.values[0].no:cd;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const a=n.findName(e);if(a!==void 0)return a.no;if(t)return zu;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(Ei(e)))}function DS(n){return n.repeated||n.kind=="map"?!0:!(n.oneof||n.kind=="message"||n.opt||n.req)}function Kv(n,e,t){if(n.kind=="map"){Kt(typeof e=="object"&&e!=null);const r={},a=Object.entries(e);switch(n.V.kind){case"scalar":for(const[l,u]of a)r[l.toString()]=Gu(n.V.T,u);break;case"message":for(const[l,u]of a)r[l.toString()]=u.toJson(t);break;case"enum":const s=n.V.T;for(const[l,u]of a)r[l.toString()]=up(s,u,t.enumAsInteger);break}return t.emitDefaultValues||a.length>0?r:void 0}if(n.repeated){Kt(Array.isArray(e));const r=[];switch(n.kind){case"scalar":for(let a=0;a<e.length;a++)r.push(Gu(n.T,e[a]));break;case"enum":for(let a=0;a<e.length;a++)r.push(up(n.T,e[a],t.enumAsInteger));break;case"message":for(let a=0;a<e.length;a++)r.push(e[a].toJson(t));break}return t.emitDefaultValues||r.length>0?r:void 0}switch(n.kind){case"scalar":return Gu(n.T,e);case"enum":return up(n.T,e,t.enumAsInteger);case"message":return b0(n.T,e).toJson(t)}}function up(n,e,t){var r;if(Kt(typeof e=="number"),n.typeName=="google.protobuf.NullValue")return null;if(t)return e;const a=n.findNumber(e);return(r=a==null?void 0:a.name)!==null&&r!==void 0?r:e}function Gu(n,e){switch(n){case ge.INT32:case ge.SFIXED32:case ge.SINT32:case ge.FIXED32:case ge.UINT32:return Kt(typeof e=="number"),e;case ge.FLOAT:case ge.DOUBLE:return Kt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case ge.STRING:return Kt(typeof e=="string"),e;case ge.BOOL:return Kt(typeof e=="boolean"),e;case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return Kt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case ge.BYTES:return Kt(e instanceof Uint8Array),f0.enc(e)}}const Es=Symbol("@bufbuild/protobuf/unknown-fields"),Jv={readUnknownFields:!0,readerFactory:n=>new _S(n)},Yv={writeUnknownFields:!0,writerFactory:()=>new ES};function FS(n){return n?Object.assign(Object.assign({},Jv),n):Jv}function US(n){return n?Object.assign(Object.assign({},Yv),n):Yv}function BS(){return{makeReadOptions:FS,makeWriteOptions:US,listUnknownFields(n){var e;return(e=n[Es])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[Es]},writeUnknownFields(n,e){const t=n[Es];if(t)for(const r of t)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(n,e,t,r){const a=n;Array.isArray(a[Es])||(a[Es]=[]),a[Es].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r,a){const s=n.getType(),l=a?e.len:e.pos+t;let u,h;for(;e.pos<l&&([u,h]=e.tag(),!(a===!0&&h==Zt.EndGroup));){const f=s.fields.find(u);if(!f){const g=e.skip(h,u);r.readUnknownFields&&this.onUnknownField(n,u,h,g);continue}Xv(n,e,f,h,r)}if(a&&(h!=Zt.EndGroup||u!==t))throw new Error("invalid end group tag")},readField:Xv,writeMessage(n,e,t){const r=n.getType();for(const a of r.fields.byNumber()){if(!v0(a,n)){if(a.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(a.name," to binary: required field not set"));continue}const s=a.oneof?n[a.oneof.localName].value:n[a.localName];Qv(a,s,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e},writeField(n,e,t,r){e!==void 0&&Qv(n,e,t,r)}}}function Xv(n,e,t,r,a){let{repeated:s,localName:l}=t;switch(t.oneof&&(n=n[t.oneof.localName],n.case!=l&&delete n.value,n.case=l,l="value"),t.kind){case"scalar":case"enum":const u=t.kind=="enum"?ge.INT32:t.T;let h=ud;if(t.kind=="scalar"&&t.L>0&&(h=HS),s){let x=n[l];if(r==Zt.LengthDelimited&&u!=ge.STRING&&u!=ge.BYTES){let T=e.uint32()+e.pos;for(;e.pos<T;)x.push(h(e,u))}else x.push(h(e,u))}else n[l]=h(e,u);break;case"message":const f=t.T;s?n[l].push($u(e,new f,a,t)):Zi(n[l])?$u(e,n[l],a,t):(n[l]=$u(e,new f,a,t),f.fieldWrapper&&!t.oneof&&!t.repeated&&(n[l]=f.fieldWrapper.unwrapField(n[l])));break;case"map":let[g,C]=VS(t,e,a);n[l][g]=C;break}}function $u(n,e,t,r){const a=e.getType().runtime.bin,s=r==null?void 0:r.delimited;return a.readMessage(e,n,s?r.no:n.uint32(),t,s),e}function VS(n,e,t){const r=e.uint32(),a=e.pos+r;let s,l;for(;e.pos<a;){const[u]=e.tag();switch(u){case 1:s=ud(e,n.K);break;case 2:switch(n.V.kind){case"scalar":l=ud(e,n.V.T);break;case"enum":l=e.int32();break;case"message":l=$u(e,new n.V.T,t,void 0);break}break}}if(s===void 0&&(s=qs(n.K,Ua.BIGINT)),typeof s!="string"&&typeof s!="number"&&(s=s.toString()),l===void 0)switch(n.V.kind){case"scalar":l=qs(n.V.T,Ua.BIGINT);break;case"enum":l=n.V.T.values[0].no;break;case"message":l=new n.V.T;break}return[s,l]}function HS(n,e){const t=ud(n,e);return typeof t=="bigint"?t.toString():t}function ud(n,e){switch(e){case ge.STRING:return n.string();case ge.BOOL:return n.bool();case ge.DOUBLE:return n.double();case ge.FLOAT:return n.float();case ge.INT32:return n.int32();case ge.INT64:return n.int64();case ge.UINT64:return n.uint64();case ge.FIXED64:return n.fixed64();case ge.BYTES:return n.bytes();case ge.FIXED32:return n.fixed32();case ge.SFIXED32:return n.sfixed32();case ge.SFIXED64:return n.sfixed64();case ge.SINT64:return n.sint64();case ge.UINT32:return n.uint32();case ge.SINT32:return n.sint32()}}function Qv(n,e,t,r){Kt(e!==void 0);const a=n.repeated;switch(n.kind){case"scalar":case"enum":let s=n.kind=="enum"?ge.INT32:n.T;if(a)if(Kt(Array.isArray(e)),n.packed)WS(t,s,n.no,e);else for(const l of e)Ql(t,s,n.no,l);else Ql(t,s,n.no,e);break;case"message":if(a){Kt(Array.isArray(e));for(const l of e)Zv(t,r,n,l)}else Zv(t,r,n,e);break;case"map":Kt(typeof e=="object"&&e!=null);for(const[l,u]of Object.entries(e))qS(t,r,n,l,u);break}}function qS(n,e,t,r,a){n.tag(t.no,Zt.LengthDelimited),n.fork();let s=r;switch(t.K){case ge.INT32:case ge.FIXED32:case ge.UINT32:case ge.SFIXED32:case ge.SINT32:s=Number.parseInt(r);break;case ge.BOOL:Kt(r=="true"||r=="false"),s=r=="true";break}switch(Ql(n,t.K,1,s),t.V.kind){case"scalar":Ql(n,t.V.T,2,a);break;case"enum":Ql(n,ge.INT32,2,a);break;case"message":Kt(a!==void 0),n.tag(2,Zt.LengthDelimited).bytes(a.toBinary(e));break}n.join()}function Zv(n,e,t,r){const a=b0(t.T,r);t.delimited?n.tag(t.no,Zt.StartGroup).raw(a.toBinary(e)).tag(t.no,Zt.EndGroup):n.tag(t.no,Zt.LengthDelimited).bytes(a.toBinary(e))}function Ql(n,e,t,r){Kt(r!==void 0);let[a,s]=y0(e);n.tag(t,a)[s](r)}function WS(n,e,t,r){if(!r.length)return;n.tag(t,Zt.LengthDelimited).fork();let[,a]=y0(e);for(let s=0;s<r.length;s++)n[a](r[s]);n.join()}function y0(n){let e=Zt.Varint;switch(n){case ge.BYTES:case ge.STRING:e=Zt.LengthDelimited;break;case ge.DOUBLE:case ge.FIXED64:case ge.SFIXED64:e=Zt.Bit64;break;case ge.FIXED32:case ge.SFIXED32:case ge.FLOAT:e=Zt.Bit32;break}const t=ge[n].toLowerCase();return[e,t]}function zS(){return{setEnumType:s0,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const a=r.localName,s=e,l=n;if(l[a]!=null)switch(r.kind){case"oneof":const u=l[a].case;if(u===void 0)continue;const h=r.findField(u);let f=l[a].value;h&&h.kind=="message"&&!Zi(f,h.T)?f=new h.T(f):h&&h.kind==="scalar"&&h.T===ge.BYTES&&(f=Fl(f)),s[a]={case:u,value:f};break;case"scalar":case"enum":let g=l[a];r.T===ge.BYTES&&(g=r.repeated?g.map(Fl):Fl(g)),s[a]=g;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===ge.BYTES)for(const[T,V]of Object.entries(l[a]))s[a][T]=Fl(V);else Object.assign(s[a],l[a]);break;case"message":const x=r.V.T;for(const T of Object.keys(l[a])){let V=l[a][T];x.fieldWrapper||(V=new x(V)),s[a][T]=V}break}break;case"message":const C=r.T;if(r.repeated)s[a]=l[a].map(x=>Zi(x,C)?x:new C(x));else{const x=l[a];C.fieldWrapper?C.typeName==="google.protobuf.BytesValue"?s[a]=Fl(x):s[a]=x:s[a]=Zi(x,C)?x:new C(x)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const a=e[r.localName],s=t[r.localName];if(r.repeated){if(a.length!==s.length)return!1;switch(r.kind){case"message":return a.every((l,u)=>r.T.equals(l,s[u]));case"scalar":return a.every((l,u)=>Ra(r.T,l,s[u]));case"enum":return a.every((l,u)=>Ra(ge.INT32,l,s[u]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":let l=a,u=s;return r.T.fieldWrapper&&(l!==void 0&&!Zi(l)&&(l=r.T.fieldWrapper.wrapField(l)),u!==void 0&&!Zi(u)&&(u=r.T.fieldWrapper.wrapField(u))),r.T.equals(l,u);case"enum":return Ra(ge.INT32,a,s);case"scalar":return Ra(r.T,a,s);case"oneof":if(a.case!==s.case)return!1;const h=r.findField(a.case);if(h===void 0)return!0;switch(h.kind){case"message":return h.T.equals(a.value,s.value);case"enum":return Ra(ge.INT32,a.value,s.value);case"scalar":return Ra(h.T,a.value,s.value)}throw new Error("oneof cannot contain ".concat(h.kind));case"map":const f=Object.keys(a).concat(Object.keys(s));switch(r.V.kind){case"message":const g=r.V.T;return f.every(x=>g.equals(a[x],s[x]));case"enum":return f.every(x=>Ra(ge.INT32,a[x],s[x]));case"scalar":const C=r.V.T;return f.every(x=>Ra(C,a[x],s[x]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const a of e.fields.byMember()){const s=n[a.localName];let l;if(a.repeated)l=s.map(Du);else if(a.kind=="map"){l=r[a.localName];for(const[u,h]of Object.entries(s))l[u]=Du(h)}else a.kind=="oneof"?l=a.findField(s.case)?{case:s.case,value:Du(s.value)}:{case:void 0}:l=Du(s);r[a.localName]=l}for(const a of e.runtime.bin.listUnknownFields(n))e.runtime.bin.onUnknownField(r,a.no,a.wireType,a.data);return t}}}function Du(n){if(n===void 0)return n;if(Zi(n))return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function Fl(n){return n instanceof Uint8Array?n:new Uint8Array(n)}function GS(n,e,t){return{syntax:n,json:NS(),bin:BS(),util:Object.assign(Object.assign({},zS()),{newFieldList:e,initFields:t}),makeMessageType(r,a,s){return wS(this,r,a,s)},makeEnum:yS,makeEnumType:l0,getEnumType:bS,makeExtension(r,a,s){return PS(this,r,a,s)}}}class $S{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function w0(n,e){const t=k0(n);return e?t:ZS(QS(t))}function KS(n){return w0(n,!1)}const JS=k0;function k0(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let a=n.charAt(r);switch(a){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(a),e=!1;break;default:e&&(e=!1,a=a.toUpperCase()),t.push(a);break}}return t.join("")}const YS=new Set(["constructor","toString","toJSON","valueOf"]),XS=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),C0=n=>"".concat(n,"$"),QS=n=>XS.has(n)?C0(n):n,ZS=n=>YS.has(n)?C0(n):n;class eT{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=KS(e)}addField(e){Kt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function tT(n,e){var t,r,a,s,l,u;const h=[];let f;for(const g of typeof n=="function"?n():n){const C=g;if(C.localName=w0(g.name,g.oneof!==void 0),C.jsonName=(t=g.jsonName)!==null&&t!==void 0?t:JS(g.name),C.repeated=(r=g.repeated)!==null&&r!==void 0?r:!1,g.kind=="scalar"&&(C.L=(a=g.L)!==null&&a!==void 0?a:Ua.BIGINT),C.delimited=(s=g.delimited)!==null&&s!==void 0?s:!1,C.req=(l=g.req)!==null&&l!==void 0?l:!1,C.opt=(u=g.opt)!==null&&u!==void 0?u:!1,g.packed===void 0&&(C.packed=g.kind=="enum"||g.kind=="scalar"&&g.T!=ge.BYTES&&g.T!=ge.STRING),g.oneof!==void 0){const x=typeof g.oneof=="string"?g.oneof:g.oneof.name;(!f||f.name!=x)&&(f=new eT(x)),C.oneof=f,f.addField(C)}h.push(C)}return h}const ne=GS("proto3",n=>new $S(n,e=>tT(e)),n=>{for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=qs(e.T,e.L);break}}});class ur extends Of{constructor(e){super(),this.seconds=Ft.zero,this.nanos=0,ne.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(ne.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const a=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(a))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(a<Date.parse("0001-01-01T00:00:00Z")||a>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ft.parse(a/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const a=(this.nanos+1e9).toString().substring(1);a.substring(3)==="000000"?r="."+a.substring(0,3)+"Z":a.substring(6)==="000"?r="."+a.substring(0,6)+"Z":r="."+a+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return ur.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new ur({seconds:Ft.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new ur().fromBinary(e,t)}static fromJson(e,t){return new ur().fromJson(e,t)}static fromJsonString(e,t){return new ur().fromJsonString(e,t)}static equals(e,t){return ne.util.equals(ur,e,t)}}ur.runtime=ne;ur.typeName="google.protobuf.Timestamp";ur.fields=ne.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const nT=ne.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ur},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:rT,repeated:!0},{no:5,name:"events",kind:"message",T:aT,repeated:!0}]),rT=ne.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:iT,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),iT=ne.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ur},{no:3,name:"value",kind:"scalar",T:2}]),aT=ne.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:ur},{no:7,name:"normalized_end_timestamp",kind:"message",T:ur,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),S0=ne.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),si=ne.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),nn=ne.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),Lf=ne.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Gl=ne.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),uc=ne.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),ci=ne.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),_o=ne.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),oT=ne.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),gn=ne.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),Pd=ne.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:dd,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:j0}]),dd=ne.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),sT=ne.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:ne.getEnumType(nn),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Ao=ne.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ne.getEnumType(js)},{no:4,name:"tracks",kind:"message",T:Is,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:sT},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:ne.getEnumType(dc)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:ne.getEnumType(ci)},{no:18,name:"kind_details",kind:"enum",T:ne.getEnumType(lT),repeated:!0}]),js=ne.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),dc=ne.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),lT=ne.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),dn=ne.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),cT=ne.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ja,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:ne.getEnumType(T0)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Is=ne.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:ne.getEnumType(si)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:ne.getEnumType(nn)},{no:10,name:"layers",kind:"message",T:ja,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:cT,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:ne.getEnumType(dn)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:j0},{no:19,name:"audio_features",kind:"enum",T:ne.getEnumType(gn),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:ne.getEnumType(S0)}]),ja=ne.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:ne.getEnumType(Lf)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),T0=ne.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Jn=ne.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:ne.getEnumType(lt)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:Nf,oneof:"value"},{no:3,name:"speaker",kind:"message",T:uT,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:P0,oneof:"value"},{no:7,name:"transcription",kind:"message",T:dT,oneof:"value"},{no:8,name:"metrics",kind:"message",T:nT,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:hd,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:jf,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:Df,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:Ff,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:pd,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:fd,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:md,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:x0,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),lt=ne.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),x0=ne.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:ne.getEnumType(dn)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),E0=ne.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:Nf,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:hd,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:jf,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:Df,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:Ff,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:pd,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:fd,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:md,oneof:"value"}]),uT=ne.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:_0,repeated:!0}]),_0=ne.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),Nf=ne.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),P0=ne.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),dT=ne.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:hT,repeated:!0}]),hT=ne.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),hd=ne.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),jf=ne.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),Df=ne.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),Ff=ne.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:R0,oneof:"value"}]),R0=ne.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),I0=ne.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),M0=ne.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:ne.getEnumType(O0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),O0=ne.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),A0=ne.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:ne.getEnumType(L0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),L0=ne.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),N0=ne.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:eb},{no:2,name:"screen",kind:"message",T:eb},{no:3,name:"resume_connection",kind:"enum",T:ne.getEnumType(uc)},{no:4,name:"disabled_codecs",kind:"message",T:pT},{no:5,name:"force_relay",kind:"enum",T:ne.getEnumType(uc)}]),eb=ne.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:ne.getEnumType(uc)}]),pT=ne.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:dd,repeated:!0},{no:2,name:"publish",kind:"message",T:dd,repeated:!0}]),j0=ne.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),jp=ne.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),D0=ne.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:ne.getEnumType(jp)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),F0=ne.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),pd=ne.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:ne.getEnumType(dn)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:D0,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:F0,oneof:"content_header"}],{localName:"DataStream_Header"}),fd=ne.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),md=ne.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),fT=ne.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),li=ne.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Dp=ne.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),mT=ne.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),gT=ne.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Ba,oneof:"message"},{no:2,name:"answer",kind:"message",T:Ba,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Rd,oneof:"message"},{no:4,name:"add_track",kind:"message",T:hc,oneof:"message"},{no:5,name:"mute",kind:"message",T:Id,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Md,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:U0,oneof:"message"},{no:8,name:"leave",kind:"message",T:Od,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:V0,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:W0,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:qf,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Ti,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Vf,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:$0,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:Bf,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:B0,oneof:"message"}]),tb=ne.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:vT,oneof:"message"},{no:2,name:"answer",kind:"message",T:Ba,oneof:"message"},{no:3,name:"offer",kind:"message",T:Ba,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Rd,oneof:"message"},{no:5,name:"update",kind:"message",T:wT,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Uf,oneof:"message"},{no:8,name:"leave",kind:"message",T:Od,oneof:"message"},{no:9,name:"mute",kind:"message",T:Id,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:kT,oneof:"message"},{no:11,name:"room_update",kind:"message",T:CT,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:TT,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:ET,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:PT,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:IT,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:yT,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:bT,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:OT,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:NT,oneof:"message"},{no:22,name:"request_response",kind:"message",T:jT,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:DT,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:MT,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:VT,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:RT,oneof:"message"}]),Fp=ne.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ja,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:ne.getEnumType(T0)}]),hc=ne.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:ne.getEnumType(si)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:ne.getEnumType(nn)},{no:9,name:"layers",kind:"message",T:ja,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Fp,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:ne.getEnumType(dn)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:ne.getEnumType(S0)},{no:17,name:"audio_features",kind:"enum",T:ne.getEnumType(gn),repeated:!0}]),Rd=ne.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:ne.getEnumType(li)},{no:3,name:"final",kind:"scalar",T:8}]),Id=ne.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),vT=ne.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Pd},{no:2,name:"participant",kind:"message",T:Ao},{no:3,name:"other_participants",kind:"message",T:Ao,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:H0,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:N0},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:M0},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:dd,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),bT=ne.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:H0,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:N0},{no:3,name:"server_info",kind:"message",T:M0},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),Uf=ne.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Is}]),yT=ne.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Ba=ne.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),wT=ne.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Ao,repeated:!0}]),Md=ne.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:I0,repeated:!0}]),U0=ne.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:ne.getEnumType(Lf)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),Bf=ne.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:ne.getEnumType(gn),repeated:!0}]),B0=ne.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Od=ne.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:ne.getEnumType(ci)},{no:3,name:"action",kind:"enum",T:ne.getEnumType(Ds)},{no:4,name:"regions",kind:"message",T:AT}]),Ds=ne.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),V0=ne.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ja,repeated:!0}]),Vf=ne.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),H0=ne.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),kT=ne.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:_0,repeated:!0}]),CT=ne.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Pd}]),ST=ne.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:ne.getEnumType(Gl)},{no:3,name:"score",kind:"scalar",T:2}]),TT=ne.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:ST,repeated:!0}]),xT=ne.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:ne.getEnumType(Dp)}]),ET=ne.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:xT,repeated:!0}]),Hf=ne.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:ne.getEnumType(Lf)},{no:2,name:"enabled",kind:"scalar",T:8}]),_T=ne.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Hf,repeated:!0}]),PT=ne.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Hf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:_T,repeated:!0}]),RT=ne.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:fT,repeated:!0}]),q0=ne.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),W0=ne.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:q0,repeated:!0}]),IT=ne.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),MT=ne.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:Pd},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Ao},{no:4,name:"other_participants",kind:"message",T:Ao,repeated:!0}]),qf=ne.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Ba},{no:2,name:"subscription",kind:"message",T:Md},{no:3,name:"publish_tracks",kind:"message",T:Uf,repeated:!0},{no:4,name:"data_channels",kind:"message",T:G0,repeated:!0},{no:5,name:"offer",kind:"message",T:Ba},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:z0,repeated:!0}]),z0=ne.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),G0=ne.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:ne.getEnumType(li)}]),Ti=ne.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:ne.getEnumType(mT),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),$0=ne.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),OT=ne.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),AT=ne.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:LT,repeated:!0}]),LT=ne.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),NT=ne.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:ne.getEnumType(oT)}]),jT=ne.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:ne.getEnumType(Wf)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:Rd,oneof:"request"},{no:5,name:"add_track",kind:"message",T:hc,oneof:"request"},{no:6,name:"mute",kind:"message",T:Id,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:Vf,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:Bf,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:B0,oneof:"request"}]),Wf=ne.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),DT=ne.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),K0=ne.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),FT=ne.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:A0},{no:2,name:"connection_settings",kind:"message",T:K0},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:hc,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:Ba},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:ne.getEnumType(_o)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:qf}]),UT=ne.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:ne.getEnumType(BT)},{no:2,name:"join_request",kind:"scalar",T:12}]),BT=ne.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),VT=ne.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function HT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Up={exports:{}},qT=Up.exports,nb;function WT(){return nb||(nb=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(qT,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"],s={},l=null;function u(A,W){var U=A[W];if(typeof U.bind=="function")return U.bind(A);try{return Function.prototype.bind.call(U,A)}catch{return function(){return Function.prototype.apply.apply(U,[A,arguments])}}}function h(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function f(A){return A==="debug"&&(A="log"),typeof console===t?!1:A==="trace"&&r?h:console[A]!==void 0?u(console,A):console.log!==void 0?u(console,"log"):e}function g(){for(var A=this.getLevel(),W=0;W<a.length;W++){var U=a[W];this[U]=W<A?e:this.methodFactory(U,A,this.name)}if(this.log=this.debug,typeof console===t&&A<this.levels.SILENT)return"No console available for logging"}function C(A){return function(){typeof console!==t&&(g.call(this),this[A].apply(this,arguments))}}function x(A,W,U){return f(A)||C.apply(this,arguments)}function T(A,W){var U=this,G,F,O,D="loglevel";typeof A=="string"?D+=":"+A:typeof A=="symbol"&&(D=void 0);function Q(X){var he=(a[X]||"silent").toUpperCase();if(!(typeof window===t||!D)){try{window.localStorage[D]=he;return}catch{}try{window.document.cookie=encodeURIComponent(D)+"="+he+";"}catch{}}}function ie(){var X;if(!(typeof window===t||!D)){try{X=window.localStorage[D]}catch{}if(typeof X===t)try{var he=window.document.cookie,je=encodeURIComponent(D),ce=he.indexOf(je+"=");ce!==-1&&(X=/^([^;]+)/.exec(he.slice(ce+je.length+1))[1])}catch{}return U.levels[X]===void 0&&(X=void 0),X}}function Y(){if(!(typeof window===t||!D)){try{window.localStorage.removeItem(D)}catch{}try{window.document.cookie=encodeURIComponent(D)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function z(X){var he=X;if(typeof he=="string"&&U.levels[he.toUpperCase()]!==void 0&&(he=U.levels[he.toUpperCase()]),typeof he=="number"&&he>=0&&he<=U.levels.SILENT)return he;throw new TypeError("log.setLevel() called with invalid level: "+X)}U.name=A,U.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},U.methodFactory=W||x,U.getLevel=function(){return O??F??G},U.setLevel=function(X,he){return O=z(X),he!==!1&&Q(O),g.call(U)},U.setDefaultLevel=function(X){F=z(X),ie()||U.setLevel(X,!1)},U.resetLevel=function(){O=null,Y(),g.call(U)},U.enableAll=function(X){U.setLevel(U.levels.TRACE,X)},U.disableAll=function(X){U.setLevel(U.levels.SILENT,X)},U.rebuild=function(){if(l!==U&&(G=z(l.getLevel())),g.call(U),l===U)for(var X in s)s[X].rebuild()},G=z(l?l.getLevel():"WARN");var K=ie();K!=null&&(O=z(K)),g.call(U)}l=new T,l.getLogger=function(A){if(typeof A!="symbol"&&typeof A!="string"||A==="")throw new TypeError("You must supply a name when creating a logger.");var W=s[A];return W||(W=s[A]=new T(A,l.methodFactory)),W};var V=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=V),l},l.getLoggers=function(){return s},l.default=l,l})}(Up)),Up.exports}var Ad=WT(),Bp;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(Bp||(Bp={}));var ui;(function(n){n.Default="livekit",n.Room="livekit-room",n.TokenSource="livekit-token-source",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(ui||(ui={}));let ct=Ad.getLogger("livekit");const zT=Object.values(ui).map(n=>Ad.getLogger(n));ct.setDefaultLevel(Bp.info);function ia(n){const e=Ad.getLogger(n);return e.setDefaultLevel(ct.getLevel()),e}function GT(n,e){for(const t of zT)t.setLevel(n)}const $T=Ad.getLogger("lk-e2ee"),Ul=7e3,KT=[0,300,2*2*300,3*3*300,4*4*300,Ul,Ul,Ul,Ul,Ul];class JT{constructor(e){this._retryDelays=e!==void 0?[...e]:KT}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function YT(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}function j(n,e,t,r){function a(s){return s instanceof t?s:new t(function(l){l(s)})}return new(t||(t=Promise))(function(s,l){function u(g){try{f(r.next(g))}catch(C){l(C)}}function h(g){try{f(r.throw(g))}catch(C){l(C)}}function f(g){g.done?s(g.value):a(g.value).then(u,h)}f((r=r.apply(n,e||[])).next())})}function rb(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ea(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof rb=="function"?rb(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(l){return new Promise(function(u,h){l=n[s](l),a(u,h,l.done,l.value)})}}function a(s,l,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},l)}}var Fu={exports:{}},ib;function XT(){if(ib)return Fu.exports;ib=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(O,D,Q){return Function.prototype.apply.call(O,D,Q)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(O){return Object.getOwnPropertyNames(O).concat(Object.getOwnPropertySymbols(O))}:t=function(O){return Object.getOwnPropertyNames(O)};function r(O){console&&console.warn&&console.warn(O)}var a=Number.isNaN||function(O){return O!==O};function s(){s.init.call(this)}Fu.exports=s,Fu.exports.once=U,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(O){if(typeof O!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof O)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(O){if(typeof O!="number"||O<0||a(O))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+O+".");l=O}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(O){if(typeof O!="number"||O<0||a(O))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+O+".");return this._maxListeners=O,this};function h(O){return O._maxListeners===void 0?s.defaultMaxListeners:O._maxListeners}s.prototype.getMaxListeners=function(){return h(this)},s.prototype.emit=function(O){for(var D=[],Q=1;Q<arguments.length;Q++)D.push(arguments[Q]);var ie=O==="error",Y=this._events;if(Y!==void 0)ie=ie&&Y.error===void 0;else if(!ie)return!1;if(ie){var z;if(D.length>0&&(z=D[0]),z instanceof Error)throw z;var K=new Error("Unhandled error."+(z?" ("+z.message+")":""));throw K.context=z,K}var X=Y[O];if(X===void 0)return!1;if(typeof X=="function")e(X,this,D);else for(var he=X.length,je=V(X,he),Q=0;Q<he;++Q)e(je[Q],this,D);return!0};function f(O,D,Q,ie){var Y,z,K;if(u(Q),z=O._events,z===void 0?(z=O._events=Object.create(null),O._eventsCount=0):(z.newListener!==void 0&&(O.emit("newListener",D,Q.listener?Q.listener:Q),z=O._events),K=z[D]),K===void 0)K=z[D]=Q,++O._eventsCount;else if(typeof K=="function"?K=z[D]=ie?[Q,K]:[K,Q]:ie?K.unshift(Q):K.push(Q),Y=h(O),Y>0&&K.length>Y&&!K.warned){K.warned=!0;var X=new Error("Possible EventEmitter memory leak detected. "+K.length+" "+String(D)+" listeners added. Use emitter.setMaxListeners() to increase limit");X.name="MaxListenersExceededWarning",X.emitter=O,X.type=D,X.count=K.length,r(X)}return O}s.prototype.addListener=function(O,D){return f(this,O,D,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(O,D){return f(this,O,D,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(O,D,Q){var ie={fired:!1,wrapFn:void 0,target:O,type:D,listener:Q},Y=g.bind(ie);return Y.listener=Q,ie.wrapFn=Y,Y}s.prototype.once=function(O,D){return u(D),this.on(O,C(this,O,D)),this},s.prototype.prependOnceListener=function(O,D){return u(D),this.prependListener(O,C(this,O,D)),this},s.prototype.removeListener=function(O,D){var Q,ie,Y,z,K;if(u(D),ie=this._events,ie===void 0)return this;if(Q=ie[O],Q===void 0)return this;if(Q===D||Q.listener===D)--this._eventsCount===0?this._events=Object.create(null):(delete ie[O],ie.removeListener&&this.emit("removeListener",O,Q.listener||D));else if(typeof Q!="function"){for(Y=-1,z=Q.length-1;z>=0;z--)if(Q[z]===D||Q[z].listener===D){K=Q[z].listener,Y=z;break}if(Y<0)return this;Y===0?Q.shift():A(Q,Y),Q.length===1&&(ie[O]=Q[0]),ie.removeListener!==void 0&&this.emit("removeListener",O,K||D)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(O){var D,Q,ie;if(Q=this._events,Q===void 0)return this;if(Q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Q[O]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Q[O]),this;if(arguments.length===0){var Y=Object.keys(Q),z;for(ie=0;ie<Y.length;++ie)z=Y[ie],z!=="removeListener"&&this.removeAllListeners(z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(D=Q[O],typeof D=="function")this.removeListener(O,D);else if(D!==void 0)for(ie=D.length-1;ie>=0;ie--)this.removeListener(O,D[ie]);return this};function x(O,D,Q){var ie=O._events;if(ie===void 0)return[];var Y=ie[D];return Y===void 0?[]:typeof Y=="function"?Q?[Y.listener||Y]:[Y]:Q?W(Y):V(Y,Y.length)}s.prototype.listeners=function(O){return x(this,O,!0)},s.prototype.rawListeners=function(O){return x(this,O,!1)},s.listenerCount=function(O,D){return typeof O.listenerCount=="function"?O.listenerCount(D):T.call(O,D)},s.prototype.listenerCount=T;function T(O){var D=this._events;if(D!==void 0){var Q=D[O];if(typeof Q=="function")return 1;if(Q!==void 0)return Q.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function V(O,D){for(var Q=new Array(D),ie=0;ie<D;++ie)Q[ie]=O[ie];return Q}function A(O,D){for(;D+1<O.length;D++)O[D]=O[D+1];O.pop()}function W(O){for(var D=new Array(O.length),Q=0;Q<D.length;++Q)D[Q]=O[Q].listener||O[Q];return D}function U(O,D){return new Promise(function(Q,ie){function Y(K){O.removeListener(D,z),ie(K)}function z(){typeof O.removeListener=="function"&&O.removeListener("error",Y),Q([].slice.call(arguments))}F(O,D,z,{once:!0}),D!=="error"&&G(O,Y,{once:!0})})}function G(O,D,Q){typeof O.on=="function"&&F(O,"error",D,Q)}function F(O,D,Q,ie){if(typeof O.on=="function")ie.once?O.once(D,Q):O.on(D,Q);else if(typeof O.addEventListener=="function")O.addEventListener(D,function Y(z){ie.once&&O.removeEventListener(D,Y),Q(z)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof O)}return Fu.exports}var Oi=XT();let J0=!0,Y0=!0;function $l(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function Do(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,a=r.addEventListener;r.addEventListener=function(l,u){if(l!==e)return a.apply(this,arguments);const h=f=>{const g=t(f);g&&(u.handleEvent?u.handleEvent(g):u(g))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,h),a.apply(this,[l,h])};const s=r.removeEventListener;r.removeEventListener=function(l,u){if(l!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(u))return s.apply(this,arguments);const h=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[l,h])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(l){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),l&&this.addEventListener(e,this["_on"+e]=l)},enumerable:!0,configurable:!0})}function QT(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(J0=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function ZT(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(Y0=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function X0(){if(typeof window=="object"){if(J0)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function zf(n,e){Y0&&console.warn(n+" is deprecated, please use "+e+" instead.")}function ex(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(a=>a.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt($l(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt($l(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt($l(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=$l(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function ab(n){return Object.prototype.toString.call(n)==="[object Object]"}function Q0(n){return ab(n)?Object.keys(n).reduce(function(e,t){const r=ab(n[t]),a=r?Q0(n[t]):n[t],s=r&&!Object.keys(a).length;return a===void 0||s?e:Object.assign(e,{[t]:a})},{}):n}function Vp(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Vp(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(a=>{Vp(n,n.get(a),t)})}))}function ob(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",a=new Map;if(e===null)return a;const s=[];return n.forEach(l=>{l.type==="track"&&l.trackIdentifier===e.id&&s.push(l)}),s.forEach(l=>{n.forEach(u=>{u.type===r&&u.trackId===l.id&&Vp(n,u,a)})}),a}const sb=X0;function Z0(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const h={};return Object.keys(u).forEach(f=>{if(f==="require"||f==="advanced"||f==="mediaSource")return;const g=typeof u[f]=="object"?u[f]:{ideal:u[f]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const C=function(x,T){return x?x+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(g.ideal!==void 0){h.optional=h.optional||[];let x={};typeof g.ideal=="number"?(x[C("min",f)]=g.ideal,h.optional.push(x),x={},x[C("max",f)]=g.ideal,h.optional.push(x)):(x[C("",f)]=g.ideal,h.optional.push(x))}g.exact!==void 0&&typeof g.exact!="number"?(h.mandatory=h.mandatory||{},h.mandatory[C("",f)]=g.exact):["min","max"].forEach(x=>{g[x]!==void 0&&(h.mandatory=h.mandatory||{},h.mandatory[C(x,f)]=g[x])})}),u.advanced&&(h.optional=(h.optional||[]).concat(u.advanced)),h},a=function(u,h){if(e.version>=61)return h(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const f=function(g,C,x){C in g&&!(x in g)&&(g[x]=g[C],delete g[C])};u=JSON.parse(JSON.stringify(u)),f(u.audio,"autoGainControl","googAutoGainControl"),f(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=r(u.audio)}if(u&&typeof u.video=="object"){let f=u.video.facingMode;f=f&&(typeof f=="object"?f:{ideal:f});const g=e.version<66;if(f&&(f.exact==="user"||f.exact==="environment"||f.ideal==="user"||f.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete u.video.facingMode;let C;if(f.exact==="environment"||f.ideal==="environment"?C=["back","rear"]:(f.exact==="user"||f.ideal==="user")&&(C=["front"]),C)return t.mediaDevices.enumerateDevices().then(x=>{x=x.filter(V=>V.kind==="videoinput");let T=x.find(V=>C.some(A=>V.label.toLowerCase().includes(A)));return!T&&x.length&&C.includes("back")&&(T=x[x.length-1]),T&&(u.video.deviceId=f.exact?{exact:T.deviceId}:{ideal:T.deviceId}),u.video=r(u.video),sb("chrome: "+JSON.stringify(u)),h(u)})}u.video=r(u.video)}return sb("chrome: "+JSON.stringify(u)),h(u)},s=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},l=function(u,h,f){a(u,g=>{t.webkitGetUserMedia(g,h,C=>{f&&f(s(C))})})};if(t.getUserMedia=l.bind(t),t.mediaDevices.getUserMedia){const u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(h){return a(h,f=>u(f).then(g=>{if(f.audio&&!g.getAudioTracks().length||f.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(C=>{C.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(s(g))))}}}function e1(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function t1(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",r=>{let a;n.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(l=>l.track&&l.track.id===r.track.id):a={track:r.track};const s=new Event("track");s.track=r.track,s.receiver=a,s.transceiver={receiver:a},s.streams=[t.stream],this.dispatchEvent(s)}),t.stream.getTracks().forEach(r=>{let a;n.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(l=>l.track&&l.track.id===r.id):a={track:r};const s=new Event("track");s.track=r,s.receiver=a,s.transceiver={receiver:a},s.streams=[t.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Do(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function n1(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(a,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=a.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:a}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(l,u){let h=a.apply(this,arguments);return h||(h=e(this,l),this._senders.push(h)),h};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(l){s.apply(this,arguments);const u=this._senders.indexOf(l);u!==-1&&this._senders.splice(u,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],t.apply(this,[a]),a.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(s=>{const l=this._senders.find(u=>u.track===s);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const t=e.apply(this,[]);return t.forEach(r=>r._pc=this),t},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function r1(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(s=>s._pc=this),a});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),n.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(s=>ob(s,a.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(a=>a._pc=this),r}),Do(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(a=>ob(a,r.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const t=arguments[0];let r,a,s;return this.getSenders().forEach(l=>{l.track===t&&(r?s=!0:r=l)}),this.getReceivers().forEach(l=>(l.track===t&&(a?s=!0:a=l),l.track===t)),s||r&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function i1(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(s,l){if(!l)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=e.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(u)===-1&&this._shimmedLocalStreams[l.id].push(u):this._shimmedLocalStreams[l.id]=[l,u],u};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(h=>{if(this.getSenders().find(f=>f.track===h))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();t.apply(this,arguments);const u=this.getSenders().filter(h=>l.indexOf(h)===-1);this._shimmedLocalStreams[s.id]=[s].concat(u)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const a=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const u=this._shimmedLocalStreams[l].indexOf(s);u!==-1&&this._shimmedLocalStreams[l].splice(u,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),a.apply(this,arguments)}}function a1(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return i1(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const f=t.apply(this);return this._reverseStreams=this._reverseStreams||{},f.map(g=>this._reverseStreams[g.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(f){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},f.getTracks().forEach(g=>{if(this.getSenders().find(C=>C.track===g))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[f.id]){const g=new n.MediaStream(f.getTracks());this._streams[f.id]=g,this._reverseStreams[g.id]=f,f=g}r.apply(this,[f])};const a=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(f){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[f.id]||f]),delete this._reverseStreams[this._streams[f.id]?this._streams[f.id].id:f.id],delete this._streams[f.id]},n.RTCPeerConnection.prototype.addTrack=function(f,g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const C=[].slice.call(arguments,1);if(C.length!==1||!C[0].getTracks().find(T=>T===f))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(T=>T.track===f))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const x=this._streams[g.id];if(x)x.addTrack(f),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const T=new n.MediaStream([f]);this._streams[g.id]=T,this._reverseStreams[T.id]=g,this.addStream(T)}return this.getSenders().find(T=>T.track===f)};function s(f,g){let C=g.sdp;return Object.keys(f._reverseStreams||[]).forEach(x=>{const T=f._reverseStreams[x],V=f._streams[T.id];C=C.replace(new RegExp(V.id,"g"),T.id)}),new RTCSessionDescription({type:g.type,sdp:C})}function l(f,g){let C=g.sdp;return Object.keys(f._reverseStreams||[]).forEach(x=>{const T=f._reverseStreams[x],V=f._streams[T.id];C=C.replace(new RegExp(T.id,"g"),V.id)}),new RTCSessionDescription({type:g.type,sdp:C})}["createOffer","createAnswer"].forEach(function(f){const g=n.RTCPeerConnection.prototype[f],C={[f](){const x=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[T=>{const V=s(this,T);x[0].apply(null,[V])},T=>{x[1]&&x[1].apply(null,T)},arguments[2]]):g.apply(this,arguments).then(T=>s(this,T))}};n.RTCPeerConnection.prototype[f]=C[f]});const u=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=l(this,arguments[0]),u.apply(this,arguments))};const h=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const f=h.get.apply(this);return f.type===""?f:s(this,f)}}),n.RTCPeerConnection.prototype.removeTrack=function(f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!f._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(f._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let g;Object.keys(this._streams).forEach(C=>{this._streams[C].getTracks().find(x=>f.track===x)&&(g=this._streams[C])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(f.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Hp(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],a={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=a[t]})}function o1(n,e){Do(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}var lb=Object.freeze({__proto__:null,fixNegotiationNeeded:o1,shimAddTrackRemoveTrack:a1,shimAddTrackRemoveTrackWithNative:i1,shimGetSendersWithDtmf:n1,shimGetUserMedia:Z0,shimMediaStream:e1,shimOnTrack:t1,shimPeerConnection:Hp,shimSenderReceiverGetStats:r1});function s1(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(a,s,l){zf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(a).then(s,l)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const a=function(l,u,h){u in l&&!(h in l)&&(l[h]=l[u],delete l[u])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(l){return typeof l=="object"&&typeof l.audio=="object"&&(l=JSON.parse(JSON.stringify(l)),a(l.audio,"autoGainControl","mozAutoGainControl"),a(l.audio,"noiseSuppression","mozNoiseSuppression")),s(l)},r&&r.prototype.getSettings){const l=r.prototype.getSettings;r.prototype.getSettings=function(){const u=l.apply(this,arguments);return a(u,"mozAutoGainControl","autoGainControl"),a(u,"mozNoiseSuppression","noiseSuppression"),u}}if(r&&r.prototype.applyConstraints){const l=r.prototype.applyConstraints;r.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),a(u,"autoGainControl","mozAutoGainControl"),a(u,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[u])}}}}function tx(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(t){if(!(t&&t.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return t.video===!0?t.video={mediaSource:e}:t.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(t)})}function l1(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function qp(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const s=n.RTCPeerConnection.prototype[a],l={[a](){return arguments[0]=new(a==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[a]=l[a]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[a,s,l]=arguments;return r.apply(this,[a||null]).then(u=>{if(e.version<53&&!s)try{u.forEach(h=>{h.type=t[h.type]||h.type})}catch(h){if(h.name!=="TypeError")throw h;u.forEach((f,g)=>{u.set(g,Object.assign({},f,{type:t[f.type]||f.type}))})}return u}).then(s,l)}}function c1(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(a=>a._pc=this),r});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const r=t.apply(this,arguments);return r._pc=this,r}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function u1(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const t=e.apply(this,[]);return t.forEach(r=>r._pc=this),t}),Do(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function d1(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(e){zf("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function h1(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function p1(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let t=arguments[1]&&arguments[1].sendEncodings;t===void 0&&(t=[]),t=[...t];const r=t.length>0;r&&t.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(r){const{sender:s}=a,l=s.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=t,s.sendEncodings=t,this.setParametersPromises.push(s.setParameters(l).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return a})}function f1(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const t=e.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}function m1(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function g1(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var cb=Object.freeze({__proto__:null,shimAddTransceiver:p1,shimCreateAnswer:g1,shimCreateOffer:m1,shimGetDisplayMedia:tx,shimGetParameters:f1,shimGetUserMedia:s1,shimOnTrack:l1,shimPeerConnection:qp,shimRTCDataChannel:h1,shimReceiverGetStats:u1,shimRemoveStream:d1,shimSenderGetStats:c1});function v1(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(r=>e.call(this,r,t)),t.getVideoTracks().forEach(r=>e.call(this,r,t))},n.RTCPeerConnection.prototype.addTrack=function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return a&&a.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(t===-1)return;this._localStreams.splice(t,1);const r=e.getTracks();this.getSenders().forEach(a=>{r.includes(a.track)&&this.removeTrack(a)})})}}function b1(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const s=new Event("addstream");s.stream=a,this.dispatchEvent(s)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(a=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(a)>=0)return;t._remoteStreams.push(a);const s=new Event("addstream");s.stream=a,t.dispatchEvent(s)})}),e.apply(t,arguments)}}}function y1(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,a=e.setLocalDescription,s=e.setRemoteDescription,l=e.addIceCandidate;e.createOffer=function(h,f){const g=arguments.length>=2?arguments[2]:arguments[0],C=t.apply(this,[g]);return f?(C.then(h,f),Promise.resolve()):C},e.createAnswer=function(h,f){const g=arguments.length>=2?arguments[2]:arguments[0],C=r.apply(this,[g]);return f?(C.then(h,f),Promise.resolve()):C};let u=function(h,f,g){const C=a.apply(this,[h]);return g?(C.then(f,g),Promise.resolve()):C};e.setLocalDescription=u,u=function(h,f,g){const C=s.apply(this,[h]);return g?(C.then(f,g),Promise.resolve()):C},e.setRemoteDescription=u,u=function(h,f,g){const C=l.apply(this,[h]);return g?(C.then(f,g),Promise.resolve()):C},e.addIceCandidate=u}function w1(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=a=>r(k1(a))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(t,r,a){e.mediaDevices.getUserMedia(t).then(r,a)}).bind(e))}function k1(n){return n&&n.video!==void 0?Object.assign({},n,{video:Q0(n.video)}):n}function C1(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(t,r){if(t&&t.iceServers){const a=[];for(let s=0;s<t.iceServers.length;s++){let l=t.iceServers[s];l.urls===void 0&&l.url?(zf("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,a.push(l)):a.push(t.iceServers[s])}t.iceServers=a}return new e(t,r)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function S1(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function T1(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(t){if(t){typeof t.offerToReceiveAudio<"u"&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const r=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");t.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):t.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof t.offerToReceiveVideo<"u"&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const a=this.getTransceivers().find(s=>s.receiver.track.kind==="video");t.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):t.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function x1(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var ub=Object.freeze({__proto__:null,shimAudioContext:x1,shimCallbacksAPI:y1,shimConstraints:k1,shimCreateOfferLegacy:T1,shimGetUserMedia:w1,shimLocalStreamsAPI:v1,shimRTCIceServerUrls:C1,shimRemoteStreamsAPI:b1,shimTrackEventTransceiver:S1}),db={exports:{}},hb;function nx(){return hb||(hb=1,function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((r,a)=>(a>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(a=>a.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const a={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":a.relatedAddress=r[s+1];break;case"rport":a.relatedPort=parseInt(r[s+1],10);break;case"tcptype":a.tcpType=r[s+1];break;case"ufrag":a.ufrag=r[s+1],a.usernameFragment=r[s+1];break;default:a[r[s]]===void 0&&(a[r[s]]=r[s+1]);break}return a},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const a=t.component;a==="rtp"?r.push(1):a==="rtcp"?r.push(2):r.push(a),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const s=t.type;return r.push("typ"),r.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const a={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),a.name=r[0],a.clockRate=parseInt(r[1],10),a.channels=r.length===3?parseInt(r[2],10):1,a.numChannels=a.channels,a},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const a=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(a!==1?"/"+a:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let a;const s=t.substring(t.indexOf(" ")+1).split(";");for(let l=0;l<s.length;l++)a=s[l].trim().split("="),r[a[0].trim()]=a[1];return r},e.writeFmtp=function(t){let r="",a=t.payloadType;if(t.preferredPayloadType!==void 0&&(a=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(l=>{t.parameters[l]!==void 0?s.push(l+"="+t.parameters[l]):s.push(l)}),r+="a=fmtp:"+a+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",a=t.payloadType;return t.preferredPayloadType!==void 0&&(a=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+a+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),a={ssrc:parseInt(t.substring(7,r),10)},s=t.indexOf(":",r);return s>-1?(a.attribute=t.substring(r+1,s),a.value=t.substring(s+1)):a.attribute=t.substring(r+1),a},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(a=>parseInt(a,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let a="a=setup:"+r+`\r
`;return t.fingerprints.forEach(s=>{a+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),a},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const a=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return a&&s?{usernameFragment:a.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(t)[0].split(" ");r.profile=a[2];for(let l=3;l<a.length;l++){const u=a[l],h=e.matchPrefix(t,"a=rtpmap:"+u+" ")[0];if(h){const f=e.parseRtpMap(h),g=e.matchPrefix(t,"a=fmtp:"+u+" ");switch(f.parameters=g.length?e.parseFmtp(g[0]):{},f.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+u+" ").map(e.parseRtcpFb),r.codecs.push(f),f.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(f.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(l=>{r.headerExtensions.push(e.parseExtmap(l))});const s=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(l=>{s.forEach(u=>{l.rtcpFeedback.find(h=>h.type===u.type&&h.parameter===u.parameter)||l.rtcpFeedback.push(u)})}),r},e.writeRtpDescription=function(t,r){let a="";a+="m="+t+" ",a+=r.codecs.length>0?"9":"0",a+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",a+=r.codecs.map(l=>l.preferredPayloadType!==void 0?l.preferredPayloadType:l.payloadType).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(l=>{a+=e.writeRtpMap(l),a+=e.writeFmtp(l),a+=e.writeRtcpFb(l)});let s=0;return r.codecs.forEach(l=>{l.maxptime>s&&(s=l.maxptime)}),s>0&&(a+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(l=>{a+=e.writeExtmap(l)}),a},e.parseRtpEncodingParameters=function(t){const r=[],a=e.parseRtpParameters(t),s=a.fecMechanisms.indexOf("RED")!==-1,l=a.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(t,"a=ssrc:").map(x=>e.parseSsrcMedia(x)).filter(x=>x.attribute==="cname"),h=u.length>0&&u[0].ssrc;let f;const g=e.matchPrefix(t,"a=ssrc-group:FID").map(x=>x.substring(17).split(" ").map(T=>parseInt(T,10)));g.length>0&&g[0].length>1&&g[0][0]===h&&(f=g[0][1]),a.codecs.forEach(x=>{if(x.name.toUpperCase()==="RTX"&&x.parameters.apt){let T={ssrc:h,codecPayloadType:parseInt(x.parameters.apt,10)};h&&f&&(T.rtx={ssrc:f}),r.push(T),s&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:h,mechanism:l?"red+ulpfec":"red"},r.push(T))}}),r.length===0&&h&&r.push({ssrc:h});let C=e.matchPrefix(t,"b=");return C.length&&(C[0].indexOf("b=TIAS:")===0?C=parseInt(C[0].substring(7),10):C[0].indexOf("b=AS:")===0?C=parseInt(C[0].substring(5),10)*1e3*.95-50*40*8:C=void 0,r.forEach(x=>{x.maxBitrate=C})),r},e.parseRtcpParameters=function(t){const r={},a=e.matchPrefix(t,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];a&&(r.cname=a.value,r.ssrc=a.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const l=e.matchPrefix(t,"a=rtcp-mux");return r.mux=l.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const a=e.matchPrefix(t,"a=msid:");if(a.length===1)return r=a[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(t,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),a=e.matchPrefix(t,"a=max-message-size:");let s;a.length>0&&(s=parseInt(a[0].substring(19),10)),isNaN(s)&&(s=65536);const l=e.matchPrefix(t,"a=sctp-port:");if(l.length>0)return{port:parseInt(l[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const u=e.matchPrefix(t,"a=sctpmap:");if(u.length>0){const h=u[0].substring(10).split(" ");return{port:parseInt(h[0],10),protocol:h[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){let a=[];return t.protocol!=="DTLS/SCTP"?a=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:a=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&a.push("a=max-message-size:"+r.maxMessageSize+`\r
`),a.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,a){let s;const l=r!==void 0?r:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(a||"thisisadapterortc")+" "+s+" "+l+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const a=e.splitLines(t);for(let s=0;s<a.length;s++)switch(a[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const r=e.splitLines(t)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(t){const r=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let a=0;a<r.length;a++)if(r[a].length<2||r[a].charAt(1)!=="=")return!1;return!0},n.exports=e}(db)),db.exports}var E1=nx(),Fs=HT(E1),rx=uS({__proto__:null,default:Fs},[E1]);function Ku(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(t){if(typeof t=="object"&&t.candidate&&t.candidate.indexOf("a=")===0&&(t=JSON.parse(JSON.stringify(t)),t.candidate=t.candidate.substring(2)),t.candidate&&t.candidate.length){const r=new e(t),a=Fs.parseCandidate(t.candidate);for(const s in a)s in r||Object.defineProperty(r,s,{value:a[s]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(t)},n.RTCIceCandidate.prototype=e.prototype,Do(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Wp(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||Do(n,"icecandidate",e=>{if(e.candidate){const t=Fs.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Ju(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(u){if(!u||!u.sdp)return!1;const h=Fs.splitSections(u.sdp);return h.shift(),h.some(f=>{const g=Fs.parseMLine(f);return g&&g.kind==="application"&&g.protocol.indexOf("SCTP")!==-1})},r=function(u){const h=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(h===null||h.length<2)return-1;const f=parseInt(h[1],10);return f!==f?-1:f},a=function(u){let h=65536;return e.browser==="firefox"&&(e.version<57?u===-1?h=16384:h=2147483637:e.version<60?h=e.version===57?65535:65536:h=2147483637),h},s=function(u,h){let f=65536;e.browser==="firefox"&&e.version===57&&(f=65535);const g=Fs.matchPrefix(u.sdp,"a=max-message-size:");return g.length>0?f=parseInt(g[0].substring(19),10):e.browser==="firefox"&&h!==-1&&(f=2147483637),f},l=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const u=r(arguments[0]),h=a(u),f=s(arguments[0],u);let g;h===0&&f===0?g=Number.POSITIVE_INFINITY:h===0||f===0?g=Math.max(h,f):g=Math.min(h,f);const C={};Object.defineProperty(C,"maxMessageSize",{get(){return g}}),this._sctp=C}return l.apply(this,arguments)}}function Yu(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,a){const s=r.send;r.send=function(){const l=arguments[0],u=l.length||l.size||l.byteLength;if(r.readyState==="open"&&a.sctp&&u>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const r=t.apply(this,arguments);return e(r,this),r},Do(n,"datachannel",r=>(e(r.channel,r.target),r))}function zp(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const s=a.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const l=new Event("connectionstatechange",a);s.dispatchEvent(l)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Gp(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=r.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&r instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:r.type,sdp:a}):r.sdp=a}return t.apply(this,arguments)}}function Xu(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Qu(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return t.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?t.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}var ix=Object.freeze({__proto__:null,removeExtmapAllowMixed:Gp,shimAddIceCandidateNullOrEmpty:Xu,shimConnectionState:zp,shimMaxMessageSize:Ju,shimParameterlessSetLocalDescription:Qu,shimRTCIceCandidate:Ku,shimRTCIceCandidateRelayProtocol:Wp,shimSendThrowTypeError:Yu});function ax(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=X0,r=ex(n),a={browserDetails:r,commonShim:ix,extractVersion:$l,disableLog:QT,disableWarnings:ZT,sdp:rx};switch(r.browser){case"chrome":if(!lb||!Hp||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),a;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),a;t("adapter.js shimming chrome."),a.browserShim=lb,Xu(n,r),Qu(n),Z0(n,r),e1(n),Hp(n,r),t1(n),a1(n,r),n1(n),r1(n),o1(n,r),Ku(n),Wp(n),zp(n),Ju(n,r),Yu(n),Gp(n,r);break;case"firefox":if(!cb||!qp||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),a;t("adapter.js shimming firefox."),a.browserShim=cb,Xu(n,r),Qu(n),s1(n,r),qp(n,r),l1(n),d1(n),c1(n),u1(n),h1(n),p1(n),f1(n),m1(n),g1(n),Ku(n),zp(n),Ju(n,r),Yu(n);break;case"safari":if(!ub||!e.shimSafari)return t("Safari shim is not included in this adapter release."),a;t("adapter.js shimming safari."),a.browserShim=ub,Xu(n,r),Qu(n),C1(n),T1(n),y1(n),v1(n),b1(n),S1(n),w1(n),x1(n),Ku(n),Wp(n),Ju(n,r),Yu(n),Gp(n,r);break;default:t("Unsupported browser!");break}return a}ax({window:typeof window>"u"?void 0:window});const ox=10,Bl="lk_e2ee",sx="LKFrameEncryptionKey",lx={sharedKey:!1,ratchetSalt:sx,ratchetWindowSize:8,failureTolerance:ox,keyringSize:16};var Da;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(Da||(Da={}));var pb;(function(n){n.KeyRatcheted="keyRatcheted"})(pb||(pb={}));var Na;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(Na||(Na={}));var fb;(function(n){n.Error="cryptorError"})(fb||(fb={}));function cx(){return ux()||$p()}function $p(){return typeof window.RTCRtpScriptTransform<"u"}function ux(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function dx(n){var e,t,r,a,s;if(((e=n.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((t=n.value)===null||t===void 0?void 0:t.case)!=="metrics"&&((r=n.value)===null||r===void 0?void 0:r.case)!=="speaker"&&((a=n.value)===null||a===void 0?void 0:a.case)!=="transcription"&&((s=n.value)===null||s===void 0?void 0:s.case)!=="encryptedPacket")return new E0({value:n.value})}class AR extends Oi.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,r,a)=>{ct.debug("key ratcheted event received",{ratchetResult:t,participantId:r,keyIndex:a})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},lx),e),this.on(Da.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,r){const a={key:e,participantIdentity:t,keyIndex:r};if(!this.options.sharedKey&&!t)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(t??"shared","-").concat(r??0),a),this.emit(Da.SetKey,a)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(Da.RatchetRequest,e,t)}}class aa extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var mt;(function(n){n[n.NotAllowed=0]="NotAllowed",n[n.ServerUnreachable=1]="ServerUnreachable",n[n.InternalError=2]="InternalError",n[n.Cancelled=3]="Cancelled",n[n.LeaveRequest=4]="LeaveRequest",n[n.Timeout=5]="Timeout"})(mt||(mt={}));class kt extends aa{constructor(e,t,r,a){super(1,e),this.name="ConnectionError",this.status=r,this.reason=t,this.context=a,this.reasonName=mt[t]}}class Gf extends aa{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class ta extends aa{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class hx extends aa{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class ln extends aa{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Kp extends aa{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class mb extends aa{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class gb extends aa{constructor(e,t){super(15,e),this.reason=t,this.reasonName=typeof t=="string"?t:Wf[t]}}var $n;(function(n){n[n.AlreadyOpened=0]="AlreadyOpened",n[n.AbnormalEnd=1]="AbnormalEnd",n[n.DecodeFailed=2]="DecodeFailed",n[n.LengthExceeded=3]="LengthExceeded",n[n.Incomplete=4]="Incomplete",n[n.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",n[n.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})($n||($n={}));class Ur extends aa{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=$n[t]}}var gd;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(gd||(gd={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(gd||(gd={}));var vb;(function(n){n[n.InvalidKey=0]="InvalidKey",n[n.MissingKey=1]="MissingKey",n[n.InternalError=2]="InternalError"})(vb||(vb={}));var Se;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.Moved="moved",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.ParticipantAttributesChanged="participantAttributesChanged",n.ParticipantActive="participantActive",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged",n.ChatMessage="chatMessage",n.LocalTrackSubscribed="localTrackSubscribed",n.MetricsReceived="metricsReceived"})(Se||(Se={}));var Le;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackCpuConstrained="localTrackCpuConstrained",n.LocalSenderCreated="localSenderCreated",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.TrackCpuConstrained="trackCpuConstrained",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded",n.AttributesChanged="attributesChanged",n.LocalTrackSubscribed="localTrackSubscribed",n.ChatMessage="chatMessage",n.Active="active"})(Le||(Le={}));var Ae;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackSubscribed="localTrackSubscribed",n.Offline="offline",n.SignalRequestResponse="signalRequestResponse",n.SignalConnected="signalConnected",n.RoomMoved="roomMoved"})(Ae||(Ae={}));var _e;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.CpuConstrained="cpuConstrained",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed",n.TrackProcessorUpdate="trackProcessorUpdate",n.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",n.TranscriptionReceived="transcriptionReceived",n.TimeSyncUpdate="timeSyncUpdate",n.PreConnectBufferFlushed="preConnectBufferFlushed"})(_e||(_e={}));function px(n){return typeof n>"u"?n:typeof structuredClone=="function"?typeof n=="object"&&n!==null?structuredClone(Object.assign({},n)):structuredClone(n):JSON.parse(JSON.stringify(n))}const fx=/version\/(\d+(\.?_?\d+)+)/i;let dp;function hr(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(dp===void 0||e){const r=mx.find(a=>{let{test:s}=a;return s.test(t)});dp=r==null?void 0:r.describe(t)}return dp}const mx=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:Zu(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:hp(n)}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:Zu(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0,osVersion:hp(n)}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:Zu(fx,n),os:n.includes("mobile/")?"iOS":"macOS",osVersion:hp(n)}}}];function Zu(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(n);return r&&r.length>=t&&r[t]||""}function hp(n){return n.includes("mac os")?Zu(/\(.+?(\d+_\d+(:?_\d+)?)/,n,1).replace(/_/g,"."):void 0}var gx="2.15.14";const vx=gx,bx=16;class _n{}_n.setTimeout=function(){return setTimeout(...arguments)};_n.setInterval=function(){return setInterval(...arguments)};_n.clearTimeout=function(){return clearTimeout(...arguments)};_n.clearInterval=function(){return clearInterval(...arguments)};const yx=5e3,Vl=[];var Cr;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH"})(Cr||(Cr={}));class me extends Oi.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var a;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=me.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=ct,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),yx):this.handleAppVisibilityChanged()},this.log=ia((a=r.loggerName)!==null&&a!==void 0?a:ui.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=me.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),pt(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===me.Kind.Video&&(t="video"),this.attachedElements.length===0&&this.kind===me.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(Vl.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&Vl.splice(Vl.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),Ms(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),a=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(a?_e.AudioPlaybackStarted:_e.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(a?_e.AudioPlaybackFailed:_e.VideoPlaybackFailed,s):s.name==="AbortError"?ct.debug("".concat(a?"audio":"video"," playback aborted, likely due to new play request")):ct.warn("could not playback ".concat(a?"audio":"video"),s),a&&e&&r.some(l=>l.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(_e.ElementAttached,e),e}detach(e){try{if(e){Us(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(_e.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(r=>{Us(this.mediaStreamTrack,r),t.push(r),this.recycleElement(r),this.emit(_e.ElementDetached,r)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=ia(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),Vl.forEach(r=>{r.parentElement||(t=!1)}),t&&Vl.push(e)}}handleAppVisibilityChanged(){return j(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===me.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){dr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){dr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Ms(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let r;n.kind==="audio"?r=t.getAudioTracks():r=t.getVideoTracks(),r.includes(n)||(r.forEach(a=>{t.removeTrack(a)}),t.addTrack(n)),(!No()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(No()||Lo())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function Us(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(f){f.Audio="audio",f.Video="video",f.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(f){f.Camera="camera",f.Microphone="microphone",f.ScreenShare="screen_share",f.ScreenShareAudio="screen_share_audio",f.Unknown="unknown"})(t=n.Source||(n.Source={}));let r;(function(f){f.Active="active",f.Paused="paused",f.Unknown="unknown"})(r=n.StreamState||(n.StreamState={}));function a(f){switch(f){case e.Audio:return si.AUDIO;case e.Video:return si.VIDEO;default:return si.DATA}}n.kindToProto=a;function s(f){switch(f){case si.AUDIO:return e.Audio;case si.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=s;function l(f){switch(f){case t.Camera:return nn.CAMERA;case t.Microphone:return nn.MICROPHONE;case t.ScreenShare:return nn.SCREEN_SHARE;case t.ScreenShareAudio:return nn.SCREEN_SHARE_AUDIO;default:return nn.UNKNOWN}}n.sourceToProto=l;function u(f){switch(f){case nn.CAMERA:return t.Camera;case nn.MICROPHONE:return t.Microphone;case nn.SCREEN_SHARE:return t.ScreenShare;case nn.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=u;function h(f){switch(f){case Dp.ACTIVE:return r.Active;case Dp.PAUSED:return r.Paused;default:return r.Unknown}}n.streamStateFromProto=h})(me||(me={}));class Pt{constructor(e,t,r,a,s){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(t!==void 0&&r!==void 0)this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:r,maxFramerate:a,priority:s};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const wx=["vp8","h264"],kx=["vp8","h264","vp9","av1","h265"];function Cx(n){return!!wx.find(e=>e===n)}const Sx=Cx;var bb;(function(n){n[n.PREFER_REGRESSION=0]="PREFER_REGRESSION",n[n.SIMULCAST=1]="SIMULCAST",n[n.REGRESSION=2]="REGRESSION"})(bb||(bb={}));var Jp;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:24e3},n.music={maxBitrate:48e3},n.musicStereo={maxBitrate:64e3},n.musicHighQuality={maxBitrate:96e3},n.musicHighQualityStereo={maxBitrate:128e3}})(Jp||(Jp={}));const pc={h90:new Pt(160,90,9e4,20),h180:new Pt(320,180,16e4,20),h216:new Pt(384,216,18e4,20),h360:new Pt(640,360,45e4,20),h540:new Pt(960,540,8e5,25),h720:new Pt(1280,720,17e5,30),h1080:new Pt(1920,1080,3e6,30),h1440:new Pt(2560,1440,5e6,30),h2160:new Pt(3840,2160,8e6,30)},Yp={h120:new Pt(160,120,7e4,20),h180:new Pt(240,180,125e3,20),h240:new Pt(320,240,14e4,20),h360:new Pt(480,360,33e4,20),h480:new Pt(640,480,5e5,20),h540:new Pt(720,540,6e5,25),h720:new Pt(960,720,13e5,30),h1080:new Pt(1440,1080,23e5,30),h1440:new Pt(1920,1440,38e5,30)},$f={h360fps3:new Pt(640,360,2e5,3,"medium"),h360fps15:new Pt(640,360,4e5,15,"medium"),h720fps5:new Pt(1280,720,8e5,5,"medium"),h720fps15:new Pt(1280,720,15e5,15,"medium"),h720fps30:new Pt(1280,720,2e6,30,"medium"),h1080fps15:new Pt(1920,1080,25e5,15,"medium"),h1080fps30:new Pt(1920,1080,5e6,30,"medium"),original:new Pt(0,0,7e6,30,"medium")},Tx="|",yb="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function xx(n){const e=n.split(Tx);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function Qn(n){return j(this,void 0,void 0,function*(){return new Promise(e=>_n.setTimeout(e,n))})}function Xp(){return"addTransceiver"in RTCPeerConnection.prototype}function Qp(){return"addTrack"in RTCPeerConnection.prototype}function Ex(){if(!("getCapabilities"in RTCRtpSender)||No()||Lo())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function _x(){if(!("getCapabilities"in RTCRtpSender)||Lo())return!1;if(No()){const t=hr();if(t!=null&&t.version&&Mi(t.version,"16")<0||(t==null?void 0:t.os)==="iOS"&&t!=null&&t.osVersion&&Mi(t.osVersion,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function _i(n){return n==="av1"||n==="vp9"}function Zp(n){return!document||fc()?!1:(n||(n=document.createElement("audio")),"setSinkId"in n)}function Px(){return typeof RTCPeerConnection>"u"?!1:Xp()||Qp()}function Lo(){var n;return((n=hr())===null||n===void 0?void 0:n.name)==="Firefox"}function wb(){const n=hr();return!!n&&n.name==="Chrome"&&n.os!=="iOS"}function No(){var n;return((n=hr())===null||n===void 0?void 0:n.name)==="Safari"}function fc(){const n=hr();return(n==null?void 0:n.name)==="Safari"||(n==null?void 0:n.os)==="iOS"}function Rx(){const n=hr();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&Mi(n.osVersion,"17")>=0}function Ix(n){return n||(n=hr()),(n==null?void 0:n.name)==="Safari"&&Mi(n.version,"18.3")>0||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&Mi(n.osVersion,"18.3")>0}function _1(){var n,e;return dr()?(e=(n=navigator.userAgentData)===null||n===void 0?void 0:n.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function Mx(){const n=hr(),e="17.2";if(n)return n.name!=="Safari"&&n.os!=="iOS"||n.os==="iOS"&&n.osVersion&&Mi(n.osVersion,e)>=0?!0:n.name==="Safari"&&Mi(n.version,e)>=0}function dr(){return typeof document<"u"}function Ii(){return navigator.product=="ReactNative"}function ef(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function P1(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function R1(){if(!Ii())return;let n=P1();if(n)return n.platform}function kb(){if(dr())return window.devicePixelRatio;if(Ii()){let n=P1();if(n)return n.devicePixelRatio}return 1}function Mi(n,e){const t=n.split("."),r=e.split("."),a=Math.min(t.length,r.length);for(let s=0;s<a;++s){const l=parseInt(t[s],10),u=parseInt(r[s],10);if(l>u)return 1;if(l<u)return-1;if(s===a-1&&l===u)return 0}return n===""&&e!==""?-1:e===""?1:t.length==r.length?0:t.length<r.length?-1:1}function Ox(n){for(const e of n)e.target.handleResize(e)}function Ax(n){for(const e of n)e.target.handleVisibilityChanged(e)}let pp=null;const Cb=()=>(pp||(pp=new ResizeObserver(Ox)),pp);let fp=null;const Sb=()=>(fp||(fp=new IntersectionObserver(Ax,{root:null,rootMargin:"0px"})),fp);function Lx(){var n;const e=new A0({sdk:L0.JS,protocol:bx,version:vx});return Ii()&&(e.os=(n=R1())!==null&&n!==void 0?n:""),e}function Tb(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const a=document.createElement("canvas");a.width=n,a.height=e;const s=a.getContext("2d");s==null||s.fillRect(0,0,a.width,a.height),r&&s&&(s.beginPath(),s.arc(n/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const l=a.captureStream(),[u]=l.getTracks();if(!u)throw Error("Could not get empty media stream video track");return u.enabled=t,u}let Hl;function mp(){if(!Hl){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const r=n.createMediaStreamDestination();if(e.connect(t),t.connect(r),e.start(),[Hl]=r.stream.getAudioTracks(),!Hl)throw Error("Could not get empty media stream audio track");Hl.enabled=!1}return Hl.clone()}class Vr{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((r,a)=>j(this,void 0,void 0,function*(){this.resolve=r,this.reject=a,e&&(yield e(r,a))})).finally(()=>{var r;this._isResolved=!0,(r=this.onFinally)===null||r===void 0||r.call(this)})}}function Nx(n){return kx.includes(n)}function Fa(n){if(typeof n=="string"||typeof n=="number")return n;if(Array.isArray(n))return n[0];if(n.exact!==void 0)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal!==void 0)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function jx(n){return n.startsWith("http")?n.replace(/^(http)/,"ws"):n}function tf(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}function Dx(n,e){return n.segments.map(t=>{let{id:r,text:a,language:s,startTime:l,endTime:u,final:h}=t;var f;const g=(f=e.get(r))!==null&&f!==void 0?f:Date.now(),C=Date.now();return h?e.delete(r):e.set(r,g),{id:r,text:a,startTime:Number.parseInt(l.toString()),endTime:Number.parseInt(u.toString()),final:h,language:s,firstReceivedTime:g,lastReceivedTime:C}})}function Fx(n){const{id:e,timestamp:t,message:r,editTimestamp:a}=n;return{id:e,timestamp:Number.parseInt(t.toString()),editTimestamp:a?Number.parseInt(a.toString()):void 0,message:r}}function xb(n){switch(n.reason){case mt.LeaveRequest:return n.context;case mt.Cancelled:return ci.CLIENT_INITIATED;case mt.NotAllowed:return ci.USER_REJECTED;case mt.ServerUnreachable:return ci.JOIN_FAILURE;default:return ci.UNKNOWN_REASON}}function ed(n){return n!==void 0?Number(n):void 0}function Po(n){return n!==void 0?BigInt(n):void 0}function Bs(n){return!!n&&!(n instanceof MediaStreamTrack)&&n.isLocal}function Pi(n){return!!n&&n.kind==me.Kind.Audio}function Va(n){return!!n&&n.kind==me.Kind.Video}function Ia(n){return Bs(n)&&Va(n)}function Yi(n){return Bs(n)&&Pi(n)}function nf(n){return!!n&&!n.isLocal}function Ux(n){return!!n&&!n.isLocal}function gp(n){return nf(n)&&Va(n)}function Bx(n){return n.isLocal}function Vx(n,e){const t=[];let r=new TextEncoder().encode(n);for(;r.length>e;){let a=e;for(;a>0;){const s=r[a];if(s!==void 0&&(s&192)!==128)break;a--}t.push(r.slice(0,a)),r=r.slice(a)}return r.length>0&&t.push(r),t}function Hx(n){var e;const t=n.get("Cache-Control");if(t){const r=(e=t.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(r)return parseInt(r,10)}}function I1(n,e,t){var r,a,s,l;const{optionsWithoutProcessor:u,audioProcessor:h,videoProcessor:f}=A1(n??{}),g=e==null?void 0:e.processor,C=t==null?void 0:t.processor,x=u??{};return x.audio===!0&&(x.audio={}),x.video===!0&&(x.video={}),x.audio&&(rf(x.audio,e),(r=(s=x.audio).deviceId)!==null&&r!==void 0||(s.deviceId={ideal:"default"}),(h||g)&&(x.audio.processor=h??g)),x.video&&(rf(x.video,t),(a=(l=x.video).deviceId)!==null&&a!==void 0||(l.deviceId={ideal:"default"}),(f||C)&&(x.video.processor=f??C)),x}function rf(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function Kf(n){var e,t,r,a;const s={};if(n.video)if(typeof n.video=="object"){const l={},u=l,h=n.video;Object.keys(h).forEach(f=>{switch(f){case"resolution":rf(u,h.resolution);break;default:u[f]=h[f]}}),s.video=l,(e=(r=s.video).deviceId)!==null&&e!==void 0||(r.deviceId={ideal:"default"})}else s.video=n.video?{deviceId:{ideal:"default"}}:!1;else s.video=!1;return n.audio?typeof n.audio=="object"?(s.audio=n.audio,(t=(a=s.audio).deviceId)!==null&&t!==void 0||(a.deviceId={ideal:"default"})):s.audio={deviceId:{ideal:"default"}}:s.audio=!1,s}function M1(n){return j(this,arguments,void 0,function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=O1();if(r){const a=r.createAnalyser();a.fftSize=2048;const s=a.frequencyBinCount,l=new Uint8Array(s);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(a),yield Qn(t),a.getByteTimeDomainData(l);const u=l.some(h=>h!==128&&h!==0);return r.close(),!u}return!1}()})}function O1(){var n;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const t=new e({latencyHint:"interactive"});if(t.state==="suspended"&&typeof window<"u"&&!((n=window.document)===null||n===void 0)&&n.body){const r=()=>j(this,void 0,void 0,function*(){var a;try{t.state==="suspended"&&(yield t.resume())}catch(s){console.warn("Error trying to auto-resume audio context",s)}finally{(a=window.document.body)===null||a===void 0||a.removeEventListener("click",r)}});t.addEventListener("statechange",()=>{var a;t.state==="closed"&&((a=window.document.body)===null||a===void 0||a.removeEventListener("click",r))}),window.document.body.addEventListener("click",r)}return t}}function qx(n){return n==="audioinput"?me.Source.Microphone:n==="videoinput"?me.Source.Camera:me.Source.Unknown}function af(n){return n===me.Source.Microphone?"audioinput":n===me.Source.Camera?"videoinput":void 0}function Wx(n){var e,t;let r=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(r=typeof r=="boolean"?{}:r,No()?r=Object.assign(Object.assign({},r),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:r,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio,preferCurrentTab:n.preferCurrentTab}}function Zl(n){return n.split("/")[1].toLowerCase()}function zx(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new Uf({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function pt(n){return"mediaStreamTrack"in n?{trackID:n.sid,source:n.source,muted:n.isMuted,enabled:n.mediaStreamTrack.enabled,kind:n.kind,streamID:n.mediaStreamID,streamTrackID:n.mediaStreamTrack.id}:{trackID:n.trackSid,enabled:n.isEnabled,muted:n.isMuted,trackInfo:Object.assign({mimeType:n.mimeType,name:n.trackName,encrypted:n.isEncrypted,kind:n.kind,source:n.source},n.track?pt(n.track):{})}}function Gx(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function $x(n,e){var t;n===void 0&&(n={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(n)],a={};for(const s of r)n[s]!==e[s]&&(a[s]=(t=e[s])!==null&&t!==void 0?t:"");return a}function A1(n){const e=Object.assign({},n);let t,r;return typeof e.audio=="object"&&e.audio.processor&&(t=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:t,videoProcessor:r,optionsWithoutProcessor:px(e)}}function Kx(n){switch(n){case nn.CAMERA:return me.Source.Camera;case nn.MICROPHONE:return me.Source.Microphone;case nn.SCREEN_SHARE:return me.Source.ScreenShare;case nn.SCREEN_SHARE_AUDIO:return me.Source.ScreenShareAudio;default:return me.Source.Unknown}}function Eb(n,e){return n.width*n.height<e.width*e.height}function Jx(n,e){var t;return(t=n.layers)===null||t===void 0?void 0:t.find(r=>r.quality===e)}class Yx extends Oi.EventEmitter{constructor(e,t){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=r=>{var a,s;const{kind:l,data:u}=r.data;switch(l){case"error":ct.error(u.error.message),this.emit(Na.EncryptionError,u.error);break;case"initAck":u.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)});break;case"enable":if(u.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)}),this.encryptionEnabled!==u.enabled&&u.participantIdentity===((a=this.room)===null||a===void 0?void 0:a.localParticipant.identity))this.emit(Na.ParticipantEncryptionStatusChanged,u.enabled,this.room.localParticipant),this.encryptionEnabled=u.enabled;else if(u.participantIdentity){const g=(s=this.room)===null||s===void 0?void 0:s.getParticipantByIdentity(u.participantIdentity);if(!g)throw TypeError("couldn't set encryption status, participant not found".concat(u.participantIdentity));this.emit(Na.ParticipantEncryptionStatusChanged,u.enabled,g)}break;case"ratchetKey":this.keyProvider.emit(Da.KeyRatcheted,u.ratchetResult,u.participantIdentity,u.keyIndex);break;case"decryptDataResponse":const h=this.decryptDataRequests.get(u.uuid);h!=null&&h.resolve&&h.resolve(u);break;case"encryptDataResponse":const f=this.encryptDataRequests.get(u.uuid);f!=null&&f.resolve&&f.resolve(u);break}},this.onWorkerError=r=>{ct.error("e2ee worker encountered an error:",{error:r.error}),this.emit(Na.EncryptionError,r.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=t}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!cx())throw new Gf("tried to setup end-to-end encryption on an unsupported browser");if(ct.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:$T.getLevel()}};this.worker&&(ct.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){ct.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?ct.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Ae.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(Se.TrackPublished,(r,a)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==dn.NONE,a.identity)),e.on(Se.ConnectionStateChanged,r=>{r===wt.Connected&&e.remoteParticipants.forEach(a=>{a.trackPublications.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==dn.NONE,a.identity)})})}).on(Se.TrackUnsubscribed,(r,a,s)=>{var l;const u={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(l=this.worker)===null||l===void 0||l.postMessage(u)}).on(Se.TrackSubscribed,(r,a,s)=>{this.setupE2EEReceiver(r,s.identity,a.trackInfo)}).on(Se.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Le.LocalSenderCreated,(r,a)=>j(this,void 0,void 0,function*(){this.setupE2EESender(a,r)})),e.localParticipant.on(Le.LocalTrackPublished,r=>{if(!Va(r.track)||!fc())return;const a={kind:"updateCodec",data:{trackId:r.track.mediaStreamID,codec:Zl(r.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(a)}),t.on(Da.SetKey,r=>this.postKey(r)).on(Da.RatchetRequest,(r,a)=>this.postRatchetRequest(r,a))}encryptData(e){return j(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const t=crypto.randomUUID(),r={kind:"encryptDataRequest",data:{uuid:t,payload:e,participantIdentity:this.room.localParticipant.identity}},a=new Vr;return a.onFinally=()=>{this.encryptDataRequests.delete(t)},this.encryptDataRequests.set(t,a),this.worker.postMessage(r),a.promise})}handleEncryptedData(e,t,r,a){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const s=crypto.randomUUID(),l={kind:"decryptDataRequest",data:{uuid:s,payload:e,iv:t,participantIdentity:r,keyIndex:a}},u=new Vr;return u.onFinally=()=>{this.decryptDataRequests.delete(s)},this.decryptDataRequests.set(s,u),this.worker.postMessage(l),u.promise}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(r)}postKey(e){let{key:t,participantIdentity:r,keyIndex:a}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const l={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:t,keyIndex:a}};this.worker.postMessage(l)}postEnable(e,t){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?Zl(r.mimeType):void 0)}}setupE2EESender(e,t){if(!Bs(e)||!t){t||ct.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,r,a){return j(this,void 0,void 0,function*(){if(this.worker){if($p()&&!wb()){const s={kind:"decode",participantIdentity:r,trackId:t,codec:a};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(Bl in e&&a){const h={kind:"updateCodec",data:{trackId:t,codec:a,participantIdentity:r}};this.worker.postMessage(h);return}let s=e.writableStream,l=e.readableStream;if(!s||!l){const h=e.createEncodedStreams();e.writableStream=h.writable,s=h.writable,e.readableStream=h.readable,l=h.readable}const u={kind:"decode",data:{readableStream:l,writableStream:s,trackId:t,codec:a,participantIdentity:r,isReuse:Bl in e}};this.worker.postMessage(u,[l,s])}e[Bl]=!0}})}handleSender(e,t,r){var a;if(!(Bl in e||!this.worker)){if(!(!((a=this.room)===null||a===void 0)&&a.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if($p()&&!wb()){ct.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{ct.info("initialize encoded streams");const s=e.createEncodedStreams(),l={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(l,[s.readable,s.writable])}e[Bl]=!0}}}const vp="default";class vn{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new vn),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return j(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;if(((s=vn.userMediaPromiseMap)===null||s===void 0?void 0:s.size)>0){ct.debug("awaiting getUserMedia promise");try{t?yield vn.userMediaPromiseMap.get(t):yield Promise.all(vn.userMediaPromiseMap.values())}catch{ct.warn("error waiting for media permissons")}}let l=yield navigator.mediaDevices.enumerateDevices();if(a&&!(No()&&r.hasDeviceInUse(t))&&(l.filter(u=>u.kind===t).length===0||l.some(u=>{const h=u.label==="",f=t?u.kind===t:!0;return h&&f}))){const u={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"&&{deviceId:{ideal:"default"}}},h=yield navigator.mediaDevices.getUserMedia(u);l=yield navigator.mediaDevices.enumerateDevices(),h.getTracks().forEach(f=>{f.stop()})}return r._previousDevices=l,t&&(l=l.filter(u=>u.kind===t)),l}()})}normalizeDeviceId(e,t,r){return j(this,void 0,void 0,function*(){if(t!==vp)return t;const a=yield this.getDevices(e),s=a.find(u=>u.deviceId===vp);if(!s){ct.warn("could not reliably determine default device");return}const l=a.find(u=>u.deviceId!==vp&&u.groupId===(r??s.groupId));if(!l){ct.warn("could not reliably determine default device");return}return l==null?void 0:l.deviceId})}hasDeviceInUse(e){return e?vn.userMediaPromiseMap.has(e):vn.userMediaPromiseMap.size>0}}vn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];vn.userMediaPromiseMap=new Map;var ec;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(ec||(ec={}));class Xx{constructor(){this.pendingTasks=new Map,this.taskMutex=new Xn,this.nextTaskIndex=0}run(e){return j(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:ec.WAITING};this.pendingTasks.set(t.id,t);const r=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=ec.RUNNING,yield e()}finally{t.status=ec.COMPLETED,this.pendingTasks.delete(t.id),r()}})}flush(){return j(this,void 0,void 0,function*(){return this.run(()=>j(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class Qx{get readyState(){return this.ws.readyState}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r,a;if(!((r=t.signal)===null||r===void 0)&&r.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const s=new WebSocket(e,(a=t.protocols)!==null&&a!==void 0?a:[]);s.binaryType="arraybuffer",this.ws=s;const l=function(){let{closeCode:u,reason:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s.close(u,h)};this.opened=new Promise((u,h)=>{s.onopen=()=>{u({readable:new ReadableStream({start(f){s.onmessage=g=>{let{data:C}=g;return f.enqueue(C)},s.onerror=g=>f.error(g)},cancel:l}),writable:new WritableStream({write(f){s.send(f)},abort(){s.close()},close:l}),protocol:s.protocol,extensions:s.extensions}),s.removeEventListener("error",h)},s.addEventListener("error",h)}),this.closed=new Promise((u,h)=>{const f=()=>j(this,void 0,void 0,function*(){const g=new Promise(x=>{s.readyState!==WebSocket.CLOSED&&s.addEventListener("close",T=>{x(T)},{once:!0})}),C=yield Promise.race([Qn(250),g]);C?u(C):h(new Error("Encountered unspecified websocket error without a timely close event"))});s.onclose=g=>{let{code:C,reason:x}=g;u({closeCode:C,reason:x}),s.removeEventListener("error",f)},s.addEventListener("error",f)}),t.signal&&(t.signal.onabort=()=>s.close()),this.close=l}}function Zx(n,e){const t=new URL(jx(n));return e.forEach((r,a)=>{t.searchParams.set(a,r)}),L1(t,"rtc")}function e2(n){const e=new URL(tf(n));return L1(e,"validate")}function t2(n){return n.endsWith("/")?n:"".concat(n,"/")}function L1(n,e){return n.pathname="".concat(t2(n.pathname)).concat(e),n.toString()}function _b(n){if(typeof n=="string")return tb.fromJson(JSON.parse(n),{ignoreUnknownFields:!0});if(n instanceof ArrayBuffer)return tb.fromBinary(new Uint8Array(n));throw new Error("could not decode websocket message: ".concat(typeof n))}function n2(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(n instanceof AbortSignal))return e;const t=n.reason;switch(typeof t){case"string":return t;case"object":return t instanceof Error?t.message:e;default:return"toString"in t?t.toString():e}}const r2=["syncState","trickle","offer","answer","simulate","leave"];function i2(n){const e=r2.indexOf(n.case)>=0;return ct.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var qt;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})(qt||(qt={}));const a2=250;class Jf{get currentState(){return this.state}get isDisconnected(){return this.state===qt.DISCONNECTING||this.state===qt.DISCONNECTED}get isEstablishingConnection(){return this.state===qt.CONNECTING||this.state===qt.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=qt.DISCONNECTED,this.log=ct,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=ia((r=t.loggerName)!==null&&r!==void 0?r:ui.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new Xx,this.queuedRequests=[],this.closingLock=new Xn,this.connectionLock=new Xn,this.state=qt.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,r,a){return j(this,void 0,void 0,function*(){return this.state=qt.CONNECTING,this.options=r,yield this.connect(e,t,r,a)})}reconnect(e,t,r,a){return j(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=qt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:a}))})}connect(e,t,r,a){return j(this,void 0,void 0,function*(){const s=yield this.connectionLock.lock();this.connectOptions=r;const l=Lx(),u=r.singlePeerConnection?s2(t,l,r):o2(t,l,r),h=Zx(e,u),f=e2(h);return new Promise((g,C)=>j(this,void 0,void 0,function*(){var x,T;try{let V=!1;const A=O=>j(this,void 0,void 0,function*(){if(V)return;V=!0;const D=O instanceof Event?O.currentTarget:O,Q=n2(D,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(Q)).catch(ie=>{this.log.error(ie),this.close()}):this.close(),W(),C(D instanceof AbortSignal?D.reason:D)});a==null||a.addEventListener("abort",A);const W=()=>{clearTimeout(U),a==null||a.removeEventListener("abort",A)},U=setTimeout(()=>{A(new kt("room connection has timed out (signal)",mt.ServerUnreachable))},r.websocketTimeout),G=(O,D)=>{this.handleSignalConnected(O,U,D)},F=new URL(h);F.searchParams.has("access_token")&&F.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(F),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new Qx(h);try{this.ws.closed.then(K=>{this.isEstablishingConnection&&C(new kt("Websocket got closed during a (re)connection attempt: ".concat(K.reason),mt.InternalError)),K.closeCode!==1e3&&this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:K.reason,code:K.closeCode,wasClean:K.closeCode===1e3,state:this.state}))}).catch(K=>{this.isEstablishingConnection&&C(new kt("Websocket error during a (re)connection attempt: ".concat(K),mt.InternalError))});const O=yield this.ws.opened.catch(K=>j(this,void 0,void 0,function*(){if(this.state!==qt.CONNECTED){this.state=qt.DISCONNECTED,clearTimeout(U);const X=yield this.handleConnectionError(K,f);C(X);return}this.handleWSError(K),C(K)}));if(clearTimeout(U),!O)return;const D=O.readable.getReader();this.streamWriter=O.writable.getWriter();const Q=yield D.read();if(D.releaseLock(),!Q.value)throw new kt("no message received as first message",mt.InternalError);const ie=_b(Q.value),Y=this.validateFirstMessage(ie,(x=r.reconnect)!==null&&x!==void 0?x:!1);if(!Y.isValid){C(Y.error);return}((T=ie.message)===null||T===void 0?void 0:T.case)==="join"&&(this.pingTimeoutDuration=ie.message.value.pingTimeout,this.pingIntervalDuration=ie.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const z=Y.shouldProcessFirstMessage?ie:void 0;G(O,z),g(Y.response)}catch(O){C(O)}finally{W()}}finally{s()}}))})}startReadingLoop(e,t){return j(this,void 0,void 0,function*(){for(t&&this.handleSignalResponse(t);;){this.signalLatency&&(yield Qn(this.signalLatency));const{done:r,value:a}=yield e.read();if(r)break;const s=_b(a);this.handleSignalResponse(s)}})}close(){return j(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return function*(){const a=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=qt.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:r});const s=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([s,Qn(a2)])}}catch(s){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:s}))}finally{t&&(e.state=qt.DISCONNECTED),a()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Os(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Os(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Rd({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Id({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return j(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const u=s.getNextRequestId();return yield s.sendRequest({case:"updateMetadata",value:new Vf({requestId:u,metadata:r,name:a,attributes:l})}),u}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new V0({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new W0({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ft.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new $0({timestamp:Ft.parse(Date.now()),rtt:Ft.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new Bf({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new Od({reason:ci.CLIENT_INITIATED,action:Ds.DISCONNECT})})}sendRequest(e){return j(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!a&&!i2(t)&&r.state===qt.RECONNECTING){r.queuedRequests.push(()=>j(r,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(a||(yield r.requestQueue.flush()),r.signalLatency&&(yield Qn(r.signalLatency)),r.isDisconnected){r.log.debug("skipping signal request (type: ".concat(t.case,") - SignalClient disconnected"));return}if(!r.streamWriter){r.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),r.logContext);return}const s=new gT({message:t});try{r.useJSON?yield r.streamWriter.write(s.toJsonString()):yield r.streamWriter.write(s.toBinary())}catch(l){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:l}))}}()})}handleSignalResponse(e){var t,r;const a=e.message;if(a==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(a.case==="answer"){const l=Pb(a.value);this.onAnswer&&this.onAnswer(l,a.value.id,a.value.midToTrackId)}else if(a.case==="offer"){const l=Pb(a.value);this.onOffer&&this.onOffer(l,a.value.id,a.value.midToTrackId)}else if(a.case==="trickle"){const l=JSON.parse(a.value.candidateInit);this.onTrickle&&this.onTrickle(l,a.value.target)}else a.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=a.value.participants)!==null&&t!==void 0?t:[]):a.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(a.value):a.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=a.value.speakers)!==null&&r!==void 0?r:[]):a.case==="leave"?this.onLeave&&this.onLeave(a.value):a.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(a.value.sid,a.value.muted):a.case==="roomUpdate"?this.onRoomUpdate&&a.value.room&&this.onRoomUpdate(a.value.room):a.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(a.value):a.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(a.value):a.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(a.value):a.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(a.value):a.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(a.value):a.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(a.value):a.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(a.value):a.case==="pong"||(a.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(a.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):a.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(a.value):a.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(a.value.trackSid):a.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(a.value.token),this.onRoomMoved&&this.onRoomMoved(a.value)):a.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(a.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:a.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return j(this,void 0,void 0,function*(){if(this.state===qt.DISCONNECTED)return;const t=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=_n.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&_n.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=_n.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&_n.clearInterval(this.pingInterval)}handleSignalConnected(e,t,r){this.state=qt.CONNECTED,clearTimeout(t),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),r)}validateFirstMessage(e,t){var r,a,s,l,u;return((r=e.message)===null||r===void 0?void 0:r.case)==="join"?{isValid:!0,response:e.message.value}:this.state===qt.RECONNECTING&&((a=e.message)===null||a===void 0?void 0:a.case)!=="leave"?((s=e.message)===null||s===void 0?void 0:s.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((l=e.message)===null||l===void 0?void 0:l.case)==="leave"?{isValid:!1,error:new kt("Received leave request while trying to (re)connect",mt.LeaveRequest,void 0,e.message.value.reason)}:t?{isValid:!1,error:new kt("Unexpected first message",mt.InternalError)}:{isValid:!1,error:new kt("did not receive join response, got ".concat((u=e.message)===null||u===void 0?void 0:u.case," instead"),mt.InternalError)}}handleConnectionError(e,t){return j(this,void 0,void 0,function*(){try{const r=yield fetch(t);if(r.status.toFixed(0).startsWith("4")){const a=yield r.text();return new kt(a,mt.NotAllowed,r.status)}else return e instanceof kt?e:new kt("Encountered unknown websocket error during connection: ".concat(e),mt.InternalError,r.status)}catch(r){return r instanceof kt?r:new kt(r instanceof Error?r.message:"server was not reachable",mt.ServerUnreachable)}})}}function Pb(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function Os(n,e){return new Ba({sdp:n.sdp,type:n.type,id:e})}function o2(n,e,t){var r;const a=new URLSearchParams;return a.set("access_token",n),t.reconnect&&(a.set("reconnect","1"),t.sid&&a.set("sid",t.sid)),a.set("auto_subscribe",t.autoSubscribe?"1":"0"),a.set("sdk",Ii()?"reactnative":"js"),a.set("version",e.version),a.set("protocol",e.protocol.toString()),e.deviceModel&&a.set("device_model",e.deviceModel),e.os&&a.set("os",e.os),e.osVersion&&a.set("os_version",e.osVersion),e.browser&&a.set("browser",e.browser),e.browserVersion&&a.set("browser_version",e.browserVersion),t.adaptiveStream&&a.set("adaptive_stream","1"),t.reconnectReason&&a.set("reconnect_reason",t.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&a.set("network",navigator.connection.type),a}function s2(n,e,t){const r=new URLSearchParams;r.set("access_token",n);const a=new FT({clientInfo:e,connectionSettings:new K0({autoSubscribe:!!t.autoSubscribe,adaptiveStream:!!t.adaptiveStream}),reconnect:!!t.reconnect,participantSid:t.sid?t.sid:void 0});t.reconnectReason&&(a.reconnectReason=t.reconnectReason);const s=new UT({joinRequest:a.toBinary()});return r.set("join_request",btoa(new TextDecoder("utf-8").decode(s.toBinary()))),r}class Rb{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class l2{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const r=Date.now();r-this._lastCleanup>this.ttl/2&&this.cleanup();const a=r+this.ttl;return this._map.set(e,{value:t,expiresAt:a}),this}get(e){const t=this._map.get(e);if(t){if(t.expiresAt<Date.now()){this._map.delete(e);return}return t.value}}has(e){const t=this._map.get(e);return t?t.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,r]of this._map.entries())r.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e(r.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],r=this.asValueMap();for(const[a,s]of r.entries())t.push(e(s,a,r));return t}asValueMap(){const e=new Map;for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e.set(t,r.value);return e}}var ii={},Ib={},bp={exports:{}},Mb;function Yf(){if(Mb)return bp.exports;Mb=1;var n=bp.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),bp.exports}var Ob;function c2(){return Ob||(Ob=1,function(n){var e=function(u){return String(Number(u))===u?Number(u):u},t=function(u,h,f,g){if(g&&!f)h[g]=e(u[1]);else for(var C=0;C<f.length;C+=1)u[C+1]!=null&&(h[f[C]]=e(u[C+1]))},r=function(u,h,f){var g=u.name&&u.names;u.push&&!h[u.push]?h[u.push]=[]:g&&!h[u.name]&&(h[u.name]={});var C=u.push?{}:g?h[u.name]:h;t(f.match(u.reg),C,u.names,u.name),u.push&&h[u.push].push(C)},a=Yf(),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(u){var h={},f=[],g=h;return u.split(/(\r\n|\r|\n)/).filter(s).forEach(function(C){var x=C[0],T=C.slice(2);x==="m"&&(f.push({rtp:[],fmtp:[]}),g=f[f.length-1]);for(var V=0;V<(a[x]||[]).length;V+=1){var A=a[x][V];if(A.reg.test(T))return r(A,g,T)}}),h.media=f,h};var l=function(u,h){var f=h.split(/=(.+)/,2);return f.length===2?u[f[0]]=e(f[1]):f.length===1&&h.length>1&&(u[f[0]]=void 0),u};n.parseParams=function(u){return u.split(/;\s?/).reduce(l,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(u){return u.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(u){for(var h=[],f=u.split(" ").map(e),g=0;g<f.length;g+=3)h.push({component:f[g],ip:f[g+1],port:f[g+2]});return h},n.parseImageAttributes=function(u){return u.split(" ").map(function(h){return h.substring(1,h.length-1).split(",").reduce(l,{})})},n.parseSimulcastStreamList=function(u){return u.split(";").map(function(h){return h.split(",").map(function(f){var g,C=!1;return f[0]!=="~"?g=e(f):(g=e(f.substring(1,f.length)),C=!0),{scid:g,paused:C}})})}}(Ib)),Ib}var yp,Ab;function u2(){if(Ab)return yp;Ab=1;var n=Yf(),e=/%[sdv%]/g,t=function(l){var u=1,h=arguments,f=h.length;return l.replace(e,function(g){if(u>=f)return g;var C=h[u];switch(u+=1,g){case"%%":return"%";case"%s":return String(C);case"%d":return Number(C);case"%v":return""}})},r=function(l,u,h){var f=u.format instanceof Function?u.format(u.push?h:h[u.name]):u.format,g=[l+"="+f];if(u.names)for(var C=0;C<u.names.length;C+=1){var x=u.names[C];u.name?g.push(h[u.name][x]):g.push(h[u.names[C]])}else g.push(h[u.name]);return t.apply(null,g)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];return yp=function(l,u){u=u||{},l.version==null&&(l.version=0),l.name==null&&(l.name=" "),l.media.forEach(function(C){C.payloads==null&&(C.payloads="")});var h=u.outerOrder||a,f=u.innerOrder||s,g=[];return h.forEach(function(C){n[C].forEach(function(x){x.name in l&&l[x.name]!=null?g.push(r(C,x,l)):x.push in l&&l[x.push]!=null&&l[x.push].forEach(function(T){g.push(r(C,x,T))})})}),l.media.forEach(function(C){g.push(r("m",n.m[0],C)),f.forEach(function(x){n[x].forEach(function(T){T.name in C&&C[T.name]!=null?g.push(r(x,T,C)):T.push in C&&C[T.push]!=null&&C[T.push].forEach(function(V){g.push(r(x,T,V))})})})}),g.join(`\r
`)+`\r
`},yp}var Lb;function d2(){if(Lb)return ii;Lb=1;var n=c2(),e=u2(),t=Yf();return ii.grammar=t,ii.write=e,ii.parse=n.parse,ii.parseParams=n.parseParams,ii.parseFmtpConfig=n.parseFmtpConfig,ii.parsePayloads=n.parsePayloads,ii.parseRemoteCandidates=n.parseRemoteCandidates,ii.parseImageAttributes=n.parseImageAttributes,ii.parseSimulcastStreamList=n.parseSimulcastStreamList,ii}var Ma=d2();function Xf(n,e,t){var r,a,s;e===void 0&&(e=50),t===void 0&&(t={});var l=(r=t.isImmediate)!=null&&r,u=(a=t.callback)!=null&&a,h=t.maxWait,f=Date.now(),g=[];function C(){if(h!==void 0){var T=Date.now()-f;if(T+e>=h)return h-T}return e}var x=function(){var T=[].slice.call(arguments),V=this;return new Promise(function(A,W){var U=l&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,f=Date.now(),!l){var F=n.apply(V,T);u&&u(F),g.forEach(function(O){return(0,O.resolve)(F)}),g=[]}},C()),U){var G=n.apply(V,T);return u&&u(G),A(G)}g.push({resolve:A,reject:W})})};return x.cancel=function(T){s!==void 0&&clearTimeout(s),g.forEach(function(V){return(0,V.reject)(T)}),g=[]},x}const h2=.7,p2=20,Vs={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class Nb extends Oi.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=ct,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Xf(a=>j(this,void 0,void 0,function*(){this.emit(Vs.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(a)a(s);else throw s}}),p2),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ia((r=t.loggerName)!==null&&r!==void 0?r:ui.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new Xn}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var r;t.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,t.candidate))},e.onicecandidateerror=t=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,t)},e.ontrack=t=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return j(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return j(this,void 0,void 0,function*(){var r;if(e.type==="answer"&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let a;if(e.type==="offer"){let{stereoMids:s,nackMids:l}=f2(e);this.remoteStereoMids=s,this.remoteNackMids=l}else if(e.type==="answer"){const s=Ma.parse((r=e.sdp)!==null&&r!==void 0?r:"");s.media.forEach(l=>{const u=Qf(l.mid);l.type==="audio"&&this.trackBitrates.some(h=>{if(!h.transceiver||u!=h.transceiver.mid)return!1;let f=0;if(l.rtp.some(C=>C.codec.toUpperCase()===h.codec.toUpperCase()?(f=C.payload,!0):!1),f===0)return!0;let g=!1;for(const C of l.fmtp)if(C.payload===f){C.config=C.config.split(";").filter(x=>!x.includes("maxaveragebitrate")).join(";"),h.maxbr>0&&(C.config+=";maxaveragebitrate=".concat(h.maxbr*1e3)),g=!0;break}return g||h.maxbr>0&&l.fmtp.push({payload:f,config:"maxaveragebitrate=".concat(h.maxbr*1e3)}),!0})}),a=Ma.write(s)}return yield this.setMungedSDP(e,a,!0),this.pendingCandidates.forEach(s=>{this.pc.addIceCandidate(s)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Vs.NegotiationComplete),e.sdp&&Ma.parse(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(Vs.RTPVideoPayloadTypes,s.rtp)})),!0})}createAndSendOffer(e){return j(this,void 0,void 0,function*(){var t;const r=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const u=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&u)yield this._pc.setRemoteDescription(u);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const a=this.latestOfferId+1;this.latestOfferId=a;const s=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:s.sdp},this.logContext));const l=Ma.parse((t=s.sdp)!==null&&t!==void 0?t:"");if(l.media.forEach(u=>{Db(u),u.type==="audio"?jb(u,["all"],[]):u.type==="video"&&this.trackBitrates.some(h=>{if(!u.msid||!h.cid||!u.msid.includes(h.cid))return!1;let f=0;if(u.rtp.some(C=>C.codec.toUpperCase()===h.codec.toUpperCase()?(f=C.payload,!0):!1),f===0||(_i(h.codec)&&!No()&&this.ensureVideoDDExtensionForSVC(u,l),h.codec!=="av1"))return!0;const g=Math.round(h.maxbr*h2);for(const C of u.fmtp)if(C.payload===f){C.config.includes("x-google-start-bitrate")||(C.config+=";x-google-start-bitrate=".concat(g));break}return!0})}),this.latestOfferId>a){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:a}));return}yield this.setMungedSDP(s,Ma.write(l)),this.onOffer(s,this.latestOfferId)}finally{r()}})}createAndSetAnswer(){return j(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),r=Ma.parse((e=t.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(a=>{Db(a),a.type==="audio"&&jb(a,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Ma.write(r)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTransceiverOfKind(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new ln("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new ln("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return j(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const r=new Map,a=new Map;if((yield this._pc.getStats()).forEach(l=>{switch(l.type){case"transport":t=l.selectedCandidatePairId;break;case"candidate-pair":t===""&&l.selected&&(t=l.id),r.set(l.id,l);break;case"remote-candidate":a.set(l.id,"".concat(l.address,":").concat(l.port));break}}),t==="")return;const s=(e=r.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return a.get(s)})}setMungedSDP(e,t,r){return j(this,void 0,void 0,function*(){if(t){const a=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:t})),e.sdp=a}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(a){let s="unknown error";a instanceof Error?s=a.message:typeof a=="string"&&(s=a);const l={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(l.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:l})),new Kp(s)}})}ensureVideoDDExtensionForSVC(e,t){var r,a;if(!(!((r=e.ext)===null||r===void 0)&&r.some(s=>s.uri===yb))){if(this.ddExtID===0){let s=0;t.media.forEach(l=>{var u;l.type==="video"&&((u=l.ext)===null||u===void 0||u.forEach(h=>{h.value>s&&(s=h.value)}))}),this.ddExtID=s+1}(a=e.ext)===null||a===void 0||a.push({value:this.ddExtID,uri:yb})}}}function jb(n,e,t){const r=Qf(n.mid);let a=0;n.rtp.some(s=>s.codec==="opus"?(a=s.payload,!0):!1),a>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(r)&&!n.rtcpFb.some(s=>s.payload===a&&s.type==="nack")&&n.rtcpFb.push({payload:a,type:"nack"}),(e.includes(r)||e.length===1&&e[0]==="all")&&n.fmtp.some(s=>s.payload===a?(s.config.includes("stereo=1")||(s.config+=";stereo=1"),!0):!1))}function f2(n){var e;const t=[],r=[],a=Ma.parse((e=n.sdp)!==null&&e!==void 0?e:"");let s=0;return a.media.forEach(l=>{var u;const h=Qf(l.mid);l.type==="audio"&&(l.rtp.some(f=>f.codec==="opus"?(s=f.payload,!0):!1),!((u=l.rtcpFb)===null||u===void 0)&&u.some(f=>f.payload===s&&f.type==="nack")&&r.push(h),l.fmtp.some(f=>f.payload===s?(f.config.includes("sprop-stereo=1")&&t.push(h),!0):!1))}),{stereoMids:t,nackMids:r}}function Db(n){if(n.connection){const e=n.connection.ip.indexOf(":")>=0;(n.connection.version===4&&e||n.connection.version===6&&!e)&&(n.connection.ip="0.0.0.0",n.connection.version=4)}}function Qf(n){return typeof n=="number"?n.toFixed(0):n}const of="vp8",m2={audioPreset:Jp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:$f.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:of,backupCodec:!0,preConnectBuffer:!1},N1={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},j1={deviceId:{ideal:"default"},resolution:pc.h720.resolution},g2={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new JT,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!1},Zf={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var $t;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})($t||($t={}));class v2{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,r){var a;this.peerConnectionTimeout=Zf.peerConnectionTimeout,this.log=ct,this.updateState=()=>{var s,l;const u=this.state,h=this.requiredTransports.map(f=>f.getConnectionState());h.every(f=>f==="connected")?this.state=$t.CONNECTED:h.some(f=>f==="failed")?this.state=$t.FAILED:h.some(f=>f==="connecting")?this.state=$t.CONNECTING:h.every(f=>f==="closed")?this.state=$t.CLOSED:h.some(f=>f==="closed")?this.state=$t.CLOSING:h.every(f=>f==="new")&&(this.state=$t.NEW),u!==this.state&&(this.log.debug("pc state change: from ".concat($t[u]," to ").concat($t[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),(l=this.subscriber)===null||l===void 0?void 0:l.getConnectionState()))},this.log=ia((a=r.loggerName)!==null&&a!==void 0?a:ui.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=t!=="subscriber-primary",this.isSubscriberConnectionRequired=t==="subscriber-primary",this.publisher=new Nb(e,r),t!=="publisher-only"&&(this.subscriber=new Nb(e,r),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=s=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,s,li.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var l;(l=this.onDataChannel)===null||l===void 0||l.call(this,s)},this.subscriber.onTrack=s=>{var l;(l=this.onTrack)===null||l===void 0||l.call(this,s)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,s,li.PUBLISHER)},this.publisher.onTrack=s=>{var l;(l=this.onTrack)===null||l===void 0||l.call(this,s)},this.publisher.onOffer=(s,l)=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,s,l)},this.state=$t.NEW,this.connectionLock=new Xn,this.remoteOfferLock=new Xn}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return j(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const t=this.publisher;for(const r of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(r)}catch(a){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:a}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return j(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return j(this,void 0,void 0,function*(){var r;t===li.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(r=this.subscriber)===null||r===void 0?void 0:r.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return j(this,void 0,void 0,function*(){var r,a,s;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(r=this.subscriber)===null||r===void 0?void 0:r.getSignallingState().toString()}));const l=yield this.remoteOfferLock.lock();try{return(yield(a=this.subscriber)===null||a===void 0?void 0:a.setRemoteDescription(e,t))?yield(s=this.subscriber)===null||s===void 0?void 0:s.createAndSetAnswer():void 0}finally{l()}})}updateConfiguration(e,t){var r;this.publisher.setConfiguration(e),(r=this.subscriber)===null||r===void 0||r.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return j(this,void 0,void 0,function*(){var r;const a=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,t)))}finally{a()}})}negotiate(e){return j(this,void 0,void 0,function*(){return new Promise((t,r)=>j(this,void 0,void 0,function*(){const a=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(a),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(Vs.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Vs.NegotiationComplete,()=>{clearTimeout(a),t()})}),yield this.publisher.negotiate(l=>{clearTimeout(a),r(l)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTransceiverOfKind(e,t){return this.publisher.addTransceiverOfKind(e,t)}getMidForReceiver(e){const t=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(r=>r.receiver===e);return t==null?void 0:t.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===li.PUBLISHER?this.publisher.getConnectedAddress():e===li.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return j(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((u,h)=>j(s,void 0,void 0,function*(){const f=()=>{this.log.warn("abort transport connection",this.logContext),_n.clearTimeout(g),h(new kt("room connection has been cancelled",mt.Cancelled))};a!=null&&a.signal.aborted&&f(),a==null||a.signal.addEventListener("abort",f);const g=_n.setTimeout(()=>{a==null||a.signal.removeEventListener("abort",f),h(new kt("could not establish pc connection",mt.InternalError))},l);for(;this.state!==$t.CONNECTED;)if(yield Qn(50),a!=null&&a.signal.aborted){h(new kt("room connection has been cancelled",mt.Cancelled));return}_n.clearTimeout(g),a==null||a.signal.removeEventListener("abort",f),u()}))}()})}}const D1=5e3;class cn{static fetchRegionSettings(e,t,r){return j(this,void 0,void 0,function*(){const a=yield cn.fetchLock.lock();try{const s=yield fetch("".concat(b2(e),"/regions"),{headers:{authorization:"Bearer ".concat(t)},signal:r});if(s.ok){const l=Hx(s.headers),u=l?l*1e3:D1;return{regionSettings:yield s.json(),updatedAtInMs:Date.now(),maxAgeInMs:u}}else throw new kt("Could not fetch region settings: ".concat(s.statusText),s.status===401?mt.NotAllowed:mt.InternalError,s.status)}finally{a()}})}static scheduleRefetch(e,t,r){return j(this,void 0,void 0,function*(){const a=cn.settingsTimeouts.get(e.hostname);clearTimeout(a),cn.settingsTimeouts.set(e.hostname,setTimeout(()=>j(this,void 0,void 0,function*(){try{const s=yield cn.fetchRegionSettings(e,t);cn.updateCachedRegionSettings(e,t,s)}catch(s){ct.debug("auto refetching of region settings failed",{error:s}),cn.scheduleRefetch(e,t,r)}}),r))})}static updateCachedRegionSettings(e,t,r){cn.cache.set(e.hostname,r),cn.scheduleRefetch(e,t,r.maxAgeInMs)}constructor(e,t){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return ef(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return j(this,void 0,void 0,function*(){return cn.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return j(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let t=cn.cache.get(this.serverUrl.hostname);(!t||Date.now()-t.updatedAtInMs>t.maxAgeInMs)&&(t=yield this.fetchRegionSettings(e),cn.updateCachedRegionSettings(this.serverUrl,this.token,t));const r=t.regionSettings.regions.filter(a=>!this.attemptedRegions.find(s=>s.url===a.url));if(r.length>0){const a=r[0];return this.attemptedRegions.push(a),ct.debug("next region: ".concat(a.region)),a.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){cn.updateCachedRegionSettings(this.serverUrl,this.token,e)}}cn.cache=new Map;cn.settingsTimeouts=new Map;cn.fetchLock=new Xn;function b2(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}class Jt extends Error{constructor(e,t,r){super(t),this.code=e,this.message=Fb(t,Jt.MAX_MESSAGE_BYTES),this.data=r?Fb(r,Jt.MAX_DATA_BYTES):void 0}static fromProto(e){return new Jt(e.code,e.message,e.data)}toProto(){return new R0({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Jt(Jt.ErrorCode[e],Jt.ErrorMessage[e],t)}}Jt.MAX_MESSAGE_BYTES=256;Jt.MAX_DATA_BYTES=15360;Jt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Jt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const F1=15360;function em(n){return new TextEncoder().encode(n).length}function Fb(n,e){if(em(n)<=e)return n;let t=0,r=n.length;const a=new TextEncoder;for(;t<r;){const s=Math.floor((t+r+1)/2);a.encode(n.slice(0,s)).length<=e?t=s:r=s-1}return n.slice(0,t)}const tm=2e3;function Ld(n,e){if(!e)return 0;let t,r;return"bytesReceived"in n?(t=n.bytesReceived,r=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,r=e.bytesSent),t===void 0||r===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-r)*8*1e3/(n.timestamp-e.timestamp)}const nm=typeof MediaRecorder<"u";class y2{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const w2=nm?MediaRecorder:y2;class k2 extends w2{constructor(e,t){if(!nm)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),t);let r,a;const s=()=>a===void 0,l=()=>{this.removeEventListener("dataavailable",r),this.removeEventListener("stop",l),this.removeEventListener("error",u),a==null||a.close(),a=void 0},u=h=>{a==null||a.error(h),this.removeEventListener("dataavailable",r),this.removeEventListener("stop",l),this.removeEventListener("error",u),a=void 0};this.byteStream=new ReadableStream({start:h=>{a=h,r=f=>j(this,void 0,void 0,function*(){let g;if(f.data.arrayBuffer){const C=yield f.data.arrayBuffer();g=new Uint8Array(C)}else if(f.data.byteArray)g=f.data.byteArray;else throw new Error("no data available!");s()||h.enqueue(g)}),this.addEventListener("dataavailable",r)},cancel:()=>{l()}}),this.addEventListener("stop",l),this.addEventListener("error",u)}}function C2(){return nm}const S2=1e3,T2=1e4;class U1 extends me{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(e,t,s),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Xf(()=>j(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>j(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(_e.Ended,this)},this.reacquireTrack=!1,this.providedByUser=a,this.muteLock=new Xn,this.pauseUpstreamLock=new Xn,this.trackChangeLock=new Xn,this.trackChangeLock.lock().then(l=>j(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{l()}})),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==me.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return j(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(s=>{Us(this._mediaStreamTrack,s)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let a;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Ms(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),a=this.processor.processedTrack}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(a??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(s=>{Ms(a??e,s)}))})}waitForDimensions(){return j(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:S2;return function*(){var r;if(e.kind===me.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=hr())===null||r===void 0?void 0:r.os)==="iOS"&&(yield Qn(10));const a=Date.now();for(;Date.now()-a<t;){const s=e.dimensions;if(s)return s;yield Qn(50)}throw new ta("unable to get track dimensions after timeout")}()})}setDeviceId(e){return j(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Fa(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Fa(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return j(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===me.Source.ScreenShare)return;const{deviceId:r,groupId:a}=e._mediaStreamTrack.getSettings(),s=e.kind===me.Kind.Audio?"audioinput":"videoinput";return t?vn.getInstance().normalizeDeviceId(s,r,a):r}()})}mute(){return j(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return j(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return j(this,void 0,void 0,function*(){const r=yield this.trackChangeLock.lock();try{if(!this.sender)throw new ta("unable to replace an unpublished track");let a,s;return typeof t=="boolean"?a=t:t!==void 0&&(a=t.userProvidedTrack,s=t.stopProcessor),this.providedByUser=a??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),s&&this.processor&&(yield this.internalStopProcessor()),this}finally{r()}})}restart(e){return j(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:a}=e,s=YT(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const l={audio:!1,video:!1};this.kind===me.Kind.Video?l.video=r||a?{deviceId:r,facingMode:a}:!0:l.audio=r?Object.assign({deviceId:r},s):!0,this.attachedElements.forEach(h=>{Us(this.mediaStreamTrack,h)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const u=(yield navigator.mediaDevices.getUserMedia(l)).getTracks()[0];return this.kind===me.Kind.Video&&(yield u.applyConstraints(s)),u.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(u),this._constraints=e,this.emit(_e.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?_e.Muted:_e.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return j(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),_1()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return j(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(_e.UpstreamPaused,this);const r=hr();if((r==null?void 0:r.name)==="Safari"&&Mi(r.version,"12.0")<0)throw new Gf("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return j(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(_e.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return j(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return j(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;const l=yield r.trackChangeLock.lock();try{r.log.debug("setting up processor",r.logContext);const u=document.createElement(r.kind),h={kind:r.kind,track:r._mediaStreamTrack,element:u,audioContext:r.audioContext};if(yield t.init(h),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.internalStopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Ms(r._mediaStreamTrack,u),u.muted=!0,u.play().catch(f=>{f instanceof DOMException&&f.name==="AbortError"?(r.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},r.logContext),{error:f})),setTimeout(()=>{u.play().catch(g=>{r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{err:g}))})},100)):r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:f}))}),r.processor=t,r.processorElement=u,r.processor.processedTrack){for(const f of r.attachedElements)f!==r.processorElement&&a&&(Us(r._mediaStreamTrack,f),Ms(r.processor.processedTrack,f));yield(s=r.sender)===null||s===void 0?void 0:s.replaceTrack(r.processor.processedTrack)}r.emit(_e.TrackProcessorUpdate,r.processor)}finally{l()}}()})}getProcessor(){return this.processor}stopProcessor(){return j(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{r()}}()})}internalStopProcessor(){return j(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,a;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,t||((a=e.processorElement)===null||a===void 0||a.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(_e.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!C2()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let t="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(t)||(t="video/mp4"),this.localTrackRecorder=new k2(this,{mimeType:t})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},T2)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class vd extends U1{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,me.Kind.Audio,t,r,s),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>j(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(u){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:u}));return}l&&this.prevStats&&(this._currentBitrate=Ld(l,this.prevStats)),this.prevStats=l}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(_e.AudioTrackFeatureUpdate,this,gn.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(_e.AudioTrackFeatureUpdate,this,gn.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=a,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return j(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===me.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return j(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Fa(this._constraints.deviceId);return this.source===me.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return j(this,void 0,void 0,function*(){let t;if(e){const r=Kf({audio:e});typeof r.audio!="boolean"&&(t=r.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return j(this,void 0,void 0,function*(){const r=yield t.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){dr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},tm)))}setProcessor(e){return j(this,void 0,void 0,function*(){var t;const r=yield this.trackChangeLock.lock();try{if(!Ii()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const a={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(a),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(_e.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return j(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let r;return t.forEach(a=>{a.type==="outbound-rtp"&&(r={type:"audio",streamId:a.id,packetsSent:a.packetsSent,packetsLost:a.packetsLost,bytesSent:a.bytesSent,timestamp:a.timestamp,roundTripTime:a.roundTripTime,jitter:a.jitter})}),r})}checkForSilence(){return j(this,void 0,void 0,function*(){const e=yield M1(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(_e.AudioSilenceDetected)),e})}}function x2(n,e,t){switch(n.kind){case"audio":return new vd(n,e,!1,void 0,t);case"video":return new bd(n,e,!1,t);default:throw new ta("unsupported track type: ".concat(n.kind))}}const E2=Object.values(pc),_2=Object.values(Yp),P2=Object.values($f),R2=[pc.h180,pc.h360],I2=[Yp.h180,Yp.h360],M2=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(e=>{var t,r;return new Pt(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*(((t=n.encoding.maxFramerate)!==null&&t!==void 0?t:30)/((r=e.fps)!==null&&r!==void 0?r:30))))),e.fps,n.encoding.priority)}),sf=["q","h","f"];function lf(n,e,t,r){var a,s;let l=r==null?void 0:r.videoEncoding;n&&(l=r==null?void 0:r.screenShareEncoding);const u=r==null?void 0:r.simulcast,h=r==null?void 0:r.scalabilityMode,f=r==null?void 0:r.videoCodec;if(!l&&!u&&!h||!e||!t)return[{}];l||(l=A2(n,e,t,f),ct.debug("using video encoding",l));const g=l.maxFramerate,C=new Pt(e,t,l.maxBitrate,l.maxFramerate,l.priority);if(h&&_i(f)){const V=new B1(h),A=[];if(V.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(h));const W=hr();if(fc()||Ii()||(W==null?void 0:W.name)==="Chrome"&&Mi(W==null?void 0:W.version,"113")<0){const U=V.suffix=="h"?2:3,G=Ix(W);for(let F=0;F<V.spatial;F+=1)A.push({rid:sf[2-F],maxBitrate:l.maxBitrate/Math.pow(U,F),maxFramerate:C.encoding.maxFramerate,scaleResolutionDownBy:G?Math.pow(2,F):void 0});A[0].scalabilityMode=h}else A.push({maxBitrate:l.maxBitrate,maxFramerate:C.encoding.maxFramerate,scalabilityMode:h});return C.encoding.priority&&(A[0].priority=C.encoding.priority,A[0].networkPriority=C.encoding.priority),ct.debug("using svc encoding",{encodings:A}),A}if(!u)return[l];let x=[];n?x=(a=Bb(r==null?void 0:r.screenShareSimulcastLayers))!==null&&a!==void 0?a:Ub(n,C):x=(s=Bb(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:Ub(n,C);let T;if(x.length>0){const V=x[0];x.length>1&&([,T]=x);const A=Math.max(e,t);if(A>=960&&T)return wp(e,t,[V,T,C],g);if(A>=480)return wp(e,t,[V,C],g)}return wp(e,t,[C])}function O2(n,e,t){var r,a,s,l;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&ct.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const u=n.mediaStreamTrack.getSettings(),h=(r=u.width)!==null&&r!==void 0?r:(a=n.dimensions)===null||a===void 0?void 0:a.width,f=(s=u.height)!==null&&s!==void 0?s:(l=n.dimensions)===null||l===void 0?void 0:l.height;return n.source===me.Source.ScreenShare&&t.simulcast&&(t.simulcast=!1),lf(n.source===me.Source.ScreenShare,h,f,t)}function A2(n,e,t,r){const a=L2(n,e,t);let{encoding:s}=a[0];const l=Math.max(e,t);for(let u=0;u<a.length;u+=1){const h=a[u];if(s=h.encoding,h.width>=l)break}if(r)switch(r){case"av1":case"h265":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function L2(n,e,t){if(n)return P2;const r=e>t?e/t:t/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?E2:_2}function Ub(n,e){if(n)return M2(e);const{width:t,height:r}=e,a=t>r?t/r:r/t;return Math.abs(a-16/9)<Math.abs(a-4/3)?R2:I2}function wp(n,e,t,r){const a=[];if(t.forEach((s,l)=>{if(l>=sf.length)return;const u=Math.min(n,e),h={rid:sf[l],scaleResolutionDownBy:Math.max(1,u/Math.min(s.width,s.height)),maxBitrate:s.encoding.maxBitrate},f=r&&s.encoding.maxFramerate?Math.min(r,s.encoding.maxFramerate):s.encoding.maxFramerate;f&&(h.maxFramerate=f);const g=Lo()||l===0;s.encoding.priority&&g&&(h.priority=s.encoding.priority,h.networkPriority=s.encoding.priority),a.push(h)}),Ii()&&R1()==="ios"){let s;a.forEach(u=>{s?u.maxFramerate&&u.maxFramerate>s&&(s=u.maxFramerate):s=u.maxFramerate});let l=!0;a.forEach(u=>{var h;u.maxFramerate!=s&&(l&&(l=!1,ct.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),ct.info('Setting framerate of encoding "'.concat((h=u.rid)!==null&&h!==void 0?h:"",'" to ').concat(s)),u.maxFramerate=s)})}return a}function Bb(n){if(n)return n.sort((e,t)=>{const{encoding:r}=e,{encoding:a}=t;return r.maxBitrate>a.maxBitrate?1:r.maxBitrate<a.maxBitrate?-1:r.maxBitrate===a.maxBitrate&&r.maxFramerate&&a.maxFramerate?r.maxFramerate>a.maxFramerate?1:-1:0})}class B1{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function N2(n){return n.source===me.Source.ScreenShare||n.constraints.height&&Fa(n.constraints.height)>=1080?"maintain-resolution":"balanced"}const j2=5e3;class bd extends U1{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3?arguments[3]:void 0;super(e,me.Kind.Video,t,r,a),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>j(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(h){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:h}));return}const l=new Map(s.map(h=>[h.rid,h])),u=s.some(h=>h.qualityLimitationReason==="cpu");if(u!==this.isCpuConstrained&&(this.isCpuConstrained=u,this.isCpuConstrained&&this.emit(_e.CpuConstrained)),this.prevStats){let h=0;l.forEach((f,g)=>{var C;const x=(C=this.prevStats)===null||C===void 0?void 0:C.get(g);h+=Ld(f,x)}),this._currentBitrate=h}this.prevStats=l}),this.senderLock=new Xn}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!dr())return;const r=(t=this.sender)===null||t===void 0?void 0:t.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},tm))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return j(this,void 0,void 0,function*(){var t,r,a,s,l;yield e.pauseUpstream.call(this);try{for(var u=!0,h=ea(this.simulcastCodecs.values()),f;f=yield h.next(),t=f.done,!t;u=!0)s=f.value,u=!1,yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(null)}catch(g){r={error:g}}finally{try{!u&&!t&&(a=h.return)&&(yield a.call(h))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return j(this,void 0,void 0,function*(){var t,r,a,s,l;yield e.resumeUpstream.call(this);try{for(var u=!0,h=ea(this.simulcastCodecs.values()),f;f=yield h.next(),t=f.done,!t;u=!0){s=f.value,u=!1;const g=s;yield(l=g.sender)===null||l===void 0?void 0:l.replaceTrack(g.mediaStreamTrack)}}catch(g){r={error:g}}finally{try{!u&&!t&&(a=h.return)&&(yield a.call(h))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return j(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===me.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return j(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source===me.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return j(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],r=yield this.sender.getStats();return r.forEach(a=>{var s;if(a.type==="outbound-rtp"){const l={type:"video",streamId:a.id,frameHeight:a.frameHeight,frameWidth:a.frameWidth,framesPerSecond:a.framesPerSecond,framesSent:a.framesSent,firCount:a.firCount,pliCount:a.pliCount,nackCount:a.nackCount,packetsSent:a.packetsSent,bytesSent:a.bytesSent,qualityLimitationReason:a.qualityLimitationReason,qualityLimitationDurations:a.qualityLimitationDurations,qualityLimitationResolutionChanges:a.qualityLimitationResolutionChanges,rid:(s=a.rid)!==null&&s!==void 0?s:a.id,retransmittedPacketsSent:a.retransmittedPacketsSent,targetBitrate:a.targetBitrate,timestamp:a.timestamp},u=r.get(a.remoteId);u&&(l.jitter=u.jitter,l.packetsLost=u.packetsLost,l.roundTripTime=u.roundTripTime),t.push(l)}}),t.sort((a,s)=>{var l,u;return((l=s.frameWidth)!==null&&l!==void 0?l:0)-((u=a.frameWidth)!==null&&u!==void 0?u:0)}),t})}setPublishingQuality(e){const t=[];for(let r=Cr.LOW;r<=Cr.HIGH;r+=1)t.push(new Hf({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(_i(this.codec),t)}restartTrack(e){return j(this,void 0,void 0,function*(){var t,r,a,s,l;let u;if(e){const C=Kf({video:e});typeof C.video!="boolean"&&(u=C.video)}yield this.restart(u),this.isCpuConstrained=!1;try{for(var h=!0,f=ea(this.simulcastCodecs.values()),g;g=yield f.next(),t=g.done,!t;h=!0){s=g.value,h=!1;const C=s;C.sender&&((l=C.sender.transport)===null||l===void 0?void 0:l.state)!=="closed"&&(C.mediaStreamTrack=this.mediaStreamTrack.clone(),yield C.sender.replaceTrack(C.mediaStreamTrack))}}catch(C){r={error:C}}finally{try{!h&&!t&&(a=f.return)&&(yield a.call(f))}finally{if(r)throw r.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return j(this,arguments,void 0,function(r){var a=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l,u,h,f,g,C;if(yield t.setProcessor.call(a,r,s),!((g=a.processor)===null||g===void 0)&&g.processedTrack)try{for(var x=!0,T=ea(a.simulcastCodecs.values()),V;V=yield T.next(),l=V.done,!l;x=!0)f=V.value,x=!1,yield(C=f.sender)===null||C===void 0?void 0:C.replaceTrack(a.processor.processedTrack)}catch(A){u={error:A}}finally{try{!x&&!l&&(h=T.return)&&(yield h.call(T))}finally{if(u)throw u.error}}}()})}setDegradationPreference(e){return j(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(t){this.log.warn("failed to set degradationPreference",Object.assign({error:t},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,t){const r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},j2))}setPublishingCodecs(e){return j(this,void 0,void 0,function*(){var t,r,a,s,l,u,h;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(_i(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const f=[];try{for(t=!0,r=ea(e);a=yield r.next(),s=a.done,!s;t=!0){h=a.value,t=!1;const g=h;if(!this.codec||this.codec===g.codec)yield this.setPublishingLayers(_i(g.codec),g.qualities);else{const C=this.simulcastCodecs.get(g.codec);if(this.log.debug("try setPublishingCodec for ".concat(g.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:C})),!C||!C.sender){for(const x of g.qualities)if(x.enabled){f.push(g.codec);break}}else C.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(g.codec),this.logContext),yield Vb(C.sender,C.encodings,g.qualities,this.senderLock,_i(g.codec),this.log,this.logContext))}}}catch(g){l={error:g}}finally{try{!t&&!s&&(u=r.return)&&(yield u.call(r))}finally{if(l)throw l.error}}return f})}setPublishingLayers(e,t){return j(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),!(!this.sender||!this.encodings)&&(yield Vb(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return j(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const t=this.sender.getParameters();t.encodings=t.encodings.map((r,a)=>{var s;return Object.assign(Object.assign({},r),{active:a===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((s=this.mediaStreamTrack.getSettings().height)!==null&&s!==void 0?s:360)/360)),scalabilityMode:a===0&&_i(this.codec)?"L1T3":void 0,maxFramerate:a===0?15:0,maxBitrate:a===0?r.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:t.encodings})),this.encodings=t.encodings,yield this.sender.setParameters(t)}catch(t){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:t})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return j(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),_1()&&this.isInBackground&&this.source===me.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function Vb(n,e,t,r,a,s,l){return j(this,void 0,void 0,function*(){const u=yield r.lock();s.debug("setPublishingLayersForSender",Object.assign(Object.assign({},l),{sender:n,qualities:t,senderEncodings:e}));try{const h=n.getParameters(),{encodings:f}=h;if(!f)return;if(f.length!==e.length){s.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},l),{encodings:f,senderEncodings:e}));return}let g=!1;a&&t.some(C=>C.enabled)&&t.forEach(C=>C.enabled=!0),f.forEach((C,x)=>{var T;let V=(T=C.rid)!==null&&T!==void 0?T:"";V===""&&(V="q");const A=V1(V),W=t.find(U=>U.quality===A);W&&C.active!==W.enabled&&(g=!0,C.active=W.enabled,s.debug("setting layer ".concat(W.quality," to ").concat(C.active?"enabled":"disabled"),l),Lo()&&(W.enabled?(C.scaleResolutionDownBy=e[x].scaleResolutionDownBy,C.maxBitrate=e[x].maxBitrate,C.maxFrameRate=e[x].maxFrameRate):(C.scaleResolutionDownBy=4,C.maxBitrate=10,C.maxFrameRate=2)))}),g&&(h.encodings=f,s.debug("setting encodings",Object.assign(Object.assign({},l),{encodings:h.encodings})),yield n.setParameters(h))}finally{u()}})}function V1(n){switch(n){case"f":return Cr.HIGH;case"h":return Cr.MEDIUM;case"q":return Cr.LOW;default:return Cr.HIGH}}function Hb(n,e,t,r){if(!t)return[new ja({quality:Cr.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(r){const a=t[0].scalabilityMode,s=new B1(a),l=[],u=s.suffix=="h"?1.5:2,h=s.suffix=="h"?2:3;for(let f=0;f<s.spatial;f+=1)l.push(new ja({quality:Math.min(Cr.HIGH,s.spatial-1)-f,width:Math.ceil(n/Math.pow(u,f)),height:Math.ceil(e/Math.pow(u,f)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(h,f)):0,ssrc:0}));return l}return t.map(a=>{var s,l,u;const h=(s=a.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let f=V1((l=a.rid)!==null&&l!==void 0?l:"");return new ja({quality:f,width:Math.ceil(n/h),height:Math.ceil(e/h),bitrate:(u=a.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0})})}const qb="_lossy",Wb="_reliable",D2=2*1e3,kp="leave-reconnect",F2=3e4;var Fr;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(Fr||(Fr={}));class U2 extends Oi.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Zf.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Fr.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=ct,this.reliableDataSequence=1,this.reliableMessageBuffer=new Rb,this.reliableReceivedState=new l2(F2),this.midToTrackId={},this.handleDataChannel=r=>j(this,[r],void 0,function(a){var s=this;let{channel:l}=a;return function*(){if(l){if(l.label===Wb)s.reliableDCSub=l;else if(l.label===qb)s.lossyDCSub=l;else return;s.log.debug("on data channel ".concat(l.id,", ").concat(l.label),s.logContext),l.onmessage=s.handleDataMessage}}()}),this.handleDataMessage=r=>j(this,void 0,void 0,function*(){var a,s,l,u,h;const f=yield this.dataProcessLock.lock();try{let g;if(r.data instanceof ArrayBuffer)g=r.data;else if(r.data instanceof Blob)g=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const C=Jn.fromBinary(new Uint8Array(g));if(C.sequence>0&&C.participantSid!==""){const x=this.reliableReceivedState.get(C.participantSid);if(x&&C.sequence<=x)return;this.reliableReceivedState.set(C.participantSid,C.sequence)}if(((a=C.value)===null||a===void 0?void 0:a.case)==="speaker")this.emit(Ae.ActiveSpeakersUpdate,C.value.value.speakers);else if(((s=C.value)===null||s===void 0?void 0:s.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const x=yield(l=this.e2eeManager)===null||l===void 0?void 0:l.handleEncryptedData(C.value.value.encryptedValue,C.value.value.iv,C.participantIdentity,C.value.value.keyIndex),T=E0.fromBinary(x.payload),V=new Jn({value:T.value,participantIdentity:C.participantIdentity,participantSid:C.participantSid});((u=V.value)===null||u===void 0?void 0:u.case)==="user"&&zb(V,V.value.value),this.emit(Ae.DataPacketReceived,V,C.value.value.encryptionType)}else((h=C.value)===null||h===void 0?void 0:h.case)==="user"&&zb(C,C.value.value),this.emit(Ae.DataPacketReceived,C,dn.NONE)}finally{f()}}),this.handleDataError=r=>{const a=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(a,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(a),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const a=r.currentTarget.maxRetransmits===0?lt.LOSSY:lt.RELIABLE;this.updateAndEmitDCBufferStatus(a)},this.handleDisconnect=(r,a)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=h=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(h,"ms. giving up"),this.logContext),this.emit(Ae.Disconnected),this.close()},l=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:l,retryCount:this.reconnectAttempts});if(u===null){s(l);return}r===kp&&(u=0),this.log.debug("reconnecting in ".concat(u,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=_n.setTimeout(()=>this.attemptReconnect(a).finally(()=>this.reconnectTimeout=void 0),u)},this.waitForRestarted=()=>new Promise((r,a)=>{this.pcState===Fr.Connected&&r();const s=()=>{this.off(Ae.Disconnected,l),r()},l=()=>{this.off(Ae.Restarted,s),a()};this.once(Ae.Restarted,s),this.once(Ae.Disconnected,l)}),this.updateAndEmitDCBufferStatus=r=>{const a=this.isBufferStatusLow(r);typeof a<"u"&&a!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,a),this.emit(Ae.DCBufferStatusChanged,a,r))},this.isBufferStatusLow=r=>{const a=this.dataChannelForKind(r);if(a)return r===lt.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(a.bufferedAmount),a.bufferedAmount<=a.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===qt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(_o.RR_SIGNAL_DISCONNECTED))},this.log=ia((t=e.loggerName)!==null&&t!==void 0?t:ui.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Jf(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new Xn,this.dataProcessLock=new Xn,this.dcBufferStatus=new Map([[lt.LOSSY,!0],[lt.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Ae.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Ae.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Ae.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Ae.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Ae.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Ae.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Ae.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(Ae.SignalRequestResponse,r)}get logContext(){var e,t,r,a,s,l;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomID:(a=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||a===void 0?void 0:a.sid,participant:(l=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||l===void 0?void 0:l.identity,pID:this.participantSid}}join(e,t,r,a){return j(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,t,r,a);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),(!this.subscriberPrimary||s.fastPublish)&&this.negotiate().catch(l=>{ct.error(l,this.logContext)}),this.registerOnLineListener(),this.clientConfiguration=s.clientConfiguration,this.emit(Ae.SignalConnected,s),s}catch(s){if(s instanceof kt&&s.reason===mt.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,r,a);throw s}})}close(){return j(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(Ae.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return j(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Rb,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return j(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ta("a track with the same ID has already been published");return new Promise((t,r)=>{const a=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new kt("publication of local track timed out, no response from server",mt.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(a),t(s)},reject:()=>{clearTimeout(a),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return j(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return j(this,void 0,void 0,function*(){var t,r;if(this.pcManager&&this.pcManager.currentState!==$t.NEW)return;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid;const a=this.makeRTCConfiguration(e);this.pcManager=new v2(a,this.options.singlePeerConnection?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(Ae.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(s,l)=>{this.client.sendIceCandidate(s,l)},this.pcManager.onPublisherOffer=(s,l)=>{this.client.sendOffer(s,l)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(s,l,u)=>j(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(s),this.logContext),["closed","disconnected","failed"].includes(l)&&(this.publisherConnectionPromise=void 0),s===$t.CONNECTED){const g=this.pcState===Fr.New;this.pcState=Fr.Connected,g&&this.emit(Ae.Connected,e)}else s===$t.FAILED&&(this.pcState===Fr.Connected||this.pcState===Fr.Reconnecting)&&(this.pcState=Fr.Disconnected,this.handleDisconnect("peerconnection failed",u==="failed"?_o.RR_SUBSCRIBER_FAILED:_o.RR_PUBLISHER_FAILED));const h=this.client.isDisconnected||this.client.currentState===qt.RECONNECTING,f=[$t.FAILED,$t.CLOSING,$t.CLOSED].includes(s);h&&f&&!this._isClosed&&this.emit(Ae.Offline)}),this.pcManager.onTrack=s=>{s.streams.length!==0&&this.emit(Ae.MediaTrackAdded,s.track,s.streams[0],s.receiver)},B2((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t,r)=>j(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:r})),this.midToTrackId=r,yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t,r)=>j(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;this.midToTrackId=r;const a=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);a&&this.client.sendAnswer(a,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Ae.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Ae.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Ae.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Ae.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(Ae.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var t,r;const a={direction:"recvonly"};for(let s=0;s<e.numAudios;s++)(t=this.pcManager)===null||t===void 0||t.addPublisherTransceiverOfKind("audio",a);for(let s=0;s<e.numVideos;s++)(r=this.pcManager)===null||r===void 0||r.addPublisherTransceiverOfKind("video",a);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",_o.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:D1,regionSettings:e.regions})),e.action){case Ds.DISCONNECT:this.emit(Ae.Disconnected,e==null?void 0:e.reason),this.close();break;case Ds.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(kp);break;case Ds.RESUME:this.handleDisconnect(kp)}}}makeRTCConfiguration(e){var t;const r=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const a=[];e.iceServers.forEach(s=>{const l={urls:s.urls};s.username&&(l.username=s.username),s.credential&&(l.credential=s.credential),a.push(l)}),r.iceServers=a}return e.clientConfiguration&&e.clientConfiguration.forceRelay===uc.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(qb,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Wb,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,r){return j(this,void 0,void 0,function*(){if(Xp())return yield this.createTransceiverRTCRtpSender(e,t,r);if(Qp())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new ln("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,r,a){return j(this,void 0,void 0,function*(){if(Xp())return this.createSimulcastTransceiverSender(e,t,r,a);if(Qp())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new ln("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,r){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("publisher is closed");const a=[];e.mediaStream&&a.push(e.mediaStream),Va(e)&&(e.codec=t.videoCodec);const s={direction:"sendonly",streams:a};return r&&(s.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s)).sender})}createSimulcastTransceiverSender(e,t,r,a){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("publisher is closed");const s={direction:"sendonly"};a&&(s.sendEncodings=a);const l=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,s);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,l.sender),l.sender})}createRTCRtpSender(e){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return j(this,void 0,void 0,function*(){var t,r,a;if(!this._isClosed){if(this.attemptingReconnect){ct.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===uc.DISABLED||((a=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&a!==void 0?a:$t.NEW)===$t.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let l=!0;s instanceof ln?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),l=!1):s instanceof _s||(this.fullReconnectOnNext=!0),l?this.handleDisconnect("reconnect",_o.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Ae.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){return j(this,void 0,void 0,function*(){var t,r,a;try{if(!this.url||!this.token)throw new ln("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Ae.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new _s;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(l){throw l instanceof kt&&l.reason===mt.NotAllowed?new ln("could not reconnect, token might be expired"):new _s}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Ae.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==qt.CONNECTED)throw new _s("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(Ae.Restarted)}catch(s){const l=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(l){yield this.restartConnection(l);return}else throw(a=this.regionUrlProvider)===null||a===void 0||a.resetAttempts(),s}})}resumeConnection(e){return j(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new ln("could not reconnect, url or token not saved");if(!this.pcManager)throw new ln("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Ae.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(a){let s="";throw a instanceof Error&&(s=a.message,this.log.error(a.message,Object.assign(Object.assign({},this.logContext),{error:a}))),a instanceof kt&&a.reason===mt.NotAllowed?new ln("could not reconnect, token might be expired"):a instanceof kt&&a.reason===mt.LeaveRequest?a:new _s(s)}if(this.emit(Ae.SignalResumed),r){const a=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(a),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=r.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==qt.CONNECTED)throw new _s("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),r!=null&&r.lastMessageSeq&&this.resendReliableMessagesForResume(r.lastMessageSeq),this.emit(Ae.Resumed)})}waitForPCInitialConnection(e,t){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return j(this,void 0,void 0,function*(){this.pcState=Fr.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Qn(D2),!this.pcManager)throw new ln("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Fr.Connected}catch(e){throw this.pcState=Fr.Disconnected,new kt("could not establish PC connection, ".concat(e.message),mt.InternalError)}})}publishRpcResponse(e,t,r,a){return j(this,void 0,void 0,function*(){const s=new Jn({destinationIdentities:[e],kind:lt.RELIABLE,value:{case:"rpcResponse",value:new Ff({requestId:t,value:a?{case:"error",value:a.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(s,lt.RELIABLE)})}publishRpcAck(e,t){return j(this,void 0,void 0,function*(){const r=new Jn({destinationIdentities:[e],kind:lt.RELIABLE,value:{case:"rpcAck",value:new Df({requestId:t})}});yield this.sendDataPacket(r,lt.RELIABLE)})}sendDataPacket(e,t){return j(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(t),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const s=dx(e);if(s){const l=yield this.e2eeManager.encryptData(s.toBinary());e.value={case:"encryptedPacket",value:new x0({encryptedValue:l.payload,iv:l.iv,keyIndex:l.keyIndex})}}}t===lt.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const r=e.toBinary(),a=this.dataChannelForKind(t);if(a){if(t===lt.RELIABLE&&this.reliableMessageBuffer.push({data:r,sequence:e.sequence}),this.attemptingReconnect)return;a.send(r)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return j(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(lt.RELIABLE);const t=this.dataChannelForKind(lt.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(r=>{t.send(r.data)})),this.updateAndEmitDCBufferStatus(lt.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((t,r)=>j(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const a=()=>r("Engine closed");for(this.once(Ae.Closing,a);!this.dcBufferStatus.get(e);)yield Qn(10);this.off(Ae.Closing,a),t()}}))}ensureDataTransportConnected(e){return j(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var s;if(!r.pcManager)throw new ln("PC manager is closed");const l=a?r.pcManager.subscriber:r.pcManager.publisher,u=a?"Subscriber":"Publisher";if(!l)throw new kt("".concat(u," connection not set"),mt.InternalError);let h=!1;!a&&!r.dataChannelForKind(t,a)&&(r.createDataChannels(),h=!0),!h&&!a&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(h=!0),h&&r.negotiate().catch(C=>{ct.error(C,r.logContext)});const f=r.dataChannelForKind(t,a);if((f==null?void 0:f.readyState)==="open")return;const g=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<g;){if(l.isICEConnected&&((s=r.dataChannelForKind(t,a))===null||s===void 0?void 0:s.readyState)==="open")return;yield Qn(50)}throw new kt("could not establish ".concat(u," connection, state: ").concat(l.getICEConnectionState()),mt.InternalError)}()})}ensurePublisherConnected(e){return j(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==$t.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return j(this,void 0,void 0,function*(){return new Promise((e,t)=>j(this,void 0,void 0,function*(){if(!this.pcManager){t(new Kp("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,a=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Ae.Closing,a),this.pcManager.publisher.once(Vs.RTPVideoPayloadTypes,s=>{const l=new Map;s.forEach(u=>{const h=u.codec.toLowerCase();Nx(h)&&l.set(u.payload,h)}),this.emit(Ae.RTPVideoMapUpdate,l)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof Kp&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",_o.RR_UNKNOWN),t(s)}finally{this.off(Ae.Closing,a)}}))})}dataChannelForKind(e,t){if(t){if(e===lt.LOSSY)return this.lossyDCSub;if(e===lt.RELIABLE)return this.reliableDCSub}else{if(e===lt.LOSSY)return this.lossyDC;if(e===lt.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var r,a,s,l;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const u=this.pcManager.publisher.getLocalDescription(),h=this.pcManager.publisher.getRemoteDescription(),f=(r=this.pcManager.subscriber)===null||r===void 0?void 0:r.getRemoteDescription(),g=(a=this.pcManager.subscriber)===null||a===void 0?void 0:a.getLocalDescription(),C=(l=(s=this.signalOpts)===null||s===void 0?void 0:s.autoSubscribe)!==null&&l!==void 0?l:!0,x=new Array,T=new Array;e.forEach(V=>{V.isDesired!==C&&x.push(V.trackSid),V.isEnabled||T.push(V.trackSid)}),this.client.sendSyncState(new qf({answer:this.options.singlePeerConnection?h?Os({sdp:h.sdp,type:h.type}):void 0:g?Os({sdp:g.sdp,type:g.type}):void 0,offer:this.options.singlePeerConnection?u?Os({sdp:u.sdp,type:u.type}):void 0:f?Os({sdp:f.sdp,type:f.type}):void 0,subscription:new Md({trackSids:x,subscribe:!C,participantTracks:[]}),publishTracks:zx(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:T,datachannelReceiveStates:this.reliableReceivedState.map((V,A)=>new z0({publisherSid:A,lastSeq:V}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(r,a)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new G0({label:r.label,id:r.id,target:a}))};return t(this.dataChannelForKind(lt.LOSSY),li.PUBLISHER),t(this.dataChannelForKind(lt.RELIABLE),li.PUBLISHER),t(this.dataChannelForKind(lt.LOSSY,!0),li.SUBSCRIBER),t(this.dataChannelForKind(lt.RELIABLE,!0),li.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&_n.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){dr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){dr()&&window.removeEventListener("online",this.handleBrowserOnLine)}getTrackIdForReceiver(e){var t;const r=(t=this.pcManager)===null||t===void 0?void 0:t.getMidForReceiver(e);if(r){const a=Object.entries(this.midToTrackId).find(s=>{let[l]=s;return l===r});if(a)return a[1]}}}class _s extends Error{}function B2(n){return n!==void 0&&n>13}function zb(n,e){const t=n.participantIdentity?n.participantIdentity:e.participantIdentity;n.participantIdentity=t,e.participantIdentity=t;const r=n.destinationIdentities.length!==0?n.destinationIdentities:e.destinationIdentities;n.destinationIdentities=r,e.destinationIdentities=r}class H1{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new Ur("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),$n.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new Ur("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),$n.LengthExceeded)}}constructor(e,t,r,a){this.reader=t,this.totalByteSize=r,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=a}}class V2 extends H1{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new Vr,r=null,a=null;if(this.signal){const l=this.signal;a=()=>{var u;(u=t.reject)===null||u===void 0||u.call(t,l.reason)},l.addEventListener("abort",a),r=l}const s=()=>{e.releaseLock(),r&&a&&r.removeEventListener("abort",a),this.signal=void 0};return{next:()=>j(this,void 0,void 0,function*(){var l,u;try{const{done:h,value:f}=yield Promise.race([e.read(),t.promise,(u=(l=this.outOfBandFailureRejectingFuture)===null||l===void 0?void 0:l.promise)!==null&&u!==void 0?u:new Promise(()=>{})]);return h?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(f),{done:!1,value:f.content})}catch(h){throw s(),h}}),return(){return j(this,void 0,void 0,function*(){return s(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return j(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,a,s,l;let u=new Set;const h=t.signal?e.withAbortSignal(t.signal):e;try{for(var f=!0,g=ea(h),C;C=yield g.next(),r=C.done,!r;f=!0){l=C.value,f=!1;const x=l;u.add(x)}}catch(x){a={error:x}}finally{try{!f&&!r&&(s=g.return)&&(yield s.call(g))}finally{if(a)throw a.error}}return Array.from(u)}()})}}class H2 extends H1{constructor(e,t,r,a){super(e,t,r,a),this.receivedChunks=new Map}handleChunkReceived(e){var t;const r=ed(e.chunkIndex),a=this.receivedChunks.get(r);if(a&&a.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let r=new Vr,a=null,s=null;if(this.signal){const u=this.signal;s=()=>{var h;(h=r.reject)===null||h===void 0||h.call(r,u.reason)},u.addEventListener("abort",s),a=u}const l=()=>{e.releaseLock(),a&&s&&a.removeEventListener("abort",s),this.signal=void 0};return{next:()=>j(this,void 0,void 0,function*(){var u,h;try{const{done:f,value:g}=yield Promise.race([e.read(),r.promise,(h=(u=this.outOfBandFailureRejectingFuture)===null||u===void 0?void 0:u.promise)!==null&&h!==void 0?h:new Promise(()=>{})]);if(f)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(g);let C;try{C=t.decode(g.content)}catch(x){throw new Ur("Cannot decode datastream chunk ".concat(g.chunkIndex," as text: ").concat(x),$n.DecodeFailed)}return{done:!1,value:C}}}catch(f){throw l(),f}}),return(){return j(this,void 0,void 0,function*(){return l(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return j(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,a,s,l;let u="";const h=t.signal?e.withAbortSignal(t.signal):e;try{for(var f=!0,g=ea(h),C;C=yield g.next(),r=C.done,!r;f=!0)l=C.value,f=!1,u+=l}catch(x){a={error:x}}finally{try{!f&&!r&&(s=g.return)&&(yield s.call(g))}finally{if(a)throw a.error}}return u}()})}}class q2{constructor(){this.log=ct,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new Ur('A text stream handler for topic "'.concat(e,'" has already been set.'),$n.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new Ur('A byte stream handler for topic "'.concat(e,'" has already been set.'),$n.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,r,a,s;const l=Array.from(this.textStreamControllers.entries()).filter(h=>h[1].sendingParticipantIdentity===e),u=Array.from(this.byteStreamControllers.entries()).filter(h=>h[1].sendingParticipantIdentity===e);if(l.length>0||u.length>0){const h=new Ur("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),$n.AbnormalEnd);for(const[f,g]of u)(r=(t=g.outOfBandFailureRejectingFuture).reject)===null||r===void 0||r.call(t,h),this.byteStreamControllers.delete(f);for(const[f,g]of l)(s=(a=g.outOfBandFailureRejectingFuture).reject)===null||s===void 0||s.call(a,h),this.textStreamControllers.delete(f)}}handleDataStreamPacket(e,t){return j(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,t);case"streamChunk":return this.handleStreamChunk(e.value.value,t);case"streamTrailer":return this.handleStreamTrailer(e.value.value,t);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t,r){return j(this,void 0,void 0,function*(){var a;if(e.contentHeader.case==="byteHeader"){const s=this.byteStreamHandlers.get(e.topic);if(!s){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let l;const u=new Vr;u.promise.catch(g=>{this.log.error(g)});const h={id:e.streamId,name:(a=e.contentHeader.value.name)!==null&&a!==void 0?a:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:ed(e.timestamp),attributes:e.attributes,encryptionType:r},f=new ReadableStream({start:g=>{if(l=g,this.textStreamControllers.has(e.streamId))throw new Ur("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),$n.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:h,controller:l,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:u})}});s(new V2(h,f,ed(e.totalLength),u),{identity:t})}else if(e.contentHeader.case==="textHeader"){const s=this.textStreamHandlers.get(e.topic);if(!s){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let l;const u=new Vr;u.promise.catch(g=>{this.log.error(g)});const h={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:r},f=new ReadableStream({start:g=>{if(l=g,this.textStreamControllers.has(e.streamId))throw new Ur("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),$n.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:h,controller:l,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:u})}});s(new H2(h,f,ed(e.totalLength),u),{identity:t})}})}handleStreamChunk(e,t){const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==t?(r.controller.error(new Ur("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(r.info.encryptionType),$n.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&r.controller.enqueue(e));const a=this.textStreamControllers.get(e.streamId);a&&(a.info.encryptionType!==t?(a.controller.error(new Ur("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(a.info.encryptionType),$n.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&a.controller.enqueue(e))}handleStreamTrailer(e,t){const r=this.textStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==t?r.controller.error(new Ur("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(r.info.encryptionType),$n.EncryptionTypeMismatch)):(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.textStreamControllers.delete(e.streamId)));const a=this.byteStreamControllers.get(e.streamId);a&&(a.info.encryptionType!==t?a.controller.error(new Ur("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(a.info.encryptionType),$n.EncryptionTypeMismatch)):(a.info.attributes=Object.assign(Object.assign({},a.info.attributes),e.attributes),a.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class q1{constructor(e,t,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return j(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class W2 extends q1{}class z2 extends q1{}const Gb=15e3;class G2{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return j(this,void 0,void 0,function*(){var r;const a=crypto.randomUUID(),s=new TextEncoder().encode(e).byteLength,l=(r=t==null?void 0:t.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),u=new Array(l?l.length+1:1).fill(0),h=(g,C)=>{var x;u[C]=g;const T=u.reduce((V,A)=>V+A,0);(x=t==null?void 0:t.onProgress)===null||x===void 0||x.call(t,T)},f=yield this.streamText({streamId:a,totalSize:s,destinationIdentities:t==null?void 0:t.destinationIdentities,topic:t==null?void 0:t.topic,attachedStreamIds:l,attributes:t==null?void 0:t.attributes});return yield f.write(e),h(1,0),yield f.close(),t!=null&&t.attachments&&l&&(yield Promise.all(t.attachments.map((g,C)=>j(this,void 0,void 0,function*(){return this._sendFile(l[C],g,{topic:t.topic,mimeType:g.type,onProgress:x=>{h(x,C+1)}})})))),f.info})}streamText(e){return j(this,void 0,void 0,function*(){var t,r,a;const s=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),l={id:s,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes,encryptionType:!((a=this.engine.e2eeManager)===null||a===void 0)&&a.isDataChannelEncryptionEnabled?dn.GCM:dn.NONE},u=new pd({streamId:s,mimeType:l.mimeType,topic:l.topic,timestamp:Po(l.timestamp),totalLength:Po(e==null?void 0:e.totalSize),attributes:l.attributes,contentHeader:{case:"textHeader",value:new D0({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?jp.UPDATE:jp.CREATE})}}),h=e==null?void 0:e.destinationIdentities,f=new Jn({destinationIdentities:h,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(f,lt.RELIABLE);let g=0;const C=this.engine,x=new WritableStream({write(A){return j(this,void 0,void 0,function*(){for(const W of Vx(A,Gb)){yield C.waitForBufferStatusLow(lt.RELIABLE);const U=new fd({content:W,streamId:s,chunkIndex:Po(g)}),G=new Jn({destinationIdentities:h,value:{case:"streamChunk",value:U}});yield C.sendDataPacket(G,lt.RELIABLE),g+=1}})},close(){return j(this,void 0,void 0,function*(){const A=new md({streamId:s}),W=new Jn({destinationIdentities:h,value:{case:"streamTrailer",value:A}});yield C.sendDataPacket(W,lt.RELIABLE)})},abort(A){console.log("Sink error:",A)}});let T=()=>j(this,void 0,void 0,function*(){yield V.close()});C.once(Ae.Closing,T);const V=new W2(x,l,()=>this.engine.off(Ae.Closing,T));return V})}sendFile(e,t){return j(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,t),{id:r}})}_sendFile(e,t,r){return j(this,void 0,void 0,function*(){var a;const s=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:(a=r==null?void 0:r.mimeType)!==null&&a!==void 0?a:t.type,topic:r==null?void 0:r.topic,destinationIdentities:r==null?void 0:r.destinationIdentities}),l=t.stream().getReader();for(;;){const{done:u,value:h}=yield l.read();if(u)break;yield s.write(h)}return yield s.close(),s.info})}streamBytes(e){return j(this,void 0,void 0,function*(){var t,r,a,s,l,u;const h=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),f=e==null?void 0:e.destinationIdentities,g={id:h,mimeType:(r=e==null?void 0:e.mimeType)!==null&&r!==void 0?r:"application/octet-stream",topic:(a=e==null?void 0:e.topic)!==null&&a!==void 0?a:"",timestamp:Date.now(),attributes:e==null?void 0:e.attributes,size:e==null?void 0:e.totalSize,name:(s=e==null?void 0:e.name)!==null&&s!==void 0?s:"unknown",encryptionType:!((l=this.engine.e2eeManager)===null||l===void 0)&&l.isDataChannelEncryptionEnabled?dn.GCM:dn.NONE},C=new pd({totalLength:Po((u=g.size)!==null&&u!==void 0?u:0),mimeType:g.mimeType,streamId:h,topic:g.topic,timestamp:Po(Date.now()),attributes:g.attributes,contentHeader:{case:"byteHeader",value:new F0({name:g.name})}}),x=new Jn({destinationIdentities:f,value:{case:"streamHeader",value:C}});yield this.engine.sendDataPacket(x,lt.RELIABLE);let T=0;const V=new Xn,A=this.engine,W=this.log,U=new WritableStream({write(G){return j(this,void 0,void 0,function*(){const F=yield V.lock();let O=0;try{for(;O<G.byteLength;){const D=G.slice(O,O+Gb);yield A.waitForBufferStatusLow(lt.RELIABLE);const Q=new Jn({destinationIdentities:f,value:{case:"streamChunk",value:new fd({content:D,streamId:h,chunkIndex:Po(T)})}});yield A.sendDataPacket(Q,lt.RELIABLE),T+=1,O+=D.byteLength}}finally{F()}})},close(){return j(this,void 0,void 0,function*(){const G=new md({streamId:h}),F=new Jn({destinationIdentities:f,value:{case:"streamTrailer",value:G}});yield A.sendDataPacket(F,lt.RELIABLE)})},abort(G){W.error("Sink error:",G)}});return new z2(U,g)})}}class W1 extends me{constructor(e,t,r,a,s){super(e,r,s),this.sid=t,this.receiver=a}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?_e.Muted:_e.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(_e.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return j(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),tm)),Gx()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(t=this.receiver)===null||t===void 0?void 0:t.getSynchronizationSources()[0];if(r){const{timestamp:a,rtpTimestamp:s}=r;s&&this.rtpTimestamp!==s&&(this.emit(_e.TimeSyncUpdate,{timestamp:a,rtpTimestamp:s}),this.rtpTimestamp=s)}};e()}}class $2 extends W1{constructor(e,t,r,a,s,l){super(e,t,me.Kind.Audio,r,l),this.monitorReceiver=()=>j(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=Ld(u,this.prevStats)),this.prevStats=u}),this.audioContext=a,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var t;for(const r of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):r.volume=e;Ii()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Ii())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return j(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Zp(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Zp(e)&&e.setSinkId(this.sinkId).catch(r=>{this.log.error("Failed to set sink id on remote audio track",r,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(a=>{r.connect(a),r=a}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(_e.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(a=>{this.emit(_e.AudioPlaybackFailed,a)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return j(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(r=>{r.type==="inbound-rtp"&&(t={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),t})}}const Cp=100;class K2 extends W1{constructor(e,t,r,a,s){super(e,t,me.Kind.Video,r,s),this.elementInfos=[],this.monitorReceiver=()=>j(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const l=yield this.getReceiverStats();l&&this.prevStats&&this.receiver&&(this._currentBitrate=Ld(l,this.prevStats)),this.prevStats=l}),this.debouncedHandleResize=Xf(()=>{this.updateDimensions()},Cp),this.adaptiveStreamSettings=a}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===me.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?Us(this._mediaStreamTrack,t):Ms(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new J2(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(r=>r===e);for(const r of t)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const r of t)this.stopObservingElement(r);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return j(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,r="",a=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,t={type:"video",streamId:s.id,framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&a.set(s.id,s)}),t&&r!==""&&a.get(r)&&(t.mimeType=a.get(r).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(r=>r.element===e);for(const r of t)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return j(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,r;const a=this.elementInfos.reduce((h,f)=>Math.max(h,f.visibilityChangedAt||0),0),s=!((r=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pauseVideoInBackground)!==null&&r!==void 0)||r?this.isInBackground:!1,l=this.elementInfos.some(h=>h.pictureInPicture),u=this.elementInfos.some(h=>h.visible)&&!s||l;if(!(this.lastVisible===u&&!e)){if(!u&&Date.now()-a<Cp){_n.setTimeout(()=>{this.updateVisibility()},Cp);return}this.lastVisible=u,this.emit(_e.VisibilityChanged,u,this)}}updateDimensions(){var e,t;let r=0,a=0;const s=this.getPixelDensity();for(const l of this.elementInfos){const u=l.width()*s,h=l.height()*s;u+h>r+a&&(r=u,a=h)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===a||(this.lastDimensions={width:r,height:a},this.emit(_e.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?kb():t||(kb()>2?2:1)}}class J2{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=r=>{var a;const{target:s,isIntersecting:l}=r;s===this.element&&(this.isIntersecting=l,this.isPiP=ql(this.element),this.visibilityChangedAt=Date.now(),(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this))},this.onEnterPiP=()=>{var r,a,s;(a=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||a===void 0||a.addEventListener("pagehide",this.onLeavePiP),this.isPiP=ql(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=ql(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=t??cf(e),this.isPiP=dr()&&ql(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,r;this.isIntersecting=cf(this.element),this.isPiP=ql(this.element),this.element.handleResize=()=>{var a;(a=this.handleResize)===null||a===void 0||a.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Sb().observe(this.element),Cb().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,r,a,s;(e=Sb())===null||e===void 0||e.unobserve(this.element),(t=Cb())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(s=(a=window.documentPictureInPicture)===null||a===void 0?void 0:a.window)===null||s===void 0||s.removeEventListener("pagehide",this.onLeavePiP)}}function ql(n){var e,t;return document.pictureInPictureElement===n?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?cf(n,(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window):!1}function cf(n,e){const t=e||window;let r=n.offsetTop,a=n.offsetLeft;const s=n.offsetWidth,l=n.offsetHeight,{hidden:u}=n,{display:h}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,r+=n.offsetTop,a+=n.offsetLeft;return r<t.pageYOffset+t.innerHeight&&a<t.pageXOffset+t.innerWidth&&r+l>t.pageYOffset&&a+s>t.pageXOffset&&!u&&h!=="none"}class Xi extends Oi.EventEmitter{constructor(e,t,r,a){var s;super(),this.metadataMuted=!1,this.encryption=dn.NONE,this.log=ct,this.handleMuted=()=>{this.emit(_e.Muted)},this.handleUnmuted=()=>{this.emit(_e.Unmuted)},this.log=ia((s=a==null?void 0:a.loggerName)!==null&&s!==void 0?s:ui.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=r,this.source=me.Source.Unknown}setTrack(e){this.track&&(this.track.off(_e.Muted,this.handleMuted),this.track.off(_e.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(_e.Muted,this.handleMuted),e.on(_e.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),pt(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==dn.NONE}get audioTrack(){if(Pi(this.track))return this.track}get videoTrack(){if(Va(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=me.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===me.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(Xi||(Xi={}));class uf extends Xi{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,r,a){super(e,t.sid,t.name,a),this.track=void 0,this.handleTrackEnded=()=>{this.emit(_e.Ended)},this.handleCpuConstrained=()=>{this.track&&Va(this.track)&&this.emit(_e.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(r)}setTrack(e){this.track&&(this.track.off(_e.Ended,this.handleTrackEnded),this.track.off(_e.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(_e.Ended,this.handleTrackEnded),e.on(_e.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return j(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return j(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return j(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return j(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Pi(this.track)){const t=this.track.getSourceTrackSettings(),r=new Set;return t.autoGainControl&&r.add(gn.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&r.add(gn.TF_ECHO_CANCELLATION),t.noiseSuppression&&r.add(gn.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&r.add(gn.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(gn.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(gn.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}function Nd(n,e){return j(this,void 0,void 0,function*(){n??(n={});let t=!1;const{audioProcessor:r,videoProcessor:a,optionsWithoutProcessor:s}=A1(n);let l=s.audio,u=s.video;if(r&&typeof s.audio=="object"&&(s.audio.processor=r),a&&typeof s.video=="object"&&(s.video.processor=a),n.audio&&typeof s.audio=="object"&&typeof s.audio.deviceId=="string"){const C=s.audio.deviceId;s.audio.deviceId={exact:C},t=!0,l=Object.assign(Object.assign({},s.audio),{deviceId:{ideal:C}})}if(s.video&&typeof s.video=="object"&&typeof s.video.deviceId=="string"){const C=s.video.deviceId;s.video.deviceId={exact:C},t=!0,u=Object.assign(Object.assign({},s.video),{deviceId:{ideal:C}})}(s.audio===!0||typeof s.audio=="object"&&!s.audio.deviceId)&&(s.audio={deviceId:"default"}),s.video===!0?s.video={deviceId:"default"}:typeof s.video=="object"&&!s.video.deviceId&&(s.video.deviceId="default");const h=I1(s,N1,j1),f=Kf(h),g=navigator.mediaDevices.getUserMedia(f);s.audio&&(vn.userMediaPromiseMap.set("audioinput",g),g.catch(()=>vn.userMediaPromiseMap.delete("audioinput"))),s.video&&(vn.userMediaPromiseMap.set("videoinput",g),g.catch(()=>vn.userMediaPromiseMap.delete("videoinput")));try{const C=yield g;return yield Promise.all(C.getTracks().map(x=>j(this,void 0,void 0,function*(){const T=x.kind==="audio";let V=T?h.audio:h.video;(typeof V=="boolean"||!V)&&(V={});let A;const W=T?f.audio:f.video;typeof W!="boolean"&&(A=W);const U=x.getSettings().deviceId;A!=null&&A.deviceId&&Fa(A.deviceId)!==U?A.deviceId=U:A||(A={deviceId:U});const G=x2(x,A,e);return G.kind===me.Kind.Video?G.source=me.Source.Camera:G.kind===me.Kind.Audio&&(G.source=me.Source.Microphone),G.mediaStream=C,Pi(G)&&r?yield G.setProcessor(r):Va(G)&&a&&(yield G.setProcessor(a)),G})))}catch(C){if(!t)throw C;return Nd(Object.assign(Object.assign({},n),{audio:l,video:u}),e)}})}function Y2(n){return j(this,void 0,void 0,function*(){return(yield Nd({audio:!1,video:!0}))[0]})}function X2(n){return j(this,void 0,void 0,function*(){return(yield Nd({audio:!0,video:!1}))[0]})}var Aa;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(Aa||(Aa={}));function Q2(n){switch(n){case Gl.EXCELLENT:return Aa.Excellent;case Gl.GOOD:return Aa.Good;case Gl.POOR:return Aa.Poor;case Gl.LOST:return Aa.Lost;default:return Aa.Unknown}}class z1 extends Oi.EventEmitter{get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===dc.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===js.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,r,a,s,l){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:dc.STANDARD;var h;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Aa.Unknown,this.log=ct,this.log=ia((h=l==null?void 0:l.loggerName)!==null&&h!==void 0?h:ui.Participant),this.loggerOptions=l,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=r,this.metadata=a,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=u,this._attributes=s??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Vr,this.once(Le.Active,()=>{var e,t;(t=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||t===void 0||t.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(me.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(me.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(me.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var t;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===js.ACTIVE&&((t=this.participantInfo)===null||t===void 0?void 0:t.state)!==js.ACTIVE&&this.emit(Le.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,r=this.metadata;this.metadata=e,t&&this.emit(Le.ParticipantMetadataChanged,r)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Le.ParticipantNameChanged,e)}_setAttributes(e){const t=$x(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Le.AttributesChanged,t)}setPermissions(e){var t,r,a,s,l,u;const h=this.permissions,f=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((a=this.permissions)===null||a===void 0?void 0:a.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((l=this.permissions)===null||l===void 0?void 0:l.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((g,C)=>{var x;return g!==((x=this.permissions)===null||x===void 0?void 0:x.canPublishSources[C])})||e.canSubscribeMetrics!==((u=this.permissions)===null||u===void 0?void 0:u.canSubscribeMetrics);return this.permissions=e,f&&this.emit(Le.ParticipantPermissionsChanged,h),f}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Le.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=Q2(e),t!==this._connectionQuality&&this.emit(Le.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&((t=(e=this.activeFuture).reject)===null||t===void 0||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>Pi(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(_e.Muted,()=>{this.emit(Le.TrackMuted,e)}),e.on(_e.Unmuted,()=>{this.emit(Le.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case me.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case me.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function Z2(n){var e,t,r;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new q0({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(r=n.allowAll)!==null&&r!==void 0?r:!1,trackSids:n.allowedTrackSids||[]})}class eE extends z1{constructor(e,t,r,a,s,l){super(e,t,void 0,void 0,void 0,{loggerName:a.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=dn.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Vr)},this.handleReconnected=()=>{var u,h;(h=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||h===void 0||h.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var u,h,f,g,C,x;this.reconnectFuture&&(this.reconnectFuture.promise.catch(T=>this.log.warn(T.message,this.logContext)),(h=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||h===void 0||h.call(u,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&((g=(f=this.signalConnectedFuture).reject)===null||g===void 0||g.call(f,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),(x=(C=this.activeAgentFuture)===null||C===void 0?void 0:C.reject)===null||x===void 0||x.call(C,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=u=>{var h,f;u.participant&&this.updateInfo(u.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Vr),(f=(h=this.signalConnectedFuture).resolve)===null||f===void 0||f.call(h)},this.handleSignalRequestResponse=u=>{const{requestId:h,reason:f,message:g}=u,C=this.pendingSignalRequests.get(h);C&&(f!==Wf.OK&&C.reject(new gb(g,f)),this.pendingSignalRequests.delete(h))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let h=u.value.value,f=null,g=null;h.value.case==="payload"?f=h.value.value:h.value.case==="error"&&(g=Jt.fromProto(h.value.value)),this.handleIncomingRpcResponse(h.requestId,f,g);break;case"rpcAck":let C=u.value.value;this.handleIncomingRpcAck(C.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>Z2(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,h)=>{if(h===void 0&&(h=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),pt(u)));return}this.engine.updateMuteStatus(u.sid,h)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),pt(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),pt(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const h=this.audioTrackPublications.get(u.sid);if(!h){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(h.trackSid,h.getTrackFeatures())},this.onTrackCpuConstrained=(u,h)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),pt(h))),this.emit(Le.LocalTrackCpuConstrained,u,h)},this.handleSubscribedQualityUpdate=u=>j(this,void 0,void 0,function*(){var h,f,g,C,x;if(!(!((x=this.roomOptions)===null||x===void 0)&&x.dynacast))return;const T=this.videoTrackPublications.get(u.trackSid);if(!T){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(!T.videoTrack)return;const V=yield T.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var A=!0,W=ea(V),U;U=yield W.next(),h=U.done,!h;A=!0){C=U.value,A=!1;const G=C;Sx(G)&&(this.log.debug("publish ".concat(G," for ").concat(T.videoTrack.sid),Object.assign(Object.assign({},this.logContext),pt(T))),yield this.publishAdditionalCodecForTrack(T.videoTrack,G,T.options))}}catch(G){f={error:G}}finally{try{!A&&!h&&(g=W.return)&&(yield g.call(W))}finally{if(f)throw f.error}}}),this.handleLocalTrackUnpublished=u=>{const h=this.trackPublications.get(u.trackSid);if(!h){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(h.track)},this.handleTrackEnded=u=>j(this,void 0,void 0,function*(){if(u.source===me.Source.ScreenShare||u.source===me.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),pt(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(Yi(u)||Ia(u))try{if(dr())try{const h=yield navigator==null?void 0:navigator.permissions.query({name:u.source===me.Source.Camera?"camera":"microphone"});if(h&&h.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),pt(u))),h.onchange=()=>{h.state!=="denied"&&(u.isMuted||u.restartTrack(),h.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),pt(u))),Yi(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),pt(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=a,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=s,this.roomOutgoingDataStreamManager=l}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==dn.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(Ae.RemoteMute,(r,a)=>{const s=this.trackPublications.get(r);!s||!s.track||(a?s.mute():s.unmute())}),!((t=this.signalConnectedFuture)===null||t===void 0)&&t.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(Ae.Connected,this.handleReconnected).on(Ae.SignalConnected,this.handleSignalConnected).on(Ae.SignalRestarted,this.handleReconnected).on(Ae.SignalResumed,this.handleReconnected).on(Ae.Restarting,this.handleReconnecting).on(Ae.Resuming,this.handleReconnecting).on(Ae.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Ae.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Ae.Closing,this.handleClosing).on(Ae.SignalRequestResponse,this.handleSignalRequestResponse).on(Ae.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return j(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return j(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return j(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return j(this,arguments,void 0,function(t){var r=this;let{metadata:a,name:s,attributes:l}=t;return function*(){return new Promise((u,h)=>j(r,void 0,void 0,function*(){var f,g;try{let C=!1;const x=yield this.engine.client.sendUpdateLocalMetadata((f=a??this.metadata)!==null&&f!==void 0?f:"",(g=s??this.name)!==null&&g!==void 0?g:"",l),T=performance.now();for(this.pendingSignalRequests.set(x,{resolve:u,reject:V=>{h(V),C=!0},values:{name:s,metadata:a,attributes:l}});performance.now()-T<5e3&&!C;){if((!s||this.name===s)&&(!a||this.metadata===a)&&(!l||Object.entries(l).every(V=>{let[A,W]=V;return this.attributes[A]===W||W===""&&!this.attributes[A]}))){this.pendingSignalRequests.delete(x),u();return}yield Qn(50)}h(new gb("Request to update local metadata timed out","TimeoutError"))}catch(C){C instanceof Error&&h(C)}}))}()})}setCameraEnabled(e,t,r){return this.setTrackEnabled(me.Source.Camera,e,t,r)}setMicrophoneEnabled(e,t,r){return this.setTrackEnabled(me.Source.Microphone,e,t,r)}setScreenShareEnabled(e,t,r){return this.setTrackEnabled(me.Source.ScreenShare,e,t,r)}setE2EEEnabled(e){return j(this,void 0,void 0,function*(){this.encryptionType=e?dn.GCM:dn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,r,a){return j(this,void 0,void 0,function*(){var s,l;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let u=this.getTrackPublication(e);if(t)if(u)yield u.unmute();else{let h;if(this.pendingPublishing.has(e)){const f=yield this.waitForPendingPublicationOfSource(e);return f||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield f==null?void 0:f.unmute(),f}this.pendingPublishing.add(e);try{switch(e){case me.Source.Camera:h=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case me.Source.Microphone:h=yield this.createTracks({audio:(l=r)!==null&&l!==void 0?l:!0});break;case me.Source.ScreenShare:h=yield this.createScreenTracks(Object.assign({},r));break;default:throw new ta(e)}}catch(f){throw h==null||h.forEach(g=>{g.stop()}),f instanceof Error&&this.emit(Le.MediaDevicesError,f,af(e)),this.pendingPublishing.delete(e),f}for(const f of h){const g=Object.assign(Object.assign({},this.roomOptions.publishDefaults),r);e===me.Source.Microphone&&Pi(f)&&g.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),f.startPreConnectBuffer())}try{const f=[];for(const g of h)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),pt(g))),f.push(this.publishTrack(g,a));[u]=yield Promise.all(f)}catch(f){throw h==null||h.forEach(g=>{g.stop()}),f}finally{this.pendingPublishing.delete(e)}}else if(!(u!=null&&u.track)&&this.pendingPublishing.has(e)&&(u=yield this.waitForPendingPublicationOfSource(e),u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),u&&u.track)if(e===me.Source.ScreenShare){u=yield this.unpublishTrack(u.track);const h=this.getTrackPublication(me.Source.ScreenShareAudio);h&&h.track&&this.unpublishTrack(h.track)}else yield u.mute();return u})}enableCameraAndMicrophone(){return j(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(me.Source.Camera)||this.pendingPublishing.has(me.Source.Microphone))){this.pendingPublishing.add(me.Source.Camera),this.pendingPublishing.add(me.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(me.Source.Camera),this.pendingPublishing.delete(me.Source.Microphone)}}})}createTracks(e){return j(this,void 0,void 0,function*(){var t,r;e??(e={});const a=I1(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults);try{return(yield Nd(a,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(s=>(Pi(s)&&(this.microphoneError=void 0,s.setAudioContext(this.audioContext),s.source=me.Source.Microphone,this.emit(Le.AudioStreamAcquired)),Va(s)&&(this.cameraError=void 0,s.source=me.Source.Camera),s))}catch(s){throw s instanceof Error&&(e.audio&&(this.microphoneError=s),e.video&&(this.cameraError=s)),s}})}createScreenTracks(e){return j(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Gf("getDisplayMedia not supported");e.resolution===void 0&&!Rx()&&(e.resolution=$f.h1080fps30.resolution);const t=Wx(e),r=yield navigator.mediaDevices.getDisplayMedia(t),a=r.getVideoTracks();if(a.length===0)throw new ta("no video track found");const s=new bd(a[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=me.Source.ScreenShare,e.contentHint&&(s.mediaStreamTrack.contentHint=e.contentHint);const l=[s];if(r.getAudioTracks().length>0){this.emit(Le.AudioStreamAcquired);const u=new vd(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});u.source=me.Source.ScreenShareAudio,l.push(u)}return l})}publishTrack(e,t){return j(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return j(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var u,h,f,g;Yi(r)&&r.setAudioContext(s.audioContext),yield(u=s.reconnectFuture)===null||u===void 0?void 0:u.promise,s.republishPromise&&!l&&(yield s.republishPromise),Bs(r)&&s.pendingPublishPromises.has(r)&&(yield s.pendingPublishPromises.get(r));let C;if(r instanceof MediaStreamTrack)C=r.getConstraints();else{C=r.constraints;let U;switch(r.source){case me.Source.Microphone:U="audioinput";break;case me.Source.Camera:U="videoinput"}U&&s.activeDeviceMap.has(U)&&(C=Object.assign(Object.assign({},C),{deviceId:s.activeDeviceMap.get(U)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new vd(r,C,!0,s.audioContext,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;case"video":r=new bd(r,C,!0,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;default:throw new ta("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});let x;if(s.trackPublications.forEach(U=>{U.track&&U.track===r&&(x=U)}),x)return s.log.warn("track has already been published, skipping",Object.assign(Object.assign({},s.logContext),pt(x))),x;const T=Object.assign(Object.assign({},s.roomOptions.publishDefaults),a),V="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,A=(h=T.forceStereo)!==null&&h!==void 0?h:V;A&&(T.dtx===void 0&&s.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},s.logContext),pt(r))),T.red===void 0&&s.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(f=T.dtx)!==null&&f!==void 0||(T.dtx=!1),(g=T.red)!==null&&g!==void 0||(T.red=!1)),!Mx()&&s.roomOptions.e2ee&&(s.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},s.logContext)),T.simulcast=!1),T.source&&(r.source=T.source);const W=new Promise((U,G)=>j(s,void 0,void 0,function*(){try{if(this.engine.client.currentState!==qt.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:pt(r)}));const F=setTimeout(()=>{G(new mb("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(F);const O=yield this.publish(r,T,A);U(O)}else try{const F=yield this.publish(r,T,A);U(F)}catch(F){G(F)}}catch(F){G(F)}}));s.pendingPublishPromises.set(r,W);try{return yield W}catch(U){throw U}finally{s.pendingPublishPromises.delete(r)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Vr),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),pt(e))),!1;const{canPublish:t,canPublishSources:r}=this.permissions;return t&&(r.length===0||r.map(a=>Kx(a)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),pt(e))),!1)}publish(e,t,r){return j(this,void 0,void 0,function*(){var a,s,l,u,h,f,g,C,x,T;if(!this.hasPermissionsToPublish(e))throw new mb("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(Y=>Bs(e)&&Y.source===e.source)&&e.source!==me.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),pt(e))),t.stopMicTrackOnMute&&Pi(e)&&(e.stopOnMute=!0),e.source===me.Source.ScreenShare&&Lo()&&(t.simulcast=!1),t.videoCodec==="av1"&&!Ex()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!_x()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=of),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(Y=>t.videoCodec===Zl(Y.mime))||(t.videoCodec=Zl(this.enabledPublishVideoCodecs[0].mime)));const V=t.videoCodec;e.on(_e.Muted,this.onTrackMuted),e.on(_e.Unmuted,this.onTrackUnmuted),e.on(_e.Ended,this.handleTrackEnded),e.on(_e.UpstreamPaused,this.onTrackUpstreamPaused),e.on(_e.UpstreamResumed,this.onTrackUpstreamResumed),e.on(_e.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const A=[],W=!(!((a=t.dtx)!==null&&a!==void 0)||a),U=e.getSourceTrackSettings();U.autoGainControl&&A.push(gn.TF_AUTO_GAIN_CONTROL),U.echoCancellation&&A.push(gn.TF_ECHO_CANCELLATION),U.noiseSuppression&&A.push(gn.TF_NOISE_SUPPRESSION),U.channelCount&&U.channelCount>1&&A.push(gn.TF_STEREO),W&&A.push(gn.TF_NO_DTX),Yi(e)&&e.hasPreConnectBuffer&&A.push(gn.TF_PRECONNECT_BUFFER);const G=new hc({cid:e.mediaStreamTrack.id,name:t.name,type:me.kindToProto(e.kind),muted:e.isMuted,source:me.sourceToProto(e.source),disableDtx:W,encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=t.red)!==null&&s!==void 0)||s),stream:t==null?void 0:t.stream,backupCodecPolicy:t==null?void 0:t.backupCodecPolicy,audioFeatures:A});let F;if(e.kind===me.Kind.Video){let Y={width:0,height:0};try{Y=yield e.waitForDimensions()}catch{const z=(u=(l=this.roomOptions.videoCaptureDefaults)===null||l===void 0?void 0:l.resolution)!==null&&u!==void 0?u:pc.h720.resolution;Y={width:z.width,height:z.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{dims:Y}))}G.width=Y.width,G.height=Y.height,Ia(e)&&(_i(V)&&(e.source===me.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),pt(e))))),t.scalabilityMode=(h=t.scalabilityMode)!==null&&h!==void 0?h:"L3T3_KEY"),G.simulcastCodecs=[new Fp({codec:V,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:of}),t.backupCodec&&V!==t.backupCodec.codec&&G.encryption===dn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),G.simulcastCodecs.push(new Fp({codec:t.backupCodec.codec,cid:""})))),F=lf(e.source===me.Source.ScreenShare,G.width,G.height,t),G.layers=Hb(G.width,G.height,F,_i(t.videoCodec))}else e.kind===me.Kind.Audio&&(F=[{maxBitrate:(f=t.audioPreset)===null||f===void 0?void 0:f.maxBitrate,priority:(C=(g=t.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&C!==void 0?C:"high",networkPriority:(T=(x=t.audioPreset)===null||x===void 0?void 0:x.priority)!==null&&T!==void 0?T:"high"}]);if(!this.engine||this.engine.isClosed)throw new ln("cannot publish track when not connected");const O=()=>j(this,void 0,void 0,function*(){var Y,z,K;if(!this.engine.pcManager)throw new ln("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,F),this.emit(Le.LocalSenderCreated,e.sender,e),Ia(e)&&((Y=t.degradationPreference)!==null&&Y!==void 0||(t.degradationPreference=N2(e)),e.setDegradationPreference(t.degradationPreference)),F)if(Lo()&&e.kind===me.Kind.Audio){let X;for(const he of this.engine.pcManager.publisher.getTransceivers())if(he.sender===e.sender){X=he;break}X&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:X,codec:"opus",maxbr:!((z=F[0])===null||z===void 0)&&z.maxBitrate?F[0].maxBitrate/1e3:0})}else e.codec&&_i(e.codec)&&!((K=F[0])===null||K===void 0)&&K.maxBitrate&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:G.cid,codec:e.codec,maxbr:F[0].maxBitrate/1e3});yield this.engine.negotiate()});let D;const Q=new Promise((Y,z)=>j(this,void 0,void 0,function*(){var K;try{D=yield this.engine.addTrack(G),Y(D)}catch(X){e.sender&&!((K=this.engine.pcManager)===null||K===void 0)&&K.publisher&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(he=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{error:he}))})),z(X)}}));if(this.enabledPublishVideoCodecs.length>0)D=(yield Promise.all([Q,O()]))[0];else{D=yield Q;let Y;if(D.codecs.forEach(z=>{Y===void 0&&(Y=z.mimeType)}),Y&&e.kind===me.Kind.Video){const z=Zl(Y);z!==V&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{codec:z})),t.videoCodec=z,F=lf(e.source===me.Source.ScreenShare,G.width,G.height,t))}yield O()}const ie=new uf(e.kind,D,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(ie.on(_e.CpuConstrained,Y=>this.onTrackCpuConstrained(Y,ie)),ie.options=t,e.sid=D.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:F,trackInfo:D})),Ia(e)?e.startMonitor(this.engine.client):Yi(e)&&e.startMonitor(),this.addTrackPublication(ie),this.emit(Le.LocalTrackPublished,ie),Yi(e)&&D.audioFeatures.includes(gn.TF_PRECONNECT_BUFFER)){const Y=e.getPreConnectBuffer(),z=e.getPreConnectBufferMimeType();this.on(Le.LocalTrackSubscribed,K=>{if(K.trackSid===D.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),pt(e))),e.stopPreConnectBuffer()}}),Y&&new Promise((K,X)=>j(this,void 0,void 0,function*(){var he,je,ce,de,Me,Re;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),pt(e)));const L=setTimeout(()=>{X(new Error("agent not active within 10 seconds"))},1e4),se=yield this.waitUntilActiveAgentPresent();clearTimeout(L),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),pt(e)));const Ge=yield this.streamBytes({name:"preconnect-buffer",mimeType:z,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[se.identity],attributes:{trackId:ie.trackSid,sampleRate:String((Me=U.sampleRate)!==null&&Me!==void 0?Me:"48000"),channels:String((Re=U.channelCount)!==null&&Re!==void 0?Re:"1")}});try{for(var le=!0,Ee=ea(Y),ke;ke=yield Ee.next(),he=ke.done,!he;le=!0){de=ke.value,le=!1;const xe=de;yield Ge.write(xe)}}catch(xe){je={error:xe}}finally{try{!le&&!he&&(ce=Ee.return)&&(yield ce.call(Ee))}finally{if(je)throw je.error}}yield Ge.close(),K()}catch(L){X(L)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),pt(e)))}).catch(K=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{error:K}))})}return ie})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,r){return j(this,void 0,void 0,function*(){var a;if(this.encryptionType!==dn.NONE)return;let s;if(this.trackPublications.forEach(x=>{x.track&&x.track===e&&(s=x)}),!s)throw new ta("track is not published");if(!Ia(e))throw new ta("track is not a video track");const l=Object.assign(Object.assign({},(a=this.roomOptions)===null||a===void 0?void 0:a.publishDefaults),r),u=O2(e,t,l);if(!u){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),pt(e)));return}const h=e.addSimulcastTrack(t,u);if(!h)return;const f=new hc({cid:h.mediaStreamTrack.id,type:me.kindToProto(e.kind),muted:e.isMuted,source:me.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:l.videoCodec,cid:h.mediaStreamTrack.id}]});if(f.layers=Hb(f.width,f.height,u),!this.engine||this.engine.isClosed)throw new ln("cannot publish track when not connected");const g=()=>j(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,h,l,u),yield this.engine.negotiate()}),C=(yield Promise.all([this.engine.addTrack(f),g()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:u,trackInfo:C}))})}unpublishTrack(e,t){return j(this,void 0,void 0,function*(){var r,a;if(Bs(e)){const f=this.pendingPublishPromises.get(e);f&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),pt(e))),yield f)}const s=this.getPublicationForTrack(e),l=s?pt(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),l)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),l));return}e=s.track,e.off(_e.Muted,this.onTrackMuted),e.off(_e.Unmuted,this.onTrackUnmuted),e.off(_e.Ended,this.handleTrackEnded),e.off(_e.UpstreamPaused,this.onTrackUpstreamPaused),e.off(_e.UpstreamResumed,this.onTrackUpstreamResumed),e.off(_e.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),t===void 0&&(t=(a=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&a!==void 0?a:!0),t?e.stop():e.stopMonitor();let u=!1;const h=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<$t.FAILED&&h)try{for(const f of this.engine.pcManager.publisher.getTransceivers())f.sender===h&&(f.direction="inactive",u=!0);if(this.engine.removeTrack(h)&&(u=!0),Ia(e)){for(const[,f]of e.simulcastCodecs)f.sender&&(this.engine.removeTrack(f.sender)&&(u=!0),f.sender=void 0);e.simulcastCodecs.clear()}}catch(f){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),l),{error:f}))}switch(this.trackPublications.delete(s.trackSid),s.kind){case me.Kind.Audio:this.audioTrackPublications.delete(s.trackSid);break;case me.Kind.Video:this.videoTrackPublications.delete(s.trackSid);break}return this.emit(Le.LocalTrackUnpublished,s),s.setTrack(void 0),u&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return j(this,void 0,void 0,function*(){return(yield Promise.all(e.map(t=>this.unpublishTrack(t)))).filter(t=>!!t)})}republishAllTracks(e){return j(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((s,l)=>j(r,void 0,void 0,function*(){try{const u=[];this.trackPublications.forEach(h=>{h.track&&(t&&(h.options=Object.assign(Object.assign({},h.options),t)),u.push(h))}),yield Promise.all(u.map(h=>j(this,void 0,void 0,function*(){const f=h.track;yield this.unpublishTrack(f,!1),a&&!f.isMuted&&f.source!==me.Source.ScreenShare&&f.source!==me.Source.ScreenShareAudio&&(Yi(f)||Ia(f))&&!f.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:h.trackSid})),yield f.restartTrack()),yield this.publishOrRepublishTrack(f,h.options,!0)}))),s()}catch(u){l(u)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return j(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const s=a.reliable?lt.RELIABLE:lt.LOSSY,l=a.destinationIdentities,u=a.topic;let h=new Nf({participantIdentity:r.identity,payload:t,destinationIdentities:l,topic:u});const f=new Jn({kind:s,value:{case:"user",value:h}});yield r.engine.sendDataPacket(f,s)}()})}publishDtmf(e,t){return j(this,void 0,void 0,function*(){const r=new Jn({kind:lt.RELIABLE,value:{case:"sipDtmf",value:new P0({code:e,digit:t})}});yield this.engine.sendDataPacket(r,lt.RELIABLE)})}sendChatMessage(e,t){return j(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:t==null?void 0:t.attachments},a=new Jn({value:{case:"chatMessage",value:new hd(Object.assign(Object.assign({},r),{timestamp:Ft.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(a,lt.RELIABLE),this.emit(Le.ChatMessage,r),r})}editChatMessage(e,t){return j(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),a=new Jn({value:{case:"chatMessage",value:new hd(Object.assign(Object.assign({},r),{timestamp:Ft.parse(r.timestamp),editTimestamp:Ft.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(a,lt.RELIABLE),this.emit(Le.ChatMessage,r),r})}sendText(e,t){return j(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return j(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return j(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return j(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return j(this,arguments,void 0,function(t){var r=this;let{destinationIdentity:a,method:s,payload:l,responseTimeout:u=15e3}=t;return function*(){return new Promise((h,f)=>j(r,void 0,void 0,function*(){var g,C,x,T;if(em(l)>F1){f(Jt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((C=(g=this.engine.latestJoinResponse)===null||g===void 0?void 0:g.serverInfo)===null||C===void 0)&&C.version&&Mi((T=(x=this.engine.latestJoinResponse)===null||x===void 0?void 0:x.serverInfo)===null||T===void 0?void 0:T.version,"1.8.0")<0){f(Jt.builtIn("UNSUPPORTED_SERVER"));return}const V=Math.max(u,8e3),A=crypto.randomUUID();yield this.publishRpcRequest(a,A,s,l,V);const W=setTimeout(()=>{this.pendingAcks.delete(A),f(Jt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(A),clearTimeout(U)},7e3);this.pendingAcks.set(A,{resolve:()=>{clearTimeout(W)},participantIdentity:a});const U=setTimeout(()=>{this.pendingResponses.delete(A),f(Jt.builtIn("RESPONSE_TIMEOUT"))},u);this.pendingResponses.set(A,{resolve:(G,F)=>{clearTimeout(U),this.pendingAcks.has(A)&&(console.warn("RPC response received before ack",A),this.pendingAcks.delete(A),clearTimeout(W)),F?f(F):h(G??"")},participantIdentity:a})}))}()})}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,r){const a=this.pendingResponses.get(e);a?(a.resolve(t,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,r,a,s){return j(this,void 0,void 0,function*(){const l=new Jn({destinationIdentities:[e],kind:lt.RELIABLE,value:{case:"rpcRequest",value:new jf({id:t,method:r,payload:a,responseTimeoutMs:s,version:1})}});yield this.engine.sendDataPacket(l,lt.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:r,resolve:a}]of this.pendingResponses)r===e&&(a(null,Jt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(t=>t.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(t=>{var r,a;const s=this.trackPublications.get(t.sid);if(s){const l=s.isMuted||((a=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&a!==void 0?a:!1);l!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),pt(s)),{mutedOnServer:l})),this.engine.client.sendMuteTrack(t.sid,l))}}),!0):!1}setActiveAgent(e){var t,r,a,s;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(r=(t=this.activeAgentFuture)===null||t===void 0?void 0:t.resolve)===null||r===void 0||r.call(t,e):(s=(a=this.activeAgentFuture)===null||a===void 0?void 0:a.reject)===null||s===void 0||s.call(a,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Vr),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(r=>{const a=r.track;a&&(e instanceof MediaStreamTrack?(Yi(a)||Ia(a))&&a.mediaStreamTrack===e&&(t=r):e===a&&(t=r))}),t}waitForPendingPublicationOfSource(e){return j(this,void 0,void 0,function*(){const t=Date.now();for(;Date.now()<t+1e4;){const r=Array.from(this.pendingPublishPromises.entries()).find(a=>{let[s]=a;return s.source===e});if(r)return r[1];yield Qn(20)}})}}class tE extends Xi{constructor(e,t,r,a){super(e,t.sid,t.name,a),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=s=>{this.setTrack(void 0),this.emit(_e.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.visible=s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensionsAdaptiveStream=s,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const a=new Md({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new I0({participantSid:"",trackSids:[this.trackSid]})]});this.emit(_e.UpdateSubscription,a),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?Xi.SubscriptionStatus.Unsubscribed:super.isSubscribed?Xi.SubscriptionStatus.Subscribed:Xi.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Xi.PermissionStatus.Allowed:Xi.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,r;this.isManualOperationAllowed()&&(((t=this.requestedVideoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((r=this.requestedVideoDimensions)===null||r===void 0?void 0:r.height)===e.height||(gp(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&gp(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:Cr.HIGH}setTrack(e){const t=this.subscriptionStatus,r=this.permissionStatus,a=this.track;a!==e&&(a&&(a.off(_e.VideoDimensionsChanged,this.handleVideoDimensionsChange),a.off(_e.VisibilityChanged,this.handleVisibilityChange),a.off(_e.Ended,this.handleEnded),a.detach(),a.stopMonitor(),this.emit(_e.Unsubscribed,a)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(_e.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(_e.VisibilityChanged,this.handleVisibilityChange),e.on(_e.Ended,this.handleEnded),this.emit(_e.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(_e.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?_e.Muted:_e.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(_e.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(_e.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return gp(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new U0({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===me.Kind.Video){let t=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(t)Eb(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const r=Jx(this.trackInfo,this.requestedMaxQuality);r&&Eb(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:Cr.HIGH})),e.quality=Cr.HIGH)}this.emit(_e.UpdateSettings,e)}}class yd extends z1{static fromParticipantInfo(e,t,r){return new yd(e,t.sid,t.identity,t.name,t.metadata,t.attributes,r,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,r,a,s,l,u){let h=arguments.length>7&&arguments[7]!==void 0?arguments[7]:dc.STANDARD;super(t,r||"",a,s,l,u,h),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(_e.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(_e.UpdateSubscription,t=>{t.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(_e.SubscriptionPermissionChanged,t=>{this.emit(Le.TrackSubscriptionPermissionChanged,e,t)}),e.on(_e.SubscriptionStatusChanged,t=>{this.emit(Le.TrackSubscriptionStatusChanged,e,t)}),e.on(_e.Subscribed,t=>{this.emit(Le.TrackSubscribed,t,e)}),e.on(_e.Unsubscribed,t=>{this.emit(Le.TrackUnsubscribed,t,e)}),e.on(_e.SubscriptionFailed,t=>{this.emit(Le.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:me.Source.Microphone;this.volumeMap.set(t,e);const r=this.getTrackPublication(t);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:me.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,r,a,s,l){let u=this.getTrackPublicationBySid(t);if(u||t.startsWith("TR")||this.trackPublications.forEach(g=>{!u&&e.kind===g.kind.toString()&&(u=g)}),!u){if(l===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit(Le.TrackSubscriptionFailed,t);return}l===void 0&&(l=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,r,a,s,l-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),pt(u))),this.emit(Le.TrackSubscriptionFailed,t);return}const h=e.kind==="video";let f;return h?f=new K2(e,t,a,s):f=new $2(e,t,a,this.audioContext,this.audioOutput),f.source=u.source,f.isMuted=u.isMuted,f.setMediaStream(r),f.start(),u.setTrack(f),this.volumeMap.has(u.source)&&nf(f)&&Pi(f)&&f.setVolume(this.volumeMap.get(u.source)),u}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,r=new Map;return e.tracks.forEach(a=>{var s,l;let u=this.getTrackPublicationBySid(a.sid);if(u)u.updateInfo(a);else{const h=me.kindFromProto(a.type);if(!h)return;u=new tE(h,a,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(l=this.loggerOptions)===null||l===void 0?void 0:l.loggerName}),u.updateInfo(a),r.set(a.sid,u);const f=Array.from(this.trackPublications.values()).find(g=>g.source===(u==null?void 0:u.source));f&&u.source!==me.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),Object.assign(Object.assign({},this.logContext),{oldTrack:pt(f),newTrack:pt(u)})),this.addTrackPublication(u)}t.set(a.sid,u)}),this.trackPublications.forEach(a=>{t.has(a.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),pt(a))),this.unpublishTrack(a.trackSid,!0))}),r.forEach(a=>{this.emit(Le.TrackPublished,a)}),!0}unpublishTrack(e,t){const r=this.trackPublications.get(e);if(!r)return;const{track:a}=r;switch(a&&(a.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case me.Kind.Audio:this.audioTrackPublications.delete(e);break;case me.Kind.Video:this.videoTrackPublications.delete(e);break}t&&this.emit(Le.TrackUnpublished,r)}setAudioOutput(e){return j(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(r=>{var a;Pi(r.track)&&nf(r.track)&&t.push(r.track.setSinkId((a=e.deviceId)!==null&&a!==void 0?a:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var wt;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting"})(wt||(wt={}));const nE=4*1e3;class Ws extends Oi.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var t,r,a,s;if(super(),t=this,this.state=wt.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=ct,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(l,u,h)=>j(this,void 0,void 0,function*(){var f;if(!Px())throw Ii()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const g=yield this.disconnectLock.lock();if(this.state===wt.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),g(),Promise.resolve();if(this.connectFuture)return g(),this.connectFuture.promise;this.setAndEmitConnectionState(wt.Connecting),((f=this.regionUrlProvider)===null||f===void 0?void 0:f.getServerUrl().toString())!==l&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),ef(new URL(l))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new cn(l,u):this.regionUrlProvider.updateToken(u),this.regionUrlProvider.fetchRegionSettings().then(T=>{var V;(V=this.regionUrlProvider)===null||V===void 0||V.setServerReportedRegions(T)}).catch(T=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:T}))}));const C=(T,V,A)=>j(this,void 0,void 0,function*(){var W,U;this.abortController&&this.abortController.abort();const G=new AbortController;this.abortController=G,g==null||g();try{yield this.attemptConnection(A??l,u,h,G),this.abortController=void 0,T()}catch(F){if(this.regionUrlProvider&&F instanceof kt&&F.reason!==mt.Cancelled&&F.reason!==mt.NotAllowed){let O=null;try{O=yield this.regionUrlProvider.getNextBestRegionUrl((W=this.abortController)===null||W===void 0?void 0:W.signal)}catch(D){if(D instanceof kt&&(D.status===401||D.reason===mt.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),V(D);return}}O&&!(!((U=this.abortController)===null||U===void 0)&&U.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(F.message,". Retrying with another region: ").concat(O),this.logContext),this.recreateEngine(),yield C(T,V,O)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,xb(F)),V(F))}else{let O=ci.UNKNOWN_REASON;F instanceof kt&&(O=xb(F)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,O),V(F)}}}),x=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Vr((T,V)=>{C(T,V,x)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(l,u,h,f,g,C)=>j(this,void 0,void 0,function*(){var x,T,V;const A=yield h.join(l,u,{autoSubscribe:f.autoSubscribe,adaptiveStream:typeof g.adaptiveStream=="object"?!0:g.adaptiveStream,maxRetries:f.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:f.websocketTimeout,singlePeerConnection:g.singlePeerConnection},C.signal);let W=A.serverInfo;if(W||(W={version:A.serverVersion,region:A.serverRegion}),this.serverInfo=W,this.log.debug("connected to Livekit Server ".concat(Object.entries(W).map(U=>{let[G,F]=U;return"".concat(G,": ").concat(F)}).join(", ")),{room:(x=A.room)===null||x===void 0?void 0:x.name,roomSid:(T=A.room)===null||T===void 0?void 0:T.sid,identity:(V=A.participant)===null||V===void 0?void 0:V.identity}),!W.version)throw new hx("unknown server version");return W.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),g.dynacast=!1),A}),this.applyJoinResponse=l=>{const u=l.participant;if(this.localParticipant.sid=u.sid,this.localParticipant.identity=u.identity,this.localParticipant.setEnabledPublishCodecs(l.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(l.sifTrailer)}catch(h){this.log.error(h instanceof Error?h.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:h}))}this.handleParticipantUpdates([u,...l.otherParticipants]),l.room&&this.handleRoomUpdate(l.room)},this.attemptConnection=(l,u,h,f)=>j(this,void 0,void 0,function*(){var g,C;this.state===wt.Reconnecting||this.isResuming||!((g=this.engine)===null||g===void 0)&&g.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((C=this.regionUrlProvider)===null||C===void 0)&&C.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Zf),h),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const x=yield this.connectSignal(l,u,this.engine,this.connOptions,this.options,f);this.applyJoinResponse(x),this.setupLocalParticipantEvents(),this.emit(Se.SignalConnected)}catch(x){yield this.engine.close(),this.recreateEngine();const T=new kt("could not establish signal connection",mt.ServerUnreachable);throw x instanceof Error&&(T.message="".concat(T.message,": ").concat(x.message)),x instanceof kt&&(T.reason=x.reason,T.status=x.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:x})),T}if(f.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new kt("Connection attempt aborted",mt.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,f)}catch(x){throw yield this.engine.close(),this.recreateEngine(),x}dr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),dr()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(wt.Connected),this.emit(Se.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return j(t,[...u],void 0,function(){var f=this;let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var C,x,T,V;const A=yield f.disconnectLock.lock();try{if(f.state===wt.Disconnected){f.log.debug("already disconnected",f.logContext);return}if(f.log.info("disconnect from room",Object.assign({},f.logContext)),f.state===wt.Connecting||f.state===wt.Reconnecting||f.isResuming){const W="Abort connection attempt due to user initiated disconnect";f.log.warn(W,f.logContext),(C=f.abortController)===null||C===void 0||C.abort(W),(T=(x=f.connectFuture)===null||x===void 0?void 0:x.reject)===null||T===void 0||T.call(x,new kt("Client initiated disconnect",mt.Cancelled)),f.connectFuture=void 0}!((V=f.engine)===null||V===void 0)&&V.client.isDisconnected||(yield f.engine.client.sendLeave()),f.engine&&(yield f.engine.close()),f.handleDisconnect(g,ci.CLIENT_INITIATED),f.engine=void 0}finally{A()}}()})},this.onPageLeave=()=>j(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>j(this,void 0,void 0,function*(){const l=[],u=hr();if(u&&u.os==="iOS"){const h="livekit-dummy-audio-el";let f=document.getElementById(h);if(!f){f=document.createElement("audio"),f.id=h,f.autoplay=!0,f.hidden=!0;const g=mp();g.enabled=!0;const C=new MediaStream([g]);f.srcObject=C,document.addEventListener("visibilitychange",()=>{f&&(f.srcObject=document.hidden?null:C,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(f),this.once(Se.Disconnected,()=>{f==null||f.remove(),f=null})}l.push(f)}this.remoteParticipants.forEach(h=>{h.audioTrackPublications.forEach(f=>{f.track&&f.track.attachedElements.forEach(g=>{l.push(g)})})});try{yield Promise.all([this.acquireAudioContext(),...l.map(h=>(h.muted=!1,h.play()))]),this.handleAudioPlaybackStarted()}catch(h){throw this.handleAudioPlaybackFailed(h),h}}),this.startVideo=()=>j(this,void 0,void 0,function*(){const l=[];for(const u of this.remoteParticipants.values())u.videoTrackPublications.forEach(h=>{var f;(f=h.track)===null||f===void 0||f.attachedElements.forEach(g=>{l.includes(g)||l.push(g)})});yield Promise.all(l.map(u=>u.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(u=>{u.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const l of this.remoteParticipants.values())this.handleParticipantDisconnected(l.identity,l);this.setAndEmitConnectionState(wt.Reconnecting)&&this.emit(Se.Reconnecting)},this.handleSignalRestarted=l=>j(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(l.serverRegion),Object.assign(Object.assign({},this.logContext),{region:l.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(l);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(u){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:u}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:l.serverRegion}))}catch{return}this.setAndEmitConnectionState(wt.Connected),this.emit(Se.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=l=>{l.forEach(u=>{var h;if(u.identity===this.localParticipant.identity){this.localParticipant.updateInfo(u);return}u.identity===""&&(u.identity=(h=this.sidToIdentity.get(u.sid))!==null&&h!==void 0?h:"");let f=this.remoteParticipants.get(u.identity);u.state===js.DISCONNECTED?this.handleParticipantDisconnected(u.identity,f):f=this.getOrCreateParticipant(u.identity,u)})},this.handleActiveSpeakersUpdate=l=>{const u=[],h={};l.forEach(f=>{if(h[f.sid]=!0,f.sid===this.localParticipant.sid)this.localParticipant.audioLevel=f.level,this.localParticipant.setIsSpeaking(!0),u.push(this.localParticipant);else{const g=this.getRemoteParticipantBySid(f.sid);g&&(g.audioLevel=f.level,g.setIsSpeaking(!0),u.push(g))}}),h[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(f=>{h[f.sid]||(f.audioLevel=0,f.setIsSpeaking(!1))}),this.activeSpeakers=u,this.emitWhenConnected(Se.ActiveSpeakersChanged,u)},this.handleSpeakersChanged=l=>{const u=new Map;this.activeSpeakers.forEach(f=>{const g=this.remoteParticipants.get(f.identity);g&&g.sid!==f.sid||u.set(f.sid,f)}),l.forEach(f=>{let g=this.getRemoteParticipantBySid(f.sid);f.sid===this.localParticipant.sid&&(g=this.localParticipant),g&&(g.audioLevel=f.level,g.setIsSpeaking(f.active),f.active?u.set(f.sid,g):u.delete(f.sid))});const h=Array.from(u.values());h.sort((f,g)=>g.audioLevel-f.audioLevel),this.activeSpeakers=h,this.emitWhenConnected(Se.ActiveSpeakersChanged,h)},this.handleStreamStateUpdate=l=>{l.streamStates.forEach(u=>{const h=this.getRemoteParticipantBySid(u.participantSid);if(!h)return;const f=h.getTrackPublicationBySid(u.trackSid);if(!f||!f.track)return;const g=me.streamStateFromProto(u.state);f.track.setStreamState(g),g!==f.track.streamState&&(h.emit(Le.TrackStreamStateChanged,f,f.track.streamState),this.emitWhenConnected(Se.TrackStreamStateChanged,f,f.track.streamState,h))})},this.handleSubscriptionPermissionUpdate=l=>{const u=this.getRemoteParticipantBySid(l.participantSid);if(!u)return;const h=u.getTrackPublicationBySid(l.trackSid);h&&h.setAllowed(l.allowed)},this.handleSubscriptionError=l=>{const u=Array.from(this.remoteParticipants.values()).find(f=>f.trackPublications.has(l.trackSid));if(!u)return;const h=u.getTrackPublicationBySid(l.trackSid);h&&h.setSubscriptionError(l.err)},this.handleDataPacket=(l,u)=>{const h=this.remoteParticipants.get(l.participantIdentity);if(l.value.case==="user")this.handleUserPacket(h,l.value.value,l.kind,u);else if(l.value.case==="transcription")this.handleTranscription(h,l.value.value);else if(l.value.case==="sipDtmf")this.handleSipDtmf(h,l.value.value);else if(l.value.case==="chatMessage")this.handleChatMessage(h,l.value.value);else if(l.value.case==="metrics")this.handleMetrics(l.value.value,h);else if(l.value.case==="streamHeader"||l.value.case==="streamChunk"||l.value.case==="streamTrailer")this.handleDataStream(l,u);else if(l.value.case==="rpcRequest"){const f=l.value.value;this.handleIncomingRpcRequest(l.participantIdentity,f.id,f.method,f.payload,f.responseTimeoutMs,f.version)}},this.handleUserPacket=(l,u,h,f)=>{this.emit(Se.DataReceived,u.payload,l,h,u.topic,f),l==null||l.emit(Le.DataReceived,u.payload,h,f)},this.handleSipDtmf=(l,u)=>{this.emit(Se.SipDTMFReceived,u,l),l==null||l.emit(Le.SipDTMFReceived,u)},this.handleTranscription=(l,u)=>{const h=u.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(u.transcribedParticipantIdentity),f=h==null?void 0:h.trackPublications.get(u.trackId),g=Dx(u,this.transcriptionReceivedTimes);f==null||f.emit(_e.TranscriptionReceived,g),h==null||h.emit(Le.TranscriptionReceived,g,f),this.emit(Se.TranscriptionReceived,g,h,f)},this.handleChatMessage=(l,u)=>{const h=Fx(u);this.emit(Se.ChatMessage,h,l)},this.handleMetrics=(l,u)=>{this.emit(Se.MetricsReceived,l,u)},this.handleDataStream=(l,u)=>{this.incomingDataStreamManager.handleDataStreamPacket(l,u)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Se.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=l=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:l})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Se.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Se.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Se.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>j(this,void 0,void 0,function*(){var l;((l=hr())===null||l===void 0?void 0:l.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(Se.MediaDevicesChanged)}),this.handleRoomUpdate=l=>{const u=this.roomInfo;this.roomInfo=l,u&&u.metadata!==l.metadata&&this.emitWhenConnected(Se.RoomMetadataChanged,l.metadata),(u==null?void 0:u.activeRecording)!==l.activeRecording&&this.emitWhenConnected(Se.RecordingStatusChanged,l.activeRecording)},this.handleConnectionQualityUpdate=l=>{l.updates.forEach(u=>{if(u.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(u.quality);return}const h=this.getRemoteParticipantBySid(u.participantSid);h&&h.setConnectionQuality(u.quality)})},this.onLocalParticipantMetadataChanged=l=>{this.emit(Se.ParticipantMetadataChanged,l,this.localParticipant)},this.onLocalParticipantNameChanged=l=>{this.emit(Se.ParticipantNameChanged,l,this.localParticipant)},this.onLocalAttributesChanged=l=>{this.emit(Se.ParticipantAttributesChanged,l,this.localParticipant)},this.onLocalTrackMuted=l=>{this.emit(Se.TrackMuted,l,this.localParticipant)},this.onLocalTrackUnmuted=l=>{this.emit(Se.TrackUnmuted,l,this.localParticipant)},this.onTrackProcessorUpdate=l=>{var u;(u=l==null?void 0:l.onPublish)===null||u===void 0||u.call(l,this)},this.onLocalTrackPublished=l=>j(this,void 0,void 0,function*(){var u,h,f,g,C,x;(u=l.track)===null||u===void 0||u.on(_e.TrackProcessorUpdate,this.onTrackProcessorUpdate),(h=l.track)===null||h===void 0||h.on(_e.Restarted,this.onLocalTrackRestarted),(C=(g=(f=l.track)===null||f===void 0?void 0:f.getProcessor())===null||g===void 0?void 0:g.onPublish)===null||C===void 0||C.call(g,this),this.emit(Se.LocalTrackPublished,l,this.localParticipant),Yi(l.track)&&(yield l.track.checkForSilence())&&this.emit(Se.LocalAudioSilenceDetected,l);const T=yield(x=l.track)===null||x===void 0?void 0:x.getDeviceId(!1),V=af(l.source);V&&T&&T!==this.localParticipant.activeDeviceMap.get(V)&&(this.localParticipant.activeDeviceMap.set(V,T),this.emit(Se.ActiveDeviceChanged,V,T))}),this.onLocalTrackUnpublished=l=>{var u,h;(u=l.track)===null||u===void 0||u.off(_e.TrackProcessorUpdate,this.onTrackProcessorUpdate),(h=l.track)===null||h===void 0||h.off(_e.Restarted,this.onLocalTrackRestarted),this.emit(Se.LocalTrackUnpublished,l,this.localParticipant)},this.onLocalTrackRestarted=l=>j(this,void 0,void 0,function*(){const u=yield l.getDeviceId(!1),h=af(l.source);h&&u&&u!==this.localParticipant.activeDeviceMap.get(h)&&(this.log.debug("local track restarted, setting ".concat(h," ").concat(u," active"),this.logContext),this.localParticipant.activeDeviceMap.set(h,u),this.emit(Se.ActiveDeviceChanged,h,u))}),this.onLocalConnectionQualityChanged=l=>{this.emit(Se.ConnectionQualityChanged,l,this.localParticipant)},this.onMediaDevicesError=(l,u)=>{this.emit(Se.MediaDevicesError,l,u)},this.onLocalParticipantPermissionsChanged=l=>{this.emit(Se.ParticipantPermissionsChanged,l,this.localParticipant)},this.onLocalChatMessageSent=l=>{this.emit(Se.ChatMessage,l,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},g2),e),this.log=ia((r=this.options.loggerName)!==null&&r!==void 0?r:ui.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},N1),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},j1),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},m2),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new q2,this.outgoingDataStreamManager=new G2(this.engine,this.log),this.disconnectLock=new Xn,this.localParticipant=new eE("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Fa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Fa(this.options.audioCaptureDefaults.deviceId)),!((a=this.options.audioOutput)===null||a===void 0)&&a.deviceId&&this.switchActiveDevice("audiooutput",Fa(this.options.audioOutput.deviceId)).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),dr()){const l=new AbortController;(s=navigator.mediaDevices)===null||s===void 0||s.addEventListener("devicechange",this.handleDeviceChange,{signal:l.signal}),Ws.cleanupRegistry&&Ws.cleanupRegistry.register(this,()=>{l.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return j(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const t=!!this.options.encryption,r=this.options.encryption||this.options.e2ee;r&&("e2eeManager"in r?(this.e2eeManager=r.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=t):this.e2eeManager=new Yx(r,t),this.e2eeManager.on(Na.ParticipantEncryptionStatusChanged,(a,s)=>{Bx(s)&&(this.isE2EEEnabled=a),this.emit(Se.ParticipantEncryptionStatusChanged,a,s)}),this.e2eeManager.on(Na.EncryptionError,a=>this.emit(Se.EncryptionError,a)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}getSid(){return j(this,void 0,void 0,function*(){return this.state===wt.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,t)=>{const r=a=>{a.sid!==""&&(this.engine.off(Ae.RoomUpdate,r),e(a.sid))};this.engine.on(Ae.RoomUpdate,r),this.once(Se.Disconnected,()=>{this.engine.off(Ae.RoomUpdate,r),t("Room disconnected before room server id was available")})})})}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new U2(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(Ae.ParticipantUpdate,this.handleParticipantUpdates).on(Ae.RoomUpdate,this.handleRoomUpdate).on(Ae.SpeakersChanged,this.handleSpeakersChanged).on(Ae.StreamStateChanged,this.handleStreamStateUpdate).on(Ae.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Ae.SubscriptionError,this.handleSubscriptionError).on(Ae.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Ae.MediaTrackAdded,(e,t,r)=>{this.onTrackAdded(e,t,r)}).on(Ae.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Ae.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Ae.DataPacketReceived,this.handleDataPacket).on(Ae.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(wt.SignalReconnecting)&&this.emit(Se.SignalReconnecting)}).on(Ae.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(wt.Connected)&&this.emit(Se.Reconnected)}).on(Ae.SignalResumed,()=>{this.bufferedEvents=[],(this.state===wt.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(Ae.Restarting,this.handleRestarting).on(Ae.SignalRestarted,this.handleSignalRestarted).on(Ae.Offline,()=>{this.setAndEmitConnectionState(wt.Reconnecting)&&this.emit(Se.Reconnecting)}).on(Ae.DCBufferStatusChanged,(e,t)=>{this.emit(Se.DCBufferStatusChanged,e,t)}).on(Ae.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:a}=r;return a===e});if(!t){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(Le.LocalTrackSubscribed,t),this.emitWhenConnected(Se.LocalTrackSubscribed,t,this.localParticipant)}).on(Ae.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((t,r)=>{this.handleParticipantDisconnected(r,t)}),this.emit(Se.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return vn.getInstance().getDevices(e,t)}prepareConnection(e,t){return j(this,void 0,void 0,function*(){if(this.state===wt.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(ef(new URL(e))&&t){this.regionUrlProvider=new cn(e,t);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===wt.Disconnected&&(this.regionUrl=r,yield fetch(tf(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(tf(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return j(this,void 0,void 0,function*(){let r=()=>j(this,void 0,void 0,function*(){}),a;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":a=new Ti({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":a=new Ti({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":a=new Ti({scenario:{case:"serverLeave",value:!0}});break;case"migration":a=new Ti({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>j(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),a=new Ti({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>j(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),a=new Ti({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":a=new Ti({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>j(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new Od({reason:ci.CLIENT_INITIATED,action:Ds.RECONNECT}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");a=new Ti({scenario:{case:"subscriberBandwidth",value:Po(t)}});break;case"leave-full-reconnect":a=new Ti({scenario:{case:"leaveRequestFullReconnect",value:!0}})}a&&(yield this.engine.client.sendSimulateScenario(a),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return j(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var u,h,f,g,C,x,T;let V=!0,A=!1;const W=l?{exact:a}:a;if(r==="audioinput"){A=s.localParticipant.audioTrackPublications.size===0;const U=(u=s.getActiveDevice(r))!==null&&u!==void 0?u:s.options.audioCaptureDefaults.deviceId;s.options.audioCaptureDefaults.deviceId=W;const G=Array.from(s.localParticipant.audioTrackPublications.values()).filter(O=>O.source===me.Source.Microphone);try{V=(yield Promise.all(G.map(O=>{var D;return(D=O.audioTrack)===null||D===void 0?void 0:D.setDeviceId(W)}))).every(O=>O===!0)}catch(O){throw s.options.audioCaptureDefaults.deviceId=U,O}const F=G.some(O=>{var D,Q;return(Q=(D=O.track)===null||D===void 0?void 0:D.isMuted)!==null&&Q!==void 0?Q:!1});V&&F&&(A=!0)}else if(r==="videoinput"){A=s.localParticipant.videoTrackPublications.size===0;const U=(h=s.getActiveDevice(r))!==null&&h!==void 0?h:s.options.videoCaptureDefaults.deviceId;s.options.videoCaptureDefaults.deviceId=W;const G=Array.from(s.localParticipant.videoTrackPublications.values()).filter(O=>O.source===me.Source.Camera);try{V=(yield Promise.all(G.map(O=>{var D;return(D=O.videoTrack)===null||D===void 0?void 0:D.setDeviceId(W)}))).every(O=>O===!0)}catch(O){throw s.options.videoCaptureDefaults.deviceId=U,O}const F=G.some(O=>{var D,Q;return(Q=(D=O.track)===null||D===void 0?void 0:D.isMuted)!==null&&Q!==void 0?Q:!1});V&&F&&(A=!0)}else if(r==="audiooutput"){if(A=!0,!Zp()&&!s.options.webAudioMix||s.options.webAudioMix&&s.audioContext&&!("setSinkId"in s.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");s.options.webAudioMix&&(a=(f=yield vn.getInstance().normalizeDeviceId("audiooutput",a))!==null&&f!==void 0?f:""),(g=(T=s.options).audioOutput)!==null&&g!==void 0||(T.audioOutput={});const U=(C=s.getActiveDevice(r))!==null&&C!==void 0?C:s.options.audioOutput.deviceId;s.options.audioOutput.deviceId=a;try{s.options.webAudioMix&&((x=s.audioContext)===null||x===void 0||x.setSinkId(a)),yield Promise.all(Array.from(s.remoteParticipants.values()).map(G=>G.setAudioOutput({deviceId:a})))}catch(G){throw s.options.audioOutput.deviceId=U,G}}return A&&(s.localParticipant.activeDeviceMap.set(r,a),s.emit(Se.ActiveDeviceChanged,r,a)),V}()})}setupLocalParticipantEvents(){this.localParticipant.on(Le.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Le.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Le.AttributesChanged,this.onLocalAttributesChanged).on(Le.TrackMuted,this.onLocalTrackMuted).on(Le.TrackUnmuted,this.onLocalTrackUnmuted).on(Le.LocalTrackPublished,this.onLocalTrackPublished).on(Le.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Le.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Le.MediaDevicesError,this.onMediaDevicesError).on(Le.AudioStreamAcquired,this.startAudio).on(Le.ChatMessage,this.onLocalChatMessageSent).on(Le.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,r){if(this.state===wt.Connecting||this.state===wt.Reconnecting){const C=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:t.id,tracksInStream:t.getTracks().map(T=>T.id)}),this.onTrackAdded(e,t,r),x()},x=()=>{this.off(Se.Reconnected,C),this.off(Se.Connected,C),this.off(Se.Disconnected,x)};this.once(Se.Reconnected,C),this.once(Se.Connected,C),this.once(Se.Disconnected,x);return}if(this.state===wt.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const a=xx(t.id),s=a[0];let l=a[1],u=e.id;if(l&&l.startsWith("TR")&&(u=l),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const h=Array.from(this.remoteParticipants.values()).find(C=>C.sid===s);if(!h){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}if(!u.startsWith("TR")){const C=this.engine.getTrackIdForReceiver(r);if(!C){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(s),this.logContext);return}u=C}u.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(s,", streamId: ").concat(l,", trackId: ").concat(u),Object.assign(Object.assign({},this.logContext),{rpID:s,streamId:l,trackId:u}));let f;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?f=this.options.adaptiveStream:f={});const g=h.addSubscribedMediaTrack(e,u,t,r,f);g!=null&&g.isEncrypted&&!this.e2eeManager&&this.emit(Se.EncryptionError,new Error("Encrypted ".concat(g.source," track received from participant ").concat(h.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==wt.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(a=>{a.trackPublications.forEach(s=>{a.unpublishTrack(s.trackSid)})}),this.localParticipant.trackPublications.forEach(a=>{var s,l,u;a.track&&this.localParticipant.unpublishTrack(a.track,e),e?((s=a.track)===null||s===void 0||s.detach(),(l=a.track)===null||l===void 0||l.stop()):(u=a.track)===null||u===void 0||u.stopMonitor()}),this.localParticipant.off(Le.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Le.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Le.AttributesChanged,this.onLocalAttributesChanged).off(Le.TrackMuted,this.onLocalTrackMuted).off(Le.TrackUnmuted,this.onLocalTrackUnmuted).off(Le.LocalTrackPublished,this.onLocalTrackPublished).off(Le.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Le.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Le.MediaDevicesError,this.onMediaDevicesError).off(Le.AudioStreamAcquired,this.startAudio).off(Le.ChatMessage,this.onLocalChatMessageSent).off(Le.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),dr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(wt.Disconnected),this.emit(Se.Disconnected,t)}}}handleParticipantDisconnected(e,t){var r;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(a=>{t.unpublishTrack(a.trackSid,!0)}),this.emit(Se.ParticipantDisconnected,t),t.setDisconnected(),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,r,a,s,l){return j(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),l!==1){yield this.engine.publishRpcResponse(e,t,null,Jt.builtIn("UNSUPPORTED_VERSION"));return}const u=this.rpcHandlers.get(r);if(!u){yield this.engine.publishRpcResponse(e,t,null,Jt.builtIn("UNSUPPORTED_METHOD"));return}let h=null,f=null;try{const g=yield u({requestId:t,callerIdentity:e,payload:a,responseTimeout:s});em(g)>F1?(h=Jt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):f=g}catch(g){g instanceof Jt?h=g:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),g),h=Jt.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,f,h)})}selectDefaultDevices(){return j(this,void 0,void 0,function*(){var e,t,r;const a=vn.getInstance().previousDevices,s=yield vn.getInstance().getDevices(void 0,!1),l=hr();if((l==null?void 0:l.name)==="Chrome"&&l.os!=="iOS")for(let h of s){const f=a.find(g=>g.deviceId===h.deviceId);f&&f.label!==""&&f.kind===h.kind&&f.label!==h.label&&this.getActiveDevice(h.kind)==="default"&&this.emit(Se.ActiveDeviceChanged,h.kind,h.deviceId)}const u=["audiooutput","audioinput","videoinput"];for(let h of u){const f=qx(h),g=this.localParticipant.getTrackPublication(f);if(g&&!((e=g.track)===null||e===void 0)&&e.isUserProvided)continue;const C=s.filter(T=>T.kind===h),x=this.getActiveDevice(h);if(x===((t=a.filter(T=>T.kind===h)[0])===null||t===void 0?void 0:t.deviceId)&&C.length>0&&((r=C[0])===null||r===void 0?void 0:r.deviceId)!==x){yield this.switchActiveDevice(h,C[0].deviceId);continue}h==="audioinput"&&!fc()||h==="videoinput"||C.length>0&&!C.find(T=>T.deviceId===this.getActiveDevice(h))&&(h!=="audiooutput"||!fc())&&(yield this.switchActiveDevice(h,C[0].deviceId))}})}acquireAudioContext(){return j(this,void 0,void 0,function*(){var e,t;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=O1())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(a=>a.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Qn(200)])}catch(a){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:a}))}const r=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(Se.AudioPlaybackStatusChanged,r))})}createParticipant(e,t){var r;let a;return t?a=yd.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):a=new yd(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&a.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&a.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),a}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const a=this.remoteParticipants.get(e);return t&&a.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),a}const r=this.createParticipant(e,t);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(Se.ParticipantConnected,r),r.on(Le.TrackPublished,a=>{this.emitWhenConnected(Se.TrackPublished,a,r)}).on(Le.TrackSubscribed,(a,s)=>{a.kind===me.Kind.Audio?(a.on(_e.AudioPlaybackStarted,this.handleAudioPlaybackStarted),a.on(_e.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):a.kind===me.Kind.Video&&(a.on(_e.VideoPlaybackFailed,this.handleVideoPlaybackFailed),a.on(_e.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Se.TrackSubscribed,a,s,r)}).on(Le.TrackUnpublished,a=>{this.emit(Se.TrackUnpublished,a,r)}).on(Le.TrackUnsubscribed,(a,s)=>{this.emit(Se.TrackUnsubscribed,a,s,r)}).on(Le.TrackMuted,a=>{this.emitWhenConnected(Se.TrackMuted,a,r)}).on(Le.TrackUnmuted,a=>{this.emitWhenConnected(Se.TrackUnmuted,a,r)}).on(Le.ParticipantMetadataChanged,a=>{this.emitWhenConnected(Se.ParticipantMetadataChanged,a,r)}).on(Le.ParticipantNameChanged,a=>{this.emitWhenConnected(Se.ParticipantNameChanged,a,r)}).on(Le.AttributesChanged,a=>{this.emitWhenConnected(Se.ParticipantAttributesChanged,a,r)}).on(Le.ConnectionQualityChanged,a=>{this.emitWhenConnected(Se.ConnectionQualityChanged,a,r)}).on(Le.ParticipantPermissionsChanged,a=>{this.emitWhenConnected(Se.ParticipantPermissionsChanged,a,r)}).on(Le.TrackSubscriptionStatusChanged,(a,s)=>{this.emitWhenConnected(Se.TrackSubscriptionStatusChanged,a,s,r)}).on(Le.TrackSubscriptionFailed,(a,s)=>{this.emit(Se.TrackSubscriptionFailed,a,r,s)}).on(Le.TrackSubscriptionPermissionChanged,(a,s)=>{this.emitWhenConnected(Se.TrackSubscriptionPermissionChanged,a,s,r)}).on(Le.Active,()=>{this.emitWhenConnected(Se.ParticipantActive,r),r.kind===dc.AGENT&&this.localParticipant.setActiveAgent(r)}),t&&r.updateInfo(t),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,a)=>(r.push(...a.getTrackPublications()),r),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&Ux(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=_n.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ci.STATE_MISMATCH))):e=0},nE)}clearConnectionReconcile(){this.connectionReconcileInterval&&_n.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(Se.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,r]=e;this.emit(t,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(this.state===wt.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===wt.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return j(this,void 0,void 0,function*(){var t,r;const a=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Pd({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ft.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Ao({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Se.SignalConnected),this.emit(Se.Connected),this.setAndEmitConnectionState(wt.Connected),a.video){const l=new uf(me.Kind.Video,new Is({source:nn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:si.AUDIO,name:"video-dummy"}),new bd(a.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Tb(160*((t=s.aspectRatios[0])!==null&&t!==void 0?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Le.LocalTrackPublished,l)}if(a.audio){const l=new uf(me.Kind.Audio,new Is({source:nn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:si.AUDIO}),new vd(a.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:mp(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Le.LocalTrackPublished,l)}for(let l=0;l<s.count-1;l+=1){let u=new Ao({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(l),state:js.ACTIVE,tracks:[],joinedAt:Ft.parse(Date.now())});const h=this.getOrCreateParticipant(u.identity,u);if(s.video){const f=Tb(160*((r=s.aspectRatios[l%s.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),g=new Is({source:nn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:si.AUDIO});h.addSubscribedMediaTrack(f,g.sid,new MediaStream([f]),new RTCRtpReceiver),u.tracks=[...u.tracks,g]}if(s.audio){const f=mp(),g=new Is({source:nn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:si.AUDIO});h.addSubscribedMediaTrack(f,g.sid,new MediaStream([f]),new RTCRtpReceiver),u.tracks=[...u.tracks,g]}h.updateInfo(u)}})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(e!==Se.ActiveSpeakersChanged&&e!==Se.TranscriptionReceived){const s=G1(r).filter(l=>l!==void 0);(e===Se.TrackSubscribed||e===Se.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s}))}return super.emit(e,...r)}}Ws.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(n=>{n()});function G1(n){return n.map(e=>{if(e)return Array.isArray(e)?G1(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var ai;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(ai||(ai={}));class Ha extends Oi.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=ai.IDLE,this.logs=[],this.options={},this.url=e,this.token=t,this.name=this.constructor.name,this.room=new Ws(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return j(this,void 0,void 0,function*(){if(this.status!==ai.IDLE)throw Error("check is running already");this.setStatus(ai.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==ai.SKIPPED&&this.setStatus(this.isSuccess()?ai.SUCCESS:ai.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return j(this,void 0,void 0,function*(){return this.room.state===wt.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return j(this,void 0,void 0,function*(){this.room&&this.room.state!==wt.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(ai.SKIPPED)}switchProtocol(e){return j(this,void 0,void 0,function*(){let t=!1,r=!1;if(this.room.on(Se.Reconnecting,()=>{t=!0}),this.room.once(Se.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(s=>setTimeout(s,1e3)),!t)return;const a=Date.now()+1e4;for(;Date.now()<a;){if(r)return;yield Qn(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class rE extends Ha{get description(){return"Cloud regions"}perform(){return j(this,void 0,void 0,function*(){const e=new cn(this.url,this.token);if(!e.isCloud()){this.skip();return}const t=[],r=new Set;for(let s=0;s<3;s++){const l=yield e.getNextBestRegionUrl();if(!l)break;if(r.has(l))continue;r.add(l);const u=yield this.checkCloudRegion(l);this.appendMessage("".concat(u.region," RTT: ").concat(u.rtt,"ms, duration: ").concat(u.duration,"ms")),t.push(u)}t.sort((s,l)=>(s.duration-l.duration)*.5+(s.rtt-l.rtt)*.5);const a=t[0];this.bestStats=a,this.appendMessage("best Cloud region: ".concat(a.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return j(this,void 0,void 0,function*(){var t,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const a=(t=this.room.serverInfo)===null||t===void 0?void 0:t.region;if(!a)throw new Error("Region not found");const s=yield this.room.localParticipant.streamText({topic:"test"}),l=1e3,u=1e6/l,h="A".repeat(l),f=Date.now();for(let T=0;T<u;T++)yield s.write(h);yield s.close();const g=Date.now(),C=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),x={region:a,rtt:1e4,duration:g-f};return C==null||C.forEach(T=>{T.type==="candidate-pair"&&T.nominated&&(x.rtt=T.currentRoundTripTime*1e3)}),yield this.disconnect(),x})}}const Sp=1e4;class iE extends Ha{get description(){return"Connection via UDP vs TCP"}perform(){return j(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),t=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-t.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-t.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=t):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(Sp/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(Sp/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return j(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const t=document.createElement("canvas");t.width=1280,t.height=720;const r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context");let a=0;const s=()=>{a=(a+1)%360,r.fillStyle="hsl(".concat(a,", 100%, 50%)"),r.fillRect(0,0,t.width,t.height),requestAnimationFrame(s)};s();const l=t.captureStream(30).getVideoTracks()[0],u=(yield this.room.localParticipant.publishTrack(l,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,h={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},f=setInterval(()=>j(this,void 0,void 0,function*(){const g=yield u.getRTCStatsReport();g==null||g.forEach(C=>{C.type==="outbound-rtp"?(h.packetsSent=C.packetsSent,h.qualityLimitationDurations=C.qualityLimitationDurations,h.bitrateTotal+=C.targetBitrate,h.count++):C.type==="remote-inbound-rtp"&&(h.packetsLost=C.packetsLost,h.rttTotal+=C.roundTripTime,h.jitterTotal+=C.jitter)})}),1e3);return yield new Promise(g=>setTimeout(g,Sp)),clearInterval(f),l.stop(),t.remove(),yield this.disconnect(),h})}}class aE extends Ha{get description(){return"Can publish audio"}perform(){return j(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield X2();if(yield M1(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),t.localParticipant.publishTrack(r),yield new Promise(l=>setTimeout(l,3e3));const a=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!a)throw new Error("Could not get RTCStats");let s=0;if(a.forEach(l=>{l.type==="outbound-rtp"&&(l.kind==="audio"||!l.kind&&l.mediaType==="audio")&&(s=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class oE extends Ha{get description(){return"Can publish video"}perform(){return j(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield Y2();yield this.checkForVideo(r.mediaStreamTrack),t.localParticipant.publishTrack(r),yield new Promise(l=>setTimeout(l,5e3));const a=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!a)throw new Error("Could not get RTCStats");let s=0;if(a.forEach(l=>{l.type==="outbound-rtp"&&(l.kind==="video"||!l.kind&&l.mediaType==="video")&&(s+=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}checkForVideo(e){return j(this,void 0,void 0,function*(){const t=new MediaStream;t.addTrack(e.clone());const r=document.createElement("video");r.srcObject=t,r.muted=!0,r.autoplay=!0,r.playsInline=!0,r.setAttribute("playsinline","true"),document.body.appendChild(r),yield new Promise(a=>{r.onplay=()=>{setTimeout(()=>{var s,l,u,h;const f=document.createElement("canvas"),g=e.getSettings(),C=(l=(s=g.width)!==null&&s!==void 0?s:r.videoWidth)!==null&&l!==void 0?l:1280,x=(h=(u=g.height)!==null&&u!==void 0?u:r.videoHeight)!==null&&h!==void 0?h:720;f.width=C,f.height=x;const T=f.getContext("2d");T.drawImage(r,0,0);const V=T.getImageData(0,0,f.width,f.height).data;let A=!0;for(let W=0;W<V.length;W+=4)if(V[W]!==0||V[W+1]!==0||V[W+2]!==0){A=!1;break}A?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),a()},1e3)},r.play()}),t.getTracks().forEach(a=>a.stop()),r.remove()})}}class sE extends Ha{get description(){return"Resuming connection after interruption"}perform(){return j(this,void 0,void 0,function*(){var e;const t=yield this.connect();let r=!1,a=!1,s;const l=new Promise(f=>{setTimeout(f,5e3),s=f}),u=()=>{r=!0};t.on(Se.SignalReconnecting,u).on(Se.Reconnecting,u).on(Se.Reconnected,()=>{a=!0,s(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const h=t.engine.client.onClose;if(h&&h(""),yield l,r){if(!a||t.state!==wt.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class lE extends Ha{get description(){return"Can connect via TURN"}perform(){return j(this,void 0,void 0,function*(){var e,t;const r=new Jf,a=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3,singlePeerConnection:!1});let s=!1,l=!1,u=!1;for(let h of a.iceServers)for(let f of h.urls)f.startsWith("turn:")?(l=!0,u=!0):f.startsWith("turns:")&&(l=!0,u=!0,s=!0),f.startsWith("stun:")&&(u=!0);u?l&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((t=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||t===void 0)&&t.iceServers||l?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(h=>setTimeout(h,0)))})}}class cE extends Ha{get description(){return"Establishing WebRTC connection"}perform(){return j(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(Se.SignalConnected,()=>{var r;const a=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(s,l)=>{if(s.candidate){const u=new RTCIceCandidate(s);let h="".concat(u.protocol," ").concat(u.address,":").concat(u.port," ").concat(u.type);u.address&&(uE(u.address)?h+=" (private)":u.protocol==="tcp"&&u.tcpType==="passive"?(e=!0,h+=" (passive)"):u.protocol==="udp"&&(t=!0)),this.appendMessage(h)}a&&a(s,l)},!((r=this.room.engine.pcManager)===null||r===void 0)&&r.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=s=>{s instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(s.errorCode," ").concat(s.errorText," ").concat(s.url))})});try{yield this.connect(),ct.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function uE(n){const e=n.split(".");if(e.length===4){if(e[0]==="10"||e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class dE extends Ha{get description(){return"Connecting to signal connection via WebSocket"}perform(){return j(this,void 0,void 0,function*(){var e,t,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let a=new Jf;const s=yield a.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3,singlePeerConnection:!1});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===O0.Cloud&&!((t=s.serverInfo)===null||t===void 0)&&t.region&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield a.close()})}}class LR extends Oi.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=t,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:ai.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==ai.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return j(this,void 0,void 0,function*(){const t=this.getNextCheckId(),r=new e(this.url,this.token,this.options),a=l=>{this.updateCheck(t,l)};r.on("update",a);const s=yield r.run();return r.off("update",a),s})}checkWebsocket(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(dE)})}checkWebRTC(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(cE)})}checkTURN(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(lE)})}checkReconnect(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(sE)})}checkPublishAudio(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(aE)})}checkPublishVideo(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(oE)})}checkConnectionProtocol(){return j(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(iE);if(e.data&&"protocol"in e.data){const t=e.data;this.options.protocol=t.protocol}return e})}checkCloudRegion(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(rE)})}}function ft(n,e,t){return(e=pE(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hE(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function pE(n){var e=hE(n,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class Zn extends Error{constructor(e,t){var r;super(e,t),ft(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}}ft(Zn,"code","ERR_JOSE_GENERIC");class fE extends Zn{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:a,payload:t}}),ft(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),ft(this,"claim",void 0),ft(this,"reason",void 0),ft(this,"payload",void 0),this.claim=r,this.reason=a,this.payload=t}}ft(fE,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class mE extends Zn{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:a,payload:t}}),ft(this,"code","ERR_JWT_EXPIRED"),ft(this,"claim",void 0),ft(this,"reason",void 0),ft(this,"payload",void 0),this.claim=r,this.reason=a,this.payload=t}}ft(mE,"code","ERR_JWT_EXPIRED");class gE extends Zn{constructor(){super(...arguments),ft(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}ft(gE,"code","ERR_JOSE_ALG_NOT_ALLOWED");class vE extends Zn{constructor(){super(...arguments),ft(this,"code","ERR_JOSE_NOT_SUPPORTED")}}ft(vE,"code","ERR_JOSE_NOT_SUPPORTED");class bE extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWE_DECRYPTION_FAILED")}}ft(bE,"code","ERR_JWE_DECRYPTION_FAILED");class yE extends Zn{constructor(){super(...arguments),ft(this,"code","ERR_JWE_INVALID")}}ft(yE,"code","ERR_JWE_INVALID");class wE extends Zn{constructor(){super(...arguments),ft(this,"code","ERR_JWS_INVALID")}}ft(wE,"code","ERR_JWS_INVALID");class kE extends Zn{constructor(){super(...arguments),ft(this,"code","ERR_JWT_INVALID")}}ft(kE,"code","ERR_JWT_INVALID");class CE extends Zn{constructor(){super(...arguments),ft(this,"code","ERR_JWK_INVALID")}}ft(CE,"code","ERR_JWK_INVALID");class SE extends Zn{constructor(){super(...arguments),ft(this,"code","ERR_JWKS_INVALID")}}ft(SE,"code","ERR_JWKS_INVALID");class TE extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}ft(TE,"code","ERR_JWKS_NO_MATCHING_KEY");class xE extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,Symbol.asyncIterator,void 0),ft(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}ft(xE,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class EE extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWKS_TIMEOUT")}}ft(EE,"code","ERR_JWKS_TIMEOUT");class _E extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}ft(_E,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");GT("error");const PE=n=>{const e=new TextDecoder().decode(n);if(e!==null&&typeof e=="object")return e;try{const t=JSON.parse(e);if(t===null||typeof t!="object")throw new Error("Invalid parsed");return t}catch{return null}},$1=({handler:n,context:e,speakersEnabled:t,micEnabled:r})=>{const[a,s]=ve.useState("pending"),[l,u]=Fv(!1,100),[h,f]=Fv(!1,100),[g,C]=ve.useState([]),x=ve.useRef(null),T=ve.useRef(null),V=ve.useRef(null),[A,W]=ve.useState(null),U=ve.useCallback(async()=>{const O=x.current;O!=null&&(T.current!=null&&(T.current.stop(),T.current=null),V.current!=null&&(V.current.getTracks().forEach(D=>{D.stop()}),V.current=null),W(null),x.current=null,C([]),n.setRequestOverride(void 0),await O.disconnect())},[C,W,n]);ve.useEffect(()=>{const O=x.current;O!=null&&O.localParticipant.setMicrophoneEnabled(r)},[r]),ve.useEffect(()=>{if(A==null)return;const O=t?1:0;A.volume=O},[A,t]);const G=ve.useCallback(async()=>{s("pending");let O=null;try{O=await n.getVoiceCredentials(e)}catch{s("error");return}if(O==null)return;const D=Y=>{const z=Y.some(X=>X.isAgent),K=Y.some(X=>X.isLocal);f(z),u(K)},Q=Y=>{if(Y.kind===me.Kind.Audio){T.current=Y;const z=Y.attach();W(z),z.play()}},ie=Y=>{u(Y)};try{const Y=new Ws;x.current=Y,V.current=await navigator.mediaDevices.getUserMedia({audio:!0}),Y.on(Se.TrackSubscribed,Q),Y.on(Se.ActiveSpeakersChanged,D),Y.localParticipant.on(Le.IsSpeakingChanged,ie),Y.on(Se.MediaDevicesError,()=>{console.info("media devices error")}),Y.on(Se.Disconnected,()=>{s("terminated"),u(!1),f(!1),U()}),n.setRequestOverride(z=>{const K=new TextEncoder().encode(JSON.stringify(z.request));Y.localParticipant.publishData(K).catch(X=>{console.error("Failed to publish data to LiveKit:",X)})}),Y.on(Se.DataReceived,(z,K)=>{C(X=>[...X,{modalities:PE(z)??{},from:K==null?void 0:K.identity,timestamp:Date.now()}])}),await Y.connect(O.url,O.token,{autoSubscribe:!0}),await Y.localParticipant.setMicrophoneEnabled(!0),Y.startAudio(),s("active")}catch(Y){Y instanceof DOMException&&Y.name==="NotAllowedError"?s("noAudioPermissions"):s("error")}},[n,e,s,f,W,C,U,u]),F=async()=>{await U(),G()};return ve.useEffect(()=>(G(),()=>{U()}),[G,U]),{roomState:a,isUserSpeaking:l,isApplicationSpeaking:h,retry:F,modalities:g}},RE=ve.createContext(null),Tp={didCatch:!1,error:null};class K1 extends ve.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Tp}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,r,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];(t=(r=this.props).onReset)===null||t===void 0||t.call(r,{args:s,reason:"imperative-api"}),this.setState(Tp)}}componentDidCatch(e,t){var r,a;(r=(a=this.props).onError)===null||r===void 0||r.call(a,e,t)}componentDidUpdate(e,t){const{didCatch:r}=this.state,{resetKeys:a}=this.props;if(r&&t.error!==null&&IE(e.resetKeys,a)){var s,l;(s=(l=this.props).onReset)===null||s===void 0||s.call(l,{next:a,prev:e.resetKeys,reason:"keys"}),this.setState(Tp)}}render(){const{children:e,fallbackRender:t,FallbackComponent:r,fallback:a}=this.props,{didCatch:s,error:l}=this.state;let u=e;if(s){const h={error:l,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")u=t(h);else if(r)u=ve.createElement(r,h);else if(a!==void 0)u=a;else throw l}return ve.createElement(RE.Provider,{value:{didCatch:s,error:l,resetErrorBoundary:this.resetErrorBoundary}},u)}}function IE(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==e.length||n.some((t,r)=>!Object.is(t,e[r]))}const mc=({message:n})=>R.jsxs("div",{className:"bg-error-secondary text-error-primary text-base p-3 rounded-inner flex items-center gap-2",children:[R.jsx(Hy,{className:"w-4 h-4 flex-none"}),R.jsx("p",{className:"text-primary-80",children:n})]}),Uu=({className:n,children:e})=>R.jsx("div",{className:it("relative flex flex-col items-center justify-center",n),children:e}),J1=({className:n,modalities:e,renderedAsOverlay:t,modalityComponents:r,handler:a})=>{const s=ve.useRef(null),l=e.map(u=>{const h=Object.entries(u.modalities).map(([f,g])=>{const C=r[f];return C==null?null:{key:f,value:g,Component:C}}).filter(f=>f!=null);return h.length===0?null:R.jsx("div",{className:"space-y-2 last:h-full",children:h.map(({key:f,value:g,Component:C})=>R.jsx(C,{renderedAsOverlay:t,data:g,conversationHandler:a,enabled:!0},f))},u.timestamp)}).filter(Boolean);return ve.useEffect(()=>{const u=s.current;if(u==null)return;const h=u.lastChild;h instanceof HTMLElement&&h.scrollIntoView({behavior:"smooth"})},[l.length]),l.length===0?null:R.jsx("div",{className:n,ref:s,children:R.jsx(K1,{fallback:R.jsx(mc,{message:"Something went wrong"}),children:l})})},ME=({handler:n,speakersEnabled:e,colorMode:t,brandIcon:r,className:a,context:s,modalityComponents:l})=>{const[u,h]=ve.useState(!0),{roomState:f,isUserSpeaking:g,isApplicationSpeaking:C,retry:x,modalities:T}=$1({micEnabled:u,speakersEnabled:e,handler:n,context:s});return f==="pending"?R.jsx(Uu,{className:a,children:R.jsx(i0,{})}):f==="error"||f==="noAudioPermissions"?R.jsxs(Uu,{className:a,children:[R.jsx(n0,{}),R.jsx("div",{className:"w-full px-3 h-20 flex items-center",children:R.jsx(ra,{type:"ghost",label:"Retry",Icon:lc,onClick:()=>{x()}})})]}):f==="terminated"?R.jsx(Uu,{className:a,children:R.jsxs("div",{className:it("grow flex flex-col items-center justify-center gap-6 text-primary-80"),children:[R.jsx(oc,{className:"w-20 h-20 text-primary-20"}),R.jsxs("div",{className:"text-center",children:[R.jsx("h3",{className:"text-xl mb-2",children:"The conversation has ended"}),R.jsx("p",{children:"You can close this panel now or restart."})]})]})}):R.jsxs(Uu,{className:a,children:[R.jsxs("div",{className:"rounded-full w-fit relative",children:[R.jsx("div",{className:it("w-[128px] h-[128px] p-4 z-10 relative rounded-full overflow-hidden bg-cover bg-center",r!=null?"":t==="dark"?"bg-[rgb(40,41,47)]":"bg-[rgb(175,175,175)]"),style:r!=null?{backgroundImage:`url(${r})`}:{},children:r==null?R.jsx(oc,{className:"w-full h-full text-primary-40"}):null}),C?R.jsx(cc,{className:"rounded-full"}):null]}),R.jsx(J1,{className:"absolute p-4 top-0 left-0 right-0 bottom-[72px] z-10 space-y-2 max-h-full overflow-auto border-b border-solid border-primary-10",renderedAsOverlay:!0,modalities:T,modalityComponents:l,handler:n}),R.jsxs("div",{className:"w-fit flex-none absolute bottom-4 left-1/2 transform -translate-x-1/2 translate-y-0",children:[g?R.jsx(cc,{className:"rounded-inner"}):null,R.jsx(un,{Icon:u?sd:If,label:"Voice",type:u?"activated":"ghost",onClick:()=>{h(V=>!V)}})]})]})},$b=({onClose:n,handler:e,reset:t,className:r})=>R.jsxs("div",{className:it("p-2 md:p-3 flex flex-col grow justify-center gap-2",r),children:[R.jsx(ra,{label:"Restart conversation",Icon:lc,type:"ghost",onClick:t}),R.jsx(ra,{label:"Talk to an agent",Icon:By,type:"ghost",onClick:()=>{e.sendIntent("NLX.Escalation"),n()}})]});function rm(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Fo=rm();function Y1(n){Fo=n}const tc={exec:()=>null};function Rt(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(a,s)=>{let l=typeof s=="string"?s:s.source;return l=l.replace(Yn.caret,"$1"),t=t.replace(a,l),r},getRegex:()=>new RegExp(t,e)};return r}const Yn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},OE=/^(?:[ \t]*(?:\n|$))+/,AE=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,LE=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,kc=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,NE=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,X1=/(?:[*+-]|\d{1,9}[.)])/,Q1=Rt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,X1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),im=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,jE=/^[^\n]+/,am=/(?!\s*\])(?:\\.|[^\[\]\\])+/,DE=Rt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",am).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),FE=Rt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,X1).getRegex(),jd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",om=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,UE=Rt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",om).replace("tag",jd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Z1=Rt(im).replace("hr",kc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",jd).getRegex(),BE=Rt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Z1).getRegex(),sm={blockquote:BE,code:AE,def:DE,fences:LE,heading:NE,hr:kc,html:UE,lheading:Q1,list:FE,newline:OE,paragraph:Z1,table:tc,text:jE},Kb=Rt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",kc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",jd).getRegex(),VE={...sm,table:Kb,paragraph:Rt(im).replace("hr",kc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Kb).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",jd).getRegex()},HE={...sm,html:Rt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",om).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:tc,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Rt(im).replace("hr",kc).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Q1).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},qE=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,WE=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ew=/^( {2,}|\\)\n(?!\s*$)/,zE=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Dd=/[\p{P}\p{S}]/u,lm=/[\s\p{P}\p{S}]/u,tw=/[^\s\p{P}\p{S}]/u,GE=Rt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,lm).getRegex(),$E=/(?!~)[\p{P}\p{S}]/u,KE=/(?!~)[\s\p{P}\p{S}]/u,JE=/(?:[^\s\p{P}\p{S}]|~)/u,YE=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,XE=Rt(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,Dd).getRegex(),nw="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",QE=Rt(nw,"gu").replace(/notPunctSpace/g,tw).replace(/punctSpace/g,lm).replace(/punct/g,Dd).getRegex(),ZE=Rt(nw,"gu").replace(/notPunctSpace/g,JE).replace(/punctSpace/g,KE).replace(/punct/g,$E).getRegex(),e_=Rt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,tw).replace(/punctSpace/g,lm).replace(/punct/g,Dd).getRegex(),t_=Rt(/\\(punct)/,"gu").replace(/punct/g,Dd).getRegex(),n_=Rt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),r_=Rt(om).replace("(?:-->|$)","-->").getRegex(),i_=Rt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",r_).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),wd=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,a_=Rt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",wd).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),rw=Rt(/^!?\[(label)\]\[(ref)\]/).replace("label",wd).replace("ref",am).getRegex(),iw=Rt(/^!?\[(ref)\](?:\[\])?/).replace("ref",am).getRegex(),o_=Rt("reflink|nolink(?!\\()","g").replace("reflink",rw).replace("nolink",iw).getRegex(),cm={_backpedal:tc,anyPunctuation:t_,autolink:n_,blockSkip:YE,br:ew,code:WE,del:tc,emStrongLDelim:XE,emStrongRDelimAst:QE,emStrongRDelimUnd:e_,escape:qE,link:a_,nolink:iw,punctuation:GE,reflink:rw,reflinkSearch:o_,tag:i_,text:zE,url:tc},s_={...cm,link:Rt(/^!?\[(label)\]\((.*?)\)/).replace("label",wd).getRegex(),reflink:Rt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",wd).getRegex()},df={...cm,emStrongRDelimAst:ZE,url:Rt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},l_={...df,br:Rt(ew).replace("{2,}","*").getRegex(),text:Rt(df.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Bu={normal:sm,gfm:VE,pedantic:HE},Wl={normal:cm,gfm:df,breaks:l_,pedantic:s_},c_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Jb=n=>c_[n];function xi(n,e){if(e){if(Yn.escapeTest.test(n))return n.replace(Yn.escapeReplace,Jb)}else if(Yn.escapeTestNoEncode.test(n))return n.replace(Yn.escapeReplaceNoEncode,Jb);return n}function Yb(n){try{n=encodeURI(n).replace(Yn.percentDecode,"%")}catch{return null}return n}function Xb(n,e){var t;const r=n.replace(Yn.findPipe,(l,u,h)=>{let f=!1,g=u;for(;--g>=0&&h[g]==="\\";)f=!f;return f?"|":" |"}),a=r.split(Yn.splitPipe);let s=0;if(a[0].trim()||a.shift(),a.length>0&&!((t=a.at(-1))!=null&&t.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;s<a.length;s++)a[s]=a[s].trim().replace(Yn.slashPipe,"|");return a}function zl(n,e,t){const r=n.length;if(r===0)return"";let a=0;for(;a<r&&n.charAt(r-a-1)===e;)a++;return n.slice(0,r-a)}function u_(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function Qb(n,e,t,r,a){const s=e.href,l=e.title||null,u=n[1].replace(a.other.outputLinkReplace,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const h={type:"link",raw:t,href:s,title:l,text:u,tokens:r.inlineTokens(u)};return r.state.inLink=!1,h}return{type:"image",raw:t,href:s,title:l,text:u}}function d_(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const a=r[1];return e.split(`
`).map(s=>{const l=s.match(t.other.beginningSpace);if(l===null)return s;const[u]=l;return u.length>=a.length?s.slice(a.length):s}).join(`
`)}class kd{constructor(e){Ct(this,"options"),Ct(this,"rules"),Ct(this,"lexer"),this.options=e||Fo}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:zl(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],a=d_(r,t[3]||"",this.rules);return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:a}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(this.rules.other.endingHash.test(r)){const a=zl(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:zl(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=zl(t[0],`
`).split(`
`),a="",s="";const l=[];for(;r.length>0;){let u=!1;const h=[];let f;for(f=0;f<r.length;f++)if(this.rules.other.blockquoteStart.test(r[f]))h.push(r[f]),u=!0;else if(!u)h.push(r[f]);else break;r=r.slice(f);const g=h.join(`
`),C=g.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${g}`:g,s=s?`${s}
${C}`:C;const x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(C,l,!0),this.lexer.state.top=x,r.length===0)break;const T=l.at(-1);if((T==null?void 0:T.type)==="code")break;if((T==null?void 0:T.type)==="blockquote"){const V=T,A=V.raw+`
`+r.join(`
`),W=this.blockquote(A);l[l.length-1]=W,a=a.substring(0,a.length-V.raw.length)+W.raw,s=s.substring(0,s.length-V.text.length)+W.text;break}else if((T==null?void 0:T.type)==="list"){const V=T,A=V.raw+`
`+r.join(`
`),W=this.list(A);l[l.length-1]=W,a=a.substring(0,a.length-T.raw.length)+W.raw,s=s.substring(0,s.length-V.raw.length)+W.raw,r=A.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:l,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const a=r.length>1,s={type:"list",raw:"",ordered:a,start:a?+r.slice(0,-1):"",loose:!1,items:[]};r=a?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=a?r:"[*+-]");const l=this.rules.other.listItemRegex(r);let u=!1;for(;e;){let f=!1,g="",C="";if(!(t=l.exec(e))||this.rules.block.hr.test(e))break;g=t[0],e=e.substring(g.length);let x=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,G=>" ".repeat(3*G.length)),T=e.split(`
`,1)[0],V=!x.trim(),A=0;if(this.options.pedantic?(A=2,C=x.trimStart()):V?A=t[1].length+1:(A=t[2].search(this.rules.other.nonSpaceChar),A=A>4?1:A,C=x.slice(A),A+=t[1].length),V&&this.rules.other.blankLine.test(T)&&(g+=T+`
`,e=e.substring(T.length+1),f=!0),!f){const G=this.rules.other.nextBulletRegex(A),F=this.rules.other.hrRegex(A),O=this.rules.other.fencesBeginRegex(A),D=this.rules.other.headingBeginRegex(A),Q=this.rules.other.htmlBeginRegex(A);for(;e;){const ie=e.split(`
`,1)[0];let Y;if(T=ie,this.options.pedantic?(T=T.replace(this.rules.other.listReplaceNesting,"  "),Y=T):Y=T.replace(this.rules.other.tabCharGlobal,"    "),O.test(T)||D.test(T)||Q.test(T)||G.test(T)||F.test(T))break;if(Y.search(this.rules.other.nonSpaceChar)>=A||!T.trim())C+=`
`+Y.slice(A);else{if(V||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||O.test(x)||D.test(x)||F.test(x))break;C+=`
`+T}!V&&!T.trim()&&(V=!0),g+=ie+`
`,e=e.substring(ie.length+1),x=Y.slice(A)}}s.loose||(u?s.loose=!0:this.rules.other.doubleBlankLine.test(g)&&(u=!0));let W=null,U;this.options.gfm&&(W=this.rules.other.listIsTask.exec(C),W&&(U=W[0]!=="[ ] ",C=C.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:g,task:!!W,checked:U,loose:!1,text:C,tokens:[]}),s.raw+=g}const h=s.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let f=0;f<s.items.length;f++)if(this.lexer.state.top=!1,s.items[f].tokens=this.lexer.blockTokens(s.items[f].text,[]),!s.loose){const g=s.items[f].tokens.filter(x=>x.type==="space"),C=g.length>0&&g.some(x=>this.rules.other.anyLine.test(x.raw));s.loose=C}if(s.loose)for(let f=0;f<s.items.length;f++)s.items[f].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:a,title:s}}}table(e){var t;const r=this.rules.block.table.exec(e);if(!r||!this.rules.other.tableDelimiter.test(r[2]))return;const a=Xb(r[1]),s=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),l=(t=r[3])!=null&&t.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],u={type:"table",raw:r[0],header:[],align:[],rows:[]};if(a.length===s.length){for(const h of s)this.rules.other.tableAlignRight.test(h)?u.align.push("right"):this.rules.other.tableAlignCenter.test(h)?u.align.push("center"):this.rules.other.tableAlignLeft.test(h)?u.align.push("left"):u.align.push(null);for(let h=0;h<a.length;h++)u.header.push({text:a[h],tokens:this.lexer.inline(a[h]),header:!0,align:u.align[h]});for(const h of l)u.rows.push(Xb(h,u.header.length).map((f,g)=>({text:f,tokens:this.lexer.inline(f),header:!1,align:u.align[g]})));return u}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const l=zl(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{const l=u_(t[2],"()");if(l>-1){const u=(t[0].indexOf("!")===0?5:4)+t[1].length+l;t[2]=t[2].substring(0,l),t[0]=t[0].substring(0,u).trim(),t[3]=""}}let a=t[2],s="";if(this.options.pedantic){const l=this.rules.other.pedanticHrefTitle.exec(a);l&&(a=l[1],s=l[3])}else s=t[3]?t[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),Qb(t,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[a.toLowerCase()];if(!s){const l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return Qb(r,s,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let a=this.rules.inline.emStrongLDelim.exec(e);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){const s=[...a[0]].length-1;let l,u,h=s,f=0;const g=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(g.lastIndex=0,t=t.slice(-1*e.length+s);(a=g.exec(t))!=null;){if(l=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!l)continue;if(u=[...l].length,a[3]||a[4]){h+=u;continue}else if((a[5]||a[6])&&s%3&&!((s+u)%3)){f+=u;continue}if(h-=u,h>0)continue;u=Math.min(u,u+h+f);const C=[...a[0]][0].length,x=e.slice(0,s+a.index+C+u);if(Math.min(s,u)%2){const V=x.slice(1,-1);return{type:"em",raw:x,text:V,tokens:this.lexer.inlineTokens(V)}}const T=x.slice(2,-2);return{type:"strong",raw:x,text:T,tokens:this.lexer.inlineTokens(T)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(this.rules.other.newLineCharGlobal," ");const a=this.rules.other.nonSpaceChar.test(r),s=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&s&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,a;return t[2]==="@"?(r=t[1],a="mailto:"+r):(r=t[1],a=r),{type:"link",raw:t[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var t;let r;if(r=this.rules.inline.url.exec(e)){let a,s;if(r[2]==="@")a=r[0],s="mailto:"+a;else{let l;do l=r[0],r[0]=((t=this.rules.inline._backpedal.exec(r[0]))==null?void 0:t[0])??"";while(l!==r[0]);a=r[0],r[1]==="www."?s="http://"+r[0]:s=r[0]}return{type:"link",raw:r[0],text:a,href:s,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const r=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:r}}}}class Hr{constructor(e){Ct(this,"tokens"),Ct(this,"options"),Ct(this,"state"),Ct(this,"tokenizer"),Ct(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Fo,this.options.tokenizer=this.options.tokenizer||new kd,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Yn,block:Bu.normal,inline:Wl.normal};this.options.pedantic?(t.block=Bu.pedantic,t.inline=Wl.pedantic):this.options.gfm&&(t.block=Bu.gfm,this.options.breaks?t.inline=Wl.breaks:t.inline=Wl.gfm),this.tokenizer.rules=t}static get rules(){return{block:Bu,inline:Wl}}static lex(e,t){return new Hr(t).lex(e)}static lexInline(e,t){return new Hr(t).inlineTokens(e)}lex(e){e=e.replace(Yn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){var a,s,l;for(this.options.pedantic&&(e=e.replace(Yn.tabCharGlobal,"    ").replace(Yn.spaceLine,""));e;){let u;if((s=(a=this.options.extensions)==null?void 0:a.block)!=null&&s.some(f=>(u=f.call({lexer:this},e,t))?(e=e.substring(u.raw.length),t.push(u),!0):!1))continue;if(u=this.tokenizer.space(e)){e=e.substring(u.raw.length);const f=t.at(-1);u.raw.length===1&&f!==void 0?f.raw+=`
`:t.push(u);continue}if(u=this.tokenizer.code(e)){e=e.substring(u.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+u.raw,f.text+=`
`+u.text,this.inlineQueue.at(-1).src=f.text):t.push(u);continue}if(u=this.tokenizer.fences(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.heading(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.hr(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.blockquote(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.list(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.html(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.def(e)){e=e.substring(u.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+u.raw,f.text+=`
`+u.raw,this.inlineQueue.at(-1).src=f.text):this.tokens.links[u.tag]||(this.tokens.links[u.tag]={href:u.href,title:u.title});continue}if(u=this.tokenizer.table(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.lheading(e)){e=e.substring(u.raw.length),t.push(u);continue}let h=e;if((l=this.options.extensions)!=null&&l.startBlock){let f=1/0;const g=e.slice(1);let C;this.options.extensions.startBlock.forEach(x=>{C=x.call({lexer:this},g),typeof C=="number"&&C>=0&&(f=Math.min(f,C))}),f<1/0&&f>=0&&(h=e.substring(0,f+1))}if(this.state.top&&(u=this.tokenizer.paragraph(h))){const f=t.at(-1);r&&(f==null?void 0:f.type)==="paragraph"?(f.raw+=`
`+u.raw,f.text+=`
`+u.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(u),r=h.length!==e.length,e=e.substring(u.raw.length);continue}if(u=this.tokenizer.text(e)){e=e.substring(u.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=`
`+u.raw,f.text+=`
`+u.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(u);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var r,a,s;let l=e,u=null;if(this.tokens.links){const g=Object.keys(this.tokens.links);if(g.length>0)for(;(u=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)g.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(u=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(u=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,u.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let h=!1,f="";for(;e;){h||(f=""),h=!1;let g;if((a=(r=this.options.extensions)==null?void 0:r.inline)!=null&&a.some(x=>(g=x.call({lexer:this},e,t))?(e=e.substring(g.raw.length),t.push(g),!0):!1))continue;if(g=this.tokenizer.escape(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.tag(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.link(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(g.raw.length);const x=t.at(-1);g.type==="text"&&(x==null?void 0:x.type)==="text"?(x.raw+=g.raw,x.text+=g.text):t.push(g);continue}if(g=this.tokenizer.emStrong(e,l,f)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.codespan(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.br(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.del(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.autolink(e)){e=e.substring(g.raw.length),t.push(g);continue}if(!this.state.inLink&&(g=this.tokenizer.url(e))){e=e.substring(g.raw.length),t.push(g);continue}let C=e;if((s=this.options.extensions)!=null&&s.startInline){let x=1/0;const T=e.slice(1);let V;this.options.extensions.startInline.forEach(A=>{V=A.call({lexer:this},T),typeof V=="number"&&V>=0&&(x=Math.min(x,V))}),x<1/0&&x>=0&&(C=e.substring(0,x+1))}if(g=this.tokenizer.inlineText(C)){e=e.substring(g.raw.length),g.raw.slice(-1)!=="_"&&(f=g.raw.slice(-1)),h=!0;const x=t.at(-1);(x==null?void 0:x.type)==="text"?(x.raw+=g.raw,x.text+=g.text):t.push(g);continue}if(e){const x="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(x);break}else throw new Error(x)}}return t}}class Cd{constructor(e){Ct(this,"options"),Ct(this,"parser"),this.options=e||Fo}space(e){return""}code({text:e,lang:t,escaped:r}){var a;const s=(a=(t||"").match(Yn.notSpaceStart))==null?void 0:a[0],l=e.replace(Yn.endingNewline,"")+`
`;return s?'<pre><code class="language-'+xi(s)+'">'+(r?l:xi(l,!0))+`</code></pre>
`:"<pre><code>"+(r?l:xi(l,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,r=e.start;let a="";for(let u=0;u<e.items.length;u++){const h=e.items[u];a+=this.listitem(h)}const s=t?"ol":"ul",l=t&&r!==1?' start="'+r+'"':"";return"<"+s+l+`>
`+a+"</"+s+`>
`}listitem(e){var t;let r="";if(e.task){const a=this.checkbox({checked:!!e.checked});e.loose?((t=e.tokens[0])==null?void 0:t.type)==="paragraph"?(e.tokens[0].text=a+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=a+" "+xi(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:a+" ",text:a+" ",escaped:!0}):r+=a+" "}return r+=this.parser.parse(e.tokens,!!e.loose),`<li>${r}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let s=0;s<e.header.length;s++)r+=this.tablecell(e.header[s]);t+=this.tablerow({text:r});let a="";for(let s=0;s<e.rows.length;s++){const l=e.rows[s];r="";for(let u=0;u<l.length;u++)r+=this.tablecell(l[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+a+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${xi(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){const a=this.parser.parseInline(r),s=Yb(e);if(s===null)return a;e=s;let l='<a href="'+e+'"';return t&&(l+=' title="'+xi(t)+'"'),l+=">"+a+"</a>",l}image({href:e,title:t,text:r}){const a=Yb(e);if(a===null)return xi(r);e=a;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${xi(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:xi(e.text)}}class um{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class qr{constructor(e){Ct(this,"options"),Ct(this,"renderer"),Ct(this,"textRenderer"),this.options=e||Fo,this.options.renderer=this.options.renderer||new Cd,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new um}static parse(e,t){return new qr(t).parse(e)}static parseInline(e,t){return new qr(t).parseInline(e)}parse(e,t=!0){var r,a;let s="";for(let l=0;l<e.length;l++){const u=e[l];if((a=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&a[u.type]){const f=u,g=this.options.extensions.renderers[f.type].call({parser:this},f);if(g!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type)){s+=g||"";continue}}const h=u;switch(h.type){case"space":{s+=this.renderer.space(h);continue}case"hr":{s+=this.renderer.hr(h);continue}case"heading":{s+=this.renderer.heading(h);continue}case"code":{s+=this.renderer.code(h);continue}case"table":{s+=this.renderer.table(h);continue}case"blockquote":{s+=this.renderer.blockquote(h);continue}case"list":{s+=this.renderer.list(h);continue}case"html":{s+=this.renderer.html(h);continue}case"paragraph":{s+=this.renderer.paragraph(h);continue}case"text":{let f=h,g=this.renderer.text(f);for(;l+1<e.length&&e[l+1].type==="text";)f=e[++l],g+=`
`+this.renderer.text(f);t?s+=this.renderer.paragraph({type:"paragraph",raw:g,text:g,tokens:[{type:"text",raw:g,text:g,escaped:!0}]}):s+=g;continue}default:{const f='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return s}parseInline(e,t=this.renderer){var r,a;let s="";for(let l=0;l<e.length;l++){const u=e[l];if((a=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&a[u.type]){const f=this.options.extensions.renderers[u.type].call({parser:this},u);if(f!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(u.type)){s+=f||"";continue}}const h=u;switch(h.type){case"escape":{s+=t.text(h);break}case"html":{s+=t.html(h);break}case"link":{s+=t.link(h);break}case"image":{s+=t.image(h);break}case"strong":{s+=t.strong(h);break}case"em":{s+=t.em(h);break}case"codespan":{s+=t.codespan(h);break}case"br":{s+=t.br(h);break}case"del":{s+=t.del(h);break}case"text":{s+=t.text(h);break}default:{const f='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return s}}class nc{constructor(e){Ct(this,"options"),Ct(this,"block"),this.options=e||Fo}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Hr.lex:Hr.lexInline}provideParser(){return this.block?qr.parse:qr.parseInline}}Ct(nc,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class h_{constructor(...e){Ct(this,"defaults",rm()),Ct(this,"options",this.setOptions),Ct(this,"parse",this.parseMarkdown(!0)),Ct(this,"parseInline",this.parseMarkdown(!1)),Ct(this,"Parser",qr),Ct(this,"Renderer",Cd),Ct(this,"TextRenderer",um),Ct(this,"Lexer",Hr),Ct(this,"Tokenizer",kd),Ct(this,"Hooks",nc),this.use(...e)}walkTokens(e,t){var r,a;let s=[];for(const l of e)switch(s=s.concat(t.call(this,l)),l.type){case"table":{const u=l;for(const h of u.header)s=s.concat(this.walkTokens(h.tokens,t));for(const h of u.rows)for(const f of h)s=s.concat(this.walkTokens(f.tokens,t));break}case"list":{const u=l;s=s.concat(this.walkTokens(u.items,t));break}default:{const u=l;(a=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&a[u.type]?this.defaults.extensions.childTokens[u.type].forEach(h=>{const f=u[h].flat(1/0);s=s.concat(this.walkTokens(f,t))}):u.tokens&&(s=s.concat(this.walkTokens(u.tokens,t)))}}return s}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const l=t.renderers[s.name];l?t.renderers[s.name]=function(...u){let h=s.renderer.apply(this,u);return h===!1&&(h=l.apply(this,u)),h}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const l=t[s.level];l?l.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),a.extensions=t),r.renderer){const s=this.defaults.renderer||new Cd(this.defaults);for(const l in r.renderer){if(!(l in s))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;const u=l,h=r.renderer[u],f=s[u];s[u]=(...g)=>{let C=h.apply(s,g);return C===!1&&(C=f.apply(s,g)),C||""}}a.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new kd(this.defaults);for(const l in r.tokenizer){if(!(l in s))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;const u=l,h=r.tokenizer[u],f=s[u];s[u]=(...g)=>{let C=h.apply(s,g);return C===!1&&(C=f.apply(s,g)),C}}a.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new nc;for(const l in r.hooks){if(!(l in s))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;const u=l,h=r.hooks[u],f=s[u];nc.passThroughHooks.has(l)?s[u]=g=>{if(this.defaults.async)return Promise.resolve(h.call(s,g)).then(x=>f.call(s,x));const C=h.call(s,g);return f.call(s,C)}:s[u]=(...g)=>{let C=h.apply(s,g);return C===!1&&(C=f.apply(s,g)),C}}a.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,l=r.walkTokens;a.walkTokens=function(u){let h=[];return h.push(l.call(this,u)),s&&(h=h.concat(s.call(this,u))),h}}this.defaults={...this.defaults,...a}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Hr.lex(e,t??this.defaults)}parser(e,t){return qr.parse(e,t??this.defaults)}parseMarkdown(e){return(t,r)=>{const a={...r},s={...this.defaults,...a},l=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&a.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const u=s.hooks?s.hooks.provideLexer():e?Hr.lex:Hr.lexInline,h=s.hooks?s.hooks.provideParser():e?qr.parse:qr.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then(f=>u(f,s)).then(f=>s.hooks?s.hooks.processAllTokens(f):f).then(f=>s.walkTokens?Promise.all(this.walkTokens(f,s.walkTokens)).then(()=>f):f).then(f=>h(f,s)).then(f=>s.hooks?s.hooks.postprocess(f):f).catch(l);try{s.hooks&&(t=s.hooks.preprocess(t));let f=u(t,s);s.hooks&&(f=s.hooks.processAllTokens(f)),s.walkTokens&&this.walkTokens(f,s.walkTokens);let g=h(f,s);return s.hooks&&(g=s.hooks.postprocess(g)),g}catch(f){return l(f)}}}onError(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const a="<p>An error occurred:</p><pre>"+xi(r.message+"",!0)+"</pre>";return t?Promise.resolve(a):a}if(t)return Promise.reject(r);throw r}}}const jo=new h_;function St(n,e){return jo.parse(n,e)}St.options=St.setOptions=function(n){return jo.setOptions(n),St.defaults=jo.defaults,Y1(St.defaults),St};St.getDefaults=rm;St.defaults=Fo;St.use=function(...n){return jo.use(...n),St.defaults=jo.defaults,Y1(St.defaults),St};St.walkTokens=function(n,e){return jo.walkTokens(n,e)};St.parseInline=jo.parseInline;St.Parser=qr;St.parser=qr.parse;St.Renderer=Cd;St.TextRenderer=um;St.Lexer=Hr;St.lexer=Hr.lex;St.Tokenizer=kd;St.Hooks=nc;St.parse=St;St.options;St.setOptions;St.use;St.walkTokens;St.parseInline;qr.parse;Hr.lex;const p_="p-2.5 w-8 h-8 transition-colors rounded-inner relative z-10 overflow-hidden focus:outline-0",f_="text-primary-60 hover:bg-primary-10 focus:bg-primary-10 active:bg-secondary-20 disabled:text-primary-20",m_="bg-accent text-secondary-80 enabled:hover:before:bg-primary-40 focus:before:bg-primary-40 enabled:active:before:bg-secondary-10 disabled:bg-accent-20",xp=({onClick:n,type:e,label:t,className:r,Icon:a})=>{const s=n==null;return R.jsx("button",{onClick:s?void 0:n,disabled:s,"aria-label":t,className:it(p_,e==="main"?f_:null,e==="activated"?m_:null,r),children:R.jsx(a,{size:12})})},g_={comment:{state:"idle"},items:{}},As=(n,e)=>n.items[e]??{rating:null,commentSubmitted:!1,commentText:""},v_=(n,e)=>{var t,r;switch(e.type){case"CLICK_RATING":return{...n,items:{...n.items,[e.feedbackUrl]:{...As(n,e.feedbackUrl),rating:((t=n.items[e.feedbackUrl])==null?void 0:t.rating)==null?e.value:null}}};case"CLICK_COMMENT_BUTTON":const a=As(n,e.feedbackUrl);return a.commentSubmitted?{...n,comment:{state:"submitted",activeFeedbackUrl:e.feedbackUrl,text:a.commentText}}:{...n,comment:{state:"editing",activeFeedbackUrl:e.feedbackUrl,text:((r=n.items[e.feedbackUrl])==null?void 0:r.commentText)??""}};case"CLICK_COMMENT_EDIT":const s=As(n,e.feedbackUrl);return{...n,comment:{activeFeedbackUrl:e.feedbackUrl,state:"editing",text:s.commentText}};case"EDIT_COMMENT_TEXT":return{...n,comment:{activeFeedbackUrl:e.feedbackUrl,state:"editing",text:e.text}};case"SUBMIT_COMMENT":return{...n,comment:{activeFeedbackUrl:e.feedbackUrl,state:"submitting",text:n.comment.state==="editing"?n.comment.text:""}};case"CANCEL_COMMENT":return{...n,comment:{state:"idle"}};case"SUBMISSION_SUCCESS":if(n.comment.state!=="submitting")return n;const l=n.comment.activeFeedbackUrl;return{...n,comment:{activeFeedbackUrl:l,state:"submitted",text:n.comment.text},items:{...n.items,[l]:{...As(n,l),commentSubmitted:!0,commentText:n.comment.text}}};case"SUBMISSION_ERROR":return{...n,comment:{activeFeedbackUrl:n.comment.state==="submitting"?n.comment.activeFeedbackUrl:"",text:n.comment.state==="submitting"?n.comment.text:"",state:"error"}};default:throw new Error("Unknown action type")}},b_=(n,e,t)=>({clickRating:(r,a)=>{if(As(t,r).rating===a){n({type:"CLICK_RATING",value:a,feedbackUrl:r});return}e.submitFeedback(r,{rating:a}).then(()=>{n({type:"CLICK_RATING",value:a,feedbackUrl:r})}).catch(s=>{console.warn("Rating error",s)})},clickCommentButton:r=>{n({type:"CLICK_COMMENT_BUTTON",feedbackUrl:r})},clickCommentEdit:()=>{t.comment.state!=="idle"&&n({type:"CLICK_COMMENT_EDIT",feedbackUrl:t.comment.activeFeedbackUrl})},editCommentText:r=>{t.comment.state!=="idle"&&n({type:"EDIT_COMMENT_TEXT",text:r,feedbackUrl:t.comment.activeFeedbackUrl})},submitComment:async()=>{t.comment.state!=="idle"&&(n({type:"SUBMIT_COMMENT",feedbackUrl:t.comment.activeFeedbackUrl}),e.submitFeedback(t.comment.activeFeedbackUrl,{comment:t.comment.text}).then(()=>{n({type:"SUBMISSION_SUCCESS"})}).catch(()=>{n({type:"SUBMISSION_ERROR"})}))},cancelComment:()=>{n({type:"CANCEL_COMMENT"})}});function y_(n){const[e,t]=ve.useReducer(v_,g_);return[e,b_(t,n,e)]}const w_=({handler:n,message:e,responseIndex:t,messageIndex:r})=>e.choices.length>0?R.jsx("ul",{className:"space-y-2 max-h-[40vh] overflow-auto no-scrollbar",children:e.choices.map((a,s)=>e.selectedChoiceId==null||a.choiceId===e.selectedChoiceId?R.jsx("li",{className:"w-full",children:R.jsx(ra,{type:"ghost",Icon:Ed,onClick:e.selectedChoiceId==null?()=>{n.sendChoice(a.choiceId,{},{responseIndex:t,messageIndex:r})}:void 0,label:a.choiceText})},s):null)}):null,Ep=({text:n,bubble:e,files:t})=>R.jsxs("div",{className:"space-y-2",children:[R.jsx("div",{className:"flex justify-end pl-10 text-base",children:R.jsx("div",{className:it("text-primary-60 rounded-inner whitespace-pre-wrap",e?"bg-primary-5 p-3":""),children:n})}),t!=null?R.jsx("div",{className:"flex flex-wrap justify-end gap-2",children:t.map((r,a)=>R.jsx("img",{className:"rounded-inner h-20",src:URL.createObjectURL(r)},a))}):null]}),Zb=({text:n,number:e})=>R.jsxs("span",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"bg-primary-10 text-primary-60 text-xs px-1.5 py-0.5 rounded-inner",children:e}),n]}),k_=n=>{const e=new Map;return n.forEach((t,r)=>{const a={fileName:t.fileName,content:t.content,presignedUrl:t.presignedUrl,metadata:void 0,pageNumber:void 0},s=JSON.stringify(a),l=e.get(s);e.set(s,l==null?{source:a,indices:[r]}:{...l,indices:[...l.indices,r]})}),[...e.values()]},C_=({sources:n})=>{const[e,t]=ve.useState(!1),r=ve.useMemo(()=>k_(n),[n]);return r.length===0?null:R.jsxs("details",{className:"space-y-2",open:e,onToggle:a=>{t(a.currentTarget.open)},children:[R.jsxs("summary",{className:"flex cursor-pointer items-center gap-2 rounded-inner hover:bg-primary-5 text-primary-80",children:[R.jsx(YC,{type:"ghost",Icon:e?Ly:Ny}),"Sources"]}),R.jsx("ol",{className:"space-y-2",children:r.map(({source:a,indices:s},l)=>{const u=a.fileName??a.content??"Source",h="p-3 bg-primary-5 rounded-inner w-full flex items-center justify-between text-primary-80",f=s.map(g=>String(g+1)).join(", ");return R.jsx("li",{children:a.presignedUrl!=null?R.jsxs("a",{href:a.presignedUrl,className:it(h,"hover:bg-primary-10"),children:[R.jsx(Zb,{text:u,number:f}),R.jsx(Gy,{className:"w-4 h-4 text-primary-60"})]}):R.jsx("div",{className:h,children:R.jsx(Zb,{text:u,number:f})})},l)})})]})},S_=({feedbackUrl:n,feedbackConfig:e,feedbackState:t,feedbackActions:r})=>{const a=As(t,n);if(e.feedbackType.type==="binary"){const{positiveValue:s,negativeValue:l}=e.feedbackType.config;return R.jsx("div",{className:"mt-4",children:R.jsxs("div",{className:"flex items-center gap-0.5",children:[R.jsx("span",{className:"text-sm text-primary-60",children:e.question??"Was this response helpful?"}),a.rating==null||a.rating===s?R.jsx(xp,{type:a.rating===s?"activated":"main",label:e.labels.positive??"Yes",onClick:()=>{r.clickRating(n,s)},Icon:Wy}):null,a.rating==null||a.rating===l?R.jsx(xp,{type:a.rating===l?"activated":"main",label:e.labels.negative??"No",onClick:()=>{r.clickRating(n,l)},Icon:qy}):null,e.commentsEnabled?R.jsx(xp,{type:a.commentSubmitted?"activated":"main",label:e.labels.comment??"Add comment",onClick:()=>{r.clickCommentButton(n)},Icon:jy}):null]})})}else return null},T_=({responses:n,colorMode:e,chatMode:t,uploadedFiles:r,userMessageBubble:a,agentMessageBubble:s,lastApplicationResponseIndex:l,interimMessage:u,isWaiting:h,modalityComponents:f,handler:g,className:C,enabled:x,feedbackState:T,feedbackActions:V})=>{const A=ve.useRef(null),W=ve.useRef(null);return ve.useEffect(()=>{!t&&!h&&setTimeout(()=>{var U;(U=W.current)==null||U.scrollIntoView({behavior:"smooth"})})},[h,t]),ve.useEffect(()=>{var U;if(t){const G=(U=A.current)==null?void 0:U.lastChild;G instanceof HTMLElement&&G.scrollIntoView({behavior:"smooth"})}},[n.length,t]),R.jsxs("div",{className:it("relative",C),children:[R.jsx("div",{"data-theme":e==="dark"?"light":"dark",className:it("absolute inset-x-0 h-px top-0 bg-background opacity-[0.01] backdrop-blur-md")}),!t&&h?R.jsx(i0,{label:u??"Thinking",className:"absolute inset-0"}):null,R.jsxs("div",{className:it("absolute inset-0 p-2 md:p-3 overflow-y-auto no-scrollbar space-y-8",!t&&h?"opacity-0":"opacity-100"),ref:A,children:[n.map((U,G)=>{var F,O,D;if(U.type===Kn.User)return U.payload.type==="text"?R.jsx(Ep,{text:U.payload.text,bubble:a},G):U.payload.type==="structured"&&U.payload.utterance!=null&&U.payload.uploadIds!=null?R.jsx(Ep,{bubble:a,text:U.payload.utterance,files:U.payload.uploadIds.map(ie=>r[ie]).filter(ie=>ie!=null)},G):null;if(U.type===Kn.Failure)return R.jsx(mc,{message:U.payload.text},G);const Q=l!=null&&G===l;return R.jsxs(ve.Fragment,{children:[R.jsxs("div",{className:it("space-y-2",!t&&Q?"min-h-full":""),ref:Q?W:void 0,children:[U.payload.messages.map((ie,Y)=>R.jsx("div",{className:"text-base",children:R.jsx("div",{className:it("space-y-6 markdown",s?"p-3 w-fit bg-secondary-40 mr-10 rounded-inner":""),dangerouslySetInnerHTML:{__html:St(ie.text,{async:!1})}})},Y)),((F=U.payload.metadata)==null?void 0:F.sources)!=null?R.jsx(C_,{sources:U.payload.metadata.sources}):null,R.jsx(K1,{fallback:R.jsx(mc,{message:"Something went wrong"}),children:Object.entries(U.payload.modalities??{}).map(([ie,Y])=>{const z=f[ie];return z==null?(console.warn(`Custom component implementation missing for the ${ie} modality.`),null):R.jsx(z,{data:Y,conversationHandler:g,enabled:x},ie)})}),((O=U.payload.metadata)==null?void 0:O.feedbackConfig)!=null&&((D=U.payload.metadata)==null?void 0:D.feedbackUrl)!=null?R.jsx(S_,{feedbackUrl:U.payload.metadata.feedbackUrl,feedbackConfig:U.payload.metadata.feedbackConfig,feedbackState:T,feedbackActions:V}):null]}),U.payload.messages.map((ie,Y)=>{if(ie.selectedChoiceId!=null){const z=ie.choices.find(K=>K.choiceId===ie.selectedChoiceId);return z==null?null:R.jsx(Ep,{text:z.choiceText,bubble:a},Y)}return null})]},G)}),t&&h?R.jsx("div",{className:"text-primary-40 text-base shimmer w-fit",children:u??"Thinking"}):null]},"messages")]})};function hf(){return hf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},hf.apply(null,arguments)}function x_(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}var E_=ve.useLayoutEffect,__=function(n){var e=Mo.useRef(n);return E_(function(){e.current=n}),e},ey=function(n,e){if(typeof n=="function"){n(e);return}n.current=e},P_=function(n,e){var t=Mo.useRef();return Mo.useCallback(function(r){n.current=r,t.current&&ey(t.current,null),t.current=e,e&&ey(e,r)},[e])},ty={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},R_=function(n){Object.keys(ty).forEach(function(e){n.style.setProperty(e,ty[e],"important")})},ny=R_,zn=null,ry=function(n,e){var t=n.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?t+e.borderSize:t-e.paddingSize};function I_(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=1/0),zn||(zn=document.createElement("textarea"),zn.setAttribute("tabindex","-1"),zn.setAttribute("aria-hidden","true"),ny(zn)),zn.parentNode===null&&document.body.appendChild(zn);var a=n.paddingSize,s=n.borderSize,l=n.sizingStyle,u=l.boxSizing;Object.keys(l).forEach(function(x){var T=x;zn.style[T]=l[T]}),ny(zn),zn.value=e;var h=ry(zn,n);zn.value=e,h=ry(zn,n),zn.value="x";var f=zn.scrollHeight-a,g=f*t;u==="border-box"&&(g=g+a+s),h=Math.max(g,h);var C=f*r;return u==="border-box"&&(C=C+a+s),h=Math.min(C,h),[h,f]}var iy=function(){},M_=function(n,e){return n.reduce(function(t,r){return t[r]=e[r],t},{})},O_=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],A_=!!document.documentElement.currentStyle,L_=function(n){var e=window.getComputedStyle(n);if(e===null)return null;var t=M_(O_,e),r=t.boxSizing;if(r==="")return null;A_&&r==="border-box"&&(t.width=parseFloat(t.width)+parseFloat(t.borderRightWidth)+parseFloat(t.borderLeftWidth)+parseFloat(t.paddingRight)+parseFloat(t.paddingLeft)+"px");var a=parseFloat(t.paddingBottom)+parseFloat(t.paddingTop),s=parseFloat(t.borderBottomWidth)+parseFloat(t.borderTopWidth);return{sizingStyle:t,paddingSize:a,borderSize:s}},N_=L_;function aw(n,e,t){var r=__(t);ve.useLayoutEffect(function(){var a=function(s){return r.current(s)};if(n)return n.addEventListener(e,a),function(){return n.removeEventListener(e,a)}},[])}var j_=function(n){aw(window,"resize",n)},D_=function(n){aw(document.fonts,"loadingdone",n)},F_=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],U_=function(n,e){var t=n.cacheMeasurements,r=n.maxRows,a=n.minRows,s=n.onChange,l=s===void 0?iy:s,u=n.onHeightChange,h=u===void 0?iy:u,f=x_(n,F_),g=f.value!==void 0,C=ve.useRef(null),x=P_(C,e),T=ve.useRef(0),V=ve.useRef(),A=function(){var U=C.current,G=t&&V.current?V.current:N_(U);if(G){V.current=G;var F=I_(G,U.value||U.placeholder||"x",a,r),O=F[0],D=F[1];T.current!==O&&(T.current=O,U.style.setProperty("height",O+"px","important"),h(O,{rowHeight:D}))}},W=function(U){g||A(),l(U)};return ve.useLayoutEffect(A),j_(A),D_(A),ve.createElement("textarea",hf({},f,{onChange:W,ref:x}))},B_=ve.forwardRef(U_);const ay=8,V_=({className:n,handler:e,uploadUrl:t,onFileUpload:r,enabled:a})=>{const[s,l]=ve.useState(!1),[u,h]=ve.useState(""),[f,g]=ve.useState(null),[C,x]=ve.useState(null),T=ve.useRef(null),V=ve.useRef(null),A=t0("md");ve.useEffect(()=>{var Y;A&&((Y=V.current)==null||Y.focus())},[A]);const W=ve.useMemo(()=>u.trim()==="",[u]),[U,G]=ve.useState(!1),F=W&&C==null||U||!a,O=()=>{if(F)return;const Y=(z,K)=>{(K==null?void 0:K.type)===Kn.Application&&(G(!1),e.unsubscribe(Y),h(""),x(null),A&&setTimeout(()=>{var X;(X=V.current)==null||X.focus()}))};e.subscribe(Y),G(!0),t!=null&&C!=null?e.sendStructured({uploadIds:[t.uploadId],utterance:u}):e.sendText(u)},D=t!=null&&a,Q=()=>{g("Something went wrong. Please try again.")},ie=Y=>{var z,K;if(t==null){Q();return}const X=(K=(z=Y.target)==null?void 0:z.files)==null?void 0:K[0];if(X==null){Q();return}const{name:he,size:je,type:ce}=X;if(x({name:he,size:je,type:ce}),je/1024**2>ay){g(`The file is too big. Max file size: ${ay}mb`);return}fetch(t.url,{method:"PUT",headers:{"Content-Type":"image/jpeg"},body:X}).then(()=>{g(null),r({uploadId:t.uploadId,file:X})}).catch(()=>{Q()})};return R.jsx("div",{className:it("relative",n),children:R.jsxs("div",{className:it("bg-primary-5 transition-colors duration-200 p-2 rounded-outer text-base font-normal",s?"":"hover:bg-secondary-20"),children:[f!=null&&R.jsxs("div",{className:"flex items-center py-1 mb-2 w-full bg-error-secondary rounded-inner",children:[R.jsx(Ap,{size:16}),R.jsx("span",{className:"truncate ml-1",children:f})]}),C&&R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[R.jsxs("p",{className:"flex items-center truncate mx-2",children:[f!=null?R.jsx(Ap,{size:16,className:"text-error-primary"}):R.jsx(Rf,{size:16,className:"text-primary-60"}),R.jsx("span",{className:"truncate ml-3",children:C.name})]}),R.jsx(un,{className:"flex-none",Icon:Fy,label:"Delete",onClick:D?()=>{x(null),g(null),T.current!=null&&(T.current.value="")}:void 0,type:"ghost"})]}),R.jsx("hr",{className:"border-b-px border-background mb-2 -mx-2"})]}),R.jsxs("div",{className:it("flex items-end gap-1"),children:[D&&C==null?R.jsxs(R.Fragment,{children:[R.jsx("label",{htmlFor:"file-upload",className:"p-3 w-10 h-10 flex-none block transition-colors rounded-inner bg-primary-80 hover:bg-primary-80 text-secondary-80 cursor-pointer",children:R.jsx(Op,{})}),R.jsx("input",{type:"file",id:"file-upload",className:"sr-only",accept:".jpg, .jpeg, .png, .webp, .mp4, .mpeg4, .avi, .mov, .pdf",onChange:ie,ref:T})]}):R.jsx(un,{className:"flex-none",Icon:Op,label:"Upload file",type:"ghost"}),R.jsx(B_,{disabled:U||!a,className:it("h-10 w-full resize-none mr-2 px-2 py-2 outline-hidden","bg-transparent text-primary-80 placeholder:text-primary-40 caret-accent","disabled:text-primary-40"),placeholder:"Type something",maxRows:10,onFocus:()=>{l(!0)},onBlur:()=>{l(!1)},value:u,onChange:Y=>{h(Y.target.value)},onKeyDown:Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),O())},ref:V}),R.jsx(un,{className:"flex-none",label:"Send message",onClick:F?void 0:()=>{O()},type:"main",Icon:Ed})]})]})})},H_=n=>({"--font-family":n.fontFamily,"--radius-inner":n.innerBorderRadius,"--radius-outer":n.outerBorderRadius,"--color-primary-80":n.primary80,"--color-primary-60":n.primary60,"--color-primary-40":n.primary40,"--color-primary-20":n.primary20,"--color-primary-10":n.primary10,"--color-primary-5":n.primary5,"--color-primary-1":n.primary1,"--color-secondary-80":n.secondary80,"--color-secondary-60":n.secondary60,"--color-secondary-40":n.secondary40,"--color-secondary-20":n.secondary20,"--color-secondary-10":n.secondary10,"--color-secondary-5":n.secondary5,"--color-secondary-1":n.secondary1,"--color-accent":n.accent,"--color-accent-20":n.accent20,"--color-background":n.background,"--color-overlay":n.overlay,"--color-warning-primary":n.warningPrimary,"--color-warning-secondary":n.warningSecondary,"--color-error-primary":n.errorPrimary,"--color-error-secondary":n.errorSecondary}),q_={fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"light-dark(rgba(0, 2, 9, 0.8), rgba(255, 255, 255, 0.85))",primary60:"light-dark(rgba(0, 2, 9, 0.6), rgba(255, 255, 255, 0.65))",primary40:"light-dark(rgba(0, 2, 9, 0.4), rgba(255, 255, 255, 0.45))",primary20:"light-dark(rgba(0, 2, 9, 0.2), rgba(255, 255, 255, 0.25))",primary10:"light-dark(rgba(0, 2, 9, 0.1), rgba(255, 255, 255, 0.15))",primary5:"light-dark(rgba(0, 2, 9, 0.05), rgba(255, 255, 255, 0.08))",primary1:"light-dark(rgba(0, 2, 9, 0.01), rgba(255, 255, 255, 0.01))",secondary80:"light-dark(rgba(255, 255, 255, 0.85), rgba(0, 2, 9, 0.8))",secondary60:"light-dark(rgba(255, 255, 255, 0.65), rgba(0, 2, 9, 0.6))",secondary40:"light-dark(rgba(255, 255, 255, 0.45), rgba(0, 2, 9, 0.4))",secondary20:"light-dark(rgba(255, 255, 255, 0.25), rgba(0, 2, 9, 0.2))",secondary10:"light-dark(rgba(255, 255, 255, 0.15), rgba(0, 2, 9, 0.1))",secondary5:"light-dark(rgba(255, 255, 255, 0.08), rgba(0, 2, 9, 0.05))",secondary1:"light-dark(rgba(255, 255, 255, 0.01), rgba(0, 2, 9, 0.01))",accent:"light-dark(rgb(28, 99, 218), rgb(174, 202, 255))",accent20:"light-dark(rgba(28, 99, 218, 0.2), rgba(174, 202, 255, 0.25))",background:"light-dark(rgba(220, 220, 220, 0.9), rgba(0, 2, 9, 0.9))",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"light-dark(rgb(220, 159, 3), rgb(255, 214, 108))",warningSecondary:"light-dark(rgb(255, 242, 209), rgb(95, 65, 29))",errorPrimary:"light-dark(rgb(157, 3, 3), rgb(255, 133, 162))",errorSecondary:"light-dark(rgb(255, 223, 230), rgb(94, 4, 4))"},W_=n=>{const e={};return n.accent!=null&&n.accent20==null&&(e.accent20=`color-mix(in srgb, ${n.accent} 20%, transparent)`),n.primary80!=null&&(n.primary60==null&&(e.primary60=`rgb(from ${n.primary80} r g b / 0.6)`),n.primary40==null&&(e.primary40=`rgb(from ${n.primary80} r g b / 0.4)`),n.primary20==null&&(e.primary20=`rgb(from ${n.primary80} r g b / 0.2)`),n.primary10==null&&(e.primary10=`rgb(from ${n.primary80} r g b / 0.1)`),n.primary5==null&&(e.primary5=`rgb(from ${n.primary80} r g b / 0.05)`),n.primary1==null&&(e.primary1=`rgb(from ${n.primary80} r g b / 0.01)`)),n.secondary80!=null&&(n.secondary60==null&&(e.secondary60=`rgb(from ${n.secondary80} r g b / 0.6)`),n.secondary40==null&&(e.secondary40=`rgb(from ${n.secondary80} r g b / 0.4)`),n.secondary20==null&&(e.secondary20=`rgb(from ${n.secondary80} r g b / 0.2)`),n.secondary10==null&&(e.secondary10=`rgb(from ${n.secondary80} r g b / 0.1)`),n.secondary5==null&&(e.secondary5=`rgb(from ${n.secondary80} r g b / 0.05)`),n.secondary1==null&&(e.secondary1=`rgb(from ${n.secondary80} r g b / 0.01)`)),{...q_,...e,...n}},td=({colorMode:n,children:e,theme:t,className:r})=>{const a=W_(t??{});return R.jsx("div",{className:it(r,"font-sans"),style:{...H_(a),colorScheme:n},children:e})},ow="bg-background backdrop-blur-sm text-primary-80 rounded-outer p-2 w-[calc(100vw-16px)] max-w-[360px] space-y-4",oy=({children:n,renderCollapse:e,onClose:t})=>R.jsxs("div",{className:ow,children:[e&&R.jsx("div",{className:"flex items-center justify-end",children:R.jsx(un,{onClick:t,Icon:sc,type:"ghost",label:"Close"})}),n]}),sy=({children:n,className:e})=>R.jsx("div",{className:it("bg-background rounded-outer p-2 w-fit flex items-center gap-2",e),children:n}),z_=({handler:n,context:e,onClose:t,modalityComponents:r,renderCollapse:a,brandIcon:s})=>{const[l,u]=ve.useState(!0),[h,f]=ve.useState(!0),g=()=>{t(new Event("close"))},{roomState:C,isUserSpeaking:x,isApplicationSpeaking:T,retry:V,modalities:A}=$1({micEnabled:l,speakersEnabled:h,handler:n,context:e});if(C==="error")return R.jsxs(oy,{renderCollapse:a,onClose:g,children:[R.jsx(mc,{message:"I couldnt connect"}),R.jsx(ra,{type:"ghost",label:"Retry",Icon:lc,onClick:()=>{V()}})]});if(C==="noAudioPermissions")return R.jsxs(oy,{renderCollapse:a,onClose:g,children:[R.jsx(mc,{message:"Connect your microphone and speaker"}),R.jsx(ra,{type:"ghost",label:"Retry",Icon:lc,onClick:()=>{V()}})]});const W=s!=null?R.jsx("img",{className:"w-10 h-10 block flex-none object-contain object-center",src:s,role:"presentation"}):null;return C==="pending"?R.jsxs(sy,{className:"relative",children:[W,R.jsx(un,{Icon:sd,label:"Microphone",type:"ghost",className:"invisible"}),R.jsx(un,{Icon:ld,label:"Speakers",type:"ghost",className:"invisible"}),R.jsx(un,{Icon:sc,label:"Close",type:"ghost",className:"invisible"}),R.jsx("span",{className:"w-6 h-6 block text-accent absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:R.jsx(r0,{})})]}):R.jsxs(sy,{children:[W,R.jsxs("div",{className:"w-fit relative",children:[x?R.jsx(cc,{className:"rounded-inner"}):null,R.jsx(un,{Icon:l?sd:If,label:"Microphone",type:l?"activated":"ghost",onClick:()=>{u(U=>!U)}})]}),R.jsxs("div",{className:"w-fit relative",children:[T?R.jsx(cc,{className:"rounded-inner"}):null,R.jsx(un,{Icon:h?ld:Mf,label:"Speakers",type:h?"activated":"ghost",onClick:()=>{f(U=>!U)}})]}),R.jsx(un,{label:"Close",Icon:sc,type:"error",onClick:()=>{g()}}),R.jsx(J1,{className:it(ow,"absolute right-0 -top-2 transform translate-x-0 -translate-y-full max-h-[360px] overflow-auto"),renderedAsOverlay:!1,modalities:A,modalityComponents:r,handler:n})]})};var G_=Object.prototype.toString;function $_(n){return typeof n=="function"||G_.call(n)==="[object Function]"}function K_(n){var e=Number(n);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var J_=Math.pow(2,53)-1;function Y_(n){var e=K_(n);return Math.min(Math.max(e,0),J_)}function oi(n,e){var t=Array,r=Object(n);if(n==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var a=Y_(r.length),s=$_(t)?Object(new t(a)):new Array(a),l=0,u;l<a;)u=r[l],s[l]=u,l+=1;return s.length=a,s}function gc(n){"@babel/helpers - typeof";return gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gc(n)}function X_(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Q_(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,sw(r.key),r)}}function Z_(n,e,t){return e&&Q_(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function eP(n,e,t){return e=sw(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sw(n){var e=tP(n,"string");return gc(e)=="symbol"?e:e+""}function tP(n,e){if(gc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(gc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var nP=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];X_(this,n),eP(this,"items",void 0),this.items=e}return Z_(n,[{key:"add",value:function(e){return this.has(e)===!1&&this.items.push(e),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(e){var t=this.items.length;return this.items=this.items.filter(function(r){return r!==e}),t!==this.items.length}},{key:"forEach",value:function(e){var t=this;this.items.forEach(function(r){e(r,r,t)})}},{key:"has",value:function(e){return this.items.indexOf(e)!==-1}},{key:"size",get:function(){return this.items.length}}])}();const rP=typeof Set>"u"?Set:nP;function Fn(n){var e;return(e=n.localName)!==null&&e!==void 0?e:n.tagName.toLowerCase()}var iP={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},aP={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),none:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function oP(n,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-description","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(t){var r;return n.hasAttribute(t)&&!((r=aP[e])!==null&&r!==void 0&&r.has(t))})}function lw(n,e){return oP(n,e)}function sP(n){var e=cP(n);if(e===null||pf.indexOf(e)!==-1){var t=lP(n);if(pf.indexOf(e||"")===-1||lw(n,t||""))return t}return e}function lP(n){var e=iP[Fn(n)];if(e!==void 0)return e;switch(Fn(n)){case"a":case"area":case"link":if(n.hasAttribute("href"))return"link";break;case"img":return n.getAttribute("alt")===""&&!lw(n,"img")?"presentation":"img";case"input":{var t=n,r=t.type;switch(r){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return r;case"range":return"slider";case"email":case"tel":case"text":case"url":return n.hasAttribute("list")?"combobox":"textbox";case"search":return n.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return n.hasAttribute("multiple")||n.size>1?"listbox":"combobox"}return null}function cP(n){var e=n.getAttribute("role");if(e!==null){var t=e.trim().split(" ")[0];if(t.length>0)return t}return null}var pf=["presentation","none"];function Dt(n){return n!==null&&n.nodeType===n.ELEMENT_NODE}function cw(n){return Dt(n)&&Fn(n)==="caption"}function nd(n){return Dt(n)&&Fn(n)==="input"}function uP(n){return Dt(n)&&Fn(n)==="optgroup"}function dP(n){return Dt(n)&&Fn(n)==="select"}function hP(n){return Dt(n)&&Fn(n)==="table"}function pP(n){return Dt(n)&&Fn(n)==="textarea"}function fP(n){var e=n.ownerDocument===null?n:n.ownerDocument,t=e.defaultView;if(t===null)throw new TypeError("no window available");return t}function mP(n){return Dt(n)&&Fn(n)==="fieldset"}function gP(n){return Dt(n)&&Fn(n)==="legend"}function vP(n){return Dt(n)&&Fn(n)==="slot"}function bP(n){return Dt(n)&&n.ownerSVGElement!==void 0}function yP(n){return Dt(n)&&Fn(n)==="svg"}function wP(n){return bP(n)&&Fn(n)==="title"}function Sd(n,e){if(Dt(n)&&n.hasAttribute(e)){var t=n.getAttribute(e).split(" "),r=n.getRootNode?n.getRootNode():n.ownerDocument;return t.map(function(a){return r.getElementById(a)}).filter(function(a){return a!==null})}return[]}function na(n,e){return Dt(n)?e.indexOf(sP(n))!==-1:!1}function kP(n){return n.trim().replace(/\s\s+/g," ")}function CP(n,e){if(!Dt(n))return!1;if(n.hasAttribute("hidden")||n.getAttribute("aria-hidden")==="true")return!0;var t=e(n);return t.getPropertyValue("display")==="none"||t.getPropertyValue("visibility")==="hidden"}function SP(n){return na(n,["button","combobox","listbox","textbox"])||uw(n,"range")}function uw(n,e){if(!Dt(n))return!1;switch(e){case"range":return na(n,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function ly(n,e){var t=oi(n.querySelectorAll(e));return Sd(n,"aria-owns").forEach(function(r){t.push.apply(t,oi(r.querySelectorAll(e)))}),t}function TP(n){return dP(n)?n.selectedOptions||ly(n,"[selected]"):ly(n,'[aria-selected="true"]')}function xP(n){return na(n,pf)}function EP(n){return cw(n)}function _P(n){return na(n,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function PP(n){return!1}function RP(n){return nd(n)||pP(n)?n.value:n.textContent||""}function cy(n){var e=n.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function dw(n){var e=Fn(n);return e==="button"||e==="input"&&n.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function hw(n){if(dw(n))return n;var e=null;return n.childNodes.forEach(function(t){if(e===null&&Dt(t)){var r=hw(t);r!==null&&(e=r)}}),e}function IP(n){if(n.control!==void 0)return n.control;var e=n.getAttribute("for");return e!==null?n.ownerDocument.getElementById(e):hw(n)}function MP(n){var e=n.labels;if(e===null)return e;if(e!==void 0)return oi(e);if(!dw(n))return null;var t=n.ownerDocument;return oi(t.querySelectorAll("label")).filter(function(r){return IP(r)===n})}function OP(n){var e=n.assignedNodes();return e.length===0?oi(n.childNodes):e}function pw(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new rP,r=typeof Map>"u"?void 0:new Map,a=fP(n),s=e.compute,l=s===void 0?"name":s,u=e.computedStyleSupportsPseudoElements,h=u===void 0?e.getComputedStyle!==void 0:u,f=e.getComputedStyle,g=f===void 0?a.getComputedStyle.bind(a):f,C=e.hidden,x=C===void 0?!1:C,T=function(F,O){if(O!==void 0)throw new Error("use uncachedGetComputedStyle directly for pseudo elements");if(r===void 0)return g(F);var D=r.get(F);if(D)return D;var Q=g(F,O);return r.set(F,Q),Q};function V(F,O){var D="";if(Dt(F)&&h){var Q=g(F,"::before"),ie=cy(Q);D="".concat(ie," ").concat(D)}var Y=vP(F)?OP(F):oi(F.childNodes).concat(Sd(F,"aria-owns"));if(Y.forEach(function(X){var he=G(X,{isEmbeddedInLabel:O.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),je=Dt(X)?T(X).getPropertyValue("display"):"inline",ce=je!=="inline"?" ":"";D+="".concat(ce).concat(he).concat(ce)}),Dt(F)&&h){var z=g(F,"::after"),K=cy(z);D="".concat(D," ").concat(K)}return D.trim()}function A(F,O){var D=F.getAttributeNode(O);return D!==null&&!t.has(D)&&D.value.trim()!==""?(t.add(D),D.value):null}function W(F){return Dt(F)?A(F,"title"):null}function U(F){if(!Dt(F))return null;if(mP(F)){t.add(F);for(var O=oi(F.childNodes),D=0;D<O.length;D+=1){var Q=O[D];if(gP(Q))return G(Q,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(hP(F)){t.add(F);for(var ie=oi(F.childNodes),Y=0;Y<ie.length;Y+=1){var z=ie[Y];if(cw(z))return G(z,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(yP(F)){t.add(F);for(var K=oi(F.childNodes),X=0;X<K.length;X+=1){var he=K[X];if(wP(he))return he.textContent}return null}else if(Fn(F)==="img"||Fn(F)==="area"){var je=A(F,"alt");if(je!==null)return je}else if(uP(F)){var ce=A(F,"label");if(ce!==null)return ce}if(nd(F)&&(F.type==="button"||F.type==="submit"||F.type==="reset")){var de=A(F,"value");if(de!==null)return de;if(F.type==="submit")return"Submit";if(F.type==="reset")return"Reset"}var Me=MP(F);if(Me!==null&&Me.length!==0)return t.add(F),oi(Me).map(function(ke){return G(ke,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(ke){return ke.length>0}).join(" ");if(nd(F)&&F.type==="image"){var Re=A(F,"alt");if(Re!==null)return Re;var le=A(F,"title");return le!==null?le:"Submit Query"}if(na(F,["button"])){var Ee=V(F,{isEmbeddedInLabel:!1});if(Ee!=="")return Ee}return null}function G(F,O){if(t.has(F))return"";if(!x&&CP(F,T)&&!O.isReferenced)return t.add(F),"";var D=Dt(F)?F.getAttributeNode("aria-labelledby"):null,Q=D!==null&&!t.has(D)?Sd(F,"aria-labelledby"):[];if(l==="name"&&!O.isReferenced&&Q.length>0)return t.add(D),Q.map(function(je){return G(je,{isEmbeddedInLabel:O.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var ie=O.recursion&&SP(F)&&l==="name";if(!ie){var Y=(Dt(F)&&F.getAttribute("aria-label")||"").trim();if(Y!==""&&l==="name")return t.add(F),Y;if(!xP(F)){var z=U(F);if(z!==null)return t.add(F),z}}if(na(F,["menu"]))return t.add(F),"";if(ie||O.isEmbeddedInLabel||O.isReferenced){if(na(F,["combobox","listbox"])){t.add(F);var K=TP(F);return K.length===0?nd(F)?F.value:"":oi(K).map(function(je){return G(je,{isEmbeddedInLabel:O.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(uw(F,"range"))return t.add(F),F.hasAttribute("aria-valuetext")?F.getAttribute("aria-valuetext"):F.hasAttribute("aria-valuenow")?F.getAttribute("aria-valuenow"):F.getAttribute("value")||"";if(na(F,["textbox"]))return t.add(F),RP(F)}if(_P(F)||Dt(F)&&O.isReferenced||EP(F)||PP()){var X=V(F,{isEmbeddedInLabel:O.isEmbeddedInLabel});if(X!=="")return t.add(F),X}if(F.nodeType===F.TEXT_NODE)return t.add(F),F.textContent||"";if(O.recursion)return t.add(F),V(F,{isEmbeddedInLabel:O.isEmbeddedInLabel});var he=W(F);return he!==null?(t.add(F),he):(t.add(F),"")}return kP(G(n,{isEmbeddedInLabel:!1,isReferenced:l==="description",recursion:!1}))}function vc(n){"@babel/helpers - typeof";return vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vc(n)}function uy(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function dy(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uy(Object(t),!0).forEach(function(r){AP(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):uy(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function AP(n,e,t){return e=LP(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LP(n){var e=NP(n,"string");return vc(e)=="symbol"?e:e+""}function NP(n,e){if(vc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(vc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function hy(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=Sd(n,"aria-describedby").map(function(s){return pw(s,dy(dy({},e),{},{compute:"description"}))}).join(" ");if(t===""){var r=n.getAttribute("aria-description");t=r===null?"":r}if(t===""){var a=n.getAttribute("title");t=a===null?"":a}return t}function jP(n){return na(n,["caption","code","deletion","emphasis","generic","insertion","none","paragraph","presentation","strong","subscript","superscript"])}function ff(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return jP(n)?"":pw(n,e)}const DP=n=>n instanceof HTMLTextAreaElement?{value:n.value}:n.type==="checkbox"?{value:n.checked,options:[{value:!0,selected:n.checked,text:"checked"},{value:!1,selected:!n.checked,text:"unchecked"}]}:{value:n.value},FP=n=>{if(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement){const e=ff(n)??"";return{name:e===""?n.name:e,description:hy(n),type:n.type,placeholder:n.placeholder,...DP(n)}}else if(n instanceof HTMLSelectElement){const e=ff(n)??"";return{name:e===""?n.name:e,description:hy(n),type:n.type,value:n.value,options:Array.from(n.options).map(t=>({value:t.value,text:t.text,selected:t.selected}))}}throw new TypeError("Unsupported element type")},UP=()=>{const n=Array.from(document.querySelectorAll("input, textarea, select")).map((t,r)=>({index:r,id:`${t.tagName.toLowerCase()}-${r}`,element:t})),e={};return n.forEach(({id:t,element:r})=>{e[t]=r}),{context:n.map(({id:t,element:r})=>({id:t,...FP(r)})),formElements:e}},Kl=(n,...e)=>{console.debug(`[NLX V+] ${n}`,...e)},BP=(n,e=50,t=1/0)=>{let r=null,a=null,s=Promise.resolve();return(...l)=>{a??(a=Date.now());const u=()=>{s=s.then(async()=>{try{await n.apply(null,l)}catch{}}),a=null};r&&clearTimeout(r),Date.now()-a>t?u():r=setTimeout(()=>{u()},e)}},VP=(n,e,t,r)=>{let a={fields:[],destinations:[],actions:[]};const s=BP(async()=>{const{context:u,state:h}=t(HP(e));if(!Ef(a,u)){try{Kl("Automatic context sent:",u),await n.sendContext({"nlx:vpContext":u})}catch{}r(h),a=u}},50,300);s();const l=new MutationObserver(s);return l.observe(document.body,{subtree:!0,childList:!0,attributes:!0}),{teardown:()=>{l.disconnect()},onCustomCommandsChange:u=>{e=u,s()}}},HP=n=>{const{context:e,formElements:t}=UP(),{context:r,links:a}=qP();return{context:{uri:window.location.pathname,fields:e,destinations:r,actions:n.filter(s=>s.description!=null).map(s=>{const{handler:l,...u}=s;return u})},state:{formElements:t,links:a,customCommands:new Map(n.map(s=>[s.action,s.handler]))}}},qP=()=>{const n=Object.fromEntries(Jk(Array.from(document.querySelectorAll("a")).map(e=>[ff(e),e.getAttribute("href")??""])));return{context:Object.keys(n),links:n}},WP=(n,e,t)=>{const r=a=>{switch(Kl("Command received",a),a.classification){case"navigation":if(e.navigation!=null)e.navigation(a.action,a.destination,t.current.links);else if(e.automaticContext!==!1)switch(a.action){case"page_next":window.history.forward();break;case"page_previous":window.history.back();break;case"page_custom":if(a.destination!=null){const s=t.current.links[a.destination];if(s!=null)window.location.href=s;else try{new URL(a.destination),window.location.href=a.destination}catch{Kl('Custom page navigation action received, but no URL found for destination".',a.destination)}}break;case"page_unknown":Kl("Unknown page navigation action received, no automatic handling available.")}break;case"input":(e==null?void 0:e.input)!=null?e.input(a.fields,t.current.formElements):(e==null?void 0:e.automaticContext)!==!1&&a.fields.forEach(s=>{if(t.current.formElements[s.id]!=null){const l=t.current.formElements[s.id];typeof s.value=="string"?l.value=s.value:l instanceof HTMLInputElement&&l.type==="checkbox"&&(l.checked=s.value),l.classList.add("voice-updated"),l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0})),setTimeout(()=>{l.classList.remove("voice-updated")},2e3)}});break;case"custom":t.current.customCommands.has(a.action)&&t.current.customCommands.get(a.action)(a.payload),Kl(`No custom command handler was defined for the %o action.

%cTip: Set up a handler with 
setCustomBidirectionalCommands([{ action: "${a.action}", handler() { }}])`,a.action,"font-style: italic; font-size: 90%"),(e==null?void 0:e.custom)!=null&&(e.automaticContext!==!1&&console.warn("bidirectional.custom is deprecated in automatic context mode. Please use `setCustomBidirectionalCommands` instead."),e.custom(a.action,a.payload));break}};return n.addEventListener("voicePlusCommand",r),()=>{n.removeEventListener("voicePlusCommand",r)}};var mf={exports:{}},zP=mf.exports,py;function GP(){return py||(py=1,function(n,e){(function(t,r){n.exports=r()})(zP,()=>(()=>{var t=[,(l,u,h)=>{h.r(u),h.d(u,{default:()=>g});var f=(()=>{var C=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(x={}){var T=x,V,A;T.ready=new Promise((d,p)=>{V=d,A=p});function W(){function d(B){const $=k;v=p=0,k=new Map,$.forEach(ae=>{try{ae(B)}catch(Z){console.error(Z)}}),this.ob(),E&&E.Qb()}let p=0,v=0,k=new Map,E=null,I=null;this.requestAnimationFrame=function(B){p||(p=requestAnimationFrame(d.bind(this)));const $=++v;return k.set($,B),$},this.cancelAnimationFrame=function(B){k.delete(B),p&&k.size==0&&(cancelAnimationFrame(p),p=0)},this.Ob=function(B){I&&(document.body.remove(I),I=null),B||(I=document.createElement("div"),I.style.backgroundColor="black",I.style.position="fixed",I.style.right=0,I.style.top=0,I.style.color="white",I.style.padding="4px",I.innerHTML="RIVE FPS",B=function($){I.innerHTML="RIVE FPS "+$.toFixed(1)},document.body.appendChild(I)),E=new function(){let $=0,ae=0;this.Qb=function(){var Z=performance.now();ae?(++$,Z-=ae,1e3<Z&&(B(1e3*$/Z),$=ae=0)):(ae=Z,$=0)}}},this.ob=function(){}}function U(){console.assert(!0);const d=new Map;let p=-1/0;this.push=function(v){return v=v+255>>8,d.has(v)&&clearTimeout(d.get(v)),d.set(v,setTimeout(function(){d.delete(v),d.length==0?p=-1/0:v==p&&(p=Math.max(...d.keys()),console.assert(p<v))},1e3)),p=Math.max(v,p),p<<8}}const G=T.onRuntimeInitialized;T.onRuntimeInitialized=function(){G&&G();let d=T.decodeAudio;T.decodeAudio=function(E,I){E=d(E),I(E)};let p=T.decodeFont;T.decodeFont=function(E,I){E=p(E),I(E)};const v=T.FileAssetLoader;T.ptrToAsset=E=>{let I=T.ptrToFileAsset(E);return I.isImage?T.ptrToImageAsset(E):I.isFont?T.ptrToFontAsset(E):I.isAudio?T.ptrToAudioAsset(E):I},T.CustomFileAssetLoader=v.extend("CustomFileAssetLoader",{__construct:function({loadContents:E}){this.__parent.__construct.call(this),this.Eb=E},loadContents:function(E,I){return E=T.ptrToAsset(E),this.Eb(E,I)}}),T.CDNFileAssetLoader=v.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(E){let I=T.ptrToAsset(E);return E=I.cdnUuid,E===""?!1:(function(B,$){var ae=new XMLHttpRequest;ae.responseType="arraybuffer",ae.onreadystatechange=function(){ae.readyState==4&&ae.status==200&&$(ae)},ae.open("GET",B,!0),ae.send(null)}(I.cdnBaseUrl+"/"+E,B=>{I.decode(new Uint8Array(B.response))}),!0)}}),T.FallbackFileAssetLoader=v.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.kb=[]},addLoader:function(E){this.kb.push(E)},loadContents:function(E,I){for(let B of this.kb)if(B.loadContents(E,I))return!0;return!1}});let k=T.computeAlignment;T.computeAlignment=function(E,I,B,$,ae=1){return k.call(this,E,I,B,$,ae)}};const F=T.onRuntimeInitialized;T.onRuntimeInitialized=function(){function d(fe){this.F=fe,this.Db=fe.getContext("2d"),this.Gb=k,this.S=[],this.la=0,this.clear=function(){console.assert(this.la==0),this.S=[],E.delete(this)},this.save=function(){++this.la,this.S.push(k.save.bind(k))},this.restore=function(){0<this.la&&(this.S.push(k.restore.bind(k)),--this.la)},this.transform=function(Ie){this.S.push(k.transform.bind(k,Ie))},this.align=function(Ie,$e,Ye,tt,vt=1){this.S.push(k.align.bind(k,Ie,$e,Ye,tt,vt))},this.flush=function(){console.assert(this.la==0),E.add(this),k.$a||v()},this.delete=function(){}}function p(fe,Ie=!1){var $e={alpha:!0,depth:Ie,stencil:Ie,antialias:Ie,premultipliedAlpha:!0,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:!1,explicitSwapControl:0,renderViaOffscreenBackBuffer:0};if(Ie=fe.getContext("webgl2",$e),!Ie)return null;$e=Gd(Ie,$e),as($e);const Ye=I(fe.width,fe.height);Ye.Na=$e,Ye.F=fe,Ye.Oa=fe.width,Ye.ab=fe.height,Ye.T=Ie;var tt=Ye.delete;return Ye.delete=function(){tt.call(this);var vt=this.Na;br===Yt[vt]&&(br=null),typeof JSEvents=="object"&&JSEvents.Oc(Yt[vt].C.canvas),Yt[vt]&&Yt[vt].C.canvas&&(Yt[vt].C.canvas.Cb=void 0),this.Na=this.F=this.Oa=this.T=Yt[vt]=null},Ye}function v(){if(k){var fe=k.Fb,Ie=0,$e=0,Ye=0,tt=Array(E.size),vt=0;for(var It of E)It.ga=Math.min(It.F.width,fe),It.fa=Math.min(It.F.height,fe),It.La=It.fa*It.ga,Ie=Math.max(Ie,It.ga),$e=Math.max($e,It.fa),Ye+=It.La,tt[vt++]=It;if(E.clear(),!(0>=Ye)){for(Ie=1<<(0>=Ie?0:32-Math.clz32(Ie-1)),$e=1<<(0>=$e?0:32-Math.clz32($e-1));$e*Ie<Ye;)Ie<=$e?Ie*=2:$e*=2;for(Ie=Math.min(Ie,fe),Ie=Math.min($e,fe),tt.sort((Qr,Vi)=>Vi.La-Qr.La),Ye=new T.DynamicRectanizer(fe),It=0;It<tt.length;){for(Ye.reset(Ie,$e),vt=It;vt<tt.length;++vt){var At=tt[vt],_t=Ye.addRect(At.ga,At.fa);if(0>_t){console.assert(vt>It);break}At.ra=_t&65535,At.sa=_t>>16}for(At=ae.push(Ye.drawWidth()),_t=Z.push(Ye.drawHeight()),console.assert(At>=Ye.drawWidth()),console.assert(_t>=Ye.drawHeight()),console.assert(At<=fe),console.assert(_t<=fe),k.F.width!=At&&(k.F.width=At),k.F.height!=_t&&(k.F.height=_t),k.clear(),At=It;At<vt;++At){_t=tt[At],k.saveClipRect(_t.ra,_t.sa,_t.ra+_t.ga,_t.sa+_t.fa);let Qr=new T.Mat2D;Qr.xx=_t.ga/_t.F.width,Qr.yy=_t.fa/_t.F.height,Qr.xy=Qr.yx=0,Qr.tx=_t.ra,Qr.ty=_t.sa,k.transform(Qr);for(const Vi of _t.S)Vi();k.restoreClipRect(),_t.S=[]}for(k.flush();It<vt;++It)At=tt[It],_t=At.Db,_t.globalCompositeOperation="copy",_t.drawImage(k.F,At.ra,At.sa,At.ga,At.fa,0,0,At.F.width,At.F.height);It=vt}}}}F&&F();let k=null;const E=new Set,I=T.makeRenderer;T.makeRenderer=function(fe,Ie){if(!k){let $e=function(Ye){var tt=document.createElement("canvas");return tt.width=1,tt.height=1,k=p(tt,Ye),k.$a=!!k.T.getExtension("WEBGL_shader_pixel_local_storage"),k.Fb=Math.min(k.T.getParameter(k.T.MAX_RENDERBUFFER_SIZE),k.T.getParameter(k.T.MAX_TEXTURE_SIZE)),k.Ma=!k.$a,(Ye=k.T.getExtension("WEBGL_debug_renderer_info"))&&(tt=k.T.getParameter(Ye.UNMASKED_RENDERER_WEBGL),k.T.getParameter(Ye.UNMASKED_VENDOR_WEBGL).includes("Google")&&tt.includes("ANGLE Metal Renderer")&&(k.Ma=!1)),k};k=$e(!0),k.Ma||(k=$e(!1))}return Ie?new d(fe):p(fe,k.Ma)};const B=T.Artboard.prototype.delete;T.Artboard.prototype.delete=function(){this.Hb=!0,B.call(this)};const $=T.Artboard.prototype.draw;T.Artboard.prototype.draw=function(fe){fe.S?fe.S.push(()=>{this.Hb||$.call(this,fe.Gb)}):$.call(this,fe)};const ae=new U,Z=new U,Te=new W;T.requestAnimationFrame=Te.requestAnimationFrame.bind(Te),T.cancelAnimationFrame=Te.cancelAnimationFrame.bind(Te),T.enableFPSCounter=Te.Ob.bind(Te),Te.ob=v,T.resolveAnimationFrame=v;let Oe=T.load;T.load=function(fe,Ie,$e=!0){const Ye=new T.FallbackFileAssetLoader;return Ie!==void 0&&Ye.addLoader(Ie),$e&&(Ie=new T.CDNFileAssetLoader,Ye.addLoader(Ie)),Promise.resolve(Oe(fe,Ye))};const Ve=T.WebGL2Renderer.prototype.clear;T.WebGL2Renderer.prototype.clear=function(){as(this.Na);const fe=this.F;(this.Oa!=fe.width||this.ab!=fe.height)&&(this.resize(fe.width,fe.height),this.Oa=fe.width,this.ab=fe.height),Ve.call(this)},T.decodeImage=function(fe,Ie){fe=T.decodeWebGL2Image(fe),Ie(fe)};let te=T.Renderer.prototype.align;T.Renderer.prototype.align=function(fe,Ie,$e,Ye,tt=1){te.call(this,fe,Ie,$e,Ye,tt)}};var O=Object.assign({},T),D="./this.program",Q=typeof window=="object",ie=typeof importScripts=="function",Y="",z,K;(Q||ie)&&(ie?Y=self.location.href:typeof document<"u"&&document.currentScript&&(Y=document.currentScript.src),C&&(Y=C),Y.indexOf("blob:")!==0?Y=Y.substr(0,Y.replace(/[?#].*/,"").lastIndexOf("/")+1):Y="",ie&&(K=d=>{var p=new XMLHttpRequest;return p.open("GET",d,!1),p.responseType="arraybuffer",p.send(null),new Uint8Array(p.response)}),z=(d,p,v)=>{var k=new XMLHttpRequest;k.open("GET",d,!0),k.responseType="arraybuffer",k.onload=()=>{k.status==200||k.status==0&&k.response?p(k.response):v()},k.onerror=v,k.send(null)});var X=T.print||console.log.bind(console),he=T.printErr||console.error.bind(console);Object.assign(T,O),O=null,T.thisProgram&&(D=T.thisProgram);var je;T.wasmBinary&&(je=T.wasmBinary),T.noExitRuntime,typeof WebAssembly!="object"&&bn("no native wasm support detected");var ce,de,Me=!1,Re,le,Ee,ke,L,se,Ge,xe;function Ue(){var d=ce.buffer;T.HEAP8=Re=new Int8Array(d),T.HEAP16=Ee=new Int16Array(d),T.HEAP32=L=new Int32Array(d),T.HEAPU8=le=new Uint8Array(d),T.HEAPU16=ke=new Uint16Array(d),T.HEAPU32=se=new Uint32Array(d),T.HEAPF32=Ge=new Float32Array(d),T.HEAPF64=xe=new Float64Array(d)}var Ne,Ze=[],ze=[],dt=[];function Ot(){var d=T.preRun.shift();Ze.unshift(d)}var Wt=0,er=null;function bn(d){throw T.onAbort&&T.onAbort(d),d="Aborted("+d+")",he(d),Me=!0,d=new WebAssembly.RuntimeError(d+". Build with -sASSERTIONS for more info."),A(d),d}function Sr(d){return d.startsWith("data:application/octet-stream;base64,")}var Tr;if(Tr="webgl2_advanced.wasm",!Sr(Tr)){var oa=Tr;Tr=T.locateFile?T.locateFile(oa,Y):Y+oa}function Ai(d){if(d==Tr&&je)return new Uint8Array(je);if(K)return K(d);throw"both async and sync fetching of the wasm failed"}function Uo(d){if(!je&&(Q||ie)){if(typeof fetch=="function"&&!d.startsWith("file://"))return fetch(d,{credentials:"same-origin"}).then(p=>{if(!p.ok)throw"failed to load wasm binary file at '"+d+"'";return p.arrayBuffer()}).catch(()=>Ai(d));if(z)return new Promise((p,v)=>{z(d,k=>p(new Uint8Array(k)),v)})}return Promise.resolve().then(()=>Ai(d))}function yn(d,p,v){return Uo(d).then(k=>WebAssembly.instantiate(k,p)).then(k=>k).then(v,k=>{he("failed to asynchronously prepare wasm: "+k),bn(k)})}function Li(d,p){var v=Tr;return je||typeof WebAssembly.instantiateStreaming!="function"||Sr(v)||v.startsWith("file://")||typeof fetch!="function"?yn(v,d,p):fetch(v,{credentials:"same-origin"}).then(k=>WebAssembly.instantiateStreaming(k,d).then(p,function(E){return he("wasm streaming compile failed: "+E),he("falling back to ArrayBuffer instantiation"),yn(v,d,p)}))}var Un,Ni,Bo={534231:(d,p,v,k,E)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Ga:0},window.h.I={},window.h.I.Ea=d,window.h.I.capture=p,window.h.I.Ra=v,window.h.ja={},window.h.ja.stopped=k,window.h.ja.xb=E;let I=window.h;I.D=[],I.rc=function(B){for(var $=0;$<I.D.length;++$)if(I.D[$]==null)return I.D[$]=B,$;return I.D.push(B),I.D.length-1},I.Bb=function(B){for(I.D[B]=null;0<I.D.length&&I.D[I.D.length-1]==null;)I.D.pop()},I.Qc=function(B){for(var $=0;$<I.D.length;++$)if(I.D[$]==B)return I.Bb($)},I.va=function(B){return I.D[B]},I.Za=["touchend","click"],I.unlock=function(){for(var B=0;B<I.D.length;++B){var $=I.D[B];$!=null&&$.J!=null&&$.state===I.ja.xb&&$.J.resume().then(()=>{rr($.pb)},ae=>{console.error("Failed to resume audiocontext",ae)})}I.Za.map(function(ae){document.removeEventListener(ae,I.unlock,!0)})},I.Za.map(function(B){document.addEventListener(B,I.unlock,!0)})}return window.h.Ga+=1,1},536409:()=>{typeof window.h<"u"&&(window.h.Za.map(function(d){document.removeEventListener(d,window.h.unlock,!0)}),--window.h.Ga,window.h.Ga===0&&delete window.h)},536713:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,536817:()=>{try{var d=new(window.AudioContext||window.webkitAudioContext),p=d.sampleRate;return d.close(),p}catch{return 0}},536988:(d,p,v,k,E,I)=>{if(typeof window.h>"u")return-1;var B={},$={};return d==window.h.I.Ea&&v!=0&&($.sampleRate=v),B.J=new(window.AudioContext||window.webkitAudioContext)($),B.J.suspend(),B.state=window.h.ja.stopped,v=0,d!=window.h.I.Ea&&(v=p),B.Z=B.J.createScriptProcessor(k,v,p),B.Z.onaudioprocess=function(ae){if((B.wa==null||B.wa.length==0)&&(B.wa=new Float32Array(Ge.buffer,E,k*p)),d==window.h.I.capture||d==window.h.I.Ra){for(var Z=0;Z<p;Z+=1)for(var Te=ae.inputBuffer.getChannelData(Z),Oe=B.wa,Ve=0;Ve<k;Ve+=1)Oe[Ve*p+Z]=Te[Ve];ma(I,k,E)}if(d==window.h.I.Ea||d==window.h.I.Ra)for(fl(I,k,E),Z=0;Z<ae.outputBuffer.numberOfChannels;++Z)for(Te=ae.outputBuffer.getChannelData(Z),Oe=B.wa,Ve=0;Ve<k;Ve+=1)Te[Ve]=Oe[Ve*p+Z];else for(Z=0;Z<ae.outputBuffer.numberOfChannels;++Z)ae.outputBuffer.getChannelData(Z).fill(0)},d!=window.h.I.capture&&d!=window.h.I.Ra||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(ae){B.Ha=B.J.createMediaStreamSource(ae),B.Ha.connect(B.Z),B.Z.connect(B.J.destination)}).catch(function(ae){console.log("Failed to get user media: "+ae)}),d==window.h.I.Ea&&B.Z.connect(B.J.destination),B.pb=I,window.h.rc(B)},539865:d=>window.h.va(d).J.sampleRate,539938:d=>{d=window.h.va(d),d.Z!==void 0&&(d.Z.onaudioprocess=function(){},d.Z.disconnect(),d.Z=void 0),d.Ha!==void 0&&(d.Ha.disconnect(),d.Ha=void 0),d.J.close(),d.J=void 0,d.pb=void 0},540338:d=>{window.h.Bb(d)},540388:d=>{d=window.h.va(d),d.J.resume(),d.state=window.h.ja.xb},540527:d=>{d=window.h.va(d),d.J.suspend(),d.state=window.h.ja.stopped}},P=d=>{for(;0<d.length;)d.shift()(T)},y=(d,p)=>{for(var v=0,k=d.length-1;0<=k;k--){var E=d[k];E==="."?d.splice(k,1):E===".."?(d.splice(k,1),v++):v&&(d.splice(k,1),v--)}if(p)for(;v;v--)d.unshift("..");return d},S=d=>{var p=d.charAt(0)==="/",v=d.substr(-1)==="/";return(d=y(d.split("/").filter(k=>!!k),!p).join("/"))||p||(d="."),d&&v&&(d+="/"),(p?"/":"")+d},M=d=>{var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(d).slice(1);return d=p[0],p=p[1],!d&&!p?".":(p&&(p=p.substr(0,p.length-1)),d+p)},J=d=>{if(d==="/")return"/";d=S(d),d=d.replace(/\/$/,"");var p=d.lastIndexOf("/");return p===-1?d:d.substr(p+1)},ue=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return d=>crypto.getRandomValues(d);bn("initRandomDevice")},be=d=>(be=ue())(d);function Je(){for(var d="",p=!1,v=arguments.length-1;-1<=v&&!p;v--){if(p=0<=v?arguments[v]:"/",typeof p!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!p)return"";d=p+"/"+d,p=p.charAt(0)==="/"}return d=y(d.split("/").filter(k=>!!k),!p).join("/"),(p?"/":"")+d||"."}var at=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,De=(d,p,v)=>{var k=p+v;for(v=p;d[v]&&!(v>=k);)++v;if(16<v-p&&d.buffer&&at)return at.decode(d.subarray(p,v));for(k="";p<v;){var E=d[p++];if(E&128){var I=d[p++]&63;if((E&224)==192)k+=String.fromCharCode((E&31)<<6|I);else{var B=d[p++]&63;E=(E&240)==224?(E&15)<<12|I<<6|B:(E&7)<<18|I<<12|B<<6|d[p++]&63,65536>E?k+=String.fromCharCode(E):(E-=65536,k+=String.fromCharCode(55296|E>>10,56320|E&1023))}}else k+=String.fromCharCode(E)}return k},st=[],Tt=d=>{for(var p=0,v=0;v<d.length;++v){var k=d.charCodeAt(v);127>=k?p++:2047>=k?p+=2:55296<=k&&57343>=k?(p+=4,++v):p+=3}return p},zt=(d,p,v,k)=>{if(!(0<k))return 0;var E=v;k=v+k-1;for(var I=0;I<d.length;++I){var B=d.charCodeAt(I);if(55296<=B&&57343>=B){var $=d.charCodeAt(++I);B=65536+((B&1023)<<10)|$&1023}if(127>=B){if(v>=k)break;p[v++]=B}else{if(2047>=B){if(v+1>=k)break;p[v++]=192|B>>6}else{if(65535>=B){if(v+2>=k)break;p[v++]=224|B>>12}else{if(v+3>=k)break;p[v++]=240|B>>18,p[v++]=128|B>>12&63}p[v++]=128|B>>6&63}p[v++]=128|B&63}}return p[v]=0,v-E};function xt(d,p){var v=Array(Tt(d)+1);return d=zt(d,v,0,v.length),p&&(v.length=d),v}var Bn=[];function Pn(d,p){Bn[d]={input:[],G:[],V:p},qo(d,wn)}var wn={open:function(d){var p=Bn[d.node.Fa];if(!p)throw new Fe(43);d.s=p,d.seekable=!1},close:function(d){d.s.V.ua(d.s)},ua:function(d){d.s.V.ua(d.s)},read:function(d,p,v,k){if(!d.s||!d.s.V.jb)throw new Fe(60);for(var E=0,I=0;I<k;I++){try{var B=d.s.V.jb(d.s)}catch{throw new Fe(29)}if(B===void 0&&E===0)throw new Fe(6);if(B==null)break;E++,p[v+I]=B}return E&&(d.node.timestamp=Date.now()),E},write:function(d,p,v,k){if(!d.s||!d.s.V.Ua)throw new Fe(60);try{for(var E=0;E<k;E++)d.s.V.Ua(d.s,p[v+E])}catch{throw new Fe(29)}return k&&(d.node.timestamp=Date.now()),E}},en={jb:function(){e:{if(!st.length){var d=null;if(typeof window<"u"&&typeof window.prompt=="function"?(d=window.prompt("Input: "),d!==null&&(d+=`
`)):typeof readline=="function"&&(d=readline(),d!==null&&(d+=`
`)),!d){d=null;break e}st=xt(d,!0)}d=st.shift()}return d},Ua:function(d,p){p===null||p===10?(X(De(d.G,0)),d.G=[]):p!=0&&d.G.push(p)},ua:function(d){d.G&&0<d.G.length&&(X(De(d.G,0)),d.G=[])},$b:function(){return{xc:25856,zc:5,wc:191,yc:35387,vc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ac:function(){return 0},bc:function(){return[24,80]}},rn={Ua:function(d,p){p===null||p===10?(he(De(d.G,0)),d.G=[]):p!=0&&d.G.push(p)},ua:function(d){d.G&&0<d.G.length&&(he(De(d.G,0)),d.G=[])}};function xr(d,p){var v=d.j?d.j.length:0;v>=p||(p=Math.max(p,v*(1048576>v?2:1.125)>>>0),v!=0&&(p=Math.max(p,256)),v=d.j,d.j=new Uint8Array(p),0<d.v&&d.j.set(v.subarray(0,d.v),0))}var et={O:null,U(){return et.createNode(null,"/",16895,0)},createNode(d,p,v,k){if((v&61440)===24576||(v&61440)===4096)throw new Fe(63);return et.O||(et.O={dir:{node:{Y:et.l.Y,P:et.l.P,ma:et.l.ma,Ca:et.l.Ca,vb:et.l.vb,Ab:et.l.Ab,wb:et.l.wb,tb:et.l.tb,Ia:et.l.Ia},stream:{ba:et.m.ba}},file:{node:{Y:et.l.Y,P:et.l.P},stream:{ba:et.m.ba,read:et.m.read,write:et.m.write,ta:et.m.ta,lb:et.m.lb,nb:et.m.nb}},link:{node:{Y:et.l.Y,P:et.l.P,na:et.l.na},stream:{}},bb:{node:{Y:et.l.Y,P:et.l.P},stream:_c}}),v=Sc(d,p,v,k),(v.mode&61440)===16384?(v.l=et.O.dir.node,v.m=et.O.dir.stream,v.j={}):(v.mode&61440)===32768?(v.l=et.O.file.node,v.m=et.O.file.stream,v.v=0,v.j=null):(v.mode&61440)===40960?(v.l=et.O.link.node,v.m=et.O.link.stream):(v.mode&61440)===8192&&(v.l=et.O.bb.node,v.m=et.O.bb.stream),v.timestamp=Date.now(),d&&(d.j[p]=v,d.timestamp=v.timestamp),v},Ec(d){return d.j?d.j.subarray?d.j.subarray(0,d.v):new Uint8Array(d.j):new Uint8Array(0)},l:{Y(d){var p={};return p.Cc=(d.mode&61440)===8192?d.id:1,p.Gc=d.id,p.mode=d.mode,p.Lc=1,p.uid=0,p.Fc=0,p.Fa=d.Fa,(d.mode&61440)===16384?p.size=4096:(d.mode&61440)===32768?p.size=d.v:(d.mode&61440)===40960?p.size=d.link.length:p.size=0,p.tc=new Date(d.timestamp),p.Jc=new Date(d.timestamp),p.Ac=new Date(d.timestamp),p.Ib=4096,p.uc=Math.ceil(p.size/p.Ib),p},P(d,p){if(p.mode!==void 0&&(d.mode=p.mode),p.timestamp!==void 0&&(d.timestamp=p.timestamp),p.size!==void 0&&(p=p.size,d.v!=p))if(p==0)d.j=null,d.v=0;else{var v=d.j;d.j=new Uint8Array(p),v&&d.j.set(v.subarray(0,Math.min(p,d.v))),d.v=p}},ma(){throw $s[44]},Ca(d,p,v,k){return et.createNode(d,p,v,k)},vb(d,p,v){if((d.mode&61440)===16384){try{var k=sa(p,v)}catch{}if(k)for(var E in k.j)throw new Fe(55)}delete d.parent.j[d.name],d.parent.timestamp=Date.now(),d.name=v,p.j[v]=d,p.timestamp=d.parent.timestamp,d.parent=p},Ab(d,p){delete d.j[p],d.timestamp=Date.now()},wb(d,p){var v=sa(d,p),k;for(k in v.j)throw new Fe(55);delete d.j[p],d.timestamp=Date.now()},tb(d){var p=[".",".."],v;for(v in d.j)d.j.hasOwnProperty(v)&&p.push(v);return p},Ia(d,p,v){return d=et.createNode(d,p,41471,0),d.link=v,d},na(d){if((d.mode&61440)!==40960)throw new Fe(28);return d.link}},m:{read(d,p,v,k,E){var I=d.node.j;if(E>=d.node.v)return 0;if(d=Math.min(d.node.v-E,k),8<d&&I.subarray)p.set(I.subarray(E,E+d),v);else for(k=0;k<d;k++)p[v+k]=I[E+k];return d},write(d,p,v,k,E,I){if(p.buffer===Re.buffer&&(I=!1),!k)return 0;if(d=d.node,d.timestamp=Date.now(),p.subarray&&(!d.j||d.j.subarray)){if(I)return d.j=p.subarray(v,v+k),d.v=k;if(d.v===0&&E===0)return d.j=p.slice(v,v+k),d.v=k;if(E+k<=d.v)return d.j.set(p.subarray(v,v+k),E),k}if(xr(d,E+k),d.j.subarray&&p.subarray)d.j.set(p.subarray(v,v+k),E);else for(I=0;I<k;I++)d.j[E+I]=p[v+I];return d.v=Math.max(d.v,E+k),k},ba(d,p,v){if(v===1?p+=d.position:v===2&&(d.node.mode&61440)===32768&&(p+=d.node.v),0>p)throw new Fe(28);return p},ta(d,p,v){xr(d.node,p+v),d.node.v=Math.max(d.node.v,p+v)},lb(d,p,v,k,E){if((d.node.mode&61440)!==32768)throw new Fe(43);if(d=d.node.j,E&2||d.buffer!==Re.buffer){if((0<v||v+p<d.length)&&(d.subarray?d=d.subarray(v,v+p):d=Array.prototype.slice.call(d,v,v+p)),v=!0,bn(),p=void 0,!p)throw new Fe(48);Re.set(d,p)}else v=!1,p=d.byteOffset;return{o:p,M:v}},nb(d,p,v,k){return et.m.write(d,p,0,k,v,!1),0}}};function Er(d,p){var v=0;return d&&(v|=365),p&&(v|=146),v}var Vn=null,ht={},Hn=[],Cc=1,Wr=null,Vo=!0,Fe=null,$s={},pr=(d,p={})=>{if(d=Je(d),!d)return{path:"",node:null};if(p=Object.assign({hb:!0,Wa:0},p),8<p.Wa)throw new Fe(32);d=d.split("/").filter(B=>!!B);for(var v=Vn,k="/",E=0;E<d.length;E++){var I=E===d.length-1;if(I&&p.parent)break;if(v=sa(v,d[E]),k=S(k+"/"+d[E]),v.Da&&(!I||I&&p.hb)&&(v=v.Da.root),!I||p.gb){for(I=0;(v.mode&61440)===40960;)if(v=Ut(k),k=Je(M(k),v),v=pr(k,{Wa:p.Wa+1}).node,40<I++)throw new Fe(32)}}return{path:k,node:v}},qa=d=>{for(var p;;){if(d===d.parent)return d=d.U.mb,p?d[d.length-1]!=="/"?`${d}/${p}`:d+p:d;p=p?`${d.name}/${p}`:d.name,d=d.parent}},Wa=(d,p)=>{for(var v=0,k=0;k<p.length;k++)v=(v<<5)-v+p.charCodeAt(k)|0;return(d+v>>>0)%Wr.length},sa=(d,p)=>{var v;if(v=(v=Ho(d,"x"))?v:d.l.ma?0:2)throw new Fe(v,d);for(v=Wr[Wa(d.id,p)];v;v=v.ec){var k=v.name;if(v.parent.id===d.id&&k===p)return v}return d.l.ma(d,p)},Sc=(d,p,v,k)=>(d=new os(d,p,v,k),p=Wa(d.parent.id,d.name),d.ec=Wr[p],Wr[p]=d),Tc=d=>{var p=["r","w","rw"][d&3];return d&512&&(p+="w"),p},Ho=(d,p)=>{if(Vo)return 0;if(!p.includes("r")||d.mode&292){if(p.includes("w")&&!(d.mode&146)||p.includes("x")&&!(d.mode&73))return 2}else return 2;return 0},di=(d,p)=>{try{return sa(d,p),20}catch{}return Ho(d,"wx")},xc=()=>{for(var d=0;4096>=d;d++)if(!Hn[d])return d;throw new Fe(33)},zr=d=>{if(d=Hn[d],!d)throw new Fe(8);return d},Ec=(d,p=-1)=>(Rn||(Rn=function(){this.h={}},Rn.prototype={},Object.defineProperties(Rn.prototype,{object:{get(){return this.node},set(v){this.node=v}},flags:{get(){return this.h.flags},set(v){this.h.flags=v}},position:{get(){return this.h.position},set(v){this.h.position=v}}})),d=Object.assign(new Rn,d),p==-1&&(p=xc()),d.X=p,Hn[p]=d),_c={open:d=>{d.m=ht[d.node.Fa].m,d.m.open&&d.m.open(d)},ba:()=>{throw new Fe(70)}},qo=(d,p)=>{ht[d]={m:p}},Ks=(d,p)=>{var v=p==="/",k=!p;if(v&&Vn)throw new Fe(10);if(!v&&!k){var E=pr(p,{hb:!1});if(p=E.path,E=E.node,E.Da)throw new Fe(10);if((E.mode&61440)!==16384)throw new Fe(54)}p={type:d,Nc:{},mb:p,dc:[]},d=d.U(p),d.U=p,p.root=d,v?Vn=d:E&&(E.Da=p,E.U&&E.U.dc.push(p))},tr=(d,p,v)=>{var k=pr(d,{parent:!0}).node;if(d=J(d),!d||d==="."||d==="..")throw new Fe(28);var E=di(k,d);if(E)throw new Fe(E);if(!k.l.Ca)throw new Fe(63);return k.l.Ca(k,d,p,v)},Wo=(d,p,v)=>{typeof v>"u"&&(v=p,p=438),tr(d,p|8192,v)},Js=(d,p)=>{if(!Je(d))throw new Fe(44);var v=pr(p,{parent:!0}).node;if(!v)throw new Fe(44);p=J(p);var k=di(v,p);if(k)throw new Fe(k);if(!v.l.Ia)throw new Fe(63);v.l.Ia(v,p,d)},Ut=d=>{if(d=pr(d).node,!d)throw new Fe(44);if(!d.l.na)throw new Fe(28);return Je(qa(d.parent),d.l.na(d))},zo=(d,p,v)=>{if(d==="")throw new Fe(44);if(typeof p=="string"){var k={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[p];if(typeof k>"u")throw Error(`Unknown file open mode: ${p}`);p=k}if(v=p&64?(typeof v>"u"?438:v)&4095|32768:0,typeof d=="object")var E=d;else{d=S(d);try{E=pr(d,{gb:!(p&131072)}).node}catch{}}if(k=!1,p&64)if(E){if(p&128)throw new Fe(20)}else E=tr(d,v,0),k=!0;if(!E)throw new Fe(44);if((E.mode&61440)===8192&&(p&=-513),p&65536&&(E.mode&61440)!==16384)throw new Fe(54);if(!k&&(v=E?(E.mode&61440)===40960?32:(E.mode&61440)===16384&&(Tc(p)!=="r"||p&512)?31:Ho(E,Tc(p)):44))throw new Fe(v);if(p&512&&!k){if(v=E,v=typeof v=="string"?pr(v,{gb:!0}).node:v,!v.l.P)throw new Fe(63);if((v.mode&61440)===16384)throw new Fe(31);if((v.mode&61440)!==32768)throw new Fe(28);if(k=Ho(v,"w"))throw new Fe(k);v.l.P(v,{size:0,timestamp:Date.now()})}return p&=-131713,E=Ec({node:E,path:qa(E),flags:p,seekable:!0,position:0,m:E.m,sc:[],error:!1}),E.m.open&&E.m.open(E),!T.logReadFiles||p&1||(Ko||(Ko={}),d in Ko||(Ko[d]=1)),E},Go=(d,p,v)=>{if(d.X===null)throw new Fe(8);if(!d.seekable||!d.m.ba)throw new Fe(70);if(v!=0&&v!=1&&v!=2)throw new Fe(28);d.position=d.m.ba(d,p,v),d.sc=[]},Ys=()=>{Fe||(Fe=function(d,p){this.name="ErrnoError",this.node=p,this.ic=function(v){this.aa=v},this.ic(d),this.message="FS error"},Fe.prototype=Error(),Fe.prototype.constructor=Fe,[44].forEach(d=>{$s[d]=new Fe(d),$s[d].stack="<generic error, no stack>"}))},za,Ga=(d,p,v)=>{d=S("/dev/"+d);var k=Er(!!p,!!v);$o||($o=64);var E=$o++<<8|0;qo(E,{open:I=>{I.seekable=!1},close:()=>{v&&v.buffer&&v.buffer.length&&v(10)},read:(I,B,$,ae)=>{for(var Z=0,Te=0;Te<ae;Te++){try{var Oe=p()}catch{throw new Fe(29)}if(Oe===void 0&&Z===0)throw new Fe(6);if(Oe==null)break;Z++,B[$+Te]=Oe}return Z&&(I.node.timestamp=Date.now()),Z},write:(I,B,$,ae)=>{for(var Z=0;Z<ae;Z++)try{v(B[$+Z])}catch{throw new Fe(29)}return ae&&(I.node.timestamp=Date.now()),Z}}),Wo(d,k,E)},$o,_r={},Rn,Ko,kn=void 0;function Gr(){return kn+=4,L[kn-4>>2]}function Pc(d){if(d===void 0)return"_unknown";d=d.replace(/[^a-zA-Z0-9_]/g,"$");var p=d.charCodeAt(0);return 48<=p&&57>=p?`_${d}`:d}function Jo(d,p){return d=Pc(d),{[d]:function(){return p.apply(this,arguments)}}[d]}function $a(){this.M=[void 0],this.ib=[]}var Cn=new $a,Pr=void 0;function rt(d){throw new Pr(d)}var fr=d=>(d||rt("Cannot use deleted val. handle = "+d),Cn.get(d).value),Rr=d=>{switch(d){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Cn.ta({ub:1,value:d})}};function Yo(d){var p=Error,v=Jo(d,function(k){this.name=d,this.message=k,k=Error(k).stack,k!==void 0&&(this.stack=this.toString()+`
`+k.replace(/^Error(:[^\n]*)?\n/,""))});return v.prototype=Object.create(p.prototype),v.prototype.constructor=v,v.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},v}var Xs=void 0,Xo=void 0;function Et(d){for(var p="";le[d];)p+=Xo[le[d++]];return p}var Ka=[];function Ja(){for(;Ka.length;){var d=Ka.pop();d.g.ia=!1,d.delete()}}var gt=void 0,Ir={};function Qo(d,p){for(p===void 0&&rt("ptr should not be undefined");d.A;)p=d.pa(p),d=d.A;return p}var $r={};function Qs(d){d=ml(d);var p=Et(d);return Xr(d),p}function la(d,p){var v=$r[d];return v===void 0&&rt(p+" has unknown type "+Qs(d)),v}function Ya(){}var Xa=!1;function Qa(d){--d.count.value,d.count.value===0&&(d.H?d.L.W(d.H):d.u.i.W(d.o))}function Kr(d,p,v){return p===v?d:v.A===void 0?null:(d=Kr(d,p,v.A),d===null?null:v.Mb(d))}var Jr={};function hi(d,p){return p=Qo(d,p),Ir[p]}var ca=void 0;function pi(d){throw new ca(d)}function mr(d,p){return p.u&&p.o||pi("makeClassHandle requires ptr and ptrType"),!!p.L!=!!p.H&&pi("Both smartPtrType and smartPtr must be specified"),p.count={value:1},ua(Object.create(d,{g:{value:p}}))}function ua(d){return typeof FinalizationRegistry>"u"?(ua=p=>p,d):(Xa=new FinalizationRegistry(p=>{Qa(p.g)}),ua=p=>{var v=p.g;return v.H&&Xa.register(p,{g:v},p),p},Ya=p=>{Xa.unregister(p)},ua(d))}var Za={};function Yr(d){for(;d.length;){var p=d.pop();d.pop()(p)}}function eo(d){return this.fromWireType(L[d>>2])}var ji={},Di={};function In(d,p,v){function k($){$=v($),$.length!==d.length&&pi("Mismatched type converter count");for(var ae=0;ae<d.length;++ae)Mn(d[ae],$[ae])}d.forEach(function($){Di[$]=p});var E=Array(p.length),I=[],B=0;p.forEach(($,ae)=>{$r.hasOwnProperty($)?E[ae]=$r[$]:(I.push($),ji.hasOwnProperty($)||(ji[$]=[]),ji[$].push(()=>{E[ae]=$r[$],++B,B===I.length&&k(E)}))}),I.length===0&&k(E)}function Zo(d){switch(d){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${d}`)}}function to(d,p,v={}){var k=p.name;if(d||rt(`type "${k}" must have a positive integer typeid pointer`),$r.hasOwnProperty(d)){if(v.Xb)return;rt(`Cannot register type '${k}' twice`)}$r[d]=p,delete Di[d],ji.hasOwnProperty(d)&&(p=ji[d],delete ji[d],p.forEach(E=>E()))}function Mn(d,p,v={}){if(!("argPackAdvance"in p))throw new TypeError("registerType registeredInstance requires argPackAdvance");to(d,p,v)}function fi(d){rt(d.g.u.i.name+" instance already deleted")}function gr(){}function Zs(d,p,v){if(d[p].B===void 0){var k=d[p];d[p]=function(){return d[p].B.hasOwnProperty(arguments.length)||rt(`Function '${v}' called with an invalid number of arguments (${arguments.length}) - expects one of (${d[p].B})!`),d[p].B[arguments.length].apply(this,arguments)},d[p].B=[],d[p].B[k.ha]=k}}function el(d,p,v){T.hasOwnProperty(d)?((v===void 0||T[d].B!==void 0&&T[d].B[v]!==void 0)&&rt(`Cannot register public name '${d}' twice`),Zs(T,d,d),T.hasOwnProperty(v)&&rt(`Cannot register multiple overloads of a function with the same number of arguments (${v})!`),T[d].B[v]=p):(T[d]=p,v!==void 0&&(T[d].Mc=v))}function tl(d,p,v,k,E,I,B,$){this.name=d,this.constructor=p,this.N=v,this.W=k,this.A=E,this.Rb=I,this.pa=B,this.Mb=$,this.qb=[]}function Fi(d,p,v){for(;p!==v;)p.pa||rt(`Expected null or instance of ${v.name}, got an instance of ${p.name}`),d=p.pa(d),p=p.A;return d}function nl(d,p){return p===null?(this.Ta&&rt(`null is not a valid ${this.name}`),0):(p.g||rt(`Cannot pass "${Ui(p)}" as a ${this.name}`),p.g.o||rt(`Cannot pass deleted object as a pointer of type ${this.name}`),Fi(p.g.o,p.g.u.i,this.i))}function Rc(d,p){if(p===null){if(this.Ta&&rt(`null is not a valid ${this.name}`),this.ya){var v=this.Va();return d!==null&&d.push(this.W,v),v}return 0}if(p.g||rt(`Cannot pass "${Ui(p)}" as a ${this.name}`),p.g.o||rt(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.xa&&p.g.u.xa&&rt(`Cannot convert argument of type ${p.g.L?p.g.L.name:p.g.u.name} to parameter type ${this.name}`),v=Fi(p.g.o,p.g.u.i,this.i),this.ya)switch(p.g.H===void 0&&rt("Passing raw pointer to smart pointer is illegal"),this.mc){case 0:p.g.L===this?v=p.g.H:rt(`Cannot convert argument of type ${p.g.L?p.g.L.name:p.g.u.name} to parameter type ${this.name}`);break;case 1:v=p.g.H;break;case 2:if(p.g.L===this)v=p.g.H;else{var k=p.clone();v=this.hc(v,Rr(function(){k.delete()})),d!==null&&d.push(this.W,v)}break;default:rt("Unsupporting sharing policy")}return v}function mi(d,p){return p===null?(this.Ta&&rt(`null is not a valid ${this.name}`),0):(p.g||rt(`Cannot pass "${Ui(p)}" as a ${this.name}`),p.g.o||rt(`Cannot pass deleted object as a pointer of type ${this.name}`),p.g.u.xa&&rt(`Cannot convert argument of type ${p.g.u.name} to parameter type ${this.name}`),Fi(p.g.o,p.g.u.i,this.i))}function vr(d,p,v,k){this.name=d,this.i=p,this.Ta=v,this.xa=k,this.ya=!1,this.W=this.hc=this.Va=this.sb=this.mc=this.fc=void 0,p.A!==void 0?this.toWireType=Rc:(this.toWireType=k?nl:mi,this.K=null)}function no(d,p,v){T.hasOwnProperty(d)||pi("Replacing nonexistant public symbol"),T[d].B!==void 0&&v!==void 0?T[d].B[v]=p:(T[d]=p,T[d].ha=v)}var ro=[],io=d=>{var p=ro[d];return p||(d>=ro.length&&(ro.length=d+1),ro[d]=p=Ne.get(d)),p},es=(d,p)=>{var v=[];return function(){if(v.length=0,Object.assign(v,arguments),d.includes("j")){var k=T["dynCall_"+d];k=v&&v.length?k.apply(null,[p].concat(v)):k.call(null,p)}else k=io(p).apply(null,v);return k}};function an(d,p){d=Et(d);var v=d.includes("j")?es(d,p):io(p);return typeof v!="function"&&rt(`unknown function pointer with signature ${d}: ${p}`),v}var On=void 0;function An(d,p){function v(I){E[I]||$r[I]||(Di[I]?Di[I].forEach(v):(k.push(I),E[I]=!0))}var k=[],E={};throw p.forEach(v),new On(`${d}: `+k.map(Qs).join([", "]))}function da(d,p,v,k,E){var I=p.length;2>I&&rt("argTypes array size mismatch! Must at least get return value and 'this' types!");var B=p[1]!==null&&v!==null,$=!1;for(v=1;v<p.length;++v)if(p[v]!==null&&p[v].K===void 0){$=!0;break}var ae=p[0].name!=="void",Z=I-2,Te=Array(Z),Oe=[],Ve=[];return function(){if(arguments.length!==Z&&rt(`function ${d} called with ${arguments.length} arguments, expected ${Z} args!`),Ve.length=0,Oe.length=B?2:1,Oe[0]=E,B){var te=p[1].toWireType(Ve,this);Oe[1]=te}for(var fe=0;fe<Z;++fe)Te[fe]=p[fe+2].toWireType(Ve,arguments[fe]),Oe.push(Te[fe]);if(fe=k.apply(null,Oe),$)Yr(Ve);else for(var Ie=B?1:2;Ie<p.length;Ie++){var $e=Ie===1?te:Te[Ie-2];p[Ie].K!==null&&p[Ie].K($e)}return te=ae?p[0].fromWireType(fe):void 0,te}}function gi(d,p){for(var v=[],k=0;k<d;k++)v.push(se[p+4*k>>2]);return v}function Ic(d,p,v){return d instanceof Object||rt(`${v} with invalid "this": ${d}`),d instanceof p.i.constructor||rt(`${v} incompatible with "this" of type ${d.constructor.name}`),d.g.o||rt(`cannot call emscripten binding method ${v} on deleted object`),Fi(d.g.o,d.g.u.i,p.i)}function ao(d){d>=Cn.h&&--Cn.get(d).ub===0&&Cn.Wb(d)}function rl(d,p,v){switch(p){case 0:return function(k){return this.fromWireType((v?Re:le)[k])};case 1:return function(k){return this.fromWireType((v?Ee:ke)[k>>1])};case 2:return function(k){return this.fromWireType((v?L:se)[k>>2])};default:throw new TypeError("Unknown integer type: "+d)}}function Ui(d){if(d===null)return"null";var p=typeof d;return p==="object"||p==="array"||p==="function"?d.toString():""+d}function ts(d,p){switch(p){case 2:return function(v){return this.fromWireType(Ge[v>>2])};case 3:return function(v){return this.fromWireType(xe[v>>3])};default:throw new TypeError("Unknown float type: "+d)}}function Mc(d,p,v){switch(p){case 0:return v?function(k){return Re[k]}:function(k){return le[k]};case 1:return v?function(k){return Ee[k>>1]}:function(k){return ke[k>>1]};case 2:return v?function(k){return L[k>>2]}:function(k){return se[k>>2]};default:throw new TypeError("Unknown integer type: "+d)}}var Oc=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Fd=(d,p)=>{for(var v=d>>1,k=v+p/2;!(v>=k)&&ke[v];)++v;if(v<<=1,32<v-d&&Oc)return Oc.decode(le.subarray(d,v));for(v="",k=0;!(k>=p/2);++k){var E=Ee[d+2*k>>1];if(E==0)break;v+=String.fromCharCode(E)}return v},Ud=(d,p,v)=>{if(v===void 0&&(v=2147483647),2>v)return 0;v-=2;var k=p;v=v<2*d.length?v/2:d.length;for(var E=0;E<v;++E)Ee[p>>1]=d.charCodeAt(E),p+=2;return Ee[p>>1]=0,p-k},il=d=>2*d.length,Bd=(d,p)=>{for(var v=0,k="";!(v>=p/4);){var E=L[d+4*v>>2];if(E==0)break;++v,65536<=E?(E-=65536,k+=String.fromCharCode(55296|E>>10,56320|E&1023)):k+=String.fromCharCode(E)}return k},Vd=(d,p,v)=>{if(v===void 0&&(v=2147483647),4>v)return 0;var k=p;v=k+v-4;for(var E=0;E<d.length;++E){var I=d.charCodeAt(E);if(55296<=I&&57343>=I){var B=d.charCodeAt(++E);I=65536+((I&1023)<<10)|B&1023}if(L[p>>2]=I,p+=4,p+4>v)break}return L[p>>2]=0,p-k},Hd=d=>{for(var p=0,v=0;v<d.length;++v){var k=d.charCodeAt(v);55296<=k&&57343>=k&&++v,p+=4}return p},qd={};function al(d){var p=qd[d];return p===void 0?Et(d):p}var oo=[];function Wd(d){var p=oo.length;return oo.push(d),p}function zd(d,p){for(var v=Array(d),k=0;k<d;++k)v[k]=la(se[p+4*k>>2],"parameter "+k);return v}var Ac=[],ol=[];function ns(d){d.Dc=d.getExtension("WEBGL_draw_instanced_base_vertex_base_instance")}function Lc(d){d.Ic=d.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance")}var Nc=1,so=[],nr=[],rs=[],lo=[],ha=[],Mr=[],is=[],Yt=[],jc={};function Xt(d){co||(co=d)}function vi(d){for(var p=Nc++,v=d.length;v<p;v++)d[v]=null;return p}function Gd(d,p){var v=vi(Yt),k={handle:v,attributes:p,version:p.Hc,C:d};return d.canvas&&(d.canvas.Cb=k),Yt[v]=k,(typeof p.Nb>"u"||p.Nb)&&Dc(k),v}function as(d){return br=Yt[d],T.Bc=pe=br&&br.C,!(d&&!pe)}function Dc(d){if(d||(d=br),!d.Yb){d.Yb=!0;var p=d.C;ns(p),Lc(p),2<=d.version&&(p.eb=p.getExtension("EXT_disjoint_timer_query_webgl2")),(2>d.version||!p.eb)&&(p.eb=p.getExtension("EXT_disjoint_timer_query")),sl(p),(p.getSupportedExtensions()||[]).forEach(function(v){v.includes("lose_context")||v.includes("debug")||p.getExtension(v)})}}var co,br;function sl(d){d.Kc=d.getExtension("WEBGL_multi_draw")}var bi={},Fc=()=>{if(!ll){var d={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:D||"./this.program"},p;for(p in bi)bi[p]===void 0?delete d[p]:d[p]=bi[p];var v=[];for(p in d)v.push(`${p}=${d[p]}`);ll=v}return ll},ll,cl=[];function pa(d,p,v,k){for(var E=0;E<d;E++){var I=pe[v](),B=I&&vi(k);I?(I.name=B,k[B]=I):Xt(1282),L[p+4*E>>2]=B}}function Uc(d,p){if(p){var v=void 0;switch(d){case 36346:v=1;break;case 36344:return;case 34814:case 36345:v=0;break;case 34466:var k=pe.getParameter(34467);v=k?k.length:0;break;case 33309:if(2>br.version){Xt(1282);return}v=2*(pe.getSupportedExtensions()||[]).length;break;case 33307:case 33308:if(2>br.version){Xt(1280);return}v=d==33307?3:0}if(v===void 0)switch(k=pe.getParameter(d),typeof k){case"number":v=k;break;case"boolean":v=k?1:0;break;case"string":Xt(1280);return;case"object":if(k===null)switch(d){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:v=0;break;default:Xt(1280);return}else{if(k instanceof Float32Array||k instanceof Uint32Array||k instanceof Int32Array||k instanceof Array){for(d=0;d<k.length;++d)L[p+4*d>>2]=k[d];return}try{v=k.name|0}catch(E){Xt(1280),he("GL_INVALID_ENUM in glGet0v: Unknown object returned from WebGL getParameter("+d+")! (error: "+E+")");return}}break;default:Xt(1280),he("GL_INVALID_ENUM in glGet0v: Native code calling glGet0v("+d+") and it returns "+k+" of type "+typeof k+"!");return}L[p>>2]=v}else Xt(1281)}var yi=d=>{var p=Tt(d)+1,v=ss(p);return v&&zt(d,le,v,p),v};function fa(d){return d.slice(-1)=="]"&&d.lastIndexOf("[")}function Bc(d){return d-=5120,d==0?Re:d==1?le:d==2?Ee:d==4?L:d==6?Ge:d==5||d==28922||d==28520||d==30779||d==30782?se:ke}var Bi=d=>d%4===0&&(d%100!==0||d%400===0),Vc=[31,29,31,30,31,30,31,31,30,31,30,31],ul=[31,28,31,30,31,30,31,31,30,31,30,31],dl=(d,p,v,k)=>{function E(te,fe,Ie){for(te=typeof te=="number"?te.toString():te||"";te.length<fe;)te=Ie[0]+te;return te}function I(te,fe){return E(te,fe,"0")}function B(te,fe){function Ie(Ye){return 0>Ye?-1:0<Ye?1:0}var $e;return($e=Ie(te.getFullYear()-fe.getFullYear()))===0&&($e=Ie(te.getMonth()-fe.getMonth()))===0&&($e=Ie(te.getDate()-fe.getDate())),$e}function $(te){switch(te.getDay()){case 0:return new Date(te.getFullYear()-1,11,29);case 1:return te;case 2:return new Date(te.getFullYear(),0,3);case 3:return new Date(te.getFullYear(),0,2);case 4:return new Date(te.getFullYear(),0,1);case 5:return new Date(te.getFullYear()-1,11,31);case 6:return new Date(te.getFullYear()-1,11,30)}}function ae(te){var fe=te.da;for(te=new Date(new Date(te.ea+1900,0,1).getTime());0<fe;){var Ie=te.getMonth(),$e=(Bi(te.getFullYear())?Vc:ul)[Ie];if(fe>$e-te.getDate())fe-=$e-te.getDate()+1,te.setDate(1),11>Ie?te.setMonth(Ie+1):(te.setMonth(0),te.setFullYear(te.getFullYear()+1));else{te.setDate(te.getDate()+fe);break}}return Ie=new Date(te.getFullYear()+1,0,4),fe=$(new Date(te.getFullYear(),0,4)),Ie=$(Ie),0>=B(fe,te)?0>=B(Ie,te)?te.getFullYear()+1:te.getFullYear():te.getFullYear()-1}var Z=L[k+40>>2];k={pc:L[k>>2],oc:L[k+4>>2],Ja:L[k+8>>2],Xa:L[k+12>>2],Ka:L[k+16>>2],ea:L[k+20>>2],R:L[k+24>>2],da:L[k+28>>2],Pc:L[k+32>>2],nc:L[k+36>>2],qc:Z&&Z?De(le,Z):""},v=v?De(le,v):"",Z={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var Te in Z)v=v.replace(new RegExp(Te,"g"),Z[Te]);var Oe="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ve="January February March April May June July August September October November December".split(" ");Z={"%a":te=>Oe[te.R].substring(0,3),"%A":te=>Oe[te.R],"%b":te=>Ve[te.Ka].substring(0,3),"%B":te=>Ve[te.Ka],"%C":te=>I((te.ea+1900)/100|0,2),"%d":te=>I(te.Xa,2),"%e":te=>E(te.Xa,2," "),"%g":te=>ae(te).toString().substring(2),"%G":te=>ae(te),"%H":te=>I(te.Ja,2),"%I":te=>(te=te.Ja,te==0?te=12:12<te&&(te-=12),I(te,2)),"%j":te=>{for(var fe=0,Ie=0;Ie<=te.Ka-1;fe+=(Bi(te.ea+1900)?Vc:ul)[Ie++]);return I(te.Xa+fe,3)},"%m":te=>I(te.Ka+1,2),"%M":te=>I(te.oc,2),"%n":()=>`
`,"%p":te=>0<=te.Ja&&12>te.Ja?"AM":"PM","%S":te=>I(te.pc,2),"%t":()=>"	","%u":te=>te.R||7,"%U":te=>I(Math.floor((te.da+7-te.R)/7),2),"%V":te=>{var fe=Math.floor((te.da+7-(te.R+6)%7)/7);if(2>=(te.R+371-te.da-2)%7&&fe++,fe)fe==53&&(Ie=(te.R+371-te.da)%7,Ie==4||Ie==3&&Bi(te.ea)||(fe=1));else{fe=52;var Ie=(te.R+7-te.da-1)%7;(Ie==4||Ie==5&&Bi(te.ea%400-1))&&fe++}return I(fe,2)},"%w":te=>te.R,"%W":te=>I(Math.floor((te.da+7-(te.R+6)%7)/7),2),"%y":te=>(te.ea+1900).toString().substring(2),"%Y":te=>te.ea+1900,"%z":te=>{te=te.nc;var fe=0<=te;return te=Math.abs(te)/60,(fe?"+":"-")+("0000"+(te/60*100+te%60)).slice(-4)},"%Z":te=>te.qc,"%%":()=>"%"},v=v.replace(/%%/g,"\0\0");for(Te in Z)v.includes(Te)&&(v=v.replace(new RegExp(Te,"g"),Z[Te](k)));return v=v.replace(/\0\0/g,"%"),Te=xt(v,!1),Te.length>p?0:(Re.set(Te,d),Te.length-1)};function os(d,p,v,k){d||(d=this),this.parent=d,this.U=d.U,this.Da=null,this.id=Cc++,this.name=p,this.mode=v,this.l={},this.m={},this.Fa=k}Object.defineProperties(os.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(d){d?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(d){d?this.mode|=146:this.mode&=-147}}}),Ys(),Wr=Array(4096),Ks(et,"/"),tr("/tmp",16895,0),tr("/home",16895,0),tr("/home/web_user",16895,0),(()=>{tr("/dev",16895,0),qo(259,{read:()=>0,write:(k,E,I,B)=>B}),Wo("/dev/null",259),Pn(1280,en),Pn(1536,rn),Wo("/dev/tty",1280),Wo("/dev/tty1",1536);var d=new Uint8Array(1024),p=0,v=()=>(p===0&&(p=be(d).byteLength),d[--p]);Ga("random",v),Ga("urandom",v),tr("/dev/shm",16895,0),tr("/dev/shm/tmp",16895,0)})(),(()=>{tr("/proc",16895,0);var d=tr("/proc/self",16895,0);tr("/proc/self/fd",16895,0),Ks({U:()=>{var p=Sc(d,"fd",16895,73);return p.l={ma:(v,k)=>{var E=zr(+k);return v={parent:null,U:{mb:"fake"},l:{na:()=>E.path}},v.parent=v}},p}},"/proc/self/fd")})(),Object.assign($a.prototype,{get(d){return this.M[d]},has(d){return this.M[d]!==void 0},ta(d){var p=this.ib.pop()||this.M.length;return this.M[p]=d,p},Wb(d){this.M[d]=void 0,this.ib.push(d)}}),Pr=T.BindingError=class extends Error{constructor(d){super(d),this.name="BindingError"}},Cn.M.push({value:void 0},{value:null},{value:!0},{value:!1}),Cn.h=Cn.M.length,T.count_emval_handles=function(){for(var d=0,p=Cn.h;p<Cn.M.length;++p)Cn.M[p]!==void 0&&++d;return d},Xs=T.PureVirtualError=Yo("PureVirtualError");for(var hl=Array(256),uo=0;256>uo;++uo)hl[uo]=String.fromCharCode(uo);Xo=hl,T.getInheritedInstanceCount=function(){return Object.keys(Ir).length},T.getLiveInheritedInstances=function(){var d=[],p;for(p in Ir)Ir.hasOwnProperty(p)&&d.push(Ir[p]);return d},T.flushPendingDeletes=Ja,T.setDelayFunction=function(d){gt=d,Ka.length&&gt&&gt(Ja)},ca=T.InternalError=class extends Error{constructor(d){super(d),this.name="InternalError"}},gr.prototype.isAliasOf=function(d){if(!(this instanceof gr&&d instanceof gr))return!1;var p=this.g.u.i,v=this.g.o,k=d.g.u.i;for(d=d.g.o;p.A;)v=p.pa(v),p=p.A;for(;k.A;)d=k.pa(d),k=k.A;return p===k&&v===d},gr.prototype.clone=function(){if(this.g.o||fi(this),this.g.ka)return this.g.count.value+=1,this;var d=ua,p=Object,v=p.create,k=Object.getPrototypeOf(this),E=this.g;return d=d(v.call(p,k,{g:{value:{count:E.count,ia:E.ia,ka:E.ka,o:E.o,u:E.u,H:E.H,L:E.L}}})),d.g.count.value+=1,d.g.ia=!1,d},gr.prototype.delete=function(){this.g.o||fi(this),this.g.ia&&!this.g.ka&&rt("Object already scheduled for deletion"),Ya(this),Qa(this.g),this.g.ka||(this.g.H=void 0,this.g.o=void 0)},gr.prototype.isDeleted=function(){return!this.g.o},gr.prototype.deleteLater=function(){return this.g.o||fi(this),this.g.ia&&!this.g.ka&&rt("Object already scheduled for deletion"),Ka.push(this),Ka.length===1&&gt&&gt(Ja),this.g.ia=!0,this},vr.prototype.Sb=function(d){return this.sb&&(d=this.sb(d)),d},vr.prototype.cb=function(d){this.W&&this.W(d)},vr.prototype.argPackAdvance=8,vr.prototype.readValueFromPointer=eo,vr.prototype.deleteObject=function(d){d!==null&&d.delete()},vr.prototype.fromWireType=function(d){function p(){return this.ya?mr(this.i.N,{u:this.fc,o:v,L:this,H:d}):mr(this.i.N,{u:this,o:d})}var v=this.Sb(d);if(!v)return this.cb(d),null;var k=hi(this.i,v);if(k!==void 0)return k.g.count.value===0?(k.g.o=v,k.g.H=d,k.clone()):(k=k.clone(),this.cb(d),k);if(k=this.i.Rb(v),k=Jr[k],!k)return p.call(this);k=this.xa?k.Jb:k.pointerType;var E=Kr(v,this.i,k.i);return E===null?p.call(this):this.ya?mr(k.i.N,{u:k,o:E,L:this,H:d}):mr(k.i.N,{u:k,o:E})},On=T.UnboundTypeError=Yo("UnboundTypeError");for(var pe,pl=0;32>pl;++pl)cl.push(Array(pl));var Hc={__syscall_fcntl64:function(d,p,v){kn=v;try{var k=zr(d);switch(p){case 0:var E=Gr();return 0>E?-28:Ec(k,E).X;case 1:case 2:return 0;case 3:return k.flags;case 4:return E=Gr(),k.flags|=E,0;case 5:return E=Gr(),Ee[E+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return L[qc()>>2]=28,-1;default:return-28}}catch(I){if(typeof _r>"u"||I.name!=="ErrnoError")throw I;return-I.aa}},__syscall_ioctl:function(d,p,v){kn=v;try{var k=zr(d);switch(p){case 21509:return k.s?0:-59;case 21505:if(!k.s)return-59;if(k.s.V.$b){p=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var E=Gr();L[E>>2]=25856,L[E+4>>2]=5,L[E+8>>2]=191,L[E+12>>2]=35387;for(var I=0;32>I;I++)Re[E+I+17>>0]=p[I]||0}return 0;case 21510:case 21511:case 21512:return k.s?0:-59;case 21506:case 21507:case 21508:if(!k.s)return-59;if(k.s.V.ac)for(E=Gr(),p=[],I=0;32>I;I++)p.push(Re[E+I+17>>0]);return 0;case 21519:return k.s?(E=Gr(),L[E>>2]=0):-59;case 21520:return k.s?-28:-59;case 21531:if(E=Gr(),!k.m.Zb)throw new Fe(59);return k.m.Zb(k,p,E);case 21523:return k.s?(k.s.V.bc&&(I=[24,80],E=Gr(),Ee[E>>1]=I[0],Ee[E+2>>1]=I[1]),0):-59;case 21524:return k.s?0:-59;case 21515:return k.s?0:-59;default:return-28}}catch(B){if(typeof _r>"u"||B.name!=="ErrnoError")throw B;return-B.aa}},__syscall_openat:function(d,p,v,k){kn=k;try{p=p?De(le,p):"";var E=p;if(E.charAt(0)==="/")p=E;else{var I=d===-100?"/":zr(d).path;if(E.length==0)throw new Fe(44);p=S(I+"/"+E)}var B=k?Gr():0;return zo(p,v,B).X}catch($){if(typeof _r>"u"||$.name!=="ErrnoError")throw $;return-$.aa}},_embind_create_inheriting_constructor:function(d,p,v){d=Et(d),p=la(p,"wrapper"),v=fr(v);var k=[].slice,E=p.i,I=E.N,B=E.A.N,$=E.A.constructor;d=Jo(d,function(){E.A.qb.forEach((function(Z){if(this[Z]===B[Z])throw new Xs(`Pure virtual function ${Z} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:I}),this.__construct.apply(this,k.call(arguments))}),I.__construct=function(){this===I&&rt("Pass correct 'this' to __construct");var Z=$.implement.apply(void 0,[this].concat(k.call(arguments)));Ya(Z);var Te=Z.g;Z.notifyOnDestruction(),Te.ka=!0,Object.defineProperties(this,{g:{value:Te}}),ua(this),Z=Te.o,Z=Qo(E,Z),Ir.hasOwnProperty(Z)?rt(`Tried to register registered instance: ${Z}`):Ir[Z]=this},I.__destruct=function(){this===I&&rt("Pass correct 'this' to __destruct"),Ya(this);var Z=this.g.o;Z=Qo(E,Z),Ir.hasOwnProperty(Z)?delete Ir[Z]:rt(`Tried to unregister unregistered instance: ${Z}`)},d.prototype=Object.create(I);for(var ae in v)d.prototype[ae]=v[ae];return Rr(d)},_embind_finalize_value_object:function(d){var p=Za[d];delete Za[d];var v=p.Va,k=p.W,E=p.fb,I=E.map(B=>B.Vb).concat(E.map(B=>B.kc));In([d],I,B=>{var $={};return E.forEach((ae,Z)=>{var Te=B[Z],Oe=ae.Tb,Ve=ae.Ub,te=B[Z+E.length],fe=ae.jc,Ie=ae.lc;$[ae.Pb]={read:$e=>Te.fromWireType(Oe(Ve,$e)),write:($e,Ye)=>{var tt=[];fe(Ie,$e,te.toWireType(tt,Ye)),Yr(tt)}}}),[{name:p.name,fromWireType:function(ae){var Z={},Te;for(Te in $)Z[Te]=$[Te].read(ae);return k(ae),Z},toWireType:function(ae,Z){for(var Te in $)if(!(Te in Z))throw new TypeError(`Missing field: "${Te}"`);var Oe=v();for(Te in $)$[Te].write(Oe,Z[Te]);return ae!==null&&ae.push(k,Oe),Oe},argPackAdvance:8,readValueFromPointer:eo,K:k}]})},_embind_register_bigint:function(){},_embind_register_bool:function(d,p,v,k,E){var I=Zo(v);p=Et(p),Mn(d,{name:p,fromWireType:function(B){return!!B},toWireType:function(B,$){return $?k:E},argPackAdvance:8,readValueFromPointer:function(B){if(v===1)var $=Re;else if(v===2)$=Ee;else if(v===4)$=L;else throw new TypeError("Unknown boolean type size: "+p);return this.fromWireType($[B>>I])},K:null})},_embind_register_class:function(d,p,v,k,E,I,B,$,ae,Z,Te,Oe,Ve){Te=Et(Te),I=an(E,I),$&&($=an(B,$)),Z&&(Z=an(ae,Z)),Ve=an(Oe,Ve);var te=Pc(Te);el(te,function(){An(`Cannot construct ${Te} due to unbound types`,[k])}),In([d,p,v],k?[k]:[],function(fe){if(fe=fe[0],k)var Ie=fe.i,$e=Ie.N;else $e=gr.prototype;fe=Jo(te,function(){if(Object.getPrototypeOf(this)!==Ye)throw new Pr("Use 'new' to construct "+Te);if(tt.$===void 0)throw new Pr(Te+" has no accessible constructor");var It=tt.$[arguments.length];if(It===void 0)throw new Pr(`Tried to invoke ctor of ${Te} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(tt.$).toString()}) parameters instead!`);return It.apply(this,arguments)});var Ye=Object.create($e,{constructor:{value:fe}});fe.prototype=Ye;var tt=new tl(Te,fe,Ye,Ve,Ie,I,$,Z);tt.A&&(tt.A.qa===void 0&&(tt.A.qa=[]),tt.A.qa.push(tt)),Ie=new vr(Te,tt,!0,!1),$e=new vr(Te+"*",tt,!1,!1);var vt=new vr(Te+" const*",tt,!1,!0);return Jr[d]={pointerType:$e,Jb:vt},no(te,fe),[Ie,$e,vt]})},_embind_register_class_class_function:function(d,p,v,k,E,I,B){var $=gi(v,k);p=Et(p),I=an(E,I),In([],[d],function(ae){function Z(){An(`Cannot call ${Te} due to unbound types`,$)}ae=ae[0];var Te=`${ae.name}.${p}`;p.startsWith("@@")&&(p=Symbol[p.substring(2)]);var Oe=ae.i.constructor;return Oe[p]===void 0?(Z.ha=v-1,Oe[p]=Z):(Zs(Oe,p,Te),Oe[p].B[v-1]=Z),In([],$,function(Ve){if(Ve=da(Te,[Ve[0],null].concat(Ve.slice(1)),null,I,B),Oe[p].B===void 0?(Ve.ha=v-1,Oe[p]=Ve):Oe[p].B[v-1]=Ve,ae.i.qa)for(const te of ae.i.qa)te.constructor.hasOwnProperty(p)||(te.constructor[p]=Ve);return[]}),[]})},_embind_register_class_class_property:function(d,p,v,k,E,I,B,$){p=Et(p),I=an(E,I),In([],[d],function(ae){ae=ae[0];var Z=`${ae.name}.${p}`,Te={get(){An(`Cannot access ${Z} due to unbound types`,[v])},enumerable:!0,configurable:!0};return Te.set=$?()=>{An(`Cannot access ${Z} due to unbound types`,[v])}:()=>{rt(`${Z} is a read-only property`)},Object.defineProperty(ae.i.constructor,p,Te),In([],[v],function(Oe){Oe=Oe[0];var Ve={get(){return Oe.fromWireType(I(k))},enumerable:!0};return $&&($=an(B,$),Ve.set=te=>{var fe=[];$(k,Oe.toWireType(fe,te)),Yr(fe)}),Object.defineProperty(ae.i.constructor,p,Ve),[]}),[]})},_embind_register_class_constructor:function(d,p,v,k,E,I){var B=gi(p,v);E=an(k,E),In([],[d],function($){$=$[0];var ae=`constructor ${$.name}`;if($.i.$===void 0&&($.i.$=[]),$.i.$[p-1]!==void 0)throw new Pr(`Cannot register multiple constructors with identical number of parameters (${p-1}) for class '${$.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return $.i.$[p-1]=()=>{An(`Cannot construct ${$.name} due to unbound types`,B)},In([],B,function(Z){return Z.splice(1,0,null),$.i.$[p-1]=da(ae,Z,null,E,I),[]}),[]})},_embind_register_class_function:function(d,p,v,k,E,I,B,$){var ae=gi(v,k);p=Et(p),I=an(E,I),In([],[d],function(Z){function Te(){An(`Cannot call ${Oe} due to unbound types`,ae)}Z=Z[0];var Oe=`${Z.name}.${p}`;p.startsWith("@@")&&(p=Symbol[p.substring(2)]),$&&Z.i.qb.push(p);var Ve=Z.i.N,te=Ve[p];return te===void 0||te.B===void 0&&te.className!==Z.name&&te.ha===v-2?(Te.ha=v-2,Te.className=Z.name,Ve[p]=Te):(Zs(Ve,p,Oe),Ve[p].B[v-2]=Te),In([],ae,function(fe){return fe=da(Oe,fe,Z,I,B),Ve[p].B===void 0?(fe.ha=v-2,Ve[p]=fe):Ve[p].B[v-2]=fe,[]}),[]})},_embind_register_class_property:function(d,p,v,k,E,I,B,$,ae,Z){p=Et(p),E=an(k,E),In([],[d],function(Te){Te=Te[0];var Oe=`${Te.name}.${p}`,Ve={get(){An(`Cannot access ${Oe} due to unbound types`,[v,B])},enumerable:!0,configurable:!0};return Ve.set=ae?()=>{An(`Cannot access ${Oe} due to unbound types`,[v,B])}:()=>{rt(Oe+" is a read-only property")},Object.defineProperty(Te.i.N,p,Ve),In([],ae?[v,B]:[v],function(te){var fe=te[0],Ie={get(){var Ye=Ic(this,Te,Oe+" getter");return fe.fromWireType(E(I,Ye))},enumerable:!0};if(ae){ae=an($,ae);var $e=te[1];Ie.set=function(Ye){var tt=Ic(this,Te,Oe+" setter"),vt=[];ae(Z,tt,$e.toWireType(vt,Ye)),Yr(vt)}}return Object.defineProperty(Te.i.N,p,Ie),[]}),[]})},_embind_register_emval:function(d,p){p=Et(p),Mn(d,{name:p,fromWireType:function(v){var k=fr(v);return ao(v),k},toWireType:function(v,k){return Rr(k)},argPackAdvance:8,readValueFromPointer:eo,K:null})},_embind_register_enum:function(d,p,v,k){function E(){}v=Zo(v),p=Et(p),E.values={},Mn(d,{name:p,constructor:E,fromWireType:function(I){return this.constructor.values[I]},toWireType:function(I,B){return B.value},argPackAdvance:8,readValueFromPointer:rl(p,v,k),K:null}),el(p,E)},_embind_register_enum_value:function(d,p,v){var k=la(d,"enum");p=Et(p),d=k.constructor,k=Object.create(k.constructor.prototype,{value:{value:v},constructor:{value:Jo(`${k.name}_${p}`,function(){})}}),d.values[v]=k,d[p]=k},_embind_register_float:function(d,p,v){v=Zo(v),p=Et(p),Mn(d,{name:p,fromWireType:function(k){return k},toWireType:function(k,E){return E},argPackAdvance:8,readValueFromPointer:ts(p,v),K:null})},_embind_register_function:function(d,p,v,k,E,I){var B=gi(p,v);d=Et(d),E=an(k,E),el(d,function(){An(`Cannot call ${d} due to unbound types`,B)},p-1),In([],B,function($){return no(d,da(d,[$[0],null].concat($.slice(1)),null,E,I),p-1),[]})},_embind_register_integer:function(d,p,v,k,E){p=Et(p),E===-1&&(E=4294967295),E=Zo(v);var I=$=>$;if(k===0){var B=32-8*v;I=$=>$<<B>>>B}v=p.includes("unsigned")?function($,ae){return ae>>>0}:function($,ae){return ae},Mn(d,{name:p,fromWireType:I,toWireType:v,argPackAdvance:8,readValueFromPointer:Mc(p,E,k!==0),K:null})},_embind_register_memory_view:function(d,p,v){function k(I){I>>=2;var B=se;return new E(B.buffer,B[I+1],B[I])}var E=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][p];v=Et(v),Mn(d,{name:v,fromWireType:k,argPackAdvance:8,readValueFromPointer:k},{Xb:!0})},_embind_register_std_string:function(d,p){p=Et(p);var v=p==="std::string";Mn(d,{name:p,fromWireType:function(k){var E=se[k>>2],I=k+4;if(v)for(var B=I,$=0;$<=E;++$){var ae=I+$;if($==E||le[ae]==0){if(B=B?De(le,B,ae-B):"",Z===void 0)var Z=B;else Z+="\0",Z+=B;B=ae+1}}else{for(Z=Array(E),$=0;$<E;++$)Z[$]=String.fromCharCode(le[I+$]);Z=Z.join("")}return Xr(k),Z},toWireType:function(k,E){E instanceof ArrayBuffer&&(E=new Uint8Array(E));var I=typeof E=="string";I||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int8Array||rt("Cannot pass non-string to std::string");var B=v&&I?Tt(E):E.length,$=ss(4+B+1),ae=$+4;if(se[$>>2]=B,v&&I)zt(E,le,ae,B+1);else if(I)for(I=0;I<B;++I){var Z=E.charCodeAt(I);255<Z&&(Xr(ae),rt("String has UTF-16 code units that do not fit in 8 bits")),le[ae+I]=Z}else for(I=0;I<B;++I)le[ae+I]=E[I];return k!==null&&k.push(Xr,$),$},argPackAdvance:8,readValueFromPointer:eo,K:function(k){Xr(k)}})},_embind_register_std_wstring:function(d,p,v){if(v=Et(v),p===2)var k=Fd,E=Ud,I=il,B=()=>ke,$=1;else p===4&&(k=Bd,E=Vd,I=Hd,B=()=>se,$=2);Mn(d,{name:v,fromWireType:function(ae){for(var Z=se[ae>>2],Te=B(),Oe,Ve=ae+4,te=0;te<=Z;++te){var fe=ae+4+te*p;(te==Z||Te[fe>>$]==0)&&(Ve=k(Ve,fe-Ve),Oe===void 0?Oe=Ve:(Oe+="\0",Oe+=Ve),Ve=fe+p)}return Xr(ae),Oe},toWireType:function(ae,Z){typeof Z!="string"&&rt(`Cannot pass non-string to C++ string type ${v}`);var Te=I(Z),Oe=ss(4+Te+p);return se[Oe>>2]=Te>>$,E(Z,Oe+4,Te+p),ae!==null&&ae.push(Xr,Oe),Oe},argPackAdvance:8,readValueFromPointer:eo,K:function(ae){Xr(ae)}})},_embind_register_value_object:function(d,p,v,k,E,I){Za[d]={name:Et(p),Va:an(v,k),W:an(E,I),fb:[]}},_embind_register_value_object_field:function(d,p,v,k,E,I,B,$,ae,Z){Za[d].fb.push({Pb:Et(p),Vb:v,Tb:an(k,E),Ub:I,kc:B,jc:an($,ae),lc:Z})},_embind_register_void:function(d,p){p=Et(p),Mn(d,{cc:!0,name:p,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(d,p,v){d=fr(d),p=la(p,"emval::as");var k=[],E=Rr(k);return se[v>>2]=E,p.toWireType(k,d)},_emval_call_method:function(d,p,v,k,E){d=oo[d],p=fr(p),v=al(v);var I=[];return se[k>>2]=Rr(I),d(p,v,I,E)},_emval_call_void_method:function(d,p,v,k){d=oo[d],p=fr(p),v=al(v),d(p,v,null,k)},_emval_decref:ao,_emval_get_method_caller:function(d,p){var v=zd(d,p),k=v[0];p=k.name+"_$"+v.slice(1).map(function(B){return B.name}).join("_")+"$";var E=Ac[p];if(E!==void 0)return E;var I=Array(d-1);return E=Wd((B,$,ae,Z)=>{for(var Te=0,Oe=0;Oe<d-1;++Oe)I[Oe]=v[Oe+1].readValueFromPointer(Z+Te),Te+=v[Oe+1].argPackAdvance;for(B=B[$].apply(B,I),Oe=0;Oe<d-1;++Oe)v[Oe+1].Lb&&v[Oe+1].Lb(I[Oe]);if(!k.cc)return k.toWireType(ae,B)}),Ac[p]=E},_emval_get_property:function(d,p){return d=fr(d),p=fr(p),Rr(d[p])},_emval_incref:function(d){4<d&&(Cn.get(d).ub+=1)},_emval_new_array:function(){return Rr([])},_emval_new_cstring:function(d){return Rr(al(d))},_emval_new_object:function(){return Rr({})},_emval_run_destructors:function(d){var p=fr(d);Yr(p),ao(d)},_emval_set_property:function(d,p,v){d=fr(d),p=fr(p),v=fr(v),d[p]=v},_emval_take_value:function(d,p){return d=la(d,"_emval_take_value"),d=d.readValueFromPointer(p),Rr(d)},abort:()=>{bn("")},beginPixelLocalStorageWEBGL:function(d,p,v){(d=Yt[d].C.ca)&&d.beginPixelLocalStorageWEBGL(T.HEAPU32.subarray(v,v+p))},decode_image:function(d,p,v){var k=T.images;k||(k=new Map,T.images=k);var E=new Image;k.set(d,E),p=T.HEAP8.subarray(p,p+v),v=new Uint8Array(v),v.set(p),E.src=URL.createObjectURL(new Blob([v],{type:"image/png"})),E.onload=function(){T._setWebImage(d,E.width,E.height)}},delete_image:function(d){var p=T.images;p&&p.get(d)&&p.delete(d)},emscripten_asm_const_int:(d,p,v)=>{ol.length=0;var k;for(v>>=2;k=le[p++];)v+=k!=105&v,ol.push(k==105?L[v]:xe[v++>>1]),++v;return Bo[d].apply(null,ol)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(d,p,v)=>le.copyWithin(d,p,p+v),emscripten_resize_heap:d=>{var p=le.length;if(d>>>=0,2147483648<d)return!1;for(var v=1;4>=v;v*=2){var k=p*(1+.2/v);k=Math.min(k,d+100663296);var E=Math;k=Math.max(d,k);e:{E=E.min.call(E,2147483648,k+(65536-k%65536)%65536)-ce.buffer.byteLength+65535>>>16;try{ce.grow(E),Ue();var I=1;break e}catch{}I=void 0}if(I)return!0}return!1},emscripten_webgl_enable_extension:function(d,p){return d=Yt[d],p=p?De(le,p):"",p.startsWith("GL_")&&(p=p.substr(3)),p=="WEBGL_draw_instanced_base_vertex_base_instance"&&ns(pe),p=="WEBGL_multi_draw_instanced_base_vertex_base_instance"&&Lc(pe),p=="WEBGL_multi_draw"&&sl(pe),!!d.C.getExtension(p)},emscripten_webgl_get_current_context:function(){return br?br.handle:0},emscripten_webgl_make_context_current:function(d){return as(d)?0:-5},enable_WEBGL_provoking_vertex:function(d){return d=Yt[d].C,d.rb=d.getExtension("WEBGL_provoking_vertex"),!!d.rb},enable_WEBGL_shader_pixel_local_storage_coherent:function(d){return d=Yt[d].C,d.ca=d.getExtension("WEBGL_shader_pixel_local_storage"),!(!d.ca||!d.ca.isCoherent())},endPixelLocalStorageWEBGL:function(d,p,v){(d=Yt[d].C.ca)&&d.endPixelLocalStorageWEBGL(T.HEAPU32.subarray(v,v+p))},environ_get:(d,p)=>{var v=0;return Fc().forEach(function(k,E){var I=p+v;for(E=se[d+4*E>>2]=I,I=0;I<k.length;++I)Re[E++>>0]=k.charCodeAt(I);Re[E>>0]=0,v+=k.length+1}),0},environ_sizes_get:(d,p)=>{var v=Fc();se[d>>2]=v.length;var k=0;return v.forEach(function(E){k+=E.length+1}),se[p>>2]=k,0},fd_close:function(d){try{var p=zr(d);if(p.X===null)throw new Fe(8);p.Sa&&(p.Sa=null);try{p.m.close&&p.m.close(p)}catch(v){throw v}finally{Hn[p.X]=null}return p.X=null,0}catch(v){if(typeof _r>"u"||v.name!=="ErrnoError")throw v;return v.aa}},fd_read:function(d,p,v,k){try{e:{var E=zr(d);d=p;for(var I,B=p=0;B<v;B++){var $=se[d>>2],ae=se[d+4>>2];d+=8;var Z=E,Te=$,Oe=ae,Ve=I,te=Re;if(0>Oe||0>Ve)throw new Fe(28);if(Z.X===null)throw new Fe(8);if((Z.flags&2097155)===1)throw new Fe(8);if((Z.node.mode&61440)===16384)throw new Fe(31);if(!Z.m.read)throw new Fe(28);var fe=typeof Ve<"u";if(!fe)Ve=Z.position;else if(!Z.seekable)throw new Fe(70);var Ie=Z.m.read(Z,te,Te,Oe,Ve);fe||(Z.position+=Ie);var $e=Ie;if(0>$e){var Ye=-1;break e}if(p+=$e,$e<ae)break;typeof I<"u"&&(I+=$e)}Ye=p}return se[k>>2]=Ye,0}catch(tt){if(typeof _r>"u"||tt.name!=="ErrnoError")throw tt;return tt.aa}},fd_seek:function(d,p,v,k,E){p=v+2097152>>>0<4194305-!!p?(p>>>0)+4294967296*v:NaN;try{if(isNaN(p))return 61;var I=zr(d);return Go(I,p,k),Ni=[I.position>>>0,(Un=I.position,1<=+Math.abs(Un)?0<Un?+Math.floor(Un/4294967296)>>>0:~~+Math.ceil((Un-+(~~Un>>>0))/4294967296)>>>0:0)],L[E>>2]=Ni[0],L[E+4>>2]=Ni[1],I.Sa&&p===0&&k===0&&(I.Sa=null),0}catch(B){if(typeof _r>"u"||B.name!=="ErrnoError")throw B;return B.aa}},fd_write:function(d,p,v,k){try{e:{var E=zr(d);d=p;for(var I,B=p=0;B<v;B++){var $=se[d>>2],ae=se[d+4>>2];d+=8;var Z=E,Te=$,Oe=ae,Ve=I,te=Re;if(0>Oe||0>Ve)throw new Fe(28);if(Z.X===null)throw new Fe(8);if((Z.flags&2097155)===0)throw new Fe(8);if((Z.node.mode&61440)===16384)throw new Fe(31);if(!Z.m.write)throw new Fe(28);Z.seekable&&Z.flags&1024&&Go(Z,0,2);var fe=typeof Ve<"u";if(!fe)Ve=Z.position;else if(!Z.seekable)throw new Fe(70);var Ie=Z.m.write(Z,te,Te,Oe,Ve,void 0);fe||(Z.position+=Ie);var $e=Ie;if(0>$e){var Ye=-1;break e}p+=$e,typeof I<"u"&&(I+=$e)}Ye=p}return se[k>>2]=Ye,0}catch(tt){if(typeof _r>"u"||tt.name!=="ErrnoError")throw tt;return tt.aa}},framebufferPixelLocalClearValuefvWEBGL:function(d,p,v,k,E,I){(d=Yt[d].C.ca)&&d.framebufferPixelLocalClearValuefvWEBGL(p,[v,k,E,I])},framebufferTexturePixelLocalStorageWEBGL:function(d,p,v,k,E){(d=Yt[d].C.ca)&&d.framebufferTexturePixelLocalStorageWEBGL(p,ha[v],k,E)},getFramebufferPixelLocalStorageParameterivWEBGL:function(d,p,v){return(d=Yt[d].C.ca)?d.getFramebufferPixelLocalStorageParameterWEBGL(p,v):0},glActiveTexture:function(d){pe.activeTexture(d)},glAttachShader:function(d,p){pe.attachShader(nr[d],Mr[p])},glBindBuffer:function(d,p){d==35051?pe.Pa=p:d==35052&&(pe.Qa=p),pe.bindBuffer(d,so[p])},glBindBufferRange:function(d,p,v,k,E){pe.bindBufferRange(d,p,so[v],k,E)},glBindFramebuffer:function(d,p){pe.bindFramebuffer(d,rs[p])},glBindRenderbuffer:function(d,p){pe.bindRenderbuffer(d,lo[p])},glBindTexture:function(d,p){pe.bindTexture(d,ha[p])},glBindVertexArray:function(d){pe.bindVertexArray(is[d])},glBlendEquation:function(d){pe.blendEquation(d)},glBlendFunc:function(d,p){pe.blendFunc(d,p)},glBlitFramebuffer:function(d,p,v,k,E,I,B,$,ae,Z){pe.blitFramebuffer(d,p,v,k,E,I,B,$,ae,Z)},glBufferData:function(d,p,v,k){v&&p?pe.bufferData(d,le,k,v,p):pe.bufferData(d,p,k)},glBufferSubData:function(d,p,v,k){v&&pe.bufferSubData(d,p,le,k,v)},glClear:function(d){pe.clear(d)},glClearBufferfv:function(d,p,v){pe.clearBufferfv(d,p,Ge,v>>2)},glClearBufferuiv:function(d,p,v){pe.clearBufferuiv(d,p,se,v>>2)},glClearColor:function(d,p,v,k){pe.clearColor(d,p,v,k)},glClearDepthf:function(d){pe.clearDepth(d)},glClearStencil:function(d){pe.clearStencil(d)},glColorMask:function(d,p,v,k){pe.colorMask(!!d,!!p,!!v,!!k)},glCompileShader:function(d){pe.compileShader(Mr[d])},glCreateProgram:function(){var d=vi(nr),p=pe.createProgram();return p.name=d,p.Ba=p.za=p.Aa=0,p.Ya=1,nr[d]=p,d},glCreateShader:function(d){var p=vi(Mr);return Mr[p]=pe.createShader(d),p},glCullFace:function(d){pe.cullFace(d)},glDeleteBuffers:function(d,p){for(var v=0;v<d;v++){var k=L[p+4*v>>2],E=so[k];E&&(pe.deleteBuffer(E),E.name=0,so[k]=null,k==pe.Pa&&(pe.Pa=0),k==pe.Qa&&(pe.Qa=0))}},glDeleteFramebuffers:function(d,p){for(var v=0;v<d;++v){var k=L[p+4*v>>2],E=rs[k];E&&(pe.deleteFramebuffer(E),E.name=0,rs[k]=null)}},glDeleteProgram:function(d){if(d){var p=nr[d];p?(pe.deleteProgram(p),p.name=0,nr[d]=null):Xt(1281)}},glDeleteRenderbuffers:function(d,p){for(var v=0;v<d;v++){var k=L[p+4*v>>2],E=lo[k];E&&(pe.deleteRenderbuffer(E),E.name=0,lo[k]=null)}},glDeleteShader:function(d){if(d){var p=Mr[d];p?(pe.deleteShader(p),Mr[d]=null):Xt(1281)}},glDeleteTextures:function(d,p){for(var v=0;v<d;v++){var k=L[p+4*v>>2],E=ha[k];E&&(pe.deleteTexture(E),E.name=0,ha[k]=null)}},glDeleteVertexArrays:function(d,p){for(var v=0;v<d;v++){var k=L[p+4*v>>2];pe.deleteVertexArray(is[k]),is[k]=null}},glDepthFunc:function(d){pe.depthFunc(d)},glDepthMask:function(d){pe.depthMask(!!d)},glDepthRangef:function(d,p){pe.depthRange(d,p)},glDisable:function(d){pe.disable(d)},glDrawArrays:function(d,p,v){pe.drawArrays(d,p,v)},glDrawArraysInstanced:function(d,p,v,k){pe.drawArraysInstanced(d,p,v,k)},glDrawBuffers:function(d,p){for(var v=cl[d],k=0;k<d;k++)v[k]=L[p+4*k>>2];pe.drawBuffers(v)},glDrawElements:function(d,p,v,k){pe.drawElements(d,p,v,k)},glDrawElementsInstanced:function(d,p,v,k,E){pe.drawElementsInstanced(d,p,v,k,E)},glEnable:function(d){pe.enable(d)},glEnableVertexAttribArray:function(d){pe.enableVertexAttribArray(d)},glFlush:function(){pe.flush()},glFramebufferRenderbuffer:function(d,p,v,k){pe.framebufferRenderbuffer(d,p,v,lo[k])},glFramebufferTexture2D:function(d,p,v,k,E){pe.framebufferTexture2D(d,p,v,ha[k],E)},glFrontFace:function(d){pe.frontFace(d)},glGenBuffers:function(d,p){pa(d,p,"createBuffer",so)},glGenFramebuffers:function(d,p){pa(d,p,"createFramebuffer",rs)},glGenRenderbuffers:function(d,p){pa(d,p,"createRenderbuffer",lo)},glGenTextures:function(d,p){pa(d,p,"createTexture",ha)},glGenVertexArrays:function(d,p){pa(d,p,"createVertexArray",is)},glGenerateMipmap:function(d){pe.generateMipmap(d)},glGetError:function(){var d=pe.getError()||co;return co=0,d},glGetIntegerv:function(d,p){Uc(d,p)},glGetProgramiv:function(d,p,v){if(v)if(d>=Nc)Xt(1281);else if(d=nr[d],p==35716)d=pe.getProgramInfoLog(d),d===null&&(d="(unknown error)"),L[v>>2]=d.length+1;else if(p==35719){if(!d.Ba)for(p=0;p<pe.getProgramParameter(d,35718);++p)d.Ba=Math.max(d.Ba,pe.getActiveUniform(d,p).name.length+1);L[v>>2]=d.Ba}else if(p==35722){if(!d.za)for(p=0;p<pe.getProgramParameter(d,35721);++p)d.za=Math.max(d.za,pe.getActiveAttrib(d,p).name.length+1);L[v>>2]=d.za}else if(p==35381){if(!d.Aa)for(p=0;p<pe.getProgramParameter(d,35382);++p)d.Aa=Math.max(d.Aa,pe.getActiveUniformBlockName(d,p).length+1);L[v>>2]=d.Aa}else L[v>>2]=pe.getProgramParameter(d,p);else Xt(1281)},glGetShaderiv:function(d,p,v){v?p==35716?(d=pe.getShaderInfoLog(Mr[d]),d===null&&(d="(unknown error)"),L[v>>2]=d?d.length+1:0):p==35720?(d=pe.getShaderSource(Mr[d]),L[v>>2]=d?d.length+1:0):L[v>>2]=pe.getShaderParameter(Mr[d],p):Xt(1281)},glGetString:function(d){var p=jc[d];if(!p){switch(d){case 7939:p=pe.getSupportedExtensions()||[],p=p.concat(p.map(function(k){return"GL_"+k})),p=yi(p.join(" "));break;case 7936:case 7937:case 37445:case 37446:(p=pe.getParameter(d))||Xt(1280),p=p&&yi(p);break;case 7938:p=yi("OpenGL ES 3.0 ("+pe.getParameter(7938)+")");break;case 35724:p=pe.getParameter(35724);var v=p.match(/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/);v!==null&&(v[1].length==3&&(v[1]+="0"),p="OpenGL ES GLSL ES "+v[1]+" ("+p+")"),p=yi(p);break;default:Xt(1280)}jc[d]=p}return p},glGetUniformBlockIndex:function(d,p){return pe.getUniformBlockIndex(nr[d],p?De(le,p):"")},glGetUniformLocation:function(d,p){if(p=p?De(le,p):"",d=nr[d]){var v=d,k=v.oa,E=v.zb,I;if(!k)for(v.oa=k={},v.yb={},I=0;I<pe.getProgramParameter(v,35718);++I){var B=pe.getActiveUniform(v,I),$=B.name;B=B.size;var ae=fa($);ae=0<ae?$.slice(0,ae):$;var Z=v.Ya;for(v.Ya+=B,E[ae]=[B,Z],$=0;$<B;++$)k[Z]=$,v.yb[Z++]=ae}if(v=d.oa,k=0,E=p,I=fa(p),0<I&&(k=parseInt(p.slice(I+1))>>>0,E=p.slice(0,I)),(E=d.zb[E])&&k<E[0]&&(k+=E[1],v[k]=v[k]||pe.getUniformLocation(d,p)))return k}else Xt(1281);return-1},glInvalidateFramebuffer:function(d,p,v){for(var k=cl[p],E=0;E<p;E++)k[E]=L[v+4*E>>2];pe.invalidateFramebuffer(d,k)},glLinkProgram:function(d){d=nr[d],pe.linkProgram(d),d.oa=0,d.zb={}},glPixelStorei:function(d,p){pe.pixelStorei(d,p)},glReadPixels:function(d,p,v,k,E,I,B){if(pe.Pa)pe.readPixels(d,p,v,k,E,I,B);else{var $=Bc(I);pe.readPixels(d,p,v,k,E,I,$,B>>31-Math.clz32($.BYTES_PER_ELEMENT))}},glRenderbufferStorageMultisample:function(d,p,v,k,E){pe.renderbufferStorageMultisample(d,p,v,k,E)},glScissor:function(d,p,v,k){pe.scissor(d,p,v,k)},glShaderSource:function(d,p,v,k){for(var E="",I=0;I<p;++I){var B=k?L[k+4*I>>2]:-1,$=L[v+4*I>>2];B=$?De(le,$,0>B?void 0:B):"",E+=B}pe.shaderSource(Mr[d],E)},glStencilFunc:function(d,p,v){pe.stencilFunc(d,p,v)},glStencilFuncSeparate:function(d,p,v,k){pe.stencilFuncSeparate(d,p,v,k)},glStencilMask:function(d){pe.stencilMask(d)},glStencilOp:function(d,p,v){pe.stencilOp(d,p,v)},glStencilOpSeparate:function(d,p,v,k){pe.stencilOpSeparate(d,p,v,k)},glTexParameteri:function(d,p,v){pe.texParameteri(d,p,v)},glTexStorage2D:function(d,p,v,k,E){pe.texStorage2D(d,p,v,k,E)},glTexSubImage2D:function(d,p,v,k,E,I,B,$,ae){if(pe.Qa)pe.texSubImage2D(d,p,v,k,E,I,B,$,ae);else if(ae){var Z=Bc($);pe.texSubImage2D(d,p,v,k,E,I,B,$,Z,ae>>31-Math.clz32(Z.BYTES_PER_ELEMENT))}else pe.texSubImage2D(d,p,v,k,E,I,B,$,null)},glUniform1i:function(d,p){var v=pe,k=v.uniform1i,E=pe.Kb;if(E){var I=E.oa[d];typeof I=="number"&&(E.oa[d]=I=pe.getUniformLocation(E,E.yb[d]+(0<I?"["+I+"]":""))),d=I}else Xt(1282),d=void 0;k.call(v,d,p)},glUniformBlockBinding:function(d,p,v){d=nr[d],pe.uniformBlockBinding(d,p,v)},glUseProgram:function(d){d=nr[d],pe.useProgram(d),pe.Kb=d},glVertexAttribDivisor:function(d,p){pe.vertexAttribDivisor(d,p)},glVertexAttribIPointer:function(d,p,v,k,E){pe.vertexAttribIPointer(d,p,v,k,E)},glVertexAttribPointer:function(d,p,v,k,E,I){pe.vertexAttribPointer(d,p,v,!!k,E,I)},glViewport:function(d,p,v,k){pe.viewport(d,p,v,k)},provokingVertexWEBGL:function(d,p){(d=Yt[d].C.rb)&&d.provokingVertexWEBGL(p)},strftime_l:(d,p,v,k)=>dl(d,p,v,k),upload_image:function(d,p){var v=T.images;v&&(p=v.get(p))&&(d=Yt[d].C,d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,p),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1))}};(function(){function d(v){if(de=v=v.exports,ce=de.memory,Ue(),Ne=de.__indirect_function_table,ze.unshift(de.__wasm_call_ctors),Wt--,T.monitorRunDependencies&&T.monitorRunDependencies(Wt),Wt==0&&er){var k=er;er=null,k()}return v}var p={env:Hc,wasi_snapshot_preview1:Hc};if(Wt++,T.monitorRunDependencies&&T.monitorRunDependencies(Wt),T.instantiateWasm)try{return T.instantiateWasm(p,d)}catch(v){he("Module.instantiateWasm callback failed with error: "+v),A(v)}return Li(p,function(v){d(v.instance)}).catch(A),{}})();var Xr=d=>(Xr=de.free)(d),ss=d=>(ss=de.malloc)(d);T._setWebImage=(d,p,v)=>(T._setWebImage=de.setWebImage)(d,p,v);var qc=()=>(qc=de.__errno_location)(),rr=T._ma_device__on_notification_unlocked=d=>(rr=T._ma_device__on_notification_unlocked=de.ma_device__on_notification_unlocked)(d);T._ma_malloc_emscripten=(d,p)=>(T._ma_malloc_emscripten=de.ma_malloc_emscripten)(d,p),T._ma_free_emscripten=(d,p)=>(T._ma_free_emscripten=de.ma_free_emscripten)(d,p);var ma=T._ma_device_process_pcm_frames_capture__webaudio=(d,p,v)=>(ma=T._ma_device_process_pcm_frames_capture__webaudio=de.ma_device_process_pcm_frames_capture__webaudio)(d,p,v),fl=T._ma_device_process_pcm_frames_playback__webaudio=(d,p,v)=>(fl=T._ma_device_process_pcm_frames_playback__webaudio=de.ma_device_process_pcm_frames_playback__webaudio)(d,p,v),ml=d=>(ml=de.__getTypeName)(d);T.__embind_initialize_bindings=()=>(T.__embind_initialize_bindings=de._embind_initialize_bindings)(),T.dynCall_iiiji=(d,p,v,k,E,I)=>(T.dynCall_iiiji=de.dynCall_iiiji)(d,p,v,k,E,I),T.dynCall_iij=(d,p,v,k)=>(T.dynCall_iij=de.dynCall_iij)(d,p,v,k),T.dynCall_iiji=(d,p,v,k,E)=>(T.dynCall_iiji=de.dynCall_iiji)(d,p,v,k,E),T.dynCall_jii=(d,p,v)=>(T.dynCall_jii=de.dynCall_jii)(d,p,v),T.dynCall_vijj=(d,p,v,k,E,I)=>(T.dynCall_vijj=de.dynCall_vijj)(d,p,v,k,E,I),T.dynCall_jiji=(d,p,v,k,E)=>(T.dynCall_jiji=de.dynCall_jiji)(d,p,v,k,E),T.dynCall_viijii=(d,p,v,k,E,I,B)=>(T.dynCall_viijii=de.dynCall_viijii)(d,p,v,k,E,I,B),T.dynCall_iiiiij=(d,p,v,k,E,I,B)=>(T.dynCall_iiiiij=de.dynCall_iiiiij)(d,p,v,k,E,I,B),T.dynCall_iiiiijj=(d,p,v,k,E,I,B,$,ae)=>(T.dynCall_iiiiijj=de.dynCall_iiiiijj)(d,p,v,k,E,I,B,$,ae),T.dynCall_iiiiiijj=(d,p,v,k,E,I,B,$,ae,Z)=>(T.dynCall_iiiiiijj=de.dynCall_iiiiiijj)(d,p,v,k,E,I,B,$,ae,Z),T.___start_em_js=531476,T.___stop_em_js=534231;var ho;er=function d(){ho||gl(),ho||(er=d)};function gl(){function d(){if(!ho&&(ho=!0,T.calledRun=!0,!Me)){if(T.noFSInit||za||(za=!0,Ys(),T.stdin=T.stdin,T.stdout=T.stdout,T.stderr=T.stderr,T.stdin?Ga("stdin",T.stdin):Js("/dev/tty","/dev/stdin"),T.stdout?Ga("stdout",null,T.stdout):Js("/dev/tty","/dev/stdout"),T.stderr?Ga("stderr",null,T.stderr):Js("/dev/tty1","/dev/stderr"),zo("/dev/stdin",0),zo("/dev/stdout",1),zo("/dev/stderr",1)),Vo=!1,P(ze),V(T),T.onRuntimeInitialized&&T.onRuntimeInitialized(),T.postRun)for(typeof T.postRun=="function"&&(T.postRun=[T.postRun]);T.postRun.length;){var p=T.postRun.shift();dt.unshift(p)}P(dt)}}if(!(0<Wt)){if(T.preRun)for(typeof T.preRun=="function"&&(T.preRun=[T.preRun]);T.preRun.length;)Ot();P(Ze),0<Wt||(T.setStatus?(T.setStatus("Running..."),setTimeout(function(){setTimeout(function(){T.setStatus("")},1),d()},1)):d())}}if(T.preInit)for(typeof T.preInit=="function"&&(T.preInit=[T.preInit]);0<T.preInit.length;)T.preInit.pop()();return gl(),x.ready}})();const g=f},l=>{l.exports=JSON.parse(`{"name":"@rive-app/webgl2","version":"2.31.5","description":"Rive's webgl2 based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)","Chris Dalton <chris@rive.app> (https://rive.app)"],"license":"MIT","files":["rive.js","rive.wasm","rive.js.map","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)},(l,u,h)=>{h.r(u),h.d(u,{Animation:()=>f.Animation});var f=h(4)},(l,u,h)=>{h.r(u),h.d(u,{Animation:()=>f});var f=function(){function g(C,x,T,V){this.animation=C,this.artboard=x,this.playing=V,this.loopCount=0,this.scrubTo=null,this.instance=new T.LinearAnimationInstance(C,x)}return Object.defineProperty(g.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"time",{get:function(){return this.instance.time},set:function(C){this.instance.time=C},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),g.prototype.advance=function(C){this.scrubTo===null?this.instance.advance(C):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},g.prototype.apply=function(C){this.instance.apply(C)},g.prototype.cleanup=function(){this.instance.delete()},g}()},(l,u,h)=>{h.r(u),h.d(u,{AudioAssetWrapper:()=>C.AudioAssetWrapper,AudioWrapper:()=>C.AudioWrapper,BLANK_URL:()=>g.BLANK_URL,CustomFileAssetLoaderWrapper:()=>C.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>C.FileAssetWrapper,FileFinalizer:()=>C.FileFinalizer,FontAssetWrapper:()=>C.FontAssetWrapper,FontWrapper:()=>C.FontWrapper,ImageAssetWrapper:()=>C.ImageAssetWrapper,ImageWrapper:()=>C.ImageWrapper,createFinalization:()=>C.createFinalization,finalizationRegistry:()=>C.finalizationRegistry,registerTouchInteractions:()=>f.registerTouchInteractions,sanitizeUrl:()=>g.sanitizeUrl});var f=h(6),g=h(7),C=h(8)},(l,u,h)=>{h.r(u),h.d(u,{registerTouchInteractions:()=>C});var f=void 0,g=function(x,T){var V,A;return["touchstart","touchmove"].indexOf(x.type)>-1&&!((V=x.touches)===null||V===void 0)&&V.length?(T||x.preventDefault(),{clientX:x.touches[0].clientX,clientY:x.touches[0].clientY}):x.type==="touchend"&&!((A=x.changedTouches)===null||A===void 0)&&A.length?{clientX:x.changedTouches[0].clientX,clientY:x.changedTouches[0].clientY}:{clientX:x.clientX,clientY:x.clientY}},C=function(x){var T=x.canvas,V=x.artboard,A=x.stateMachines,W=A===void 0?[]:A,U=x.renderer,G=x.rive,F=x.fit,O=x.alignment,D=x.isTouchScrollEnabled,Q=D===void 0?!1:D,ie=x.layoutScaleFactor,Y=ie===void 0?1:ie;if(!T||!W.length||!U||!G||!V||typeof window>"u")return null;var z=null,K=!1,X=function(je){if(K&&je instanceof MouseEvent){je.type=="mouseup"&&(K=!1);return}K=Q&&je.type==="touchend"&&z==="touchstart",z=je.type;var ce=je.currentTarget.getBoundingClientRect(),de=g(je,Q),Me=de.clientX,Re=de.clientY;if(!(!Me&&!Re)){var le=Me-ce.left,Ee=Re-ce.top,ke=G.computeAlignment(F,O,{minX:0,minY:0,maxX:ce.width,maxY:ce.height},V.bounds,Y),L=new G.Mat2D;ke.invert(L);var se=new G.Vec2D(le,Ee),Ge=G.mapXY(L,se),xe=Ge.x(),Ue=Ge.y();switch(Ge.delete(),L.delete(),se.delete(),ke.delete(),je.type){case"mouseout":for(var Ne=0,Ze=W;Ne<Ze.length;Ne++){var ze=Ze[Ne];ze.pointerMove(xe,Ue)}break;case"touchmove":case"mouseover":case"mousemove":{for(var dt=0,Ot=W;dt<Ot.length;dt++){var ze=Ot[dt];ze.pointerMove(xe,Ue)}break}case"touchstart":case"mousedown":{for(var Wt=0,er=W;Wt<er.length;Wt++){var ze=er[Wt];ze.pointerDown(xe,Ue)}break}case"touchend":case"mouseup":{for(var bn=0,Sr=W;bn<Sr.length;bn++){var ze=Sr[bn];ze.pointerUp(xe,Ue)}break}}}},he=X.bind(f);return T.addEventListener("mouseover",he),T.addEventListener("mouseout",he),T.addEventListener("mousemove",he),T.addEventListener("mousedown",he),T.addEventListener("mouseup",he),T.addEventListener("touchmove",he,{passive:Q}),T.addEventListener("touchstart",he,{passive:Q}),T.addEventListener("touchend",he),function(){T.removeEventListener("mouseover",he),T.removeEventListener("mouseout",he),T.removeEventListener("mousemove",he),T.removeEventListener("mousedown",he),T.removeEventListener("mouseup",he),T.removeEventListener("touchmove",he),T.removeEventListener("touchstart",he),T.removeEventListener("touchend",he)}}},(l,u,h)=>{h.r(u),h.d(u,{BLANK_URL:()=>A,sanitizeUrl:()=>G});var f=/^([^\w]*)(javascript|data|vbscript)/im,g=/&#(\w+)(^\w|;)?/g,C=/&(newline|tab);/gi,x=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,T=/^.+(:|&colon;)/gim,V=[".","/"],A="about:blank";function W(F){return V.indexOf(F[0])>-1}function U(F){var O=F.replace(x,"");return O.replace(g,function(D,Q){return String.fromCharCode(Q)})}function G(F){if(!F)return A;var O=U(F).replace(C,"").replace(x,"").trim();if(!O)return A;if(W(O))return O;var D=O.match(T);if(!D)return O;var Q=D[0];return f.test(Q)?A:O}},(l,u,h)=>{h.r(u),h.d(u,{AudioAssetWrapper:()=>F,AudioWrapper:()=>V,CustomFileAssetLoaderWrapper:()=>W,FileAssetWrapper:()=>U,FileFinalizer:()=>g,FontAssetWrapper:()=>O,FontWrapper:()=>A,ImageAssetWrapper:()=>G,ImageWrapper:()=>T,createFinalization:()=>Y,finalizationRegistry:()=>ie});var f=function(){var z=function(K,X){return z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(he,je){he.__proto__=je}||function(he,je){for(var ce in je)Object.prototype.hasOwnProperty.call(je,ce)&&(he[ce]=je[ce])},z(K,X)};return function(K,X){if(typeof X!="function"&&X!==null)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");z(K,X);function he(){this.constructor=K}K.prototype=X===null?Object.create(X):(he.prototype=X.prototype,new he)}}(),g=function(){function z(K){this.selfUnref=!1,this._file=K}return z.prototype.unref=function(){this._file&&this._file.unref()},z}(),C=function(){function z(K){this._finalizableObject=K}return z.prototype.unref=function(){this._finalizableObject.unref()},z}(),x=function(){function z(){this.selfUnref=!1}return z.prototype.unref=function(){},z}(),T=function(z){f(K,z);function K(X){var he=z.call(this)||this;return he._nativeImage=X,he}return Object.defineProperty(K.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),K.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},K}(x),V=function(z){f(K,z);function K(X){var he=z.call(this)||this;return he._nativeAudio=X,he}return Object.defineProperty(K.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),K.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},K}(x),A=function(z){f(K,z);function K(X){var he=z.call(this)||this;return he._nativeFont=X,he}return Object.defineProperty(K.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),K.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},K}(x),W=function(){function z(K,X){this._assetLoaderCallback=X,this.assetLoader=new K.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return z.prototype.loadContents=function(K,X){var he;return K.isImage?he=new G(K):K.isAudio?he=new F(K):K.isFont&&(he=new O(K)),this._assetLoaderCallback(he,X)},z}(),U=function(){function z(K){this._nativeFileAsset=K}return z.prototype.decode=function(K){this._nativeFileAsset.decode(K)},Object.defineProperty(z.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),z}(),G=function(z){f(K,z);function K(){return z!==null&&z.apply(this,arguments)||this}return K.prototype.setRenderImage=function(X){this._nativeFileAsset.setRenderImage(X.nativeImage)},K}(U),F=function(z){f(K,z);function K(){return z!==null&&z.apply(this,arguments)||this}return K.prototype.setAudioSource=function(X){this._nativeFileAsset.setAudioSource(X.nativeAudio)},K}(U),O=function(z){f(K,z);function K(){return z!==null&&z.apply(this,arguments)||this}return K.prototype.setFont=function(X){this._nativeFileAsset.setFont(X.nativeFont)},K}(U),D=function(){function z(K){}return z.prototype.register=function(K){K.selfUnref=!0},z.prototype.unregister=function(K){},z}(),Q=typeof FinalizationRegistry<"u"?FinalizationRegistry:D,ie=new Q(function(z){z==null||z.unref()}),Y=function(z,K){var X=new C(K);ie.register(z,X)}}],r={};function a(l){var u=r[l];if(u!==void 0)return u.exports;var h=r[l]={exports:{}};return t[l](h,h.exports,a),h.exports}a.d=(l,u)=>{for(var h in u)a.o(u,h)&&!a.o(l,h)&&Object.defineProperty(l,h,{enumerable:!0,get:u[h]})},a.o=(l,u)=>Object.prototype.hasOwnProperty.call(l,u),a.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var s={};return(()=>{a.r(s),a.d(s,{Alignment:()=>G,DataEnum:()=>Ue,EventType:()=>X,Fit:()=>U,Layout:()=>F,LoopType:()=>he,Rive:()=>Ge,RiveEventType:()=>ie,RiveFile:()=>se,RuntimeLoader:()=>O,StateMachineInput:()=>Q,StateMachineInputType:()=>D,Testing:()=>Li,ViewModel:()=>xe,ViewModelInstance:()=>Ze,ViewModelInstanceArtboard:()=>Ai,ViewModelInstanceAssetImage:()=>oa,ViewModelInstanceBoolean:()=>Wt,ViewModelInstanceColor:()=>Tr,ViewModelInstanceEnum:()=>bn,ViewModelInstanceList:()=>Sr,ViewModelInstanceNumber:()=>Ot,ViewModelInstanceString:()=>dt,ViewModelInstanceTrigger:()=>er,ViewModelInstanceValue:()=>ze,decodeAudio:()=>Un,decodeFont:()=>Bo,decodeImage:()=>Ni});var l=a(1),u=a(2),h=a(3),f=a(5),g=function(){var P=function(y,S){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,J){M.__proto__=J}||function(M,J){for(var ue in J)Object.prototype.hasOwnProperty.call(J,ue)&&(M[ue]=J[ue])},P(y,S)};return function(y,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");P(y,S);function M(){this.constructor=y}y.prototype=S===null?Object.create(S):(M.prototype=S.prototype,new M)}}(),C=function(){return C=Object.assign||function(P){for(var y,S=1,M=arguments.length;S<M;S++){y=arguments[S];for(var J in y)Object.prototype.hasOwnProperty.call(y,J)&&(P[J]=y[J])}return P},C.apply(this,arguments)},x=function(P,y,S,M){function J(ue){return ue instanceof S?ue:new S(function(be){be(ue)})}return new(S||(S=Promise))(function(ue,be){function Je(st){try{De(M.next(st))}catch(Tt){be(Tt)}}function at(st){try{De(M.throw(st))}catch(Tt){be(Tt)}}function De(st){st.done?ue(st.value):J(st.value).then(Je,at)}De((M=M.apply(P,[])).next())})},T=function(P,y){var S={label:0,sent:function(){if(ue[0]&1)throw ue[1];return ue[1]},trys:[],ops:[]},M,J,ue,be=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return be.next=Je(0),be.throw=Je(1),be.return=Je(2),typeof Symbol=="function"&&(be[Symbol.iterator]=function(){return this}),be;function Je(De){return function(st){return at([De,st])}}function at(De){if(M)throw new TypeError("Generator is already executing.");for(;be&&(be=0,De[0]&&(S=0)),S;)try{if(M=1,J&&(ue=De[0]&2?J.return:De[0]?J.throw||((ue=J.return)&&ue.call(J),0):J.next)&&!(ue=ue.call(J,De[1])).done)return ue;switch(J=0,ue&&(De=[De[0]&2,ue.value]),De[0]){case 0:case 1:ue=De;break;case 4:return S.label++,{value:De[1],done:!1};case 5:S.label++,J=De[1],De=[0];continue;case 7:De=S.ops.pop(),S.trys.pop();continue;default:if(ue=S.trys,!(ue=ue.length>0&&ue[ue.length-1])&&(De[0]===6||De[0]===2)){S=0;continue}if(De[0]===3&&(!ue||De[1]>ue[0]&&De[1]<ue[3])){S.label=De[1];break}if(De[0]===6&&S.label<ue[1]){S.label=ue[1],ue=De;break}if(ue&&S.label<ue[2]){S.label=ue[2],S.ops.push(De);break}ue[2]&&S.ops.pop(),S.trys.pop();continue}De=y.call(P,S)}catch(st){De=[6,st],J=0}finally{M=ue=0}if(De[0]&5)throw De[1];return{value:De[0]?De[1]:void 0,done:!0}}},V=function(P,y,S){for(var M=0,J=y.length,ue;M<J;M++)(ue||!(M in y))&&(ue||(ue=Array.prototype.slice.call(y,0,M)),ue[M]=y[M]);return P.concat(ue||Array.prototype.slice.call(y))},A=function(P){g(y,P);function y(){var S=P!==null&&P.apply(this,arguments)||this;return S.isHandledError=!0,S}return y}(Error),W=function(P){return P&&P.isHandledError?P.message:"Problem loading file; may be corrupt!"},U;(function(P){P.Cover="cover",P.Contain="contain",P.Fill="fill",P.FitWidth="fitWidth",P.FitHeight="fitHeight",P.None="none",P.ScaleDown="scaleDown",P.Layout="layout"})(U||(U={}));var G;(function(P){P.Center="center",P.TopLeft="topLeft",P.TopCenter="topCenter",P.TopRight="topRight",P.CenterLeft="centerLeft",P.CenterRight="centerRight",P.BottomLeft="bottomLeft",P.BottomCenter="bottomCenter",P.BottomRight="bottomRight"})(G||(G={}));var F=function(){function P(y){var S,M,J,ue,be,Je,at;this.fit=(S=y==null?void 0:y.fit)!==null&&S!==void 0?S:U.Contain,this.alignment=(M=y==null?void 0:y.alignment)!==null&&M!==void 0?M:G.Center,this.layoutScaleFactor=(J=y==null?void 0:y.layoutScaleFactor)!==null&&J!==void 0?J:1,this.minX=(ue=y==null?void 0:y.minX)!==null&&ue!==void 0?ue:0,this.minY=(be=y==null?void 0:y.minY)!==null&&be!==void 0?be:0,this.maxX=(Je=y==null?void 0:y.maxX)!==null&&Je!==void 0?Je:0,this.maxY=(at=y==null?void 0:y.maxY)!==null&&at!==void 0?at:0}return P.new=function(y){var S=y.fit,M=y.alignment,J=y.minX,ue=y.minY,be=y.maxX,Je=y.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new P({fit:S,alignment:M,minX:J,minY:ue,maxX:be,maxY:Je})},P.prototype.copyWith=function(y){var S=y.fit,M=y.alignment,J=y.layoutScaleFactor,ue=y.minX,be=y.minY,Je=y.maxX,at=y.maxY;return new P({fit:S??this.fit,alignment:M??this.alignment,layoutScaleFactor:J??this.layoutScaleFactor,minX:ue??this.minX,minY:be??this.minY,maxX:Je??this.maxX,maxY:at??this.maxY})},P.prototype.runtimeFit=function(y){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var S;return this.fit===U.Cover?S=y.Fit.cover:this.fit===U.Contain?S=y.Fit.contain:this.fit===U.Fill?S=y.Fit.fill:this.fit===U.FitWidth?S=y.Fit.fitWidth:this.fit===U.FitHeight?S=y.Fit.fitHeight:this.fit===U.ScaleDown?S=y.Fit.scaleDown:this.fit===U.Layout?S=y.Fit.layout:S=y.Fit.none,this.cachedRuntimeFit=S,S},P.prototype.runtimeAlignment=function(y){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var S;return this.alignment===G.TopLeft?S=y.Alignment.topLeft:this.alignment===G.TopCenter?S=y.Alignment.topCenter:this.alignment===G.TopRight?S=y.Alignment.topRight:this.alignment===G.CenterLeft?S=y.Alignment.centerLeft:this.alignment===G.CenterRight?S=y.Alignment.centerRight:this.alignment===G.BottomLeft?S=y.Alignment.bottomLeft:this.alignment===G.BottomCenter?S=y.Alignment.bottomCenter:this.alignment===G.BottomRight?S=y.Alignment.bottomRight:S=y.Alignment.center,this.cachedRuntimeAlignment=S,S},P}(),O=function(){function P(){}return P.loadRuntime=function(){l.default({locateFile:function(){return P.wasmURL}}).then(function(y){var S;for(P.runtime=y;P.callBackQueue.length>0;)(S=P.callBackQueue.shift())===null||S===void 0||S(P.runtime)}).catch(function(y){var S={message:(y==null?void 0:y.message)||"Unknown error",type:(y==null?void 0:y.name)||"Error",wasmError:y instanceof WebAssembly.CompileError||y instanceof WebAssembly.RuntimeError,originalError:y};console.debug("Rive WASM load error details:",S);var M="https://cdn.jsdelivr.net/npm/".concat(u.name,"@").concat(u.version,"/rive_fallback.wasm");if(P.wasmURL.toLowerCase()!==M)console.warn("Failed to load WASM from ".concat(P.wasmURL," (").concat(S.message,"), trying jsdelivr as a backup")),P.setWasmUrl(M),P.loadRuntime();else{var J=["Could not load Rive WASM file from ".concat(P.wasmURL," or ").concat(M,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(S.type),"- Message: ".concat(S.message),"- WebAssembly-specific error: ".concat(S.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(J)}})},P.getInstance=function(y){P.isLoading||(P.isLoading=!0,P.loadRuntime()),P.runtime?y(P.runtime):P.callBackQueue.push(y)},P.awaitInstance=function(){return new Promise(function(y){return P.getInstance(function(S){return y(S)})})},P.setWasmUrl=function(y){P.wasmURL=y},P.getWasmUrl=function(){return P.wasmURL},P.isLoading=!1,P.callBackQueue=[],P.wasmURL="https://unpkg.com/".concat(u.name,"@").concat(u.version,"/rive.wasm"),P}(),D;(function(P){P[P.Number=56]="Number",P[P.Trigger=58]="Trigger",P[P.Boolean=59]="Boolean"})(D||(D={}));var Q=function(){function P(y,S){this.type=y,this.runtimeInput=S}return Object.defineProperty(P.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(y){this.runtimeInput.value=y},enumerable:!1,configurable:!0}),P.prototype.fire=function(){this.type===D.Trigger&&this.runtimeInput.fire()},P.prototype.delete=function(){this.runtimeInput=null},P}(),ie;(function(P){P[P.General=128]="General",P[P.OpenUrl=131]="OpenUrl"})(ie||(ie={}));var Y=function(){function P(y){this.nativeArtboard=y}return P}(),z=function(){function P(y,S,M,J){this.stateMachine=y,this.playing=M,this.artboard=J,this.inputs=[],this.instance=new S.StateMachineInstance(y,J),this.initInputs(S)}return Object.defineProperty(P.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"statesChanged",{get:function(){for(var y=[],S=0;S<this.instance.stateChangedCount();S++)y.push(this.instance.stateChangedNameByIndex(S));return y},enumerable:!1,configurable:!0}),P.prototype.advance=function(y){this.instance.advance(y)},P.prototype.advanceAndApply=function(y){this.instance.advanceAndApply(y)},P.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},P.prototype.reportedEventAt=function(y){return this.instance.reportedEventAt(y)},P.prototype.initInputs=function(y){for(var S=0;S<this.instance.inputCount();S++){var M=this.instance.input(S);this.inputs.push(this.mapRuntimeInput(M,y))}},P.prototype.mapRuntimeInput=function(y,S){if(y.type===S.SMIInput.bool)return new Q(D.Boolean,y.asBool());if(y.type===S.SMIInput.number)return new Q(D.Number,y.asNumber());if(y.type===S.SMIInput.trigger)return new Q(D.Trigger,y.asTrigger())},P.prototype.cleanup=function(){this.inputs.forEach(function(y){y.delete()}),this.inputs.length=0,this.instance.delete()},P.prototype.bindViewModelInstance=function(y){y.runtimeInstance!=null&&this.instance.bindViewModelInstance(y.runtimeInstance)},P}(),K=function(){function P(y,S,M,J,ue){J===void 0&&(J=[]),ue===void 0&&(ue=[]),this.runtime=y,this.artboard=S,this.eventManager=M,this.animations=J,this.stateMachines=ue}return P.prototype.add=function(y,S,M){if(M===void 0&&(M=!0),y=yn(y),y.length===0)this.animations.forEach(function(xt){return xt.playing=S}),this.stateMachines.forEach(function(xt){return xt.playing=S});else for(var J=this.animations.map(function(xt){return xt.name}),ue=this.stateMachines.map(function(xt){return xt.name}),be=0;be<y.length;be++){var Je=J.indexOf(y[be]),at=ue.indexOf(y[be]);if(Je>=0||at>=0)Je>=0?this.animations[Je].playing=S:this.stateMachines[at].playing=S;else{var De=this.artboard.animationByName(y[be]);if(De){var st=new h.Animation(De,this.artboard,this.runtime,S);st.advance(0),st.apply(1),this.animations.push(st)}else{var Tt=this.artboard.stateMachineByName(y[be]);if(Tt){var zt=new z(Tt,this.runtime,S,this.artboard);this.stateMachines.push(zt)}}}}return M&&(S?this.eventManager.fire({type:X.Play,data:this.playing}):this.eventManager.fire({type:X.Pause,data:this.paused})),S?this.playing:this.paused},P.prototype.initLinearAnimations=function(y,S){for(var M=this.animations.map(function(at){return at.name}),J=0;J<y.length;J++){var ue=M.indexOf(y[J]);if(ue>=0)this.animations[ue].playing=S;else{var be=this.artboard.animationByName(y[J]);if(be){var Je=new h.Animation(be,this.artboard,this.runtime,S);Je.advance(0),Je.apply(1),this.animations.push(Je)}else console.error("Animation with name ".concat(y[J]," not found."))}}},P.prototype.initStateMachines=function(y,S){for(var M=this.stateMachines.map(function(at){return at.name}),J=0;J<y.length;J++){var ue=M.indexOf(y[J]);if(ue>=0)this.stateMachines[ue].playing=S;else{var be=this.artboard.stateMachineByName(y[J]);if(be){var Je=new z(be,this.runtime,S,this.artboard);this.stateMachines.push(Je)}else console.warn("State Machine with name ".concat(y[J]," not found.")),this.initLinearAnimations([y[J]],S)}}},P.prototype.play=function(y){return this.add(y,!0)},P.prototype.advanceIfPaused=function(){this.stateMachines.forEach(function(y){y.playing||y.advanceAndApply(0)})},P.prototype.pause=function(y){return this.add(y,!1)},P.prototype.scrub=function(y,S){var M=this.animations.filter(function(J){return y.includes(J.name)});return M.forEach(function(J){return J.scrubTo=S}),M.map(function(J){return J.name})},Object.defineProperty(P.prototype,"playing",{get:function(){return this.animations.filter(function(y){return y.playing}).map(function(y){return y.name}).concat(this.stateMachines.filter(function(y){return y.playing}).map(function(y){return y.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"paused",{get:function(){return this.animations.filter(function(y){return!y.playing}).map(function(y){return y.name}).concat(this.stateMachines.filter(function(y){return!y.playing}).map(function(y){return y.name}))},enumerable:!1,configurable:!0}),P.prototype.stop=function(y){var S=this;y=yn(y);var M=[];if(y.length===0)M=this.animations.map(function(be){return be.name}).concat(this.stateMachines.map(function(be){return be.name})),this.animations.forEach(function(be){return be.cleanup()}),this.stateMachines.forEach(function(be){return be.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var J=this.animations.filter(function(be){return y.includes(be.name)});J.forEach(function(be){be.cleanup(),S.animations.splice(S.animations.indexOf(be),1)});var ue=this.stateMachines.filter(function(be){return y.includes(be.name)});ue.forEach(function(be){be.cleanup(),S.stateMachines.splice(S.stateMachines.indexOf(be),1)}),M=J.map(function(be){return be.name}).concat(ue.map(function(be){return be.name}))}return this.eventManager.fire({type:X.Stop,data:M}),M},Object.defineProperty(P.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(y,S){return y||S.playing},!1)||this.stateMachines.reduce(function(y,S){return y||S.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),P.prototype.atLeastOne=function(y,S){S===void 0&&(S=!0);var M;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([M=this.artboard.animationByIndex(0).name],y,S):this.artboard.stateMachineCount()>0&&this.add([M=this.artboard.stateMachineByIndex(0).name],y,S)),M},P.prototype.handleLooping=function(){for(var y=0,S=this.animations.filter(function(J){return J.playing});y<S.length;y++){var M=S[y];M.loopValue===0&&M.loopCount?(M.loopCount=0,this.stop(M.name)):M.loopValue===1&&M.loopCount?(this.eventManager.fire({type:X.Loop,data:{animation:M.name,type:he.Loop}}),M.loopCount=0):M.loopValue===2&&M.loopCount>1&&(this.eventManager.fire({type:X.Loop,data:{animation:M.name,type:he.PingPong}}),M.loopCount=0)}},P.prototype.handleStateChanges=function(){for(var y=[],S=0,M=this.stateMachines.filter(function(ue){return ue.playing});S<M.length;S++){var J=M[S];y.push.apply(y,J.statesChanged)}y.length>0&&this.eventManager.fire({type:X.StateChange,data:y})},P.prototype.handleAdvancing=function(y){this.eventManager.fire({type:X.Advance,data:y})},P}(),X;(function(P){P.Load="load",P.LoadError="loaderror",P.Play="play",P.Pause="pause",P.Stop="stop",P.Loop="loop",P.Draw="draw",P.Advance="advance",P.StateChange="statechange",P.RiveEvent="riveevent",P.AudioStatusChange="audiostatuschange"})(X||(X={}));var he;(function(P){P.OneShot="oneshot",P.Loop="loop",P.PingPong="pingpong"})(he||(he={}));var je=function(){function P(y){y===void 0&&(y=[]),this.listeners=y}return P.prototype.getListeners=function(y){return this.listeners.filter(function(S){return S.type===y})},P.prototype.add=function(y){this.listeners.includes(y)||this.listeners.push(y)},P.prototype.remove=function(y){for(var S=0;S<this.listeners.length;S++){var M=this.listeners[S];if(M.type===y.type&&M.callback===y.callback){this.listeners.splice(S,1);break}}},P.prototype.removeAll=function(y){var S=this;y?this.listeners.filter(function(M){return M.type===y}).forEach(function(M){return S.remove(M)}):this.listeners.splice(0,this.listeners.length)},P.prototype.fire=function(y){var S=this.getListeners(y.type);S.forEach(function(M){return M.callback(y)})},P}(),ce=function(){function P(y){this.eventManager=y,this.queue=[]}return P.prototype.add=function(y){this.queue.push(y)},P.prototype.process=function(){for(;this.queue.length>0;){var y=this.queue.shift();y!=null&&y.action&&y.action(),y!=null&&y.event&&this.eventManager.fire(y.event)}},P}(),de;(function(P){P[P.AVAILABLE=0]="AVAILABLE",P[P.UNAVAILABLE=1]="UNAVAILABLE"})(de||(de={}));var Me=function(P){g(y,P);function y(){var S=P!==null&&P.apply(this,arguments)||this;return S._started=!1,S._enabled=!1,S._status=de.UNAVAILABLE,S}return y.prototype.delay=function(S){return x(this,void 0,void 0,function(){return T(this,function(M){return[2,new Promise(function(J){return setTimeout(J,S)})]})})},y.prototype.timeout=function(){return x(this,void 0,void 0,function(){return T(this,function(S){return[2,new Promise(function(M,J){return setTimeout(J,50)})]})})},y.prototype.reportToListeners=function(){this.fire({type:X.AudioStatusChange}),this.removeAll()},y.prototype.enableAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){return this._enabled||(this._enabled=!0,this._status=de.AVAILABLE,this.reportToListeners()),[2]})})},y.prototype.testAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){switch(S.label){case 0:if(!(this._status===de.UNAVAILABLE&&this._audioContext!==null))return[3,4];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return S.sent(),this.enableAudio(),[3,4];case 3:return S.sent(),[3,4];case 4:return[2]}})})},y.prototype._establishAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){switch(S.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),S.label=2;case 2:return this._status!==de.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return S.sent(),[4,this.delay(1e3)];case 4:return S.sent(),[3,2];case 5:return[2]}})})},y.prototype.listenForUserAction=function(){var S=this,M=function(){return x(S,void 0,void 0,function(){return T(this,function(J){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",M,{once:!0})},y.prototype.establishAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){return this._establishAudio(),[2]})})},Object.defineProperty(y.prototype,"systemVolume",{get:function(){return this._status===de.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),y}(je),Re=new Me,le=function(){function P(){}return P.prototype.observe=function(){},P.prototype.unobserve=function(){},P.prototype.disconnect=function(){},P}(),Ee=globalThis.ResizeObserver||le,ke=function(){function P(){var y=this;this._elementsMap=new Map,this._onObservedEntry=function(S){var M=y._elementsMap.get(S.target);M!==null?M.onResize(S.target.clientWidth==0||S.target.clientHeight==0):y._resizeObserver.unobserve(S.target)},this._onObserved=function(S){S.forEach(y._onObservedEntry)},this._resizeObserver=new Ee(this._onObserved)}return P.prototype.add=function(y,S){var M={onResize:S,element:y};return this._elementsMap.set(y,M),this._resizeObserver.observe(y),M},P.prototype.remove=function(y){this._resizeObserver.unobserve(y.element),this._elementsMap.delete(y.element)},P}(),L=new ke,se=function(){function P(y){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.selfUnref=!1,this.src=y.src,this.buffer=y.buffer,y.assetLoader&&(this.assetLoader=y.assetLoader),this.enableRiveAssetCDN=typeof y.enableRiveAssetCDN=="boolean"?y.enableRiveAssetCDN:!0,this.eventManager=new je,y.onLoad&&this.on(X.Load,y.onLoad),y.onLoadError&&this.on(X.LoadError,y.onLoadError)}return P.prototype.releaseFile=function(){var y;this.selfUnref&&((y=this.file)===null||y===void 0||y.unref()),this.file=null},P.prototype.initData=function(){return x(this,void 0,void 0,function(){var y,S,M,J,ue;return T(this,function(be){switch(be.label){case 0:return this.src?(y=this,[4,Uo(this.src)]):[3,2];case 1:y.buffer=be.sent(),be.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(M=new f.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),S=M.assetLoader),J=this,[4,this.runtime.load(new Uint8Array(this.buffer),S,this.enableRiveAssetCDN)]);case 3:return J.file=be.sent(),ue=new f.FileFinalizer(this.file),f.finalizationRegistry.register(this,ue),this.destroyed?(this.releaseFile(),[2]):(this.file!==null?this.eventManager.fire({type:X.Load,data:this}):this.fireLoadError(P.fileLoadErrorMessage),[2])}})})},P.prototype.init=function(){return x(this,void 0,void 0,function(){var y,S;return T(this,function(M){switch(M.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(P.missingErrorMessage),[2];M.label=1;case 1:return M.trys.push([1,4,,5]),y=this,[4,O.awaitInstance()];case 2:return y.runtime=M.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return M.sent(),[3,5];case 4:return S=M.sent(),this.fireLoadError(S instanceof Error?S.message:P.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},P.prototype.fireLoadError=function(y){throw this.eventManager.fire({type:X.LoadError,data:y}),new Error(y)},P.prototype.on=function(y,S){this.eventManager.add({type:y,callback:S})},P.prototype.off=function(y,S){this.eventManager.remove({type:y,callback:S})},P.prototype.cleanup=function(){this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),this.releaseFile(),this.destroyed=!0)},P.prototype.removeAllRiveEventListeners=function(y){this.eventManager.removeAll(y)},P.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},P.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},P.prototype.getArtboard=function(y){var S=this.file.artboardByName(y);return S!=null?new Y(S):null},P.missingErrorMessage="Rive source file or data buffer required",P.fileLoadErrorMessage="The file failed to load",P}(),Ge=function(){function P(y){var S=this,M;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(J){var ue=S._hasZeroSize!==J;S._hasZeroSize=J,J?(!S._layout.maxX||!S._layout.maxY)&&S.resizeToCanvas():ue&&S.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=y.canvas,y.canvas.constructor===HTMLCanvasElement&&(this._observed=L.add(this.canvas,this.onCanvasResize)),this.src=y.src,this.buffer=y.buffer,this.riveFile=y.riveFile,this.layout=(M=y.layout)!==null&&M!==void 0?M:new F,this.shouldDisableRiveListeners=!!y.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!y.isTouchScrollEnabled,this.automaticallyHandleEvents=!!y.automaticallyHandleEvents,this.enableRiveAssetCDN=y.enableRiveAssetCDN===void 0?!0:y.enableRiveAssetCDN,this.eventManager=new je,y.onLoad&&this.on(X.Load,y.onLoad),y.onLoadError&&this.on(X.LoadError,y.onLoadError),y.onPlay&&this.on(X.Play,y.onPlay),y.onPause&&this.on(X.Pause,y.onPause),y.onStop&&this.on(X.Stop,y.onStop),y.onLoop&&this.on(X.Loop,y.onLoop),y.onStateChange&&this.on(X.StateChange,y.onStateChange),y.onAdvance&&this.on(X.Advance,y.onAdvance),y.onload&&!y.onLoad&&this.on(X.Load,y.onload),y.onloaderror&&!y.onLoadError&&this.on(X.LoadError,y.onloaderror),y.onplay&&!y.onPlay&&this.on(X.Play,y.onplay),y.onpause&&!y.onPause&&this.on(X.Pause,y.onpause),y.onstop&&!y.onStop&&this.on(X.Stop,y.onstop),y.onloop&&!y.onLoop&&this.on(X.Loop,y.onloop),y.onstatechange&&!y.onStateChange&&this.on(X.StateChange,y.onstatechange),y.assetLoader&&(this.assetLoader=y.assetLoader),this.taskQueue=new ce(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:y.autoplay,autoBind:y.autoBind,animations:y.animations,stateMachines:y.stateMachines,artboard:y.artboard,useOffscreenRenderer:y.useOffscreenRenderer})}return Object.defineProperty(P.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),P.new=function(y){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new P(y)},P.prototype.onSystemAudioChanged=function(){this.volume=this._volume},P.prototype.init=function(y){var S=this,M=y.src,J=y.buffer,ue=y.riveFile,be=y.animations,Je=y.stateMachines,at=y.artboard,De=y.autoplay,st=De===void 0?!1:De,Tt=y.useOffscreenRenderer,zt=Tt===void 0?!1:Tt,xt=y.autoBind,Bn=xt===void 0?!1:xt;if(!this.destroyed){if(this.src=M,this.buffer=J,this.riveFile=ue,!this.src&&!this.buffer&&!this.riveFile)throw new A(P.missingErrorMessage);var Pn=yn(be),wn=yn(Je);this.loaded=!1,this.readyForPlaying=!1,O.awaitInstance().then(function(en){S.destroyed||(S.runtime=en,S.removeRiveListeners(),S.deleteRiveRenderer(),S.renderer=S.runtime.makeRenderer(S.canvas,zt),S.canvas.width||S.canvas.height||S.resizeDrawingSurfaceToCanvas(),S.initData(at,Pn,wn,st,Bn).then(function(rn){if(rn)return S.setupRiveListeners()}).catch(function(rn){console.error(rn)}))}).catch(function(en){console.error(en)})}},P.prototype.setupRiveListeners=function(y){var S=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var M=(this.animator.stateMachines||[]).filter(function(ue){return ue.playing&&S.runtime.hasListeners(ue.instance)}).map(function(ue){return ue.instance}),J=this.isTouchScrollEnabled;y&&"isTouchScrollEnabled"in y&&(J=y.isTouchScrollEnabled),this.eventCleanup=(0,f.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:M,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:J,layoutScaleFactor:this._layout.layoutScaleFactor})}},P.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},P.prototype.initializeAudio=function(){var y=this,S;Re.status==de.UNAVAILABLE&&!((S=this.artboard)===null||S===void 0)&&S.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:X.AudioStatusChange,callback:function(){return y.onSystemAudioChanged()}},Re.add(this._audioEventListener),Re.establishAudio())},P.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},P.prototype.initData=function(y,S,M,J,ue){return x(this,void 0,void 0,function(){var be,Je,at,De;return T(this,function(st){switch(st.label){case 0:return st.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(be=new se({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=be,[4,be.init()]);case 1:if(st.sent(),this.destroyed)return be.destroyIfUnused(),[2,!1];st.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(y,S,M,J,ue),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:X.Load,data:(De=this.src)!==null&&De!==void 0?De:"buffer"}),this.animator.advanceIfPaused(),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return Je=st.sent(),at=W(Je),console.warn(at),this.eventManager.fire({type:X.LoadError,data:at}),[2,Promise.reject(at)];case 4:return[2]}})})},P.prototype.initArtboard=function(y,S,M,J,ue){if(this.file){var be=y?this.file.artboardByName(y):this.file.defaultArtboard();if(!be){var Je="Invalid artboard name or no default artboard";console.warn(Je),this.eventManager.fire({type:X.LoadError,data:Je});return}this.artboard=be,be.volume=this._volume*Re.systemVolume,this.animator=new K(this.runtime,this.artboard,this.eventManager);var at;if(S.length>0||M.length>0?(at=S.concat(M),this.animator.initLinearAnimations(S,J),this.animator.initStateMachines(M,J)):at=[this.animator.atLeastOne(J,!1)],this.taskQueue.add({event:{type:J?X.Play:X.Pause,data:at}}),ue){var De=this.file.defaultArtboardViewModel(be);if(De!==null){var st=De.defaultInstance();if(st!==null){var Tt=new Ze(st,null);this.bindViewModelInstance(Tt)}}}}},P.prototype.drawFrame=function(){var y,S;!((y=document==null?void 0:document.timeline)===null||y===void 0)&&y.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(S=this.runtime)===null||S===void 0||S.resolveAnimationFrame()):this.startRendering()},P.prototype.draw=function(y,S){var M;this.frameRequestId=null;var J=performance.now();this.lastRenderTime||(this.lastRenderTime=y),this.renderSecondTimer+=y-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,S==null||S());var ue=(y-this.lastRenderTime)/1e3;this.lastRenderTime=y;for(var be=this.animator.animations.filter(function(Hn){return Hn.playing||Hn.needsScrub}).sort(function(Hn){return Hn.needsScrub?-1:1}),Je=0,at=be;Je<at.length;Je++){var De=at[Je];De.advance(ue),De.instance.didLoop&&(De.loopCount+=1),De.apply(1)}for(var st=this.animator.stateMachines.filter(function(Hn){return Hn.playing}),Tt=0,zt=st;Tt<zt.length;Tt++){var xt=zt[Tt],Bn=xt.reportedEventCount();if(Bn)for(var Pn=0;Pn<Bn;Pn++){var wn=xt.reportedEventAt(Pn);if(wn)if(wn.type===ie.OpenUrl){if(this.eventManager.fire({type:X.RiveEvent,data:wn}),this.automaticallyHandleEvents){var en=document.createElement("a"),rn=wn,xr=rn.url,et=rn.target,Er=(0,f.sanitizeUrl)(xr);xr&&en.setAttribute("href",Er),et&&en.setAttribute("target",et),Er&&Er!==f.BLANK_URL&&en.click()}}else this.eventManager.fire({type:X.RiveEvent,data:wn})}xt.advanceAndApply(ue)}this.animator.stateMachines.length==0&&this.artboard.advance(ue);var Vn=this.renderer;Vn.clear(),Vn.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(Vn),Vn.restore(),Vn.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(ue),this.frameCount++;var ht=performance.now();for(this.frameTimes.push(ht),this.durations.push(ht-J);this.frameTimes[0]<=ht-1e3;)this.frameTimes.shift(),this.durations.shift();(M=this._viewModelInstance)===null||M===void 0||M.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},P.prototype.alignRenderer=function(){var y=this,S=y.renderer,M=y.runtime,J=y._layout,ue=y.artboard;S.align(J.runtimeFit(M),J.runtimeAlignment(M),{minX:J.minX,minY:J.minY,maxX:J.maxX,maxY:J.maxY},ue.bounds,this._devicePixelRatioUsed*J.layoutScaleFactor)},Object.defineProperty(P.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(y,S){return y+S},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),P.prototype.cleanup=function(){var y,S;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&L.remove(this._observed),this.removeRiveListeners(),this.file&&((y=this.riveFile)===null||y===void 0||y.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(Re.remove(this._audioEventListener),this._audioEventListener=null),(S=this._viewModelInstance)===null||S===void 0||S.cleanup(),this._viewModelInstance=null,this._dataEnums=null},P.prototype.deleteRiveRenderer=function(){var y;(y=this.renderer)===null||y===void 0||y.delete(),this.renderer=null},P.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},P.prototype.retrieveTextRun=function(y){var S;if(!y){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var M=this.artboard.textRun(y);if(!M){console.warn("Could not access a text run with name '".concat(y,"' in the '").concat((S=this.artboard)===null||S===void 0?void 0:S.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return M},P.prototype.getTextRunValue=function(y){var S=this.retrieveTextRun(y);return S?S.text:void 0},P.prototype.setTextRunValue=function(y,S){var M=this.retrieveTextRun(y);M&&(M.text=S)},P.prototype.play=function(y,S){var M=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return M.play(y,S)}});return}this.animator.play(y),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},P.prototype.pause=function(y){var S=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return S.pause(y)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(y)},P.prototype.scrub=function(y,S){var M=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return M.scrub(y,S)}});return}this.animator.scrub(y,S||0),this.drawFrame()},P.prototype.stop=function(y){var S=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return S.stop(y)}});return}this.animator&&this.animator.stop(y),this.eventCleanup&&this.eventCleanup()},P.prototype.reset=function(y){var S,M,J=y==null?void 0:y.artboard,ue=yn(y==null?void 0:y.animations),be=yn(y==null?void 0:y.stateMachines),Je=(S=y==null?void 0:y.autoplay)!==null&&S!==void 0?S:!1,at=(M=y==null?void 0:y.autoBind)!==null&&M!==void 0?M:!1;this.cleanupInstances(),this.initArtboard(J,ue,be,Je,at),this.taskQueue.process()},P.prototype.load=function(y){this.file=null,this.stop(),this.init(y)},Object.defineProperty(P.prototype,"layout",{get:function(){return this._layout},set:function(y){this._layout=y,(!y.maxX||!y.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),P.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},P.prototype.resizeDrawingSurfaceToCanvas=function(y){if(this.canvas instanceof HTMLCanvasElement&&window){var S=this.canvas.getBoundingClientRect(),M=S.width,J=S.height,ue=y||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=ue,this.canvas.width=ue*M,this.canvas.height=ue*J,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===U.Layout){var be=this._layout.layoutScaleFactor;this.artboard.width=M/be,this.artboard.height=J/be}}},Object.defineProperty(P.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var y=[],S=0;S<this.artboard.animationCount();S++)y.push(this.artboard.animationByIndex(S).name);return y},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var y=[],S=0;S<this.artboard.stateMachineCount();S++)y.push(this.artboard.stateMachineByIndex(S).name);return y},enumerable:!1,configurable:!0}),P.prototype.stateMachineInputs=function(y){if(this.loaded){var S=this.animator.stateMachines.find(function(M){return M.name===y});return S==null?void 0:S.inputs}},P.prototype.retrieveInputAtPath=function(y,S){if(!y){console.warn("No input name provided for path '".concat(S,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(y,"', at path: '").concat(S,"', but the Artboard is null"));return}var M=this.artboard.inputByPath(y,S);if(!M){console.warn("Could not access an input with name: '".concat(y,"', at path:'").concat(S,"'"));return}return M},P.prototype.setBooleanStateAtPath=function(y,S,M){var J=this.retrieveInputAtPath(y,M);J&&(J.type===D.Boolean?J.asBool().value=S:console.warn("Input with name: '".concat(y,"', at path:'").concat(M,"' is not a boolean")))},P.prototype.setNumberStateAtPath=function(y,S,M){var J=this.retrieveInputAtPath(y,M);J&&(J.type===D.Number?J.asNumber().value=S:console.warn("Input with name: '".concat(y,"', at path:'").concat(M,"' is not a number")))},P.prototype.fireStateAtPath=function(y,S){var M=this.retrieveInputAtPath(y,S);M&&(M.type===D.Trigger?M.asTrigger().fire():console.warn("Input with name: '".concat(y,"', at path:'").concat(S,"' is not a trigger")))},P.prototype.retrieveTextAtPath=function(y,S){if(!y){console.warn("No text name provided for path '".concat(S,"'"));return}if(!S){console.warn("No path provided for text '".concat(y,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(y,"', at path: '").concat(S,"', but the Artboard is null"));return}var M=this.artboard.textByPath(y,S);if(!M){console.warn("Could not access text with name: '".concat(y,"', at path:'").concat(S,"'"));return}return M},P.prototype.getTextRunValueAtPath=function(y,S){var M=this.retrieveTextAtPath(y,S);if(!M){console.warn("Could not get text with name: '".concat(y,"', at path:'").concat(S,"'"));return}return M.text},P.prototype.setTextRunValueAtPath=function(y,S,M){var J=this.retrieveTextAtPath(y,M);if(!J){console.warn("Could not set text with name: '".concat(y,"', at path:'").concat(M,"'"));return}J.text=S},Object.defineProperty(P.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(y){return y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(y){return y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(y){return!y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(y){return!y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),P.prototype.on=function(y,S){this.eventManager.add({type:y,callback:S})},P.prototype.off=function(y,S){this.eventManager.remove({type:y,callback:S})},P.prototype.unsubscribe=function(y,S){console.warn("This function is deprecated: please use `off()` instead."),this.off(y,S)},P.prototype.removeAllRiveEventListeners=function(y){this.eventManager.removeAll(y)},P.prototype.unsubscribeAll=function(y){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(y)},P.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},P.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},P.prototype.enableFPSCounter=function(y){this.runtime.enableFPSCounter(y)},P.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(P.prototype,"contents",{get:function(){if(this.loaded){for(var y={artboards:[]},S=0;S<this.file.artboardCount();S++){for(var M=this.file.artboardByIndex(S),J={name:M.name,animations:[],stateMachines:[]},ue=0;ue<M.animationCount();ue++){var be=M.animationByIndex(ue);J.animations.push(be.name)}for(var Je=0;Je<M.stateMachineCount();Je++){for(var at=M.stateMachineByIndex(Je),De=at.name,st=new this.runtime.StateMachineInstance(at,M),Tt=[],zt=0;zt<st.inputCount();zt++){var xt=st.input(zt);Tt.push({name:xt.name,type:xt.type})}J.stateMachines.push({name:De,inputs:Tt})}y.artboards.push(J)}return y}},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(y){this._volume=y,this.artboard&&(this.artboard.volume=y*Re.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"artboardWidth",{get:function(){var y;return this.artboard?this.artboard.width:(y=this._artboardWidth)!==null&&y!==void 0?y:0},set:function(y){this._artboardWidth=y,this.artboard&&(this.artboard.width=y)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"artboardHeight",{get:function(){var y;return this.artboard?this.artboard.height:(y=this._artboardHeight)!==null&&y!==void 0?y:0},set:function(y){this._artboardHeight=y,this.artboard&&(this.artboard.height=y)},enumerable:!1,configurable:!0}),P.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(P.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(y){this._devicePixelRatioUsed=y},enumerable:!1,configurable:!0}),P.prototype.bindViewModelInstance=function(y){var S;this.artboard&&!this.destroyed&&y&&y.runtimeInstance&&(y.internalIncrementReferenceCount(),(S=this._viewModelInstance)===null||S===void 0||S.cleanup(),this._viewModelInstance=y,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(M){return M.bindViewModelInstance(y)}):this.artboard.bindViewModelInstance(y.runtimeInstance))},Object.defineProperty(P.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),P.prototype.viewModelByIndex=function(y){var S=this.file.viewModelByIndex(y);return S!==null?new xe(S):null},P.prototype.viewModelByName=function(y){var S=this.file.viewModelByName(y);return S!==null?new xe(S):null},P.prototype.enums=function(){if(this._dataEnums===null){var y=this.file.enums();this._dataEnums=y.map(function(S){return new Ue(S)})}return this._dataEnums},P.prototype.defaultViewModel=function(){if(this.artboard){var y=this.file.defaultArtboardViewModel(this.artboard);if(y)return new xe(y)}return null},P.prototype.getArtboard=function(y){var S,M;return(M=(S=this.riveFile)===null||S===void 0?void 0:S.getArtboard(y))!==null&&M!==void 0?M:null},P.missingErrorMessage="Rive source file or data buffer required",P.cleanupErrorMessage="Attempt to use file after calling cleanup.",P}(),xe=function(){function P(y){this._viewModel=y}return Object.defineProperty(P.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),P.prototype.instanceByIndex=function(y){var S=this._viewModel.instanceByIndex(y);return S!==null?new Ze(S,null):null},P.prototype.instanceByName=function(y){var S=this._viewModel.instanceByName(y);return S!==null?new Ze(S,null):null},P.prototype.defaultInstance=function(){var y=this._viewModel.defaultInstance();return y!==null?new Ze(y,null):null},P.prototype.instance=function(){var y=this._viewModel.instance();return y!==null?new Ze(y,null):null},Object.defineProperty(P.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),P}(),Ue=function(){function P(y){this._dataEnum=y}return Object.defineProperty(P.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),P}(),Ne;(function(P){P.Number="number",P.String="string",P.Boolean="boolean",P.Color="color",P.Trigger="trigger",P.Enum="enum",P.List="list",P.Image="image",P.Artboard="artboard"})(Ne||(Ne={}));var Ze=function(){function P(y,S){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=y,S!==null&&this._parents.push(S)}return Object.defineProperty(P.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),P.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(y){y.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(y){y.clearChanges()})),this._children.forEach(function(y){return y.handleCallbacks()})},P.prototype.addParent=function(y){this._parents.includes(y)||(this._parents.push(y),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&y.addToViewModelCallbacks(this))},P.prototype.removeParent=function(y){var S=this._parents.indexOf(y);if(S!==-1){var M=this._parents[S];M.removeFromViewModelCallbacks(this),this._parents.splice(S,1)}},P.prototype.addToPropertyCallbacks=function(y){var S=this;this._propertiesWithCallbacks.includes(y)||(this._propertiesWithCallbacks.push(y),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(M){M.addToViewModelCallbacks(S)}))},P.prototype.removeFromPropertyCallbacks=function(y){var S=this;this._propertiesWithCallbacks.includes(y)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(M){return M!==y}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(M){M.removeFromViewModelCallbacks(S)}))},P.prototype.addToViewModelCallbacks=function(y){var S=this;this._children.includes(y)||(this._children.push(y),this._parents.forEach(function(M){M.addToViewModelCallbacks(S)}))},P.prototype.removeFromViewModelCallbacks=function(y){var S=this;this._children.includes(y)&&(this._children=this._children.filter(function(M){return M!==y}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(M){M.removeFromViewModelCallbacks(S)}))},P.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(y){y.clearCallbacks()})},P.prototype.propertyFromPath=function(y,S){var M=y.split("/");return this.propertyFromPathSegments(M,0,S)},P.prototype.viewModelFromPathSegments=function(y,S){var M=this.internalViewModelInstance(y[S]);return M!==null?S==y.length-1?M:M.viewModelFromPathSegments(y,S++):null},P.prototype.propertyFromPathSegments=function(y,S,M){var J,ue,be,Je,at,De,st,Tt,zt,xt,Bn,Pn,wn,en,rn,xr,et,Er;if(S<y.length-1){var Vn=this.internalViewModelInstance(y[S]);return Vn!==null?Vn.propertyFromPathSegments(y,S+1,M):null}var ht=null;switch(M){case Ne.Number:if(ht=(ue=(J=this._runtimeInstance)===null||J===void 0?void 0:J.number(y[S]))!==null&&ue!==void 0?ue:null,ht!==null)return new Ot(ht,this);break;case Ne.String:if(ht=(Je=(be=this._runtimeInstance)===null||be===void 0?void 0:be.string(y[S]))!==null&&Je!==void 0?Je:null,ht!==null)return new dt(ht,this);break;case Ne.Boolean:if(ht=(De=(at=this._runtimeInstance)===null||at===void 0?void 0:at.boolean(y[S]))!==null&&De!==void 0?De:null,ht!==null)return new Wt(ht,this);break;case Ne.Color:if(ht=(Tt=(st=this._runtimeInstance)===null||st===void 0?void 0:st.color(y[S]))!==null&&Tt!==void 0?Tt:null,ht!==null)return new Tr(ht,this);break;case Ne.Trigger:if(ht=(xt=(zt=this._runtimeInstance)===null||zt===void 0?void 0:zt.trigger(y[S]))!==null&&xt!==void 0?xt:null,ht!==null)return new er(ht,this);break;case Ne.Enum:if(ht=(Pn=(Bn=this._runtimeInstance)===null||Bn===void 0?void 0:Bn.enum(y[S]))!==null&&Pn!==void 0?Pn:null,ht!==null)return new bn(ht,this);break;case Ne.List:if(ht=(en=(wn=this._runtimeInstance)===null||wn===void 0?void 0:wn.list(y[S]))!==null&&en!==void 0?en:null,ht!==null)return new Sr(ht,this);break;case Ne.Image:if(ht=(xr=(rn=this._runtimeInstance)===null||rn===void 0?void 0:rn.image(y[S]))!==null&&xr!==void 0?xr:null,ht!==null)return new oa(ht,this);break;case Ne.Artboard:if(ht=(Er=(et=this._runtimeInstance)===null||et===void 0?void 0:et.artboard(y[S]))!==null&&Er!==void 0?Er:null,ht!==null)return new Ai(ht,this);break}return null},P.prototype.internalViewModelInstance=function(y){var S;if(this._viewModelInstances.has(y))return this._viewModelInstances.get(y);var M=(S=this._runtimeInstance)===null||S===void 0?void 0:S.viewModel(y);if(M!==null){var J=new P(M,this);return J.internalIncrementReferenceCount(),this._viewModelInstances.set(y,J),J}return null},P.prototype.number=function(y){var S=this.propertyFromPath(y,Ne.Number);return S},P.prototype.string=function(y){var S=this.propertyFromPath(y,Ne.String);return S},P.prototype.boolean=function(y){var S=this.propertyFromPath(y,Ne.Boolean);return S},P.prototype.color=function(y){var S=this.propertyFromPath(y,Ne.Color);return S},P.prototype.trigger=function(y){var S=this.propertyFromPath(y,Ne.Trigger);return S},P.prototype.enum=function(y){var S=this.propertyFromPath(y,Ne.Enum);return S},P.prototype.list=function(y){var S=this.propertyFromPath(y,Ne.List);return S},P.prototype.image=function(y){var S=this.propertyFromPath(y,Ne.Image);return S},P.prototype.artboard=function(y){var S=this.propertyFromPath(y,Ne.Artboard);return S},P.prototype.viewModel=function(y){var S=y.split("/"),M=S.length>1?this.viewModelFromPathSegments(S.slice(0,S.length-1),0):this;return M!=null?M.internalViewModelInstance(S[S.length-1]):null},P.prototype.internalReplaceViewModel=function(y,S){var M;if(S.runtimeInstance!==null){var J=((M=this._runtimeInstance)===null||M===void 0?void 0:M.replaceViewModel(y,S.runtimeInstance))||!1;if(J){S.internalIncrementReferenceCount();var ue=this.internalViewModelInstance(y);ue!==null&&(ue.removeParent(this),this._children.includes(ue)&&(this._children=this._children.filter(function(be){return be!==ue})),ue.cleanup()),this._viewModelInstances.set(y,S),S.addParent(this)}return J}return!1},P.prototype.replaceViewModel=function(y,S){var M,J=y.split("/"),ue=J.length>1?this.viewModelFromPathSegments(J.slice(0,J.length-1),0):this;return(M=ue==null?void 0:ue.internalReplaceViewModel(J[J.length-1],S))!==null&&M!==void 0?M:!1},P.prototype.incrementReferenceCount=function(){var y;this._referenceCount++,(y=this._runtimeInstance)===null||y===void 0||y.incrementReferenceCount()},P.prototype.decrementReferenceCount=function(){var y;this._referenceCount--,(y=this._runtimeInstance)===null||y===void 0||y.decrementReferenceCount()},Object.defineProperty(P.prototype,"properties",{get:function(){var y;return((y=this._runtimeInstance)===null||y===void 0?void 0:y.getProperties().map(function(S){return C({},S)}))||[]},enumerable:!1,configurable:!0}),P.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},P.prototype.cleanup=function(){var y=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(J){J.cleanup()}),this._viewModelInstances.clear();var S=V([],this._children);this._children.length=0;var M=V([],this._parents);this._parents.length=0,S.forEach(function(J){J.removeParent(y)}),M.forEach(function(J){J.removeFromViewModelCallbacks(y)})}},P}(),ze=function(){function P(y,S){this.callbacks=[],this._viewModelInstanceValue=y,this._parentViewModel=S}return P.prototype.on=function(y){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(y)||(this.callbacks.push(y),this._parentViewModel.addToPropertyCallbacks(this))},P.prototype.off=function(y){y?this.callbacks=this.callbacks.filter(function(S){return S!==y}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},P.prototype.internalHandleCallback=function(y){},P.prototype.handleCallbacks=function(){var y=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(S){y.internalHandleCallback(S)})},P.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},P.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(P.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),P}(),dt=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}(ze),Ot=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}(ze),Wt=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}(ze),er=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return y.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},y.prototype.internalHandleCallback=function(S){S()},y}(ze),bn=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(S){this._viewModelInstanceValue.valueIndex=S},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}(ze),Sr=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),y.prototype.addInstance=function(S){S.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(S.runtimeInstance),S.addParent(this._parentViewModel))},y.prototype.addInstanceAt=function(S,M){return S.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(S.runtimeInstance,M)?(S.addParent(this._parentViewModel),!0):!1},y.prototype.removeInstance=function(S){S.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(S.runtimeInstance),S.removeParent(this._parentViewModel))},y.prototype.removeInstanceAt=function(S){this._viewModelInstanceValue.removeInstanceAt(S)},y.prototype.instanceAt=function(S){var M=this._viewModelInstanceValue.instanceAt(S);if(M!=null){var J=new Ze(M,this._parentViewModel);return J}return null},y.prototype.swap=function(S,M){this._viewModelInstanceValue.swap(S,M)},y.prototype.internalHandleCallback=function(S){S()},y}(ze),Tr=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.rgb=function(S,M,J){this._viewModelInstanceValue.rgb(S,M,J)},y.prototype.rgba=function(S,M,J,ue){this._viewModelInstanceValue.argb(ue,S,M,J)},y.prototype.argb=function(S,M,J,ue){this._viewModelInstanceValue.argb(S,M,J,ue)},y.prototype.alpha=function(S){this._viewModelInstanceValue.alpha(S)},y.prototype.opacity=function(S){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,S))*255))},y.prototype.internalHandleCallback=function(S){S(this.value)},y}(ze),oa=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"value",{set:function(S){var M;this._viewModelInstanceValue.value((M=S==null?void 0:S.nativeImage)!==null&&M!==void 0?M:null)},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S()},y}(ze),Ai=function(P){g(y,P);function y(S,M){return P.call(this,S,M)||this}return Object.defineProperty(y.prototype,"value",{set:function(S){var M;this._viewModelInstanceValue.value((M=S==null?void 0:S.nativeArtboard)!==null&&M!==void 0?M:null)},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S()},y}(ze),Uo=function(P){return x(void 0,void 0,void 0,function(){var y,S,M;return T(this,function(J){switch(J.label){case 0:return y=new Request(P),[4,fetch(y)];case 1:return S=J.sent(),[4,S.arrayBuffer()];case 2:return M=J.sent(),[2,M]}})})},yn=function(P){return typeof P=="string"?[P]:P instanceof Array?P:[]},Li={EventManager:je,TaskQueueManager:ce},Un=function(P){return x(void 0,void 0,void 0,function(){var y,S,M;return T(this,function(J){switch(J.label){case 0:return y=new Promise(function(ue){return O.getInstance(function(be){be.decodeAudio(P,ue)})}),[4,y];case 1:return S=J.sent(),M=new f.AudioWrapper(S),f.finalizationRegistry.register(M,S),[2,M]}})})},Ni=function(P){return x(void 0,void 0,void 0,function(){var y,S,M;return T(this,function(J){switch(J.label){case 0:return y=new Promise(function(ue){return O.getInstance(function(be){be.decodeImage(P,ue)})}),[4,y];case 1:return S=J.sent(),M=new f.ImageWrapper(S),f.finalizationRegistry.register(M,S),[2,M]}})})},Bo=function(P){return x(void 0,void 0,void 0,function(){var y,S,M;return T(this,function(J){switch(J.label){case 0:return y=new Promise(function(ue){return O.getInstance(function(be){be.decodeFont(P,ue)})}),[4,y];case 1:return S=J.sent(),M=new f.FontWrapper(S),f.finalizationRegistry.register(M,S),[2,M]}})})}})(),s})())}(mf)),mf.exports}var _p=GP();function $P(n,e){e.style.borderColor=n;const t=getComputedStyle(e).getPropertyValue("border-color"),r=e.getContext("2d");return r?(r.fillStyle=t,r.fillRect(0,0,1,1),e.style.display="none",[...r.getImageData(0,0,1,1).data]):[0,0,0,255]}const KP=({restored:n})=>{const e=ve.useRef(null),t=ve.useRef(null);return ve.useEffect(()=>{const r=t.current,a=e.current;if(r==null||a==null)return;const s=new _p.Rive({src:"https://assets.nlx.ai/touchpoint/voice-plus-animation.riv",canvas:r,autoBind:!0,autoplay:!0,stateMachines:"State Machine 1",layout:new _p.Layout({fit:_p.Fit.Fill}),onLoad:()=>{s.resizeDrawingSurfaceToCanvas();const u=s.viewModelInstance;if(u!=null){const h=u.trigger("run"),f=u.trigger("runNoWave"),g=u.color("color"),C=u.number("voiceInput");C!=null&&(C.value=100),g==null||g.rgba(...$P("var(--color-accent)",a)),n?f==null||f.trigger():h==null||h.trigger()}}}),l=()=>{s.resizeDrawingSurfaceToCanvas()};return window.addEventListener("resize",l,!1),()=>{s.cleanup(),window.removeEventListener("resize",l,!1)}},[n]),R.jsxs(R.Fragment,{children:[R.jsx("canvas",{ref:e,width:"1",height:"1"}),R.jsx("canvas",{className:"pointer-events-none fixed inset-0",ref:t,style:{width:"100%",height:"100%"}})]})},JP=({feedbackState:n,feedbackActions:e})=>n.comment.state==="idle"?null:n.comment.state==="submitted"?R.jsxs("div",{className:"flex flex-col grow p-2 md:p-3 gap-2.5",children:[R.jsxs("div",{className:"flex items-center gap-2.5",children:[R.jsx(un,{type:"ghost",Icon:Mp,label:"Back",onClick:t=>{t.preventDefault(),t.stopPropagation(),e.cancelComment()}}),R.jsx("h2",{className:"",children:"Feedback submitted"})]}),R.jsx("p",{className:"grow border border-solid border-primary-10 rounded-2xl p-4",children:n.comment.text}),R.jsx(ra,{type:"ghost",label:"Edit",Icon:Uy,onClick:()=>{e.clickCommentEdit()}})]}):R.jsxs("form",{className:"flex flex-col grow p-2 gap-2.5",onSubmit:t=>{t.preventDefault(),e.submitComment()},children:[R.jsxs("div",{className:"flex items-center gap-2.5",children:[R.jsx(un,{type:"ghost",Icon:Mp,label:"Back",onClick:t=>{t.preventDefault(),t.stopPropagation(),e.cancelComment()}}),R.jsx("label",{htmlFor:"feedback-form",children:"Provide feedback"})]}),R.jsx("textarea",{id:"feedback-form",className:"grow bg-primary-5 rounded-2xl p-2",placeholder:"Enter your feedback...",value:n.comment.text,onChange:t=>{e.editCommentText(t.target.value)}}),R.jsx(ra,{type:"main",label:"Submit",Icon:Rf,onClick:()=>{}})]}),fw=ve.forwardRef((n,e)=>{var t;const r=sessionStorage.getItem("nlxActiveVoiceConversationId")===n.config.conversationId,a=ve.useMemo(()=>{const xe=sessionStorage.getItem("nlxActiveConversationResponses")??"{}";try{const Ue=JSON.parse(xe);if(Array.isArray(Ue[n.config.conversationId]))return Ue[n.config.conversationId]}catch{return null}},[n.config.conversationId]),[s,l]=ve.useState(void 0),u=ve.useMemo(()=>PC({responses:a,...n.config}),[n.config,a]);ve.useEffect(()=>(u.addEventListener("interimMessage",l),()=>{u.removeEventListener("interimMessage",l)}),[u,l]);const[h,f]=ve.useState([]),g=((t=h[h.length-1])==null?void 0:t.type)===Kn.User,C=n.colorMode??"dark",[x,T]=ve.useState(n.embedded||r),V=RC(n.config),[A,W]=ve.useState(!1),U=ve.useRef(n.embedded||r),G=n.input??"text",F=ve.useCallback(()=>{sessionStorage.removeItem("nlxActiveVoiceConversationId"),(G==="voice"||G==="voiceMini")&&(Q.current=!1,u.reset({clearResponses:!0}),sessionStorage.removeItem("nlxConversationId"))},[u,G]),O=n.onClose,D=ve.useCallback(xe=>{O!=null&&(O(xe),F(),xe.defaultPrevented||T(!1))},[O,T,F]);ve.useEffect(()=>{U.current=x},[x]),ve.useImperativeHandle(e,()=>({setExpanded(xe){xe?T(!0):(F(),T(!1))},getExpanded(){return U.current},getConversationHandler(){return u},setCustomBidirectionalCommands:xe=>{z.current(xe)}}),[u,T,F]),ve.useEffect(()=>{const xe=Ue=>{f(Ue);const Ne=u.currentConversationId();G==="text"&&Ne!=null&&sessionStorage.setItem("nlxActiveConversationResponses",JSON.stringify({[Ne]:Ue}))};return u.subscribe(xe),()=>{u.unsubscribe(xe)}},[u,f,G]);const Q=ve.useRef(r);ve.useEffect(()=>{if(!x||Q.current)return;Q.current=!0,(G!=="text"||a==null||a.length===0)&&n.initializeConversation(u,n.initialContext);const xe=u.currentConversationId();xe!=null&&sessionStorage.setItem("nlxActiveVoiceConversationId",xe)},[u,x,F,G,n,a]);const ie=ve.useRef({formElements:{},links:{},customCommands:new Map}),Y=ve.useRef([]),z=ve.useRef(xe=>{var Ue;if(((Ue=n.bidirectional)==null?void 0:Ue.automaticContext)!==!1)Y.current=xe;else throw new Error("Custom commands can only be set when automatic context is enabled.")});ve.useEffect(()=>{if(x&&n.bidirectional!=null&&n.bidirectional.automaticContext!==!1){const{teardown:xe,onCustomCommandsChange:Ue}=VP(u,Y.current,n.bidirectional.customizeAutomaticContext??(Ne=>Ne),Ne=>{ie.current=Ne});return z.current=Ue,xe}},[x,u,n.bidirectional]),ve.useEffect(()=>{if(n.bidirectional!=null&&(n.bidirectional.navigation!=null||n.bidirectional.input!=null||n.bidirectional.custom!=null||n.bidirectional.automaticContext!==!1))return WP(u,n.bidirectional,ie)},[n.bidirectional,u]);const K=n.windowSize??(n.embedded?"full":"half"),X=ve.useMemo(()=>{const xe=_v(Ne=>Ne.type===Kn.Application,h);if(xe===-1)return null;const Ue=h[xe];return(Ue==null?void 0:Ue.type)!==Kn.Application?null:{index:xe,response:Ue}},[h]),he=ve.useMemo(()=>{if(X==null)return;const xe=_v(Ne=>Ne.choices.length>0,X.response.payload.messages);if(xe===-1)return;const Ue=X.response.payload.messages[xe];if(Ue!=null)return{message:Ue,messageIndex:xe,responseIndex:X.index}},[X]),[je,ce]=ve.useState({}),de=ve.useMemo(()=>n.modalityComponents??n.customModalities??{},[n.modalityComponents,n.customModalities]),[Me,Re]=ve.useState(!0),[le,Ee]=ve.useState(0),ke=()=>{u.reset({clearResponses:!0}),F(),G!=="voice"&&n.initializeConversation(u,n.initialContext);const xe=u.currentConversationId();sessionStorage.getItem("nlxConversationId")!==null&&(xe==null?sessionStorage.removeItem("nlxConversationId"):sessionStorage.setItem("nlxConversationId",xe)),xe!=null&&sessionStorage.setItem("nlxActiveVoiceConversationId",xe),Ee(Ue=>Ue+1)},[L,se]=y_(u);if(u==null)return null;if(!x)return n.launchIcon!==!1?R.jsx(td,{className:"fixed z-launch-button bottom-2 right-2 w-fit",theme:n.theme,colorMode:C,children:R.jsx(JC,{className:"backdrop-blur-sm",iconUrl:typeof n.launchIcon=="string"?n.launchIcon:void 0,Custom:typeof n.launchIcon=="function"?n.launchIcon:void 0,onClick:()=>{T(!0)},label:"Expand chat"})}):null;if(G==="voiceMini")return R.jsx(R.Fragment,{children:R.jsxs(td,{theme:n.theme,colorMode:C,className:it("w-fit",n.embedded?"":"fixed z-touchpoint bottom-2 right-2"),children:[n.animate?R.jsx(KP,{restored:r}):null,R.jsx(z_,{handler:u,context:n.initialContext,brandIcon:n.brandIcon,onClose:()=>{D(new Event("close"))},renderCollapse:n.onClose!=null,modalityComponents:de},le)]})});const Ge=()=>{var xe,Ue;return A?R.jsx($b,{reset:()=>{ke(),W(!1)},className:it("flex-none",K==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{W(!1)},handler:u}):V?R.jsxs(R.Fragment,{children:[R.jsx(T_,{enabled:n.enabled,userMessageBubble:n.userMessageBubble??!1,agentMessageBubble:n.agentMessageBubble??!1,chatMode:n.chatMode??!0,isWaiting:g,interimMessage:s,lastApplicationResponseIndex:X==null?void 0:X.index,responses:h,colorMode:C,handler:u,uploadedFiles:je,modalityComponents:de,feedbackState:L,feedbackActions:se,className:it("grow",K==="full"?"w-full md:max-w-content md:mx-auto":"")}),R.jsxs("div",{className:it("p-2 md:p-3 flex flex-col flex-none gap-2",K==="full"?"w-full md:max-w-content md:mx-auto":""),children:[he!=null?R.jsx(w_,{...he,handler:u}):null,(he==null?void 0:he.message.selectedChoiceId)!=null?null:R.jsx(V_,{enabled:n.enabled,handler:u,uploadUrl:(Ue=(xe=X==null?void 0:X.response.payload.metadata)==null?void 0:xe.uploadUrls)==null?void 0:Ue[0],onFileUpload:({uploadId:Ne,file:Ze})=>{ce(ze=>({...ze,[Ne]:Ze}))}})]})]}):R.jsx(n0,{})};return R.jsxs(td,{theme:n.theme,colorMode:C,className:it("grid grid-cols-2 xl:grid-cols-[1fr_632px]",n.embedded?"w-full h-full":"fixed inset-0 z-touchpoint"),children:[K==="half"?R.jsx("div",{className:"hidden md:block bg-overlay"}):null,R.jsx("div",{className:it("@container/main","w-full bg-background text-primary-80 flex relative flex-col h-full backdrop-blur-overlay",{"col-span-2 md:col-span-1":K==="half","col-span-2":K==="full"}),children:L.comment.state!=="idle"?R.jsx(JP,{feedbackActions:se,feedbackState:L}):R.jsxs(R.Fragment,{children:[R.jsx(iS,{windowSize:n.embedded?"embedded":K,errorThemedCloseButton:G==="voice",speakerControls:G==="voice"?{enabled:Me,setEnabled:Re}:void 0,colorMode:C,brandIcon:G==="text"?n.brandIcon:void 0,isSettingsOpen:A,enabled:n.enabled,toggleSettings:n.enableSettings?()=>{W(xe=>!xe)}:void 0,renderCollapse:n.onClose!=null,collapse:D,reset:ke}),G==="text"?Ge():R.jsxs(R.Fragment,{children:[A?R.jsx($b,{className:it("flex-none",K==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{W(!1)},reset:()=>{ke(),W(!1)},handler:u}):null,R.jsx(ME,{brandIcon:n.brandIcon,handler:u,speakersEnabled:Me,colorMode:C,className:A?"hidden":"grow",context:n.initialContext,modalityComponents:de},le)]})]})})]})});fw.displayName="App";const mw=`/*! tailwindcss v4.1.16 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-rotate-x:initial;--tw-rotate-y:initial;--tw-rotate-z:initial;--tw-skew-x:initial;--tw-skew-y:initial;--tw-space-y-reverse:0;--tw-border-style:solid;--tw-font-weight:initial;--tw-outline-style:solid;--tw-blur:initial;--tw-brightness:initial;--tw-contrast:initial;--tw-grayscale:initial;--tw-hue-rotate:initial;--tw-invert:initial;--tw-opacity:initial;--tw-saturate:initial;--tw-sepia:initial;--tw-drop-shadow:initial;--tw-drop-shadow-color:initial;--tw-drop-shadow-alpha:100%;--tw-drop-shadow-size:initial;--tw-backdrop-blur:initial;--tw-backdrop-brightness:initial;--tw-backdrop-contrast:initial;--tw-backdrop-grayscale:initial;--tw-backdrop-hue-rotate:initial;--tw-backdrop-invert:initial;--tw-backdrop-opacity:initial;--tw-backdrop-saturate:initial;--tw-backdrop-sepia:initial;--tw-duration:initial;--tw-content:"";--glow-opacity:0%}}}@layer theme{:root,:host{--color-gray-200:oklch(92.8% .006 264.531);--color-black:#000;--spacing:.25rem;--container-sm:24rem;--text-xs:.75rem;--text-xs--line-height:calc(1/.75);--text-sm:.875rem;--text-sm--line-height:calc(1.25/.875);--text-base:1rem;--text-base--line-height: 1.5 ;--text-xl:1.25rem;--text-xl--line-height:calc(1.75/1.25);--font-weight-normal:400;--font-weight-bold:700;--radius-2xl:1rem;--animate-ping:ping 1s cubic-bezier(0,0,.2,1)infinite;--blur-sm:8px;--blur-md:12px;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--font-sans:inherit;--backdrop-blur-overlay:48px;--container-content:640px;--radius-inner:inherit;--radius-outer:inherit;--z-index-touchpoint:1000;--z-index-launch-button:100;--color-primary-80:inherit;--color-primary-60:inherit;--color-primary-40:inherit;--color-primary-20:inherit;--color-primary-10:inherit;--color-primary-5:inherit;--color-primary-1:inherit;--color-secondary-80:inherit;--color-secondary-60:inherit;--color-secondary-40:inherit;--color-secondary-20:inherit;--color-secondary-10:inherit;--color-secondary-5:inherit;--color-secondary-1:inherit;--color-accent:inherit;--color-accent-20:inherit;--color-background:inherit;--color-overlay:inherit;--color-warning-primary:inherit;--color-warning-secondary:inherit;--color-error-primary:inherit;--color-error-secondary:inherit;--animate-shimmer:shimmer 1.5s linear infinite}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:currentColor}@supports (color:color-mix(in lab,red,red)){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}::-webkit-calendar-picker-indicator{line-height:1}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}*,:after,:before,::backdrop{border-color:var(--color-gray-200,currentcolor)}::file-selector-button{border-color:var(--color-gray-200,currentcolor)}button:not(:disabled),[role=button]:not(:disabled){cursor:pointer}*{font-family:var(--font-family)!important}}@layer components;@layer utilities{.\\@container\\/main{container:main/inline-size}.pointer-events-none{pointer-events:none}.collapse{visibility:collapse}.invisible{visibility:hidden}.visible{visibility:visible}.sr-only{clip-path:inset(50%);white-space:nowrap;border-width:0;width:1px;height:1px;margin:-1px;padding:0;position:absolute;overflow:hidden}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:calc(var(--spacing)*0)}.inset-x-0{inset-inline:calc(var(--spacing)*0)}.-top-2{top:calc(var(--spacing)*-2)}.top-0{top:calc(var(--spacing)*0)}.top-1\\/2{top:50%}.right-0{right:calc(var(--spacing)*0)}.right-2{right:calc(var(--spacing)*2)}.bottom-2{bottom:calc(var(--spacing)*2)}.bottom-4{bottom:calc(var(--spacing)*4)}.bottom-\\[72px\\]{bottom:72px}.left-0{left:calc(var(--spacing)*0)}.left-1\\/2{left:50%}.z-10{z-index:10}.z-launch-button{z-index:var(--z-index-launch-button)}.z-touchpoint{z-index:var(--z-index-touchpoint)}.col-span-2{grid-column:span 2/span 2}.container{width:100%}@media (min-width:40rem){.container{max-width:40rem}}@media (min-width:48rem){.container{max-width:48rem}}@media (min-width:64rem){.container{max-width:64rem}}@media (min-width:80rem){.container{max-width:80rem}}@media (min-width:96rem){.container{max-width:96rem}}.-mx-2{margin-inline:calc(var(--spacing)*-2)}.mx-2{margin-inline:calc(var(--spacing)*2)}.mx-auto{margin-inline:auto}.mt-4{margin-top:calc(var(--spacing)*4)}.mr-2{margin-right:calc(var(--spacing)*2)}.mr-10{margin-right:calc(var(--spacing)*10)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.ml-1{margin-left:calc(var(--spacing)*1)}.ml-2{margin-left:calc(var(--spacing)*2)}.ml-3{margin-left:calc(var(--spacing)*3)}.ml-auto{margin-left:auto}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.block{display:block}.contents{display:contents}.flex{display:flex}.grid{display:grid}.hidden{display:none}.inline{display:inline}.h-4{height:calc(var(--spacing)*4)}.h-6{height:calc(var(--spacing)*6)}.h-8{height:calc(var(--spacing)*8)}.h-10{height:calc(var(--spacing)*10)}.h-20{height:calc(var(--spacing)*20)}.h-24{height:calc(var(--spacing)*24)}.h-52{height:calc(var(--spacing)*52)}.h-64{height:calc(var(--spacing)*64)}.h-72{height:calc(var(--spacing)*72)}.h-\\[128px\\]{height:128px}.h-\\[360px\\]{height:360px}.h-full{height:100%}.h-px{height:1px}.max-h-\\[40vh\\]{max-height:40vh}.max-h-\\[360px\\]{max-height:360px}.max-h-full{max-height:100%}.min-h-full{min-height:100%}.w-4{width:calc(var(--spacing)*4)}.w-6{width:calc(var(--spacing)*6)}.w-8{width:calc(var(--spacing)*8)}.w-10{width:calc(var(--spacing)*10)}.w-20{width:calc(var(--spacing)*20)}.w-24{width:calc(var(--spacing)*24)}.w-72{width:calc(var(--spacing)*72)}.w-80{width:calc(var(--spacing)*80)}.w-\\[128px\\]{width:128px}.w-\\[calc\\(100vw-16px\\)\\]{width:calc(100vw - 16px)}.w-fit{width:fit-content}.w-full{width:100%}.max-w-\\[360px\\]{max-width:360px}.max-w-content{max-width:var(--container-content)}.max-w-sm{max-width:var(--container-sm)}.flex-none{flex:none}.shrink-0{flex-shrink:0}.grow{flex-grow:1}.-translate-x-1\\/2{--tw-translate-x: -50% ;translate:var(--tw-translate-x)var(--tw-translate-y)}.translate-x-0{--tw-translate-x:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-1\\/2{--tw-translate-y: -50% ;translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-full{--tw-translate-y:-100%;translate:var(--tw-translate-x)var(--tw-translate-y)}.translate-y-0{--tw-translate-y:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.transform{transform:var(--tw-rotate-x,)var(--tw-rotate-y,)var(--tw-rotate-z,)var(--tw-skew-x,)var(--tw-skew-y,)}.animate-ping{animation:var(--animate-ping)}.cursor-pointer{cursor:pointer}.resize{resize:both}.resize-none{resize:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-\\[320px_1fr\\]{grid-template-columns:320px 1fr}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.items-end{align-items:flex-end}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.gap-0\\.5{gap:calc(var(--spacing)*.5)}.gap-1{gap:calc(var(--spacing)*1)}.gap-2{gap:calc(var(--spacing)*2)}.gap-2\\.5{gap:calc(var(--spacing)*2.5)}.gap-3{gap:calc(var(--spacing)*3)}.gap-4{gap:calc(var(--spacing)*4)}.gap-6{gap:calc(var(--spacing)*6)}:where(.space-y-1>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*1)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*1)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-2>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*2)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-4>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*4)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*4)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-6>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*6)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*6)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-8>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*8)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*8)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-px>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(1px*var(--tw-space-y-reverse));margin-block-end:calc(1px*calc(1 - var(--tw-space-y-reverse)))}.gap-x-2{column-gap:calc(var(--spacing)*2)}.truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.rounded-2xl{border-radius:var(--radius-2xl)}.rounded-full{border-radius:3.40282e38px}.rounded-inner{border-radius:var(--radius-inner)}.rounded-outer{border-radius:var(--radius-outer)}.border{border-style:var(--tw-border-style);border-width:1px}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-solid{--tw-border-style:solid;border-style:solid}.border-background{border-color:var(--color-background)}.border-primary-10{border-color:var(--color-primary-10)}.bg-\\[rgb\\(40\\,41\\,47\\)\\]{background-color:#28292f}.bg-\\[rgb\\(175\\,175\\,175\\)\\]{background-color:#afafaf}.bg-accent{background-color:var(--color-accent)}.bg-background{background-color:var(--color-background)}.bg-black\\/50{background-color:#00000080}@supports (color:color-mix(in lab,red,red)){.bg-black\\/50{background-color:color-mix(in oklab,var(--color-black)50%,transparent)}}.bg-current{background-color:currentColor}.bg-error-primary{background-color:var(--color-error-primary)}.bg-error-secondary{background-color:var(--color-error-secondary)}.bg-overlay{background-color:var(--color-overlay)}.bg-primary-5{background-color:var(--color-primary-5)}.bg-primary-10{background-color:var(--color-primary-10)}.bg-primary-80{background-color:var(--color-primary-80)}.bg-secondary-40{background-color:var(--color-secondary-40)}.bg-secondary-60{background-color:var(--color-secondary-60)}.bg-transparent{background-color:#0000}.bg-cover{background-size:cover}.bg-center{background-position:50%}.object-contain{object-fit:contain}.object-cover{object-fit:cover}.object-center{object-position:center}.p-2{padding:calc(var(--spacing)*2)}.p-2\\.5{padding:calc(var(--spacing)*2.5)}.p-3{padding:calc(var(--spacing)*3)}.p-4{padding:calc(var(--spacing)*4)}.px-1\\.5{padding-inline:calc(var(--spacing)*1.5)}.px-2{padding-inline:calc(var(--spacing)*2)}.px-3{padding-inline:calc(var(--spacing)*3)}.px-5{padding-inline:calc(var(--spacing)*5)}.py-0\\.5{padding-block:calc(var(--spacing)*.5)}.py-1{padding-block:calc(var(--spacing)*1)}.py-2{padding-block:calc(var(--spacing)*2)}.py-2\\.5{padding-block:calc(var(--spacing)*2.5)}.py-4{padding-block:calc(var(--spacing)*4)}.pr-2{padding-right:calc(var(--spacing)*2)}.pl-4{padding-left:calc(var(--spacing)*4)}.pl-10{padding-left:calc(var(--spacing)*10)}.text-center{text-align:center}.text-left{text-align:left}.text-right{text-align:right}.font-sans{font-family:var(--font-sans)}.text-base{font-size:var(--text-base);line-height:var(--tw-leading,var(--text-base--line-height))}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-xl{font-size:var(--text-xl);line-height:var(--tw-leading,var(--text-xl--line-height))}.text-xs{font-size:var(--text-xs);line-height:var(--tw-leading,var(--text-xs--line-height))}.font-normal{--tw-font-weight:var(--font-weight-normal);font-weight:var(--font-weight-normal)}.whitespace-pre-wrap{white-space:pre-wrap}.text-accent{color:var(--color-accent)}.text-accent-20{color:var(--color-accent-20)}.text-error-primary{color:var(--color-error-primary)}.text-primary-20{color:var(--color-primary-20)}.text-primary-40{color:var(--color-primary-40)}.text-primary-60{color:var(--color-primary-60)}.text-primary-80{color:var(--color-primary-80)}.text-secondary-80{color:var(--color-secondary-80)}.placeholder-primary-20::placeholder{color:var(--color-primary-20)}.placeholder-primary-40::placeholder{color:var(--color-primary-40)}.caret-accent{caret-color:var(--color-accent)}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-\\[0\\.01\\]{opacity:.01}.outline-hidden{--tw-outline-style:none;outline-style:none}@media (forced-colors:active){.outline-hidden{outline-offset:2px;outline:2px solid #0000}}.outline-0{outline-style:var(--tw-outline-style);outline-width:0}.outline-2{outline-style:var(--tw-outline-style);outline-width:2px}.outline-accent{outline-color:var(--color-accent)}.filter{filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.backdrop-blur-md{--tw-backdrop-blur:blur(var(--blur-md));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.backdrop-blur-overlay{--tw-backdrop-blur:blur(var(--backdrop-blur-overlay));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.backdrop-blur-sm{--tw-backdrop-blur:blur(var(--blur-sm));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.transition-colors{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.duration-200{--tw-duration:.2s;transition-duration:.2s}.duration-500{--tw-duration:.5s;transition-duration:.5s}.outline-solid{--tw-outline-style:solid;outline-style:solid}.placeholder\\:text-primary-40::placeholder{color:var(--color-primary-40)}.before\\:absolute:before{content:var(--tw-content);position:absolute}.before\\:inset-0:before{content:var(--tw-content);inset:calc(var(--spacing)*0)}.before\\:-z-10:before{content:var(--tw-content);z-index:-10}.before\\:bg-transparent:before{content:var(--tw-content);background-color:#0000}.before\\:transition-colors:before{content:var(--tw-content);transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.before\\:content-\\[\\'\\'\\]:before{--tw-content:"";content:var(--tw-content)}.after\\:pointer-events-none:after{content:var(--tw-content);pointer-events:none}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:inset-0:after{content:var(--tw-content);inset:calc(var(--spacing)*0)}.after\\:rounded-outer:after{content:var(--tw-content);border-radius:var(--radius-outer)}.after\\:content-\\[\\'\\'\\]:after{--tw-content:"";content:var(--tw-content)}.last\\:h-full:last-child{height:100%}@media (hover:hover){.hover\\:bg-primary-5:hover{background-color:var(--color-primary-5)}.hover\\:bg-primary-10:hover{background-color:var(--color-primary-10)}.hover\\:bg-primary-80:hover{background-color:var(--color-primary-80)}.hover\\:bg-secondary-20:hover{background-color:var(--color-secondary-20)}.hover\\:text-primary-80:hover{color:var(--color-primary-80)}.hover\\:after\\:bg-primary-10:hover:after{content:var(--tw-content);background-color:var(--color-primary-10)}}.focus\\:bg-primary-10:focus{background-color:var(--color-primary-10)}.focus\\:outline-0:focus{outline-style:var(--tw-outline-style);outline-width:0}.focus\\:before\\:bg-primary-5:focus:before{content:var(--tw-content);background-color:var(--color-primary-5)}.focus\\:before\\:bg-primary-10:focus:before{content:var(--tw-content);background-color:var(--color-primary-10)}.focus\\:before\\:bg-primary-40:focus:before{content:var(--tw-content);background-color:var(--color-primary-40)}.focus\\:before\\:bg-primary-80:focus:before{content:var(--tw-content);background-color:var(--color-primary-80)}.active\\:bg-secondary-20:active{background-color:var(--color-secondary-20)}@media (hover:hover){.enabled\\:hover\\:before\\:bg-primary-5:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-5)}.enabled\\:hover\\:before\\:bg-primary-10:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-10)}.enabled\\:hover\\:before\\:bg-primary-40:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-40)}.enabled\\:hover\\:before\\:bg-primary-80:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-80)}}.enabled\\:active\\:before\\:bg-secondary-10:enabled:active:before{content:var(--tw-content);background-color:var(--color-secondary-10)}.disabled\\:bg-accent-20:disabled{background-color:var(--color-accent-20)}.disabled\\:bg-primary-5:disabled{background-color:var(--color-primary-5)}.disabled\\:bg-primary-10:disabled{background-color:var(--color-primary-10)}.disabled\\:bg-secondary-20:disabled{background-color:var(--color-secondary-20)}.disabled\\:text-primary-20:disabled{color:var(--color-primary-20)}.disabled\\:text-primary-40:disabled{color:var(--color-primary-40)}.disabled\\:text-secondary-40:disabled{color:var(--color-secondary-40)}@media (min-width:48rem){.md\\:absolute{position:absolute}.md\\:left-0{left:calc(var(--spacing)*0)}.md\\:-order-1{order:-1}.md\\:col-span-1{grid-column:span 1/span 1}.md\\:mx-auto{margin-inline:auto}.md\\:block{display:block}.md\\:w-fit{width:fit-content}.md\\:max-w-content{max-width:var(--container-content)}.md\\:-translate-x-full{--tw-translate-x:-100%;translate:var(--tw-translate-x)var(--tw-translate-y)}.md\\:translate-y-0{--tw-translate-y:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.md\\:transform{transform:var(--tw-rotate-x,)var(--tw-rotate-y,)var(--tw-rotate-z,)var(--tw-skew-x,)var(--tw-skew-y,)}.md\\:flex-col{flex-direction:column}.md\\:p-3{padding:calc(var(--spacing)*3)}}@media (min-width:80rem){.xl\\:grid-cols-\\[1fr_632px\\]{grid-template-columns:1fr 632px}}@container main (min-width:48rem){.\\@3xl\\/main\\:absolute{position:absolute}.\\@3xl\\/main\\:top-0{top:calc(var(--spacing)*0)}.\\@3xl\\/main\\:right-0{right:calc(var(--spacing)*0)}.\\@3xl\\/main\\:left-0{left:calc(var(--spacing)*0)}}}.shimmer{background-image:linear-gradient(90deg,var(--color-primary-1)0%,var(--color-primary-40)50%,var(--color-primary-1)100%);animation:var(--animate-shimmer);background-repeat:no-repeat;background-size:80px 100%;-webkit-background-clip:text;background-clip:text}@property --glow-opacity{syntax:"<percentage>";inherits:false;initial-value:0%}.fullscreen-error svg{--glow-opacity:0%;filter:drop-shadow(0 0 6px #0000);animation:3s infinite error-glow}@supports (color:color-mix(in lab,red,red)){.fullscreen-error svg{filter:drop-shadow(0 0 6px color-mix(in srgb,transparent,var(--accent)var(--glow-opacity)))}}@keyframes error-glow{0%{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}22%{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}35%{color:var(--accent);fill-opacity:.8;--glow-opacity:60%}45%{color:var(--accent);fill-opacity:.7;--glow-opacity:30%}55%{color:var(--accent);fill-opacity:.6;--glow-opacity:60%}60%{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}to{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}}.markdown ul{list-style-type:disc;list-style-position:inside}.markdown ol{list-style-type:decimal;list-style-position:inside}.markdown hr{--tw-border-style:solid;border-style:solid;border-color:var(--color-primary-20)}.markdown a{text-decoration-line:underline}.markdown h1,.markdown h2,.markdown h3{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-rotate-x{syntax:"*";inherits:false}@property --tw-rotate-y{syntax:"*";inherits:false}@property --tw-rotate-z{syntax:"*";inherits:false}@property --tw-skew-x{syntax:"*";inherits:false}@property --tw-skew-y{syntax:"*";inherits:false}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-outline-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-drop-shadow-color{syntax:"*";inherits:false}@property --tw-drop-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-drop-shadow-size{syntax:"*";inherits:false}@property --tw-backdrop-blur{syntax:"*";inherits:false}@property --tw-backdrop-brightness{syntax:"*";inherits:false}@property --tw-backdrop-contrast{syntax:"*";inherits:false}@property --tw-backdrop-grayscale{syntax:"*";inherits:false}@property --tw-backdrop-hue-rotate{syntax:"*";inherits:false}@property --tw-backdrop-invert{syntax:"*";inherits:false}@property --tw-backdrop-opacity{syntax:"*";inherits:false}@property --tw-backdrop-saturate{syntax:"*";inherits:false}@property --tw-backdrop-sepia{syntax:"*";inherits:false}@property --tw-duration{syntax:"*";inherits:false}@property --tw-content{syntax:"*";inherits:false;initial-value:""}@keyframes ping{75%,to{opacity:0;transform:scale(2)}}@keyframes shimmer{0%{background-position:-80px 0}to{background-position:calc(100% + 80px) 0}}`,bc=({children:n,className:e,faded:t})=>R.jsx("p",{className:it("text-base",t?"text-primary-60":"text-primary-80",e),children:n}),YP=({children:n,className:e})=>R.jsx("p",{className:it("text-sm text-primary-60",e),children:n});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gw=function(n,e){return(gw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])})(n,e)},XP,Vu,QP=(function(n){/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function t(){for(var r=[],a=0;a<arguments.length;a++){var s=arguments[a];if(s){var l=typeof s;if(l==="string"||l==="number")r.push(s);else if(Array.isArray(s)&&s.length){var u=t.apply(null,s);u&&r.push(u)}else if(l==="object")for(var h in s)e.call(s,h)&&s[h]&&r.push(h)}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()}(Vu={path:XP,exports:{},require:function(n,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e==null&&Vu.path)}},Vu.exports),Vu.exports);function gf(n,e,t){var r,a,s,l,u;function h(){var g=Date.now()-l;g<e&&g>=0?r=setTimeout(h,e-g):(r=null,t||(u=n.apply(s,a),s=a=null))}e==null&&(e=100);var f=function(){s=this,a=arguments,l=Date.now();var g=t&&!r;return r||(r=setTimeout(h,e)),g&&(u=n.apply(s,a),s=a=null),u};return f.clear=function(){r&&(clearTimeout(r),r=null)},f.flush=function(){r&&(u=n.apply(s,a),s=a=null,clearTimeout(r),r=null)},f}gf.debounce=gf;var ZP=gf;(function(n,e){e===void 0&&(e={});var t=e.insertAt;if(typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t==="top"&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=n:a.appendChild(document.createTextNode(n))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var Pp,eR=(Pp="indiana-scroll-container",function(n,e){if(!n)return Pp;var t;typeof n=="string"?t=n:e=n;var r=Pp;return t&&(r+="__"+t),r+(e?Object.keys(e).reduce(function(a,s){var l=e[s];return l&&(a+=" "+(typeof l=="boolean"?r+"--"+s:r+"--"+s+"_"+l)),a},""):"")}),tR=function(n){function e(t){var r=n.call(this,t)||this;return r.onEndScroll=function(){r.scrolling=!1,!r.pressed&&r.started&&r.processEnd()},r.onScroll=function(a){var s=r.container.current;s.scrollLeft===r.scrollLeft&&s.scrollTop===r.scrollTop||(r.scrolling=!0,r.processScroll(a),r.onEndScroll())},r.onTouchStart=function(a){var s=r.props.nativeMobileScroll;if(r.isDraggable(a.target))if(r.internal=!0,s&&r.scrolling)r.pressed=!0;else{var l=a.touches[0];r.processClick(a,l.clientX,l.clientY),!s&&r.props.stopPropagation&&a.stopPropagation()}},r.onTouchEnd=function(a){var s=r.props.nativeMobileScroll;r.pressed&&(!r.started||r.scrolling&&s?r.pressed=!1:r.processEnd(),r.forceUpdate())},r.onTouchMove=function(a){var s=r.props.nativeMobileScroll;if(r.pressed&&(!s||!r.isMobile)){var l=a.touches[0];l&&r.processMove(a,l.clientX,l.clientY),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation()}},r.onMouseDown=function(a){r.isDraggable(a.target)&&r.isScrollable()&&(r.internal=!0,r.props.buttons.indexOf(a.button)!==-1&&(r.processClick(a,a.clientX,a.clientY),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation()))},r.onMouseMove=function(a){r.pressed&&(r.processMove(a,a.clientX,a.clientY),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation())},r.onMouseUp=function(a){r.pressed&&(r.started?r.processEnd():(r.internal=!1,r.pressed=!1,r.forceUpdate(),r.props.onClick&&r.props.onClick(a)),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation())},r.container=Mo.createRef(),r.onEndScroll=ZP(r.onEndScroll,300),r.scrolling=!1,r.started=!1,r.pressed=!1,r.internal=!1,r.getRef=r.getRef.bind(r),r}return function(t,r){function a(){this.constructor=t}gw(t,r),t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}(e,n),e.prototype.componentDidMount=function(){var t=this.props.nativeMobileScroll,r=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),r.addEventListener("touchstart",this.onTouchStart,{passive:!1}),r.addEventListener("mousedown",this.onMouseDown,{passive:!1}),t&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},e.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},e.prototype.getElement=function(){return this.container.current},e.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},e.prototype.isDraggable=function(t){var r=this.props.ignoreElements;if(r){var a=t.closest(r);return a===null||a.contains(this.getElement())}return!0},e.prototype.isScrollable=function(){var t=this.container.current;return t&&(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)},e.prototype.processClick=function(t,r,a){var s=this.container.current;this.scrollLeft=s.scrollLeft,this.scrollTop=s.scrollTop,this.clientX=r,this.clientY=a,this.pressed=!0},e.prototype.processStart=function(t){t===void 0&&(t=!0);var r=this.props.onStartScroll;this.started=!0,t&&document.body.classList.add("indiana-dragging"),r&&r({external:!this.internal}),this.forceUpdate()},e.prototype.processScroll=function(t){if(this.started){var r=this.props.onScroll;r&&r({external:!this.internal})}else this.processStart(!1)},e.prototype.processMove=function(t,r,a){var s=this.props,l=s.horizontal,u=s.vertical,h=s.activationDistance,f=s.onScroll,g=this.container.current;this.started?(l&&(g.scrollLeft-=r-this.clientX),u&&(g.scrollTop-=a-this.clientY),f&&f({external:!this.internal}),this.clientX=r,this.clientY=a,this.scrollLeft=g.scrollLeft,this.scrollTop=g.scrollTop):(l&&Math.abs(r-this.clientX)>h||u&&Math.abs(a-this.clientY)>h)&&(this.clientX=r,this.clientY=a,this.processStart())},e.prototype.processEnd=function(){var t=this.props.onEndScroll;this.container.current&&t&&t({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},e.prototype.getRef=function(t){[this.container,this.props.innerRef].forEach(function(r){r&&(typeof r=="function"?r(t):r.current=t)})},e.prototype.render=function(){var t=this.props,r=t.children,a=t.draggingClassName,s=t.className,l=t.style,u=t.hideScrollbars,h=t.component;return Mo.createElement(h,{className:QP(s,this.pressed&&a,eR({dragging:this.pressed,"hide-scrollbars":u,"native-scroll":this.isMobile})),style:l,ref:this.getRef,onScroll:this.onScroll},r)},e.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},e}(ve.PureComponent);const vw=ve.createContext({recentlyEndedScrolling:!1}),bw=n=>{const[e,t]=ve.useState(!1);return ve.useEffect(()=>{if(!e)return;const r=setTimeout(()=>{t(!1)},100);return()=>{clearTimeout(r)}},[e,t]),R.jsx(vw.Provider,{value:{recentlyEndedScrolling:e},children:R.jsx(tR,{className:it("flex gap-x-2 overflow-x-auto no-scrollbar px-2 -mx-2",n.className),onEndScroll:()=>{t(!0)},children:n.children})})},dm=({children:n,className:e,selected:t,onClick:r,href:a,newTab:s})=>{const l=it("block shrink-0 rounded-inner overflow-hidden","w-80 space-y-px",t?"outline-solid outline-2 outline-accent":"",r!=null||a!=null?"hover:bg-primary-5":"",e),u=ve.useContext(vw);if(ve.useEffect(()=>{a==null&&s!=null&&console.warn("Setting the `newTab` prop on the `<CustomCard/>` has no effect if the `href` is not also set.")},[a,s]),a!=null)return R.jsx("a",{className:l,href:a,onClick:r,...s?{target:"_blank",rel:"noreferrer"}:{},children:n});const h=r==null?r:()=>{u.recentlyEndedScrolling||r()};return r!=null?R.jsx("button",{className:l,onClick:h,children:n}):R.jsx("div",{className:l,children:n})},hm=({src:n,alt:e})=>R.jsx("img",{src:n,alt:e,className:"w-full h-52 object-cover"}),pm=({left:n,right:e,className:t,icon:r})=>R.jsxs("div",{className:it(t,"flex items-center relative justify-between gap-2 bg-primary-5 px-3 py-4"),children:[R.jsx("div",{className:"space-y-1 text-left",children:n}),R.jsx("div",{className:"space-y-1 text-right",children:e}),r!=null?R.jsx(r,{className:"text-primary-60 w-4 h-4 absolute top-1/2 left-1/2 transform -translate-y-1/2 -translate-x-1/2"}):null]});function fy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function nR(n,e,t){return e=xd(e),function(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(r)}(n,kw()?Reflect.construct(e,t||[],xd(n).constructor):e.apply(n,t))}function rR(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function iR(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function yw(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(h,f){if(h){if(typeof h=="string")return fy(h,f);var g={}.toString.call(h).slice(8,-1);return g==="Object"&&h.constructor&&(g=h.constructor.name),g==="Map"||g==="Set"?Array.from(h):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?fy(h,f):void 0}}(n))||e){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(h){throw h},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,l=!0,u=!1;return{s:function(){t=t.call(n)},n:function(){var h=t.next();return l=h.done,h},e:function(h){u=!0,s=h},f:function(){try{l||t.return==null||t.return()}finally{if(u)throw s}}}}function ww(n,e,t){return(e=function(r){var a=function(s,l){if(typeof s!="object"||!s)return s;var u=s[Symbol.toPrimitive];if(u!==void 0){var h=u.call(s,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return typeof a=="symbol"?a:a+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Td(){return Td=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Td.apply(null,arguments)}function xd(n){return xd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xd(n)}function aR(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&vf(n,e)}function kw(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kw=function(){return!!n})()}function my(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Hu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?my(Object(t),!0).forEach(function(r){ww(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):my(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Cw(n,e){if(n==null)return{};var t,r,a=function(l,u){if(l==null)return{};var h={};for(var f in l)if({}.hasOwnProperty.call(l,f)){if(u.includes(f))continue;h[f]=l[f]}return h}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}function vf(n,e){return vf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},vf(n,e)}function rc(n,e){var t,r=e.replacementChars,a=e.replacement,s=e.separate,l=r,u="",h=yw(n);try{for(h.s();!(t=h.n()).done;){var f,g=t.value,C=!Object.prototype.hasOwnProperty.call(a,g)&&((f=a[l[0]])===null||f===void 0?void 0:f.test(g));(s&&g===l[0]||C)&&(l=l.slice(1),u+=g)}}catch(x){h.e(x)}finally{h.f()}return u}function Sw(n,e){var t,r=e.mask,a=e.replacement,s=e.separate,l=e.showMask,u=0,h="",f=yw(r);try{for(f.s();!(t=f.n()).done;){var g=t.value;if(!l&&n[u]===void 0)break;Object.prototype.hasOwnProperty.call(a,g)&&n[u]!==void 0?h+=n[u++]:h+=g}}catch(x){f.e(x)}finally{f.f()}if(s&&!l){for(var C=r.length-1;C>=0&&h[C]===r[C];C--);h=h.slice(0,C+1)}return h}function Tw(n,e){for(var t=e.mask,r=e.replacement,a=[],s=0;s<t.length;s++){var l,u=(l=n[s])!==null&&l!==void 0?l:t[s],h=Object.prototype.hasOwnProperty.call(r,u)?"replacement":n[s]!==void 0&&n[s]!==t[s]?"input":"mask";a.push({type:h,value:u,index:s})}return a}function Gs(n){return n.length>0?ww({},n,/./):{}}function bf(n,e){for(var t=e.start,r=t===void 0?0:t,a=e.end,s=e.mask,l=e.replacement,u=e.separate,h=n.slice(r,a),f=s.slice(r,a),g="",C=0;C<f.length;C++){var x=Object.prototype.hasOwnProperty.call(l,f[C]);x&&h[C]!==void 0&&h[C]!==f[C]?g+=h[C]:x&&u&&(g+=f[C])}return g}function xw(n,e){var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r,s=RegExp("[^".concat(Object.keys(a).join(""),"]"),"g");return Sw(rc(n,{replacementChars:t.replace(s,""),replacement:a,separate:!1}),{mask:t,replacement:a,separate:!1,showMask:!1})}function oR(n,e){var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r,s=bf(n,{mask:t,replacement:a,separate:!1}),l=RegExp("[^".concat(Object.keys(a).join(""),"]"),"g");return rc(s,{replacementChars:t.replace(l,""),replacement:a,separate:!1})}function sR(n,e){var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r;return Tw(xw(n,{mask:t,replacement:a}),{mask:t,replacement:a})}var lR=["[","]","\\","/","^","$",".","|","?","*","+","(",")","{","}"];function gy(n){return lR.includes(n)?"\\".concat(n):n}function cR(n,e){for(var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r,s=n==="partial"||n==="partial-inexact",l=n==="full"||n==="partial",u="",h=0;h<t.length;h++){var f=t[h];h===0&&(u="^"),s&&(u+="("),u+=Object.prototype.hasOwnProperty.call(a,f)?"".concat(l?"(?!".concat(gy(f),")"):"","(").concat(a[f].source,")"):gy(f),h===t.length-1&&(s&&(u+=")?".repeat(t.length)),u+="$")}return u}function uR(n,e){return new Proxy(n,{set:function(t,r,a){return r==="current"&&(a!==n.current&&(n.current!==null&&e.unregister(n.current),a!==null&&e.register(a)),t[r]=a,!0)}})}function dR(n,e,t){return e=yc(e),function(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(r)}(n,fm()?Reflect.construct(e,t||[],yc(n).constructor):e.apply(n,t))}function Ew(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function _w(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function hR(n,e,t){return(e=function(r){var a=function(s,l){if(typeof s!="object"||!s)return s;var u=s[Symbol.toPrimitive];if(u!==void 0){var h=u.call(s,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return typeof a=="symbol"?a:a+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yc(n){return yc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yc(n)}function pR(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&wc(n,e)}function fm(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fm=function(){return!!n})()}function vy(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function by(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vy(Object(t),!0).forEach(function(r){hR(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):vy(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function fR(n,e){if(n==null)return{};var t,r,a=function(l,u){if(l==null)return{};var h={};for(var f in l)if({}.hasOwnProperty.call(l,f)){if(u.includes(f))continue;h[f]=l[f]}return h}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}function wc(n,e){return wc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},wc(n,e)}function yf(n){return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yf(n)}function wf(n){var e=typeof Map=="function"?new Map:void 0;return wf=function(t){if(t===null||!function(a){try{return Function.toString.call(a).indexOf("[native code]")!==-1}catch{return typeof a=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(a,s,l){if(fm())return Reflect.construct.apply(null,arguments);var u=[null];u.push.apply(u,s);var h=new(a.bind.apply(a,u));return l&&wc(h,l.prototype),h}(t,arguments,yc(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),wc(r,t)},wf(n)}var ic=function(n){function e(t){var r;return Ew(this,e),(r=dR(this,e,[t])).name="SyntheticChangeError",r}return pR(e,n),_w(e)}(wf(Error)),yy,mR=["options"],gR=["text","email","tel","search","url"],Pw=_w(function n(e){var t=e.init,r=e.tracking;Ew(this,n);var a=new WeakMap;this.register=function(s){var l;if(gR.includes(s.type)){var u=(l=s._wrapperState)!==null&&l!==void 0?l:{},h=u.initialValue,f=h===void 0?"":h,g=u.controlled,C=g!==void 0&&g,x=t({initialValue:s.value||f,controlled:C}),T=x.value,V=x.options,A={value:T,options:V,fallbackOptions:V},W={id:-1,cachedId:-1},U={value:"",selectionStart:0,selectionEnd:0},G=Object.getOwnPropertyDescriptor("_valueTracker"in s?s:HTMLInputElement.prototype,"value");Object.defineProperty(s,"value",by(by({},G),{},{set:function(Q){var ie;U.value=Q,G==null||(ie=G.set)===null||ie===void 0||ie.call(s,Q)}})),s.value=T;var F=function(){var Q=function(){var ie,Y;U.selectionStart=(ie=s.selectionStart)!==null&&ie!==void 0?ie:0,U.selectionEnd=(Y=s.selectionEnd)!==null&&Y!==void 0?Y:0,W.id=window.setTimeout(Q)};W.id=window.setTimeout(Q)},O=function(){window.clearTimeout(W.id),W.id=-1,W.cachedId=-1},D=function(Q){try{var ie,Y;if(W.cachedId===W.id)throw new ic("The input selection has not been updated.");W.cachedId=W.id;var z=s.value,K=s.selectionStart,X=s.selectionEnd;if(K===null||X===null)throw new ic("The selection attributes have not been initialized.");var he,je=U.value;if(Q.inputType===void 0&&(U.selectionStart=0,U.selectionEnd=je.length),K>U.selectionStart?he="insert":K<=U.selectionStart&&K<U.selectionEnd?he="deleteBackward":K===U.selectionEnd&&z.length<je.length&&(he="deleteForward"),he===void 0||(he==="deleteBackward"||he==="deleteForward")&&z.length>je.length)throw new ic("Input type detection error.");var ce="",de=U.selectionStart,Me=U.selectionEnd;if(he==="insert")ce=z.slice(U.selectionStart,K);else{var Re=je.length-z.length;de=K,Me=K+Re}A.value!==je?A.options=A.fallbackOptions:A.fallbackOptions=A.options;var le=A.options,Ee=r({inputType:he,previousValue:je,previousOptions:le,value:z,addedValue:ce,changeStart:de,changeEnd:Me,selectionStart:K,selectionEnd:X}),ke=Ee.options,L=fR(Ee,mR);s.value=L.value,s.setSelectionRange(L.selectionStart,L.selectionEnd),A.value=L.value,A.options=ke,U.selectionStart=L.selectionStart,U.selectionEnd=L.selectionEnd,(ie=s._valueTracker)===null||ie===void 0||(Y=ie.setValue)===null||Y===void 0||Y.call(ie,je)}catch(se){if(s.value=U.value,s.setSelectionRange(U.selectionStart,U.selectionEnd),Q.preventDefault(),Q.stopPropagation(),se.name!=="SyntheticChangeError")throw se}};document.activeElement===s&&F(),s.addEventListener("focus",F),s.addEventListener("blur",O),s.addEventListener("input",D),a.set(s,{onFocus:F,onBlur:O,onInput:D})}},this.unregister=function(s){var l=a.get(s);l!==void 0&&(s.removeEventListener("focus",l.onFocus),s.removeEventListener("blur",l.onBlur),s.removeEventListener("input",l.onInput),a.delete(s))}});yy=Pw,Object.defineProperty(yy.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Input"});function vR(n,e){return ve.useCallback(function(t){n.current=t,typeof e=="function"?e(t):yf(e)==="object"&&e!==null&&(e.current=t)},[n,e])}var wy,bR=["track","modify"];function Ps(n){var e,t,r,a;return{mask:(e=n.mask)!==null&&e!==void 0?e:"",replacement:typeof n.replacement=="string"?Gs(n.replacement):(t=n.replacement)!==null&&t!==void 0?t:{},showMask:(r=n.showMask)!==null&&r!==void 0&&r,separate:(a=n.separate)!==null&&a!==void 0&&a,track:n.track,modify:n.modify}}var Rw=function(n){function e(){var t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rR(this,e),(t=nR(this,e,[{init:function(a){var s=a.initialValue,l=a.controlled,u=Ps(r),h=u.mask,f=u.replacement,g=u.separate,C=u.showMask;return s=l||s?s:C?h:"",{value:s,options:{mask:h,replacement:f,separate:g}}},tracking:function(a){var s=a.inputType,l=a.previousValue,u=a.previousOptions,h=a.addedValue,f=a.changeStart,g=a.changeEnd,C=Ps(r),x=C.track,T=C.modify,V=Cw(C,bR),A=V.mask,W=V.replacement,U=V.showMask,G=V.separate,F=Hu(Hu({},s==="insert"?{inputType:s,data:h}:{inputType:s,data:null}),{},{value:l,selectionStart:f,selectionEnd:g}),O=x==null?void 0:x(F);if(O===!1)throw new ic("Custom tracking stop.");O===null?h="":O!==!0&&O!==void 0&&(h=O);var D=T==null?void 0:T(F);(D==null?void 0:D.mask)!==void 0&&(A=D.mask),(D==null?void 0:D.replacement)!==void 0&&(W=typeof(D==null?void 0:D.replacement)=="string"?Gs(D==null?void 0:D.replacement):D.replacement),(D==null?void 0:D.showMask)!==void 0&&(U=D.showMask),(D==null?void 0:D.separate)!==void 0&&(G=D.separate);var Q=bf(l,Hu({end:f},u)),ie=bf(l,Hu({start:g},u)),Y=RegExp("[^".concat(Object.keys(W).join(""),"]"),"g"),z=A.replace(Y,"");if(Q&&(Q=rc(Q,{replacementChars:z,replacement:W,separate:G}),z=z.slice(Q.length)),h&&(h=rc(h,{replacementChars:z,replacement:W,separate:!1}),z=z.slice(h.length)),s==="insert"&&h==="")throw new ic("The character does not match the key value of the `replacement` object.");if(G){var K=A.slice(f,g).replace(Y,""),X=K.length-h.length;X<0?ie=ie.slice(-X):X>0&&(ie=K.slice(-X)+ie)}ie&&(ie=rc(ie,{replacementChars:z,replacement:W,separate:G}));var he=Sw(Q+h+ie,{mask:A,replacement:W,separate:G,showMask:U}),je=function(ce){var de,Me,Re,le=ce.inputType,Ee=ce.value,ke=ce.addedValue,L=ce.beforeChangeValue,se=ce.mask,Ge=ce.replacement,xe=ce.separate,Ue=Tw(Ee,{mask:se,replacement:Ge}).filter(function(Ot){var Wt=Ot.type;return Wt==="input"||xe&&Wt==="replacement"}),Ne=(de=Ue[L.length+ke.length-1])===null||de===void 0?void 0:de.index,Ze=(Me=Ue[L.length-1])===null||Me===void 0?void 0:Me.index,ze=(Re=Ue[L.length+ke.length])===null||Re===void 0?void 0:Re.index;if(le==="insert"){if(Ne!==void 0)return Ne+1;if(ze!==void 0)return ze;if(Ze!==void 0)return Ze+1}if(le==="deleteForward"){if(ze!==void 0)return ze;if(Ze!==void 0)return Ze+1}if(le==="deleteBackward"){if(Ze!==void 0)return Ze+1;if(ze!==void 0)return ze}var dt=Ee.split("").findIndex(function(Ot){return Object.prototype.hasOwnProperty.call(Ge,Ot)});return dt!==-1?dt:Ee.length}({inputType:s,value:he,addedValue:h,beforeChangeValue:Q,mask:A,replacement:W,separate:G});return{value:he,selectionStart:je,selectionEnd:je,options:{mask:A,replacement:W,separate:G}}}}])).format=function(a){return xw(a,Ps(r))},t.formatToParts=function(a){return sR(a,Ps(r))},t.unformat=function(a){return oR(a,Ps(r))},t.generatePattern=function(a){return cR(a,Ps(r))},t}return aR(e,Pw),iR(e)}();wy=Rw,Object.defineProperty(wy.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Mask"});function yR(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.mask,t=n.replacement,r=n.showMask,a=n.separate,s=n.track,l=n.modify,u=ve.useRef(null),h=ve.useRef({mask:e,replacement:t,showMask:r,separate:a,track:s,modify:l});return h.current.mask=e,h.current.replacement=t,h.current.showMask=r,h.current.separate=a,h.current.track=s,h.current.modify=l,ve.useMemo(function(){return uR(u,new Rw(h.current))},[])}var wR=["component","mask","replacement","showMask","separate","track","modify"];function kR(n,e){var t=n.component,r=n.mask,a=n.replacement,s=n.showMask,l=n.separate,u=n.track,h=n.modify,f=Cw(n,wR),g=yR({mask:r,replacement:a,showMask:s,separate:l,track:u,modify:h}),C=vR(g,e);return t?Mo.createElement(t,Td({ref:C},f)):Mo.createElement("input",Td({ref:C},f))}var CR=ve.forwardRef(kR);const SR={mask:"MM / DD / YYYY",replacement:{D:/\d/,M:/\d/,Y:/\d/},showMask:!0},Iw=({onSubmit:n,className:e})=>{const t=n==null,[r,a]=ve.useState(null);return R.jsxs("div",{className:it("relative bg-primary-5 flex items-center justify-between pl-4 py-2 pr-2 rounded-outer transition-colors duration-500 before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",t?"":"hover:bg-secondary-20",e),children:[R.jsxs("div",{className:"flex items-center",children:[R.jsx(Dy,{className:"w-4 h-4 text-primary-60"}),R.jsx(CR,{...SR,className:it("bg-transparent text-primary-80 outline-0 ml-2 py-2.5",t?"placeholder-primary-20 pointer-events-none":"placeholder-primary-40"),placeholder:"MM / DD / YYYY",onChange:s=>{const l=s.target.value,[u,h,f]=l.split(" / ");u!=null&&u.length===2&&h!=null&&h.length===2&&f!=null&&f.length===4?a(`${f}-${u}-${h}`):a(null)}})]}),R.jsx(un,{className:"flex-none",label:"Send message",onClick:r==null||n==null?void 0:()=>{n(r)},type:"main",Icon:Ed})]})},Mw=(n,e)=>t=>{n!=null&&(n.type==="slot"&&e.sendSlots({[n.id]:t}),n.type==="context"&&e.sendContext({[n.id]:t}),n.type==="choiceId"&&e.sendChoice(typeof t=="string"?t:JSON.stringify(t)))},TR=({data:n,className:e,conversationHandler:t})=>{const r=ve.useMemo(()=>Mw(n.$saveAs,t),[n.$saveAs,t]);return R.jsx(Iw,{className:e,onSubmit:r})},xR=({data:n,className:e,renderedAsOverlay:t})=>R.jsxs(dm,{className:it(e),children:[n.thumbnail!=null?R.jsx(hm,{src:n.thumbnail,alt:n.thumbnailAlt}):null,n.rows!=null?n.rows.map((r,a)=>R.jsx(pm,{className:t?"backdrop-blur-overlay":"",left:R.jsx(bc,{faded:!0,children:r.label}),right:R.jsx(bc,{children:r.value})},a)):null]}),ER=({data:n,className:e,conversationHandler:t,renderedAsOverlay:r})=>{const[a,s]=ve.useState(null),l=ve.useMemo(()=>Mw(n.$saveAs,t),[n.$saveAs,t]),u=h=>{s(h),l(h)};return R.jsx(bw,{className:e,children:n.cards.map((h,f)=>R.jsxs(dm,{className:r?"backdrop-blur-overlay":"",selected:h.id===a,onClick:h.id!=null&&n.$saveAs!=null?()=>{h.id!=null&&u(h.id)}:void 0,children:[h.thumbnail!=null?R.jsx(hm,{src:h.thumbnail,alt:h.thumbnailAlt}):null,h.rows!=null?h.rows.map((g,C)=>R.jsx(pm,{left:R.jsx(bc,{faded:!0,children:g.label}),right:R.jsx(bc,{children:g.value})},C)):null]},h.id??f))})},NR=({children:n,mode:e,theme:t})=>R.jsxs(R.Fragment,{children:[R.jsx("style",{children:mw}),R.jsx(td,{className:"bg-background p-4 rounded-outer space-y-4",theme:t,colorMode:e,children:n})]}),jR=Xk.version,_R=n=>Ak.bind((e,...t)=>ve.createElement(n[e]??e,...t)),DR=_R({TextButton:ra,IconButton:un,BaseText:bc,SmallText:YP,DateInput:Iw,Carousel:bw,CustomCard:dm,CustomCardRow:pm,CustomCardImageRow:hm,Ripple:cc,...KC}),PR=()=>{const n=crypto.randomUUID();return sessionStorage.setItem("nlxConversationId",n),n},RR=()=>{const n=crypto.randomUUID();return localStorage.setItem("nlxUserId",n),n},IR=n=>{const e=n.config.applicationUrl??("botUrl"in n.config?n.config.botUrl:void 0);"botUrl"in n.config&&console.warn("The 'botUrl' configuration option is deprecated. Use 'applicationUrl' instead."),"customModalities"in n&&console.warn("The 'customModalities' configuration option is deprecated. Use 'modalityComponents' instead.");const t={...n.modalityComponents??n.customModalities??{},DefaultDateInput:TR,DefaultCard:xR,DefaultCarousel:ER};return{...n,config:{...n.config,applicationUrl:e,conversationId:n.config.conversationId??sessionStorage.getItem("nlxConversationId")??PR(),userId:n.config.userId??localStorage.getItem("nlxUserId")??RR(),bidirectional:n.bidirectional==null?n.config.bidirectional??!1:!0},input:n.input??"text",modalityComponents:t,initializeConversation:n.initializeConversation??((r,a)=>{((n==null?void 0:n.input)??"text")==="text"&&r.sendWelcomeFlow(a)})}};let Ow=()=>{const n=document.createElement("style");n.textContent=`:where(nlx-touchpoint.nlx-text, nlx-touchpoint.nlx-voice) {
    display: block;
    height: 350px;
  }
  :where(nlx-touchpoint.nlx-voiceMini) {
   display: inline-block;

  }`,document.head.appendChild(n),Ow=()=>{}};var Ls,Jl,La,ac,rd,kf;class MR extends HTMLElement{constructor(){super(...arguments),Nl(this,rd),Nl(this,Ls,null),Nl(this,Jl,null),Nl(this,La,null),Ct(this,"onRef",null),Ct(this,"embedded",!0),Ct(this,"onClose",null),Ct(this,"enableSettings",!1),Nl(this,ac,!0)}set enabled(e){Br(this,ac)!==e&&(id(this,ac,e),nv(this,rd,kf).call(this))}set touchpointConfiguration(e){Ef(Br(this,La),e)||(id(this,La,e),nv(this,rd,kf).call(this))}connectedCallback(){var e;if(Br(this,La)==null&&this.getAttribute("configuration")!=null)try{this.touchpointConfiguration=JSON.parse(this.getAttribute("configuration")??"")}catch(t){throw new Error("Failed to parse touchpoint configuration: "+(t instanceof Error?t.message:String(t)))}this.embedded&&(Ow(),this.classList.add(`nlx-${((e=Br(this,La))==null?void 0:e.input)??"text"}`))}disconnectedCallback(){var e;(e=Br(this,Ls))==null||e.unmount()}}Ls=new WeakMap,Jl=new WeakMap,La=new WeakMap,ac=new WeakMap,rd=new WeakSet,kf=function(){if(Br(this,Jl)??id(this,Jl,this.attachShadow({mode:"closed"})),Br(this,Ls)??id(this,Ls,Ok.createRoot(Br(this,Jl))),Br(this,La)!=null){const n=IR(Br(this,La));Br(this,Ls).render(R.jsxs(R.Fragment,{children:[R.jsx("style",{children:mw}),R.jsx(fw,{...n,embedded:this.embedded,onClose:this.onClose,enableSettings:this.enableSettings,enabled:Br(this,ac),ref:e=>{var t;e!=null&&((t=this.onRef)==null||t.call(this,e))}})]}))}};const OR=(n,e)=>{customElements.get(n)==null&&customElements.define(n,e)};OR("nlx-touchpoint",MR);const FR=n=>new Promise(e=>{const t=document.createElement("nlx-touchpoint");t.embedded=!1,t.onRef=r=>{e({set expanded(a){r.setExpanded(a)},get expanded(){return r.getExpanded()},get conversationHandler(){return r.getConversationHandler()},teardown:()=>{document.body.removeChild(t)},setCustomBidirectionalCommands(a){r.setCustomBidirectionalCommands(a)}})},t.onClose=()=>{},t.enableSettings=!0,t.touchpointConfiguration=n,document.body.appendChild(t)});export{bc as BaseText,bw as Carousel,dm as CustomCard,hm as CustomCardImageRow,pm as CustomCardRow,Iw as DateInput,un as IconButton,KC as Icons,NR as PreviewContainer,Mo as React,cc as Ripple,YP as SmallText,ra as TextButton,UP as analyzePageForms,FR as create,DR as html,jR as version};
