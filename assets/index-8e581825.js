var Zy=Object.defineProperty,Dm=t=>{throw TypeError(t)},Qy=(t,e,n)=>e in t?Zy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ie=(t,e,n)=>Qy(t,typeof e!="symbol"?e+"":e,n),rd=(t,e,n)=>e.has(t)||Dm("Cannot "+n),kt=(t,e,n)=>(rd(t,e,"read from private field"),n?n.call(t):e.get(t)),Di=(t,e,n)=>e.has(t)?Dm("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),os=(t,e,n,r)=>(rd(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Lh=(t,e,n)=>(rd(t,e,"access private method"),n);function jm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Am={exports:{}},Zs={},Um={exports:{}},J={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Za=Symbol.for("react.element"),Jy=Symbol.for("react.portal"),Yy=Symbol.for("react.fragment"),Xy=Symbol.for("react.strict_mode"),e1=Symbol.for("react.profiler"),t1=Symbol.for("react.provider"),n1=Symbol.for("react.context"),r1=Symbol.for("react.forward_ref"),i1=Symbol.for("react.suspense"),a1=Symbol.for("react.memo"),o1=Symbol.for("react.lazy"),Mh=Symbol.iterator;function s1(t){return t===null||typeof t!="object"?null:(t=Mh&&t[Mh]||t["@@iterator"],typeof t=="function"?t:null)}var Fm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bm=Object.assign,zm={};function Ri(t,e,n){this.props=t,this.context=e,this.refs=zm,this.updater=n||Fm}Ri.prototype.isReactComponent={};Ri.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ri.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Vm(){}Vm.prototype=Ri.prototype;function id(t,e,n){this.props=t,this.context=e,this.refs=zm,this.updater=n||Fm}var ad=id.prototype=new Vm;ad.constructor=id;Bm(ad,Ri.prototype);ad.isPureReactComponent=!0;var Dh=Array.isArray,Hm=Object.prototype.hasOwnProperty,od={current:null},qm={key:!0,ref:!0,__self:!0,__source:!0};function $m(t,e,n){var r,i={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)Hm.call(e,r)&&!qm.hasOwnProperty(r)&&(i[r]=e[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:Za,type:t,key:a,ref:o,props:i,_owner:od.current}}function c1(t,e){return{$$typeof:Za,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Za}function l1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var jh=/\/+/g;function Sc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?l1(""+t.key):e.toString(36)}function Oo(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Za:case Jy:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Sc(o,0):r,Dh(i)?(n="",t!=null&&(n=t.replace(jh,"$&/")+"/"),Oo(i,e,n,"",function(l){return l})):i!=null&&(sd(i)&&(i=c1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(jh,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Dh(t))for(var s=0;s<t.length;s++){a=t[s];var c=r+Sc(a,s);o+=Oo(a,e,n,c,i)}else if(c=s1(t),typeof c=="function")for(t=c.call(t),s=0;!(a=t.next()).done;)a=a.value,c=r+Sc(a,s++),o+=Oo(a,e,n,c,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function to(t,e,n){if(t==null)return t;var r=[],i=0;return Oo(t,r,"","",function(a){return e.call(n,a,i++)}),r}function u1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var et={current:null},No={transition:null},d1={ReactCurrentDispatcher:et,ReactCurrentBatchConfig:No,ReactCurrentOwner:od};function Wm(){throw Error("act(...) is not supported in production builds of React.")}J.Children={map:to,forEach:function(t,e,n){to(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return to(t,function(){e++}),e},toArray:function(t){return to(t,function(e){return e})||[]},only:function(t){if(!sd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};J.Component=Ri;J.Fragment=Yy;J.Profiler=e1;J.PureComponent=id;J.StrictMode=Xy;J.Suspense=i1;J.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d1;J.act=Wm;J.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Bm({},t.props),i=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=od.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(c in e)Hm.call(e,c)&&!qm.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&s!==void 0?s[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Za,type:t.type,key:i,ref:a,props:r,_owner:o}};J.createContext=function(t){return t={$$typeof:n1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:t1,_context:t},t.Consumer=t};J.createElement=$m;J.createFactory=function(t){var e=$m.bind(null,t);return e.type=t,e};J.createRef=function(){return{current:null}};J.forwardRef=function(t){return{$$typeof:r1,render:t}};J.isValidElement=sd;J.lazy=function(t){return{$$typeof:o1,_payload:{_status:-1,_result:t},_init:u1}};J.memo=function(t,e){return{$$typeof:a1,type:t,compare:e===void 0?null:e}};J.startTransition=function(t){var e=No.transition;No.transition={};try{t()}finally{No.transition=e}};J.unstable_act=Wm;J.useCallback=function(t,e){return et.current.useCallback(t,e)};J.useContext=function(t){return et.current.useContext(t)};J.useDebugValue=function(){};J.useDeferredValue=function(t){return et.current.useDeferredValue(t)};J.useEffect=function(t,e){return et.current.useEffect(t,e)};J.useId=function(){return et.current.useId()};J.useImperativeHandle=function(t,e,n){return et.current.useImperativeHandle(t,e,n)};J.useInsertionEffect=function(t,e){return et.current.useInsertionEffect(t,e)};J.useLayoutEffect=function(t,e){return et.current.useLayoutEffect(t,e)};J.useMemo=function(t,e){return et.current.useMemo(t,e)};J.useReducer=function(t,e,n){return et.current.useReducer(t,e,n)};J.useRef=function(t){return et.current.useRef(t)};J.useState=function(t){return et.current.useState(t)};J.useSyncExternalStore=function(t,e,n){return et.current.useSyncExternalStore(t,e,n)};J.useTransition=function(){return et.current.useTransition()};J.version="18.3.1";Um.exports=J;var A=Um.exports;const wr=jm(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1=A,p1=Symbol.for("react.element"),f1=Symbol.for("react.fragment"),m1=Object.prototype.hasOwnProperty,g1=h1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v1={key:!0,ref:!0,__self:!0,__source:!0};function Km(t,e,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)m1.call(e,r)&&!v1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:p1,type:t,key:a,ref:o,props:i,_owner:g1.current}}Zs.Fragment=f1;Zs.jsx=Km;Zs.jsxs=Km;Am.exports=Zs;var y=Am.exports,Gm={exports:{}},bt={},Zm={exports:{}},Qm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,$){var K=D.length;D.push($);e:for(;0<K;){var Z=K-1>>>1,he=D[Z];if(0<i(he,$))D[Z]=$,D[K]=he,K=Z;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var $=D[0],K=D.pop();if(K!==$){D[0]=K;e:for(var Z=0,he=D.length,ir=he>>>1;Z<ir;){var sn=2*(Z+1)-1,ar=D[sn],Kt=sn+1,_t=D[Kt];if(0>i(ar,K))Kt<he&&0>i(_t,ar)?(D[Z]=_t,D[Kt]=K,Z=Kt):(D[Z]=ar,D[sn]=K,Z=sn);else if(Kt<he&&0>i(_t,K))D[Z]=_t,D[Kt]=K,Z=Kt;else break e}}return $}function i(D,$){var K=D.sortIndex-$.sortIndex;return K!==0?K:D.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var c=[],l=[],u=1,d=null,h=3,f=!1,v=!1,k=!1,S=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(D){for(var $=n(l);$!==null;){if($.callback===null)r(l);else if($.startTime<=D)r(l),$.sortIndex=$.expirationTime,e(c,$);else break;$=n(l)}}function m(D){if(k=!1,p(D),!v)if(n(c)!==null)v=!0,H(w);else{var $=n(l);$!==null&&Q(m,$.startTime-D)}}function w(D,$){v=!1,k&&(k=!1,g(E),E=-1),f=!0;var K=h;try{for(p($),d=n(c);d!==null&&(!(d.expirationTime>$)||D&&!U());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,h=d.priorityLevel;var he=Z(d.expirationTime<=$);$=t.unstable_now(),typeof he=="function"?d.callback=he:d===n(c)&&r(c),p($)}else r(c);d=n(c)}if(d!==null)var ir=!0;else{var sn=n(l);sn!==null&&Q(m,sn.startTime-$),ir=!1}return ir}finally{d=null,h=K,f=!1}}var T=!1,x=null,E=-1,O=5,N=-1;function U(){return!(t.unstable_now()-N<O)}function W(){if(x!==null){var D=t.unstable_now();N=D;var $=!0;try{$=x(!0,D)}finally{$?q():(T=!1,x=null)}}else T=!1}var q;if(typeof b=="function")q=function(){b(W)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,z=R.port2;R.port1.onmessage=W,q=function(){z.postMessage(null)}}else q=function(){S(W,0)};function H(D){x=D,T||(T=!0,q())}function Q(D,$){E=S(function(){D(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){v||f||(v=!0,H(w))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(D){switch(h){case 1:case 2:case 3:var $=3;break;default:$=h}var K=h;h=$;try{return D()}finally{h=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,$){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var K=h;h=D;try{return $()}finally{h=K}},t.unstable_scheduleCallback=function(D,$,K){var Z=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?Z+K:Z):K=Z,D){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=K+he,D={id:u++,callback:$,priorityLevel:D,startTime:K,expirationTime:he,sortIndex:-1},K>Z?(D.sortIndex=K,e(l,D),n(c)===null&&D===n(l)&&(k?(g(E),E=-1):k=!0,Q(m,K-Z))):(D.sortIndex=he,e(c,D),v||f||(v=!0,H(w))),D},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(D){var $=h;return function(){var K=h;h=$;try{return D.apply(this,arguments)}finally{h=K}}}})(Qm);Zm.exports=Qm;var b1=Zm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y1=A,vt=b1;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jm=new Set,Ta={};function Or(t,e){gi(t,e),gi(t+"Capture",e)}function gi(t,e){for(Ta[t]=e,t=0;t<e.length;t++)Jm.add(e[t])}var vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bl=Object.prototype.hasOwnProperty,k1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ah={},Uh={};function w1(t){return bl.call(Uh,t)?!0:bl.call(Ah,t)?!1:k1.test(t)?Uh[t]=!0:(Ah[t]=!0,!1)}function C1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function S1(t,e,n,r){if(e===null||typeof e>"u"||C1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tt(t,e,n,r,i,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var He={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){He[t]=new tt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];He[e]=new tt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){He[t]=new tt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){He[t]=new tt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){He[t]=new tt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){He[t]=new tt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){He[t]=new tt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){He[t]=new tt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){He[t]=new tt(t,5,!1,t.toLowerCase(),null,!1,!1)});var cd=/[\-:]([a-z])/g;function ld(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cd,ld);He[e]=new tt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cd,ld);He[e]=new tt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cd,ld);He[e]=new tt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){He[t]=new tt(t,1,!1,t.toLowerCase(),null,!1,!1)});He.xlinkHref=new tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){He[t]=new tt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ud(t,e,n,r){var i=He.hasOwnProperty(e)?He[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(S1(e,n,i,r)&&(n=null),r||i===null?w1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Sn=y1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,no=Symbol.for("react.element"),Hr=Symbol.for("react.portal"),qr=Symbol.for("react.fragment"),dd=Symbol.for("react.strict_mode"),yl=Symbol.for("react.profiler"),Ym=Symbol.for("react.provider"),Xm=Symbol.for("react.context"),hd=Symbol.for("react.forward_ref"),kl=Symbol.for("react.suspense"),wl=Symbol.for("react.suspense_list"),pd=Symbol.for("react.memo"),Rn=Symbol.for("react.lazy"),eg=Symbol.for("react.offscreen"),Fh=Symbol.iterator;function ji(t){return t===null||typeof t!="object"?null:(t=Fh&&t[Fh]||t["@@iterator"],typeof t=="function"?t:null)}var Ce=Object.assign,Tc;function Xi(t){if(Tc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Tc=e&&e[1]||""}return`
`+Tc+t}var xc=!1;function Ec(t,e){if(!t||xc)return"";xc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(o!==1||s!==1)do if(o--,s--,0>s||i[o]!==a[s]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=s);break}}}finally{xc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xi(t):""}function T1(t){switch(t.tag){case 5:return Xi(t.type);case 16:return Xi("Lazy");case 13:return Xi("Suspense");case 19:return Xi("SuspenseList");case 0:case 2:case 15:return t=Ec(t.type,!1),t;case 11:return t=Ec(t.type.render,!1),t;case 1:return t=Ec(t.type,!0),t;default:return""}}function Cl(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qr:return"Fragment";case Hr:return"Portal";case yl:return"Profiler";case dd:return"StrictMode";case kl:return"Suspense";case wl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Xm:return(t.displayName||"Context")+".Consumer";case Ym:return(t._context.displayName||"Context")+".Provider";case hd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pd:return e=t.displayName||null,e!==null?e:Cl(t.type)||"Memo";case Rn:e=t._payload,t=t._init;try{return Cl(t(e))}catch{}}return null}function x1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cl(e);case 8:return e===dd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function tg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function E1(t){var e=tg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ro(t){t._valueTracker||(t._valueTracker=E1(t))}function ng(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=tg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ss(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Sl(t,e){var n=e.checked;return Ce({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Bh(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Zn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rg(t,e){e=e.checked,e!=null&&ud(t,"checked",e,!1)}function Tl(t,e){rg(t,e);var n=Zn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xl(t,e.type,n):e.hasOwnProperty("defaultValue")&&xl(t,e.type,Zn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zh(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function xl(t,e,n){(e!=="number"||ss(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ea=Array.isArray;function ii(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Zn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function El(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Ce({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vh(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(ea(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Zn(n)}}function ig(t,e){var n=Zn(e.value),r=Zn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Hh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ag(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pl(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ag(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var io,og=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(io=io||document.createElement("div"),io.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=io.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var aa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},P1=["Webkit","ms","Moz","O"];Object.keys(aa).forEach(function(t){P1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),aa[e]=aa[t]})});function sg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||aa.hasOwnProperty(t)&&aa[t]?(""+e).trim():e+"px"}function cg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=sg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var R1=Ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rl(t,e){if(e){if(R1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Il(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _l=null;function fd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ol=null,ai=null,oi=null;function qh(t){if(t=Ya(t)){if(typeof Ol!="function")throw Error(L(280));var e=t.stateNode;e&&(e=ec(e),Ol(t.stateNode,t.type,e))}}function lg(t){ai?oi?oi.push(t):oi=[t]:ai=t}function ug(){if(ai){var t=ai,e=oi;if(oi=ai=null,qh(t),e)for(t=0;t<e.length;t++)qh(e[t])}}function dg(t,e){return t(e)}function hg(){}var Pc=!1;function pg(t,e,n){if(Pc)return t(e,n);Pc=!0;try{return dg(t,e,n)}finally{Pc=!1,(ai!==null||oi!==null)&&(hg(),ug())}}function Ea(t,e){var n=t.stateNode;if(n===null)return null;var r=ec(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var Nl=!1;if(vn)try{var Ai={};Object.defineProperty(Ai,"passive",{get:function(){Nl=!0}}),window.addEventListener("test",Ai,Ai),window.removeEventListener("test",Ai,Ai)}catch{Nl=!1}function I1(t,e,n,r,i,a,o,s,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var oa=!1,cs=null,ls=!1,Ll=null,_1={onError:function(t){oa=!0,cs=t}};function O1(t,e,n,r,i,a,o,s,c){oa=!1,cs=null,I1.apply(_1,arguments)}function N1(t,e,n,r,i,a,o,s,c){if(O1.apply(this,arguments),oa){if(oa){var l=cs;oa=!1,cs=null}else throw Error(L(198));ls||(ls=!0,Ll=l)}}function Nr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function fg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $h(t){if(Nr(t)!==t)throw Error(L(188))}function L1(t){var e=t.alternate;if(!e){if(e=Nr(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return $h(i),t;if(a===r)return $h(i),e;a=a.sibling}throw Error(L(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,s=i.child;s;){if(s===n){o=!0,n=i,r=a;break}if(s===r){o=!0,r=i,n=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===n){o=!0,n=a,r=i;break}if(s===r){o=!0,r=a,n=i;break}s=s.sibling}if(!o)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function mg(t){return t=L1(t),t!==null?gg(t):null}function gg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=gg(t);if(e!==null)return e;t=t.sibling}return null}var vg=vt.unstable_scheduleCallback,Wh=vt.unstable_cancelCallback,M1=vt.unstable_shouldYield,D1=vt.unstable_requestPaint,Pe=vt.unstable_now,j1=vt.unstable_getCurrentPriorityLevel,md=vt.unstable_ImmediatePriority,bg=vt.unstable_UserBlockingPriority,us=vt.unstable_NormalPriority,A1=vt.unstable_LowPriority,yg=vt.unstable_IdlePriority,Qs=null,tn=null;function U1(t){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Qs,t,void 0,(t.current.flags&128)===128)}catch{}}var Vt=Math.clz32?Math.clz32:z1,F1=Math.log,B1=Math.LN2;function z1(t){return t>>>=0,t===0?32:31-(F1(t)/B1|0)|0}var ao=64,oo=4194304;function ta(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ds(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var s=o&~i;s!==0?r=ta(s):(a&=o,a!==0&&(r=ta(a)))}else o=n&~i,o!==0?r=ta(o):a!==0&&(r=ta(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Vt(e),i=1<<n,r|=t[n],e&=~i;return r}function V1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function H1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-Vt(a),s=1<<o,c=i[o];c===-1?(!(s&n)||s&r)&&(i[o]=V1(s,e)):c<=e&&(t.expiredLanes|=s),a&=~s}}function Ml(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function kg(){var t=ao;return ao<<=1,!(ao&4194240)&&(ao=64),t}function Rc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Vt(e),t[e]=n}function q1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Vt(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function gd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Vt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var se=0;function wg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Cg,vd,Sg,Tg,xg,Dl=!1,so=[],Fn=null,Bn=null,zn=null,Pa=new Map,Ra=new Map,On=[],$1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kh(t,e){switch(t){case"focusin":case"focusout":Fn=null;break;case"dragenter":case"dragleave":Bn=null;break;case"mouseover":case"mouseout":zn=null;break;case"pointerover":case"pointerout":Pa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ra.delete(e.pointerId)}}function Ui(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Ya(e),e!==null&&vd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function W1(t,e,n,r,i){switch(e){case"focusin":return Fn=Ui(Fn,t,e,n,r,i),!0;case"dragenter":return Bn=Ui(Bn,t,e,n,r,i),!0;case"mouseover":return zn=Ui(zn,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Pa.set(a,Ui(Pa.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ra.set(a,Ui(Ra.get(a)||null,t,e,n,r,i)),!0}return!1}function Eg(t){var e=pr(t.target);if(e!==null){var n=Nr(e);if(n!==null){if(e=n.tag,e===13){if(e=fg(n),e!==null){t.blockedOn=e,xg(t.priority,function(){Sg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Lo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=jl(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);_l=r,n.target.dispatchEvent(r),_l=null}else return e=Ya(n),e!==null&&vd(e),t.blockedOn=n,!1;e.shift()}return!0}function Gh(t,e,n){Lo(t)&&n.delete(e)}function K1(){Dl=!1,Fn!==null&&Lo(Fn)&&(Fn=null),Bn!==null&&Lo(Bn)&&(Bn=null),zn!==null&&Lo(zn)&&(zn=null),Pa.forEach(Gh),Ra.forEach(Gh)}function Fi(t,e){t.blockedOn===e&&(t.blockedOn=null,Dl||(Dl=!0,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,K1)))}function Ia(t){function e(i){return Fi(i,t)}if(0<so.length){Fi(so[0],t);for(var n=1;n<so.length;n++){var r=so[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Fn!==null&&Fi(Fn,t),Bn!==null&&Fi(Bn,t),zn!==null&&Fi(zn,t),Pa.forEach(e),Ra.forEach(e),n=0;n<On.length;n++)r=On[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<On.length&&(n=On[0],n.blockedOn===null);)Eg(n),n.blockedOn===null&&On.shift()}var si=Sn.ReactCurrentBatchConfig,hs=!0;function G1(t,e,n,r){var i=se,a=si.transition;si.transition=null;try{se=1,bd(t,e,n,r)}finally{se=i,si.transition=a}}function Z1(t,e,n,r){var i=se,a=si.transition;si.transition=null;try{se=4,bd(t,e,n,r)}finally{se=i,si.transition=a}}function bd(t,e,n,r){if(hs){var i=jl(t,e,n,r);if(i===null)Uc(t,e,r,ps,n),Kh(t,r);else if(W1(i,t,e,n,r))r.stopPropagation();else if(Kh(t,r),e&4&&-1<$1.indexOf(t)){for(;i!==null;){var a=Ya(i);if(a!==null&&Cg(a),a=jl(t,e,n,r),a===null&&Uc(t,e,r,ps,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else Uc(t,e,r,null,n)}}var ps=null;function jl(t,e,n,r){if(ps=null,t=fd(r),t=pr(t),t!==null)if(e=Nr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=fg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ps=t,null}function Pg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(j1()){case md:return 1;case bg:return 4;case us:case A1:return 16;case yg:return 536870912;default:return 16}default:return 16}}var jn=null,yd=null,Mo=null;function Rg(){if(Mo)return Mo;var t,e=yd,n=e.length,r,i="value"in jn?jn.value:jn.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[a-r];r++);return Mo=i.slice(t,1<r?1-r:void 0)}function Do(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function co(){return!0}function Zh(){return!1}function yt(t){function e(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?co:Zh,this.isPropagationStopped=Zh,this}return Ce(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=co)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=co)},persist:function(){},isPersistent:co}),e}var Ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kd=yt(Ii),Ja=Ce({},Ii,{view:0,detail:0}),Q1=yt(Ja),Ic,_c,Bi,Js=Ce({},Ja,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bi&&(Bi&&t.type==="mousemove"?(Ic=t.screenX-Bi.screenX,_c=t.screenY-Bi.screenY):_c=Ic=0,Bi=t),Ic)},movementY:function(t){return"movementY"in t?t.movementY:_c}}),Qh=yt(Js),J1=Ce({},Js,{dataTransfer:0}),Y1=yt(J1),X1=Ce({},Ja,{relatedTarget:0}),Oc=yt(X1),ek=Ce({},Ii,{animationName:0,elapsedTime:0,pseudoElement:0}),tk=yt(ek),nk=Ce({},Ii,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rk=yt(nk),ik=Ce({},Ii,{data:0}),Jh=yt(ik),ak={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ok={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ck(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=sk[t])?!!e[t]:!1}function wd(){return ck}var lk=Ce({},Ja,{key:function(t){if(t.key){var e=ak[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Do(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ok[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wd,charCode:function(t){return t.type==="keypress"?Do(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Do(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uk=yt(lk),dk=Ce({},Js,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yh=yt(dk),hk=Ce({},Ja,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wd}),pk=yt(hk),fk=Ce({},Ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),mk=yt(fk),gk=Ce({},Js,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vk=yt(gk),bk=[9,13,27,32],Cd=vn&&"CompositionEvent"in window,sa=null;vn&&"documentMode"in document&&(sa=document.documentMode);var yk=vn&&"TextEvent"in window&&!sa,Ig=vn&&(!Cd||sa&&8<sa&&11>=sa),Xh=" ",ep=!1;function _g(t,e){switch(t){case"keyup":return bk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Og(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $r=!1;function kk(t,e){switch(t){case"compositionend":return Og(e);case"keypress":return e.which!==32?null:(ep=!0,Xh);case"textInput":return t=e.data,t===Xh&&ep?null:t;default:return null}}function wk(t,e){if($r)return t==="compositionend"||!Cd&&_g(t,e)?(t=Rg(),Mo=yd=jn=null,$r=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ig&&e.locale!=="ko"?null:e.data;default:return null}}var Ck={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ck[t.type]:e==="textarea"}function Ng(t,e,n,r){lg(r),e=fs(e,"onChange"),0<e.length&&(n=new kd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ca=null,_a=null;function Sk(t){Hg(t,0)}function Ys(t){var e=Gr(t);if(ng(e))return t}function Tk(t,e){if(t==="change")return e}var Lg=!1;if(vn){var Nc;if(vn){var Lc="oninput"in document;if(!Lc){var np=document.createElement("div");np.setAttribute("oninput","return;"),Lc=typeof np.oninput=="function"}Nc=Lc}else Nc=!1;Lg=Nc&&(!document.documentMode||9<document.documentMode)}function rp(){ca&&(ca.detachEvent("onpropertychange",Mg),_a=ca=null)}function Mg(t){if(t.propertyName==="value"&&Ys(_a)){var e=[];Ng(e,_a,t,fd(t)),pg(Sk,e)}}function xk(t,e,n){t==="focusin"?(rp(),ca=e,_a=n,ca.attachEvent("onpropertychange",Mg)):t==="focusout"&&rp()}function Ek(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ys(_a)}function Pk(t,e){if(t==="click")return Ys(e)}function Rk(t,e){if(t==="input"||t==="change")return Ys(e)}function Ik(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var qt=typeof Object.is=="function"?Object.is:Ik;function Oa(t,e){if(qt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!bl.call(e,i)||!qt(t[i],e[i]))return!1}return!0}function ip(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ap(t,e){var n=ip(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ip(n)}}function Dg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Dg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function jg(){for(var t=window,e=ss();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ss(t.document)}return e}function Sd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function _k(t){var e=jg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Dg(n.ownerDocument.documentElement,n)){if(r!==null&&Sd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=ap(n,a);var o=ap(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ok=vn&&"documentMode"in document&&11>=document.documentMode,Wr=null,Al=null,la=null,Ul=!1;function op(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ul||Wr==null||Wr!==ss(r)||(r=Wr,"selectionStart"in r&&Sd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),la&&Oa(la,r)||(la=r,r=fs(Al,"onSelect"),0<r.length&&(e=new kd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Wr)))}function lo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Kr={animationend:lo("Animation","AnimationEnd"),animationiteration:lo("Animation","AnimationIteration"),animationstart:lo("Animation","AnimationStart"),transitionend:lo("Transition","TransitionEnd")},Mc={},Ag={};vn&&(Ag=document.createElement("div").style,"AnimationEvent"in window||(delete Kr.animationend.animation,delete Kr.animationiteration.animation,delete Kr.animationstart.animation),"TransitionEvent"in window||delete Kr.transitionend.transition);function Xs(t){if(Mc[t])return Mc[t];if(!Kr[t])return t;var e=Kr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ag)return Mc[t]=e[n];return t}var Ug=Xs("animationend"),Fg=Xs("animationiteration"),Bg=Xs("animationstart"),zg=Xs("transitionend"),Vg=new Map,sp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xn(t,e){Vg.set(t,e),Or(e,[t])}for(var Dc=0;Dc<sp.length;Dc++){var jc=sp[Dc],Nk=jc.toLowerCase(),Lk=jc[0].toUpperCase()+jc.slice(1);Xn(Nk,"on"+Lk)}Xn(Ug,"onAnimationEnd");Xn(Fg,"onAnimationIteration");Xn(Bg,"onAnimationStart");Xn("dblclick","onDoubleClick");Xn("focusin","onFocus");Xn("focusout","onBlur");Xn(zg,"onTransitionEnd");gi("onMouseEnter",["mouseout","mouseover"]);gi("onMouseLeave",["mouseout","mouseover"]);gi("onPointerEnter",["pointerout","pointerover"]);gi("onPointerLeave",["pointerout","pointerover"]);Or("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Or("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Or("onBeforeInput",["compositionend","keypress","textInput","paste"]);Or("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Or("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Or("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var na="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mk=new Set("cancel close invalid load scroll toggle".split(" ").concat(na));function cp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,N1(r,e,void 0,t),t.currentTarget=null}function Hg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==a&&i.isPropagationStopped())break e;cp(i,s,l),a=c}else for(o=0;o<r.length;o++){if(s=r[o],c=s.instance,l=s.currentTarget,s=s.listener,c!==a&&i.isPropagationStopped())break e;cp(i,s,l),a=c}}}if(ls)throw t=Ll,ls=!1,Ll=null,t}function pe(t,e){var n=e[Hl];n===void 0&&(n=e[Hl]=new Set);var r=t+"__bubble";n.has(r)||(qg(e,t,2,!1),n.add(r))}function Ac(t,e,n){var r=0;e&&(r|=4),qg(n,t,r,e)}var uo="_reactListening"+Math.random().toString(36).slice(2);function Na(t){if(!t[uo]){t[uo]=!0,Jm.forEach(function(n){n!=="selectionchange"&&(Mk.has(n)||Ac(n,!1,t),Ac(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uo]||(e[uo]=!0,Ac("selectionchange",!1,e))}}function qg(t,e,n,r){switch(Pg(e)){case 1:var i=G1;break;case 4:i=Z1;break;default:i=bd}n=i.bind(null,e,n,t),i=void 0,!Nl||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Uc(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;s!==null;){if(o=pr(s),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}s=s.parentNode}}r=r.return}pg(function(){var l=a,u=fd(n),d=[];e:{var h=Vg.get(t);if(h!==void 0){var f=kd,v=t;switch(t){case"keypress":if(Do(n)===0)break e;case"keydown":case"keyup":f=uk;break;case"focusin":v="focus",f=Oc;break;case"focusout":v="blur",f=Oc;break;case"beforeblur":case"afterblur":f=Oc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Qh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Y1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=pk;break;case Ug:case Fg:case Bg:f=tk;break;case zg:f=mk;break;case"scroll":f=Q1;break;case"wheel":f=vk;break;case"copy":case"cut":case"paste":f=rk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Yh}var k=(e&4)!==0,S=!k&&t==="scroll",g=k?h!==null?h+"Capture":null:h;k=[];for(var b=l,p;b!==null;){p=b;var m=p.stateNode;if(p.tag===5&&m!==null&&(p=m,g!==null&&(m=Ea(b,g),m!=null&&k.push(La(b,m,p)))),S)break;b=b.return}0<k.length&&(h=new f(h,v,null,n,u),d.push({event:h,listeners:k}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==_l&&(v=n.relatedTarget||n.fromElement)&&(pr(v)||v[bn]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(v=n.relatedTarget||n.toElement,f=l,v=v?pr(v):null,v!==null&&(S=Nr(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(f=null,v=l),f!==v)){if(k=Qh,m="onMouseLeave",g="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(k=Yh,m="onPointerLeave",g="onPointerEnter",b="pointer"),S=f==null?h:Gr(f),p=v==null?h:Gr(v),h=new k(m,b+"leave",f,n,u),h.target=S,h.relatedTarget=p,m=null,pr(u)===l&&(k=new k(g,b+"enter",v,n,u),k.target=p,k.relatedTarget=S,m=k),S=m,f&&v)t:{for(k=f,g=v,b=0,p=k;p;p=jr(p))b++;for(p=0,m=g;m;m=jr(m))p++;for(;0<b-p;)k=jr(k),b--;for(;0<p-b;)g=jr(g),p--;for(;b--;){if(k===g||g!==null&&k===g.alternate)break t;k=jr(k),g=jr(g)}k=null}else k=null;f!==null&&lp(d,h,f,k,!1),v!==null&&S!==null&&lp(d,S,v,k,!0)}}e:{if(h=l?Gr(l):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var w=Tk;else if(tp(h))if(Lg)w=Rk;else{w=Ek;var T=xk}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=Pk);if(w&&(w=w(t,l))){Ng(d,w,n,u);break e}T&&T(t,h,l),t==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&xl(h,"number",h.value)}switch(T=l?Gr(l):window,t){case"focusin":(tp(T)||T.contentEditable==="true")&&(Wr=T,Al=l,la=null);break;case"focusout":la=Al=Wr=null;break;case"mousedown":Ul=!0;break;case"contextmenu":case"mouseup":case"dragend":Ul=!1,op(d,n,u);break;case"selectionchange":if(Ok)break;case"keydown":case"keyup":op(d,n,u)}var x;if(Cd)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else $r?_g(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Ig&&n.locale!=="ko"&&($r||E!=="onCompositionStart"?E==="onCompositionEnd"&&$r&&(x=Rg()):(jn=u,yd="value"in jn?jn.value:jn.textContent,$r=!0)),T=fs(l,E),0<T.length&&(E=new Jh(E,t,null,n,u),d.push({event:E,listeners:T}),x?E.data=x:(x=Og(n),x!==null&&(E.data=x)))),(x=yk?kk(t,n):wk(t,n))&&(l=fs(l,"onBeforeInput"),0<l.length&&(u=new Jh("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=x))}Hg(d,e)})}function La(t,e,n){return{instance:t,listener:e,currentTarget:n}}function fs(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Ea(t,n),a!=null&&r.unshift(La(t,a,i)),a=Ea(t,e),a!=null&&r.push(La(t,a,i))),t=t.return}return r}function jr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function lp(t,e,n,r,i){for(var a=e._reactName,o=[];n!==null&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(c!==null&&c===r)break;s.tag===5&&l!==null&&(s=l,i?(c=Ea(n,a),c!=null&&o.unshift(La(n,c,s))):i||(c=Ea(n,a),c!=null&&o.push(La(n,c,s)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Dk=/\r\n?/g,jk=/\u0000|\uFFFD/g;function up(t){return(typeof t=="string"?t:""+t).replace(Dk,`
`).replace(jk,"")}function ho(t,e,n){if(e=up(e),up(t)!==e&&n)throw Error(L(425))}function ms(){}var Fl=null,Bl=null;function zl(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Vl=typeof setTimeout=="function"?setTimeout:void 0,Ak=typeof clearTimeout=="function"?clearTimeout:void 0,dp=typeof Promise=="function"?Promise:void 0,Uk=typeof queueMicrotask=="function"?queueMicrotask:typeof dp<"u"?function(t){return dp.resolve(null).then(t).catch(Fk)}:Vl;function Fk(t){setTimeout(function(){throw t})}function Fc(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ia(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ia(e)}function Vn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function hp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _i=Math.random().toString(36).slice(2),en="__reactFiber$"+_i,Ma="__reactProps$"+_i,bn="__reactContainer$"+_i,Hl="__reactEvents$"+_i,Bk="__reactListeners$"+_i,zk="__reactHandles$"+_i;function pr(t){var e=t[en];if(e)return e;for(var n=t.parentNode;n;){if(e=n[bn]||n[en]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=hp(t);t!==null;){if(n=t[en])return n;t=hp(t)}return e}t=n,n=t.parentNode}return null}function Ya(t){return t=t[en]||t[bn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function ec(t){return t[Ma]||null}var ql=[],Zr=-1;function er(t){return{current:t}}function fe(t){0>Zr||(t.current=ql[Zr],ql[Zr]=null,Zr--)}function de(t,e){Zr++,ql[Zr]=t.current,t.current=e}var Qn={},Ke=er(Qn),st=er(!1),Cr=Qn;function vi(t,e){var n=t.type.contextTypes;if(!n)return Qn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ct(t){return t=t.childContextTypes,t!=null}function gs(){fe(st),fe(Ke)}function pp(t,e,n){if(Ke.current!==Qn)throw Error(L(168));de(Ke,e),de(st,n)}function $g(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(L(108,x1(t)||"Unknown",i));return Ce({},n,r)}function vs(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Qn,Cr=Ke.current,de(Ke,t),de(st,st.current),!0}function fp(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=$g(t,e,Cr),r.__reactInternalMemoizedMergedChildContext=t,fe(st),fe(Ke),de(Ke,t)):fe(st),de(st,n)}var ln=null,tc=!1,Bc=!1;function Wg(t){ln===null?ln=[t]:ln.push(t)}function Vk(t){tc=!0,Wg(t)}function tr(){if(!Bc&&ln!==null){Bc=!0;var t=0,e=se;try{var n=ln;for(se=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ln=null,tc=!1}catch(i){throw ln!==null&&(ln=ln.slice(t+1)),vg(md,tr),i}finally{se=e,Bc=!1}}return null}var Qr=[],Jr=0,bs=null,ys=0,wt=[],Ct=0,Sr=null,pn=1,fn="";function cr(t,e){Qr[Jr++]=ys,Qr[Jr++]=bs,bs=t,ys=e}function Kg(t,e,n){wt[Ct++]=pn,wt[Ct++]=fn,wt[Ct++]=Sr,Sr=t;var r=pn;t=fn;var i=32-Vt(r)-1;r&=~(1<<i),n+=1;var a=32-Vt(e)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,pn=1<<32-Vt(e)+i|n<<i|r,fn=a+t}else pn=1<<a|n<<i|r,fn=t}function Td(t){t.return!==null&&(cr(t,1),Kg(t,1,0))}function xd(t){for(;t===bs;)bs=Qr[--Jr],Qr[Jr]=null,ys=Qr[--Jr],Qr[Jr]=null;for(;t===Sr;)Sr=wt[--Ct],wt[Ct]=null,fn=wt[--Ct],wt[Ct]=null,pn=wt[--Ct],wt[Ct]=null}var gt=null,pt=null,ve=!1,At=null;function Gg(t,e){var n=St(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function mp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,gt=t,pt=Vn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,gt=t,pt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Sr!==null?{id:pn,overflow:fn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=St(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,gt=t,pt=null,!0):!1;default:return!1}}function $l(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Wl(t){if(ve){var e=pt;if(e){var n=e;if(!mp(t,e)){if($l(t))throw Error(L(418));e=Vn(n.nextSibling);var r=gt;e&&mp(t,e)?Gg(r,n):(t.flags=t.flags&-4097|2,ve=!1,gt=t)}}else{if($l(t))throw Error(L(418));t.flags=t.flags&-4097|2,ve=!1,gt=t}}}function gp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;gt=t}function po(t){if(t!==gt)return!1;if(!ve)return gp(t),ve=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zl(t.type,t.memoizedProps)),e&&(e=pt)){if($l(t))throw Zg(),Error(L(418));for(;e;)Gg(t,e),e=Vn(e.nextSibling)}if(gp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){pt=Vn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}pt=null}}else pt=gt?Vn(t.stateNode.nextSibling):null;return!0}function Zg(){for(var t=pt;t;)t=Vn(t.nextSibling)}function bi(){pt=gt=null,ve=!1}function Ed(t){At===null?At=[t]:At.push(t)}var Hk=Sn.ReactCurrentBatchConfig;function zi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var s=i.refs;o===null?delete s[a]:s[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function fo(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vp(t){var e=t._init;return e(t._payload)}function Qg(t){function e(g,b){if(t){var p=g.deletions;p===null?(g.deletions=[b],g.flags|=16):p.push(b)}}function n(g,b){if(!t)return null;for(;b!==null;)e(g,b),b=b.sibling;return null}function r(g,b){for(g=new Map;b!==null;)b.key!==null?g.set(b.key,b):g.set(b.index,b),b=b.sibling;return g}function i(g,b){return g=Wn(g,b),g.index=0,g.sibling=null,g}function a(g,b,p){return g.index=p,t?(p=g.alternate,p!==null?(p=p.index,p<b?(g.flags|=2,b):p):(g.flags|=2,b)):(g.flags|=1048576,b)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function s(g,b,p,m){return b===null||b.tag!==6?(b=Kc(p,g.mode,m),b.return=g,b):(b=i(b,p),b.return=g,b)}function c(g,b,p,m){var w=p.type;return w===qr?u(g,b,p.props.children,m,p.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Rn&&vp(w)===b.type)?(m=i(b,p.props),m.ref=zi(g,b,p),m.return=g,m):(m=Vo(p.type,p.key,p.props,null,g.mode,m),m.ref=zi(g,b,p),m.return=g,m)}function l(g,b,p,m){return b===null||b.tag!==4||b.stateNode.containerInfo!==p.containerInfo||b.stateNode.implementation!==p.implementation?(b=Gc(p,g.mode,m),b.return=g,b):(b=i(b,p.children||[]),b.return=g,b)}function u(g,b,p,m,w){return b===null||b.tag!==7?(b=br(p,g.mode,m,w),b.return=g,b):(b=i(b,p),b.return=g,b)}function d(g,b,p){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Kc(""+b,g.mode,p),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case no:return p=Vo(b.type,b.key,b.props,null,g.mode,p),p.ref=zi(g,null,b),p.return=g,p;case Hr:return b=Gc(b,g.mode,p),b.return=g,b;case Rn:var m=b._init;return d(g,m(b._payload),p)}if(ea(b)||ji(b))return b=br(b,g.mode,p,null),b.return=g,b;fo(g,b)}return null}function h(g,b,p,m){var w=b!==null?b.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return w!==null?null:s(g,b,""+p,m);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case no:return p.key===w?c(g,b,p,m):null;case Hr:return p.key===w?l(g,b,p,m):null;case Rn:return w=p._init,h(g,b,w(p._payload),m)}if(ea(p)||ji(p))return w!==null?null:u(g,b,p,m,null);fo(g,p)}return null}function f(g,b,p,m,w){if(typeof m=="string"&&m!==""||typeof m=="number")return g=g.get(p)||null,s(b,g,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case no:return g=g.get(m.key===null?p:m.key)||null,c(b,g,m,w);case Hr:return g=g.get(m.key===null?p:m.key)||null,l(b,g,m,w);case Rn:var T=m._init;return f(g,b,p,T(m._payload),w)}if(ea(m)||ji(m))return g=g.get(p)||null,u(b,g,m,w,null);fo(b,m)}return null}function v(g,b,p,m){for(var w=null,T=null,x=b,E=b=0,O=null;x!==null&&E<p.length;E++){x.index>E?(O=x,x=null):O=x.sibling;var N=h(g,x,p[E],m);if(N===null){x===null&&(x=O);break}t&&x&&N.alternate===null&&e(g,x),b=a(N,b,E),T===null?w=N:T.sibling=N,T=N,x=O}if(E===p.length)return n(g,x),ve&&cr(g,E),w;if(x===null){for(;E<p.length;E++)x=d(g,p[E],m),x!==null&&(b=a(x,b,E),T===null?w=x:T.sibling=x,T=x);return ve&&cr(g,E),w}for(x=r(g,x);E<p.length;E++)O=f(x,g,E,p[E],m),O!==null&&(t&&O.alternate!==null&&x.delete(O.key===null?E:O.key),b=a(O,b,E),T===null?w=O:T.sibling=O,T=O);return t&&x.forEach(function(U){return e(g,U)}),ve&&cr(g,E),w}function k(g,b,p,m){var w=ji(p);if(typeof w!="function")throw Error(L(150));if(p=w.call(p),p==null)throw Error(L(151));for(var T=w=null,x=b,E=b=0,O=null,N=p.next();x!==null&&!N.done;E++,N=p.next()){x.index>E?(O=x,x=null):O=x.sibling;var U=h(g,x,N.value,m);if(U===null){x===null&&(x=O);break}t&&x&&U.alternate===null&&e(g,x),b=a(U,b,E),T===null?w=U:T.sibling=U,T=U,x=O}if(N.done)return n(g,x),ve&&cr(g,E),w;if(x===null){for(;!N.done;E++,N=p.next())N=d(g,N.value,m),N!==null&&(b=a(N,b,E),T===null?w=N:T.sibling=N,T=N);return ve&&cr(g,E),w}for(x=r(g,x);!N.done;E++,N=p.next())N=f(x,g,E,N.value,m),N!==null&&(t&&N.alternate!==null&&x.delete(N.key===null?E:N.key),b=a(N,b,E),T===null?w=N:T.sibling=N,T=N);return t&&x.forEach(function(W){return e(g,W)}),ve&&cr(g,E),w}function S(g,b,p,m){if(typeof p=="object"&&p!==null&&p.type===qr&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case no:e:{for(var w=p.key,T=b;T!==null;){if(T.key===w){if(w=p.type,w===qr){if(T.tag===7){n(g,T.sibling),b=i(T,p.props.children),b.return=g,g=b;break e}}else if(T.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Rn&&vp(w)===T.type){n(g,T.sibling),b=i(T,p.props),b.ref=zi(g,T,p),b.return=g,g=b;break e}n(g,T);break}else e(g,T);T=T.sibling}p.type===qr?(b=br(p.props.children,g.mode,m,p.key),b.return=g,g=b):(m=Vo(p.type,p.key,p.props,null,g.mode,m),m.ref=zi(g,b,p),m.return=g,g=m)}return o(g);case Hr:e:{for(T=p.key;b!==null;){if(b.key===T)if(b.tag===4&&b.stateNode.containerInfo===p.containerInfo&&b.stateNode.implementation===p.implementation){n(g,b.sibling),b=i(b,p.children||[]),b.return=g,g=b;break e}else{n(g,b);break}else e(g,b);b=b.sibling}b=Gc(p,g.mode,m),b.return=g,g=b}return o(g);case Rn:return T=p._init,S(g,b,T(p._payload),m)}if(ea(p))return v(g,b,p,m);if(ji(p))return k(g,b,p,m);fo(g,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,b!==null&&b.tag===6?(n(g,b.sibling),b=i(b,p),b.return=g,g=b):(n(g,b),b=Kc(p,g.mode,m),b.return=g,g=b),o(g)):n(g,b)}return S}var yi=Qg(!0),Jg=Qg(!1),ks=er(null),ws=null,Yr=null,Pd=null;function Rd(){Pd=Yr=ws=null}function Id(t){var e=ks.current;fe(ks),t._currentValue=e}function Kl(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ci(t,e){ws=t,Pd=Yr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(at=!0),t.firstContext=null)}function Rt(t){var e=t._currentValue;if(Pd!==t)if(t={context:t,memoizedValue:e,next:null},Yr===null){if(ws===null)throw Error(L(308));Yr=t,ws.dependencies={lanes:0,firstContext:t}}else Yr=Yr.next=t;return e}var fr=null;function _d(t){fr===null?fr=[t]:fr.push(t)}function Yg(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,_d(e)):(n.next=i.next,i.next=n),e.interleaved=n,yn(t,r)}function yn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var In=!1;function Od(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xg(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ne&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,yn(t,n)}return i=r.interleaved,i===null?(e.next=e,_d(r)):(e.next=i.next,i.next=e),r.interleaved=e,yn(t,n)}function jo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gd(t,n)}}function bp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Cs(t,e,n,r){var i=t.updateQueue;In=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var c=s,l=c.next;c.next=null,o===null?a=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,s=u.lastBaseUpdate,s!==o&&(s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(a!==null){var d=i.baseState;o=0,u=l=c=null,s=a;do{var h=s.lane,f=s.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=t,k=s;switch(h=e,f=n,k.tag){case 1:if(v=k.payload,typeof v=="function"){d=v.call(f,d,h);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=k.payload,h=typeof v=="function"?v.call(f,d,h):v,h==null)break e;d=Ce({},d,h);break e;case 2:In=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[s]:h.push(s))}else f={eventTime:f,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},u===null?(l=u=f,c=d):u=u.next=f,o|=h;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;h=s,s=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);xr|=o,t.lanes=o,t.memoizedState=d}}function yp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(L(191,i));i.call(r)}}}var Xa={},nn=er(Xa),Da=er(Xa),ja=er(Xa);function mr(t){if(t===Xa)throw Error(L(174));return t}function Nd(t,e){switch(de(ja,e),de(Da,t),de(nn,Xa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pl(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pl(e,t)}fe(nn),de(nn,e)}function ki(){fe(nn),fe(Da),fe(ja)}function ev(t){mr(ja.current);var e=mr(nn.current),n=Pl(e,t.type);e!==n&&(de(Da,t),de(nn,n))}function Ld(t){Da.current===t&&(fe(nn),fe(Da))}var ke=er(0);function Ss(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var zc=[];function Md(){for(var t=0;t<zc.length;t++)zc[t]._workInProgressVersionPrimary=null;zc.length=0}var Ao=Sn.ReactCurrentDispatcher,Vc=Sn.ReactCurrentBatchConfig,Tr=0,we=null,Ne=null,De=null,Ts=!1,ua=!1,Aa=0,qk=0;function qe(){throw Error(L(321))}function Dd(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!qt(t[n],e[n]))return!1;return!0}function jd(t,e,n,r,i,a){if(Tr=a,we=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ao.current=t===null||t.memoizedState===null?Gk:Zk,t=n(r,i),ua){a=0;do{if(ua=!1,Aa=0,25<=a)throw Error(L(301));a+=1,De=Ne=null,e.updateQueue=null,Ao.current=Qk,t=n(r,i)}while(ua)}if(Ao.current=xs,e=Ne!==null&&Ne.next!==null,Tr=0,De=Ne=we=null,Ts=!1,e)throw Error(L(300));return t}function Ad(){var t=Aa!==0;return Aa=0,t}function Jt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return De===null?we.memoizedState=De=t:De=De.next=t,De}function It(){if(Ne===null){var t=we.alternate;t=t!==null?t.memoizedState:null}else t=Ne.next;var e=De===null?we.memoizedState:De.next;if(e!==null)De=e,Ne=t;else{if(t===null)throw Error(L(310));Ne=t,t={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},De===null?we.memoizedState=De=t:De=De.next=t}return De}function Ua(t,e){return typeof e=="function"?e(t):e}function Hc(t){var e=It(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=Ne,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var s=o=null,c=null,l=a;do{var u=l.lane;if((Tr&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(s=c=d,o=r):c=c.next=d,we.lanes|=u,xr|=u}l=l.next}while(l!==null&&l!==a);c===null?o=r:c.next=s,qt(r,e.memoizedState)||(at=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,we.lanes|=a,xr|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qc(t){var e=It(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);qt(a,e.memoizedState)||(at=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function tv(){}function nv(t,e){var n=we,r=It(),i=e(),a=!qt(r.memoizedState,i);if(a&&(r.memoizedState=i,at=!0),r=r.queue,Ud(av.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||De!==null&&De.memoizedState.tag&1){if(n.flags|=2048,Fa(9,iv.bind(null,n,r,i,e),void 0,null),Ae===null)throw Error(L(349));Tr&30||rv(n,e,i)}return i}function rv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=we.updateQueue,e===null?(e={lastEffect:null,stores:null},we.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function iv(t,e,n,r){e.value=n,e.getSnapshot=r,ov(e)&&sv(t)}function av(t,e,n){return n(function(){ov(e)&&sv(t)})}function ov(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!qt(t,n)}catch{return!0}}function sv(t){var e=yn(t,1);e!==null&&Ht(e,t,1,-1)}function kp(t){var e=Jt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:t},e.queue=t,t=t.dispatch=Kk.bind(null,we,t),[e.memoizedState,t]}function Fa(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=we.updateQueue,e===null?(e={lastEffect:null,stores:null},we.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function cv(){return It().memoizedState}function Uo(t,e,n,r){var i=Jt();we.flags|=t,i.memoizedState=Fa(1|e,n,void 0,r===void 0?null:r)}function nc(t,e,n,r){var i=It();r=r===void 0?null:r;var a=void 0;if(Ne!==null){var o=Ne.memoizedState;if(a=o.destroy,r!==null&&Dd(r,o.deps)){i.memoizedState=Fa(e,n,a,r);return}}we.flags|=t,i.memoizedState=Fa(1|e,n,a,r)}function wp(t,e){return Uo(8390656,8,t,e)}function Ud(t,e){return nc(2048,8,t,e)}function lv(t,e){return nc(4,2,t,e)}function uv(t,e){return nc(4,4,t,e)}function dv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function hv(t,e,n){return n=n!=null?n.concat([t]):null,nc(4,4,dv.bind(null,e,t),n)}function Fd(){}function pv(t,e){var n=It();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dd(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function fv(t,e){var n=It();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dd(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function mv(t,e,n){return Tr&21?(qt(n,e)||(n=kg(),we.lanes|=n,xr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,at=!0),t.memoizedState=n)}function $k(t,e){var n=se;se=n!==0&&4>n?n:4,t(!0);var r=Vc.transition;Vc.transition={};try{t(!1),e()}finally{se=n,Vc.transition=r}}function gv(){return It().memoizedState}function Wk(t,e,n){var r=$n(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},vv(t))bv(e,n);else if(n=Yg(t,e,n,r),n!==null){var i=Xe();Ht(n,t,r,i),yv(n,e,r)}}function Kk(t,e,n){var r=$n(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(vv(t))bv(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,qt(s,o)){var c=e.interleaved;c===null?(i.next=i,_d(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=Yg(t,e,i,r),n!==null&&(i=Xe(),Ht(n,t,r,i),yv(n,e,r))}}function vv(t){var e=t.alternate;return t===we||e!==null&&e===we}function bv(t,e){ua=Ts=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function yv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gd(t,n)}}var xs={readContext:Rt,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useInsertionEffect:qe,useLayoutEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useMutableSource:qe,useSyncExternalStore:qe,useId:qe,unstable_isNewReconciler:!1},Gk={readContext:Rt,useCallback:function(t,e){return Jt().memoizedState=[t,e===void 0?null:e],t},useContext:Rt,useEffect:wp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Uo(4194308,4,dv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Uo(4194308,4,t,e)},useInsertionEffect:function(t,e){return Uo(4,2,t,e)},useMemo:function(t,e){var n=Jt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Jt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Wk.bind(null,we,t),[r.memoizedState,t]},useRef:function(t){var e=Jt();return t={current:t},e.memoizedState=t},useState:kp,useDebugValue:Fd,useDeferredValue:function(t){return Jt().memoizedState=t},useTransition:function(){var t=kp(!1),e=t[0];return t=$k.bind(null,t[1]),Jt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=we,i=Jt();if(ve){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),Ae===null)throw Error(L(349));Tr&30||rv(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,wp(av.bind(null,r,a,t),[t]),r.flags|=2048,Fa(9,iv.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=Jt(),e=Ae.identifierPrefix;if(ve){var n=fn,r=pn;n=(r&~(1<<32-Vt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Aa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=qk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Zk={readContext:Rt,useCallback:pv,useContext:Rt,useEffect:Ud,useImperativeHandle:hv,useInsertionEffect:lv,useLayoutEffect:uv,useMemo:fv,useReducer:Hc,useRef:cv,useState:function(){return Hc(Ua)},useDebugValue:Fd,useDeferredValue:function(t){var e=It();return mv(e,Ne.memoizedState,t)},useTransition:function(){var t=Hc(Ua)[0],e=It().memoizedState;return[t,e]},useMutableSource:tv,useSyncExternalStore:nv,useId:gv,unstable_isNewReconciler:!1},Qk={readContext:Rt,useCallback:pv,useContext:Rt,useEffect:Ud,useImperativeHandle:hv,useInsertionEffect:lv,useLayoutEffect:uv,useMemo:fv,useReducer:qc,useRef:cv,useState:function(){return qc(Ua)},useDebugValue:Fd,useDeferredValue:function(t){var e=It();return Ne===null?e.memoizedState=t:mv(e,Ne.memoizedState,t)},useTransition:function(){var t=qc(Ua)[0],e=It().memoizedState;return[t,e]},useMutableSource:tv,useSyncExternalStore:nv,useId:gv,unstable_isNewReconciler:!1};function Mt(t,e){if(t&&t.defaultProps){e=Ce({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gl(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ce({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var rc={isMounted:function(t){return(t=t._reactInternals)?Nr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Xe(),i=$n(t),a=gn(r,i);a.payload=e,n!=null&&(a.callback=n),e=Hn(t,a,i),e!==null&&(Ht(e,t,i,r),jo(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Xe(),i=$n(t),a=gn(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=Hn(t,a,i),e!==null&&(Ht(e,t,i,r),jo(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Xe(),r=$n(t),i=gn(n,r);i.tag=2,e!=null&&(i.callback=e),e=Hn(t,i,r),e!==null&&(Ht(e,t,r,n),jo(e,t,r))}};function Cp(t,e,n,r,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!Oa(n,r)||!Oa(i,a):!0}function kv(t,e,n){var r=!1,i=Qn,a=e.contextType;return typeof a=="object"&&a!==null?a=Rt(a):(i=ct(e)?Cr:Ke.current,r=e.contextTypes,a=(r=r!=null)?vi(t,i):Qn),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function Sp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&rc.enqueueReplaceState(e,e.state,null)}function Zl(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Od(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Rt(a):(a=ct(e)?Cr:Ke.current,i.context=vi(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Gl(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&rc.enqueueReplaceState(i,i.state,null),Cs(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function wi(t,e){try{var n="",r=e;do n+=T1(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function $c(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ql(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Jk=typeof WeakMap=="function"?WeakMap:Map;function wv(t,e,n){n=gn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ps||(Ps=!0,au=r),Ql(t,e)},n}function Cv(t,e,n){n=gn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Ql(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Ql(t,e),typeof r!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Tp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Jk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=dw.bind(null,t,e,n),e.then(t,t))}function xp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ep(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=gn(-1,1),e.tag=2,Hn(n,e,1))),n.lanes|=1),t)}var Yk=Sn.ReactCurrentOwner,at=!1;function Je(t,e,n,r){e.child=t===null?Jg(e,null,n,r):yi(e,t.child,n,r)}function Pp(t,e,n,r,i){n=n.render;var a=e.ref;return ci(e,i),r=jd(t,e,n,r,a,i),n=Ad(),t!==null&&!at?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,kn(t,e,i)):(ve&&n&&Td(e),e.flags|=1,Je(t,e,r,i),e.child)}function Rp(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!Kd(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,Sv(t,e,a,r,i)):(t=Vo(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Oa,n(o,r)&&t.ref===e.ref)return kn(t,e,i)}return e.flags|=1,t=Wn(a,r),t.ref=e.ref,t.return=e,e.child=t}function Sv(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(Oa(a,r)&&t.ref===e.ref)if(at=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(at=!0);else return e.lanes=t.lanes,kn(t,e,i)}return Jl(t,e,n,r,i)}function Tv(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},de(ei,dt),dt|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,de(ei,dt),dt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,de(ei,dt),dt|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,de(ei,dt),dt|=r;return Je(t,e,i,n),e.child}function xv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Jl(t,e,n,r,i){var a=ct(n)?Cr:Ke.current;return a=vi(e,a),ci(e,i),n=jd(t,e,n,r,a,i),r=Ad(),t!==null&&!at?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,kn(t,e,i)):(ve&&r&&Td(e),e.flags|=1,Je(t,e,n,i),e.child)}function Ip(t,e,n,r,i){if(ct(n)){var a=!0;vs(e)}else a=!1;if(ci(e,i),e.stateNode===null)Fo(t,e),kv(e,n,r),Zl(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,s=e.memoizedProps;o.props=s;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Rt(l):(l=ct(n)?Cr:Ke.current,l=vi(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==r||c!==l)&&Sp(e,o,r,l),In=!1;var h=e.memoizedState;o.state=h,Cs(e,r,o,i),c=e.memoizedState,s!==r||h!==c||st.current||In?(typeof u=="function"&&(Gl(e,n,u,r),c=e.memoizedState),(s=In||Cp(e,n,s,r,h,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=s):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Xg(t,e),s=e.memoizedProps,l=e.type===e.elementType?s:Mt(e.type,s),o.props=l,d=e.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Rt(c):(c=ct(n)?Cr:Ke.current,c=vi(e,c));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==d||h!==c)&&Sp(e,o,r,c),In=!1,h=e.memoizedState,o.state=h,Cs(e,r,o,i);var v=e.memoizedState;s!==d||h!==v||st.current||In?(typeof f=="function"&&(Gl(e,n,f,r),v=e.memoizedState),(l=In||Cp(e,n,l,r,h,v,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Yl(t,e,n,r,a,i)}function Yl(t,e,n,r,i,a){xv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&fp(e,n,!1),kn(t,e,a);r=e.stateNode,Yk.current=e;var s=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=yi(e,t.child,null,a),e.child=yi(e,null,s,a)):Je(t,e,s,a),e.memoizedState=r.state,i&&fp(e,n,!0),e.child}function Ev(t){var e=t.stateNode;e.pendingContext?pp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&pp(t,e.context,!1),Nd(t,e.containerInfo)}function _p(t,e,n,r,i){return bi(),Ed(i),e.flags|=256,Je(t,e,n,r),e.child}var Xl={dehydrated:null,treeContext:null,retryLane:0};function eu(t){return{baseLanes:t,cachePool:null,transitions:null}}function Pv(t,e,n){var r=e.pendingProps,i=ke.current,a=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=t!==null&&t.memoizedState===null?!1:(i&2)!==0),s?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),de(ke,i&1),t===null)return Wl(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=oc(o,r,0,null),t=br(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=eu(n),e.memoizedState=Xl,t):Bd(e,o));if(i=t.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return Xk(t,e,o,r,s,i,n);if(a){a=r.fallback,o=e.mode,i=t.child,s=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Wn(i,c),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?a=Wn(s,a):(a=br(a,o,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?eu(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=Xl,r}return a=t.child,t=a.sibling,r=Wn(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Bd(t,e){return e=oc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mo(t,e,n,r){return r!==null&&Ed(r),yi(e,t.child,null,n),t=Bd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Xk(t,e,n,r,i,a,o){if(n)return e.flags&256?(e.flags&=-257,r=$c(Error(L(422))),mo(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=oc({mode:"visible",children:r.children},i,0,null),a=br(a,i,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&yi(e,t.child,null,o),e.child.memoizedState=eu(o),e.memoizedState=Xl,a);if(!(e.mode&1))return mo(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,a=Error(L(419)),r=$c(a,r,void 0),mo(t,e,o,r)}if(s=(o&t.childLanes)!==0,at||s){if(r=Ae,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,yn(t,i),Ht(r,t,i,-1))}return Wd(),r=$c(Error(L(421))),mo(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=hw.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,pt=Vn(i.nextSibling),gt=e,ve=!0,At=null,t!==null&&(wt[Ct++]=pn,wt[Ct++]=fn,wt[Ct++]=Sr,pn=t.id,fn=t.overflow,Sr=e),e=Bd(e,r.children),e.flags|=4096,e)}function Op(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Kl(t.return,e,n)}function Wc(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Rv(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(Je(t,e,r.children,n),r=ke.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Op(t,n,e);else if(t.tag===19)Op(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(de(ke,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ss(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Wc(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ss(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Wc(e,!0,n,null,a);break;case"together":Wc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function kn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=Wn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Wn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ew(t,e,n){switch(e.tag){case 3:Ev(e),bi();break;case 5:ev(e);break;case 1:ct(e.type)&&vs(e);break;case 4:Nd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;de(ks,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(de(ke,ke.current&1),e.flags|=128,null):n&e.child.childLanes?Pv(t,e,n):(de(ke,ke.current&1),t=kn(t,e,n),t!==null?t.sibling:null);de(ke,ke.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Rv(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),de(ke,ke.current),r)break;return null;case 22:case 23:return e.lanes=0,Tv(t,e,n)}return kn(t,e,n)}var Iv,tu,_v,Ov;Iv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};tu=function(){};_v=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,mr(nn.current);var a=null;switch(n){case"input":i=Sl(t,i),r=Sl(t,r),a=[];break;case"select":i=Ce({},i,{value:void 0}),r=Ce({},r,{value:void 0}),a=[];break;case"textarea":i=El(t,i),r=El(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ms)}Rl(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var s=i[l];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Ta.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in r){var c=r[l];if(s=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(c!=null||s!=null))if(l==="style")if(s){for(o in s)!s.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&s[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,s=s?s.__html:void 0,c!=null&&s!==c&&(a=a||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Ta.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&pe("scroll",t),a||s===c||(a=[])):(a=a||[]).push(l,c))}n&&(a=a||[]).push("style",n);var l=a;(e.updateQueue=l)&&(e.flags|=4)}};Ov=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vi(t,e){if(!ve)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $e(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function tw(t,e,n){var r=e.pendingProps;switch(xd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $e(e),null;case 1:return ct(e.type)&&gs(),$e(e),null;case 3:return r=e.stateNode,ki(),fe(st),fe(Ke),Md(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(po(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,At!==null&&(cu(At),At=null))),tu(t,e),$e(e),null;case 5:Ld(e);var i=mr(ja.current);if(n=e.type,t!==null&&e.stateNode!=null)_v(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return $e(e),null}if(t=mr(nn.current),po(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[en]=e,r[Ma]=a,t=(e.mode&1)!==0,n){case"dialog":pe("cancel",r),pe("close",r);break;case"iframe":case"object":case"embed":pe("load",r);break;case"video":case"audio":for(i=0;i<na.length;i++)pe(na[i],r);break;case"source":pe("error",r);break;case"img":case"image":case"link":pe("error",r),pe("load",r);break;case"details":pe("toggle",r);break;case"input":Bh(r,a),pe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},pe("invalid",r);break;case"textarea":Vh(r,a),pe("invalid",r)}Rl(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];o==="children"?typeof s=="string"?r.textContent!==s&&(a.suppressHydrationWarning!==!0&&ho(r.textContent,s,t),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&ho(r.textContent,s,t),i=["children",""+s]):Ta.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&pe("scroll",r)}switch(n){case"input":ro(r),zh(r,a,!0);break;case"textarea":ro(r),Hh(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=ms)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ag(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[en]=e,t[Ma]=r,Iv(t,e,!1,!1),e.stateNode=t;e:{switch(o=Il(n,r),n){case"dialog":pe("cancel",t),pe("close",t),i=r;break;case"iframe":case"object":case"embed":pe("load",t),i=r;break;case"video":case"audio":for(i=0;i<na.length;i++)pe(na[i],t);i=r;break;case"source":pe("error",t),i=r;break;case"img":case"image":case"link":pe("error",t),pe("load",t),i=r;break;case"details":pe("toggle",t),i=r;break;case"input":Bh(t,r),i=Sl(t,r),pe("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ce({},r,{value:void 0}),pe("invalid",t);break;case"textarea":Vh(t,r),i=El(t,r),pe("invalid",t);break;default:i=r}Rl(n,i),s=i;for(a in s)if(s.hasOwnProperty(a)){var c=s[a];a==="style"?cg(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&og(t,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&xa(t,c):typeof c=="number"&&xa(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ta.hasOwnProperty(a)?c!=null&&a==="onScroll"&&pe("scroll",t):c!=null&&ud(t,a,c,o))}switch(n){case"input":ro(t),zh(t,r,!1);break;case"textarea":ro(t),Hh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Zn(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?ii(t,!!r.multiple,a,!1):r.defaultValue!=null&&ii(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ms)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $e(e),null;case 6:if(t&&e.stateNode!=null)Ov(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=mr(ja.current),mr(nn.current),po(e)){if(r=e.stateNode,n=e.memoizedProps,r[en]=e,(a=r.nodeValue!==n)&&(t=gt,t!==null))switch(t.tag){case 3:ho(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ho(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[en]=e,e.stateNode=r}return $e(e),null;case 13:if(fe(ke),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ve&&pt!==null&&e.mode&1&&!(e.flags&128))Zg(),bi(),e.flags|=98560,a=!1;else if(a=po(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(L(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(L(317));a[en]=e}else bi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$e(e),a=!1}else At!==null&&(cu(At),At=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ke.current&1?Le===0&&(Le=3):Wd())),e.updateQueue!==null&&(e.flags|=4),$e(e),null);case 4:return ki(),tu(t,e),t===null&&Na(e.stateNode.containerInfo),$e(e),null;case 10:return Id(e.type._context),$e(e),null;case 17:return ct(e.type)&&gs(),$e(e),null;case 19:if(fe(ke),a=e.memoizedState,a===null)return $e(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)Vi(a,!1);else{if(Le!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ss(t),o!==null){for(e.flags|=128,Vi(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return de(ke,ke.current&1|2),e.child}t=t.sibling}a.tail!==null&&Pe()>Ci&&(e.flags|=128,r=!0,Vi(a,!1),e.lanes=4194304)}else{if(!r)if(t=Ss(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vi(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!ve)return $e(e),null}else 2*Pe()-a.renderingStartTime>Ci&&n!==1073741824&&(e.flags|=128,r=!0,Vi(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Pe(),e.sibling=null,n=ke.current,de(ke,r?n&1|2:n&1),e):($e(e),null);case 22:case 23:return $d(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?dt&1073741824&&($e(e),e.subtreeFlags&6&&(e.flags|=8192)):$e(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function nw(t,e){switch(xd(e),e.tag){case 1:return ct(e.type)&&gs(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ki(),fe(st),fe(Ke),Md(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ld(e),null;case 13:if(fe(ke),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));bi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return fe(ke),null;case 4:return ki(),null;case 10:return Id(e.type._context),null;case 22:case 23:return $d(),null;case 24:return null;default:return null}}var go=!1,We=!1,rw=typeof WeakSet=="function"?WeakSet:Set,V=null;function Xr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Te(t,e,r)}else n.current=null}function Nv(t,e,n){try{n()}catch(r){Te(t,e,r)}}var Np=!1;function iw(t,e){if(Fl=hs,t=jg(),Sd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,s=-1,c=-1,l=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(s=o+i),d!==a||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++l===i&&(s=o),h===a&&++u===r&&(c=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=s===-1||c===-1?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bl={focusedElem:t,selectionRange:n},hs=!1,V=e;V!==null;)if(e=V,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,V=t;else for(;V!==null;){e=V;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var k=v.memoizedProps,S=v.memoizedState,g=e.stateNode,b=g.getSnapshotBeforeUpdate(e.elementType===e.type?k:Mt(e.type,k),S);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var p=e.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(m){Te(e,e.return,m)}if(t=e.sibling,t!==null){t.return=e.return,V=t;break}V=e.return}return v=Np,Np=!1,v}function da(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Nv(e,n,a)}i=i.next}while(i!==r)}}function ic(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function nu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Lv(t){var e=t.alternate;e!==null&&(t.alternate=null,Lv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[en],delete e[Ma],delete e[Hl],delete e[Bk],delete e[zk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Mv(t){return t.tag===5||t.tag===3||t.tag===4}function Lp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Mv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ru(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ms));else if(r!==4&&(t=t.child,t!==null))for(ru(t,e,n),t=t.sibling;t!==null;)ru(t,e,n),t=t.sibling}function iu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(iu(t,e,n),t=t.sibling;t!==null;)iu(t,e,n),t=t.sibling}var Fe=null,Dt=!1;function Tn(t,e,n){for(n=n.child;n!==null;)Dv(t,e,n),n=n.sibling}function Dv(t,e,n){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Qs,n)}catch{}switch(n.tag){case 5:We||Xr(n,e);case 6:var r=Fe,i=Dt;Fe=null,Tn(t,e,n),Fe=r,Dt=i,Fe!==null&&(Dt?(t=Fe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Fe.removeChild(n.stateNode));break;case 18:Fe!==null&&(Dt?(t=Fe,n=n.stateNode,t.nodeType===8?Fc(t.parentNode,n):t.nodeType===1&&Fc(t,n),Ia(t)):Fc(Fe,n.stateNode));break;case 4:r=Fe,i=Dt,Fe=n.stateNode.containerInfo,Dt=!0,Tn(t,e,n),Fe=r,Dt=i;break;case 0:case 11:case 14:case 15:if(!We&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Nv(n,e,o),i=i.next}while(i!==r)}Tn(t,e,n);break;case 1:if(!We&&(Xr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Te(n,e,s)}Tn(t,e,n);break;case 21:Tn(t,e,n);break;case 22:n.mode&1?(We=(r=We)||n.memoizedState!==null,Tn(t,e,n),We=r):Tn(t,e,n);break;default:Tn(t,e,n)}}function Mp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new rw),e.forEach(function(r){var i=pw.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ot(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,o=e,s=o;e:for(;s!==null;){switch(s.tag){case 5:Fe=s.stateNode,Dt=!1;break e;case 3:Fe=s.stateNode.containerInfo,Dt=!0;break e;case 4:Fe=s.stateNode.containerInfo,Dt=!0;break e}s=s.return}if(Fe===null)throw Error(L(160));Dv(a,o,i),Fe=null,Dt=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Te(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)jv(e,t),e=e.sibling}function jv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ot(e,t),Gt(t),r&4){try{da(3,t,t.return),ic(3,t)}catch(k){Te(t,t.return,k)}try{da(5,t,t.return)}catch(k){Te(t,t.return,k)}}break;case 1:Ot(e,t),Gt(t),r&512&&n!==null&&Xr(n,n.return);break;case 5:if(Ot(e,t),Gt(t),r&512&&n!==null&&Xr(n,n.return),t.flags&32){var i=t.stateNode;try{xa(i,"")}catch(k){Te(t,t.return,k)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,s=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&rg(i,a),Il(s,o);var l=Il(s,a);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?cg(i,d):u==="dangerouslySetInnerHTML"?og(i,d):u==="children"?xa(i,d):ud(i,u,d,l)}switch(s){case"input":Tl(i,a);break;case"textarea":ig(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?ii(i,!!a.multiple,f,!1):h!==!!a.multiple&&(a.defaultValue!=null?ii(i,!!a.multiple,a.defaultValue,!0):ii(i,!!a.multiple,a.multiple?[]:"",!1))}i[Ma]=a}catch(k){Te(t,t.return,k)}}break;case 6:if(Ot(e,t),Gt(t),r&4){if(t.stateNode===null)throw Error(L(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(k){Te(t,t.return,k)}}break;case 3:if(Ot(e,t),Gt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ia(e.containerInfo)}catch(k){Te(t,t.return,k)}break;case 4:Ot(e,t),Gt(t);break;case 13:Ot(e,t),Gt(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Hd=Pe())),r&4&&Mp(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(We=(l=We)||u,Ot(e,t),We=l):Ot(e,t),Gt(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(V=t,u=t.child;u!==null;){for(d=V=u;V!==null;){switch(h=V,f=h.child,h.tag){case 0:case 11:case 14:case 15:da(4,h,h.return);break;case 1:Xr(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(k){Te(r,n,k)}}break;case 5:Xr(h,h.return);break;case 22:if(h.memoizedState!==null){jp(d);continue}}f!==null?(f.return=h,V=f):jp(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,s.style.display=sg("display",o))}catch(k){Te(t,t.return,k)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(k){Te(t,t.return,k)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ot(e,t),Gt(t),r&4&&Mp(t);break;case 21:break;default:Ot(e,t),Gt(t)}}function Gt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Mv(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(xa(i,""),r.flags&=-33);var a=Lp(t);iu(t,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,s=Lp(t);ru(t,s,o);break;default:throw Error(L(161))}}catch(c){Te(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function aw(t,e,n){V=t,Av(t)}function Av(t,e,n){for(var r=(t.mode&1)!==0;V!==null;){var i=V,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||go;if(!o){var s=i.alternate,c=s!==null&&s.memoizedState!==null||We;s=go;var l=We;if(go=o,(We=c)&&!l)for(V=i;V!==null;)o=V,c=o.child,o.tag===22&&o.memoizedState!==null?Ap(i):c!==null?(c.return=o,V=c):Ap(i);for(;a!==null;)V=a,Av(a),a=a.sibling;V=i,go=s,We=l}Dp(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,V=a):Dp(t)}}function Dp(t){for(;V!==null;){var e=V;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:We||ic(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!We)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Mt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&yp(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}yp(e,o,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ia(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}We||e.flags&512&&nu(e)}catch(h){Te(e,e.return,h)}}if(e===t){V=null;break}if(n=e.sibling,n!==null){n.return=e.return,V=n;break}V=e.return}}function jp(t){for(;V!==null;){var e=V;if(e===t){V=null;break}var n=e.sibling;if(n!==null){n.return=e.return,V=n;break}V=e.return}}function Ap(t){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ic(4,e)}catch(c){Te(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Te(e,i,c)}}var a=e.return;try{nu(e)}catch(c){Te(e,a,c)}break;case 5:var o=e.return;try{nu(e)}catch(c){Te(e,o,c)}}}catch(c){Te(e,e.return,c)}if(e===t){V=null;break}var s=e.sibling;if(s!==null){s.return=e.return,V=s;break}V=e.return}}var ow=Math.ceil,Es=Sn.ReactCurrentDispatcher,zd=Sn.ReactCurrentOwner,Pt=Sn.ReactCurrentBatchConfig,ne=0,Ae=null,_e=null,Ve=0,dt=0,ei=er(0),Le=0,Ba=null,xr=0,ac=0,Vd=0,ha=null,rt=null,Hd=0,Ci=1/0,cn=null,Ps=!1,au=null,qn=null,vo=!1,An=null,Rs=0,pa=0,ou=null,Bo=-1,zo=0;function Xe(){return ne&6?Pe():Bo!==-1?Bo:Bo=Pe()}function $n(t){return t.mode&1?ne&2&&Ve!==0?Ve&-Ve:Hk.transition!==null?(zo===0&&(zo=kg()),zo):(t=se,t!==0||(t=window.event,t=t===void 0?16:Pg(t.type)),t):1}function Ht(t,e,n,r){if(50<pa)throw pa=0,ou=null,Error(L(185));Qa(t,n,r),(!(ne&2)||t!==Ae)&&(t===Ae&&(!(ne&2)&&(ac|=n),Le===4&&Nn(t,Ve)),lt(t,r),n===1&&ne===0&&!(e.mode&1)&&(Ci=Pe()+500,tc&&tr()))}function lt(t,e){var n=t.callbackNode;H1(t,e);var r=ds(t,t===Ae?Ve:0);if(r===0)n!==null&&Wh(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Wh(n),e===1)t.tag===0?Vk(Up.bind(null,t)):Wg(Up.bind(null,t)),Uk(function(){!(ne&6)&&tr()}),n=null;else{switch(wg(r)){case 1:n=md;break;case 4:n=bg;break;case 16:n=us;break;case 536870912:n=yg;break;default:n=us}n=$v(n,Uv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Uv(t,e){if(Bo=-1,zo=0,ne&6)throw Error(L(327));var n=t.callbackNode;if(li()&&t.callbackNode!==n)return null;var r=ds(t,t===Ae?Ve:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Is(t,r);else{e=r;var i=ne;ne|=2;var a=Bv();(Ae!==t||Ve!==e)&&(cn=null,Ci=Pe()+500,vr(t,e));do try{lw();break}catch(s){Fv(t,s)}while(!0);Rd(),Es.current=a,ne=i,_e!==null?e=0:(Ae=null,Ve=0,e=Le)}if(e!==0){if(e===2&&(i=Ml(t),i!==0&&(r=i,e=su(t,i))),e===1)throw n=Ba,vr(t,0),Nn(t,r),lt(t,Pe()),n;if(e===6)Nn(t,r);else{if(i=t.current.alternate,!(r&30)&&!sw(i)&&(e=Is(t,r),e===2&&(a=Ml(t),a!==0&&(r=a,e=su(t,a))),e===1))throw n=Ba,vr(t,0),Nn(t,r),lt(t,Pe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:lr(t,rt,cn);break;case 3:if(Nn(t,r),(r&130023424)===r&&(e=Hd+500-Pe(),10<e)){if(ds(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Xe(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Vl(lr.bind(null,t,rt,cn),e);break}lr(t,rt,cn);break;case 4:if(Nn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Vt(r);a=1<<o,o=e[o],o>i&&(i=o),r&=~a}if(r=i,r=Pe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ow(r/1960))-r,10<r){t.timeoutHandle=Vl(lr.bind(null,t,rt,cn),r);break}lr(t,rt,cn);break;case 5:lr(t,rt,cn);break;default:throw Error(L(329))}}}return lt(t,Pe()),t.callbackNode===n?Uv.bind(null,t):null}function su(t,e){var n=ha;return t.current.memoizedState.isDehydrated&&(vr(t,e).flags|=256),t=Is(t,e),t!==2&&(e=rt,rt=n,e!==null&&cu(e)),t}function cu(t){rt===null?rt=t:rt.push.apply(rt,t)}function sw(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!qt(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Nn(t,e){for(e&=~Vd,e&=~ac,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Vt(e),r=1<<n;t[n]=-1,e&=~r}}function Up(t){if(ne&6)throw Error(L(327));li();var e=ds(t,0);if(!(e&1))return lt(t,Pe()),null;var n=Is(t,e);if(t.tag!==0&&n===2){var r=Ml(t);r!==0&&(e=r,n=su(t,r))}if(n===1)throw n=Ba,vr(t,0),Nn(t,e),lt(t,Pe()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,lr(t,rt,cn),lt(t,Pe()),null}function qd(t,e){var n=ne;ne|=1;try{return t(e)}finally{ne=n,ne===0&&(Ci=Pe()+500,tc&&tr())}}function Er(t){An!==null&&An.tag===0&&!(ne&6)&&li();var e=ne;ne|=1;var n=Pt.transition,r=se;try{if(Pt.transition=null,se=1,t)return t()}finally{se=r,Pt.transition=n,ne=e,!(ne&6)&&tr()}}function $d(){dt=ei.current,fe(ei)}function vr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ak(n)),_e!==null)for(n=_e.return;n!==null;){var r=n;switch(xd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&gs();break;case 3:ki(),fe(st),fe(Ke),Md();break;case 5:Ld(r);break;case 4:ki();break;case 13:fe(ke);break;case 19:fe(ke);break;case 10:Id(r.type._context);break;case 22:case 23:$d()}n=n.return}if(Ae=t,_e=t=Wn(t.current,null),Ve=dt=e,Le=0,Ba=null,Vd=ac=xr=0,rt=ha=null,fr!==null){for(e=0;e<fr.length;e++)if(n=fr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}fr=null}return t}function Fv(t,e){do{var n=_e;try{if(Rd(),Ao.current=xs,Ts){for(var r=we.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Ts=!1}if(Tr=0,De=Ne=we=null,ua=!1,Aa=0,zd.current=null,n===null||n.return===null){Le=1,Ba=e,_e=null;break}e:{var a=t,o=n.return,s=n,c=e;if(e=Ve,s.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=s,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=xp(o);if(f!==null){f.flags&=-257,Ep(f,o,s,a,e),f.mode&1&&Tp(a,l,e),e=f,c=l;var v=e.updateQueue;if(v===null){var k=new Set;k.add(c),e.updateQueue=k}else v.add(c);break e}else{if(!(e&1)){Tp(a,l,e),Wd();break e}c=Error(L(426))}}else if(ve&&s.mode&1){var S=xp(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Ep(S,o,s,a,e),Ed(wi(c,s));break e}}a=c=wi(c,s),Le!==4&&(Le=2),ha===null?ha=[a]:ha.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var g=wv(a,c,e);bp(a,g);break e;case 1:s=c;var b=a.type,p=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(qn===null||!qn.has(p)))){a.flags|=65536,e&=-e,a.lanes|=e;var m=Cv(a,s,e);bp(a,m);break e}}a=a.return}while(a!==null)}Vv(n)}catch(w){e=w,_e===n&&n!==null&&(_e=n=n.return);continue}break}while(!0)}function Bv(){var t=Es.current;return Es.current=xs,t===null?xs:t}function Wd(){(Le===0||Le===3||Le===2)&&(Le=4),Ae===null||!(xr&268435455)&&!(ac&268435455)||Nn(Ae,Ve)}function Is(t,e){var n=ne;ne|=2;var r=Bv();(Ae!==t||Ve!==e)&&(cn=null,vr(t,e));do try{cw();break}catch(i){Fv(t,i)}while(!0);if(Rd(),ne=n,Es.current=r,_e!==null)throw Error(L(261));return Ae=null,Ve=0,Le}function cw(){for(;_e!==null;)zv(_e)}function lw(){for(;_e!==null&&!M1();)zv(_e)}function zv(t){var e=qv(t.alternate,t,dt);t.memoizedProps=t.pendingProps,e===null?Vv(t):_e=e,zd.current=null}function Vv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=nw(n,e),n!==null){n.flags&=32767,_e=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Le=6,_e=null;return}}else if(n=tw(n,e,dt),n!==null){_e=n;return}if(e=e.sibling,e!==null){_e=e;return}_e=e=t}while(e!==null);Le===0&&(Le=5)}function lr(t,e,n){var r=se,i=Pt.transition;try{Pt.transition=null,se=1,uw(t,e,n,r)}finally{Pt.transition=i,se=r}return null}function uw(t,e,n,r){do li();while(An!==null);if(ne&6)throw Error(L(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(q1(t,a),t===Ae&&(_e=Ae=null,Ve=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vo||(vo=!0,$v(us,function(){return li(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Pt.transition,Pt.transition=null;var o=se;se=1;var s=ne;ne|=4,zd.current=null,iw(t,n),jv(n,t),_k(Bl),hs=!!Fl,Bl=Fl=null,t.current=n,aw(n),D1(),ne=s,se=o,Pt.transition=a}else t.current=n;if(vo&&(vo=!1,An=t,Rs=i),a=t.pendingLanes,a===0&&(qn=null),U1(n.stateNode),lt(t,Pe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ps)throw Ps=!1,t=au,au=null,t;return Rs&1&&t.tag!==0&&li(),a=t.pendingLanes,a&1?t===ou?pa++:(pa=0,ou=t):pa=0,tr(),null}function li(){if(An!==null){var t=wg(Rs),e=Pt.transition,n=se;try{if(Pt.transition=null,se=16>t?16:t,An===null)var r=!1;else{if(t=An,An=null,Rs=0,ne&6)throw Error(L(331));var i=ne;for(ne|=4,V=t.current;V!==null;){var a=V,o=a.child;if(V.flags&16){var s=a.deletions;if(s!==null){for(var c=0;c<s.length;c++){var l=s[c];for(V=l;V!==null;){var u=V;switch(u.tag){case 0:case 11:case 15:da(8,u,a)}var d=u.child;if(d!==null)d.return=u,V=d;else for(;V!==null;){u=V;var h=u.sibling,f=u.return;if(Lv(u),u===l){V=null;break}if(h!==null){h.return=f,V=h;break}V=f}}}var v=a.alternate;if(v!==null){var k=v.child;if(k!==null){v.child=null;do{var S=k.sibling;k.sibling=null,k=S}while(k!==null)}}V=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,V=o;else e:for(;V!==null;){if(a=V,a.flags&2048)switch(a.tag){case 0:case 11:case 15:da(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,V=g;break e}V=a.return}}var b=t.current;for(V=b;V!==null;){o=V;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,V=p;else e:for(o=b;V!==null;){if(s=V,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:ic(9,s)}}catch(w){Te(s,s.return,w)}if(s===o){V=null;break e}var m=s.sibling;if(m!==null){m.return=s.return,V=m;break e}V=s.return}}if(ne=i,tr(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Qs,t)}catch{}r=!0}return r}finally{se=n,Pt.transition=e}}return!1}function Fp(t,e,n){e=wi(n,e),e=wv(t,e,1),t=Hn(t,e,1),e=Xe(),t!==null&&(Qa(t,1,e),lt(t,e))}function Te(t,e,n){if(t.tag===3)Fp(t,t,n);else for(;e!==null;){if(e.tag===3){Fp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qn===null||!qn.has(r))){t=wi(n,t),t=Cv(e,t,1),e=Hn(e,t,1),t=Xe(),e!==null&&(Qa(e,1,t),lt(e,t));break}}e=e.return}}function dw(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Xe(),t.pingedLanes|=t.suspendedLanes&n,Ae===t&&(Ve&n)===n&&(Le===4||Le===3&&(Ve&130023424)===Ve&&500>Pe()-Hd?vr(t,0):Vd|=n),lt(t,e)}function Hv(t,e){e===0&&(t.mode&1?(e=oo,oo<<=1,!(oo&130023424)&&(oo=4194304)):e=1);var n=Xe();t=yn(t,e),t!==null&&(Qa(t,e,n),lt(t,n))}function hw(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Hv(t,n)}function pw(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),Hv(t,n)}var qv;qv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||st.current)at=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return at=!1,ew(t,e,n);at=!!(t.flags&131072)}else at=!1,ve&&e.flags&1048576&&Kg(e,ys,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fo(t,e),t=e.pendingProps;var i=vi(e,Ke.current);ci(e,n),i=jd(null,e,r,t,i,n);var a=Ad();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ct(r)?(a=!0,vs(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Od(e),i.updater=rc,e.stateNode=i,i._reactInternals=e,Zl(e,r,t,n),e=Yl(null,e,r,!0,a,n)):(e.tag=0,ve&&a&&Td(e),Je(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fo(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=mw(r),t=Mt(r,t),i){case 0:e=Jl(null,e,r,t,n);break e;case 1:e=Ip(null,e,r,t,n);break e;case 11:e=Pp(null,e,r,t,n);break e;case 14:e=Rp(null,e,r,Mt(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),Jl(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),Ip(t,e,r,i,n);case 3:e:{if(Ev(e),t===null)throw Error(L(387));r=e.pendingProps,a=e.memoizedState,i=a.element,Xg(t,e),Cs(e,r,null,n);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=wi(Error(L(423)),e),e=_p(t,e,r,n,i);break e}else if(r!==i){i=wi(Error(L(424)),e),e=_p(t,e,r,n,i);break e}else for(pt=Vn(e.stateNode.containerInfo.firstChild),gt=e,ve=!0,At=null,n=Jg(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bi(),r===i){e=kn(t,e,n);break e}Je(t,e,r,n)}e=e.child}return e;case 5:return ev(e),t===null&&Wl(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,o=i.children,zl(r,i)?o=null:a!==null&&zl(r,a)&&(e.flags|=32),xv(t,e),Je(t,e,o,n),e.child;case 6:return t===null&&Wl(e),null;case 13:return Pv(t,e,n);case 4:return Nd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=yi(e,null,r,n):Je(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),Pp(t,e,r,i,n);case 7:return Je(t,e,e.pendingProps,n),e.child;case 8:return Je(t,e,e.pendingProps.children,n),e.child;case 12:return Je(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value,de(ks,r._currentValue),r._currentValue=o,a!==null)if(qt(a.value,o)){if(a.children===i.children&&!st.current){e=kn(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var s=a.dependencies;if(s!==null){o=a.child;for(var c=s.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=gn(-1,n&-n),c.tag=2;var l=a.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Kl(a.return,n,e),s.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(L(341));o.lanes|=n,s=o.alternate,s!==null&&(s.lanes|=n),Kl(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Je(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ci(e,n),i=Rt(i),r=r(i),e.flags|=1,Je(t,e,r,n),e.child;case 14:return r=e.type,i=Mt(r,e.pendingProps),i=Mt(r.type,i),Rp(t,e,r,i,n);case 15:return Sv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mt(r,i),Fo(t,e),e.tag=1,ct(r)?(t=!0,vs(e)):t=!1,ci(e,n),kv(e,r,i),Zl(e,r,i,n),Yl(null,e,r,!0,t,n);case 19:return Rv(t,e,n);case 22:return Tv(t,e,n)}throw Error(L(156,e.tag))};function $v(t,e){return vg(t,e)}function fw(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function St(t,e,n,r){return new fw(t,e,n,r)}function Kd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function mw(t){if(typeof t=="function")return Kd(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hd)return 11;if(t===pd)return 14}return 2}function Wn(t,e){var n=t.alternate;return n===null?(n=St(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Vo(t,e,n,r,i,a){var o=2;if(r=t,typeof t=="function")Kd(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qr:return br(n.children,i,a,e);case dd:o=8,i|=8;break;case yl:return t=St(12,n,e,i|2),t.elementType=yl,t.lanes=a,t;case kl:return t=St(13,n,e,i),t.elementType=kl,t.lanes=a,t;case wl:return t=St(19,n,e,i),t.elementType=wl,t.lanes=a,t;case eg:return oc(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ym:o=10;break e;case Xm:o=9;break e;case hd:o=11;break e;case pd:o=14;break e;case Rn:o=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=St(o,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function br(t,e,n,r){return t=St(7,t,r,e),t.lanes=n,t}function oc(t,e,n,r){return t=St(22,t,r,e),t.elementType=eg,t.lanes=n,t.stateNode={isHidden:!1},t}function Kc(t,e,n){return t=St(6,t,null,e),t.lanes=n,t}function Gc(t,e,n){return e=St(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function gw(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rc(0),this.expirationTimes=Rc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gd(t,e,n,r,i,a,o,s,c){return t=new gw(t,e,n,s,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=St(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Od(a),t}function vw(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Wv(t){if(!t)return Qn;t=t._reactInternals;e:{if(Nr(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ct(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(ct(n))return $g(t,n,e)}return e}function Kv(t,e,n,r,i,a,o,s,c){return t=Gd(n,r,!0,t,i,a,o,s,c),t.context=Wv(null),n=t.current,r=Xe(),i=$n(n),a=gn(r,i),a.callback=e??null,Hn(n,a,i),t.current.lanes=i,Qa(t,i,r),lt(t,r),t}function sc(t,e,n,r){var i=e.current,a=Xe(),o=$n(i);return n=Wv(n),e.context===null?e.context=n:e.pendingContext=n,e=gn(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Hn(i,e,o),t!==null&&(Ht(t,i,o,a),jo(t,i,o)),o}function _s(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Bp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Zd(t,e){Bp(t,e),(t=t.alternate)&&Bp(t,e)}function bw(){return null}var Gv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qd(t){this._internalRoot=t}cc.prototype.render=Qd.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));sc(t,e,null,null)};cc.prototype.unmount=Qd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Er(function(){sc(null,t,null,null)}),e[bn]=null}};function cc(t){this._internalRoot=t}cc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Tg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<On.length&&e!==0&&e<On[n].priority;n++);On.splice(n,0,t),n===0&&Eg(t)}};function Jd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zp(){}function yw(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var l=_s(o);a.call(l)}}var o=Kv(e,r,t,0,null,!1,!1,"",zp);return t._reactRootContainer=o,t[bn]=o.current,Na(t.nodeType===8?t.parentNode:t),Er(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var l=_s(c);s.call(l)}}var c=Gd(t,0,!1,null,null,!1,!1,"",zp);return t._reactRootContainer=c,t[bn]=c.current,Na(t.nodeType===8?t.parentNode:t),Er(function(){sc(e,c,n,r)}),c}function uc(t,e,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var s=i;i=function(){var c=_s(o);s.call(c)}}sc(e,o,t,i)}else o=yw(n,e,t,i,r);return _s(o)}Cg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ta(e.pendingLanes);n!==0&&(gd(e,n|1),lt(e,Pe()),!(ne&6)&&(Ci=Pe()+500,tr()))}break;case 13:Er(function(){var r=yn(t,1);if(r!==null){var i=Xe();Ht(r,t,1,i)}}),Zd(t,1)}};vd=function(t){if(t.tag===13){var e=yn(t,134217728);if(e!==null){var n=Xe();Ht(e,t,134217728,n)}Zd(t,134217728)}};Sg=function(t){if(t.tag===13){var e=$n(t),n=yn(t,e);if(n!==null){var r=Xe();Ht(n,t,e,r)}Zd(t,e)}};Tg=function(){return se};xg=function(t,e){var n=se;try{return se=t,e()}finally{se=n}};Ol=function(t,e,n){switch(e){case"input":if(Tl(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ec(r);if(!i)throw Error(L(90));ng(r),Tl(r,i)}}}break;case"textarea":ig(t,n);break;case"select":e=n.value,e!=null&&ii(t,!!n.multiple,e,!1)}};dg=qd;hg=Er;var kw={usingClientEntryPoint:!1,Events:[Ya,Gr,ec,lg,ug,qd]},Hi={findFiberByHostInstance:pr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ww={bundleType:Hi.bundleType,version:Hi.version,rendererPackageName:Hi.rendererPackageName,rendererConfig:Hi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=mg(t),t===null?null:t.stateNode},findFiberByHostInstance:Hi.findFiberByHostInstance||bw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{Qs=bo.inject(ww),tn=bo}catch{}}bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kw;bt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jd(e))throw Error(L(200));return vw(t,e,null,n)};bt.createRoot=function(t,e){if(!Jd(t))throw Error(L(299));var n=!1,r="",i=Gv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Gd(t,1,!1,null,null,n,!1,r,i),t[bn]=e.current,Na(t.nodeType===8?t.parentNode:t),new Qd(e)};bt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=mg(e),t=t===null?null:t.stateNode,t};bt.flushSync=function(t){return Er(t)};bt.hydrate=function(t,e,n){if(!lc(e))throw Error(L(200));return uc(null,t,e,!0,n)};bt.hydrateRoot=function(t,e,n){if(!Jd(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=Gv;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Kv(e,null,t,1,n??null,i,!1,a,o),t[bn]=e.current,Na(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new cc(e)};bt.render=function(t,e,n){if(!lc(e))throw Error(L(200));return uc(null,t,e,!1,n)};bt.unmountComponentAtNode=function(t){if(!lc(t))throw Error(L(40));return t._reactRootContainer?(Er(function(){uc(null,null,t,!1,function(){t._reactRootContainer=null,t[bn]=null})}),!0):!1};bt.unstable_batchedUpdates=qd;bt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lc(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return uc(t,e,n,!1,r)};bt.version="18.3.1-next-f1338f8080-20240426";function Zv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zv)}catch(t){console.error(t)}}Zv(),Gm.exports=bt;var Cw=Gm.exports,Qv,Vp=Cw;Qv=Vp.createRoot,Vp.hydrateRoot;var Jv=function(t,e,n,r){var i;e[0]=0;for(var a=1;a<e.length;a++){var o=e[a++],s=e[a]?(e[0]|=o?1:2,n[e[a++]]):e[++a];o===3?r[0]=s:o===4?r[1]=Object.assign(r[1]||{},s):o===5?(r[1]=r[1]||{})[e[++a]]=s:o===6?r[1][e[++a]]+=s+"":o?(i=t.apply(s,Jv(t,s,n,["",null])),r.push(i),s[0]?e[0]|=2:(e[a-2]=0,e[a]=i)):r.push(s)}return r},Hp=new Map;function Sw(t){var e=Hp.get(this);return e||(e=new Map,Hp.set(this,e)),(e=Jv(this,e.get(t)||(e.set(t,e=function(n){for(var r,i,a=1,o="",s="",c=[0],l=function(h){a===1&&(h||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?c.push(0,h,o):a===3&&(h||o)?(c.push(3,h,o),a=2):a===2&&o==="..."&&h?c.push(4,h,0):a===2&&o&&!h?c.push(5,0,!0,o):a>=5&&((o||!h&&a===5)&&(c.push(a,0,o,i),a=6),h&&(c.push(a,h,0,i),a=6)),o=""},u=0;u<n.length;u++){u&&(a===1&&l(),l(u));for(var d=0;d<n[u].length;d++)r=n[u][d],a===1?r==="<"?(l(),c=[c],a=3):o+=r:a===4?o==="--"&&r===">"?(a=1,o=""):o=r+o[0]:s?r===s?s="":o+=r:r==='"'||r==="'"?s=r:r===">"?(l(),a=1):a&&(r==="="?(a=5,i=o,o=""):r==="/"&&(a<5||n[u][d+1]===">")?(l(),a===3&&(c=c[0]),a=c,(c=c[0]).push(2,0,a),a=0):r===" "||r==="	"||r===`
`||r==="\r"?(l(),a=2):o+=r),a===3&&o==="!--"&&(a=4,c=c[0])}return l(),c}(t)),e),arguments,[])).length>1?e:e[0]}var Be=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},Qe={searchParams:"URLSearchParams"in Be,iterable:"Symbol"in Be&&"iterator"in Symbol,blob:"FileReader"in Be&&"Blob"in Be&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Be,arrayBuffer:"ArrayBuffer"in Be};function Tw(t){return t&&DataView.prototype.isPrototypeOf(t)}if(Qe.arrayBuffer)var xw=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Ew=ArrayBuffer.isView||function(t){return t&&xw.indexOf(Object.prototype.toString.call(t))>-1};function Oi(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function Yd(t){return typeof t!="string"&&(t=String(t)),t}function Xd(t){var e={next:function(){var n=t.shift();return{done:n===void 0,value:n}}};return Qe.iterable&&(e[Symbol.iterator]=function(){return e}),e}function Me(t){this.map={},t instanceof Me?t.forEach(function(e,n){this.append(n,e)},this):Array.isArray(t)?t.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}Me.prototype.append=function(t,e){t=Oi(t),e=Yd(e);var n=this.map[t];this.map[t]=n?n+", "+e:e};Me.prototype.delete=function(t){delete this.map[Oi(t)]};Me.prototype.get=function(t){return t=Oi(t),this.has(t)?this.map[t]:null};Me.prototype.has=function(t){return this.map.hasOwnProperty(Oi(t))};Me.prototype.set=function(t,e){this.map[Oi(t)]=Yd(e)};Me.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)};Me.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),Xd(t)};Me.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),Xd(t)};Me.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),Xd(t)};Qe.iterable&&(Me.prototype[Symbol.iterator]=Me.prototype.entries);function Zc(t){if(!t._noBody){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}}function Yv(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function Pw(t){var e=new FileReader,n=Yv(e);return e.readAsArrayBuffer(t),n}function Rw(t){var e=new FileReader,n=Yv(e),r=/charset=([A-Za-z0-9_-]+)/.exec(t.type),i=r?r[1]:"utf-8";return e.readAsText(t,i),n}function Iw(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function qp(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function Xv(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:Qe.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:Qe.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:Qe.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():Qe.arrayBuffer&&Qe.blob&&Tw(t)?(this._bodyArrayBuffer=qp(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Qe.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||Ew(t))?this._bodyArrayBuffer=qp(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Qe.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Qe.blob&&(this.blob=function(){var t=Zc(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=Zc(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(Qe.blob)return this.blob().then(Pw);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var t=Zc(this);if(t)return t;if(this._bodyBlob)return Rw(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Iw(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Qe.formData&&(this.formData=function(){return this.text().then(Nw)}),this.json=function(){return this.text().then(JSON.parse)},this}var _w=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Ow(t){var e=t.toUpperCase();return _w.indexOf(e)>-1?e:t}function Pr(t,e){if(!(this instanceof Pr))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var n=e.body;if(t instanceof Pr){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new Me(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!n&&t._bodyInit!=null&&(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new Me(e.headers)),this.method=Ow(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in Be){var a=new AbortController;return a.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var i=/\?/;this.url+=(i.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}Pr.prototype.clone=function(){return new Pr(this,{body:this._bodyInit})};function Nw(t){var e=new FormData;return t.trim().split("&").forEach(function(n){if(n){var r=n.split("="),i=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(a))}}),e}function Lw(t){var e=new Me,n=t.replace(/\r?\n[\t ]+/g," ");return n.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var i=r.split(":"),a=i.shift().trim();if(a){var o=i.join(":").trim();try{e.append(a,o)}catch(s){console.warn("Response "+s.message)}}}),e}Xv.call(Pr.prototype);function rn(t,e){if(!(this instanceof rn))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new Me(e.headers),this.url=e.url||"",this._initBody(t)}Xv.call(rn.prototype);rn.prototype.clone=function(){return new rn(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Me(this.headers),url:this.url})};rn.error=function(){var t=new rn(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var Mw=[301,302,303,307,308];rn.redirect=function(t,e){if(Mw.indexOf(e)===-1)throw new RangeError("Invalid status code");return new rn(null,{status:e,headers:{location:t}})};var hr=Be.DOMException;try{new hr}catch{hr=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},hr.prototype=Object.create(Error.prototype),hr.prototype.constructor=hr}function e0(t,e){return new Promise(function(n,r){var i=new Pr(t,e);if(i.signal&&i.signal.aborted)return r(new hr("Aborted","AbortError"));var a=new XMLHttpRequest;function o(){a.abort()}a.onload=function(){var l={statusText:a.statusText,headers:Lw(a.getAllResponseHeaders()||"")};i.url.indexOf("file://")===0&&(a.status<200||a.status>599)?l.status=200:l.status=a.status,l.url="responseURL"in a?a.responseURL:l.headers.get("X-Request-URL");var u="response"in a?a.response:a.responseText;setTimeout(function(){n(new rn(u,l))},0)},a.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},a.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},a.onabort=function(){setTimeout(function(){r(new hr("Aborted","AbortError"))},0)};function s(l){try{return l===""&&Be.location.href?Be.location.href:l}catch{return l}}if(a.open(i.method,s(i.url),!0),i.credentials==="include"?a.withCredentials=!0:i.credentials==="omit"&&(a.withCredentials=!1),"responseType"in a&&(Qe.blob?a.responseType="blob":Qe.arrayBuffer&&(a.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof Me||Be.Headers&&e.headers instanceof Be.Headers)){var c=[];Object.getOwnPropertyNames(e.headers).forEach(function(l){c.push(Oi(l)),a.setRequestHeader(l,Yd(e.headers[l]))}),i.headers.forEach(function(l,u){c.indexOf(u)===-1&&a.setRequestHeader(u,l)})}else i.headers.forEach(function(l,u){a.setRequestHeader(u,l)});i.signal&&(i.signal.addEventListener("abort",o),a.onreadystatechange=function(){a.readyState===4&&i.signal.removeEventListener("abort",o)}),a.send(typeof i._bodyInit>"u"?null:i._bodyInit)})}e0.polyfill=!0;Be.fetch||(Be.fetch=e0,Be.Headers=Me,Be.Request=Pr,Be.Response=rn);var Dw=self.fetch.bind(self);const yo=jm(Dw);function ye(t){return t!=null&&typeof t=="object"&&t["@@functional/placeholder"]===!0}function gr(t){return function e(n){return arguments.length===0||ye(n)?e:t.apply(this,arguments)}}function Ar(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return ye(n)?e:gr(function(i){return t(n,i)});default:return ye(n)&&ye(r)?e:ye(n)?gr(function(i){return t(i,r)}):ye(r)?gr(function(i){return t(n,i)}):t(n,r)}}}function jw(t,e){t=t||[],e=e||[];var n,r=t.length,i=e.length,a=[];for(n=0;n<r;)a[a.length]=t[n],n+=1;for(n=0;n<i;)a[a.length]=e[n],n+=1;return a}function Aw(t){return function e(n,r,i){switch(arguments.length){case 0:return e;case 1:return ye(n)?e:Ar(function(a,o){return t(n,a,o)});case 2:return ye(n)&&ye(r)?e:ye(n)?Ar(function(a,o){return t(a,r,o)}):ye(r)?Ar(function(a,o){return t(n,a,o)}):gr(function(a){return t(n,r,a)});default:return ye(n)&&ye(r)&&ye(i)?e:ye(n)&&ye(r)?Ar(function(a,o){return t(a,o,i)}):ye(n)&&ye(i)?Ar(function(a,o){return t(a,r,o)}):ye(r)&&ye(i)?Ar(function(a,o){return t(n,a,o)}):ye(n)?gr(function(a){return t(a,r,i)}):ye(r)?gr(function(a){return t(n,a,i)}):ye(i)?gr(function(a){return t(n,r,a)}):t(n,r,i)}}}var $p=Aw(function(t,e,n){var r=n.length;if(t>=r||t<-r)return n;var i=(r+t)%r,a=jw(n);return a[i]=e(n[i]),a});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var lu=function(t,e){return lu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},lu(t,e)};function t0(t,e){lu(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Uw(t){var e=typeof Symbol=="function"&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function Fw(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function Bw(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Fw(arguments[e]));return t}var n0=function(){function t(e,n){this.target=n,this.type=e}return t}(),zw=function(t){t0(e,t);function e(n,r){var i=t.call(this,"error",r)||this;return i.message=n.message,i.error=n,i}return e}(n0),Vw=function(t){t0(e,t);function e(n,r,i){n===void 0&&(n=1e3),r===void 0&&(r="");var a=t.call(this,"close",i)||this;return a.wasClean=!0,a.code=n,a.reason=r,a}return e}(n0);/*!
 * Reconnecting WebSocket
 * by Pedro Ladaria <pedro.ladaria@gmail.com>
 * https://github.com/pladaria/reconnecting-websocket
 * License MIT
 */var Hw=function(){if(typeof WebSocket<"u")return WebSocket},qw=function(t){return typeof t<"u"&&!!t&&t.CLOSING===2},or={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+Math.random()*4e3,minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},Qc=function(){function t(e,n,r){var i=this;r===void 0&&(r={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(a){i._debug("open event");var o=i._options.minUptime,s=o===void 0?or.minUptime:o;clearTimeout(i._connectTimeout),i._uptimeTimeout=setTimeout(function(){return i._acceptOpen()},s),i._ws.binaryType=i._binaryType,i._messageQueue.forEach(function(c){return i._ws.send(c)}),i._messageQueue=[],i.onopen&&i.onopen(a),i._listeners.open.forEach(function(c){return i._callEventListener(a,c)})},this._handleMessage=function(a){i._debug("message event"),i.onmessage&&i.onmessage(a),i._listeners.message.forEach(function(o){return i._callEventListener(a,o)})},this._handleError=function(a){i._debug("error event",a.message),i._disconnect(void 0,a.message==="TIMEOUT"?"timeout":void 0),i.onerror&&i.onerror(a),i._debug("exec error listeners"),i._listeners.error.forEach(function(o){return i._callEventListener(a,o)}),i._connect()},this._handleClose=function(a){i._debug("close event"),i._clearTimeouts(),i._shouldReconnect&&i._connect(),i.onclose&&i.onclose(a),i._listeners.close.forEach(function(o){return i._callEventListener(a,o)})},this._url=e,this._protocols=n,this._options=r,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(t,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CONNECTING",{get:function(){return t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OPEN",{get:function(){return t.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSING",{get:function(){return t.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSED",{get:function(){return t.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferedAmount",{get:function(){var e=this._messageQueue.reduce(function(n,r){return typeof r=="string"?n+=r.length:r instanceof Blob?n+=r.size:n+=r.byteLength,n},0);return e+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?t.CLOSED:t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),t.prototype.close=function(e,n){if(e===void 0&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(e,n)},t.prototype.reconnect=function(e,n){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,!this._ws||this._ws.readyState===this.CLOSED?this._connect():(this._disconnect(e,n),this._connect())},t.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var n=this._options.maxEnqueuedMessages,r=n===void 0?or.maxEnqueuedMessages:n;this._messageQueue.length<r&&(this._debug("enqueue",e),this._messageQueue.push(e))}},t.prototype.addEventListener=function(e,n){this._listeners[e]&&this._listeners[e].push(n)},t.prototype.dispatchEvent=function(e){var n,r,i=this._listeners[e.type];if(i)try{for(var a=Uw(i),o=a.next();!o.done;o=a.next()){var s=o.value;this._callEventListener(e,s)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!0},t.prototype.removeEventListener=function(e,n){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(r){return r!==n}))},t.prototype._debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._options.debug&&console.log.apply(console,Bw(["RWS>"],e))},t.prototype._getNextDelay=function(){var e=this._options,n=e.reconnectionDelayGrowFactor,r=n===void 0?or.reconnectionDelayGrowFactor:n,i=e.minReconnectionDelay,a=i===void 0?or.minReconnectionDelay:i,o=e.maxReconnectionDelay,s=o===void 0?or.maxReconnectionDelay:o,c=0;return this._retryCount>0&&(c=a*Math.pow(r,this._retryCount-1),c>s&&(c=s)),this._debug("next delay",c),c},t.prototype._wait=function(){var e=this;return new Promise(function(n){setTimeout(n,e._getNextDelay())})},t.prototype._getNextUrl=function(e){if(typeof e=="string")return Promise.resolve(e);if(typeof e=="function"){var n=e();if(typeof n=="string")return Promise.resolve(n);if(n.then)return n}throw Error("Invalid URL")},t.prototype._connect=function(){var e=this;if(!(this._connectLock||!this._shouldReconnect)){this._connectLock=!0;var n=this._options,r=n.maxRetries,i=r===void 0?or.maxRetries:r,a=n.connectionTimeout,o=a===void 0?or.connectionTimeout:a,s=n.WebSocket,c=s===void 0?Hw():s;if(this._retryCount>=i){this._debug("max retries reached",this._retryCount,">=",i);return}if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!qw(c))throw Error("No valid WebSocket class provided");this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(l){e._closeCalled||(e._debug("connect",{url:l,protocols:e._protocols}),e._ws=e._protocols?new c(l,e._protocols):new c(l),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},o))})}},t.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new zw(Error("TIMEOUT"),this))},t.prototype._disconnect=function(e,n){if(e===void 0&&(e=1e3),this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(e,n),this._handleClose(new Vw(e,n,this))}catch{}}},t.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},t.prototype._callEventListener=function(e,n){"handleEvent"in n?n.handleEvent(e):n(e)},t.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},t.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},t.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},t}();let ko;const $w=new Uint8Array(16);function Ww(){if(!ko&&(ko=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ko))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ko($w)}const Ue=[];for(let t=0;t<256;++t)Ue.push((t+256).toString(16).slice(1));function Kw(t,e=0){return Ue[t[e+0]]+Ue[t[e+1]]+Ue[t[e+2]]+Ue[t[e+3]]+"-"+Ue[t[e+4]]+Ue[t[e+5]]+"-"+Ue[t[e+6]]+Ue[t[e+7]]+"-"+Ue[t[e+8]]+Ue[t[e+9]]+"-"+Ue[t[e+10]]+Ue[t[e+11]]+Ue[t[e+12]]+Ue[t[e+13]]+Ue[t[e+14]]+Ue[t[e+15]]}const Gw=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Wp={randomUUID:Gw};function Kp(t,e,n){if(Wp.randomUUID&&!t)return Wp.randomUUID();t=t||{};const r=t.random||(t.rng||Ww)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Kw(r)}var Zw="@nlxai/chat-core",Qw="1.0.5-alpha.12",Jw="NLX Chat SDK core",Yw="module",Xw="lib/index.cjs",eC="lib/index.esm.js",tC="lib/index.umd.js",nC="lib/index.d.ts",rC={".":{types:"./lib/index.d.ts",import:"./lib/index.esm.js",require:"./lib/index.cjs"}},iC={build:"rm -rf lib && rollup -c --configPlugin typescript --configImportAttributesKey with",docs:"rm -rf docs/ && typedoc && concat-md --decrease-title-levels --dir-name-as-title docs/ > docs/index.md","lint:check":"eslint src/ --ext .ts,.tsx,.js,.jsx --max-warnings 0",lint:"eslint src/ --ext .ts,.tsx,.js,.jsx --fix",prepublish:"npm run build","preview-docs":"npm run docs && comrak --unsafe --gfm -o docs/index.html docs/index.md && open docs/index.html","publish-docs":"npm run docs && mv docs/index.md ../website/src/content/headless-api-reference.md",test:"typedoc --emit none",tsc:"tsc"},aC="Peter Szerzo <peter@nlx.ai>",oC="MIT",sC={"@types/isomorphic-fetch":"^0.0.36","@types/node":"^22.10.1","@types/ramda":"0.29.1","@types/uuid":"^9.0.7","concat-md":"^0.5.1","eslint-config-nlx":"*",prettier:"^3.1.0","rollup-config-nlx":"*",typedoc:"^0.25.13","typedoc-plugin-markdown":"^3.17.1",typescript:"^5.5.4"},cC={"isomorphic-fetch":"^3.0.0",ramda:"^0.29.1","reconnecting-websocket":"^4.4.0",uuid:"^9.0.1"},lC={access:"public"},uC="c701b502f0398e9956a8b35b711a45f264fa7603",wo={name:Zw,version:Qw,description:Jw,type:Yw,main:Xw,module:eC,browser:tC,types:nC,exports:rC,scripts:iC,author:aC,license:oC,devDependencies:sC,dependencies:cC,publishConfig:lC,gitHead:uC};const sr=console,Gp="NLX.Welcome",dC="We encountered an issue. Please try again soon.",r0=t=>Array.isArray(t)?t:Object.entries(t).map(([e,n])=>({slotId:e,value:n})),Zp=t=>({...t,intentId:t.flowId??t.intentId,slots:t.slots!=null?r0(t.slots):t.slots}),Qp=t=>t.responses,Jc=t=>{try{return JSON.parse(t)}catch{return null}},i0=t=>{var e;return((e=t.match(/(bots\.dev\.studio\.nlx\.ai|bots\.studio\.nlx\.ai|apps\.nlx\.ai|dev\.apps\.nlx\.ai)/g))==null?void 0:e[0])??"apps.nlx.ai"},hC=t=>{if(_n(t))return t;const e=i0(t),n=new URL(t).pathname.split("/"),r=n[2],i=n[3];return`wss://us-east-1-ws.${e}?deploymentKey=${r}&channelKey=${i}`},Jp=t=>{if(!_n(t))return t;const e=i0(t),n=new URL(t),r=new URLSearchParams(n.search),i=r.get("channelKey"),a=r.get("deploymentKey");return`https://${e}/c/${a}/${i}`},_n=t=>t.indexOf("wss://")===0,pC=t=>(t.applicationUrl??t.botUrl??"").length>0;function fC(t){let e,n=[],r=null,i,a=[],o=null;const s=t.applicationUrl??t.botUrl??"";/[-|_][a-z]{2,}[-|_][A-Z]{2,}$/.test(s)&&sr.warn("Since v1.0.0, the language code is no longer added at the end of the application URL. Please remove the modifier (e.g. '-en-US') from the URL, and specify it in the `languageCode` parameter instead.");const c={voicePlusCommand:[]},l=t.conversationId??Kp();let u={responses:t.responses??[],languageCode:t.languageCode,userId:t.userId,conversationId:l};const d=()=>{var R;return`${Jp(s)}${((R=t.experimental)==null?void 0:R.completeBotUrl)===!0?"":`-${u.languageCode}`}`},h=(R,z)=>{u={...u,...R},b.forEach(H=>{H(Qp(u),z)})},f=()=>{const R={type:"failure",receivedAt:new Date().getTime(),payload:{text:t.failureMessage??dC}};h({responses:[...u.responses,R]},R)},v=R=>{if((R==null?void 0:R.messages.length)>0){const z={type:"bot",receivedAt:new Date().getTime(),payload:{...R,messages:R.messages.map(H=>({nodeId:H.nodeId,messageId:H.messageId,text:H.text,choices:H.choices??[]}))}};h({responses:[...u.responses,z]},z),R.metadata.hasPendingDataRequest&&(O({poll:!0}),setTimeout(()=>{g({request:{structured:{poll:!0}}})},1500))}else sr.warn("Invalid message structure, expected object with field 'messages'."),f()};let k;const S=R=>{(i==null?void 0:i.readyState)===1?i.send(JSON.stringify(R)):a=[...a,R]},g=async R=>{var z;if(k!=null){k(R,Q=>{const D={type:"bot",receivedAt:new Date().getTime(),payload:Q};h({responses:[...u.responses,D]},D)});return}const H={userId:u.userId,conversationId:u.conversationId,...R,languageCode:u.languageCode,channelType:(z=t.experimental)==null?void 0:z.channelType,environment:t.environment};if(_n(s))(e==null?void 0:e.readyState)===1?e.send(JSON.stringify(H)):n=[...n,H];else try{const Q=await yo(d(),{method:"POST",headers:{...t.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-sdk-version":wo.version},body:JSON.stringify(H)});if(Q.status>=400)throw new Error(`Responded with ${Q.status}`);const D=await Q.json();v(D)}catch(Q){sr.warn(Q),f()}};let b=[];const p=async()=>{(e==null?void 0:e.readyState)===1&&n[0]!=null&&(await g(n[0]),n=n.slice(1))},m=()=>{(i==null?void 0:i.readyState)===1&&a[0]!=null&&(S(a[0]),a=a.slice(1))},w=()=>{var R;x();const z=new URL(s);((R=t.experimental)==null?void 0:R.completeBotUrl)!==!0&&(z.searchParams.set("languageCode",u.languageCode),z.searchParams.set("channelKey",`${z.searchParams.get("channelKey")??""}-${u.languageCode}`)),z.searchParams.set("conversationId",u.conversationId),e=new Qc(z.href),r=setInterval(()=>{p()},500),e.onmessage=function(H){typeof(H==null?void 0:H.data)=="string"&&v(Jc(H.data))},z.searchParams.set("voice-plus","true"),i=new Qc(z.href),o=setInterval(()=>{m()},500),i.onmessage=H=>{if(typeof(H==null?void 0:H.data)=="string"){const Q=Jc(H.data);Q!=null&&c.voicePlusCommand.forEach(D=>{D(Q)})}}},T=()=>{var R;if(E(),t.bidirectional!==!0)return;const z=new URL(hC(s));((R=t.experimental)==null?void 0:R.completeBotUrl)!==!0&&(z.searchParams.set("languageCode",u.languageCode),z.searchParams.set("channelKey",`${z.searchParams.get("channelKey")??""}-${u.languageCode}`)),z.searchParams.set("conversationId",u.conversationId),z.searchParams.set("type","voice-plus");const H=t.headers["nlx-api-key"];!_n(s)&&H!=null&&z.searchParams.set("apiKey",H),i=new Qc(z.href),o=setInterval(()=>{m()},500),i.onmessage=Q=>{if(typeof(Q==null?void 0:Q.data)=="string"){const D=Jc(Q.data);D!=null&&c.voicePlusCommand.forEach($=>{$(D)})}}},x=()=>{r!=null&&clearInterval(r),e!=null&&(e.onmessage=null,e.close(),e=void 0)},E=()=>{o!=null&&clearInterval(o),i!=null&&(i.onmessage=null,i.close(),i=void 0)};_n(s)&&w(),T();const O=(R,z)=>{const H={type:"user",receivedAt:new Date().getTime(),payload:{type:"structured",...Zp(R),context:z}};h({responses:[...u.responses,H]},H)},N=(R,z)=>{O({intentId:R},z),g({context:z,request:{structured:{intentId:R}}})},U=(R,z)=>{const H={type:"user",receivedAt:new Date().getTime(),payload:{type:"text",text:R,context:z}};h({responses:[...u.responses,H]},H),g({context:z,request:{unstructured:{text:R}}})},W=(R,z,H)=>{let Q=[...u.responses];const D={type:"user",receivedAt:new Date().getTime(),payload:{type:"choice",choiceId:R}},$=(H==null?void 0:H.responseIndex)??-1,K=(H==null?void 0:H.messageIndex)??-1;$>-1&&K>-1&&(Q=$p($,Z=>Z.type==="bot"?{...Z,payload:{...Z.payload,messages:$p(K,he=>({...he,selectedChoiceId:R}),Z.payload.messages)}}:Z,Q)),Q=[...Q,D],h({responses:Q},D),g({context:z,request:{structured:{nodeId:H==null?void 0:H.nodeId,intentId:H==null?void 0:H.intentId,choiceId:R}}})},q=R=>{b=b.filter(z=>z!==R)};return{sendText:U,sendContext:async R=>{const z=await yo(`${d()}/context`,{method:"POST",headers:{...t.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":u.conversationId,"nlx-sdk-version":wo.version},body:JSON.stringify({languageCode:u.languageCode,conversationId:u.conversationId,userId:u.userId,context:R})});if(z.status>=400)throw new Error(`Responded with ${z.status}`)},sendStructured:(R,z)=>{O(R,z),g({context:z,request:{structured:Zp(R)}})},sendSlots:(R,z)=>{O({slots:R},z),g({context:z,request:{structured:{slots:r0(R)}}})},sendFlow:N,sendIntent:(R,z)=>{sr.warn("Calling `sendIntent` is deprecated and will be removed in a future version of the SDK. Use `sendFlow` instead."),N(R,z)},sendWelcomeFlow:R=>{N(Gp,R)},sendWelcomeIntent:R=>{sr.warn("Calling `sendWelcomeIntent` is deprecated and will be removed in a future version of the SDK. Use `sendWelcomeFlow` instead."),N(Gp,R)},sendChoice:W,currentConversationId:()=>u.conversationId,setLanguageCode:R=>{if(R===u.languageCode){sr.warn("Attempted to set language code to the one already active.");return}_n(s)&&w(),T(),h({languageCode:R})},currentLanguageCode:()=>u.languageCode,getVoiceCredentials:async R=>{const z=Jp(s),H=await yo(`${z}-${u.languageCode}/requestToken`,{method:"POST",headers:{...t.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":u.conversationId,"nlx-sdk-version":wo.version},body:JSON.stringify({languageCode:u.languageCode,conversationId:u.conversationId,userId:u.userId,requestToken:!0,context:R})});if(H.status>=400)throw new Error(`Responded with ${H.status}`);const Q=await H.json();if((Q==null?void 0:Q.url)==null)throw new Error("Invalid response");return Q},terminateVoiceCall:async()=>{const R=await yo(`${d()}/terminateVoice`,{method:"POST",headers:{...t.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":u.conversationId,"nlx-sdk-version":wo.version},body:JSON.stringify({languageCode:u.languageCode,conversationId:u.conversationId,userId:u.userId})});if(R.status>=400)throw new Error(`Responded with ${R.status}`)},subscribe:R=>(b=[...b,R],R(Qp(u)),()=>{q(R)}),unsubscribe:q,unsubscribeAll:()=>{b=[]},reset:R=>{h({conversationId:Kp(),responses:(R==null?void 0:R.clearResponses)===!0?[]:u.responses}),_n(s)&&w(),T()},destroy:()=>{b=[],_n(s)&&x(),E()},setBotRequestOverride:R=>{sr.warn("Calling `setBotRequestOverride` is deprecated and will be removed in a future version of the SDK. Use `setRequestOverride` instead."),k=R},setRequestOverride:R=>{k=R},addEventListener:(R,z)=>{c[R]=[...c[R],z]},removeEventListener:(R,z)=>{c[R]=c[R].filter(H=>H!==z)},sendVoicePlusContext:R=>{S({context:R})}}}function a0(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=a0(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Y(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=a0(t))&&(r&&(r+=" "),r+=e);return r}function Vr(t){return t!=null&&typeof t=="object"&&t["@@functional/placeholder"]===!0}function fa(t){return function e(n){return arguments.length===0||Vr(n)?e:t.apply(this,arguments)}}function o0(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return Vr(n)?e:fa(function(i){return t(n,i)});default:return Vr(n)&&Vr(r)?e:Vr(n)?fa(function(i){return t(i,r)}):Vr(r)?fa(function(i){return t(n,i)}):t(n,r)}}}const mC=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};function gC(t){return t!=null&&typeof t["@@transducer/step"]=="function"}function vC(t,e,n){return function(){if(arguments.length===0)return n();var r=arguments[arguments.length-1];if(!mC(r)){for(var i=0;i<t.length;){if(typeof r[t[i]]=="function")return r[t[i]].apply(r,Array.prototype.slice.call(arguments,0,-1));i+=1}if(gC(r)){var a=e.apply(null,Array.prototype.slice.call(arguments,0,-1));return a(r)}}return n.apply(this,arguments)}}const bC={init:function(){return this.xf["@@transducer/init"]()}};function Yp(t){for(var e=[],n;!(n=t.next()).done;)e.push(n.value);return e}function Xp(t,e,n){for(var r=0,i=n.length;r<i;){if(t(e,n[r]))return!0;r+=1}return!1}function yC(t){var e=String(t).match(/^function (\w*)/);return e==null?"":e[1]}function Os(t,e){return Object.prototype.hasOwnProperty.call(e,t)}function kC(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}const Yc=typeof Object.is=="function"?Object.is:kC;var ef=Object.prototype.toString,wC=function(){return ef.call(arguments)==="[object Arguments]"?function(t){return ef.call(t)==="[object Arguments]"}:function(t){return Os("callee",t)}}(),CC=!{toString:null}.propertyIsEnumerable("toString"),tf=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],nf=function(){return arguments.propertyIsEnumerable("length")}(),SC=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},rf=fa(typeof Object.keys=="function"&&!nf?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(t){if(Object(t)!==t)return[];var e,n,r=[],i=nf&&wC(t);for(e in t)Os(e,t)&&(!i||e!=="length")&&(r[r.length]=e);if(CC)for(n=tf.length-1;n>=0;)e=tf[n],Os(e,t)&&!SC(r,e)&&(r[r.length]=e),n-=1;return r}),af=fa(function(t){return t===null?"Null":t===void 0?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function of(t,e,n,r){var i=Yp(t),a=Yp(e);function o(s,c){return eh(s,c,n.slice(),r.slice())}return!Xp(function(s,c){return!Xp(o,c,s)},a,i)}function eh(t,e,n,r){if(Yc(t,e))return!0;var i=af(t);if(i!==af(e))return!1;if(typeof t["fantasy-land/equals"]=="function"||typeof e["fantasy-land/equals"]=="function")return typeof t["fantasy-land/equals"]=="function"&&t["fantasy-land/equals"](e)&&typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](t);if(typeof t.equals=="function"||typeof e.equals=="function")return typeof t.equals=="function"&&t.equals(e)&&typeof e.equals=="function"&&e.equals(t);switch(i){case"Arguments":case"Array":case"Object":if(typeof t.constructor=="function"&&yC(t.constructor)==="Promise")return t===e;break;case"Boolean":case"Number":case"String":if(!(typeof t==typeof e&&Yc(t.valueOf(),e.valueOf())))return!1;break;case"Date":if(!Yc(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(!(t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode))return!1;break}for(var a=n.length-1;a>=0;){if(n[a]===t)return r[a]===e;a-=1}switch(i){case"Map":return t.size!==e.size?!1:of(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size!==e.size?!1:of(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var o=rf(t);if(o.length!==rf(e).length)return!1;var s=n.concat([t]),c=r.concat([e]);for(a=o.length-1;a>=0;){var l=o[a];if(!(Os(l,e)&&eh(e[l],t[l],s,c)))return!1;a-=1}return!0}var TC=o0(function(t,e){return eh(t,e,[],[])}),xC=function(){function t(e,n){this.xf=n,this.f=e,this.idx=-1,this.lastIdx=-1}return t.prototype["@@transducer/init"]=bC.init,t.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](e,this.lastIdx))},t.prototype["@@transducer/step"]=function(e,n){return this.idx+=1,this.f(n)&&(this.lastIdx=this.idx),e},t}();function EC(t){return function(e){return new xC(t,e)}}var sf=o0(vC([],EC,function(t,e){for(var n=e.length-1;n>=0;){if(t(e[n]))return n;n-=1}return-1}));const G=t=>({width:t.size!=null?`${t.size}px`:"100%",height:t.size!=null?`${t.size}px`:"100%",className:t.className}),PC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M11 21H10L11 14H7.5C6.92 14 6.93 13.68 7.12 13.34C7.31 13 7.17 13.26 7.19 13.22C8.48 10.94 10.42 7.54 13 3H14L13 10H16.5C16.99 10 17.06 10.33 16.97 10.51L16.9 10.66C12.96 17.55 11 21 11 21Z",fill:"currentColor"})}),za=t=>y.jsxs("svg",{viewBox:"0 0 24 24",...G(t),children:[y.jsx("path",{d:"M13.5562 5.34835C12.2796 6.62498 12.4866 8.90179 14.0186 10.4337C14.3377 10.7529 14.5571 11.134 14.6767 11.5383C14.8007 11.9572 14.8177 12.4011 14.7277 12.8268C14.6656 13.1203 14.5526 13.4051 14.3887 13.6672C14.3259 13.7677 14.2557 13.865 14.1778 13.9581C14.1279 14.018 14.0747 14.0761 14.0186 14.1322C13.3341 14.8166 12.3641 15.0421 11.4917 14.8092L11.4728 14.8042C9.38654 14.2543 7.32235 15.2129 6.85652 16.9516C6.5761 17.9979 5.50065 18.6188 4.45431 18.3385C3.40798 18.0581 2.787 16.9826 3.06729 15.9363C3.34209 14.9111 4.38012 14.2942 5.40615 14.5335L5.40666 14.5317C5.42748 14.5378 5.44842 14.5437 5.46962 14.5493C7.21342 15.0166 9.08173 13.699 9.64244 11.6062C9.64857 11.5835 9.65521 11.5608 9.66185 11.5383C9.7815 11.134 10.0009 10.7529 10.32 10.4337L10.332 10.4214C10.339 10.4142 10.346 10.407 10.3533 10.4C11.8549 8.86865 12.0496 6.61566 10.7824 5.34835C10.0163 4.58237 10.0163 3.34047 10.7824 2.57449C11.5483 1.8085 12.7903 1.8085 13.5562 2.57449C14.3066 3.32501 14.3218 4.53237 13.6016 5.30135L13.6029 5.30263C13.5872 5.3177 13.5716 5.33289 13.5562 5.34835Z",fill:"currentColor"}),y.jsx("path",{d:"M19.327 6.83185C20.0311 6.83185 20.6019 7.40264 20.6019 8.10675C20.6019 8.81087 20.0311 9.38166 19.327 9.38166C18.6229 9.38166 18.0521 8.81087 18.0521 8.10675C18.0521 7.40264 18.6229 6.83185 19.327 6.83185Z",fill:"currentColor"}),y.jsx("path",{d:"M21.3237 16.4754C21.3237 15.3741 20.4309 14.4813 19.3297 14.4813C18.2284 14.4813 17.3356 15.3741 17.3356 16.4754C17.3356 17.5767 18.2284 18.4695 19.3297 18.4695C20.4309 18.4695 21.3237 17.5767 21.3237 16.4754Z",fill:"currentColor"}),y.jsx("path",{d:"M12.1025 19.3194C12.8246 19.3194 13.4101 19.9195 13.4101 20.6597C13.4101 21.4 12.8246 22 12.1025 22C11.3804 22 10.7949 21.4 10.7949 20.6597C10.7949 19.9195 11.3804 19.3194 12.1025 19.3194Z",fill:"currentColor"}),y.jsx("path",{d:"M6.28367 8.13944C6.28367 7.41726 5.68363 6.83185 4.94339 6.83185C4.20314 6.83185 3.6031 7.41726 3.6031 8.13944C3.6031 8.86163 4.20314 9.44704 4.94339 9.44704C5.68363 9.44704 6.28367 8.86163 6.28367 8.13944Z",fill:"currentColor"})]}),RC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M6 13C5.45 13 5 13.45 5 14C5 14.55 5.45 15 6 15C6.55 15 7 14.55 7 14C7 13.45 6.55 13 6 13ZM6 17C5.45 17 5 17.45 5 18C5 18.55 5.45 19 6 19C6.55 19 7 18.55 7 18C7 17.45 6.55 17 6 17ZM6 9C5.45 9 5 9.45 5 10C5 10.55 5.45 11 6 11C6.55 11 7 10.55 7 10C7 9.45 6.55 9 6 9ZM3 9.5C2.72 9.5 2.5 9.72 2.5 10C2.5 10.28 2.72 10.5 3 10.5C3.28 10.5 3.5 10.28 3.5 10C3.5 9.72 3.28 9.5 3 9.5ZM6 5C5.45 5 5 5.45 5 6C5 6.55 5.45 7 6 7C6.55 7 7 6.55 7 6C7 5.45 6.55 5 6 5ZM21 10.5C21.28 10.5 21.5 10.28 21.5 10C21.5 9.72 21.28 9.5 21 9.5C20.72 9.5 20.5 9.72 20.5 10C20.5 10.28 20.72 10.5 21 10.5ZM14 7C14.55 7 15 6.55 15 6C15 5.45 14.55 5 14 5C13.45 5 13 5.45 13 6C13 6.55 13.45 7 14 7ZM14 3.5C14.28 3.5 14.5 3.28 14.5 3C14.5 2.72 14.28 2.5 14 2.5C13.72 2.5 13.5 2.72 13.5 3C13.5 3.28 13.72 3.5 14 3.5ZM3 13.5C2.72 13.5 2.5 13.72 2.5 14C2.5 14.28 2.72 14.5 3 14.5C3.28 14.5 3.5 14.28 3.5 14C3.5 13.72 3.28 13.5 3 13.5ZM10 20.5C9.72 20.5 9.5 20.72 9.5 21C9.5 21.28 9.72 21.5 10 21.5C10.28 21.5 10.5 21.28 10.5 21C10.5 20.72 10.28 20.5 10 20.5ZM10 3.5C10.28 3.5 10.5 3.28 10.5 3C10.5 2.72 10.28 2.5 10 2.5C9.72 2.5 9.5 2.72 9.5 3C9.5 3.28 9.72 3.5 10 3.5ZM10 7C10.55 7 11 6.55 11 6C11 5.45 10.55 5 10 5C9.45 5 9 5.45 9 6C9 6.55 9.45 7 10 7ZM10 12.5C9.17 12.5 8.5 13.17 8.5 14C8.5 14.83 9.17 15.5 10 15.5C10.83 15.5 11.5 14.83 11.5 14C11.5 13.17 10.83 12.5 10 12.5ZM18 13C17.45 13 17 13.45 17 14C17 14.55 17.45 15 18 15C18.55 15 19 14.55 19 14C19 13.45 18.55 13 18 13ZM18 17C17.45 17 17 17.45 17 18C17 18.55 17.45 19 18 19C18.55 19 19 18.55 19 18C19 17.45 18.55 17 18 17ZM18 9C17.45 9 17 9.45 17 10C17 10.55 17.45 11 18 11C18.55 11 19 10.55 19 10C19 9.45 18.55 9 18 9ZM18 5C17.45 5 17 5.45 17 6C17 6.55 17.45 7 18 7C18.55 7 19 6.55 19 6C19 5.45 18.55 5 18 5ZM21 13.5C20.72 13.5 20.5 13.72 20.5 14C20.5 14.28 20.72 14.5 21 14.5C21.28 14.5 21.5 14.28 21.5 14C21.5 13.72 21.28 13.5 21 13.5ZM14 17C13.45 17 13 17.45 13 18C13 18.55 13.45 19 14 19C14.55 19 15 18.55 15 18C15 17.45 14.55 17 14 17ZM14 20.5C13.72 20.5 13.5 20.72 13.5 21C13.5 21.28 13.72 21.5 14 21.5C14.28 21.5 14.5 21.28 14.5 21C14.5 20.72 14.28 20.5 14 20.5ZM10 8.5C9.17 8.5 8.5 9.17 8.5 10C8.5 10.83 9.17 11.5 10 11.5C10.83 11.5 11.5 10.83 11.5 10C11.5 9.17 10.83 8.5 10 8.5ZM10 17C9.45 17 9 17.45 9 18C9 18.55 9.45 19 10 19C10.55 19 11 18.55 11 18C11 17.45 10.55 17 10 17ZM14 12.5C13.17 12.5 12.5 13.17 12.5 14C12.5 14.83 13.17 15.5 14 15.5C14.83 15.5 15.5 14.83 15.5 14C15.5 13.17 14.83 12.5 14 12.5ZM14 8.5C13.17 8.5 12.5 9.17 12.5 10C12.5 10.83 13.17 11.5 14 11.5C14.83 11.5 15.5 10.83 15.5 10C15.5 9.17 14.83 8.5 14 8.5Z",fill:"currentColor"})}),IC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z",fill:"currentColor"})}),s0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12 15.41L6 9.40997L7.41 7.99997L12 12.58L16.59 7.99997L18 9.40997L12 15.41Z",fill:"currentColor"})}),_C=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M7.59001 12L13.59 18L15 16.59L10.42 12L15 7.41002L13.59 6.00002L7.59001 12Z",fill:"currentColor"})}),c0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M15 12L9.00005 18L7.59005 16.59L12.17 12L7.59005 7.41002L9.00005 6.00002L15 12Z",fill:"currentColor"})}),OC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12 8L6 14L7.41 15.41L12 10.83L16.59 15.41L18 14L12 8Z",fill:"currentColor"})}),Ni=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z",fill:"currentColor"})}),uu=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M18.5 16H7C4.79 16 3 14.21 3 12C3 9.79 4.79 8 7 8H19.5C20.88 8 22 9.12 22 10.5C22 11.88 20.88 13 19.5 13H9C8.45 13 8 12.55 8 12C8 11.45 8.45 11 9 11H18.5V9.5H9C7.62 9.5 6.5 10.62 6.5 12C6.5 13.38 7.62 14.5 9 14.5H19.5C21.71 14.5 23.5 12.71 23.5 10.5C23.5 8.29 21.71 6.5 19.5 6.5H7C3.96 6.5 1.5 8.96 1.5 12C1.5 15.04 3.96 17.5 7 17.5H18.5V16Z",fill:"currentColor"})}),NC=t=>y.jsxs("svg",{viewBox:"0 0 24 24",...G(t),children:[y.jsx("path",{d:"M12 15.2C13.7673 15.2 15.2 13.7673 15.2 12C15.2 10.2327 13.7673 8.8 12 8.8C10.2327 8.8 8.8 10.2327 8.8 12C8.8 13.7673 10.2327 15.2 12 15.2Z",fill:"currentColor"}),y.jsx("path",{d:"M9 2L7.17 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4H16.83L15 2H9ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z",fill:"currentColor"})]}),l0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M8.99991 16.17L4.82991 12L3.40991 13.41L8.99991 19L20.9999 7L19.5899 5.59L8.99991 16.17Z",fill:"currentColor"})}),th=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z",fill:"currentColor"})}),LC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z",fill:"currentColor"})}),u0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3.01 4.9 3.01 6L3 20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM19 20H5V9H19V20Z",fill:"currentColor"})}),d0=t=>y.jsxs("svg",{viewBox:"0 0 24 24",...G(t),children:[y.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 21C6.9 21 6 20.1 6 19V7H18V19C18 20.1 17.1 21 16 21H8ZM9.33337 9H8V19H9.33337V9ZM11.3334 9V19H12.6666V9H11.3334ZM16 19H14.6666V9H16V19Z",fill:"currentColor"}),y.jsx("path",{d:"M15.5 4H19V6H5V4H8.5L9.5 3H14.5L15.5 4Z",fill:"currentColor"})]}),h0=t=>y.jsxs("svg",{viewBox:"0 0 24 24",...G(t),children:[y.jsx("path",{d:"M21 12.22C21 6.73 16.74 3 12 3C7.31 3 3 6.65 3 12.28C2.4 12.62 2 13.26 2 14V16C2 17.1 2.9 18 4 18H5V11.9C5 8.03 8.13 4.9 12 4.9C15.87 4.9 19 8.03 19 11.9V19H11V21H19C20.1 21 21 20.1 21 19V17.78C21.59 17.47 22 16.86 22 16.14V13.84C22 13.14 21.59 12.53 21 12.22Z",fill:"currentColor"}),y.jsx("path",{d:"M9 14C9.55228 14 10 13.5523 10 13C10 12.4477 9.55228 12 9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14Z",fill:"currentColor"}),y.jsx("path",{d:"M15 14C15.5523 14 16 13.5523 16 13C16 12.4477 15.5523 12 15 12C14.4477 12 14 12.4477 14 13C14 13.5523 14.4477 14 15 14Z",fill:"currentColor"}),y.jsx("path",{d:"M18 11.03C17.52 8.18 15.04 6 12.05 6C9.02 6 5.76 8.51 6.02 12.45C8.49 11.44 10.35 9.24 10.88 6.56C12.19 9.19 14.88 11 18 11.03Z",fill:"currentColor"})]}),du=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z",fill:"currentColor"})}),MC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M7 14H5V19H10V17H7V14ZM5 10H7V7H10V5H5V10ZM17 17H14V19H19V14H17V17ZM14 5V7H17V10H19V5H14Z",fill:"currentColor"})}),dc=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12 15C13.66 15 14.99 13.66 14.99 12L15 6C15 4.34 13.66 3 12 3C10.34 3 9 4.34 9 6V12C9 13.66 10.34 15 12 15ZM17.3 12C17.3 15 14.76 17.1 12 17.1C9.24 17.1 6.7 15 6.7 12H5C5 15.42 7.72 18.23 11 18.72V22H13V18.72C16.28 18.24 19 15.42 19 12H17.3Z",fill:"currentColor"})}),nh=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"currentColor"})}),DC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})}),hc=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M3 9.99999V14C3 14.55 3.45 15 4 15H7L10.29 18.29C10.92 18.92 12 18.47 12 17.58V6.40999C12 5.51999 10.92 5.06999 10.29 5.69999L7 8.99999H4C3.45 8.99999 3 9.44999 3 9.99999ZM16.5 12C16.5 10.23 15.48 8.70999 14 7.96999V16.02C15.48 15.29 16.5 13.77 16.5 12ZM14 4.44999V4.64999C14 5.02999 14.25 5.35999 14.6 5.49999C17.18 6.52999 19 9.05999 19 12C19 14.94 17.18 17.47 14.6 18.5C14.24 18.64 14 18.97 14 19.35V19.55C14 20.18 14.63 20.62 15.21 20.4C18.6 19.11 21 15.84 21 12C21 8.15999 18.6 4.88999 15.21 3.59999C14.63 3.36999 14 3.81999 14 4.44999Z",fill:"currentColor"})}),pc=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M16.5 12C16.5 10.23 15.48 8.71 14 7.97V10.18L16.45 12.63C16.48 12.43 16.5 12.22 16.5 12ZM19 12C19 12.94 18.8 13.82 18.46 14.64L19.97 16.15C20.63 14.91 21 13.5 21 12C21 7.72 18.01 4.14 14 3.23V5.29C16.89 6.15 19 8.83 19 12ZM4.27 3L3 4.27L7.73 9H3V15H7L12 20V13.27L16.25 17.52C15.58 18.04 14.83 18.45 14 18.7V20.76C15.38 20.45 16.63 19.81 17.69 18.95L19.73 21L21 19.73L12 10.73L4.27 3ZM12 4L9.91 6.09L12 8.18V4Z",fill:"currentColor"})}),jC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12.87 15.07L10.33 12.56L10.36 12.53C12.1 10.59 13.34 8.36 14.07 6H17V4H10V2H8V4H1V5.99H12.17C11.5 7.92 10.44 9.75 9 11.35C8.07 10.32 7.3 9.19 6.69 8H4.69C5.42 9.63 6.42 11.17 7.67 12.56L2.58 17.58L4 19L9 14L12.11 17.11L12.87 15.07ZM18.5 10H16.5L12 22H14L15.12 19H19.87L21 22H23L18.5 10ZM15.88 17L17.5 12.67L19.12 17H15.88Z",fill:"currentColor"})}),AC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M19 19H5V5H12V3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V12H19V19ZM14 3V5H17.59L7.76 14.83L9.17 16.24L19 6.41V10H21V3H14Z",fill:"currentColor"})}),UC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M8 5V19L19 12L8 5Z",fill:"currentColor"})}),FC=t=>y.jsxs("svg",{viewBox:"0 0 24 24",...G(t),children:[y.jsx("path",{d:"M13 14.5C13 15.3284 12.3284 16 11.5 16C10.6716 16 10 15.3284 10 14.5C10 13.6716 10.6716 13 11.5 13C12.3284 13 13 13.6716 13 14.5Z",fill:"currentColor"}),y.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 2H14L20 8V20C20 21.1 19.1 22 18 22H5.99C4.89 22 4 21.1 4 20V4C4 2.9 4.9 2 6 2ZM13.16 17.57L15.04 19.45L16.45 18.04L14.57 16.16C15.29 14.83 15.1 13.15 13.98 12.03C12.61 10.66 10.4 10.66 9.03 12.03C7.66 13.4 7.66 15.61 9.03 16.98C10.15 18.1 11.83 18.28 13.16 17.57ZM13 3.5V9H18.5L13 3.5Z",fill:"currentColor"})]}),BC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M3 15H21V13H3V15ZM3 19H21V17H3V19ZM3 11H21V9H3V11ZM3 5V7H21V5H3Z",fill:"currentColor"})}),p0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M10 3C14.97 3 19 7.03 19 12H22L18.11 15.89L18.04 16.03L14 12H17C17 8.13 13.87 5 10 5C6.13 5 3 8.13 3 12C3 15.87 6.13 19 10 19V21C5.03 21 1 16.97 1 12C1 7.03 5.03 3 10 3Z",fill:"currentColor"})}),f0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M19.1064 12.9302C19.1459 12.6333 19.1657 12.3266 19.1657 12C19.1657 11.6833 19.1459 11.3667 19.0965 11.0698L21.1053 9.50625C21.2834 9.36771 21.3329 9.10052 21.2241 8.9026L19.3241 5.61719C19.2053 5.39948 18.9579 5.33021 18.7402 5.39948L16.3751 6.34948C15.8803 5.97344 15.3558 5.65677 14.772 5.41927L14.4157 2.90573C14.3761 2.66823 14.1782 2.5 13.9407 2.5H10.1407C9.90323 2.5 9.71521 2.66823 9.67563 2.90573L9.31938 5.41927C8.73552 5.65677 8.20115 5.98333 7.71625 6.34948L5.35115 5.39948C5.13344 5.32031 4.88604 5.39948 4.7673 5.61719L2.87719 8.9026C2.75844 9.11042 2.79802 9.36771 2.99594 9.50625L5.00479 11.0698C4.95532 11.3667 4.91573 11.6932 4.91573 12C4.91573 12.3068 4.93552 12.6333 4.985 12.9302L2.97615 14.4938C2.79802 14.6323 2.74855 14.8995 2.8574 15.0974L4.7574 18.3828C4.87615 18.6005 5.12354 18.6698 5.34125 18.6005L7.70636 17.6505C8.20115 18.0266 8.72563 18.3432 9.30948 18.5807L9.66573 21.0943C9.71521 21.3318 9.90323 21.5 10.1407 21.5H13.9407C14.1782 21.5 14.3761 21.3318 14.4058 21.0943L14.7621 18.5807C15.3459 18.3432 15.8803 18.0266 16.3652 17.6505L18.7303 18.6005C18.948 18.6797 19.1954 18.6005 19.3142 18.3828L21.2142 15.0974C21.3329 14.8797 21.2834 14.6323 21.0954 14.4938L19.1064 12.9302ZM12.0407 15.5625C10.0814 15.5625 8.47823 13.9594 8.47823 12C8.47823 10.0406 10.0814 8.4375 12.0407 8.4375C14.0001 8.4375 15.6032 10.0406 15.6032 12C15.6032 13.9594 14.0001 15.5625 12.0407 15.5625Z",fill:"currentColor"})}),zC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z",fill:"currentColor"})}),VC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),m0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M1 21H23L12 2L1 21ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z",fill:"currentColor"})}),HC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M15 3H6C5.17 3 4.46 3.5 4.16 4.22L1.14 11.27C1.05 11.5 1 11.74 1 12V14C1 15.1 1.9 16 3 16H9.31L8.36 20.57L8.33 20.89C8.33 21.3 8.5 21.68 8.77 21.95L9.83 23L16.42 16.41C16.78 16.05 17 15.55 17 15V5C17 3.9 16.1 3 15 3ZM19 3V15H23V3H19Z",fill:"currentColor"})}),qC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M1 21H5V9H1V21ZM23 10C23 8.9 22.1 8 21 8H14.69L15.64 3.43L15.67 3.11C15.67 2.7 15.5 2.32 15.23 2.05L14.17 1L7.59 7.59C7.22 7.95 7 8.45 7 9V19C7 20.1 7.9 21 9 21H18C18.83 21 19.54 20.5 19.84 19.78L22.86 12.73C22.95 12.5 23 12.26 23 12V10Z",fill:"currentColor"})}),$C=t=>y.jsxs("svg",{viewBox:"0 0 24 24",...G(t),children:[y.jsx("path",{d:"M11 7H12.5V12.25L17 14.92L16.25 16.15L11 13V7Z",fill:"currentColor"}),y.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47997 6.47 1.99997 11.99 1.99997C17.52 1.99997 22 6.47997 22 12C22 17.52 17.52 22 11.99 22C6.47 22 2 17.52 2 12ZM4 12C4 16.42 7.58 20 12 20C16.42 20 20 16.42 20 12C20 7.57997 16.42 3.99997 12 3.99997C7.58 3.99997 4 7.57997 4 12Z",fill:"currentColor"})]}),g0=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M13 3C8.03 3 4 7.03 4 12H1L4.89 15.89L4.96 16.03L9 12H6C6 8.13 9.13 5 13 5C16.87 5 20 8.13 20 12C20 15.87 16.87 19 13 19V21C17.97 21 22 16.97 22 12C22 7.03 17.97 3 13 3Z",fill:"currentColor"})}),WC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M12 4V1L8 5L12 9V6C15.31 6 18 8.69 18 12C18 13.01 17.75 13.97 17.3 14.8L18.76 16.26C19.54 15.03 20 13.57 20 12C20 7.58 16.42 4 12 4ZM12 18C8.69 18 6 15.31 6 12C6 10.99 6.25 10.03 6.7 9.2L5.24 7.74C4.46 8.97 4 10.43 4 12C4 16.42 7.58 20 12 20V23L16 19L12 15V18Z",fill:"currentColor"})}),KC=t=>y.jsx("svg",{viewBox:"0 0 24 24",...G(t),children:y.jsx("path",{d:"M11 18H13V16H11V18ZM12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 12 11 11.75 11 15H13C13 12.75 16 12.5 16 10C16 7.79 14.21 6 12 6Z",fill:"currentColor"})}),v0=t=>y.jsxs("svg",{viewBox:"0 0 16 16",...G(t),fill:"currentColor",children:[y.jsx("path",{d:"M12.6667 7.33326V12.6666H3.33333V3.33326H8.66667V1.99992H3.33333C2.6 1.99992 2 2.59992 2 3.33326V12.6666C2 13.3999 2.6 13.9999 3.33333 13.9999H12.6667C13.4 13.9999 14 13.3999 14 12.6666V7.33326H12.6667Z"}),y.jsx("path",{d:"M14.0183 1.97412L10.0699 1.97412L11.5506 3.45477L7.66668 7.33327L8.65378 8.32037L12.5377 4.44188L14.0183 5.92253V1.97412Z"})]}),GC=Object.freeze(Object.defineProperty({__proto__:null,Action:PC,Add:IC,ArrowDown:s0,ArrowForward:Ni,ArrowLeft:_C,ArrowRight:c0,ArrowUp:OC,AssistantOld:RC,Attachment:uu,Camera:NC,Check:l0,Close:th,Copy:LC,Date:u0,Delete:d0,Error:du,Escalate:h0,FullScreen:MC,Help:KC,Location:DC,Mic:dc,MicOff:nh,OpenInNew:AC,OpenLink:v0,Play:UC,Preview:FC,Refresh:WC,Reorder:BC,Restart:p0,Search:zC,Settings:f0,Share:VC,ThumbDown:HC,ThumbUp:qC,Time:$C,Touchpoint:za,Translate:jC,Undo:g0,Volume:hc,VolumeOff:pc,Warning:m0},Symbol.toStringTag,{value:"Module"})),ZC=t=>y.jsxs("button",{className:Y("p-3 w-fit bg-background text-primary-80 rounded-outer","after:content-[''] after:rounded-outer after:absolute after:inset-0 after:pointer-events-none","hover:after:bg-primary-10",t.className),disabled:t.onClick==null,onClick:t.onClick,children:[y.jsx("span",{className:"block flex-none w-8 h-8",children:t.iconUrl==null?y.jsx(za,{}):y.jsx("img",{src:t.iconUrl,className:"w-8 h-8"})}),t.showLabel??!1?y.jsx("span",{children:t.label}):null]}),b0="p-3 w-10 h-10 transition-colors rounded-inner relative z-10 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent focus:outline-0",y0="bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40",k0="bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20",w0="bg-accent text-secondary-80 enabled:hover:before:bg-primary-40 focus:before:bg-primary-40 enabled:active:before:bg-secondary-10 disabled:bg-accent-20",C0="bg-secondary-60 backdrop-blur text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",S0="bg-background backdrop-blur text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",T0="bg-error-primary text-secondary-80",QC=({type:t,Icon:e})=>y.jsx("span",{className:Y(b0,"block",t==="main"?y0:null,t==="ghost"?k0:null,t==="activated"?w0:null,t==="coverup"?C0:null,t==="overlay"?S0:null,t==="error"?T0:null),children:y.jsx(e,{})}),ft=({onClick:t,type:e,label:n,className:r,Icon:i})=>{const a=t==null;return y.jsx("button",{onClick:a?void 0:t,disabled:a,"aria-label":n,className:Y(b0,e==="main"?y0:null,e==="ghost"?k0:null,e==="activated"?w0:null,e==="coverup"?C0:null,e==="overlay"?S0:null,e==="error"?T0:null,r),children:y.jsx(i,{})})};function JC(t){const e=A.useRef(t);return e.current=t,A.useMemo(()=>Object.freeze({get current(){return e.current}}),[])}function YC(t){const e=JC(t);A.useEffect(()=>()=>{e.current()},[])}function XC(t,e,n,r=0){const i=A.useRef(),a=A.useRef(),o=A.useRef(t),s=A.useRef(),c=()=>{i.current&&(clearTimeout(i.current),i.current=void 0),a.current&&(clearTimeout(a.current),a.current=void 0)};return YC(c),A.useEffect(()=>{o.current=t},e),A.useMemo(()=>{const l=()=>{if(c(),!s.current)return;const d=s.current;s.current=void 0,o.current.apply(d.this,d.args)},u=function(...d){i.current&&clearTimeout(i.current),s.current={args:d,this:this},i.current=setTimeout(l,n),r>0&&!a.current&&(a.current=setTimeout(l,r))};return Object.defineProperties(u,{length:{value:t.length},name:{value:`${t.name||"anonymous"}__debounced__${n}`}}),u},[n,r,...e])}const eS=typeof globalThis<"u"&&typeof navigator<"u"&&typeof document<"u";function cf(t,e,n=0){const[r,i]=A.useState(t);return[r,XC(i,[],e,n)]}const Si=new Map,x0=t=>{const e=matchMedia(t),n=new Set,r=()=>{for(const i of n)i(e.matches)};return e.addEventListener("change",r,{passive:!0}),{mql:e,dispatchers:n,listener:r}},tS=(t,e)=>{let n=Si.get(t);n||(n=x0(t),Si.set(t,n)),n.dispatchers.add(e),e(n.mql.matches)},nS=(t,e)=>{const n=Si.get(t);if(n){const{mql:r,dispatchers:i,listener:a}=n;i.delete(e),i.size===0&&(Si.delete(t),r.removeEventListener?r.removeEventListener("change",a):r.removeListener(a))}};function rS(t,e={}){let{initializeWithValue:n=!0}=e;eS||(n=!1);const[r,i]=A.useState(()=>{if(n){let a=Si.get(t);return a||(a=x0(t),Si.set(t,a)),a.mql.matches}});return A.useEffect(()=>(tS(t,i),()=>{nS(t,i)}),[t]),r}const E0=t=>rS("(min-width: 768px)"),iS=({windowSize:t,renderCollapse:e,errorThemedCloseButton:n,speakerControls:r,collapse:i,toggleSettings:a,isSettingsOpen:o,brandIcon:s,reset:c,enabled:l})=>{const u=t==="half",d=E0(),h=u&&d?"overlay":"ghost";return y.jsxs("div",{className:Y("flex","p-2 md:p-3 items-center justify-between gap-2",{"md:absolute md:w-fit md:flex-col md:left-0 md:-translate-x-full":t==="half","md:absolute md:left-0 md:right-0 md:top-0":t==="full"}),children:[s!=null?y.jsx("img",{className:"w-10 h-10 block",src:s,role:"presentation"}):null,y.jsx(ft,{label:"Reset",type:h,className:s==null?"":"ml-auto",onClick:l?()=>{c()}:void 0,Icon:g0}),a!=null?y.jsx(ft,{className:s!=null?"":"ml-auto",Icon:f0,label:"Settings",type:o?"activated":h,onClick:l?a:void 0}):null,r!=null?y.jsx(ft,{Icon:r.enabled?hc:pc,label:"Speakers",type:r.enabled?"activated":h,onClick:()=>{r.setEnabled(f=>!f)}}):null,e?y.jsx(ft,{label:"Collapse",type:n??!1?"error":h,className:Y(a==null?"ml-auto":"",u?"md:-order-1":""),onClick:l?()=>{i(new Event("collapse"))}:void 0,Icon:th}):null]})},P0=()=>y.jsxs("div",{className:Y("flex-grow flex flex-col items-center justify-center gap-6 text-primary-80","fullscreen-error"),children:[y.jsx(za,{className:"w-20 h-20 text-primary-20"}),y.jsxs("div",{className:"text-center",children:[y.jsx("h3",{className:"text-xl mb-2",children:"Oops!"}),y.jsx("p",{children:"Something went wrong."}),y.jsx("p",{children:"Try again later."})]})]}),Co=({k:t,className:e})=>{const n=r=>`${r}s`;return y.jsx("div",{className:Y("bg-accent-20 animate-ping absolute inset-0",e),style:{animationDelay:n(-1.5*t),animationDuration:n(1.5)}})},Ns=({className:t})=>y.jsxs(y.Fragment,{children:[y.jsx(Co,{k:.12,className:t}),y.jsx(Co,{k:.24,className:t}),y.jsx(Co,{k:.36,className:t}),y.jsx(Co,{k:.48,className:t})]}),aS=30,qi=17,oS=t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,hu=990,sS=300,So=hu+sS,cS=({d:t})=>{const e=Math.PI/2,n=t/qi/2.8,r=e*Math.min(n,1),i=n<1?(t-Math.sin(r))/Math.cos(r)*.5:0,a=-t,o=t,s=t-qi*Math.sin(r),c=qi*Math.cos(r),l=s-i*Math.cos(r),u=c-i*Math.sin(r);return y.jsxs(y.Fragment,{children:[y.jsx("circle",{cx:a,cy:"0",r:qi}),y.jsx("circle",{cx:o,cy:"0",r:qi}),n<.45?y.jsx("path",{d:`
            M${-s},${c} 
            C${-l},${u} ${l},${u} ${s},${c} L${s},${-c}
            C${l},${-u} ${-l},${-u} ${-s},${-c} Z
          `}):null]})},lS=t=>t<1/3?t*3:t<2/3?1:3-t*3,lf=t=>t<1/3?0:t<2/3?(t-1/3)*3:1,rh=()=>{const[t,e]=A.useState(null),n=A.useRef(!1);if(A.useEffect(()=>{const d=h=>{e(f=>f==null?{start:h,current:h}:{...f,current:h}),n.current||requestAnimationFrame(d)};n.current||requestAnimationFrame(d)},[n,e]),t==null)return null;let r,i;const a=t.current-t.start,o=a%So,s=Math.floor(a/So);if(o<hu){const d=a/So,h=Math.floor(d),f=oS((d-h)*(So/hu));r=lS(f),i=s%2?lf(f):1+lf(f)}else r=0,i=0;const c=r>.2?0:5*(.2-r)/.2,l=.3,u=r>l?1-.25*(r-l)/(1-l):1;return y.jsx("svg",{viewBox:"0 0 100 100",stroke:"none",fill:"currentColor",style:{filter:`drop-shadow(0 0 ${c}px var(--accent))`},children:y.jsx("g",{transform:`translate(50 50) rotate(${i*90})`,opacity:u,children:y.jsx(cS,{d:aS*r})})})},R0=({label:t,className:e})=>y.jsx("div",{className:Y("h-full w-full flex items-center justify-center",e),children:y.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[y.jsx("div",{className:Y("w-8 h-8 block text-accent"),children:y.jsx(rh,{})}),t!=null?y.jsx("p",{className:"text-primary-60",children:t}):null]})}),Ti=({onClick:t,label:e,type:n="ghost",Icon:r,className:i})=>y.jsxs("button",{onClick:t,disabled:t==null,className:Y("relative z-10 w-full px-5 py-4 transition-colors rounded-outer flex justify-between items-center focus:outline-0 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",{"bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40":n==="main","bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-5 focus:before:bg-primary-5 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20":n==="ghost"},i),children:[e,y.jsx(r,{size:16})]});function uS(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var dS=Object.defineProperty,hS=(t,e,n)=>e in t?dS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,uf=(t,e,n)=>hS(t,typeof e!="symbol"?e+"":e,n);class mt{constructor(){uf(this,"_locking"),uf(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function xe(t,e){if(!t)throw new Error(e)}const pS=34028234663852886e22,fS=-34028234663852886e22,mS=4294967295,gS=2147483647,vS=-2147483648;function Ho(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>gS||t<vS)throw new Error("invalid int 32: "+t)}function pu(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>mS||t<0)throw new Error("invalid uint 32: "+t)}function I0(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>pS||t<fS))throw new Error("invalid float 32: "+t)}const _0=Symbol("@bufbuild/protobuf/enum-type");function bS(t){const e=t[_0];return xe(e,"missing enum type on enum object"),e}function O0(t,e,n,r){t[_0]=N0(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function N0(t,e,n){const r=Object.create(null),i=Object.create(null),a=[];for(const o of e){const s=L0(o);a.push(s),r[o.name]=s,i[o.no]=s}return{typeName:t,values:a,findName(o){return r[o]},findNumber(o){return i[o]}}}function yS(t,e,n){const r={};for(const i of e){const a=L0(i);r[a.localName]=a.no,r[a.no]=a.localName}return O0(r,t,e),r}function L0(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class ih{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,a=i.makeReadOptions(n);return i.readMessage(this,a.readerFactory(e),e.byteLength,a),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,a=i.makeReadOptions(n);return i.readMessage(r,e,a,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),a=i.writerFactory();return r.writeMessage(this,a,i),a.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function kS(t,e,n,r){var i;const a=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),o={[a]:function(s){t.util.initFields(this),t.util.initPartial(s,this)}}[a];return Object.setPrototypeOf(o.prototype,new ih),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(s,c){return new o().fromBinary(s,c)},fromJson(s,c){return new o().fromJson(s,c)},fromJsonString(s,c){return new o().fromJsonString(s,c)},equals(s,c){return t.util.equals(o,s,c)}}),o}function wS(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Xc(t,e,n){for(let a=0;a<28;a=a+7){const o=t>>>a,s=!(!(o>>>7)&&e==0),c=(s?o|128:o)&255;if(n.push(c),!s)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let a=3;a<31;a=a+7){const o=e>>>a,s=!!(o>>>7),c=(s?o|128:o)&255;if(n.push(c),!s)return}n.push(e>>>31&1)}}const qo=4294967296;function df(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function a(o,s){const c=Number(t.slice(o,s));i*=n,r=r*n+c,r>=qo&&(i=i+(r/qo|0),r=r%qo)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),e?D0(r,i):ah(r,i)}function CS(t,e){let n=ah(t,e);const r=n.hi&2147483648;r&&(n=D0(n.lo,n.hi));const i=M0(n.lo,n.hi);return r?"-"+i:i}function M0(t,e){if({lo:t,hi:e}=SS(t,e),e<=2097151)return String(qo*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let a=n+r*6777216+i*6710656,o=r+i*8147497,s=i*2;const c=1e7;return a>=c&&(o+=Math.floor(a/c),a%=c),o>=c&&(s+=Math.floor(o/c),o%=c),s.toString()+hf(o)+hf(a)}function SS(t,e){return{lo:t>>>0,hi:e>>>0}}function ah(t,e){return{lo:t|0,hi:e|0}}function D0(t,e){return e=~e,t?t=~t+1:e+=1,ah(t,e)}const hf=t=>{const e=String(t);return"0000000".slice(e.length)+e};function pf(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function TS(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function xS(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),a=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(s){const c=typeof s=="bigint"?s:BigInt(s);if(c>i||c<r)throw new Error("int64 invalid: ".concat(s));return c},uParse(s){const c=typeof s=="bigint"?s:BigInt(s);if(c>o||c<a)throw new Error("uint64 invalid: ".concat(s));return c},enc(s){return t.setBigInt64(0,this.parse(s),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(s){return t.setBigInt64(0,this.uParse(s),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(s,c){return t.setInt32(0,s,!0),t.setInt32(4,c,!0),t.getBigInt64(0,!0)},uDec(s,c){return t.setInt32(0,s,!0),t.setInt32(4,c,!0),t.getBigUint64(0,!0)}}}const e=r=>xe(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),n=r=>xe(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),e(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),e(r),df(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),n(r),df(r)},dec(r,i){return CS(r,i)},uDec(r,i){return M0(r,i)}}}const be=xS();var I;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(I||(I={}));var Jn;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Jn||(Jn={}));function xn(t,e,n){if(e===n)return!0;if(t==I.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case I.UINT64:case I.FIXED64:case I.INT64:case I.SFIXED64:case I.SINT64:return e==n}return!1}function xi(t,e){switch(t){case I.BOOL:return!1;case I.UINT64:case I.FIXED64:case I.INT64:case I.SFIXED64:case I.SINT64:return e==0?be.zero:"0";case I.DOUBLE:case I.FLOAT:return 0;case I.BYTES:return new Uint8Array(0);case I.STRING:return"";default:return 0}}function j0(t,e){switch(t){case I.BOOL:return e===!1;case I.STRING:return e==="";case I.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Re;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Re||(Re={}));class ES{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(pu(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ho(e),pf(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){I0(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){pu(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Ho(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Ho(e),e=(e<<1^e>>31)>>>0,pf(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=be.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=be.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=be.enc(e);return Xc(n.lo,n.hi,this.buf),this}sint64(e){let n=be.enc(e),r=n.hi>>31,i=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Xc(i,a,this.buf),this}uint64(e){let n=be.uEnc(e);return Xc(n.lo,n.hi,this.buf),this}}class PS{constructor(e,n){this.varint64=wS,this.uint32=TS,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case Re.Varint:for(;this.buf[this.pos++]&128;);break;case Re.Bit64:this.pos+=4;case Re.Bit32:this.pos+=4;break;case Re.LengthDelimited:let i=this.uint32();this.pos+=i;break;case Re.StartGroup:for(;;){const[a,o]=this.tag();if(o===Re.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(o,a)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return be.dec(...this.varint64())}uint64(){return be.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,be.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return be.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return be.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function RS(t,e,n,r){let i;return{typeName:e,extendee:n,get field(){if(!i){const a=typeof r=="function"?r():r;a.name=e.split(".").pop(),a.jsonName="[".concat(e,"]"),i=t.util.newFieldList([a]).list()[0]}return i},runtime:t}}function A0(t){const e=t.field.localName,n=Object.create(null);return n[e]=IS(t),[n,()=>n[e]]}function IS(t){const e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return xi(e.T,e.L);case"message":const n=e.T,r=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function _S(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}let dn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),fc=[];for(let t=0;t<dn.length;t++)fc[dn[t].charCodeAt(0)]=t;fc[45]=dn.indexOf("+");fc[95]=dn.indexOf("/");const U0={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,a,o=0;for(let s=0;s<t.length;s++){if(a=fc[t.charCodeAt(s)],a===void 0)switch(t[s]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=a,i=1;break;case 1:n[r++]=o<<2|(a&48)>>4,o=a,i=2;break;case 2:n[r++]=(o&15)<<4|(a&60)>>2,o=a,i=3;break;case 3:n[r++]=(o&3)<<6|a,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let a=0;a<t.length;a++)switch(r=t[a],n){case 0:e+=dn[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=dn[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=dn[i|r>>6],e+=dn[r&63],n=0;break}return n&&(e+=dn[i],e+="=",n==1&&(e+="=")),e}};function OS(t,e,n){B0(e,t);const r=e.runtime.bin.makeReadOptions(n),i=_S(t.getType().runtime.bin.listUnknownFields(t),e.field),[a,o]=A0(e);for(const s of i)e.runtime.bin.readField(a,r.readerFactory(s.data),e.field,s.wireType,r);return o()}function NS(t,e,n,r){B0(e,t);const i=e.runtime.bin.makeReadOptions(r),a=e.runtime.bin.makeWriteOptions(r);if(F0(t,e)){const l=t.getType().runtime.bin.listUnknownFields(t).filter(u=>u.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(const u of l)t.getType().runtime.bin.onUnknownField(t,u.no,u.wireType,u.data)}const o=a.writerFactory();let s=e.field;!s.opt&&!s.repeated&&(s.kind=="enum"||s.kind=="scalar")&&(s=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(s,n,o,a);const c=i.readerFactory(o.finish());for(;c.pos<c.len;){const[l,u]=c.tag(),d=c.skip(u,l);t.getType().runtime.bin.onUnknownField(t,l,u,d)}}function F0(t,e){const n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(r=>r.no==e.field.no)}function B0(t,e){xe(t.extendee.typeName==e.getType().typeName,"extension ".concat(t.typeName," can only be applied to message ").concat(t.extendee.typeName))}function z0(t,e){const n=t.localName;if(t.repeated)return e[n].length>0;if(t.oneof)return e[t.oneof.localName].case===n;switch(t.kind){case"enum":case"scalar":return t.opt||t.req?e[n]!==void 0:t.kind=="enum"?e[n]!==t.T.values[0].no:!j0(t.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function ff(t,e){const n=t.localName,r=!t.opt&&!t.req;if(t.repeated)e[n]=[];else if(t.oneof)e[t.oneof.localName]={case:void 0};else switch(t.kind){case"map":e[n]={};break;case"enum":e[n]=r?t.T.values[0].no:void 0;break;case"scalar":e[n]=r?xi(t.T,t.L):void 0;break;case"message":e[n]=void 0;break}}function yr(t,e){if(t===null||typeof t!="object"||!Object.getOwnPropertyNames(ih.prototype).every(r=>r in t&&typeof t[r]=="function"))return!1;const n=t.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function V0(t,e){return yr(e)||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}I.DOUBLE,I.FLOAT,I.INT64,I.UINT64,I.INT32,I.UINT32,I.BOOL,I.STRING,I.BYTES;const mf={ignoreUnknownFields:!1},gf={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function LS(t){return t?Object.assign(Object.assign({},mf),t):mf}function MS(t){return t?Object.assign(Object.assign({},gf),t):gf}const Ls=Symbol(),$o=Symbol();function DS(){return{makeReadOptions:LS,makeWriteOptions:MS,readMessage(t,e,n,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(Yt(e)));r=r??new t;const i=new Map,a=n.typeRegistry;for(const[o,s]of Object.entries(e)){const c=t.fields.findJsonName(o);if(c){if(c.oneof){if(s===null&&c.kind=="scalar")continue;const l=i.get(c.oneof);if(l!==void 0)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(l,'", "').concat(o,'"'));i.set(c.oneof,o)}vf(r,s,c,n,t)}else{let l=!1;if(a!=null&&a.findExtension&&o.startsWith("[")&&o.endsWith("]")){const u=a.findExtension(o.substring(1,o.length-1));if(u&&u.extendee.typeName==t.typeName){l=!0;const[d,h]=A0(u);vf(d,s,u.field,n,u),NS(r,u,h(),n)}}if(!l&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(o,'" is unknown'))}}return r},writeMessage(t,e){const n=t.getType(),r={};let i;try{for(i of n.fields.byNumber()){if(!z0(i,t)){if(i.req)throw"required field not set";if(!e.emitDefaultValues||!AS(i))continue}const o=i.oneof?t[i.oneof.localName].value:t[i.localName],s=bf(i,o,e);s!==void 0&&(r[e.useProtoFieldName?i.name:i.jsonName]=s)}const a=e.typeRegistry;if(a!=null&&a.findExtensionFor)for(const o of n.runtime.bin.listUnknownFields(t)){const s=a.findExtensionFor(n.typeName,o.no);if(s&&F0(t,s)){const c=OS(t,s,e),l=bf(s.field,c,e);l!==void 0&&(r[s.field.jsonName]=l)}}}catch(a){const o=i?"cannot encode field ".concat(n.typeName,".").concat(i.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),s=a instanceof Error?a.message:String(a);throw new Error(o+(s.length>0?": ".concat(s):""))}return r},readScalar(t,e,n){return ma(t,e,n??Jn.BIGINT,!0)},writeScalar(t,e,n){if(e!==void 0&&(n||j0(t,e)))return Wo(t,e)},debug:Yt}}function Yt(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function vf(t,e,n,r,i){let a=n.localName;if(n.repeated){if(xe(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Yt(e)));const o=t[a];for(const s of e){if(s===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Yt(s)));switch(n.kind){case"message":o.push(n.T.fromJson(s,r));break;case"enum":const c=el(n.T,s,r.ignoreUnknownFields,!0);c!==$o&&o.push(c);break;case"scalar":try{o.push(ma(n.T,s,n.L,!0))}catch(l){let u="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Yt(s));throw l instanceof Error&&l.message.length>0&&(u+=": ".concat(l.message)),new Error(u)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Yt(e)));const o=t[a];for(const[s,c]of Object.entries(e)){if(c===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: map value null"));let l;try{l=jS(n.K,s)}catch(u){let d="cannot decode map key for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Yt(e));throw u instanceof Error&&u.message.length>0&&(d+=": ".concat(u.message)),new Error(d)}switch(n.V.kind){case"message":o[l]=n.V.T.fromJson(c,r);break;case"enum":const u=el(n.V.T,c,r.ignoreUnknownFields,!0);u!==$o&&(o[l]=u);break;case"scalar":try{o[l]=ma(n.V.T,c,Jn.BIGINT,!0)}catch(d){let h="cannot decode map value for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Yt(e));throw d instanceof Error&&d.message.length>0&&(h+=": ".concat(d.message)),new Error(h)}break}}}else switch(n.oneof&&(t=t[n.oneof.localName]={case:a},a="value"),n.kind){case"message":const o=n.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let s=t[a];yr(s)?s.fromJson(e,r):(t[a]=s=o.fromJson(e,r),o.fieldWrapper&&!n.oneof&&(t[a]=o.fieldWrapper.unwrapField(s)));break;case"enum":const c=el(n.T,e,r.ignoreUnknownFields,!1);switch(c){case Ls:ff(n,t);break;case $o:break;default:t[a]=c;break}break;case"scalar":try{const l=ma(n.T,e,n.L,!1);switch(l){case Ls:ff(n,t);break;default:t[a]=l;break}}catch(l){let u="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Yt(e));throw l instanceof Error&&l.message.length>0&&(u+=": ".concat(l.message)),new Error(u)}break}}function jS(t,e){if(t===I.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return ma(t,e,Jn.BIGINT,!0).toString()}function ma(t,e,n,r){if(e===null)return r?xi(t,n):Ls;switch(t){case I.DOUBLE:case I.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const i=Number(e);if(Number.isNaN(i)||!Number.isFinite(i))break;return t==I.FLOAT&&I0(i),i;case I.INT32:case I.FIXED32:case I.SFIXED32:case I.SINT32:case I.UINT32:let a;if(typeof e=="number"?a=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(a=Number(e)),a===void 0)break;return t==I.UINT32||t==I.FIXED32?pu(a):Ho(a),a;case I.INT64:case I.SFIXED64:case I.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=be.parse(e);return n?o.toString():o;case I.FIXED64:case I.UINT64:if(typeof e!="number"&&typeof e!="string")break;const s=be.uParse(e);return n?s.toString():s;case I.BOOL:if(typeof e!="boolean")break;return e;case I.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case I.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return U0.dec(e)}throw new Error}function el(t,e,n,r){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:r?t.values[0].no:Ls;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const i=t.findName(e);if(i!==void 0)return i.no;if(n)return $o;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(Yt(e)))}function AS(t){return t.repeated||t.kind=="map"?!0:!(t.oneof||t.kind=="message"||t.opt||t.req)}function bf(t,e,n){if(t.kind=="map"){xe(typeof e=="object"&&e!=null);const r={},i=Object.entries(e);switch(t.V.kind){case"scalar":for(const[o,s]of i)r[o.toString()]=Wo(t.V.T,s);break;case"message":for(const[o,s]of i)r[o.toString()]=s.toJson(n);break;case"enum":const a=t.V.T;for(const[o,s]of i)r[o.toString()]=tl(a,s,n.enumAsInteger);break}return n.emitDefaultValues||i.length>0?r:void 0}if(t.repeated){xe(Array.isArray(e));const r=[];switch(t.kind){case"scalar":for(let i=0;i<e.length;i++)r.push(Wo(t.T,e[i]));break;case"enum":for(let i=0;i<e.length;i++)r.push(tl(t.T,e[i],n.enumAsInteger));break;case"message":for(let i=0;i<e.length;i++)r.push(e[i].toJson(n));break}return n.emitDefaultValues||r.length>0?r:void 0}switch(t.kind){case"scalar":return Wo(t.T,e);case"enum":return tl(t.T,e,n.enumAsInteger);case"message":return V0(t.T,e).toJson(n)}}function tl(t,e,n){var r;if(xe(typeof e=="number"),t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const i=t.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function Wo(t,e){switch(t){case I.INT32:case I.SFIXED32:case I.SINT32:case I.FIXED32:case I.UINT32:return xe(typeof e=="number"),e;case I.FLOAT:case I.DOUBLE:return xe(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case I.STRING:return xe(typeof e=="string"),e;case I.BOOL:return xe(typeof e=="boolean"),e;case I.UINT64:case I.FIXED64:case I.INT64:case I.SFIXED64:case I.SINT64:return xe(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case I.BYTES:return xe(e instanceof Uint8Array),U0.enc(e)}}const Ur=Symbol("@bufbuild/protobuf/unknown-fields"),yf={readUnknownFields:!0,readerFactory:t=>new PS(t)},kf={writeUnknownFields:!0,writerFactory:()=>new ES};function US(t){return t?Object.assign(Object.assign({},yf),t):yf}function FS(t){return t?Object.assign(Object.assign({},kf),t):kf}function BS(){return{makeReadOptions:US,makeWriteOptions:FS,listUnknownFields(t){var e;return(e=t[Ur])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Ur]},writeUnknownFields(t,e){const n=t[Ur];if(n)for(const r of n)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[Ur])||(i[Ur]=[]),i[Ur].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r,i){const a=t.getType(),o=i?e.len:e.pos+n;let s,c;for(;e.pos<o&&([s,c]=e.tag(),!(i===!0&&c==Re.EndGroup));){const l=a.fields.find(s);if(!l){const u=e.skip(c,s);r.readUnknownFields&&this.onUnknownField(t,s,c,u);continue}wf(t,e,l,c,r)}if(i&&(c!=Re.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:wf,writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){if(!z0(i,t)){if(i.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(i.name," to binary: required field not set"));continue}const a=i.oneof?t[i.oneof.localName].value:t[i.localName];Cf(i,a,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e},writeField(t,e,n,r){e!==void 0&&Cf(t,e,n,r)}}}function wf(t,e,n,r,i){let{repeated:a,localName:o}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=o&&delete t.value,t.case=o,o="value"),n.kind){case"scalar":case"enum":const s=n.kind=="enum"?I.INT32:n.T;let c=Ms;if(n.kind=="scalar"&&n.L>0&&(c=VS),a){let h=t[o];if(r==Re.LengthDelimited&&s!=I.STRING&&s!=I.BYTES){let f=e.uint32()+e.pos;for(;e.pos<f;)h.push(c(e,s))}else h.push(c(e,s))}else t[o]=c(e,s);break;case"message":const l=n.T;a?t[o].push(Ko(e,new l,i,n)):yr(t[o])?Ko(e,t[o],i,n):(t[o]=Ko(e,new l,i,n),l.fieldWrapper&&!n.oneof&&!n.repeated&&(t[o]=l.fieldWrapper.unwrapField(t[o])));break;case"map":let[u,d]=zS(n,e,i);t[o][u]=d;break}}function Ko(t,e,n,r){const i=e.getType().runtime.bin,a=r==null?void 0:r.delimited;return i.readMessage(e,t,a?r.no:t.uint32(),n,a),e}function zS(t,e,n){const r=e.uint32(),i=e.pos+r;let a,o;for(;e.pos<i;){const[s]=e.tag();switch(s){case 1:a=Ms(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=Ms(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=Ko(e,new t.V.T,n,void 0);break}break}}if(a===void 0&&(a=xi(t.K,Jn.BIGINT)),typeof a!="string"&&typeof a!="number"&&(a=a.toString()),o===void 0)switch(t.V.kind){case"scalar":o=xi(t.V.T,Jn.BIGINT);break;case"enum":o=t.V.T.values[0].no;break;case"message":o=new t.V.T;break}return[a,o]}function VS(t,e){const n=Ms(t,e);return typeof n=="bigint"?n.toString():n}function Ms(t,e){switch(e){case I.STRING:return t.string();case I.BOOL:return t.bool();case I.DOUBLE:return t.double();case I.FLOAT:return t.float();case I.INT32:return t.int32();case I.INT64:return t.int64();case I.UINT64:return t.uint64();case I.FIXED64:return t.fixed64();case I.BYTES:return t.bytes();case I.FIXED32:return t.fixed32();case I.SFIXED32:return t.sfixed32();case I.SFIXED64:return t.sfixed64();case I.SINT64:return t.sint64();case I.UINT32:return t.uint32();case I.SINT32:return t.sint32()}}function Cf(t,e,n,r){xe(e!==void 0);const i=t.repeated;switch(t.kind){case"scalar":case"enum":let a=t.kind=="enum"?I.INT32:t.T;if(i)if(xe(Array.isArray(e)),t.packed)qS(n,a,t.no,e);else for(const o of e)ga(n,a,t.no,o);else ga(n,a,t.no,e);break;case"message":if(i){xe(Array.isArray(e));for(const o of e)Sf(n,r,t,o)}else Sf(n,r,t,e);break;case"map":xe(typeof e=="object"&&e!=null);for(const[o,s]of Object.entries(e))HS(n,r,t,o,s);break}}function HS(t,e,n,r,i){t.tag(n.no,Re.LengthDelimited),t.fork();let a=r;switch(n.K){case I.INT32:case I.FIXED32:case I.UINT32:case I.SFIXED32:case I.SINT32:a=Number.parseInt(r);break;case I.BOOL:xe(r=="true"||r=="false"),a=r=="true";break}switch(ga(t,n.K,1,a),n.V.kind){case"scalar":ga(t,n.V.T,2,i);break;case"enum":ga(t,I.INT32,2,i);break;case"message":xe(i!==void 0),t.tag(2,Re.LengthDelimited).bytes(i.toBinary(e));break}t.join()}function Sf(t,e,n,r){const i=V0(n.T,r);n.delimited?t.tag(n.no,Re.StartGroup).raw(i.toBinary(e)).tag(n.no,Re.EndGroup):t.tag(n.no,Re.LengthDelimited).bytes(i.toBinary(e))}function ga(t,e,n,r){xe(r!==void 0);let[i,a]=H0(e);t.tag(n,i)[a](r)}function qS(t,e,n,r){if(!r.length)return;t.tag(n,Re.LengthDelimited).fork();let[,i]=H0(e);for(let a=0;a<r.length;a++)t[i](r[a]);t.join()}function H0(t){let e=Re.Varint;switch(t){case I.BYTES:case I.STRING:e=Re.LengthDelimited;break;case I.DOUBLE:case I.FIXED64:case I.SFIXED64:e=Re.Bit64;break;case I.FIXED32:case I.SFIXED32:case I.FLOAT:e=Re.Bit32;break}const n=I[t].toLowerCase();return[e,n]}function $S(){return{setEnumType:O0,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,a=e,o=t;if(o[i]!=null)switch(r.kind){case"oneof":const s=o[i].case;if(s===void 0)continue;const c=r.findField(s);let l=o[i].value;c&&c.kind=="message"&&!yr(l,c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===I.BYTES&&(l=$i(l)),a[i]={case:s,value:l};break;case"scalar":case"enum":let u=o[i];r.T===I.BYTES&&(u=r.repeated?u.map($i):$i(u)),a[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===I.BYTES)for(const[f,v]of Object.entries(o[i]))a[i][f]=$i(v);else Object.assign(a[i],o[i]);break;case"message":const h=r.V.T;for(const f of Object.keys(o[i])){let v=o[i][f];h.fieldWrapper||(v=new h(v)),a[i][f]=v}break}break;case"message":const d=r.T;if(r.repeated)a[i]=o[i].map(h=>yr(h,d)?h:new d(h));else{const h=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?a[i]=$i(h):a[i]=h:a[i]=yr(h,d)?h:new d(h)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],a=n[r.localName];if(r.repeated){if(i.length!==a.length)return!1;switch(r.kind){case"message":return i.every((o,s)=>r.T.equals(o,a[s]));case"scalar":return i.every((o,s)=>xn(r.T,o,a[s]));case"enum":return i.every((o,s)=>xn(I.INT32,o,a[s]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,a);case"enum":return xn(I.INT32,i,a);case"scalar":return xn(r.T,i,a);case"oneof":if(i.case!==a.case)return!1;const o=r.findField(i.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(i.value,a.value);case"enum":return xn(I.INT32,i.value,a.value);case"scalar":return xn(o.T,i.value,a.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const s=Object.keys(i).concat(Object.keys(a));switch(r.V.kind){case"message":const c=r.V.T;return s.every(u=>c.equals(i[u],a[u]));case"enum":return s.every(u=>xn(I.INT32,i[u],a[u]));case"scalar":const l=r.V.T;return s.every(u=>xn(l,i[u],a[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const a=t[i.localName];let o;if(i.repeated)o=a.map(To);else if(i.kind=="map"){o=r[i.localName];for(const[s,c]of Object.entries(a))o[s]=To(c)}else i.kind=="oneof"?o=i.findField(a.case)?{case:a.case,value:To(a.value)}:{case:void 0}:o=To(a);r[i.localName]=o}for(const i of e.runtime.bin.listUnknownFields(t))e.runtime.bin.onUnknownField(r,i.no,i.wireType,i.data);return n}}}function To(t){if(t===void 0)return t;if(yr(t))return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function $i(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function WS(t,e,n){return{syntax:t,json:DS(),bin:BS(),util:Object.assign(Object.assign({},$S()),{newFieldList:e,initFields:n}),makeMessageType(r,i,a){return kS(this,r,i,a)},makeEnum:yS,makeEnumType:N0,getEnumType:bS,makeExtension(r,i,a){return RS(this,r,i,a)}}}class KS{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function q0(t,e){const n=$0(t);return e?n:XS(YS(n))}function GS(t){return q0(t,!1)}const ZS=$0;function $0(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const QS=new Set(["constructor","toString","toJSON","valueOf"]),JS=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),W0=t=>"".concat(t,"$"),YS=t=>JS.has(t)?W0(t):t,XS=t=>QS.has(t)?W0(t):t;class eT{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=GS(e)}addField(e){xe(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function tT(t,e){var n,r,i,a,o,s;const c=[];let l;for(const u of typeof t=="function"?t():t){const d=u;if(d.localName=q0(u.name,u.oneof!==void 0),d.jsonName=(n=u.jsonName)!==null&&n!==void 0?n:ZS(u.name),d.repeated=(r=u.repeated)!==null&&r!==void 0?r:!1,u.kind=="scalar"&&(d.L=(i=u.L)!==null&&i!==void 0?i:Jn.BIGINT),d.delimited=(a=u.delimited)!==null&&a!==void 0?a:!1,d.req=(o=u.req)!==null&&o!==void 0?o:!1,d.opt=(s=u.opt)!==null&&s!==void 0?s:!1,u.packed===void 0&&(d.packed=u.kind=="enum"||u.kind=="scalar"&&u.T!=I.BYTES&&u.T!=I.STRING),u.oneof!==void 0){const h=typeof u.oneof=="string"?u.oneof:u.oneof.name;(!l||l.name!=h)&&(l=new eT(h)),d.oneof=l,l.addField(d)}c.push(d)}return c}const P=WS("proto3",t=>new KS(t,e=>tT(e)),t=>{for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=xi(e.T,e.L);break}}});class it extends ih{constructor(e){super(),this.seconds=be.zero,this.nanos=0,P.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(P.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=be.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return it.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new it({seconds:be.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new it().fromBinary(e,n)}static fromJson(e,n){return new it().fromJson(e,n)}static fromJsonString(e,n){return new it().fromJsonString(e,n)}static equals(e,n){return P.util.equals(it,e,n)}}it.runtime=P;it.typeName="google.protobuf.Timestamp";it.fields=P.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const nT=P.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:it},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:rT,repeated:!0},{no:5,name:"events",kind:"message",T:aT,repeated:!0}]),rT=P.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:iT,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),iT=P.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:it},{no:3,name:"value",kind:"scalar",T:2}]),aT=P.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:it},{no:7,name:"normalized_end_timestamp",kind:"message",T:it,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),K0=P.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),Ft=P.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Ie=P.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),ui=P.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),ra=P.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Va=P.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),zt=P.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),Fr=P.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),oT=P.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Xt=P.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),oh=P.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ds,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:ab}]),Ds=P.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),sT=P.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:P.getEnumType(Ie),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Ha=P.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(fu)},{no:4,name:"tracks",kind:"message",T:ti,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:sT},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:P.getEnumType(js)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:P.getEnumType(zt)},{no:18,name:"kind_details",kind:"enum",T:P.getEnumType(cT),repeated:!0}]),fu=P.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),js=P.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),cT=P.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),ht=P.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),lT=P.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:kr,repeated:!0}]),ti=P.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:P.getEnumType(Ft)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:P.getEnumType(Ie)},{no:10,name:"layers",kind:"message",T:kr,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:lT,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:P.getEnumType(ht)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:ab},{no:19,name:"audio_features",kind:"enum",T:P.getEnumType(Xt),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:P.getEnumType(K0)}]),kr=P.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(ui)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),nt=P.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:P.getEnumType(te)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:Z0,oneof:"value"},{no:3,name:"speaker",kind:"message",T:uT,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Q0,oneof:"value"},{no:7,name:"transcription",kind:"message",T:dT,oneof:"value"},{no:8,name:"metrics",kind:"message",T:nT,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:mu,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:J0,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:Y0,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:X0,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:vu,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:bu,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:yu,oneof:"value"}]),te=P.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),uT=P.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:G0,repeated:!0}]),G0=P.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),Z0=P.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Q0=P.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),dT=P.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:hT,repeated:!0}]),hT=P.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),mu=P.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),J0=P.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),Y0=P.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),X0=P.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:eb,oneof:"value"}]),eb=P.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),tb=P.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),pT=P.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:P.getEnumType(nb)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),nb=P.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),fT=P.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:P.getEnumType(rb)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),rb=P.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),ib=P.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Tf},{no:2,name:"screen",kind:"message",T:Tf},{no:3,name:"resume_connection",kind:"enum",T:P.getEnumType(Va)},{no:4,name:"disabled_codecs",kind:"message",T:mT},{no:5,name:"force_relay",kind:"enum",T:P.getEnumType(Va)}]),Tf=P.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:P.getEnumType(Va)}]),mT=P.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Ds,repeated:!0},{no:2,name:"publish",kind:"message",T:Ds,repeated:!0}]),ab=P.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),gu=P.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),ob=P.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:P.getEnumType(gu)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),sb=P.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),vu=P.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:P.getEnumType(ht)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:ob,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:sb,oneof:"content_header"}],{localName:"DataStream_Header"}),bu=P.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),yu=P.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),Bt=P.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),ku=P.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),gT=P.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),vT=P.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Rr,oneof:"message"},{no:2,name:"answer",kind:"message",T:Rr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:sh,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Cu,oneof:"message"},{no:5,name:"mute",kind:"message",T:ch,oneof:"message"},{no:6,name:"subscription",kind:"message",T:mc,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:cb,oneof:"message"},{no:8,name:"leave",kind:"message",T:gc,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:ub,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:fb,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:mb,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Zt,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:db,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:vb,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:lb,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:CT,oneof:"message"}]),xf=P.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:bT,oneof:"message"},{no:2,name:"answer",kind:"message",T:Rr,oneof:"message"},{no:3,name:"offer",kind:"message",T:Rr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:sh,oneof:"message"},{no:5,name:"update",kind:"message",T:wT,oneof:"message"},{no:6,name:"track_published",kind:"message",T:lh,oneof:"message"},{no:8,name:"leave",kind:"message",T:gc,oneof:"message"},{no:9,name:"mute",kind:"message",T:ch,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:ST,oneof:"message"},{no:11,name:"room_update",kind:"message",T:TT,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:ET,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:RT,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:_T,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:OT,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:kT,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:yT,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:NT,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:DT,oneof:"message"},{no:22,name:"request_response",kind:"message",T:jT,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:AT,oneof:"message"}]),wu=P.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),Cu=P.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:P.getEnumType(Ft)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:P.getEnumType(Ie)},{no:9,name:"layers",kind:"message",T:kr,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:wu,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:P.getEnumType(ht)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:P.getEnumType(K0)}]),sh=P.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:P.getEnumType(Bt)},{no:3,name:"final",kind:"scalar",T:8}]),ch=P.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),bT=P.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:oh},{no:2,name:"participant",kind:"message",T:Ha},{no:3,name:"other_participants",kind:"message",T:Ha,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:hb,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:ib},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:pT},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Ds,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),yT=P.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:hb,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:ib}]),lh=P.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ti}]),kT=P.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Rr=P.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),wT=P.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Ha,repeated:!0}]),mc=P.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:tb,repeated:!0}]),cb=P.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:P.getEnumType(ui)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),lb=P.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:P.getEnumType(Xt),repeated:!0}]),CT=P.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),gc=P.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:P.getEnumType(zt)},{no:3,name:"action",kind:"enum",T:P.getEnumType(di)},{no:4,name:"regions",kind:"message",T:LT}]),di=P.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),ub=P.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:kr,repeated:!0}]),db=P.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),hb=P.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),ST=P.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:G0,repeated:!0}]),TT=P.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:oh}]),xT=P.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:P.getEnumType(ra)},{no:3,name:"score",kind:"scalar",T:2}]),ET=P.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:xT,repeated:!0}]),PT=P.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(ku)}]),RT=P.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:PT,repeated:!0}]),uh=P.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(ui)},{no:2,name:"enabled",kind:"scalar",T:8}]),IT=P.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:uh,repeated:!0}]),_T=P.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:uh,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:IT,repeated:!0}]),pb=P.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),fb=P.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:pb,repeated:!0}]),OT=P.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),mb=P.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Rr},{no:2,name:"subscription",kind:"message",T:mc},{no:3,name:"publish_tracks",kind:"message",T:lh,repeated:!0},{no:4,name:"data_channels",kind:"message",T:gb,repeated:!0},{no:5,name:"offer",kind:"message",T:Rr},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),gb=P.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:P.getEnumType(Bt)}]),Zt=P.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:P.getEnumType(gT),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),vb=P.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),NT=P.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),LT=P.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:MT,repeated:!0}]),MT=P.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),DT=P.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:P.getEnumType(oT)}]),jT=P.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:P.getEnumType(dh)},{no:3,name:"message",kind:"scalar",T:9}]),dh=P.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),AT=P.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function UT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Su={exports:{}},FT=Su.exports,Ef;function BT(){return Ef||(Ef=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(FT,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],a={},o=null;function s(k,S){var g=k[S];if(typeof g.bind=="function")return g.bind(k);try{return Function.prototype.bind.call(g,k)}catch{return function(){return Function.prototype.apply.apply(g,[k,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(k){return k==="debug"&&(k="log"),typeof console===n?!1:k==="trace"&&r?c:console[k]!==void 0?s(console,k):console.log!==void 0?s(console,"log"):e}function u(){for(var k=this.getLevel(),S=0;S<i.length;S++){var g=i[S];this[g]=S<k?e:this.methodFactory(g,k,this.name)}if(this.log=this.debug,typeof console===n&&k<this.levels.SILENT)return"No console available for logging"}function d(k){return function(){typeof console!==n&&(u.call(this),this[k].apply(this,arguments))}}function h(k,S,g){return l(k)||d.apply(this,arguments)}function f(k,S){var g=this,b,p,m,w="loglevel";typeof k=="string"?w+=":"+k:typeof k=="symbol"&&(w=void 0);function T(U){var W=(i[U]||"silent").toUpperCase();if(!(typeof window===n||!w)){try{window.localStorage[w]=W;return}catch{}try{window.document.cookie=encodeURIComponent(w)+"="+W+";"}catch{}}}function x(){var U;if(!(typeof window===n||!w)){try{U=window.localStorage[w]}catch{}if(typeof U===n)try{var W=window.document.cookie,q=encodeURIComponent(w),R=W.indexOf(q+"=");R!==-1&&(U=/^([^;]+)/.exec(W.slice(R+q.length+1))[1])}catch{}return g.levels[U]===void 0&&(U=void 0),U}}function E(){if(!(typeof window===n||!w)){try{window.localStorage.removeItem(w)}catch{}try{window.document.cookie=encodeURIComponent(w)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function O(U){var W=U;if(typeof W=="string"&&g.levels[W.toUpperCase()]!==void 0&&(W=g.levels[W.toUpperCase()]),typeof W=="number"&&W>=0&&W<=g.levels.SILENT)return W;throw new TypeError("log.setLevel() called with invalid level: "+U)}g.name=k,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=S||h,g.getLevel=function(){return m??p??b},g.setLevel=function(U,W){return m=O(U),W!==!1&&T(m),u.call(g)},g.setDefaultLevel=function(U){p=O(U),x()||g.setLevel(U,!1)},g.resetLevel=function(){m=null,E(),u.call(g)},g.enableAll=function(U){g.setLevel(g.levels.TRACE,U)},g.disableAll=function(U){g.setLevel(g.levels.SILENT,U)},g.rebuild=function(){if(o!==g&&(b=O(o.getLevel())),u.call(g),o===g)for(var U in a)a[U].rebuild()},b=O(o?o.getLevel():"WARN");var N=x();N!=null&&(m=O(N)),u.call(g)}o=new f,o.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var S=a[k];return S||(S=a[k]=new f(k,o.methodFactory)),S};var v=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=v),o},o.getLoggers=function(){return a},o.default=o,o})}(Su)),Su.exports}var vc=BT(),Tu;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(Tu||(Tu={}));var $t;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})($t||($t={}));let X=vc.getLogger("livekit");Object.values($t).map(t=>vc.getLogger(t));X.setDefaultLevel(Tu.info);function wn(t){const e=vc.getLogger(t);return e.setDefaultLevel(X.getLevel()),e}const zT=vc.getLogger("lk-e2ee"),Wi=7e3,VT=[0,300,2*2*300,3*3*300,4*4*300,Wi,Wi,Wi,Wi,Wi];class HT{constructor(e){this._retryDelays=e!==void 0?[...e]:VT}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function qT(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function C(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?a(u.value):i(u.value).then(s,c)}l((r=r.apply(t,e||[])).next())})}function Pf(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ln(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Pf=="function"?Pf(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=t[a]&&function(o){return new Promise(function(s,c){o=t[a](o),i(s,c,o.done,o.value)})}}function i(a,o,s,c){Promise.resolve(c).then(function(l){a({value:l,done:s})},o)}}var xo={exports:{}},Rf;function $T(){if(Rf)return xo.exports;Rf=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(m,w,T){return Function.prototype.apply.call(m,w,T)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:n=function(m){return Object.getOwnPropertyNames(m)};function r(m){console&&console.warn&&console.warn(m)}var i=Number.isNaN||function(m){return m!==m};function a(){a.init.call(this)}xo.exports=a,xo.exports.once=g,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(m){if(typeof m!="number"||m<0||i(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");o=m}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||i(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this};function c(m){return m._maxListeners===void 0?a.defaultMaxListeners:m._maxListeners}a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(m){for(var w=[],T=1;T<arguments.length;T++)w.push(arguments[T]);var x=m==="error",E=this._events;if(E!==void 0)x=x&&E.error===void 0;else if(!x)return!1;if(x){var O;if(w.length>0&&(O=w[0]),O instanceof Error)throw O;var N=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw N.context=O,N}var U=E[m];if(U===void 0)return!1;if(typeof U=="function")e(U,this,w);else for(var W=U.length,q=v(U,W),T=0;T<W;++T)e(q[T],this,w);return!0};function l(m,w,T,x){var E,O,N;if(s(T),O=m._events,O===void 0?(O=m._events=Object.create(null),m._eventsCount=0):(O.newListener!==void 0&&(m.emit("newListener",w,T.listener?T.listener:T),O=m._events),N=O[w]),N===void 0)N=O[w]=T,++m._eventsCount;else if(typeof N=="function"?N=O[w]=x?[T,N]:[N,T]:x?N.unshift(T):N.push(T),E=c(m),E>0&&N.length>E&&!N.warned){N.warned=!0;var U=new Error("Possible EventEmitter memory leak detected. "+N.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");U.name="MaxListenersExceededWarning",U.emitter=m,U.type=w,U.count=N.length,r(U)}return m}a.prototype.addListener=function(m,w){return l(this,m,w,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(m,w){return l(this,m,w,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(m,w,T){var x={fired:!1,wrapFn:void 0,target:m,type:w,listener:T},E=u.bind(x);return E.listener=T,x.wrapFn=E,E}a.prototype.once=function(m,w){return s(w),this.on(m,d(this,m,w)),this},a.prototype.prependOnceListener=function(m,w){return s(w),this.prependListener(m,d(this,m,w)),this},a.prototype.removeListener=function(m,w){var T,x,E,O,N;if(s(w),x=this._events,x===void 0)return this;if(T=x[m],T===void 0)return this;if(T===w||T.listener===w)--this._eventsCount===0?this._events=Object.create(null):(delete x[m],x.removeListener&&this.emit("removeListener",m,T.listener||w));else if(typeof T!="function"){for(E=-1,O=T.length-1;O>=0;O--)if(T[O]===w||T[O].listener===w){N=T[O].listener,E=O;break}if(E<0)return this;E===0?T.shift():k(T,E),T.length===1&&(x[m]=T[0]),x.removeListener!==void 0&&this.emit("removeListener",m,N||w)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(m){var w,T,x;if(T=this._events,T===void 0)return this;if(T.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):T[m]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete T[m]),this;if(arguments.length===0){var E=Object.keys(T),O;for(x=0;x<E.length;++x)O=E[x],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(w=T[m],typeof w=="function")this.removeListener(m,w);else if(w!==void 0)for(x=w.length-1;x>=0;x--)this.removeListener(m,w[x]);return this};function h(m,w,T){var x=m._events;if(x===void 0)return[];var E=x[w];return E===void 0?[]:typeof E=="function"?T?[E.listener||E]:[E]:T?S(E):v(E,E.length)}a.prototype.listeners=function(m){return h(this,m,!0)},a.prototype.rawListeners=function(m){return h(this,m,!1)},a.listenerCount=function(m,w){return typeof m.listenerCount=="function"?m.listenerCount(w):f.call(m,w)},a.prototype.listenerCount=f;function f(m){var w=this._events;if(w!==void 0){var T=w[m];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function v(m,w){for(var T=new Array(w),x=0;x<w;++x)T[x]=m[x];return T}function k(m,w){for(;w+1<m.length;w++)m[w]=m[w+1];m.pop()}function S(m){for(var w=new Array(m.length),T=0;T<w.length;++T)w[T]=m[T].listener||m[T];return w}function g(m,w){return new Promise(function(T,x){function E(N){m.removeListener(w,O),x(N)}function O(){typeof m.removeListener=="function"&&m.removeListener("error",E),T([].slice.call(arguments))}p(m,w,O,{once:!0}),w!=="error"&&b(m,E,{once:!0})})}function b(m,w,T){typeof m.on=="function"&&p(m,"error",w,T)}function p(m,w,T,x){if(typeof m.on=="function")x.once?m.once(w,T):m.on(w,T);else if(typeof m.addEventListener=="function")m.addEventListener(w,function E(O){x.once&&m.removeEventListener(w,E),T(O)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m)}return xo.exports}var on=$T();let bb=!0,yb=!0;function Go(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function Lr(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,s){if(o!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(s.handleEvent?s.handleEvent(u):s(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,c),i.apply(this,[o,c])};const a=r.removeEventListener;r.removeEventListener=function(o,s){if(o!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(s))return a.apply(this,arguments);const c=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[o,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function WT(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(bb=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function KT(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(yb=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function kb(){if(typeof window=="object"){if(bb)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function hh(t,e){yb&&console.warn(t+" is deprecated, please use "+e+" instead.")}function GT(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=Go(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Go(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Go(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function If(t){return Object.prototype.toString.call(t)==="[object Object]"}function wb(t){return If(t)?Object.keys(t).reduce(function(e,n){const r=If(t[n]),i=r?wb(t[n]):t[n],a=r&&!Object.keys(i).length;return i===void 0||a?e:Object.assign(e,{[n]:i})},{}):t}function xu(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?xu(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{xu(t,t.get(i),n)})}))}function _f(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const a=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&a.push(o)}),a.forEach(o=>{t.forEach(s=>{s.type===r&&s.trackId===o.id&&xu(t,s,i)})}),i}const Of=kb;function Cb(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const c={};return Object.keys(s).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof s[l]=="object"?s[l]:{ideal:s[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(h,f){return h?h+f.charAt(0).toUpperCase()+f.slice(1):f==="deviceId"?"sourceId":f};if(u.ideal!==void 0){c.optional=c.optional||[];let h={};typeof u.ideal=="number"?(h[d("min",l)]=u.ideal,c.optional.push(h),h={},h[d("max",l)]=u.ideal,c.optional.push(h)):(h[d("",l)]=u.ideal,c.optional.push(h))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(h=>{u[h]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(h,l)]=u[h])})}),s.advanced&&(c.optional=(c.optional||[]).concat(s.advanced)),c},i=function(s,c){if(e.version>=61)return c(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const l=function(u,d,h){d in u&&!(h in u)&&(u[h]=u[d],delete u[d])};s=JSON.parse(JSON.stringify(s)),l(s.audio,"autoGainControl","googAutoGainControl"),l(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=r(s.audio)}if(s&&typeof s.video=="object"){let l=s.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete s.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(h=>{h=h.filter(v=>v.kind==="videoinput");let f=h.find(v=>d.some(k=>v.label.toLowerCase().includes(k)));return!f&&h.length&&d.includes("back")&&(f=h[h.length-1]),f&&(s.video.deviceId=l.exact?{exact:f.deviceId}:{ideal:f.deviceId}),s.video=r(s.video),Of("chrome: "+JSON.stringify(s)),c(s)})}s.video=r(s.video)}return Of("chrome: "+JSON.stringify(s)),c(s)},a=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(s,c,l){i(s,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(a(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>s(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(a(u))))}}}function Sb(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Tb(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",r=>{let i;t.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(o=>o.track&&o.track.id===r.track.id):i={track:r.track};const a=new Event("track");a.track=r.track,a.receiver=i,a.transceiver={receiver:i},a.streams=[n.stream],this.dispatchEvent(a)}),n.stream.getTracks().forEach(r=>{let i;t.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(o=>o.track&&o.track.id===r.id):i={track:r};const a=new Event("track");a.track=r,a.receiver=i,a.transceiver={receiver:i},a.streams=[n.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Lr(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function xb(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=i.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,s){let c=i.apply(this,arguments);return c||(c=e(this,o),this._senders.push(c)),c};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){a.apply(this,arguments);const s=this._senders.indexOf(o);s!==-1&&this._senders.splice(s,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(i){this._senders=this._senders||[],n.apply(this,[i]),i.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(i){this._senders=this._senders||[],r.apply(this,[i]),i.getTracks().forEach(a=>{const o=this._senders.find(s=>s.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(r=>r._pc=this),n},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Eb(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=n.apply(this,[]);return i.forEach(a=>a._pc=this),i});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){const i=this;return this._pc.getStats().then(a=>_f(a,i.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Lr(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(i=>_f(i,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const n=arguments[0];let r,i,a;return this.getSenders().forEach(o=>{o.track===n&&(r?a=!0:r=o)}),this.getReceivers().forEach(o=>(o.track===n&&(i?a=!0:i=o),o.track===n)),a||r&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Pb(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const s=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(s)===-1&&this._shimmedLocalStreams[o.id].push(s):this._shimmedLocalStreams[o.id]=[o,s],s};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(c=>{if(this.getSenders().find(l=>l.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();n.apply(this,arguments);const s=this.getSenders().filter(c=>o.indexOf(c)===-1);this._shimmedLocalStreams[a.id]=[a].concat(s)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const s=this._shimmedLocalStreams[o].indexOf(a);s!==-1&&this._shimmedLocalStreams[o].splice(s,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),i.apply(this,arguments)}}function Rb(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Pb(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const l=n.apply(this);return this._reverseStreams=this._reverseStreams||{},l.map(u=>this._reverseStreams[u.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.getTracks().forEach(u=>{if(this.getSenders().find(d=>d.track===u))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[l.id]){const u=new t.MediaStream(l.getTracks());this._streams[l.id]=u,this._reverseStreams[u.id]=l,l=u}r.apply(this,[l])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[l.id]||l]),delete this._reverseStreams[this._streams[l.id]?this._streams[l.id].id:l.id],delete this._streams[l.id]},t.RTCPeerConnection.prototype.addTrack=function(l,u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(f=>f===l))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(f=>f.track===l))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[u.id];if(h)h.addTrack(l),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const f=new t.MediaStream([l]);this._streams[u.id]=f,this._reverseStreams[f.id]=u,this.addStream(f)}return this.getSenders().find(f=>f.track===l)};function a(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const f=l._reverseStreams[h],v=l._streams[f.id];d=d.replace(new RegExp(v.id,"g"),f.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const f=l._reverseStreams[h],v=l._streams[f.id];d=d.replace(new RegExp(f.id,"g"),v.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[f=>{const v=a(this,f);h[0].apply(null,[v])},f=>{h[1]&&h[1].apply(null,f)},arguments[2]]):u.apply(this,arguments).then(f=>a(this,f))}};t.RTCPeerConnection.prototype[l]=d[l]});const s=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=o(this,arguments[0]),s.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:a(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(l){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!l._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(l._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let u;Object.keys(this._streams).forEach(d=>{this._streams[d].getTracks().find(h=>l.track===h)&&(u=this._streams[d])}),u&&(u.getTracks().length===1?this.removeStream(this._reverseStreams[u.id]):u.removeTrack(l.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Eu(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Ib(t,e){Lr(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var Nf=Object.freeze({__proto__:null,fixNegotiationNeeded:Ib,shimAddTrackRemoveTrack:Rb,shimAddTrackRemoveTrackWithNative:Pb,shimGetSendersWithDtmf:xb,shimGetUserMedia:Cb,shimMediaStream:Sb,shimOnTrack:Tb,shimPeerConnection:Eu,shimSenderReceiverGetStats:Eb});function _b(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,a,o){hh("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(a,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,s,c){s in o&&!(c in o)&&(o[c]=o[s],delete o[s])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),a(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const s=o.apply(this,arguments);return i(s,"mozAutoGainControl","autoGainControl"),i(s,"mozNoiseSuppression","noiseSuppression"),s}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s,"autoGainControl","mozAutoGainControl"),i(s,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[s])}}}}function ZT(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(n)})}function Ob(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Pu(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=t.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,a,o]=arguments;return r.apply(this,[i||null]).then(s=>{if(e.version<53&&!a)try{s.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;s.forEach((l,u)=>{s.set(u,Object.assign({},l,{type:n[l.type]||l.type}))})}return s}).then(a,o)}}function Nb(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Lb(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(r=>r._pc=this),n}),Lr(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Mb(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(e){hh("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&e.getTracks().includes(n.track)&&this.removeTrack(n)})})}function Db(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function jb(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const r=n.length>0;r&&n.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=e.apply(this,arguments);if(r){const{sender:a}=i,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=n,a.sendEncodings=n,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return i})}function Ab(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function Ub(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Fb(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Lf=Object.freeze({__proto__:null,shimAddTransceiver:jb,shimCreateAnswer:Fb,shimCreateOffer:Ub,shimGetDisplayMedia:ZT,shimGetParameters:Ab,shimGetUserMedia:_b,shimOnTrack:Ob,shimPeerConnection:Pu,shimRTCDataChannel:Db,shimReceiverGetStats:Lb,shimRemoveStream:Mb,shimSenderGetStats:Nb});function Bb(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(r=>e.call(this,r,n)),n.getVideoTracks().forEach(r=>e.call(this,r,n))},t.RTCPeerConnection.prototype.addTrack=function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i&&i.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(e);if(n===-1)return;this._localStreams.splice(n,1);const r=e.getTracks();this.getSenders().forEach(i=>{r.includes(i.track)&&this.removeTrack(i)})})}}function zb(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,this.dispatchEvent(a)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(i=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(i)>=0)return;n._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,n.dispatchEvent(a)})}),e.apply(n,arguments)}}}function Vb(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,a=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(c,l){const u=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[u]);return l?(d.then(c,l),Promise.resolve()):d},e.createAnswer=function(c,l){const u=arguments.length>=2?arguments[2]:arguments[0],d=r.apply(this,[u]);return l?(d.then(c,l),Promise.resolve()):d};let s=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=s,s=function(c,l,u){const d=a.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=s,s=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=s}function Hb(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(qb(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,r,i){e.mediaDevices.getUserMedia(n).then(r,i)}).bind(e))}function qb(t){return t&&t.video!==void 0?Object.assign({},t,{video:wb(t.video)}):t}function $b(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(n,r){if(n&&n.iceServers){const i=[];for(let a=0;a<n.iceServers.length;a++){let o=n.iceServers[a];o.urls===void 0&&o.url?(hh("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,i.push(o)):i.push(n.iceServers[a])}n.iceServers=i}return new e(n,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Wb(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Kb(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const r=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):n.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveVideo===!0&&!i&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Gb(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var Mf=Object.freeze({__proto__:null,shimAudioContext:Gb,shimCallbacksAPI:Vb,shimConstraints:qb,shimCreateOfferLegacy:Kb,shimGetUserMedia:Hb,shimLocalStreamsAPI:Bb,shimRTCIceServerUrls:$b,shimRemoteStreamsAPI:zb,shimTrackEventTransceiver:Wb}),Df={exports:{}},jf;function QT(){return jf||(jf=1,function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,i)=>(i>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let a=8;a<r.length;a+=2)switch(r[a]){case"raddr":i.relatedAddress=r[a+1];break;case"rport":i.relatedPort=parseInt(r[a+1],10);break;case"tcptype":i.tcpType=r[a+1];break;case"ufrag":i.ufrag=r[a+1],i.usernameFragment=r[a+1];break;default:i[r[a]]===void 0&&(i[r[a]]=r[a+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const a=n.type;return r.push("typ"),r.push(a),a!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const a=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<a.length;o++)i=a[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const a=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?a.push(o+"="+n.parameters[o]):a.push(o)}),r+="a=fmtp:"+i+" "+a.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(a=>{r+="a=rtcp-fb:"+i+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},a=n.indexOf(":",r);return a>-1?(i.attribute=n.substring(r+1,a),i.value=n.substring(a+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(a=>{i+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],a=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&a?{usernameFragment:i.substring(12),password:a.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=e.splitLines(n)[0].split(" ");r.profile=i[2];for(let o=3;o<i.length;o++){const s=i[o],c=e.matchPrefix(n,"a=rtpmap:"+s+" ")[0];if(c){const l=e.parseRtpMap(c),u=e.matchPrefix(n,"a=fmtp:"+s+" ");switch(l.parameters=u.length?e.parseFmtp(u[0]):{},l.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+s+" ").map(e.parseRtcpFb),r.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(l.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(o=>{r.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(o=>{a.forEach(s=>{o.rtcpFeedback.find(c=>c.type===s.type&&c.parameter===s.parameter)||o.rtcpFeedback.push(s)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let a=0;return r.codecs.forEach(o=>{o.maxptime>a&&(a=o.maxptime)}),a>0&&(i+="a=maxptime:"+a+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),a=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(n,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),c=s.length>0&&s[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(f=>parseInt(f,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let f={ssrc:c,codecPayloadType:parseInt(h.parameters.apt,10)};c&&l&&(f.rtx={ssrc:l}),r.push(f),a&&(f=JSON.parse(JSON.stringify(f)),f.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(f))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(h=>{h.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const a=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=a.length>0,r.compound=a.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const a=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(a.length>0)return r=a[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let a;i.length>0&&(a=parseInt(i[0].substring(19),10)),isNaN(a)&&(a=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:a};const s=e.matchPrefix(n,"a=sctpmap:");if(s.length>0){const c=s[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:a}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let a;const o=r!==void 0?r:2;return n?a=n:a=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+a+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let a=0;a<i.length;a++)switch(i[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[a].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e}(Df)),Df.exports}var Zb=QT(),hi=UT(Zb),JT=uS({__proto__:null,default:hi},[Zb]);function Zo(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){const r=new e(n),i=hi.parseCandidate(n.candidate);for(const a in i)a in r||Object.defineProperty(r,a,{value:i[a]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(n)},t.RTCIceCandidate.prototype=e.prototype,Lr(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Ru(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Lr(t,"icecandidate",e=>{if(e.candidate){const n=hi.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Qo(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(s){if(!s||!s.sdp)return!1;const c=hi.splitSections(s.sdp);return c.shift(),c.some(l=>{const u=hi.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(s){const c=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(s){let c=65536;return e.browser==="firefox"&&(e.version<57?s===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},a=function(s,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=hi.matchPrefix(s.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:s}=this.getConfiguration();s==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const s=r(arguments[0]),c=i(s),l=a(arguments[0],s);let u;c===0&&l===0?u=Number.POSITIVE_INFINITY:c===0||l===0?u=Math.max(c,l):u=Math.min(c,l);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return u}}),this._sctp=d}return o.apply(this,arguments)}}function Jo(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const a=r.send;r.send=function(){const o=arguments[0],s=o.length||o.size||o.byteLength;if(r.readyState==="open"&&i.sctp&&s>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return a.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},Lr(t,"datachannel",r=>(e(r.channel,r.target),r))}function Iu(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const a=i.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const o=new Event("connectionstatechange",i);a.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function _u(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const i=r.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:i}):r.sdp=i}return n.apply(this,arguments)}}function Yo(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Xo(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(i=>n.apply(this,[i]))})}var YT=Object.freeze({__proto__:null,removeExtmapAllowMixed:_u,shimAddIceCandidateNullOrEmpty:Yo,shimConnectionState:Iu,shimMaxMessageSize:Qo,shimParameterlessSetLocalDescription:Xo,shimRTCIceCandidate:Zo,shimRTCIceCandidateRelayProtocol:Ru,shimSendThrowTypeError:Jo});function XT(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=kb,r=GT(t),i={browserDetails:r,commonShim:YT,extractVersion:Go,disableLog:WT,disableWarnings:KT,sdp:JT};switch(r.browser){case"chrome":if(!Nf||!Eu||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Nf,Yo(t,r),Xo(t),Cb(t,r),Sb(t),Eu(t,r),Tb(t),Rb(t,r),xb(t),Eb(t),Ib(t,r),Zo(t),Ru(t),Iu(t),Qo(t,r),Jo(t),_u(t,r);break;case"firefox":if(!Lf||!Pu||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Lf,Yo(t,r),Xo(t),_b(t,r),Pu(t,r),Ob(t),Mb(t),Nb(t),Lb(t),Db(t),jb(t),Ab(t),Ub(t),Fb(t),Zo(t),Iu(t),Qo(t,r),Jo(t);break;case"safari":if(!Mf||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=Mf,Yo(t,r),Xo(t),$b(t),Kb(t),Vb(t),Bb(t),zb(t),Wb(t),Hb(t),Gb(t),Zo(t),Ru(t),Qo(t,r),Jo(t),_u(t,r);break;default:n("Unsupported browser!");break}return i}XT({window:typeof window>"u"?void 0:window});const e2=10,Eo="lk_e2ee",t2="LKFrameEncryptionKey",n2={sharedKey:!1,ratchetSalt:t2,ratchetWindowSize:8,failureTolerance:e2,keyringSize:16};var Kn;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(Kn||(Kn={}));var Af;(function(t){t.KeyRatcheted="keyRatcheted"})(Af||(Af={}));var Un;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Un||(Un={}));var Uf;(function(t){t.Error="cryptorError"})(Uf||(Uf={}));function r2(){return i2()||Ou()}function Ou(){return typeof window.RTCRtpScriptTransform<"u"}function i2(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class E3 extends on.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{X.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},n2),e),this.on(Kn.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(Kn.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(Kn.RatchetRequest,e,n)}}class nr extends Error{constructor(e,n){super(n||"an error has occured"),this.name="LiveKitError",this.code=e}}var ee;(function(t){t[t.NotAllowed=0]="NotAllowed",t[t.ServerUnreachable=1]="ServerUnreachable",t[t.InternalError=2]="InternalError",t[t.Cancelled=3]="Cancelled",t[t.LeaveRequest=4]="LeaveRequest"})(ee||(ee={}));class ue extends nr{constructor(e,n,r,i){super(1,e),this.name="ConnectionError",this.status=r,this.reason=n,this.context=i,this.reasonName=ee[n]}}class ph extends nr{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class hn extends nr{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class a2 extends nr{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class Oe extends nr{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Nu extends nr{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class o2 extends nr{constructor(e,n){super(15,e),this.name="PublishTrackError",this.status=n}}class Ff extends nr{constructor(e,n){super(15,e),this.reason=n,this.reasonName=typeof n=="string"?n:dh[n]}}var As;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(As||(As={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(As||(As={}));var Bf;(function(t){t[t.InvalidKey=0]="InvalidKey",t[t.MissingKey=1]="MissingKey",t[t.InternalError=2]="InternalError"})(Bf||(Bf={}));var M;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.ParticipantAttributesChanged="participantAttributesChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged",t.ChatMessage="chatMessage",t.LocalTrackSubscribed="localTrackSubscribed",t.MetricsReceived="metricsReceived"})(M||(M={}));var B;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded",t.AttributesChanged="attributesChanged",t.LocalTrackSubscribed="localTrackSubscribed",t.ChatMessage="chatMessage"})(B||(B={}));var F;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackSubscribed="localTrackSubscribed",t.Offline="offline",t.SignalRequestResponse="signalRequestResponse"})(F||(F={}));var j;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed",t.TrackProcessorUpdate="trackProcessorUpdate",t.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",t.TranscriptionReceived="transcriptionReceived",t.TimeSyncUpdate="timeSyncUpdate"})(j||(j={}));function s2(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const c2=/version\/(\d+(\.?_?\d+)+)/i;let nl;function Wt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(nl===void 0||e){const r=l2.find(i=>{let{test:a}=i;return a.test(n)});nl=r==null?void 0:r.describe(n)}return nl}const l2=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:es(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:rl(t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:es(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0,osVersion:rl(t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:es(c2,t),os:t.includes("mobile/")?"iOS":"macOS",osVersion:rl(t)}}}];function es(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}function rl(t){return t.includes("mac os")?es(/\(.+?(\d+_\d+(:?_\d+)?)/,t,1).replace(/_/g,"."):void 0}var u2="2.10.0";const d2=u2,h2=15;class ze{}ze.setTimeout=function(){return setTimeout(...arguments)};ze.setInterval=function(){return setInterval(...arguments)};ze.clearTimeout=function(){return clearTimeout(...arguments)};ze.clearInterval=function(){return clearInterval(...arguments)};const p2=5e3,Ki=[];var Tt;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH"})(Tt||(Tt={}));class _ extends on.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=_.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=X,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),p2):this.handleAppVisibilityChanged()},this.log=wn((i=r.loggerName)!==null&&i!==void 0?i:$t.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=_.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),ae(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===_.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===_.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(Ki.forEach(a=>{a.parentElement===null&&!e&&(e=a)}),e&&Ki.splice(Ki.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),ni(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(a=>a.kind==="audio");return e.play().then(()=>{this.emit(i?j.AudioPlaybackStarted:j.VideoPlaybackStarted)}).catch(a=>{a.name==="NotAllowedError"?this.emit(i?j.AudioPlaybackFailed:j.VideoPlaybackFailed,a):a.name==="AbortError"?X.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):X.warn("could not playback ".concat(i?"audio":"video"),a),i&&e&&r.some(o=>o.kind==="video")&&a.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(j.ElementAttached,e),e}detach(e){try{if(e){pi(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(j.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{pi(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(j.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=wn(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),Ki.forEach(r=>{r.parentElement||(n=!1)}),n&&Ki.push(e)}}handleAppVisibilityChanged(){return C(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===_.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){ot()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){ot()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function ni(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!Yn()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Yn()||Ei())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function pi(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return Ft.AUDIO;case e.Video:return Ft.VIDEO;default:return Ft.DATA}}t.kindToProto=i;function a(l){switch(l){case Ft.AUDIO:return e.Audio;case Ft.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=a;function o(l){switch(l){case n.Camera:return Ie.CAMERA;case n.Microphone:return Ie.MICROPHONE;case n.ScreenShare:return Ie.SCREEN_SHARE;case n.ScreenShareAudio:return Ie.SCREEN_SHARE_AUDIO;default:return Ie.UNKNOWN}}t.sourceToProto=o;function s(l){switch(l){case Ie.CAMERA:return n.Camera;case Ie.MICROPHONE:return n.Microphone;case Ie.SCREEN_SHARE:return n.ScreenShare;case Ie.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=s;function c(l){switch(l){case ku.ACTIVE:return r.Active;case ku.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(_||(_={}));class ce{constructor(e,n,r,i,a){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&r!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:r,maxFramerate:i,priority:a};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const f2=["vp8","h264"],m2=["vp8","h264","vp9","av1"];function g2(t){return!!f2.find(e=>e===t)}var zf;(function(t){t[t.PREFER_REGRESSION=0]="PREFER_REGRESSION",t[t.SIMULCAST=1]="SIMULCAST",t[t.REGRESSION=2]="REGRESSION"})(zf||(zf={}));var Lu;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:24e3},t.music={maxBitrate:48e3},t.musicStereo={maxBitrate:64e3},t.musicHighQuality={maxBitrate:96e3},t.musicHighQualityStereo={maxBitrate:128e3}})(Lu||(Lu={}));const qa={h90:new ce(160,90,9e4,20),h180:new ce(320,180,16e4,20),h216:new ce(384,216,18e4,20),h360:new ce(640,360,45e4,20),h540:new ce(960,540,8e5,25),h720:new ce(1280,720,17e5,30),h1080:new ce(1920,1080,3e6,30),h1440:new ce(2560,1440,5e6,30),h2160:new ce(3840,2160,8e6,30)},Mu={h120:new ce(160,120,7e4,20),h180:new ce(240,180,125e3,20),h240:new ce(320,240,14e4,20),h360:new ce(480,360,33e4,20),h480:new ce(640,480,5e5,20),h540:new ce(720,540,6e5,25),h720:new ce(960,720,13e5,30),h1080:new ce(1440,1080,23e5,30),h1440:new ce(1920,1440,38e5,30)},fh={h360fps3:new ce(640,360,2e5,3,"medium"),h360fps15:new ce(640,360,4e5,15,"medium"),h720fps5:new ce(1280,720,8e5,5,"medium"),h720fps15:new ce(1280,720,15e5,15,"medium"),h720fps30:new ce(1280,720,2e6,30,"medium"),h1080fps15:new ce(1920,1080,25e5,15,"medium"),h1080fps30:new ce(1920,1080,5e6,30,"medium"),original:new ce(0,0,7e6,30,"medium")},v2="|",Vf="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function b2(t){const e=t.split(v2);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function ut(t){return C(this,void 0,void 0,function*(){return new Promise(e=>ze.setTimeout(e,t))})}function Du(){return"addTransceiver"in RTCPeerConnection.prototype}function ju(){return"addTrack"in RTCPeerConnection.prototype}function y2(){if(!("getCapabilities"in RTCRtpSender)||Yn())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function k2(){if(!("getCapabilities"in RTCRtpSender)||Ei())return!1;if(Yn()){const n=Wt();if(n!=null&&n.version&&Ir(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function va(t){return t==="av1"||t==="vp9"}function Au(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}function w2(){return typeof RTCPeerConnection>"u"?!1:Du()||ju()}function Ei(){var t;return((t=Wt())===null||t===void 0?void 0:t.name)==="Firefox"}function Yn(){var t;return((t=Wt())===null||t===void 0?void 0:t.name)==="Safari"}function C2(){const t=Wt();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function Qb(){var t,e;return ot()?(e=(t=navigator.userAgentData)===null||t===void 0?void 0:t.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function S2(){const t=Wt(),e="17.2";if(t)return t.name!=="Safari"&&t.os!=="iOS"||t.os==="iOS"&&t.osVersion&&Ir(e,t.osVersion)>=0?!0:t.name==="Safari"&&Ir(e,t.version)>=0}function ot(){return typeof document<"u"}function an(){return navigator.product=="ReactNative"}function Uu(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function Jb(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Yb(){if(!an())return;let t=Jb();if(t)return t.platform}function Hf(){if(ot())return window.devicePixelRatio;if(an()){let t=Jb();if(t)return t.devicePixelRatio}return 1}function Ir(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let a=0;a<i;++a){const o=parseInt(n[a],10),s=parseInt(r[a],10);if(o>s)return 1;if(o<s)return-1;if(a===i-1&&o===s)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function T2(t){for(const e of t)e.target.handleResize(e)}function x2(t){for(const e of t)e.target.handleVisibilityChanged(e)}let il=null;const qf=()=>(il||(il=new ResizeObserver(T2)),il);let al=null;const $f=()=>(al||(al=new IntersectionObserver(x2,{root:null,rootMargin:"0px"})),al);function E2(){var t;const e=new fT({sdk:rb.JS,protocol:h2,version:d2});return an()&&(e.os=(t=Yb())!==null&&t!==void 0?t:""),e}function Wf(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const a=i.getContext("2d");a==null||a.fillRect(0,0,i.width,i.height),r&&a&&(a.beginPath(),a.arc(t/2,e/2,50,0,Math.PI*2,!0),a.closePath(),a.fillStyle="grey",a.fill());const o=i.captureStream(),[s]=o.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}let Gi;function ol(){if(!Gi){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Gi]=r.stream.getAudioTracks(),!Gi)throw Error("Could not get empty media stream audio track");Gi.enabled=!1}return Gi.clone()}class Xb{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>C(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function P2(t){return m2.includes(t)}function Gn(t){if(typeof t=="string"||typeof t=="number")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function Fu(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}function R2(t,e){return t.segments.map(n=>{let{id:r,text:i,language:a,startTime:o,endTime:s,final:c}=n;var l;const u=(l=e.get(r))!==null&&l!==void 0?l:Date.now(),d=Date.now();return c?e.delete(r):e.set(r,u),{id:r,text:i,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(s.toString()),final:c,language:a,firstReceivedTime:u,lastReceivedTime:d}})}function I2(t){const{id:e,timestamp:n,message:r,editTimestamp:i}=t;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:i?Number.parseInt(i.toString()):void 0,message:r}}function Kf(t){switch(t.reason){case ee.LeaveRequest:return t.context;case ee.Cancelled:return zt.CLIENT_INITIATED;case ee.NotAllowed:return zt.USER_REJECTED;case ee.ServerUnreachable:return zt.JOIN_FAILURE;default:return zt.UNKNOWN_REASON}}function ts(t){return t!==void 0?Number(t):void 0}function ur(t){return t!==void 0?BigInt(t):void 0}function fi(t){return!!t&&!(t instanceof MediaStreamTrack)&&t.isLocal}function Cn(t){return!!t&&t.kind==_.Kind.Audio}function Li(t){return!!t&&t.kind==_.Kind.Video}function En(t){return fi(t)&&Li(t)}function dr(t){return fi(t)&&Cn(t)}function Bu(t){return!!t&&!t.isLocal}function _2(t){return!!t&&!t.isLocal}function sl(t){return Bu(t)&&Li(t)}function O2(t){return t.isLocal}function N2(t,e){const n=[];let r=new TextEncoder().encode(t);for(;r.length>e;){let i=e;for(;i>0;){const a=r[i];if(a!==void 0&&(a&192)!==128)break;i--}n.push(r.slice(0,i)),r=r.slice(i)}return r.length>0&&n.push(r),n}function ey(t,e,n){var r,i,a,o,s;const{optionsWithoutProcessor:c,audioProcessor:l,videoProcessor:u}=mh(t??{}),d=e==null?void 0:e.processor,h=n==null?void 0:n.processor,f=(r=s2(c))!==null&&r!==void 0?r:{};return f.audio===!0&&(f.audio={}),f.video===!0&&(f.video={}),f.audio&&(zu(f.audio,e),(i=(o=f.audio).deviceId)!==null&&i!==void 0||(o.deviceId="default"),(l||d)&&(f.audio.processor=l??d)),f.video&&(zu(f.video,n),(a=(s=f.video).deviceId)!==null&&a!==void 0||(s.deviceId="default"),(u||h)&&(f.video.processor=u??h)),f}function zu(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function bc(t){var e,n,r,i;const a={};if(t.video)if(typeof t.video=="object"){const o={},s=o,c=t.video;Object.keys(c).forEach(l=>{switch(l){case"resolution":zu(s,c.resolution);break;default:s[l]=c[l]}}),a.video=o,(e=(r=a.video).deviceId)!==null&&e!==void 0||(r.deviceId="default")}else a.video=t.video?{deviceId:"default"}:!1;else a.video=!1;return t.audio?typeof t.audio=="object"?(a.audio=t.audio,(n=(i=a.audio).deviceId)!==null&&n!==void 0||(i.deviceId="default")):a.audio={deviceId:"default"}:a.audio=!1,a}function ty(t){return C(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=ny();if(r){const i=r.createAnalyser();i.fftSize=2048;const a=i.frequencyBinCount,o=new Uint8Array(a);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield ut(n),i.getByteTimeDomainData(o);const s=o.some(c=>c!==128&&c!==0);return r.close(),!s}return!1}()})}function ny(){var t;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const n=new e({latencyHint:"interactive"});if(n.state==="suspended"&&typeof window<"u"&&!((t=window.document)===null||t===void 0)&&t.body){const r=()=>C(this,void 0,void 0,function*(){var i;try{n.state==="suspended"&&(yield n.resume())}catch(a){console.warn("Error trying to auto-resume audio context",a)}(i=window.document.body)===null||i===void 0||i.removeEventListener("click",r)});window.document.body.addEventListener("click",r)}return n}}function Gf(t){return t===_.Source.Microphone?"audioinput":t===_.Source.Camera?"videoinput":void 0}function L2(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Yn()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio,preferCurrentTab:t.preferCurrentTab}}function ns(t){return t.split("/")[1].toLowerCase()}function M2(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new lh({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function ae(t){return"mediaStreamTrack"in t?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?ae(t.track):{})}}function D2(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function j2(t,e){var n;t===void 0&&(t={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(t)],i={};for(const a of r)t[a]!==e[a]&&(i[a]=(n=e[a])!==null&&n!==void 0?n:"");return i}function mh(t){const e=Object.assign({},t);let n,r;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:r,optionsWithoutProcessor:e}}function A2(t){switch(t){case Ie.CAMERA:return _.Source.Camera;case Ie.MICROPHONE:return _.Source.Microphone;case Ie.SCREEN_SHARE:return _.Source.ScreenShare;case Ie.SCREEN_SHARE_AUDIO:return _.Source.ScreenShareAudio;default:return _.Source.Unknown}}class U2 extends on.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:a,data:o}=n.data;switch(a){case"error":X.error(o.error.message),this.emit(Un.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(s=>{this.postKey(s)});break;case"enable":if(o.enabled&&this.keyProvider.getKeys().forEach(s=>{this.postKey(s)}),this.encryptionEnabled!==o.enabled&&o.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Un.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const s=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(o.participantIdentity);if(!s)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(Un.ParticipantEncryptionStatusChanged,o.enabled,s)}break;case"ratchetKey":this.keyProvider.emit(Kn.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{X.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Un.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!r2())throw new ph("tried to setup end-to-end encryption on an unsupported browser");if(X.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:zT.getLevel()}};this.worker&&(X.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){X.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?X.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(F.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(M.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==ht.NONE,i.identity)),e.on(M.ConnectionStateChanged,r=>{r===re.Connected&&e.remoteParticipants.forEach(i=>{i.trackPublications.forEach(a=>{this.setParticipantCryptorEnabled(a.trackInfo.encryption!==ht.NONE,i.identity)})})}).on(M.TrackUnsubscribed,(r,i,a)=>{var o;const s={kind:"removeTransform",data:{participantIdentity:a.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(s)}).on(M.TrackSubscribed,(r,i,a)=>{this.setupE2EEReceiver(r,a.identity,i.trackInfo)}).on(M.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(B.LocalTrackPublished,r=>C(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(Kn.SetKey,r=>this.postKey(r)).on(Kn.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var a;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((a=this.room)===null||a===void 0?void 0:a.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?ns(r.mimeType):void 0)}}setupE2EESender(e,n){if(!fi(e)||!n){n||X.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return C(this,void 0,void 0,function*(){if(this.worker){if(Ou()){const a={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{if(Eo in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let a=e.writableStream,o=e.readableStream;if(!a||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,a=c.writable,e.readableStream=c.readable,o=c.readable}const s={kind:"decode",data:{readableStream:o,writableStream:a,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(s,[o,a])}e[Eo]=!0}})}handleSender(e,n,r){var i;if(!(Eo in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Ou()){X.info("initialize script transform");const a={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{X.info("initialize encoded streams");const a=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:a.readable,writableStream:a.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[a.readable,a.writable])}e[Eo]=!0}}}const cl="default";class je{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new je),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return C(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;if(((a=je.userMediaPromiseMap)===null||a===void 0?void 0:a.size)>0){X.debug("awaiting getUserMedia promise");try{n?yield je.userMediaPromiseMap.get(n):yield Promise.all(je.userMediaPromiseMap.values())}catch{X.warn("error waiting for media permissons")}}let o=yield navigator.mediaDevices.enumerateDevices();if(i&&!(Yn()&&r.hasDeviceInUse(n))&&(o.filter(s=>s.kind===n).length===0||o.some(s=>{const c=s.label==="",l=n?s.kind===n:!0;return c&&l}))){const s={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:"default"}},c=yield navigator.mediaDevices.getUserMedia(s);o=yield navigator.mediaDevices.enumerateDevices(),c.getTracks().forEach(l=>{l.stop()})}return r._previousDevices=o,n&&(o=o.filter(s=>s.kind===n)),o}()})}normalizeDeviceId(e,n,r){return C(this,void 0,void 0,function*(){if(n!==cl)return n;const i=yield this.getDevices(e),a=i.find(s=>s.deviceId===cl);if(!a){X.warn("could not reliably determine default device");return}const o=i.find(s=>s.deviceId!==cl&&s.groupId===(r??a.groupId));if(!o){X.warn("could not reliably determine default device");return}return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?je.userMediaPromiseMap.has(e):je.userMediaPromiseMap.size>0}}je.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];je.userMediaPromiseMap=new Map;var ba;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(ba||(ba={}));class F2{constructor(){this.pendingTasks=new Map,this.taskMutex=new mt,this.nextTaskIndex=0}run(e){return C(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:ba.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=ba.RUNNING,yield e()}finally{n.status=ba.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return C(this,void 0,void 0,function*(){return this.run(()=>C(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function B2(t,e){const n=new URL(t);return e.forEach((r,i)=>{n.searchParams.set(i,r)}),ry(n,"rtc")}function z2(t){const e=new URL(Fu(t));return ry(e,"validate")}function V2(t){return t.endsWith("/")?t:"".concat(t,"/")}function ry(t,e){const n="".concat(t.protocol,"//").concat(t.host).concat(V2(t.pathname)).concat(e);return t.searchParams.size>0?"".concat(n,"?").concat(t.searchParams.toString()):n}const H2=["syncState","trickle","offer","answer","simulate","leave"];function q2(t){const e=H2.indexOf(t.case)>=0;return X.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var me;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(me||(me={}));class gh{get currentState(){return this.state}get isDisconnected(){return this.state===me.DISCONNECTING||this.state===me.DISCONNECTED}get isEstablishingConnection(){return this.state===me.CONNECTING||this.state===me.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=me.DISCONNECTED,this.log=X,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=wn((r=n.loggerName)!==null&&r!==void 0?r:$t.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new F2,this.queuedRequests=[],this.closingLock=new mt,this.connectionLock=new mt,this.state=me.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return C(this,void 0,void 0,function*(){return this.state=me.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return C(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=me.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r;const a=E2(),o=$2(n,a,r),s=B2(e,o),c=z2(s);return new Promise((l,u)=>C(this,void 0,void 0,function*(){const d=yield this.connectionLock.lock();try{const h=()=>C(this,void 0,void 0,function*(){this.close(),clearTimeout(f),u(new ue("room connection has been cancelled (signal)",ee.Cancelled))}),f=setTimeout(()=>{this.close(),u(new ue("room connection has timed out (signal)",ee.ServerUnreachable))},r.websocketTimeout);i!=null&&i.aborted&&h(),i==null||i.addEventListener("abort",h);const v=new URL(s);v.searchParams.has("access_token")&&v.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(v),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(f)},this.ws.onerror=k=>C(this,void 0,void 0,function*(){if(this.state!==me.CONNECTED){this.state=me.DISCONNECTED,clearTimeout(f);try{const S=yield fetch(c);if(S.status.toFixed(0).startsWith("4")){const g=yield S.text();u(new ue(g,ee.NotAllowed,S.status))}else u(new ue("Encountered unknown websocket error during connection: ".concat(k.toString()),ee.InternalError,S.status))}catch(S){u(new ue(S instanceof Error?S.message:"server was not reachable",ee.ServerUnreachable))}return}this.handleWSError(k)}),this.ws.onmessage=k=>C(this,void 0,void 0,function*(){var S,g,b;let p;if(typeof k.data=="string"){const m=JSON.parse(k.data);p=xf.fromJson(m,{ignoreUnknownFields:!0})}else if(k.data instanceof ArrayBuffer)p=xf.fromBinary(new Uint8Array(k.data));else{this.log.error("could not decode websocket message: ".concat(typeof k.data),this.logContext);return}if(this.state!==me.CONNECTED){let m=!1;if(((S=p.message)===null||S===void 0?void 0:S.case)==="join"?(this.state=me.CONNECTED,i==null||i.removeEventListener("abort",h),this.pingTimeoutDuration=p.message.value.pingTimeout,this.pingIntervalDuration=p.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),l(p.message.value)):this.state===me.RECONNECTING&&p.message.case!=="leave"?(this.state=me.CONNECTED,i==null||i.removeEventListener("abort",h),this.startPingInterval(),((g=p.message)===null||g===void 0?void 0:g.case)==="reconnect"?l(p.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),l(void 0),m=!0)):this.isEstablishingConnection&&p.message.case==="leave"?u(new ue("Received leave request while trying to (re)connect",ee.LeaveRequest,void 0,p.message.value.reason)):r.reconnect||u(new ue("did not receive join response, got ".concat((b=p.message)===null||b===void 0?void 0:b.case," instead"),ee.InternalError)),!m)return}this.signalLatency&&(yield ut(this.signalLatency)),this.handleSignalResponse(p)}),this.ws.onclose=k=>{this.isEstablishingConnection&&u(new ue("Websocket got closed during a (re)connection attempt",ee.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:k.reason,code:k.code,wasClean:k.wasClean,state:this.state})),this.handleOnClose(k.reason)}}finally{d()}}))}close(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=me.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const i=new Promise(a=>{e.ws?e.ws.onclose=()=>{a()}:a()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([i,ut(250)])),e.ws=void 0}}finally{n&&(e.state=me.DISCONNECTED),r()}}()})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Us(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Us(e)})}sendIceCandidate(e,n){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new sh({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new ch({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return C(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const s=a.getNextRequestId();return yield a.sendRequest({case:"updateMetadata",value:new db({requestId:s,metadata:r,name:i,attributes:o})}),s}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new ub({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new fb({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:be.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new vb({timestamp:be.parse(Date.now()),rtt:be.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new lb({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new gc({reason:zt.CLIENT_INITIATED,action:di.DISCONNECT})})}sendRequest(e){return C(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!i&&!q2(n)&&r.state===me.RECONNECTING){r.queuedRequests.push(()=>C(r,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(i||(yield r.requestQueue.flush()),r.signalLatency&&(yield ut(r.signalLatency)),!r.ws||r.ws.readyState!==r.ws.OPEN){r.log.error("cannot send signal request before connected, type: ".concat(n==null?void 0:n.case),r.logContext);return}const a=new vT({message:n});try{r.useJSON?r.ws.send(a.toJsonString()):r.ws.send(a.toBinary())}catch(o){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:o}))}}()})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let a=!1;if(i.case==="answer"){const o=Zf(i.value);this.onAnswer&&this.onAnswer(o)}else if(i.case==="offer"){const o=Zf(i.value);this.onOffer&&this.onOffer(o)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),a=!0):i.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(i.value):i.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));a||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return C(this,void 0,void 0,function*(){if(this.state===me.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=ze.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&ze.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=ze.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&ze.clearInterval(this.pingInterval)}}function Zf(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Us(t){return new Rr({sdp:t.sdp,type:t.type})}function $2(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",an()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),i}var Nt={},Qf={},ll={exports:{}},Jf;function vh(){if(Jf)return ll.exports;Jf=1;var t=ll.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(t).forEach(function(e){var n=t[e];n.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),ll.exports}var Yf;function W2(){return Yf||(Yf=1,function(t){var e=function(s){return String(Number(s))===s?Number(s):s},n=function(s,c,l,u){if(u&&!l)c[u]=e(s[1]);else for(var d=0;d<l.length;d+=1)s[d+1]!=null&&(c[l[d]]=e(s[d+1]))},r=function(s,c,l){var u=s.name&&s.names;s.push&&!c[s.push]?c[s.push]=[]:u&&!c[s.name]&&(c[s.name]={});var d=s.push?{}:u?c[s.name]:c;n(l.match(s.reg),d,s.names,s.name),s.push&&c[s.push].push(d)},i=vh(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(s){var c={},l=[],u=c;return s.split(/(\r\n|\r|\n)/).filter(a).forEach(function(d){var h=d[0],f=d.slice(2);h==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var v=0;v<(i[h]||[]).length;v+=1){var k=i[h][v];if(k.reg.test(f))return r(k,u,f)}}),c.media=l,c};var o=function(s,c){var l=c.split(/=(.+)/,2);return l.length===2?s[l[0]]=e(l[1]):l.length===1&&c.length>1&&(s[l[0]]=void 0),s};t.parseParams=function(s){return s.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(s){return s.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(s){for(var c=[],l=s.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(s){return s.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(s){return s.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}}(Qf)),Qf}var ul,Xf;function K2(){if(Xf)return ul;Xf=1;var t=vh(),e=/%[sdv%]/g,n=function(o){var s=1,c=arguments,l=c.length;return o.replace(e,function(u){if(s>=l)return u;var d=c[s];switch(s+=1,u){case"%%":return"%";case"%s":return String(d);case"%d":return Number(d);case"%v":return""}})},r=function(o,s,c){var l=s.format instanceof Function?s.format(s.push?c:c[s.name]):s.format,u=[o+"="+l];if(s.names)for(var d=0;d<s.names.length;d+=1){var h=s.names[d];s.name?u.push(c[s.name][h]):u.push(c[s.names[d]])}else u.push(c[s.name]);return n.apply(null,u)},i=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];return ul=function(o,s){s=s||{},o.version==null&&(o.version=0),o.name==null&&(o.name=" "),o.media.forEach(function(d){d.payloads==null&&(d.payloads="")});var c=s.outerOrder||i,l=s.innerOrder||a,u=[];return c.forEach(function(d){t[d].forEach(function(h){h.name in o&&o[h.name]!=null?u.push(r(d,h,o)):h.push in o&&o[h.push]!=null&&o[h.push].forEach(function(f){u.push(r(d,h,f))})})}),o.media.forEach(function(d){u.push(r("m",t.m[0],d)),l.forEach(function(h){t[h].forEach(function(f){f.name in d&&d[f.name]!=null?u.push(r(h,f,d)):f.push in d&&d[f.push]!=null&&d[f.push].forEach(function(v){u.push(r(h,f,v))})})})}),u.join(`\r
`)+`\r
`},ul}var em;function G2(){if(em)return Nt;em=1;var t=W2(),e=K2(),n=vh();return Nt.grammar=n,Nt.write=e,Nt.parse=t.parse,Nt.parseParams=t.parseParams,Nt.parseFmtpConfig=t.parseFmtpConfig,Nt.parsePayloads=t.parsePayloads,Nt.parseRemoteCandidates=t.parseRemoteCandidates,Nt.parseImageAttributes=t.parseImageAttributes,Nt.parseSimulcastStreamList=t.parseSimulcastStreamList,Nt}var Pn=G2();function bh(t,e,n){var r,i,a;e===void 0&&(e=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,s=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var f=Date.now()-l;if(f+e>=c)return c-f}return e}var h=function(){var f=[].slice.call(arguments),v=this;return new Promise(function(k,S){var g=o&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,l=Date.now(),!o){var p=t.apply(v,f);s&&s(p),u.forEach(function(m){return(0,m.resolve)(p)}),u=[]}},d()),g){var b=t.apply(v,f);return s&&s(b),k(b)}u.push({resolve:k,reject:S})})};return h.cancel=function(f){a!==void 0&&clearTimeout(a),u.forEach(function(v){return(0,v.reject)(f)}),u=[]},h}const Z2=.7,Q2=20,mi={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class tm extends on.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=X,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=bh(i=>C(this,void 0,void 0,function*(){this.emit(mi.NegotiationStarted);try{yield this.createAndSendOffer()}catch(a){if(i)i(a);else throw a}}),Q2),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=wn((r=n.loggerName)!==null&&r!==void 0?r:$t.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC()}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return C(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return C(this,void 0,void 0,function*(){var n;let r;if(e.type==="offer"){let{stereoMids:i,nackMids:a}=J2(e);this.remoteStereoMids=i,this.remoteNackMids=a}else if(e.type==="answer"){const i=Pn.parse((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(a=>{a.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||a.mid!=o.transceiver.mid)return!1;let s=0;if(a.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(s=l.payload,!0):!1),s===0)return!0;let c=!1;for(const l of a.fmtp)if(l.payload===s){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),c=!0;break}return c||o.maxbr>0&&a.fmtp.push({payload:s,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),r=Pn.write(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(mi.NegotiationComplete),e.sdp&&Pn.parse(e.sdp).media.forEach(i=>{i.type==="video"&&this.emit(mi.RTPVideoPayloadTypes,i.rtp)}))})}createAndSendOffer(e){return C(this,void 0,void 0,function*(){var n;if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const a=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&a)yield this._pc.setRemoteDescription(a);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:r.sdp},this.logContext));const i=Pn.parse((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(a=>{rm(a),a.type==="audio"?nm(a,[],[]):a.type==="video"&&this.trackBitrates.some(o=>{if(!a.msid||!o.cid||!a.msid.includes(o.cid))return!1;let s=0;if(a.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(s=l.payload,!0):!1),s===0||(va(o.codec)&&this.ensureVideoDDExtensionForSVC(a,i),o.codec!=="av1"))return!0;const c=Math.round(o.maxbr*Z2);for(const l of a.fmtp)if(l.payload===s){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(c));break}return!0})}),yield this.setMungedSDP(r,Pn.write(i)),this.onOffer(r)})}createAndSetAnswer(){return C(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),r=Pn.parse((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{rm(i),i.type==="audio"&&nm(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Pn.write(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Oe("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Oe("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return C(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(o=>{switch(o.type){case"transport":n=o.selectedCandidatePairId;break;case"candidate-pair":n===""&&o.selected&&(n=o.id),r.set(o.id,o);break;case"remote-candidate":i.set(o.id,"".concat(o.address,":").concat(o.port));break}}),n==="")return;const a=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(a!==void 0)return i.get(a)})}setMungedSDP(e,n,r){return C(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(a){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:a,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let a="unknown error";i instanceof Error?a=i.message:typeof i=="string"&&(a=i);const o={error:a,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new Nu(a)}})}ensureVideoDDExtensionForSVC(e,n){var r,i;if(!(!((r=e.ext)===null||r===void 0)&&r.some(a=>a.uri===Vf))){if(this.ddExtID===0){let a=0;n.media.forEach(o=>{var s;o.type==="video"&&((s=o.ext)===null||s===void 0||s.forEach(c=>{c.value>a&&(a=c.value)}))}),this.ddExtID=a+1}(i=e.ext)===null||i===void 0||i.push({value:this.ddExtID,uri:Vf})}}}function nm(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function J2(t){var e;const n=[],r=[],i=Pn.parse((e=t.sdp)!==null&&e!==void 0?e:"");let a=0;return i.media.forEach(o=>{var s;o.type==="audio"&&(o.rtp.some(c=>c.codec==="opus"?(a=c.payload,!0):!1),!((s=o.rtcpFb)===null||s===void 0)&&s.some(c=>c.payload===a&&c.type==="nack")&&r.push(o.mid),o.fmtp.some(c=>c.payload===a?(c.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:r}}function rm(t){if(t.connection){const e=t.connection.ip.indexOf(":")>=0;(t.connection.version===4&&e||t.connection.version===6&&!e)&&(t.connection.ip="0.0.0.0",t.connection.version=4)}}const Vu="vp8",Y2={audioPreset:Lu.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:fh.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Vu,backupCodec:!0},iy={deviceId:"default",autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},ay={deviceId:"default",resolution:qa.h720.resolution},X2={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new HT,disconnectOnPageLeave:!0,webAudioMix:!1},yh={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Se;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(Se||(Se={}));class ex{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=yh.peerConnectionTimeout,this.log=X,this.updateState=()=>{var a;const o=this.state,s=this.requiredTransports.map(c=>c.getConnectionState());s.every(c=>c==="connected")?this.state=Se.CONNECTED:s.some(c=>c==="failed")?this.state=Se.FAILED:s.some(c=>c==="connecting")?this.state=Se.CONNECTING:s.every(c=>c==="closed")?this.state=Se.CLOSED:s.some(c=>c==="closed")?this.state=Se.CLOSING:s.every(c=>c==="new")&&(this.state=Se.NEW),o!==this.state&&(this.log.debug("pc state change: from ".concat(Se[o]," to ").concat(Se[this.state]),this.logContext),(a=this.onStateChange)===null||a===void 0||a.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=wn((i=r.loggerName)!==null&&i!==void 0?i:$t.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n,this.publisher=new tm(e,r),this.subscriber=new tm(e,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,Bt.PUBLISHER)},this.subscriber.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,Bt.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var o;(o=this.onDataChannel)===null||o===void 0||o.call(this,a)},this.subscriber.onTrack=a=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,a)},this.publisher.onOffer=a=>{var o;(o=this.onPublisherOffer)===null||o===void 0||o.call(this,a)},this.state=Se.NEW,this.connectionLock=new mt,this.remoteOfferLock=new mt}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return C(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return C(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return C(this,void 0,void 0,function*(){n===Bt.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return C(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const n=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()}finally{n()}})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return C(this,void 0,void 0,function*(){var r;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(a=>this.ensureTransportConnected(a,e,n)))}finally{i()}})}negotiate(e){return C(this,void 0,void 0,function*(){return new Promise((n,r)=>C(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),a=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",a),this.publisher.once(mi.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(mi.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Bt.PUBLISHER?this.publisher.getConnectedAddress():e===Bt.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return C(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((s,c)=>C(a,void 0,void 0,function*(){const l=()=>{this.log.warn("abort transport connection",this.logContext),ze.clearTimeout(u),c(new ue("room connection has been cancelled",ee.Cancelled))};i!=null&&i.signal.aborted&&l(),i==null||i.signal.addEventListener("abort",l);const u=ze.setTimeout(()=>{i==null||i.signal.removeEventListener("abort",l),c(new ue("could not establish pc connection",ee.InternalError))},o);for(;this.state!==Se.CONNECTED;)if(yield ut(50),i!=null&&i.signal.aborted){c(new ue("room connection has been cancelled",ee.Cancelled));return}ze.clearTimeout(u),i==null||i.signal.removeEventListener("abort",l),s()}))}()})}}class Ee extends Error{constructor(e,n,r){super(n),this.code=e,this.message=im(n,Ee.MAX_MESSAGE_BYTES),this.data=r?im(r,Ee.MAX_DATA_BYTES):void 0}static fromProto(e){return new Ee(e.code,e.message,e.data)}toProto(){return new eb({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new Ee(Ee.ErrorCode[e],Ee.ErrorMessage[e],n)}}Ee.MAX_MESSAGE_BYTES=256;Ee.MAX_DATA_BYTES=15360;Ee.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Ee.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const oy=15360;function kh(t){return new TextEncoder().encode(t).length}function im(t,e){if(kh(t)<=e)return t;let n=0,r=t.length;const i=new TextEncoder;for(;n<r;){const a=Math.floor((n+r+1)/2);i.encode(t.slice(0,a)).length<=e?n=a:r=a-1}return t.slice(0,n)}const wh=2e3;function yc(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}const tx=1e3;class sy extends _{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=arguments.length>4?arguments[4]:void 0;super(e,n,a),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=bh(()=>C(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>C(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(j.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new mt,this.pauseUpstreamLock=new mt,this.processorLock=new mt,this.restartLock=new mt,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==_.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return C(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(a=>{pi(this._mediaStreamTrack,a)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let i;if(this.processor&&e){const a=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(ni(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}finally{a()}}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(i??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(a=>{ni(i??e,a)}))})}waitForDimensions(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tx;return function*(){var r;if(e.kind===_.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=Wt())===null||r===void 0?void 0:r.os)==="iOS"&&(yield ut(10));const i=Date.now();for(;Date.now()-i<n;){const a=e.dimensions;if(a)return a;yield ut(50)}throw new hn("unable to get track dimensions after timeout")}()})}setDeviceId(e){return C(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Gn(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Gn(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===_.Source.ScreenShare)return;const{deviceId:r,groupId:i}=e._mediaStreamTrack.getSettings(),a=e.kind===_.Kind.Audio?"audioinput":"videoinput";return n?je.getInstance().normalizeDeviceId(a,r,i):r}()})}mute(){return C(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return C(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return C(this,void 0,void 0,function*(){if(!this.sender)throw new hn("unable to replace an unpublished track");let r,i;return typeof n=="boolean"?r=n:n!==void 0&&(r=n.userProvidedTrack,i=n.stopProcessor),this.providedByUser=r??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return C(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:i}=e,a=qT(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const o={audio:!1,video:!1};this.kind===_.Kind.Video?o.video=r||i?{deviceId:r,facingMode:i}:!0:o.audio=r?{deviceId:r}:!0,this.attachedElements.forEach(c=>{pi(this.mediaStreamTrack,c)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const s=(yield navigator.mediaDevices.getUserMedia(o)).getTracks()[0];return yield s.applyConstraints(a),s.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(s),this._constraints=e,this.emit(j.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?j.Muted:j.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return C(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Qb()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return C(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(j.UpstreamPaused,this);const r=Wt();if((r==null?void 0:r.name)==="Safari"&&Ir(r.version,"12.0")<0)throw new ph("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{n()}})}resumeUpstream(){return C(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(j.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{n()}})}getRTCStatsReport(){return C(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return C(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;const o=yield r.processorLock.lock();try{r.log.debug("setting up processor",r.logContext);const s=document.createElement(r.kind),c={kind:r.kind,track:r._mediaStreamTrack,element:s,audioContext:r.audioContext};if(yield n.init(c),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.stopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(ni(r._mediaStreamTrack,s),s.muted=!0,s.play().catch(l=>r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:l}))),r.processor=n,r.processorElement=s,r.processor.processedTrack){for(const l of r.attachedElements)l!==r.processorElement&&i&&(pi(r._mediaStreamTrack,l),ni(r.processor.processedTrack,l));yield(a=r.sender)===null||a===void 0?void 0:a.replaceTrack(r.processor.processedTrack)}r.emit(j.TrackProcessorUpdate,r.processor)}finally{o()}}()})}getProcessor(){return this.processor}stopProcessor(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,i;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,n||((i=e.processorElement)===null||i===void 0||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(j.TrackProcessorUpdate))}()})}}class Fs extends sy{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;super(e,_.Kind.Audio,n,r,a),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>C(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(s){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:s}));return}o&&this.prevStats&&(this._currentBitrate=yc(o,this.prevStats)),this.prevStats=o}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(j.AudioTrackFeatureUpdate,this,Xt.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(j.AudioTrackFeatureUpdate,this,Xt.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===_.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Gn(this._constraints.deviceId);return this.source===_.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return C(this,void 0,void 0,function*(){let n;if(e){const r=bc({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return C(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){ot()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},wh)))}setProcessor(e){return C(this,void 0,void 0,function*(){var n;const r=yield this.processorLock.lock();try{if(!an()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(j.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return C(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return C(this,void 0,void 0,function*(){const e=yield ty(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(j.AudioSilenceDetected)),e})}}function cy(t,e,n){switch(t.kind){case"audio":return new Fs(t,e,!1,void 0,n);case"video":return new zs(t,e,!1,n);default:throw new hn("unsupported track type: ".concat(t.kind))}}const nx=Object.values(qa),rx=Object.values(Mu),ix=Object.values(fh),ax=[qa.h180,qa.h360],ox=[Mu.h180,Mu.h360],sx=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(e=>{var n,r;return new ce(Math.floor(t.width/e.scaleResolutionDownBy),Math.floor(t.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*(((n=t.encoding.maxFramerate)!==null&&n!==void 0?n:30)/((r=e.fps)!==null&&r!==void 0?r:30))))),e.fps,t.encoding.priority)}),Hu=["q","h","f"];function qu(t,e,n,r){var i,a;let o=r==null?void 0:r.videoEncoding;t&&(o=r==null?void 0:r.screenShareEncoding);const s=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!o&&!s&&!c||!e||!n)return[{}];o||(o=lx(t,e,n,l),X.debug("using video encoding",o));const u=o.maxFramerate,d=new ce(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&va(l)){const v=new Bs(c),k=[];if(v.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const S=Wt();if(Yn()||an()||(S==null?void 0:S.name)==="Chrome"&&Ir(S==null?void 0:S.version,"113")<0){const g=v.suffix=="h"?2:3;for(let b=0;b<v.spatial;b+=1)k.push({rid:Hu[2-b],maxBitrate:o.maxBitrate/Math.pow(g,b),maxFramerate:d.encoding.maxFramerate});k[0].scalabilityMode=c}else k.push({maxBitrate:o.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:c});return d.encoding.priority&&(k[0].priority=d.encoding.priority,k[0].networkPriority=d.encoding.priority),X.debug("using svc encoding",{encodings:k}),k}if(!s)return[o];let h=[];t?h=(i=om(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:am(t,d):h=(a=om(r==null?void 0:r.videoSimulcastLayers))!==null&&a!==void 0?a:am(t,d);let f;if(h.length>0){const v=h[0];h.length>1&&([,f]=h);const k=Math.max(e,n);if(k>=960&&f)return dl(e,n,[v,f,d],u);if(k>=480)return dl(e,n,[v,d],u)}return dl(e,n,[d])}function cx(t,e,n){var r,i,a,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&X.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const s=t.mediaStreamTrack.getSettings(),c=(r=s.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(a=s.height)!==null&&a!==void 0?a:(o=t.dimensions)===null||o===void 0?void 0:o.height;return t.source===_.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),qu(t.source===_.Source.ScreenShare,c,l,n)}function lx(t,e,n,r){const i=ux(t,e,n);let{encoding:a}=i[0];const o=Math.max(e,n);for(let s=0;s<i.length;s+=1){const c=i[s];if(a=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.7;break;case"vp9":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.85;break}return a}function ux(t,e,n){if(t)return ix;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?nx:rx}function am(t,e){if(t)return sx(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?ax:ox}function dl(t,e,n,r){const i=[];if(n.forEach((a,o)=>{if(o>=Hu.length)return;const s=Math.min(t,e),c={rid:Hu[o],scaleResolutionDownBy:Math.max(1,s/Math.min(a.width,a.height)),maxBitrate:a.encoding.maxBitrate},l=r&&a.encoding.maxFramerate?Math.min(r,a.encoding.maxFramerate):a.encoding.maxFramerate;l&&(c.maxFramerate=l);const u=Ei()||o===0;a.encoding.priority&&u&&(c.priority=a.encoding.priority,c.networkPriority=a.encoding.priority),i.push(c)}),an()&&Yb()==="ios"){let a;i.forEach(s=>{a?s.maxFramerate&&s.maxFramerate>a&&(a=s.maxFramerate):a=s.maxFramerate});let o=!0;i.forEach(s=>{var c;s.maxFramerate!=a&&(o&&(o=!1,X.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),X.info('Setting framerate of encoding "'.concat((c=s.rid)!==null&&c!==void 0?c:"",'" to ').concat(a)),s.maxFramerate=a)})}return i}function om(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class Bs{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function dx(t){return t.source===_.Source.ScreenShare||t.constraints.height&&Gn(t.constraints.height)>=1080?"maintain-resolution":"balanced"}const hx=5e3;class zs extends sy{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,_.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>C(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(s){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:s}));return}const o=new Map(a.map(s=>[s.rid,s]));if(this.prevStats){let s=0;o.forEach((c,l)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(l);s+=yc(c,d)}),this._currentBitrate=s}this.prevStats=o}),this.senderLock=new mt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!ot())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},wh))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return C(this,void 0,void 0,function*(){var n,r,i,a,o;yield e.pauseUpstream.call(this);try{for(var s=!0,c=Ln(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;s=!0)a=l.value,s=!1,yield(o=a.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(u){r={error:u}}finally{try{!s&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return C(this,void 0,void 0,function*(){var n,r,i,a,o;yield e.resumeUpstream.call(this);try{for(var s=!0,c=Ln(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;s=!0){a=l.value,s=!1;const u=a;yield(o=u.sender)===null||o===void 0?void 0:o.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!s&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===_.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===_.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return C(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var a;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,framesPerSecond:i.framesPerSecond,framesSent:i.framesSent,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationDurations:i.qualityLimitationDurations,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges,rid:(a=i.rid)!==null&&a!==void 0?a:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,targetBitrate:i.targetBitrate,timestamp:i.timestamp},s=r.get(i.remoteId);s&&(o.jitter=s.jitter,o.packetsLost=s.packetsLost,o.roundTripTime=s.roundTripTime),n.push(o)}}),n.sort((i,a)=>{var o,s;return((o=a.frameWidth)!==null&&o!==void 0?o:0)-((s=i.frameWidth)!==null&&s!==void 0?s:0)}),n})}setPublishingQuality(e){const n=[];for(let r=Tt.LOW;r<=Tt.HIGH;r+=1)n.push(new uh({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}restartTrack(e){return C(this,void 0,void 0,function*(){var n,r,i,a,o;let s;if(e){const d=bc({video:e});typeof d.video!="boolean"&&(s=d.video)}yield this.restart(s);try{for(var c=!0,l=Ln(this.simulcastCodecs.values()),u;u=yield l.next(),n=u.done,!n;c=!0){a=u.value,c=!1;const d=a;d.sender&&((o=d.sender.transport)===null||o===void 0?void 0:o.state)!=="closed"&&(d.mediaStreamTrack=this.mediaStreamTrack.clone(),yield d.sender.replaceTrack(d.mediaStreamTrack))}}catch(d){r={error:d}}finally{try{!c&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return C(this,arguments,void 0,function(r){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o,s,c,l,u,d;if(yield n.setProcessor.call(i,r,a),!((u=i.processor)===null||u===void 0)&&u.processedTrack)try{for(var h=!0,f=Ln(i.simulcastCodecs.values()),v;v=yield f.next(),o=v.done,!o;h=!0)l=v.value,h=!1,yield(d=l.sender)===null||d===void 0?void 0:d.replaceTrack(i.processor.processedTrack)}catch(k){s={error:k}}finally{try{!h&&!o&&(c=f.return)&&(yield c.call(f))}finally{if(s)throw s.error}}}()})}setDegradationPreference(e){return C(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},hx))}setPublishingCodecs(e){return C(this,void 0,void 0,function*(){var n,r,i,a,o,s,c;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=Ln(e);i=yield r.next(),a=i.done,!a;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const h of u.qualities)if(h.enabled){l.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield sm(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){o={error:u}}finally{try{!n&&!a&&(s=r.return)&&(yield s.call(r))}finally{if(o)throw o.error}}return l})}setPublishingLayers(e){return C(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield sm(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return C(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Qb()&&this.isInBackground&&this.source===_.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function sm(t,e,n,r,i,a){return C(this,void 0,void 0,function*(){const o=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},a),{sender:t,qualities:n,senderEncodings:e}));try{const s=t.getParameters(),{encodings:c}=s;if(!c)return;if(c.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},a),{encodings:c,senderEncodings:e}));return}let l=!1;const u=Wt();if((u==null?void 0:u.name)==="Chrome"&&Ir(u==null?void 0:u.version,"133")>0&&c[0].scalabilityMode){const d=c[0],h=new Bs(d.scalabilityMode);let f=ui.OFF;if(n.forEach(v=>{v.enabled&&(f===ui.OFF||v.quality>f)&&(f=v.quality)}),f===ui.OFF)d.active&&(d.active=!1,l=!0);else if(!d.active||h.spatial!==f+1){l=!0,d.active=!0;const v=new Bs(e[0].scalabilityMode);h.spatial=f+1,h.suffix=v.suffix,h.spatial===1&&(h.suffix=void 0),d.scalabilityMode=h.toString(),d.scaleResolutionDownBy=Math.pow(2,2-f),e[0].maxBitrate&&(d.maxBitrate=e[0].maxBitrate/(d.scaleResolutionDownBy*d.scaleResolutionDownBy))}}else c.forEach((d,h)=>{var f;let v=(f=d.rid)!==null&&f!==void 0?f:"";v===""&&(v="q");const k=ly(v),S=n.find(g=>g.quality===k);S&&d.active!==S.enabled&&(l=!0,d.active=S.enabled,i.debug("setting layer ".concat(S.quality," to ").concat(d.active?"enabled":"disabled"),a),Ei()&&(S.enabled?(d.scaleResolutionDownBy=e[h].scaleResolutionDownBy,d.maxBitrate=e[h].maxBitrate,d.maxFrameRate=e[h].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))});l&&(s.encodings=c,i.debug("setting encodings",Object.assign(Object.assign({},a),{encodings:s.encodings})),yield t.setParameters(s))}finally{o()}})}function ly(t){switch(t){case"f":return Tt.HIGH;case"h":return Tt.MEDIUM;case"q":return Tt.LOW;default:return Tt.HIGH}}function cm(t,e,n,r){if(!n)return[new kr({quality:Tt.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,a=new Bs(i),o=[],s=a.suffix=="h"?1.5:2,c=a.suffix=="h"?2:3;for(let l=0;l<a.spatial;l+=1)o.push(new kr({quality:Math.min(Tt.HIGH,a.spatial-1)-l,width:Math.ceil(t/Math.pow(s,l)),height:Math.ceil(e/Math.pow(s,l)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(c,l)):0,ssrc:0}));return o}return n.map(i=>{var a,o,s;const c=(a=i.scaleResolutionDownBy)!==null&&a!==void 0?a:1;let l=ly((o=i.rid)!==null&&o!==void 0?o:"");return new kr({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(s=i.maxBitrate)!==null&&s!==void 0?s:0,ssrc:0})})}const lm="_lossy",um="_reliable",px=2*1e3,hl="leave-reconnect";var Lt;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Lt||(Lt={}));class fx extends on.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=yh.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Lt.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=X,this.handleDataChannel=r=>C(this,[r],void 0,function(i){var a=this;let{channel:o}=i;return function*(){if(o){if(o.label===um)a.reliableDCSub=o;else if(o.label===lm)a.lossyDCSub=o;else return;a.log.debug("on data channel ".concat(o.id,", ").concat(o.label),a.logContext),o.onmessage=a.handleDataMessage}}()}),this.handleDataMessage=r=>C(this,void 0,void 0,function*(){var i,a;const o=yield this.dataProcessLock.lock();try{let s;if(r.data instanceof ArrayBuffer)s=r.data;else if(r.data instanceof Blob)s=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const c=nt.fromBinary(new Uint8Array(s));((i=c.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(F.ActiveSpeakersUpdate,c.value.value.speakers):(((a=c.value)===null||a===void 0?void 0:a.case)==="user"&&gx(c,c.value.value),this.emit(F.DataPacketReceived,c))}finally{o()}}),this.handleDataError=r=>{const i=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:a}=r.error;this.log.error("DataChannel error on ".concat(i,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:a}))}else this.log.error("Unknown DataChannel error on ".concat(i),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const i=r.currentTarget.maxRetransmits===0?te.LOSSY:te.RELIABLE;this.updateAndEmitDCBufferStatus(i)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const a=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(F.Disconnected),this.close()},o=Date.now()-this.reconnectStart;let s=this.getNextRetryDelay({elapsedMs:o,retryCount:this.reconnectAttempts});if(s===null){a(o);return}r===hl&&(s=0),this.log.debug("reconnecting in ".concat(s,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=ze.setTimeout(()=>this.attemptReconnect(i).finally(()=>this.reconnectTimeout=void 0),s)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===Lt.Connected&&r();const a=()=>{this.off(F.Disconnected,o),r()},o=()=>{this.off(F.Restarted,a),i()};this.once(F.Restarted,a),this.once(F.Disconnected,o)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(F.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===me.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Fr.RR_SIGNAL_DISCONNECTED))},this.log=wn((n=e.loggerName)!==null&&n!==void 0?n:$t.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new gh(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new mt,this.dataProcessLock=new mt,this.dcBufferStatus=new Map([[te.LOSSY,!0],[te.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(F.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(F.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(F.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(F.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(F.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(F.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(F.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(F.SignalRequestResponse,r)}get logContext(){var e,n,r,i,a,o,s,c;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,participant:(o=(a=this.latestJoinResponse)===null||a===void 0?void 0:a.participant)===null||o===void 0?void 0:o.identity,pID:(c=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||c===void 0?void 0:c.sid}}join(e,n,r,i){return C(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const a=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=a,this.subscriberPrimary=a.subscriberPrimary,this.pcManager||(yield this.configure(a)),(!this.subscriberPrimary||a.fastPublish)&&this.negotiate(),this.clientConfiguration=a.clientConfiguration,a}catch(a){if(a instanceof ue&&a.reason===ee.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw a}})}close(){return C(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(F.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return C(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return C(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new hn("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new ue("publication of local track timed out, no response from server",ee.InternalError))},1e4);this.pendingTrackResolvers[e.cid]={resolve:a=>{clearTimeout(i),n(a)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return C(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return C(this,void 0,void 0,function*(){var n,r;if(this.pcManager&&this.pcManager.currentState!==Se.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const i=this.makeRTCConfiguration(e);this.pcManager=new ex(i,e.subscriberPrimary,this.loggerOptions),this.emit(F.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(a,o)=>{this.client.sendIceCandidate(a,o)},this.pcManager.onPublisherOffer=a=>{this.client.sendOffer(a)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(a,o,s)=>C(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(a),this.logContext),["closed","disconnected","failed"].includes(o)&&(this.publisherConnectionPromise=void 0),a===Se.CONNECTED){const u=this.pcState===Lt.New;this.pcState=Lt.Connected,u&&this.emit(F.Connected,e)}else a===Se.FAILED&&this.pcState===Lt.Connected&&(this.pcState=Lt.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?Fr.RR_SUBSCRIBER_FAILED:Fr.RR_PUBLISHER_FAILED));const c=this.client.isDisconnected||this.client.currentState===me.RECONNECTING,l=[Se.FAILED,Se.CLOSING,Se.CLOSED].includes(a);c&&l&&!this._isClosed&&this.emit(F.Offline)}),this.pcManager.onTrack=a=>{this.emit(F.MediaTrackAdded,a.track,a.streams[0],a.receiver)},mx((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>C(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>C(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(F.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(F.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(F.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(F.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Fr.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case di.DISCONNECT:this.emit(F.Disconnected,e==null?void 0:e.reason),this.close();break;case di.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(hl);break;case di.RESUME:this.handleDisconnect(hl)}}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(a=>{const o={urls:a.urls};a.username&&(o.username=a.username),a.credential&&(o.credential=a.credential),i.push(o)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Va.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(lm,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(um,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,r){return C(this,void 0,void 0,function*(){if(Du())return yield this.createTransceiverRTCRtpSender(e,n,r);if(ju())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Oe("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return C(this,void 0,void 0,function*(){if(Du())return this.createSimulcastTransceiverSender(e,n,r,i);if(ju())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Oe("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new Oe("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),Li(e)&&(e.codec=n.videoCodec);const a={direction:"sendonly",streams:i};return r&&(a.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,a)).sender})}createSimulcastTransceiverSender(e,n,r,i){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new Oe("publisher is closed");const a={direction:"sendonly"};i&&(a.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,a);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new Oe("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return C(this,void 0,void 0,function*(){var n,r,i;if(!this._isClosed){if(this.attemptingReconnect){X.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Va.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:Se.NEW)===Se.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(a){this.reconnectAttempts+=1;let o=!0;a instanceof Oe?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:a})),o=!1):a instanceof Br||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",Fr.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(F.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return C(this,void 0,void 0,function*(){var n,r,i;try{if(!this.url||!this.token)throw new Oe("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(F.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let a;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Br;a=yield this.join(e??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof ue&&o.reason===ee.NotAllowed?new Oe("could not reconnect, token might be expired"):new Br}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(F.SignalRestarted,a),yield this.waitForPCReconnected(),this.client.currentState!==me.CONNECTED)throw new Br("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(F.Restarted)}catch(a){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),a}})}resumeConnection(e){return C(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new Oe("could not reconnect, url or token not saved");if(!this.pcManager)throw new Oe("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(F.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let a="";throw i instanceof Error&&(a=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof ue&&i.reason===ee.NotAllowed?new Oe("could not reconnect, token might be expired"):i instanceof ue&&i.reason===ee.LeaveRequest?i:new Br(a)}if(this.emit(F.SignalResumed),r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==me.CONNECTED)throw new Br("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(F.Resumed)})}waitForPCInitialConnection(e,n){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new Oe("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return C(this,void 0,void 0,function*(){this.pcState=Lt.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield ut(px),!this.pcManager)throw new Oe("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Lt.Connected}catch(e){throw this.pcState=Lt.Disconnected,new ue("could not establish PC connection, ".concat(e.message),ee.InternalError)}})}publishRpcResponse(e,n,r,i){return C(this,void 0,void 0,function*(){const a=new nt({destinationIdentities:[e],kind:te.RELIABLE,value:{case:"rpcResponse",value:new X0({requestId:n,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(a,te.RELIABLE)})}publishRpcAck(e,n){return C(this,void 0,void 0,function*(){const r=new nt({destinationIdentities:[e],kind:te.RELIABLE,value:{case:"rpcAck",value:new Y0({requestId:n})}});yield this.sendDataPacket(r,te.RELIABLE)})}sendDataPacket(e,n){return C(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}waitForBufferStatusLow(e){return new Promise((n,r)=>C(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))n();else{const i=()=>r("Engine closed");for(this.once(F.Closing,i);!this.dcBufferStatus.get(e);)yield ut(10);this.off(F.Closing,i),n()}}))}ensureDataTransportConnected(e){return C(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var a;if(!r.pcManager)throw new Oe("PC manager is closed");const o=i?r.pcManager.subscriber:r.pcManager.publisher,s=i?"Subscriber":"Publisher";if(!o)throw new ue("".concat(s," connection not set"),ee.InternalError);let c=!1;!i&&!r.dataChannelForKind(n,i)&&(r.createDataChannels(),c=!0),!c&&!i&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(c=!0),c&&r.negotiate();const l=r.dataChannelForKind(n,i);if((l==null?void 0:l.readyState)==="open")return;const u=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<u;){if(o.isICEConnected&&((a=r.dataChannelForKind(n,i))===null||a===void 0?void 0:a.readyState)==="open")return;yield ut(50)}throw new ue("could not establish ".concat(s," connection, state: ").concat(o.getICEConnectionState()),ee.InternalError)}()})}ensurePublisherConnected(e){return C(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Se.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return C(this,void 0,void 0,function*(){return new Promise((e,n)=>C(this,void 0,void 0,function*(){if(!this.pcManager){n(new Nu("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(F.Closing,i),this.pcManager.publisher.once(mi.RTPVideoPayloadTypes,a=>{const o=new Map;a.forEach(s=>{const c=s.codec.toLowerCase();P2(c)&&o.set(s.payload,c)}),this.emit(F.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),e()}catch(a){a instanceof Nu&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Fr.RR_UNKNOWN),n(a)}finally{this.off(F.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===te.LOSSY)return this.lossyDCSub;if(e===te.RELIABLE)return this.reliableDCSub}else{if(e===te.LOSSY)return this.lossyDC;if(e===te.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const a=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),s=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array,l=new Array;e.forEach(u=>{u.isDesired!==s&&c.push(u.trackSid),u.isEnabled||l.push(u.trackSid)}),this.client.sendSyncState(new mb({answer:a?Us({sdp:a.sdp,type:a.type}):void 0,offer:o?Us({sdp:o.sdp,type:o.type}):void 0,subscription:new mc({trackSids:c,subscribe:!s,participantTracks:[]}),publishTracks:M2(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:l}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new gb({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(te.LOSSY),Bt.PUBLISHER),n(this.dataChannelForKind(te.RELIABLE),Bt.PUBLISHER),n(this.dataChannelForKind(te.LOSSY,!0),Bt.SUBSCRIBER),n(this.dataChannelForKind(te.RELIABLE,!0),Bt.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&ze.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){ot()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){ot()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Br extends Error{}function mx(t){return t!==void 0&&t>13}function gx(t,e){const n=t.participantIdentity?t.participantIdentity:e.participantIdentity;t.participantIdentity=n,e.participantIdentity=n;const r=t.destinationIdentities.length!==0?t.destinationIdentities:e.destinationIdentities;t.destinationIdentities=r,e.destinationIdentities=r}class $u{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Uu(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return C(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),X.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return C(this,void 0,void 0,function*(){const n=yield fetch("".concat(vx(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new ue("Could not fetch region settings: ".concat(n.statusText),n.status===401?ee.NotAllowed:ee.InternalError,n.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function vx(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class uy{get info(){return this._info}constructor(e,n,r){this.reader=n,this.totalByteSize=r,this._info=e,this.bytesReceived=0}}class bx extends uy{handleChunkReceived(e){var n;this.bytesReceived+=e.content.byteLength;const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>C(this,void 0,void 0,function*(){try{const{done:n,value:r}=yield e.read();return n?{done:!0,value:void 0}:(this.handleChunkReceived(r),{done:!1,value:r.content})}catch{return{done:!0,value:void 0}}}),return(){return C(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return C(this,void 0,void 0,function*(){var e,n,r,i;let a=new Set;try{for(var o=!0,s=Ln(this),c;c=yield s.next(),e=c.done,!e;o=!0){i=c.value,o=!1;const l=i;a.add(l)}}catch(l){n={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(n)throw n.error}}return Array.from(a)})}}class yx extends uy{constructor(e,n,r){super(e,n,r),this.receivedChunks=new Map}handleChunkReceived(e){var n;const r=ts(e.chunkIndex),i=this.receivedChunks.get(r);if(i&&i.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength;const a=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,a)}[Symbol.asyncIterator](){const e=this.reader.getReader(),n=new TextDecoder;return{next:()=>C(this,void 0,void 0,function*(){try{const{done:r,value:i}=yield e.read();return r?{done:!0,value:void 0}:(this.handleChunkReceived(i),{done:!1,value:n.decode(i.content)})}catch{return{done:!0,value:void 0}}}),return(){return C(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return C(this,void 0,void 0,function*(){var e,n,r,i;let a="";try{for(var o=!0,s=Ln(this),c;c=yield s.next(),e=c.done,!e;o=!0)i=c.value,o=!1,a+=i}catch(l){n={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(n)throw n.error}}return a})}}class kx{constructor(e,n,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=n}write(e){return this.defaultWriter.write(e)}close(){return C(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class wx extends kx{}class dy extends _{constructor(e,n,r,i,a){super(e,r,a),this.sid=n,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?j.Muted:j.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(j.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return C(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),wh)),D2()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(r){const{timestamp:i,rtpTimestamp:a}=r;a&&this.rtpTimestamp!==a&&(this.emit(j.TimeSyncUpdate,{timestamp:i,rtpTimestamp:a}),this.rtpTimestamp=a)}};e()}}class Cx extends dy{constructor(e,n,r,i,a,o){super(e,n,_.Kind.Audio,r,o),this.monitorReceiver=()=>C(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=yc(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.webAudioPluginNodes=[],a&&(this.sinkId=a.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;an()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(an())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return C(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(Au(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Au(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(j.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(j.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return C(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const pl=100;class Sx extends dy{constructor(e,n,r,i,a){super(e,n,_.Kind.Video,r,a),this.elementInfos=[],this.monitorReceiver=()=>C(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=yc(o,this.prevStats)),this.prevStats=o}),this.debouncedHandleResize=bh(()=>{this.updateDimensions()},pl),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?pi(this._mediaStreamTrack,n):ni(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new Tx(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return C(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(a=>{a.type==="inbound-rtp"?(r=a.codecId,n={type:"video",streamId:a.id,framesDecoded:a.framesDecoded,framesDropped:a.framesDropped,framesReceived:a.framesReceived,packetsReceived:a.packetsReceived,packetsLost:a.packetsLost,frameWidth:a.frameWidth,frameHeight:a.frameHeight,pliCount:a.pliCount,firCount:a.firCount,nackCount:a.nackCount,jitter:a.jitter,timestamp:a.timestamp,bytesReceived:a.bytesReceived,decoderImplementation:a.decoderImplementation}):a.type==="codec"&&i.set(a.id,a)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return C(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((s,c)=>Math.max(s,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,a=this.elementInfos.some(s=>s.pictureInPicture),o=this.elementInfos.some(s=>s.visible)&&!i||a;if(this.lastVisible!==o){if(!o&&Date.now()-r<pl){ze.setTimeout(()=>{this.updateVisibility()},pl);return}this.lastVisible=o,this.emit(j.VisibilityChanged,o,this)}}updateDimensions(){var e,n;let r=0,i=0;const a=this.getPixelDensity();for(const o of this.elementInfos){const s=o.width()*a,c=o.height()*a;s+c>r+i&&(r=s,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(j.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?Hf():n||(Hf()>2?2:1)}}class Tx{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:a,isIntersecting:o}=r;a===this.element&&(this.isIntersecting=o,this.isPiP=Zi(this.element),this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r,i,a;(i=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Zi(this.element),(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=Zi(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??Wu(e),this.isPiP=ot()&&Zi(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,r;this.isIntersecting=Wu(this.element),this.isPiP=Zi(this.element),this.element.handleResize=()=>{var i;(i=this.handleResize)===null||i===void 0||i.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,$f().observe(this.element),qf().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,r,i,a;(e=$f())===null||e===void 0||e.unobserve(this.element),(n=qf())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(a=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||a===void 0||a.removeEventListener("pagehide",this.onLeavePiP)}}function Zi(t){var e,n;return document.pictureInPictureElement===t?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Wu(t,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Wu(t,e){const n=e||window;let r=t.offsetTop,i=t.offsetLeft;const a=t.offsetWidth,o=t.offsetHeight,{hidden:s}=t,{display:c}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,r+=t.offsetTop,i+=t.offsetLeft;return r<n.pageYOffset+n.innerHeight&&i<n.pageXOffset+n.innerWidth&&r+o>n.pageYOffset&&i+a>n.pageXOffset&&!s&&c!=="none"}class un extends on.EventEmitter{constructor(e,n,r,i){var a;super(),this.metadataMuted=!1,this.encryption=ht.NONE,this.log=X,this.handleMuted=()=>{this.emit(j.Muted)},this.handleUnmuted=()=>{this.emit(j.Unmuted)},this.log=wn((a=i==null?void 0:i.loggerName)!==null&&a!==void 0?a:$t.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=_.Source.Unknown}setTrack(e){this.track&&(this.track.off(j.Muted,this.handleMuted),this.track.off(j.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(j.Muted,this.handleMuted),e.on(j.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),ae(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==ht.NONE}get audioTrack(){if(Cn(this.track))return this.track}get videoTrack(){if(Li(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=_.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===_.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(un||(un={}));class Ku extends un{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(j.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(j.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(j.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return C(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return C(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return C(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return C(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Cn(this.track)){const n=this.track.getSourceTrackSettings(),r=new Set;return n.autoGainControl&&r.add(Xt.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&r.add(Xt.TF_ECHO_CANCELLATION),n.noiseSuppression&&r.add(Xt.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&r.add(Xt.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(Xt.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(Xt.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}var Mn;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Mn||(Mn={}));function xx(t){switch(t){case ra.EXCELLENT:return Mn.Excellent;case ra.GOOD:return Mn.Good;case ra.POOR:return Mn.Poor;case ra.LOST:return Mn.Lost;default:return Mn.Unknown}}class hy extends on.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===js.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,r,i,a,o){let s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:js.STANDARD;var c;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Mn.Unknown,this.log=X,this.log=wn((c=o==null?void 0:o.loggerName)!==null&&c!==void 0?c:$t.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=s,this._attributes=a??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(_.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(_.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(_.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(B.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(B.ParticipantNameChanged,e)}_setAttributes(e){const n=j2(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(B.AttributesChanged,n)}setPermissions(e){var n,r,i,a,o,s;const c=this.permissions,l=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((a=this.permissions)===null||a===void 0?void 0:a.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((u,d)=>{var h;return u!==((h=this.permissions)===null||h===void 0?void 0:h.canPublishSources[d])})||e.canSubscribeMetrics!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribeMetrics);return this.permissions=e,l&&this.emit(B.ParticipantPermissionsChanged,c),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(B.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=xx(e),n!==this._connectionQuality&&this.emit(B.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>Cn(n.track)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(j.Muted,()=>{this.emit(B.TrackMuted,e)}),e.on(j.Unmuted,()=>{this.emit(B.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case _.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case _.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function Ex(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new pb({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}const Po=15e3;class Px extends hy{constructor(e,n,r,i,a){super(e,n,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=ht.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Xb)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(c=>this.log.warn(c.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=o=>{const{requestId:s,reason:c,message:l}=o,u=this.pendingSignalRequests.get(s);u&&(c!==dh.OK&&u.reject(new Ff(l,c)),this.pendingSignalRequests.delete(s))},this.handleDataPacket=o=>{switch(o.value.case){case"rpcResponse":let s=o.value.value,c=null,l=null;s.value.case==="payload"?c=s.value.value:s.value.case==="error"&&(l=Ee.fromProto(s.value.value)),this.handleIncomingRpcResponse(s.requestId,c,l);break;case"rpcAck":let u=o.value.value;this.handleIncomingRpcAck(u.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>Ex(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),ae(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),ae(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),ae(o))),this.onTrackMuted(o,o.isMuted)},this.onTrackFeatureUpdate=o=>{const s=this.audioTrackPublications.get(o.sid);if(!s){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(o.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(s.trackSid,s.getTrackFeatures())},this.handleSubscribedQualityUpdate=o=>C(this,void 0,void 0,function*(){var s,c,l,u,d,h;if(!(!((d=this.roomOptions)===null||d===void 0)&&d.dynacast))return;const f=this.videoTrackPublications.get(o.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!f.videoTrack)return;const g=yield f.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var v=!0,k=Ln(g),S;S=yield k.next(),s=S.done,!s;v=!0){u=S.value,v=!1;const b=u;g2(b)&&(this.log.debug("publish ".concat(b," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),ae(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,b,f.options))}}catch(b){c={error:b}}finally{try{!v&&!s&&(l=k.return)&&(yield l.call(k))}finally{if(c)throw c.error}}}else o.subscribedQualities.length>0&&(yield(h=f.videoTrack)===null||h===void 0?void 0:h.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.trackPublications.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>C(this,void 0,void 0,function*(){if(o.source===_.Source.ScreenShare||o.source===_.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),ae(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(dr(o)||En(o))try{if(ot())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===_.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),ae(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),ae(o))),dr(o)?yield o.restartTrack({deviceId:"default"}):yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),ae(o))),yield o.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=a}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==ht.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(F.RemoteMute,(n,r)=>{const i=this.trackPublications.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(F.Connected,this.handleReconnected).on(F.SignalRestarted,this.handleReconnected).on(F.SignalResumed,this.handleReconnected).on(F.Restarting,this.handleReconnecting).on(F.Resuming,this.handleReconnecting).on(F.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(F.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(F.Disconnected,this.handleDisconnected).on(F.SignalRequestResponse,this.handleSignalRequestResponse).on(F.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return C(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return C(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return C(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return C(this,arguments,void 0,function(n){var r=this;let{metadata:i,name:a,attributes:o}=n;return function*(){return new Promise((s,c)=>C(r,void 0,void 0,function*(){var l,u;try{let d=!1;const h=yield this.engine.client.sendUpdateLocalMetadata((l=i??this.metadata)!==null&&l!==void 0?l:"",(u=a??this.name)!==null&&u!==void 0?u:"",o),f=performance.now();for(this.pendingSignalRequests.set(h,{resolve:s,reject:v=>{c(v),d=!0},values:{name:a,metadata:i,attributes:o}});performance.now()-f<5e3&&!d;){if((!a||this.name===a)&&(!i||this.metadata===i)&&(!o||Object.entries(o).every(v=>{let[k,S]=v;return this.attributes[k]===S||S===""&&!this.attributes[k]}))){this.pendingSignalRequests.delete(h),s();return}yield ut(50)}c(new Ff("Request to update local metadata timed out","TimeoutError"))}catch(d){d instanceof Error&&c(d)}}))}()})}setCameraEnabled(e,n,r){return this.setTrackEnabled(_.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(_.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(_.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(B.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return C(this,void 0,void 0,function*(){this.encryptionType=e?ht.GCM:ht.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){return C(this,void 0,void 0,function*(){var a,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let s=this.getTrackPublication(e);if(n)if(s)yield s.unmute();else{let c;if(this.pendingPublishing.has(e)){const l=yield this.waitForPendingPublicationOfSource(e);return l||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield l==null?void 0:l.unmute(),l}this.pendingPublishing.add(e);try{switch(e){case _.Source.Camera:c=yield this.createTracks({video:(a=r)!==null&&a!==void 0?a:!0});break;case _.Source.Microphone:c=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case _.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new hn(e)}}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&this.emit(B.MediaDevicesError,l),this.pendingPublishing.delete(e),l}try{const l=[];for(const u of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),ae(u))),l.push(this.publishTrack(u,i));[s]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l}finally{this.pendingPublishing.delete(e)}}else if(!(s!=null&&s.track)&&this.pendingPublishing.has(e)&&(s=yield this.waitForPendingPublicationOfSource(e),s||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),s&&s.track)if(e===_.Source.ScreenShare){s=yield this.unpublishTrack(s.track);const c=this.getTrackPublication(_.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield s.mute();return s})}enableCameraAndMicrophone(){return C(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(_.Source.Camera)||this.pendingPublishing.has(_.Source.Microphone))){this.pendingPublishing.add(_.Source.Camera),this.pendingPublishing.add(_.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(_.Source.Camera),this.pendingPublishing.delete(_.Source.Microphone)}}})}createTracks(e){return C(this,void 0,void 0,function*(){var n,r;e??(e={});const i=ey(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),{audioProcessor:a,videoProcessor:o,optionsWithoutProcessor:s}=mh(i),c=bc(s);let l;try{l=yield navigator.mediaDevices.getUserMedia(c)}catch(u){throw u instanceof Error&&(c.audio&&(this.microphoneError=u),c.video&&(this.cameraError=u)),u}return c.audio&&(this.microphoneError=void 0,this.emit(B.AudioStreamAcquired)),c.video&&(this.cameraError=void 0),Promise.all(l.getTracks().map(u=>C(this,void 0,void 0,function*(){const d=u.kind==="audio";let h;const f=d?c.audio:c.video;typeof f!="boolean"&&(h=f);const v=cy(u,h,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return v.kind===_.Kind.Video?v.source=_.Source.Camera:v.kind===_.Kind.Audio&&(v.source=_.Source.Microphone,v.setAudioContext(this.audioContext)),v.mediaStream=l,Cn(v)&&a?yield v.setProcessor(a):Li(v)&&o&&(yield v.setProcessor(o)),v})))})}createScreenTracks(e){return C(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new ph("getDisplayMedia not supported");e.resolution===void 0&&!C2()&&(e.resolution=fh.h1080fps30.resolution);const n=L2(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new hn("no video track found");const a=new zs(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=_.Source.ScreenShare,e.contentHint&&(a.mediaStreamTrack.contentHint=e.contentHint);const o=[a];if(r.getAudioTracks().length>0){this.emit(B.AudioStreamAcquired);const s=new Fs(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=_.Source.ScreenShareAudio,o.push(s)}return o})}publishTrack(e,n){return C(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return C(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var s,c,l,u;dr(r)&&r.setAudioContext(a.audioContext),yield(s=a.reconnectFuture)===null||s===void 0?void 0:s.promise,a.republishPromise&&!o&&(yield a.republishPromise),fi(r)&&a.pendingPublishPromises.has(r)&&(yield a.pendingPublishPromises.get(r));let d;if(r instanceof MediaStreamTrack)d=r.getConstraints();else{d=r.constraints;let g;switch(r.source){case _.Source.Microphone:g="audioinput";break;case _.Source.Camera:g="videoinput"}g&&a.activeDeviceMap.has(g)&&(d=Object.assign(Object.assign({},d),{deviceId:a.activeDeviceMap.get(g)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new Fs(r,d,!0,a.audioContext,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;case"video":r=new zs(r,d,!0,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;default:throw new hn("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});let h;if(a.trackPublications.forEach(g=>{g.track&&g.track===r&&(h=g)}),h)return a.log.warn("track has already been published, skipping",Object.assign(Object.assign({},a.logContext),ae(h))),h;const f="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,v=(c=i==null?void 0:i.forceStereo)!==null&&c!==void 0?c:f;v&&(i||(i={}),i.dtx===void 0&&a.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},a.logContext),ae(r))),i.red===void 0&&a.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(l=i.dtx)!==null&&l!==void 0||(i.dtx=!1),(u=i.red)!==null&&u!==void 0||(i.red=!1));const k=Object.assign(Object.assign({},a.roomOptions.publishDefaults),i);!S2()&&a.roomOptions.e2ee&&(a.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},a.logContext)),k.simulcast=!1),k.source&&(r.source=k.source);const S=a.publish(r,k,v);a.pendingPublishPromises.set(r,S);try{return yield S}catch(g){throw g}finally{a.pendingPublishPromises.delete(r)}}()})}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),ae(e))),!1;const{canPublish:n,canPublishSources:r}=this.permissions;return n&&(r.length===0||r.map(i=>A2(i)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),ae(e))),!1)}publish(e,n,r){return C(this,void 0,void 0,function*(){var i,a,o,s,c,l,u,d,h,f;if(!this.hasPermissionsToPublish(e))throw new o2("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(m=>fi(e)&&m.source===e.source)&&e.source!==_.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),ae(e))),n.stopMicTrackOnMute&&Cn(e)&&(e.stopOnMute=!0),e.source===_.Source.ScreenShare&&Ei()&&(n.simulcast=!1),n.videoCodec==="av1"&&!y2()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!k2()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Vu),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(m=>n.videoCodec===ns(m.mime))||(n.videoCodec=ns(this.enabledPublishVideoCodecs[0].mime)));const v=n.videoCodec;e.on(j.Muted,this.onTrackMuted),e.on(j.Unmuted,this.onTrackUnmuted),e.on(j.Ended,this.handleTrackEnded),e.on(j.UpstreamPaused,this.onTrackUpstreamPaused),e.on(j.UpstreamResumed,this.onTrackUpstreamResumed),e.on(j.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const k=new Cu({cid:e.mediaStreamTrack.id,name:n.name,type:_.kindToProto(e.kind),muted:e.isMuted,source:_.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((a=n.red)!==null&&a!==void 0)||a),stream:n==null?void 0:n.stream,backupCodecPolicy:n==null?void 0:n.backupCodecPolicy});let S;if(e.kind===_.Kind.Video){let m={width:0,height:0};try{m=yield e.waitForDimensions()}catch{const w=(s=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&s!==void 0?s:qa.h720.resolution;m={width:w.width,height:w.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),ae(e)),{dims:m}))}k.width=m.width,k.height=m.height,En(e)&&(va(v)&&(e.source===_.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),ae(e))))),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),k.simulcastCodecs=[new wu({codec:v,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Vu}),n.backupCodec&&v!==n.backupCodec.codec&&k.encryption===ht.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),k.simulcastCodecs.push(new wu({codec:n.backupCodec.codec,cid:""})))),S=qu(e.source===_.Source.ScreenShare,k.width,k.height,n),k.layers=cm(k.width,k.height,S,va(n.videoCodec))}else e.kind===_.Kind.Audio&&(S=[{maxBitrate:(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate,priority:(d=(u=n.audioPreset)===null||u===void 0?void 0:u.priority)!==null&&d!==void 0?d:"high",networkPriority:(f=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&f!==void 0?f:"high"}]);if(!this.engine||this.engine.isClosed)throw new Oe("cannot publish track when not connected");const g=()=>C(this,void 0,void 0,function*(){var m,w,T;if(!this.engine.pcManager)throw new Oe("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,S),En(e)&&((m=n.degradationPreference)!==null&&m!==void 0||(n.degradationPreference=dx(e)),e.setDegradationPreference(n.degradationPreference)),S)if(Ei()&&e.kind===_.Kind.Audio){let x;for(const E of this.engine.pcManager.publisher.getTransceivers())if(E.sender===e.sender){x=E;break}x&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:x,codec:"opus",maxbr:!((w=S[0])===null||w===void 0)&&w.maxBitrate?S[0].maxBitrate/1e3:0})}else e.codec&&va(e.codec)&&!((T=S[0])===null||T===void 0)&&T.maxBitrate&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:k.cid,codec:e.codec,maxbr:S[0].maxBitrate/1e3});yield this.engine.negotiate()});let b;if(this.enabledPublishVideoCodecs.length>0)b=(yield Promise.all([this.engine.addTrack(k),g()]))[0];else{b=yield this.engine.addTrack(k);let m;if(b.codecs.forEach(w=>{m===void 0&&(m=w.mimeType)}),m&&e.kind===_.Kind.Video){const w=ns(m);w!==v&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),ae(e)),{codec:w})),n.videoCodec=w,S=qu(e.source===_.Source.ScreenShare,k.width,k.height,n))}yield g()}const p=new Ku(e.kind,b,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return p.options=n,e.sid=b.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:S,trackInfo:b})),En(e)?e.startMonitor(this.engine.client):dr(e)&&e.startMonitor(),this.addTrackPublication(p),this.emit(B.LocalTrackPublished,p),p})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){return C(this,void 0,void 0,function*(){var i;if(this.encryptionType!==ht.NONE)return;let a;if(this.trackPublications.forEach(h=>{h.track&&h.track===e&&(a=h)}),!a)throw new hn("track is not published");if(!En(e))throw new hn("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),s=cx(e,n,o);if(!s){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),ae(e)));return}const c=e.addSimulcastTrack(n,s);if(!c)return;const l=new Cu({cid:c.mediaStreamTrack.id,type:_.kindToProto(e.kind),muted:e.isMuted,source:_.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=cm(l.width,l.height,s),!this.engine||this.engine.isClosed)throw new Oe("cannot publish track when not connected");const u=()=>C(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,c,o,s),yield this.engine.negotiate()}),d=(yield Promise.all([this.engine.addTrack(l),u()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:s,trackInfo:d}))})}unpublishTrack(e,n){return C(this,void 0,void 0,function*(){var r,i;if(fi(e)){const l=this.pendingPublishPromises.get(e);l&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),ae(e))),yield l)}const a=this.getPublicationForTrack(e),o=a?ae(a):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!a||!a.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));return}e=a.track,e.off(j.Muted,this.onTrackMuted),e.off(j.Unmuted,this.onTrackUnmuted),e.off(j.Ended,this.handleTrackEnded),e.off(j.UpstreamPaused,this.onTrackUpstreamPaused),e.off(j.UpstreamResumed,this.onTrackUpstreamResumed),e.off(j.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n?e.stop():e.stopMonitor();let s=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Se.FAILED&&c)try{for(const l of this.engine.pcManager.publisher.getTransceivers())l.sender===c&&(l.direction="inactive",s=!0);if(this.engine.removeTrack(c)&&(s=!0),En(e)){for(const[,l]of e.simulcastCodecs)l.sender&&(this.engine.removeTrack(l.sender)&&(s=!0),l.sender=void 0);e.simulcastCodecs.clear()}}catch(l){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:l}))}switch(this.trackPublications.delete(a.trackSid),a.kind){case _.Kind.Audio:this.audioTrackPublications.delete(a.trackSid);break;case _.Kind.Video:this.videoTrackPublications.delete(a.trackSid);break}return this.emit(B.LocalTrackUnpublished,a),a.setTrack(void 0),s&&(yield this.engine.negotiate()),a})}unpublishTracks(e){return C(this,void 0,void 0,function*(){return(yield Promise.all(e.map(n=>this.unpublishTrack(n)))).filter(n=>!!n)})}republishAllTracks(e){return C(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((a,o)=>C(r,void 0,void 0,function*(){try{const s=[];this.trackPublications.forEach(c=>{c.track&&(n&&(c.options=Object.assign(Object.assign({},c.options),n)),s.push(c))}),yield Promise.all(s.map(c=>C(this,void 0,void 0,function*(){const l=c.track;yield this.unpublishTrack(l,!1),i&&!l.isMuted&&l.source!==_.Source.ScreenShare&&l.source!==_.Source.ScreenShareAudio&&(dr(l)||En(l))&&!l.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:c.trackSid})),yield l.restartTrack()),yield this.publishOrRepublishTrack(l,c.options,!0)}))),a()}catch(s){o(s)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return C(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const a=i.reliable?te.RELIABLE:te.LOSSY,o=i.destinationIdentities,s=i.topic,c=new nt({kind:a,value:{case:"user",value:new Z0({participantIdentity:r.identity,payload:n,destinationIdentities:o,topic:s})}});yield r.engine.sendDataPacket(c,a)}()})}publishDtmf(e,n){return C(this,void 0,void 0,function*(){const r=new nt({kind:te.RELIABLE,value:{case:"sipDtmf",value:new Q0({code:e,digit:n})}});yield this.engine.sendDataPacket(r,te.RELIABLE)})}sendChatMessage(e,n){return C(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:n==null?void 0:n.attachments},i=new nt({value:{case:"chatMessage",value:new mu(Object.assign(Object.assign({},r),{timestamp:be.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(i,te.RELIABLE),this.emit(B.ChatMessage,r),r})}editChatMessage(e,n){return C(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),i=new nt({value:{case:"chatMessage",value:new mu(Object.assign(Object.assign({},r),{timestamp:be.parse(r.timestamp),editTimestamp:be.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,te.RELIABLE),this.emit(B.ChatMessage,r),r})}sendText(e,n){return C(this,void 0,void 0,function*(){var r;const i=crypto.randomUUID(),a=new TextEncoder().encode(e).byteLength,o=(r=n==null?void 0:n.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),s=new Array(o?o.length+1:1).fill(0),c=(u,d)=>{var h;s[d]=u;const f=s.reduce((v,k)=>v+k,0);(h=n==null?void 0:n.onProgress)===null||h===void 0||h.call(n,f)},l=yield this.streamText({streamId:i,totalSize:a,destinationIdentities:n==null?void 0:n.destinationIdentities,topic:n==null?void 0:n.topic,attachedStreamIds:o,attributes:n==null?void 0:n.attributes});return yield l.write(e),c(1,0),yield l.close(),n!=null&&n.attachments&&o&&(yield Promise.all(n.attachments.map((u,d)=>C(this,void 0,void 0,function*(){return this._sendFile(o[d],u,{topic:n.topic,mimeType:u.type,onProgress:h=>{c(h,d+1)}})})))),l.info})}streamText(e){return C(this,void 0,void 0,function*(){var n,r;const i=(n=e==null?void 0:e.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),a={id:i,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes},o=new vu({streamId:i,mimeType:a.mimeType,topic:a.topic,timestamp:ur(a.timestamp),totalLength:ur(e==null?void 0:e.totalSize),attributes:a.attributes,contentHeader:{case:"textHeader",value:new ob({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?gu.UPDATE:gu.CREATE})}}),s=e==null?void 0:e.destinationIdentities,c=new nt({destinationIdentities:s,value:{case:"streamHeader",value:o}});yield this.engine.sendDataPacket(c,te.RELIABLE);let l=0;const u=this,d=new WritableStream({write(v){return C(this,void 0,void 0,function*(){for(const k of N2(v,Po)){yield u.engine.waitForBufferStatusLow(te.RELIABLE);const S=new bu({content:k,streamId:i,chunkIndex:ur(l)}),g=new nt({destinationIdentities:s,value:{case:"streamChunk",value:S}});yield u.engine.sendDataPacket(g,te.RELIABLE),l+=1}})},close(){return C(this,void 0,void 0,function*(){const v=new yu({streamId:i}),k=new nt({destinationIdentities:s,value:{case:"streamTrailer",value:v}});yield u.engine.sendDataPacket(k,te.RELIABLE)})},abort(v){console.log("Sink error:",v)}});let h=()=>C(this,void 0,void 0,function*(){yield f.close()});u.engine.once(F.Closing,h);const f=new wx(d,a,()=>this.engine.off(F.Closing,h));return f})}sendFile(e,n){return C(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,n),{id:r}})}_sendFile(e,n,r){return C(this,void 0,void 0,function*(){var i,a;const o=n.size,s=new vu({totalLength:ur(o),mimeType:(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:n.type,streamId:e,topic:r==null?void 0:r.topic,encryptionType:r==null?void 0:r.encryptionType,timestamp:ur(Date.now()),contentHeader:{case:"byteHeader",value:new sb({name:n.name})}}),c=r==null?void 0:r.destinationIdentities,l=new nt({destinationIdentities:c,value:{case:"streamHeader",value:s}});yield this.engine.sendDataPacket(l,te.RELIABLE);function u(v){return new Promise(k=>{const S=new FileReader;S.onload=()=>{k(new Uint8Array(S.result))},S.readAsArrayBuffer(v)})}const d=Math.ceil(o/Po);for(let v=0;v<d;v++){const k=yield u(n.slice(v*Po,Math.min((v+1)*Po,o)));yield this.engine.waitForBufferStatusLow(te.RELIABLE);const S=new bu({content:k,streamId:e,chunkIndex:ur(v)}),g=new nt({destinationIdentities:c,value:{case:"streamChunk",value:S}});yield this.engine.sendDataPacket(g,te.RELIABLE),(a=r==null?void 0:r.onProgress)===null||a===void 0||a.call(r,(v+1)/d)}const h=new yu({streamId:e}),f=new nt({destinationIdentities:c,value:{case:"streamTrailer",value:h}});yield this.engine.sendDataPacket(f,te.RELIABLE)})}performRpc(e){return C(this,arguments,void 0,function(n){var r=this;let{destinationIdentity:i,method:a,payload:o,responseTimeout:s=1e4}=n;return function*(){return new Promise((c,l)=>C(r,void 0,void 0,function*(){var u,d,h,f;if(kh(o)>oy){l(Ee.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((d=(u=this.engine.latestJoinResponse)===null||u===void 0?void 0:u.serverInfo)===null||d===void 0)&&d.version&&Ir((f=(h=this.engine.latestJoinResponse)===null||h===void 0?void 0:h.serverInfo)===null||f===void 0?void 0:f.version,"1.8.0")<0){l(Ee.builtIn("UNSUPPORTED_SERVER"));return}const v=crypto.randomUUID();yield this.publishRpcRequest(i,v,a,o,s-2e3);const k=setTimeout(()=>{this.pendingAcks.delete(v),l(Ee.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(v),clearTimeout(S)},2e3);this.pendingAcks.set(v,{resolve:()=>{clearTimeout(k)},participantIdentity:i});const S=setTimeout(()=>{this.pendingResponses.delete(v),l(Ee.builtIn("RESPONSE_TIMEOUT"))},s);this.pendingResponses.set(v,{resolve:(g,b)=>{clearTimeout(S),this.pendingAcks.has(v)&&(console.warn("RPC response received before ack",v),this.pendingAcks.delete(v),clearTimeout(k)),b?l(b):c(g??"")},participantIdentity:i})}))}()})}registerRpcMethod(e,n){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,r){const i=this.pendingResponses.get(e);i?(i.resolve(n,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,n,r,i,a){return C(this,void 0,void 0,function*(){const o=new nt({destinationIdentities:[e],kind:te.RELIABLE,value:{case:"rpcRequest",value:new J0({id:n,method:r,payload:i,responseTimeoutMs:a,version:1})}});yield this.engine.sendDataPacket(o,te.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:r,resolve:i}]of this.pendingResponses)r===e&&(i(null,Ee.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const a=this.trackPublications.get(n.sid);if(a){const o=a.isMuted||((i=(r=a.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),ae(a)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(dr(i)||En(i))&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}waitForPendingPublicationOfSource(e){return C(this,void 0,void 0,function*(){const n=Date.now();for(;Date.now()<n+1e4;){const r=Array.from(this.pendingPublishPromises.entries()).find(i=>{let[a]=i;return a.source===e});if(r)return r[1];yield ut(20)}})}}class Rx extends un{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Tt.HIGH,this.handleEnded=a=>{this.setTrack(void 0),this.emit(j.Ended,a)},this.handleVisibilityChange=a=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(a),this.logContext),this.disabled=!a,this.emitTrackUpdate()},this.handleVideoDimensionsChange=a=>{this.log.debug("adaptivestream video dimensions ".concat(a.width,"x").concat(a.height),this.logContext),this.videoDimensions=a,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new mc({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new tb({participantSid:"",trackSids:[this.trackSid]})]});this.emit(j.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?un.SubscriptionStatus.Unsubscribed:super.isSubscribed?un.SubscriptionStatus.Subscribed:un.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?un.PermissionStatus.Allowed:un.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(sl(this.track)&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&sl(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(j.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(j.VisibilityChanged,this.handleVisibilityChange),i.off(j.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(j.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(j.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(j.VisibilityChanged,this.handleVisibilityChange),e.on(j.Ended,this.handleEnded),this.emit(j.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(j.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?j.Muted:j.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(j.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(j.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===_.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return sl(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new cb({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=Tt.HIGH,this.emit(j.UpdateSettings,e)}}class Vs extends hy{static fromParticipantInfo(e,n,r){return new Vs(e,n.sid,n.identity,n.name,n.metadata,n.attributes,r,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,r,i,a,o,s){let c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:js.STANDARD;super(n,r||"",i,a,o,s,c),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(j.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),ae(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(j.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(j.SubscriptionPermissionChanged,n=>{this.emit(B.TrackSubscriptionPermissionChanged,e,n)}),e.on(j.SubscriptionStatusChanged,n=>{this.emit(B.TrackSubscriptionStatusChanged,e,n)}),e.on(j.Subscribed,n=>{this.emit(B.TrackSubscribed,n,e)}),e.on(j.Unsubscribed,n=>{this.emit(B.TrackUnsubscribed,n,e)}),e.on(j.SubscriptionFailed,n=>{this.emit(B.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrackPublication(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,a,o){let s=this.getTrackPublicationBySid(n);if(s||n.startsWith("TR")||this.trackPublications.forEach(u=>{!s&&e.kind===u.kind.toString()&&(s=u)}),!s){if(o===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(B.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,a,o-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),ae(s))),this.emit(B.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new Sx(e,n,i,a):l=new Cx(e,n,i,this.audioContext,this.audioOutput),l.source=s.source,l.isMuted=s.isMuted,l.setMediaStream(r),l.start(),s.setTrack(l),this.volumeMap.has(s.source)&&Bu(l)&&Cn(l)&&l.setVolume(this.volumeMap.get(s.source)),s}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var a,o;let s=this.getTrackPublicationBySid(i.sid);if(s)s.updateInfo(i);else{const c=_.kindFromProto(i.type);if(!c)return;s=new Rx(c,i,(a=this.signalClient.connectOptions)===null||a===void 0?void 0:a.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(o=this.loggerOptions)===null||o===void 0?void 0:o.loggerName}),s.updateInfo(i),r.set(i.sid,s);const l=Array.from(this.trackPublications.values()).find(u=>u.source===(s==null?void 0:s.source));l&&s.source!==_.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(s.source),Object.assign(Object.assign({},this.logContext),{oldTrack:ae(l),newTrack:ae(s)})),this.addTrackPublication(s)}n.set(i.sid,s)}),this.trackPublications.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),ae(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(B.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.trackPublications.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case _.Kind.Audio:this.audioTrackPublications.delete(e);break;case _.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(B.TrackUnpublished,r)}setAudioOutput(e){return C(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(r=>{var i;Cn(r.track)&&Bu(r.track)&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var re;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting"})(re||(re={}));const Ix=4*1e3;class Pi extends on.EventEmitter{constructor(e){var n,r,i,a;if(super(),n=this,this.state=re.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=X,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(o,s,c)=>C(this,void 0,void 0,function*(){var l;if(!w2())throw an()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const u=yield this.disconnectLock.lock();if(this.state===re.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),u(),Promise.resolve();if(this.connectFuture)return u(),this.connectFuture.promise;this.setAndEmitConnectionState(re.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Uu(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new $u(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().then(f=>{var v;(v=this.regionUrlProvider)===null||v===void 0||v.setServerReportedRegions(f)}).catch(f=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:f}))}));const d=(f,v,k)=>C(this,void 0,void 0,function*(){var S,g;this.abortController&&this.abortController.abort();const b=new AbortController;this.abortController=b,u==null||u();try{yield this.attemptConnection(k??o,s,c,b),this.abortController=void 0,f()}catch(p){if(this.regionUrlProvider&&p instanceof ue&&p.reason!==ee.Cancelled&&p.reason!==ee.NotAllowed){let m=null;try{m=yield this.regionUrlProvider.getNextBestRegionUrl((S=this.abortController)===null||S===void 0?void 0:S.signal)}catch(w){if(w instanceof ue&&(w.status===401||w.reason===ee.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),v(w);return}}m&&!(!((g=this.abortController)===null||g===void 0)&&g.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(p.message,". Retrying with another region: ").concat(m),this.logContext),this.recreateEngine(),yield d(f,v,m)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Kf(p)),v(p))}else{let m=zt.UNKNOWN_REASON;p instanceof ue&&(m=Kf(p)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,m),v(p)}}}),h=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Xb((f,v)=>{d(f,v,h)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,c,l,u,d)=>C(this,void 0,void 0,function*(){var h,f,v;const k=yield c.join(o,s,{autoSubscribe:l.autoSubscribe,adaptiveStream:typeof u.adaptiveStream=="object"?!0:u.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},d.signal);let S=k.serverInfo;if(S||(S={version:k.serverVersion,region:k.serverRegion}),this.serverInfo=S,this.log.debug("connected to Livekit Server ".concat(Object.entries(S).map(g=>{let[b,p]=g;return"".concat(b,": ").concat(p)}).join(", ")),{room:(h=k.room)===null||h===void 0?void 0:h.name,roomSid:(f=k.room)===null||f===void 0?void 0:f.sid,identity:(v=k.participant)===null||v===void 0?void 0:v.identity}),!S.version)throw new a2("unknown server version");return S.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),u.dynacast=!1),k}),this.applyJoinResponse=o=>{const s=o.participant;if(this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.localParticipant.setEnabledPublishCodecs(o.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(o.sifTrailer)}catch(c){this.log.error(c instanceof Error?c.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:c}))}this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room)},this.attemptConnection=(o,s,c,l)=>C(this,void 0,void 0,function*(){var u,d;this.state===re.Reconnecting||this.isResuming||!((u=this.engine)===null||u===void 0)&&u.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((d=this.regionUrlProvider)===null||d===void 0)&&d.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},yh),c),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const h=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(h),this.setupLocalParticipantEvents(),this.emit(M.SignalConnected)}catch(h){yield this.engine.close(),this.recreateEngine();const f=new ue("could not establish signal connection",ee.ServerUnreachable);throw h instanceof Error&&(f.message="".concat(f.message,": ").concat(h.message)),h instanceof ue&&(f.reason=h.reason,f.status=h.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:h})),f}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new ue("Connection attempt aborted",ee.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(h){throw yield this.engine.close(),this.recreateEngine(),h}ot()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),ot()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(re.Connected),this.emit(M.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return C(n,[...s],void 0,function(){var l=this;let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var d,h,f,v;const k=yield l.disconnectLock.lock();try{if(l.state===re.Disconnected){l.log.debug("already disconnected",l.logContext);return}l.log.info("disconnect from room",Object.assign({},l.logContext)),(l.state===re.Connecting||l.state===re.Reconnecting||l.isResuming)&&(l.log.warn("abort connection attempt",l.logContext),(d=l.abortController)===null||d===void 0||d.abort(),(f=(h=l.connectFuture)===null||h===void 0?void 0:h.reject)===null||f===void 0||f.call(h,new ue("Client initiated disconnect",ee.Cancelled)),l.connectFuture=void 0),!((v=l.engine)===null||v===void 0)&&v.client.isDisconnected||(yield l.engine.client.sendLeave()),l.engine&&(yield l.engine.close()),l.handleDisconnect(u,zt.CLIENT_INITIATED),l.engine=void 0}finally{k()}}()})},this.onPageLeave=()=>C(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>C(this,void 0,void 0,function*(){const o=[],s=Wt();if(s&&s.os==="iOS"){const c="livekit-dummy-audio-el";let l=document.getElementById(c);if(!l){l=document.createElement("audio"),l.id=c,l.autoplay=!0,l.hidden=!0;const u=ol();u.enabled=!0;const d=new MediaStream([u]);l.srcObject=d,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:d,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(M.Disconnected,()=>{l==null||l.remove(),l=null})}o.push(l)}this.remoteParticipants.forEach(c=>{c.audioTrackPublications.forEach(l=>{l.track&&l.track.attachedElements.forEach(u=>{o.push(u)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(c=>(c.muted=!1,c.play()))]),this.handleAudioPlaybackStarted()}catch(c){throw this.handleAudioPlaybackFailed(c),c}}),this.startVideo=()=>C(this,void 0,void 0,function*(){const o=[];for(const s of this.remoteParticipants.values())s.videoTrackPublications.forEach(c=>{var l;(l=c.track)===null||l===void 0||l.attachedElements.forEach(u=>{o.includes(u)||o.push(u)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const o of this.remoteParticipants.values())this.handleParticipantDisconnected(o.identity,o);this.setAndEmitConnectionState(re.Reconnecting)&&this.emit(M.Reconnecting)},this.handleSignalRestarted=o=>C(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(re.Connected),this.emit(M.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{var c;if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}s.identity===""&&(s.identity=(c=this.sidToIdentity.get(s.sid))!==null&&c!==void 0?c:"");let l=this.remoteParticipants.get(s.identity);s.state===fu.DISCONNECTED?this.handleParticipantDisconnected(s.identity,l):l=this.getOrCreateParticipant(s.identity,s)})},this.handleActiveSpeakersUpdate=o=>{const s=[],c={};o.forEach(l=>{if(c[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const u=this.getRemoteParticipantBySid(l.sid);u&&(u.audioLevel=l.level,u.setIsSpeaking(!0),s.push(u))}}),c[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(l=>{c[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(M.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(l=>{const u=this.remoteParticipants.get(l.identity);u&&u.sid!==l.sid||s.set(l.sid,l)}),o.forEach(l=>{let u=this.getRemoteParticipantBySid(l.sid);l.sid===this.localParticipant.sid&&(u=this.localParticipant),u&&(u.audioLevel=l.level,u.setIsSpeaking(l.active),l.active?s.set(l.sid,u):s.delete(l.sid))});const c=Array.from(s.values());c.sort((l,u)=>u.audioLevel-l.audioLevel),this.activeSpeakers=c,this.emitWhenConnected(M.ActiveSpeakersChanged,c)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const c=this.getRemoteParticipantBySid(s.participantSid);if(!c)return;const l=c.getTrackPublicationBySid(s.trackSid);if(!l||!l.track)return;const u=_.streamStateFromProto(s.state);u!==l.track.streamState&&(l.track.streamState=u,c.emit(B.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(M.TrackStreamStateChanged,l,l.track.streamState,c))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.getRemoteParticipantBySid(o.participantSid);if(!s)return;const c=s.getTrackPublicationBySid(o.trackSid);c&&c.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.remoteParticipants.values()).find(l=>l.trackPublications.has(o.trackSid));if(!s)return;const c=s.getTrackPublicationBySid(o.trackSid);c&&c.setSubscriptionError(o.err)},this.handleDataPacket=o=>{const s=this.remoteParticipants.get(o.participantIdentity);if(o.value.case==="user")this.handleUserPacket(s,o.value.value,o.kind);else if(o.value.case==="transcription")this.handleTranscription(s,o.value.value);else if(o.value.case==="sipDtmf")this.handleSipDtmf(s,o.value.value);else if(o.value.case==="chatMessage")this.handleChatMessage(s,o.value.value);else if(o.value.case==="metrics")this.handleMetrics(o.value.value,s);else if(o.value.case==="streamHeader")this.handleStreamHeader(o.value.value,o.participantIdentity);else if(o.value.case==="streamChunk")this.handleStreamChunk(o.value.value);else if(o.value.case==="streamTrailer")this.handleStreamTrailer(o.value.value);else if(o.value.case==="rpcRequest"){const c=o.value.value;this.handleIncomingRpcRequest(o.participantIdentity,c.id,c.method,c.payload,c.responseTimeoutMs,c.version)}},this.handleUserPacket=(o,s,c)=>{this.emit(M.DataReceived,s.payload,o,c,s.topic),o==null||o.emit(B.DataReceived,s.payload,c)},this.handleSipDtmf=(o,s)=>{this.emit(M.SipDTMFReceived,s,o),o==null||o.emit(B.SipDTMFReceived,s)},this.bufferedSegments=new Map,this.handleTranscription=(o,s)=>{const c=s.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(s.transcribedParticipantIdentity),l=c==null?void 0:c.trackPublications.get(s.trackId),u=R2(s,this.transcriptionReceivedTimes);l==null||l.emit(j.TranscriptionReceived,u),c==null||c.emit(B.TranscriptionReceived,u,l),this.emit(M.TranscriptionReceived,u,c,l)},this.handleChatMessage=(o,s)=>{const c=I2(s);this.emit(M.ChatMessage,c,o)},this.handleMetrics=(o,s)=>{this.emit(M.MetricsReceived,o,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(M.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(M.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(M.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(M.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>C(this,void 0,void 0,function*(){var o,s;const c=je.getInstance().previousDevices,l=yield je.getInstance().getDevices(void 0,!1),u=Wt();if((u==null?void 0:u.name)==="Chrome"&&u.os!=="iOS")for(let h of l){const f=c.find(v=>v.deviceId===h.deviceId);f&&f.label!==""&&f.kind===h.kind&&f.label!==h.label&&this.getActiveDevice(h.kind)==="default"&&this.emit(M.ActiveDeviceChanged,h.kind,h.deviceId)}const d=["audiooutput","audioinput","videoinput"];for(let h of d){const f=l.filter(k=>k.kind===h),v=this.getActiveDevice(h);if(v===((o=c.filter(k=>k.kind===h)[0])===null||o===void 0?void 0:o.deviceId)&&f.length>0&&((s=f[0])===null||s===void 0?void 0:s.deviceId)!==v){yield this.switchActiveDevice(h,f[0].deviceId);continue}h==="audioinput"&&!Yn()||h==="videoinput"||f.length>0&&!f.find(k=>k.deviceId===this.getActiveDevice(h))&&(yield this.switchActiveDevice(h,f[0].deviceId))}this.emit(M.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(M.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(M.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const c=this.getRemoteParticipantBySid(s.participantSid);c&&c.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(M.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(M.ParticipantNameChanged,o,this.localParticipant)},this.onLocalAttributesChanged=o=>{this.emit(M.ParticipantAttributesChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(M.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(M.TrackUnmuted,o,this.localParticipant)},this.onTrackProcessorUpdate=o=>{var s;(s=o==null?void 0:o.onPublish)===null||s===void 0||s.call(o,this)},this.onLocalTrackPublished=o=>C(this,void 0,void 0,function*(){var s,c,l,u,d,h;(s=o.track)===null||s===void 0||s.on(j.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.on(j.Restarted,this.onLocalTrackRestarted),(d=(u=(l=o.track)===null||l===void 0?void 0:l.getProcessor())===null||u===void 0?void 0:u.onPublish)===null||d===void 0||d.call(u,this),this.emit(M.LocalTrackPublished,o,this.localParticipant),dr(o.track)&&(yield o.track.checkForSilence())&&this.emit(M.LocalAudioSilenceDetected,o);const f=yield(h=o.track)===null||h===void 0?void 0:h.getDeviceId(!1),v=Gf(o.source);v&&f&&f!==this.localParticipant.activeDeviceMap.get(v)&&(this.localParticipant.activeDeviceMap.set(v,f),this.emit(M.ActiveDeviceChanged,v,f))}),this.onLocalTrackUnpublished=o=>{var s,c;(s=o.track)===null||s===void 0||s.off(j.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.off(j.Restarted,this.onLocalTrackRestarted),this.emit(M.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalTrackRestarted=o=>C(this,void 0,void 0,function*(){const s=yield o.getDeviceId(!1),c=Gf(o.source);c&&s&&s!==this.localParticipant.activeDeviceMap.get(c)&&(this.log.debug("local track restarted, setting ".concat(c," ").concat(s," active"),this.logContext),this.localParticipant.activeDeviceMap.set(c,s),this.emit(M.ActiveDeviceChanged,c,s))}),this.onLocalConnectionQualityChanged=o=>{this.emit(M.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(M.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(M.ParticipantPermissionsChanged,o,this.localParticipant)},this.onLocalChatMessageSent=o=>{this.emit(M.ChatMessage,o,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},X2),e),this.log=wn((r=this.options.loggerName)!==null&&r!==void 0?r:$t.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},iy),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},ay),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Y2),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new mt,this.localParticipant=new Px("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Gn(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Gn(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",Gn(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),ot()){const o=new AbortController;(a=navigator.mediaDevices)===null||a===void 0||a.addEventListener("devicechange",this.handleDeviceChange,{signal:o.signal}),Pi.cleanupRegistry&&Pi.cleanupRegistry.register(this,()=>{o.abort()})}}registerTextStreamHandler(e,n){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,n)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,n){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,n)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,n){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,n,r,i,a,o){return C(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,n),o!==1){yield this.engine.publishRpcResponse(e,n,null,Ee.builtIn("UNSUPPORTED_VERSION"));return}const s=this.rpcHandlers.get(r);if(!s){yield this.engine.publishRpcResponse(e,n,null,Ee.builtIn("UNSUPPORTED_METHOD"));return}let c=null,l=null;try{const u=yield s({requestId:n,callerIdentity:e,payload:i,responseTimeout:a});kh(u)>oy?(c=Ee.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):l=u}catch(u){u instanceof Ee?c=u:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),u),c=Ee.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,n,l,c)})}setE2EEEnabled(e){return C(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new U2(this.options.e2ee),this.e2eeManager.on(Un.ParticipantEncryptionStatusChanged,(n,r)=>{O2(r)&&(this.isE2EEEnabled=n),this.emit(M.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Un.EncryptionError,n=>this.emit(M.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return C(this,void 0,void 0,function*(){return this.state===re.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const r=i=>{i.sid!==""&&(this.engine.off(F.RoomUpdate,r),e(i.sid))};this.engine.on(F.RoomUpdate,r),this.once(M.Disconnected,()=>{this.engine.off(F.RoomUpdate,r),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new fx(this.options),this.engine.on(F.ParticipantUpdate,this.handleParticipantUpdates).on(F.RoomUpdate,this.handleRoomUpdate).on(F.SpeakersChanged,this.handleSpeakersChanged).on(F.StreamStateChanged,this.handleStreamStateUpdate).on(F.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(F.SubscriptionError,this.handleSubscriptionError).on(F.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(F.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(F.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(F.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(F.DataPacketReceived,this.handleDataPacket).on(F.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(re.SignalReconnecting)&&this.emit(M.SignalReconnecting)}).on(F.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(re.Connected)&&this.emit(M.Reconnected)}).on(F.SignalResumed,()=>{this.bufferedEvents=[],(this.state===re.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(F.Restarting,this.handleRestarting).on(F.SignalRestarted,this.handleSignalRestarted).on(F.Offline,()=>{this.setAndEmitConnectionState(re.Reconnecting)&&this.emit(M.Reconnecting)}).on(F.DCBufferStatusChanged,(e,n)=>{this.emit(M.DCBufferStatusChanged,e,n)}).on(F.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:i}=r;return i===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(B.LocalTrackSubscribed,n),this.emitWhenConnected(M.LocalTrackSubscribed,n,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return je.getInstance().getDevices(e,n)}prepareConnection(e,n){return C(this,void 0,void 0,function*(){if(this.state===re.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Uu(new URL(e))&&n){this.regionUrlProvider=new $u(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===re.Disconnected&&(this.regionUrl=r,yield fetch(Fu(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(Fu(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return C(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Zt({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Zt({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Zt({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Zt({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>C(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Zt({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>C(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Zt({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Zt({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>C(this,void 0,void 0,function*(){const a=this.engine.client.onLeave;a&&a(new gc({reason:zt.CLIENT_INITIATED,action:di.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Zt({scenario:{case:"subscriberBandwidth",value:ur(n)}});break;case"leave-full-reconnect":i=new Zt({scenario:{case:"leaveRequestFullReconnect",value:!0}})}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return C(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var s,c,l,u,d,h,f,v;let k=!0,S=!1;const g=o?{exact:i}:i;if(r==="audioinput"){S=a.localParticipant.audioTrackPublications.size===0;const b=(s=a.getActiveDevice(r))!==null&&s!==void 0?s:a.options.audioCaptureDefaults.deviceId;a.options.audioCaptureDefaults.deviceId=g;const p=Array.from(a.localParticipant.audioTrackPublications.values()).filter(m=>m.source===_.Source.Microphone);try{k=(yield Promise.all(p.map(m=>{var w;return(w=m.audioTrack)===null||w===void 0?void 0:w.setDeviceId(g)}))).every(m=>m===!0)}catch(m){throw a.options.audioCaptureDefaults.deviceId=b,m}}else if(r==="videoinput"){S=a.localParticipant.videoTrackPublications.size===0;const b=(c=a.getActiveDevice(r))!==null&&c!==void 0?c:a.options.videoCaptureDefaults.deviceId;a.options.videoCaptureDefaults.deviceId=g;const p=Array.from(a.localParticipant.videoTrackPublications.values()).filter(m=>m.source===_.Source.Camera);try{k=(yield Promise.all(p.map(m=>{var w;return(w=m.videoTrack)===null||w===void 0?void 0:w.setDeviceId(g)}))).every(m=>m===!0)}catch(m){throw a.options.videoCaptureDefaults.deviceId=b,m}}else if(r==="audiooutput"){if(!Au()&&!a.options.webAudioMix||a.options.webAudioMix&&a.audioContext&&!("setSinkId"in a.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");a.options.webAudioMix&&(i=(l=yield je.getInstance().normalizeDeviceId("audiooutput",i))!==null&&l!==void 0?l:""),(u=(v=a.options).audioOutput)!==null&&u!==void 0||(v.audioOutput={});const b=(d=a.getActiveDevice(r))!==null&&d!==void 0?d:a.options.audioOutput.deviceId;a.options.audioOutput.deviceId=i;try{a.options.webAudioMix&&((h=a.audioContext)===null||h===void 0||h.setSinkId(i)),yield Promise.all(Array.from(a.remoteParticipants.values()).map(p=>p.setAudioOutput({deviceId:i})))}catch(p){throw a.options.audioOutput.deviceId=b,p}}return(S||r==="audiooutput")&&(a.localParticipant.activeDeviceMap.set(r,r==="audiooutput"&&((f=a.options.audioOutput)===null||f===void 0?void 0:f.deviceId)||i),a.emit(M.ActiveDeviceChanged,r,i)),k}()})}setupLocalParticipantEvents(){this.localParticipant.on(B.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(B.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(B.AttributesChanged,this.onLocalAttributesChanged).on(B.TrackMuted,this.onLocalTrackMuted).on(B.TrackUnmuted,this.onLocalTrackUnmuted).on(B.LocalTrackPublished,this.onLocalTrackPublished).on(B.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(B.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(B.MediaDevicesError,this.onMediaDevicesError).on(B.AudioStreamAcquired,this.startAudio).on(B.ChatMessage,this.onLocalChatMessageSent).on(B.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===re.Connecting||this.state===re.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(M.Reconnected,u),this.off(M.Connected,u),this.off(M.Disconnected,d)};this.once(M.Reconnected,u),this.once(M.Connected,u),this.once(M.Disconnected,d);return}if(this.state===re.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const i=b2(n.id),a=i[0];let o=i[1],s=e.id;if(o&&o.startsWith("TR")&&(s=o),a===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=Array.from(this.remoteParticipants.values()).find(u=>u.sid===a);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(a),this.logContext);return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,s,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==re.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(i=>{i.trackPublications.forEach(a=>{i.unpublishTrack(a.trackSid)})}),this.localParticipant.trackPublications.forEach(i=>{var a,o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e?((a=i.track)===null||a===void 0||a.detach(),(o=i.track)===null||o===void 0||o.stop()):(s=i.track)===null||s===void 0||s.stopMonitor()}),this.localParticipant.off(B.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(B.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(B.AttributesChanged,this.onLocalAttributesChanged).off(B.TrackMuted,this.onLocalTrackMuted).off(B.TrackUnmuted,this.onLocalTrackUnmuted).off(B.LocalTrackPublished,this.onLocalTrackPublished).off(B.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(B.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(B.MediaDevicesError,this.onMediaDevicesError).off(B.AudioStreamAcquired,this.startAudio).off(B.ChatMessage,this.onLocalChatMessageSent).off(B.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),ot()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(re.Disconnected),this.emit(M.Disconnected,n)}}}handleParticipantDisconnected(e,n){var r;this.remoteParticipants.delete(e),n&&(n.trackPublications.forEach(i=>{n.unpublishTrack(i.trackSid,!0)}),this.emit(M.ParticipantDisconnected,n),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(n.identity))}handleStreamHeader(e,n){return C(this,void 0,void 0,function*(){var r;if(e.contentHeader.case==="byteHeader"){const i=this.byteStreamHandlers.get(e.topic);if(!i){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let a;const o={id:e.streamId,name:(r=e.contentHeader.value.name)!==null&&r!==void 0?r:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:ts(e.timestamp),attributes:e.attributes},s=new ReadableStream({start:c=>{a=c,this.byteStreamControllers.set(e.streamId,{info:o,controller:a,startTime:Date.now()})}});i(new bx(o,s,ts(e.totalLength)),{identity:n})}else if(e.contentHeader.case==="textHeader"){const i=this.textStreamHandlers.get(e.topic);if(!i){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let a;const o={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},s=new ReadableStream({start:c=>{a=c,this.textStreamControllers.set(e.streamId,{info:o,controller:a,startTime:Date.now()})}});i(new yx(o,s,ts(e.totalLength)),{identity:n})}})}handleStreamChunk(e){const n=this.byteStreamControllers.get(e.streamId);n&&e.content.length>0&&n.controller.enqueue(e);const r=this.textStreamControllers.get(e.streamId);r&&e.content.length>0&&r.controller.enqueue(e)}handleStreamTrailer(e){const n=this.textStreamControllers.get(e.streamId);n&&(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.textStreamControllers.delete(e.streamId));const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.byteStreamControllers.delete(e.streamId))}acquireAudioContext(){return C(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=ny())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),ut(200)])}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(M.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=Vs.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):i=new Vs(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const i=this.remoteParticipants.get(e);return n&&i.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),i}const r=this.createParticipant(e,n);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(M.ParticipantConnected,r),r.on(B.TrackPublished,i=>{this.emitWhenConnected(M.TrackPublished,i,r)}).on(B.TrackSubscribed,(i,a)=>{i.kind===_.Kind.Audio?(i.on(j.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(j.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===_.Kind.Video&&(i.on(j.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(j.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(M.TrackSubscribed,i,a,r)}).on(B.TrackUnpublished,i=>{this.emit(M.TrackUnpublished,i,r)}).on(B.TrackUnsubscribed,(i,a)=>{this.emit(M.TrackUnsubscribed,i,a,r)}).on(B.TrackMuted,i=>{this.emitWhenConnected(M.TrackMuted,i,r)}).on(B.TrackUnmuted,i=>{this.emitWhenConnected(M.TrackUnmuted,i,r)}).on(B.ParticipantMetadataChanged,i=>{this.emitWhenConnected(M.ParticipantMetadataChanged,i,r)}).on(B.ParticipantNameChanged,i=>{this.emitWhenConnected(M.ParticipantNameChanged,i,r)}).on(B.AttributesChanged,i=>{this.emitWhenConnected(M.ParticipantAttributesChanged,i,r)}).on(B.ConnectionQualityChanged,i=>{this.emitWhenConnected(M.ConnectionQualityChanged,i,r)}).on(B.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(M.ParticipantPermissionsChanged,i,r)}).on(B.TrackSubscriptionStatusChanged,(i,a)=>{this.emitWhenConnected(M.TrackSubscriptionStatusChanged,i,a,r)}).on(B.TrackSubscriptionFailed,(i,a)=>{this.emit(M.TrackSubscriptionFailed,i,r,a)}).on(B.TrackSubscriptionPermissionChanged,(i,a)=>{this.emitWhenConnected(M.TrackSubscriptionPermissionChanged,i,a,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,i)=>(r.push(...i.getTrackPublications()),r),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&_2(n)&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=ze.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,zt.STATE_MISMATCH))):e=0},Ix)}clearConnectionReconcile(){this.connectionReconcileInterval&&ze.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(M.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(this.state===re.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===re.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return C(this,void 0,void 0,function*(){var n,r;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),a=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new oh({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:be.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Ha({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(M.SignalConnected),this.emit(M.Connected),this.setAndEmitConnectionState(re.Connected),i.video){const o=new Ku(_.Kind.Video,new ti({source:Ie.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ft.AUDIO,name:"video-dummy"}),new zs(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Wf(160*((n=a.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(B.LocalTrackPublished,o)}if(i.audio){const o=new Ku(_.Kind.Audio,new ti({source:Ie.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ft.AUDIO}),new Fs(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:ol(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(B.LocalTrackPublished,o)}for(let o=0;o<a.count-1;o+=1){let s=new Ha({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:fu.ACTIVE,tracks:[],joinedAt:be.parse(Date.now())});const c=this.getOrCreateParticipant(s.identity,s);if(a.video){const l=Wf(160*((r=a.aspectRatios[o%a.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new ti({source:Ie.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Ft.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l]),new RTCRtpReceiver),s.tracks=[...s.tracks,u]}if(a.audio){const l=ol(),u=new ti({source:Ie.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Ft.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l]),new RTCRtpReceiver),s.tracks=[...s.tracks,u]}c.updateInfo(s)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==M.ActiveSpeakersChanged&&e!==M.TranscriptionReceived){const a=py(r).filter(o=>o!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:a}))}return super.emit(e,...r)}}Pi.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{t()});function py(t){return t.map(e=>{if(e)return Array.isArray(e)?py(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var jt;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(jt||(jt={}));class rr extends on.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=jt.IDLE,this.logs=[],this.options={},this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Pi(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return C(this,void 0,void 0,function*(){if(this.status!==jt.IDLE)throw Error("check is running already");this.setStatus(jt.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==jt.SKIPPED&&this.setStatus(this.isSuccess()?jt.SUCCESS:jt.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return C(this,void 0,void 0,function*(){return this.room.state===re.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return C(this,void 0,void 0,function*(){this.room&&this.room.state!==re.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(jt.SKIPPED)}switchProtocol(e){return C(this,void 0,void 0,function*(){let n=!1,r=!1;if(this.room.on(M.Reconnecting,()=>{n=!0}),this.room.once(M.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(a=>setTimeout(a,1e3)),!n)return;const i=Date.now()+1e4;for(;Date.now()<i;){if(r)return;yield ut(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class _x extends rr{get description(){return"Cloud regions"}perform(){return C(this,void 0,void 0,function*(){const e=new $u(this.url,this.token);if(!e.isCloud()){this.skip();return}const n=[],r=new Set;for(let a=0;a<3;a++){const o=yield e.getNextBestRegionUrl();if(!o)break;if(r.has(o))continue;r.add(o);const s=yield this.checkCloudRegion(o);this.appendMessage("".concat(s.region," RTT: ").concat(s.rtt,"ms, duration: ").concat(s.duration,"ms")),n.push(s)}n.sort((a,o)=>(a.duration-o.duration)*.5+(a.rtt-o.rtt)*.5);const i=n[0];this.bestStats=i,this.appendMessage("best Cloud region: ".concat(i.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return C(this,void 0,void 0,function*(){var n,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const i=(n=this.room.serverInfo)===null||n===void 0?void 0:n.region;if(!i)throw new Error("Region not found");const a=yield this.room.localParticipant.streamText({topic:"test"}),o=1e3,s=1e6/o,c="A".repeat(o),l=Date.now();for(let f=0;f<s;f++)yield a.write(c);yield a.close();const u=Date.now(),d=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),h={region:i,rtt:1e4,duration:u-l};return d==null||d.forEach(f=>{f.type==="candidate-pair"&&f.nominated&&(h.rtt=f.currentRoundTripTime*1e3)}),yield this.disconnect(),h})}}const fl=1e4;class Ox extends rr{get description(){return"Connection via UDP vs TCP"}perform(){return C(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),n=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-n.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-n.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=n):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(fl/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(fl/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return C(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const n=document.createElement("canvas");n.width=1280,n.height=720;const r=n.getContext("2d");if(!r)throw new Error("Could not get canvas context");let i=0;const a=()=>{i=(i+1)%360,r.fillStyle="hsl(".concat(i,", 100%, 50%)"),r.fillRect(0,0,n.width,n.height),requestAnimationFrame(a)};a();const o=n.captureStream(30).getVideoTracks()[0],s=(yield this.room.localParticipant.publishTrack(o,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,c={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},l=setInterval(()=>C(this,void 0,void 0,function*(){const u=yield s.getRTCStatsReport();u==null||u.forEach(d=>{d.type==="outbound-rtp"?(c.packetsSent=d.packetsSent,c.qualityLimitationDurations=d.qualityLimitationDurations,c.bitrateTotal+=d.targetBitrate,c.count++):d.type==="remote-inbound-rtp"&&(c.packetsLost=d.packetsLost,c.rttTotal+=d.roundTripTime,c.jitterTotal+=d.jitter)})}),1e3);return yield new Promise(u=>setTimeout(u,fl)),clearInterval(l),o.stop(),n.remove(),yield this.disconnect(),c})}}function fy(t){return C(this,void 0,void 0,function*(){var e,n;t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio={deviceId:"default"}),(n=t.video)!==null&&n!==void 0||(t.video={deviceId:"default"});const{audioProcessor:r,videoProcessor:i}=mh(t),a=ey(t,iy,ay),o=bc(a),s=navigator.mediaDevices.getUserMedia(o);t.audio&&(je.userMediaPromiseMap.set("audioinput",s),s.catch(()=>je.userMediaPromiseMap.delete("audioinput"))),t.video&&(je.userMediaPromiseMap.set("videoinput",s),s.catch(()=>je.userMediaPromiseMap.delete("videoinput")));const c=yield s;return Promise.all(c.getTracks().map(l=>C(this,void 0,void 0,function*(){const u=l.kind==="audio";u?a.audio:a.video;let d;const h=u?o.audio:o.video;typeof h!="boolean"&&(d=h);const f=l.getSettings().deviceId;d!=null&&d.deviceId&&Gn(d.deviceId)!==f?d.deviceId=f:d||(d={deviceId:f});const v=cy(l,d);return v.kind===_.Kind.Video?v.source=_.Source.Camera:v.kind===_.Kind.Audio&&(v.source=_.Source.Microphone),v.mediaStream=c,Cn(v)&&r?yield v.setProcessor(r):Li(v)&&i&&(yield v.setProcessor(i)),v})))})}function Nx(t){return C(this,void 0,void 0,function*(){return(yield fy({audio:!1,video:t}))[0]})}function Lx(t){return C(this,void 0,void 0,function*(){return(yield fy({audio:t,video:!1}))[0]})}class Mx extends rr{get description(){return"Can publish audio"}perform(){return C(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield Lx();if(yield ty(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let a=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="audio"||!o.kind&&o.mediaType==="audio")&&(a=o.packetsSent)}),a===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(a," audio packets"))})}}class Dx extends rr{get description(){return"Can publish video"}perform(){return C(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield Nx();yield this.checkForVideo(r.mediaStreamTrack),n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,5e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let a=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="video"||!o.kind&&o.mediaType==="video")&&(a+=o.packetsSent)}),a===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(a," video packets"))})}checkForVideo(e){return C(this,void 0,void 0,function*(){const n=new MediaStream;n.addTrack(e.clone());const r=document.createElement("video");r.srcObject=n,r.muted=!0,yield new Promise(i=>{r.onplay=()=>{setTimeout(()=>{var a,o,s,c;const l=document.createElement("canvas"),u=e.getSettings(),d=(o=(a=u.width)!==null&&a!==void 0?a:r.videoWidth)!==null&&o!==void 0?o:1280,h=(c=(s=u.height)!==null&&s!==void 0?s:r.videoHeight)!==null&&c!==void 0?c:720;l.width=d,l.height=h;const f=l.getContext("2d");f.drawImage(r,0,0);const v=f.getImageData(0,0,l.width,l.height).data;let k=!0;for(let S=0;S<v.length;S+=4)if(v[S]!==0||v[S+1]!==0||v[S+2]!==0){k=!1;break}k?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),i()},1e3)},r.play()}),r.remove()})}}class jx extends rr{get description(){return"Resuming connection after interruption"}perform(){return C(this,void 0,void 0,function*(){var e;const n=yield this.connect();let r=!1,i=!1,a;const o=new Promise(l=>{setTimeout(l,5e3),a=l}),s=()=>{r=!0};n.on(M.SignalReconnecting,s).on(M.Reconnecting,s).on(M.Reconnected,()=>{i=!0,a(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const c=n.engine.client.onClose;if(c&&c(""),yield o,r){if(!i||n.state!==re.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Ax extends rr{get description(){return"Can connect via TURN"}perform(){return C(this,void 0,void 0,function*(){var e,n;const r=new gh,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let a=!1,o=!1,s=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(o=!0,s=!0):l.startsWith("turns:")&&(o=!0,s=!0,a=!0),l.startsWith("stun:")&&(s=!0);s?o&&!a&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class Ux extends rr{get description(){return"Establishing WebRTC connection"}perform(){return C(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(M.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,a)=>{if(i.candidate){const o=new RTCIceCandidate(i);let s="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(Fx(o.address)?s+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,s+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(s)}r&&r(i,a)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),X.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Fx(t){const e=t.split(".");if(e.length===4){if(e[0]==="10"||e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class Bx extends rr{get description(){return"Connecting to signal connection via WebSocket"}perform(){return C(this,void 0,void 0,function*(){var e,n,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new gh;const a=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(a.serverVersion,".")),((e=a.serverInfo)===null||e===void 0?void 0:e.edition)===nb.Cloud&&!((n=a.serverInfo)===null||n===void 0)&&n.region&&this.appendMessage("LiveKit Cloud: ".concat((r=a.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class P3 extends on.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:jt.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==jt.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return C(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token,this.options),i=o=>{this.updateCheck(n,o)};r.on("update",i);const a=yield r.run();return r.off("update",i),a})}checkWebsocket(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(Bx)})}checkWebRTC(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(Ux)})}checkTURN(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(Ax)})}checkReconnect(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(jx)})}checkPublishAudio(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(Mx)})}checkPublishVideo(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(Dx)})}checkConnectionProtocol(){return C(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(Ox);if(e.data&&"protocol"in e.data){const n=e.data;this.options.protocol=n.protocol}return e})}checkCloudRegion(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(_x)})}}const zx=t=>{const e=new TextDecoder().decode(t);if(e!==null&&typeof e=="object")return e;try{const n=JSON.parse(e);if(n===null||typeof n!="object")throw new Error("Invalid parsed");return n}catch{return null}},my=({active:t,micEnabled:e,speakersEnabled:n,handler:r,context:i})=>{const a=A.useRef(null),[o,s]=A.useState("inactive"),[c,l]=cf(!1,600),u=A.useRef(null),[d,h]=A.useState(null),[f,v]=A.useState(null);A.useEffect(()=>{const p=a.current;p!=null&&p.localParticipant.setMicrophoneEnabled(e).catch(m=>{console.warn(m)})},[e]),A.useEffect(()=>{const p=u.current;p!=null&&(p.volume=n?1:0)},[n]),A.useEffect(()=>{(async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0});const p=await navigator.mediaDevices.enumerateDevices(),m=p.filter(w=>w.kind==="audiooutput").map(w=>w.label);h({micAllowed:!0,micNames:p.filter(w=>w.kind==="audioinput").map(w=>w.label),speakerNames:m.length>0?m:["System Default Speaker Device"]})}catch(p){console.warn(p),h({micAllowed:!1,micNames:[],speakerNames:[]})}})()},[h]);const[k,S]=cf(!1,600),g=A.useCallback(()=>{a.current!=null&&(a.current.disconnect().catch(p=>{console.warn(p)}),r.terminateVoiceCall(),a.current=null,u.current!=null&&(u.current.pause(),u.current=null),v(null))},[v]);A.useEffect(()=>{const p=()=>{g()};return window.addEventListener("beforeunload",p),()=>{window.removeEventListener("beforeunload",p)}},[g]);const b=A.useCallback(async()=>{try{s("pending");const p=await r.getVoiceCredentials(i),m=E=>{const O=E.some(U=>U.isAgent),N=E.some(U=>U.isLocal);S(O),l(N)},w=E=>{if(E.kind===_.Kind.Audio){const O=E.attach();O.play(),u.current=O}},T=E=>{l(E)},x=new Pi;a.current=x,await x.prepareConnection(p.url,p.token),x.on(M.TrackSubscribed,w),x.on(M.ActiveSpeakersChanged,m),x.localParticipant.on(B.IsSpeakingChanged,T),x.on(M.Disconnected,()=>{s("terminated"),l(!1),S(!1),g()}),x.on(M.DataReceived,(E,O)=>{v({modalities:zx(E)??{},from:O==null?void 0:O.identity,timestamp:Date.now()})}),await x.connect(p.url,p.token,{autoSubscribe:!0}),await x.localParticipant.setMicrophoneEnabled(!0),await x.startAudio(),s("active")}catch(p){s("error"),console.warn(p),r.terminateVoiceCall().catch(m=>{console.warn(m)})}},[s,r,l,S]);return A.useEffect(()=>(t&&b(),g),[t,g,b]),{roomState:o,isUserSpeaking:c,isApplicationSpeaking:k,soundCheck:d,roomData:f}},gy=({soundCheck:t})=>y.jsxs("div",{className:"space-y-4 text-primary-80",children:[y.jsx("p",{children:"Get ready to join a voice experience. Please ensure your microphone and speakers are turned on and functioning."}),t!=null?y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex items-center gap-2 text-primary-80",children:[y.jsx("span",{className:Y("block w-10 h-10 p-2 flex-none",t.micAllowed?"":"text-error-primary"),children:t.micAllowed?y.jsx(dc,{}):y.jsx(nh,{})}),y.jsx("input",{className:"p-2 rounded-inner bg-primary-5 w-full flex-grow text-primary-80",value:t.micNames[0],placeholder:"Mic not found",disabled:!0})]}),y.jsxs("div",{className:"flex items-center gap-2 text-primary-80",children:[y.jsx("span",{className:Y("block w-10 h-10 p-2 flex-none",t.speakerNames[0]!=null?"":"text-error-primary"),children:t.speakerNames[0]!=null?y.jsx(hc,{}):y.jsx(pc,{})}),y.jsx("input",{className:"p-2 rounded-inner bg-primary-5 w-full flex-grow text-primary-80",value:t.speakerNames[0],placeholder:"Speaker not found",disabled:!0})]})]}):null]}),Qi=({className:t,children:e})=>y.jsx("div",{className:Y("relative flex flex-col items-center justify-center",t),children:e}),Vx=({handler:t,speakersEnabled:e,colorMode:n,brandIcon:r,className:i,active:a,setActive:o,initializeConversation:s,context:c,customModalities:l={}})=>{const[u,d]=A.useState(!0),{roomState:h,soundCheck:f,isUserSpeaking:v,isApplicationSpeaking:k,roomData:S}=my({active:a,micEnabled:u,speakersEnabled:e,handler:t,context:c});return a?h==="pending"?y.jsx(Qi,{className:i,children:y.jsx(R0,{})}):h==="error"?y.jsx(Qi,{className:i,children:y.jsx(P0,{})}):h==="terminated"?y.jsx(Qi,{className:i,children:y.jsxs("div",{className:Y("flex-grow flex flex-col items-center justify-center gap-6 text-primary-80"),children:[y.jsx(za,{className:"w-20 h-20 text-primary-20"}),y.jsxs("div",{className:"text-center",children:[y.jsx("h3",{className:"text-xl mb-2",children:"The conversation has ended"}),y.jsx("p",{children:"You can close this panel now or restart."})]})]})}):y.jsxs(Qi,{className:i,children:[y.jsxs("div",{className:"rounded-full w-fit relative",children:[y.jsx("div",{className:Y("w-[128px] h-[128px] p-4 z-10 relative rounded-full overflow-hidden bg-cover bg-center",r!=null?"":n==="dark"?"bg-[rgb(40,41,47)]":"bg-[rgb(175,175,175)]"),style:r!=null?{backgroundImage:`url(${r})`}:{},children:r==null?y.jsx(za,{className:"w-full h-full text-primary-40"}):null}),k?y.jsx(Ns,{className:"rounded-full"}):null]}),(()=>{if(S==null)return null;const g=Object.entries(S.modalities).map(([b,p])=>{const m=l[b];return m!=null?y.jsx(m,{data:p,conversationHandler:t,enabled:!0},b):null}).filter(Boolean);if(g.length>0)return y.jsx("div",{className:"absolute top-4 left-4 right-4",children:g})})(),y.jsxs("div",{className:"w-fit flex-none absolute bottom-4 left-1/2 transform -translate-x-1/2",children:[v?y.jsx(Ns,{className:"rounded-inner"}):null,y.jsx(ft,{Icon:u?dc:nh,label:"Voice",type:u?"activated":"ghost",onClick:()=>{d(g=>!g)}})]})]}):y.jsx(Qi,{className:i,children:y.jsxs("div",{className:"p-4 h-full flex flex-col justify-between",children:[y.jsx(gy,{soundCheck:f}),y.jsx(Ti,{type:"main",label:"I'm ready",Icon:Ni,onClick:()=>{o(!0),s(t,c)}})]})})},Hx=({onClose:t,handler:e,className:n})=>y.jsxs("div",{className:Y("p-2 md:p-3 flex flex-col flex-grow justify-center gap-2",n),children:[y.jsx(Ti,{label:"Restart conversation",Icon:p0,type:"ghost",onClick:()=>{e.reset({clearResponses:!0}),e.sendWelcomeIntent(),t()}}),y.jsx(Ti,{label:"Talk to an agent",Icon:h0,type:"ghost",onClick:()=>{e.sendIntent("NLX.Escalation"),t()}})]});function Ch(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Mr=Ch();function vy(t){Mr=t}const ya={exec:()=>null};function le(t,e=""){let n=typeof t=="string"?t:t.source;const r={replace:(i,a)=>{let o=typeof a=="string"?a:a.source;return o=o.replace(Ye.caret,"$1"),n=n.replace(i,o),r},getRegex:()=>new RegExp(n,e)};return r}const Ye={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},qx=/^(?:[ \t]*(?:\n|$))+/,$x=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Wx=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,eo=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Kx=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,by=/(?:[*+-]|\d{1,9}[.)])/,yy=le(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,by).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Sh=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Gx=/^[^\n]+/,Th=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Zx=le(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Th).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Qx=le(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,by).getRegex(),kc="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",xh=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Jx=le("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",xh).replace("tag",kc).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ky=le(Sh).replace("hr",eo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kc).getRegex(),Yx=le(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ky).getRegex(),Eh={blockquote:Yx,code:$x,def:Zx,fences:Wx,heading:Kx,hr:eo,html:Jx,lheading:yy,list:Qx,newline:qx,paragraph:ky,table:ya,text:Gx},dm=le("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",eo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kc).getRegex(),Xx={...Eh,table:dm,paragraph:le(Sh).replace("hr",eo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",dm).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kc).getRegex()},eE={...Eh,html:le(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",xh).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ya,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:le(Sh).replace("hr",eo).replace("heading",` *#{1,6} *[^
]`).replace("lheading",yy).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},tE=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,nE=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,wy=/^( {2,}|\\)\n(?!\s*$)/,rE=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,wc=/[\p{P}\p{S}]/u,Ph=/[\s\p{P}\p{S}]/u,Cy=/[^\s\p{P}\p{S}]/u,iE=le(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ph).getRegex(),aE=/(?!~)[\p{P}\p{S}]/u,oE=/(?!~)[\s\p{P}\p{S}]/u,sE=/(?:[^\s\p{P}\p{S}]|~)/u,cE=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,lE=le(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,wc).getRegex(),Sy="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",uE=le(Sy,"gu").replace(/notPunctSpace/g,Cy).replace(/punctSpace/g,Ph).replace(/punct/g,wc).getRegex(),dE=le(Sy,"gu").replace(/notPunctSpace/g,sE).replace(/punctSpace/g,oE).replace(/punct/g,aE).getRegex(),hE=le("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Cy).replace(/punctSpace/g,Ph).replace(/punct/g,wc).getRegex(),pE=le(/\\(punct)/,"gu").replace(/punct/g,wc).getRegex(),fE=le(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),mE=le(xh).replace("(?:-->|$)","-->").getRegex(),gE=le("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",mE).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Hs=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,vE=le(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Hs).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ty=le(/^!?\[(label)\]\[(ref)\]/).replace("label",Hs).replace("ref",Th).getRegex(),xy=le(/^!?\[(ref)\](?:\[\])?/).replace("ref",Th).getRegex(),bE=le("reflink|nolink(?!\\()","g").replace("reflink",Ty).replace("nolink",xy).getRegex(),Rh={_backpedal:ya,anyPunctuation:pE,autolink:fE,blockSkip:cE,br:wy,code:nE,del:ya,emStrongLDelim:lE,emStrongRDelimAst:uE,emStrongRDelimUnd:hE,escape:tE,link:vE,nolink:xy,punctuation:iE,reflink:Ty,reflinkSearch:bE,tag:gE,text:rE,url:ya},yE={...Rh,link:le(/^!?\[(label)\]\((.*?)\)/).replace("label",Hs).getRegex(),reflink:le(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Hs).getRegex()},Gu={...Rh,emStrongRDelimAst:dE,url:le(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},kE={...Gu,br:le(wy).replace("{2,}","*").getRegex(),text:le(Gu.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ro={normal:Eh,gfm:Xx,pedantic:eE},Ji={normal:Rh,gfm:Gu,breaks:kE,pedantic:yE},wE={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hm=t=>wE[t];function Qt(t,e){if(e){if(Ye.escapeTest.test(t))return t.replace(Ye.escapeReplace,hm)}else if(Ye.escapeTestNoEncode.test(t))return t.replace(Ye.escapeReplaceNoEncode,hm);return t}function pm(t){try{t=encodeURI(t).replace(Ye.percentDecode,"%")}catch{return null}return t}function fm(t,e){var n;const r=t.replace(Ye.findPipe,(o,s,c)=>{let l=!1,u=s;for(;--u>=0&&c[u]==="\\";)l=!l;return l?"|":" |"}),i=r.split(Ye.splitPipe);let a=0;if(i[0].trim()||i.shift(),i.length>0&&!((n=i.at(-1))!=null&&n.trim())&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;a<i.length;a++)i[a]=i[a].trim().replace(Ye.slashPipe,"|");return i}function Yi(t,e,n){const r=t.length;if(r===0)return"";let i=0;for(;i<r&&t.charAt(r-i-1)===e;)i++;return t.slice(0,r-i)}function CE(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return-1}function mm(t,e,n,r,i){const a=e.href,o=e.title||null,s=t[1].replace(i.other.outputLinkReplace,"$1");if(t[0].charAt(0)!=="!"){r.state.inLink=!0;const c={type:"link",raw:n,href:a,title:o,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,c}return{type:"image",raw:n,href:a,title:o,text:s}}function SE(t,e,n){const r=t.match(n.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(a=>{const o=a.match(n.other.beginningSpace);if(o===null)return a;const[s]=o;return s.length>=i.length?a.slice(i.length):a}).join(`
`)}class qs{constructor(e){ie(this,"options"),ie(this,"rules"),ie(this,"lexer"),this.options=e||Mr}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const r=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Yi(r,`
`)}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const r=n[0],i=SE(r,n[3]||"",this.rules);return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:i}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let r=n[2].trim();if(this.rules.other.endingHash.test(r)){const i=Yi(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:Yi(n[0],`
`)}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){let r=Yi(n[0],`
`).split(`
`),i="",a="";const o=[];for(;r.length>0;){let s=!1;const c=[];let l;for(l=0;l<r.length;l++)if(this.rules.other.blockquoteStart.test(r[l]))c.push(r[l]),s=!0;else if(!s)c.push(r[l]);else break;r=r.slice(l);const u=c.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,a=a?`${a}
${d}`:d;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=h,r.length===0)break;const f=o.at(-1);if((f==null?void 0:f.type)==="code")break;if((f==null?void 0:f.type)==="blockquote"){const v=f,k=v.raw+`
`+r.join(`
`),S=this.blockquote(k);o[o.length-1]=S,i=i.substring(0,i.length-v.raw.length)+S.raw,a=a.substring(0,a.length-v.text.length)+S.text;break}else if((f==null?void 0:f.type)==="list"){const v=f,k=v.raw+`
`+r.join(`
`),S=this.list(k);o[o.length-1]=S,i=i.substring(0,i.length-f.raw.length)+S.raw,a=a.substring(0,a.length-v.raw.length)+S.raw,r=k.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:o,text:a}}}list(e){let n=this.rules.block.list.exec(e);if(n){let r=n[1].trim();const i=r.length>1,a={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=this.rules.other.listItemRegex(r);let s=!1;for(;e;){let l=!1,u="",d="";if(!(n=o.exec(e))||this.rules.block.hr.test(e))break;u=n[0],e=e.substring(u.length);let h=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,b=>" ".repeat(3*b.length)),f=e.split(`
`,1)[0],v=!h.trim(),k=0;if(this.options.pedantic?(k=2,d=h.trimStart()):v?k=n[1].length+1:(k=n[2].search(this.rules.other.nonSpaceChar),k=k>4?1:k,d=h.slice(k),k+=n[1].length),v&&this.rules.other.blankLine.test(f)&&(u+=f+`
`,e=e.substring(f.length+1),l=!0),!l){const b=this.rules.other.nextBulletRegex(k),p=this.rules.other.hrRegex(k),m=this.rules.other.fencesBeginRegex(k),w=this.rules.other.headingBeginRegex(k),T=this.rules.other.htmlBeginRegex(k);for(;e;){const x=e.split(`
`,1)[0];let E;if(f=x,this.options.pedantic?(f=f.replace(this.rules.other.listReplaceNesting,"  "),E=f):E=f.replace(this.rules.other.tabCharGlobal,"    "),m.test(f)||w.test(f)||T.test(f)||b.test(f)||p.test(f))break;if(E.search(this.rules.other.nonSpaceChar)>=k||!f.trim())d+=`
`+E.slice(k);else{if(v||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||m.test(h)||w.test(h)||p.test(h))break;d+=`
`+f}!v&&!f.trim()&&(v=!0),u+=x+`
`,e=e.substring(x.length+1),h=E.slice(k)}}a.loose||(s?a.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(s=!0));let S=null,g;this.options.gfm&&(S=this.rules.other.listIsTask.exec(d),S&&(g=S[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),a.items.push({type:"list_item",raw:u,task:!!S,checked:g,loose:!1,text:d,tokens:[]}),a.raw+=u}const c=a.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let l=0;l<a.items.length;l++)if(this.lexer.state.top=!1,a.items[l].tokens=this.lexer.blockTokens(a.items[l].text,[]),!a.loose){const u=a.items[l].tokens.filter(h=>h.type==="space"),d=u.length>0&&u.some(h=>this.rules.other.anyLine.test(h.raw));a.loose=d}if(a.loose)for(let l=0;l<a.items.length;l++)a.items[l].loose=!0;return a}}html(e){const n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){const n=this.rules.block.def.exec(e);if(n){const r=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:i,title:a}}}table(e){var n;const r=this.rules.block.table.exec(e);if(!r||!this.rules.other.tableDelimiter.test(r[2]))return;const i=fm(r[1]),a=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=(n=r[3])!=null&&n.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:r[0],header:[],align:[],rows:[]};if(i.length===a.length){for(const c of a)this.rules.other.tableAlignRight.test(c)?s.align.push("right"):this.rules.other.tableAlignCenter.test(c)?s.align.push("center"):this.rules.other.tableAlignLeft.test(c)?s.align.push("left"):s.align.push(null);for(let c=0;c<i.length;c++)s.header.push({text:i[c],tokens:this.lexer.inline(i[c]),header:!0,align:s.align[c]});for(const c of o)s.rows.push(fm(c,s.header.length).map((l,u)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:s.align[u]})));return s}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const r=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const o=Yi(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{const o=CE(n[2],"()");if(o>-1){const s=(n[0].indexOf("!")===0?5:4)+n[1].length+o;n[2]=n[2].substring(0,o),n[0]=n[0].substring(0,s).trim(),n[3]=""}}let i=n[2],a="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(i);o&&(i=o[1],a=o[3])}else a=n[3]?n[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i=i.slice(1):i=i.slice(1,-1)),mm(n,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(e,n){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),a=n[i.toLowerCase()];if(!a){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return mm(r,a,r[0],this.lexer,this.rules)}}emStrong(e,n,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!r||this.rules.inline.punctuation.exec(r))){const a=[...i[0]].length-1;let o,s,c=a,l=0;const u=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,n=n.slice(-1*e.length+a);(i=u.exec(n))!=null;){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(s=[...o].length,i[3]||i[4]){c+=s;continue}else if((i[5]||i[6])&&a%3&&!((a+s)%3)){l+=s;continue}if(c-=s,c>0)continue;s=Math.min(s,s+c+l);const d=[...i[0]][0].length,h=e.slice(0,a+i.index+d+s);if(Math.min(a,s)%2){const v=h.slice(1,-1);return{type:"em",raw:h,text:v,tokens:this.lexer.inlineTokens(v)}}const f=h.slice(2,-2);return{type:"strong",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let r=n[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(r),a=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&a&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:n[0],text:r}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){const n=this.rules.inline.autolink.exec(e);if(n){let r,i;return n[2]==="@"?(r=n[1],i="mailto:"+r):(r=n[1],i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var n;let r;if(r=this.rules.inline.url.exec(e)){let i,a;if(r[2]==="@")i=r[0],a="mailto:"+i;else{let o;do o=r[0],r[0]=((n=this.rules.inline._backpedal.exec(r[0]))==null?void 0:n[0])??"";while(o!==r[0]);i=r[0],r[1]==="www."?a="http://"+r[0]:a=r[0]}return{type:"link",raw:r[0],text:i,href:a,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const n=this.rules.inline.text.exec(e);if(n){const r=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:r}}}}class xt{constructor(e){ie(this,"tokens"),ie(this,"options"),ie(this,"state"),ie(this,"tokenizer"),ie(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Mr,this.options.tokenizer=this.options.tokenizer||new qs,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:Ye,block:Ro.normal,inline:Ji.normal};this.options.pedantic?(n.block=Ro.pedantic,n.inline=Ji.pedantic):this.options.gfm&&(n.block=Ro.gfm,this.options.breaks?n.inline=Ji.breaks:n.inline=Ji.gfm),this.tokenizer.rules=n}static get rules(){return{block:Ro,inline:Ji}}static lex(e,n){return new xt(n).lex(e)}static lexInline(e,n){return new xt(n).inlineTokens(e)}lex(e){e=e.replace(Ye.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var i,a,o;for(this.options.pedantic&&(e=e.replace(Ye.tabCharGlobal,"    ").replace(Ye.spaceLine,""));e;){let s;if((a=(i=this.options.extensions)==null?void 0:i.block)!=null&&a.some(l=>(s=l.call({lexer:this},e,n))?(e=e.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);const l=n.at(-1);s.raw.length===1&&l!==void 0?l.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);const l=n.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+s.raw,l.text+=`
`+s.text,this.inlineQueue.at(-1).src=l.text):n.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);const l=n.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+s.raw,l.text+=`
`+s.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),n.push(s);continue}let c=e;if((o=this.options.extensions)!=null&&o.startBlock){let l=1/0;const u=e.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(l=Math.min(l,d))}),l<1/0&&l>=0&&(c=e.substring(0,l+1))}if(this.state.top&&(s=this.tokenizer.paragraph(c))){const l=n.at(-1);r&&(l==null?void 0:l.type)==="paragraph"?(l.raw+=`
`+s.raw,l.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(s),r=c.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);const l=n.at(-1);(l==null?void 0:l.type)==="text"?(l.raw+=`
`+s.raw,l.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(s);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var r,i,a;let o=e,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,s.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let c=!1,l="";for(;e;){c||(l=""),c=!1;let u;if((i=(r=this.options.extensions)==null?void 0:r.inline)!=null&&i.some(h=>(u=h.call({lexer:this},e,n))?(e=e.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(e,o,l)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),n.push(u);continue}let d=e;if((a=this.options.extensions)!=null&&a.startInline){let h=1/0;const f=e.slice(1);let v;this.options.extensions.startInline.forEach(k=>{v=k.call({lexer:this},f),typeof v=="number"&&v>=0&&(h=Math.min(h,v))}),h<1/0&&h>=0&&(d=e.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(l=u.raw.slice(-1)),c=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}}class $s{constructor(e){ie(this,"options"),ie(this,"parser"),this.options=e||Mr}space(e){return""}code({text:e,lang:n,escaped:r}){var i;const a=(i=(n||"").match(Ye.notSpaceStart))==null?void 0:i[0],o=e.replace(Ye.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Qt(a)+'">'+(r?o:Qt(o,!0))+`</code></pre>
`:"<pre><code>"+(r?o:Qt(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:n}){return`<h${n}>${this.parser.parseInline(e)}</h${n}>
`}hr(e){return`<hr>
`}list(e){const n=e.ordered,r=e.start;let i="";for(let s=0;s<e.items.length;s++){const c=e.items[s];i+=this.listitem(c)}const a=n?"ol":"ul",o=n&&r!==1?' start="'+r+'"':"";return"<"+a+o+`>
`+i+"</"+a+`>
`}listitem(e){var n;let r="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+Qt(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):r+=i+" "}return r+=this.parser.parse(e.tokens,!!e.loose),`<li>${r}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let n="",r="";for(let a=0;a<e.header.length;a++)r+=this.tablecell(e.header[a]);n+=this.tablerow({text:r});let i="";for(let a=0;a<e.rows.length;a++){const o=e.rows[a];r="";for(let s=0;s<o.length;s++)r+=this.tablecell(o[s]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const n=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+n+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Qt(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:n,tokens:r}){const i=this.parser.parseInline(r),a=pm(e);if(a===null)return i;e=a;let o='<a href="'+e+'"';return n&&(o+=' title="'+Qt(n)+'"'),o+=">"+i+"</a>",o}image({href:e,title:n,text:r}){const i=pm(e);if(i===null)return Qt(r);e=i;let a=`<img src="${e}" alt="${r}"`;return n&&(a+=` title="${Qt(n)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Qt(e.text)}}class Ih{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Et{constructor(e){ie(this,"options"),ie(this,"renderer"),ie(this,"textRenderer"),this.options=e||Mr,this.options.renderer=this.options.renderer||new $s,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ih}static parse(e,n){return new Et(n).parse(e)}static parseInline(e,n){return new Et(n).parseInline(e)}parse(e,n=!0){var r,i;let a="";for(let o=0;o<e.length;o++){const s=e[o];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[s.type]){const l=s,u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){a+=u||"";continue}}const c=s;switch(c.type){case"space":{a+=this.renderer.space(c);continue}case"hr":{a+=this.renderer.hr(c);continue}case"heading":{a+=this.renderer.heading(c);continue}case"code":{a+=this.renderer.code(c);continue}case"table":{a+=this.renderer.table(c);continue}case"blockquote":{a+=this.renderer.blockquote(c);continue}case"list":{a+=this.renderer.list(c);continue}case"html":{a+=this.renderer.html(c);continue}case"paragraph":{a+=this.renderer.paragraph(c);continue}case"text":{let l=c,u=this.renderer.text(l);for(;o+1<e.length&&e[o+1].type==="text";)l=e[++o],u+=`
`+this.renderer.text(l);n?a+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):a+=u;continue}default:{const l='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return a}parseInline(e,n=this.renderer){var r,i;let a="";for(let o=0;o<e.length;o++){const s=e[o];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[s.type]){const l=this.options.extensions.renderers[s.type].call({parser:this},s);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){a+=l||"";continue}}const c=s;switch(c.type){case"escape":{a+=n.text(c);break}case"html":{a+=n.html(c);break}case"link":{a+=n.link(c);break}case"image":{a+=n.image(c);break}case"strong":{a+=n.strong(c);break}case"em":{a+=n.em(c);break}case"codespan":{a+=n.codespan(c);break}case"br":{a+=n.br(c);break}case"del":{a+=n.del(c);break}case"text":{a+=n.text(c);break}default:{const l='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return a}}class ka{constructor(e){ie(this,"options"),ie(this,"block"),this.options=e||Mr}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?xt.lex:xt.lexInline}provideParser(){return this.block?Et.parse:Et.parseInline}}ie(ka,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class TE{constructor(...e){ie(this,"defaults",Ch()),ie(this,"options",this.setOptions),ie(this,"parse",this.parseMarkdown(!0)),ie(this,"parseInline",this.parseMarkdown(!1)),ie(this,"Parser",Et),ie(this,"Renderer",$s),ie(this,"TextRenderer",Ih),ie(this,"Lexer",xt),ie(this,"Tokenizer",qs),ie(this,"Hooks",ka),this.use(...e)}walkTokens(e,n){var r,i;let a=[];for(const o of e)switch(a=a.concat(n.call(this,o)),o.type){case"table":{const s=o;for(const c of s.header)a=a.concat(this.walkTokens(c.tokens,n));for(const c of s.rows)for(const l of c)a=a.concat(this.walkTokens(l.tokens,n));break}case"list":{const s=o;a=a.concat(this.walkTokens(s.items,n));break}default:{const s=o;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[s.type]?this.defaults.extensions.childTokens[s.type].forEach(c=>{const l=s[c].flat(1/0);a=a.concat(this.walkTokens(l,n))}):s.tokens&&(a=a.concat(this.walkTokens(s.tokens,n)))}}return a}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const o=n.renderers[a.name];o?n.renderers[a.name]=function(...s){let c=a.renderer.apply(this,s);return c===!1&&(c=o.apply(this,s)),c}:n.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=n[a.level];o?o.unshift(a.tokenizer):n[a.level]=[a.tokenizer],a.start&&(a.level==="block"?n.startBlock?n.startBlock.push(a.start):n.startBlock=[a.start]:a.level==="inline"&&(n.startInline?n.startInline.push(a.start):n.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(n.childTokens[a.name]=a.childTokens)}),i.extensions=n),r.renderer){const a=this.defaults.renderer||new $s(this.defaults);for(const o in r.renderer){if(!(o in a))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const s=o,c=r.renderer[s],l=a[s];a[s]=(...u)=>{let d=c.apply(a,u);return d===!1&&(d=l.apply(a,u)),d||""}}i.renderer=a}if(r.tokenizer){const a=this.defaults.tokenizer||new qs(this.defaults);for(const o in r.tokenizer){if(!(o in a))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const s=o,c=r.tokenizer[s],l=a[s];a[s]=(...u)=>{let d=c.apply(a,u);return d===!1&&(d=l.apply(a,u)),d}}i.tokenizer=a}if(r.hooks){const a=this.defaults.hooks||new ka;for(const o in r.hooks){if(!(o in a))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const s=o,c=r.hooks[s],l=a[s];ka.passThroughHooks.has(o)?a[s]=u=>{if(this.defaults.async)return Promise.resolve(c.call(a,u)).then(h=>l.call(a,h));const d=c.call(a,u);return l.call(a,d)}:a[s]=(...u)=>{let d=c.apply(a,u);return d===!1&&(d=l.apply(a,u)),d}}i.hooks=a}if(r.walkTokens){const a=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(s){let c=[];return c.push(o.call(this,s)),a&&(c=c.concat(a.call(this,s))),c}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return xt.lex(e,n??this.defaults)}parser(e,n){return Et.parse(e,n??this.defaults)}parseMarkdown(e){return(n,r)=>{const i={...r},a={...this.defaults,...i},o=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&i.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));a.hooks&&(a.hooks.options=a,a.hooks.block=e);const s=a.hooks?a.hooks.provideLexer():e?xt.lex:xt.lexInline,c=a.hooks?a.hooks.provideParser():e?Et.parse:Et.parseInline;if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(l=>s(l,a)).then(l=>a.hooks?a.hooks.processAllTokens(l):l).then(l=>a.walkTokens?Promise.all(this.walkTokens(l,a.walkTokens)).then(()=>l):l).then(l=>c(l,a)).then(l=>a.hooks?a.hooks.postprocess(l):l).catch(o);try{a.hooks&&(n=a.hooks.preprocess(n));let l=s(n,a);a.hooks&&(l=a.hooks.processAllTokens(l)),a.walkTokens&&this.walkTokens(l,a.walkTokens);let u=c(l,a);return a.hooks&&(u=a.hooks.postprocess(u)),u}catch(l){return o(l)}}}onError(e,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Qt(r.message+"",!0)+"</pre>";return n?Promise.resolve(i):i}if(n)return Promise.reject(r);throw r}}}const _r=new TE;function oe(t,e){return _r.parse(t,e)}oe.options=oe.setOptions=function(t){return _r.setOptions(t),oe.defaults=_r.defaults,vy(oe.defaults),oe};oe.getDefaults=Ch;oe.defaults=Mr;oe.use=function(...t){return _r.use(...t),oe.defaults=_r.defaults,vy(oe.defaults),oe};oe.walkTokens=function(t,e){return _r.walkTokens(t,e)};oe.parseInline=_r.parseInline;oe.Parser=Et;oe.parser=Et.parse;oe.Renderer=$s;oe.TextRenderer=Ih;oe.Lexer=xt;oe.lexer=xt.lex;oe.Tokenizer=qs;oe.Hooks=ka;oe.parse=oe;oe.options;oe.setOptions;oe.use;oe.walkTokens;oe.parseInline;Et.parse;xt.lex;const Ey=({message:t})=>y.jsxs("div",{className:"bg-error-secondary text-error-primary text-base p-3 rounded-inner flex items-center gap-2",children:[y.jsx(m0,{className:"w-4 h-4 flex-none"}),y.jsx("p",{className:"text-primary-80",children:t})]}),xE=({handler:t,message:e,responseIndex:n,messageIndex:r})=>e.choices.length>0?y.jsx("ul",{className:"space-y-2 max-h-[40vh] overflow-auto no-scrollbar",children:e.choices.map((i,a)=>e.selectedChoiceId==null||i.choiceId===e.selectedChoiceId?y.jsx("li",{className:"w-full",children:y.jsx(Ti,{type:"ghost",Icon:Ni,onClick:e.selectedChoiceId==null?()=>{t.sendChoice(i.choiceId,{},{responseIndex:n,messageIndex:r})}:void 0,label:i.choiceText})},a):null)}):null,ml=({text:t,bubble:e,files:n})=>y.jsxs("div",{className:"space-y-2",children:[y.jsx("div",{className:"flex justify-end pl-10 text-base",children:y.jsx("div",{className:Y("text-primary-60 rounded-inner whitespace-pre-wrap",e?"bg-primary-5 p-3":""),children:t})}),n!=null?y.jsx("div",{className:"flex flex-wrap justify-end gap-2",children:n.map((r,i)=>y.jsx("img",{className:"rounded-inner h-20",src:URL.createObjectURL(r)},i))}):null]}),EE=({sources:t})=>{const[e,n]=A.useState(!1);return y.jsxs("details",{className:"space-y-2",open:e,onToggle:r=>{n(r.currentTarget.open)},children:[y.jsxs("summary",{className:"flex cursor-pointer items-center gap-2 rounded-inner hover:bg-primary-5 text-primary-80",children:[y.jsx(QC,{type:"ghost",Icon:e?s0:c0}),"Sources"]}),y.jsx("ol",{className:"space-y-2",children:t.map((r,i)=>{const a=r.fileName??"Source",o="p-3 bg-primary-5 rounded-inner w-full flex items-center justify-between text-primary-80";return y.jsx("li",{children:r.presignedUrl!=null?y.jsxs("a",{href:r.presignedUrl,className:Y(o,"hover:bg-primary-10"),children:[a,y.jsx(v0,{className:"w-4 h-4 text-primary-60"})]}):y.jsx("div",{className:o,children:a})},i)})})]})},PE=({responses:t,colorMode:e,chatMode:n,uploadedFiles:r,userMessageBubble:i,agentMessageBubble:a,lastBotResponseIndex:o,isWaiting:s,customModalities:c,handler:l,className:u,enabled:d})=>{const h=A.useRef(null),f=A.useRef(null);return A.useEffect(()=>{!n&&!s&&setTimeout(()=>{var v;(v=f.current)==null||v.scrollIntoView({behavior:"smooth"})})},[s,n]),A.useEffect(()=>{var v;if(n){const k=(v=h.current)==null?void 0:v.lastChild;k instanceof HTMLElement&&k.scrollIntoView({behavior:"smooth"})}},[t.length,n]),y.jsxs("div",{className:Y("relative",u),children:[y.jsx("div",{"data-theme":e==="dark"?"light":"dark",className:Y("absolute inset-x-0 h-[1px] top-0 bg-background opacity-[0.01] backdrop-blur-md")}),!n&&s?y.jsx(R0,{label:"Thinking",className:"absolute inset-0"}):null,y.jsxs("div",{className:Y("absolute inset-0 p-2 md:p-3 overflow-y-auto no-scrollbar space-y-8",!n&&s?"opacity-0":"opacity-100"),ref:h,children:[t.map((v,k)=>{var S;if(v.type==="user")return v.payload.type==="text"?y.jsx(ml,{text:v.payload.text,bubble:i},k):v.payload.type==="structured"&&v.payload.utterance!=null&&v.payload.uploadIds!=null?y.jsx(ml,{bubble:i,text:v.payload.utterance,files:v.payload.uploadIds.map(b=>r[b]).filter(b=>b!=null)},k):null;if(v.type==="failure")return y.jsx(Ey,{message:v.payload.text},k);const g=o!=null&&k===o;return y.jsxs(A.Fragment,{children:[y.jsxs("div",{className:Y("space-y-2",!n&&g?"min-h-full":""),ref:g?f:void 0,children:[v.payload.messages.map((b,p)=>y.jsx("div",{className:"text-base",children:y.jsx("div",{className:Y("space-y-6 markdown",a?"p-3 w-fit bg-secondary-40 mr-10 rounded-inner":""),dangerouslySetInnerHTML:{__html:oe(b.text,{async:!1})}})},p)),((S=v.payload.metadata)==null?void 0:S.sources)!=null?y.jsx(EE,{sources:v.payload.metadata.sources}):null,Object.entries(v.payload.modalities??{}).map(([b,p])=>{const m=c[b];return m==null?(console.warn(`Custom component implementation missing for the ${b} modality.`),null):y.jsx(m,{data:p,conversationHandler:l,enabled:d},b)})]}),v.payload.messages.map((b,p)=>{if(b.selectedChoiceId!=null){const m=b.choices.find(w=>w.choiceId===b.selectedChoiceId);return m==null?null:y.jsx(ml,{text:m.choiceText,bubble:i},p)}return null})]},k)}),n&&s?y.jsxs("div",{className:"text-primary-60 flex items-center gap-1 text-base",children:[y.jsx("span",{className:"w-5 h-5 block flex-none text-accent",children:y.jsx(rh,{})}),"Thinking..."]}):null]},"messages")]})};function Zu(){return Zu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Zu.apply(null,arguments)}function RE(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var IE=A.useLayoutEffect,_E=function(t){var e=wr.useRef(t);return IE(function(){e.current=t}),e},gm=function(t,e){if(typeof t=="function"){t(e);return}t.current=e},OE=function(t,e){var n=wr.useRef();return wr.useCallback(function(r){t.current=r,n.current&&gm(n.current,null),n.current=e,e&&gm(e,r)},[e])},vm={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},NE=function(t){Object.keys(vm).forEach(function(e){t.style.setProperty(e,vm[e],"important")})},bm=NE,Ze=null,ym=function(t,e){var n=t.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?n+e.borderSize:n-e.paddingSize};function LE(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),Ze||(Ze=document.createElement("textarea"),Ze.setAttribute("tabindex","-1"),Ze.setAttribute("aria-hidden","true"),bm(Ze)),Ze.parentNode===null&&document.body.appendChild(Ze);var i=t.paddingSize,a=t.borderSize,o=t.sizingStyle,s=o.boxSizing;Object.keys(o).forEach(function(h){var f=h;Ze.style[f]=o[f]}),bm(Ze),Ze.value=e;var c=ym(Ze,t);Ze.value=e,c=ym(Ze,t),Ze.value="x";var l=Ze.scrollHeight-i,u=l*n;s==="border-box"&&(u=u+i+a),c=Math.max(u,c);var d=l*r;return s==="border-box"&&(d=d+i+a),c=Math.min(d,c),[c,l]}var km=function(){},ME=function(t,e){return t.reduce(function(n,r){return n[r]=e[r],n},{})},DE=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],jE=!!document.documentElement.currentStyle,AE=function(t){var e=window.getComputedStyle(t);if(e===null)return null;var n=ME(DE,e),r=n.boxSizing;if(r==="")return null;jE&&r==="border-box"&&(n.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)+parseFloat(n.borderLeftWidth)+parseFloat(n.paddingRight)+parseFloat(n.paddingLeft)+"px");var i=parseFloat(n.paddingBottom)+parseFloat(n.paddingTop),a=parseFloat(n.borderBottomWidth)+parseFloat(n.borderTopWidth);return{sizingStyle:n,paddingSize:i,borderSize:a}},UE=AE;function Py(t,e,n){var r=_E(n);A.useLayoutEffect(function(){var i=function(a){return r.current(a)};if(t)return t.addEventListener(e,i),function(){return t.removeEventListener(e,i)}},[])}var FE=function(t){Py(window,"resize",t)},BE=function(t){Py(document.fonts,"loadingdone",t)},zE=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],VE=function(t,e){var n=t.cacheMeasurements,r=t.maxRows,i=t.minRows,a=t.onChange,o=a===void 0?km:a,s=t.onHeightChange,c=s===void 0?km:s,l=RE(t,zE),u=l.value!==void 0,d=A.useRef(null),h=OE(d,e),f=A.useRef(0),v=A.useRef(),k=function(){var g=d.current,b=n&&v.current?v.current:UE(g);if(b){v.current=b;var p=LE(b,g.value||g.placeholder||"x",i,r),m=p[0],w=p[1];f.current!==m&&(f.current=m,g.style.setProperty("height",m+"px","important"),c(m,{rowHeight:w}))}},S=function(g){u||k(),o(g)};return A.useLayoutEffect(k),FE(k),BE(k),A.createElement("textarea",Zu({},l,{onChange:S,ref:h}))},HE=A.forwardRef(VE);const wm=8,qE=({className:t,handler:e,uploadUrl:n,onFileUpload:r,enabled:i})=>{const[a,o]=A.useState(!1),[s,c]=A.useState(""),[l,u]=A.useState(null),[d,h]=A.useState(null),f=A.useRef(null),v=A.useRef(null),k=E0();A.useEffect(()=>{var E;k&&((E=v.current)==null||E.focus())},[k]);const S=A.useMemo(()=>s.trim()==="",[s]),[g,b]=A.useState(!1),p=S&&d==null||g||!i,m=()=>{if(p)return;const E=(O,N)=>{(N==null?void 0:N.type)==="bot"&&(b(!1),e.unsubscribe(E),c(""),h(null),k&&setTimeout(()=>{var U;(U=v.current)==null||U.focus()}))};e.subscribe(E),b(!0),n!=null&&d!=null?e.sendStructured({uploadIds:[n.uploadId],utterance:s}):e.sendText(s)},w=n!=null&&i,T=()=>{u("Something went wrong. Please try again.")},x=E=>{var O,N;if(n==null){T();return}const U=(N=(O=E.target)==null?void 0:O.files)==null?void 0:N[0];if(U==null){T();return}const{name:W,size:q,type:R}=U;if(h({name:W,size:q,type:R}),q/1024**2>wm){u(`The file is too big. Max file size: ${wm}mb`);return}fetch(n.url,{method:"PUT",headers:{"Content-Type":"image/jpeg"},body:U}).then(()=>{u(null),r({uploadId:n.uploadId,file:U})}).catch(()=>{T()})};return y.jsx("div",{className:Y("relative",t),children:y.jsxs("div",{className:Y("bg-primary-5 transition-colors duration-200 p-2 rounded-outer text-base font-normal",a?"":"hover:bg-secondary-20"),children:[l!=null&&y.jsxs("div",{className:"flex items-center py-1 mb-2 w-full bg-error-secondary rounded-inner",children:[y.jsx(du,{size:16}),y.jsx("span",{className:"truncate ml-1",children:l})]}),d&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[y.jsxs("p",{className:"flex items-center truncate mx-2",children:[l!=null?y.jsx(du,{size:16,className:"text-error-primary"}):y.jsx(l0,{size:16,className:"text-primary-60"}),y.jsx("span",{className:"truncate ml-3",children:d.name})]}),y.jsx(ft,{className:"flex-none",Icon:d0,label:"Delete",onClick:w?()=>{h(null),u(null),f.current!=null&&(f.current.value="")}:void 0,type:"ghost"})]}),y.jsx("hr",{className:"border-b-px border-background mb-2 -mx-2"})]}),y.jsxs("div",{className:Y("flex items-end gap-1"),children:[w&&d==null?y.jsxs(y.Fragment,{children:[y.jsx("label",{htmlFor:"file-upload",className:"p-3 w-10 h-10 flex-none block transition-colors rounded-inner bg-primary-80 hover:bg-primary-80 text-secondary-80 cursor-pointer",children:y.jsx(uu,{})}),y.jsx("input",{type:"file",id:"file-upload",className:"sr-only",accept:".jpg, .jpeg, .png, .webp, .mp4, .mpeg4, .avi, .mov, .pdf",onChange:x,ref:f})]}):y.jsx(ft,{className:"flex-none",Icon:uu,label:"Upload file",type:"ghost"}),y.jsx(HE,{disabled:g||!i,className:Y("h-10 w-full resize-none mr-2 px-2 py-2 outline-none","bg-transparent text-primary-80 placeholder:text-primary-40 caret-accent","disabled:text-primary-40"),placeholder:"Type something",maxRows:10,onFocus:()=>{o(!0)},onBlur:()=>{o(!1)},value:s,onChange:E=>{c(E.target.value)},onKeyDown:E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),m())},ref:v}),y.jsx(ft,{className:"flex-none",label:"Send message",onClick:p?void 0:()=>{m()},type:"main",Icon:Ni})]})]})})},$E=t=>({"--font-family":t.fontFamily,"--inner-border-radius":t.innerBorderRadius,"--outer-border-radius":t.outerBorderRadius,"--primary-80":t.primary80,"--primary-60":t.primary60,"--primary-40":t.primary40,"--primary-20":t.primary20,"--primary-10":t.primary10,"--primary-5":t.primary5,"--primary-1":t.primary1,"--secondary-80":t.secondary80,"--secondary-60":t.secondary60,"--secondary-40":t.secondary40,"--secondary-20":t.secondary20,"--secondary-10":t.secondary10,"--secondary-5":t.secondary5,"--secondary-1":t.secondary1,"--accent":t.accent,"--accent-20":t.accent20,"--background":t.background,"--overlay":t.overlay,"--warning-primary":t.warningPrimary,"--warning-secondary":t.warningSecondary,"--error-primary":t.errorPrimary,"--error-secondary":t.errorSecondary}),WE={fontFamily:'"Neue Haas Grotesk", sans-serif',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"rgba(0, 2, 9, 0.8)",primary60:"rgba(0, 2, 9, 0.6)",primary40:"rgba(0, 2, 9, 0.4)",primary20:"rgba(0, 2, 9, 0.2)",primary10:"rgba(0, 2, 9, 0.1)",primary5:"rgba(0, 2, 9, 0.05)",primary1:"rgba(0, 2, 9, 0.01)",secondary80:"rgba(255, 255, 255, 0.85)",secondary60:"rgba(255, 255, 255, 0.65)",secondary40:"rgba(255, 255, 255, 0.45)",secondary20:"rgba(255, 255, 255, 0.25)",secondary10:"rgba(255, 255, 255, 0.15)",secondary5:"rgba(255, 255, 255, 0.08)",secondary1:"rgba(255, 255, 255, 0.01)",accent:"rgb(28, 99, 218)",accent20:"rgba(28, 99, 218, 0.2)",background:"rgba(220, 220, 220, 0.9)",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"rgb(220, 159, 3)",warningSecondary:"rgb(255, 242, 209)",errorPrimary:"rgb(157, 3, 3)",errorSecondary:"rgb(255, 223, 230)"},KE={fontFamily:'"Neue Haas Grotesk", sans-serif',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"rgba(255, 255, 255, 0.85)",primary60:"rgba(255, 255, 255, 0.65)",primary40:"rgba(255, 255, 255, 0.45)",primary20:"rgba(255, 255, 255, 0.25)",primary10:"rgba(255, 255, 255, 0.15)",primary5:"rgba(255, 255, 255, 0.08)",primary1:"rgba(255, 255, 255, 0.01)",secondary80:"rgba(0, 2, 9, 0.8)",secondary60:"rgba(0, 2, 9, 0.6)",secondary40:"rgba(0, 2, 9, 0.4)",secondary20:"rgba(0, 2, 9, 0.2)",secondary10:"rgba(0, 2, 9, 0.1)",secondary5:"rgba(0, 2, 9, 0.05)",secondary1:"rgba(0, 2, 9, 0.01)",accent:"rgb(174, 202, 255)",accent20:"rgba(174, 202, 255, 0.25)",background:"rgba(0, 2, 9, 0.9)",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"rgb(255, 214, 108)",warningSecondary:"rgb(95, 65, 29)",errorPrimary:"rgb(255, 133, 162)",errorSecondary:"rgb(94, 4, 4)"},GE=(t,e)=>{const n={};return t.accent!=null&&t.accent20==null&&(n.accent20=`color-mix(in srgb, ${t.accent} 20%, transparent)`),t.primary80!=null&&(t.primary60==null&&(n.primary60=`rgb(from ${t.primary80} r g b / 0.6)`),t.primary40==null&&(n.primary40=`rgb(from ${t.primary80} r g b / 0.4)`),t.primary20==null&&(n.primary20=`rgb(from ${t.primary80} r g b / 0.2)`),t.primary10==null&&(n.primary10=`rgb(from ${t.primary80} r g b / 0.1)`),t.primary5==null&&(n.primary5=`rgb(from ${t.primary80} r g b / 0.05)`),t.primary1==null&&(n.primary1=`rgb(from ${t.primary80} r g b / 0.01)`)),t.secondary80!=null&&(t.secondary60==null&&(n.secondary60=`rgb(from ${t.secondary80} r g b / 0.6)`),t.secondary40==null&&(n.secondary40=`rgb(from ${t.secondary80} r g b / 0.4)`),t.secondary20==null&&(n.secondary20=`rgb(from ${t.secondary80} r g b / 0.2)`),t.secondary10==null&&(n.secondary10=`rgb(from ${t.secondary80} r g b / 0.1)`),t.secondary5==null&&(n.secondary5=`rgb(from ${t.secondary80} r g b / 0.05)`),t.secondary1==null&&(n.secondary1=`rgb(from ${t.secondary80} r g b / 0.01)`)),{...e,...n,...t}},rs=({colorMode:t,children:e,theme:n,className:r})=>{const i=GE(n??{},t==="dark"?KE:WE);return y.jsx("div",{className:Y(r),style:{...$E(i),colorScheme:t},children:e})},gl=({children:t})=>y.jsx("div",{className:"bg-background rounded-outer p-2 max-w-[320px] space-y-4",children:t}),ZE=({children:t})=>y.jsx("div",{className:"bg-background rounded-outer p-2 w-fit flex items-center gap-2",children:t}),QE=({handler:t,context:e})=>{const[n,r]=A.useState(!1),[i,a]=A.useState(!0),[o,s]=A.useState(!0),{roomState:c,soundCheck:l,isUserSpeaking:u,isApplicationSpeaking:d}=my({active:n,micEnabled:i,speakersEnabled:o,handler:t,context:e});return n?c==="error"?y.jsx(gl,{children:y.jsx(Ey,{message:"Something went wrong"})}):c==="pending"?y.jsx(gl,{children:y.jsx("div",{className:"flex items-center p-8",children:y.jsx("span",{className:"w-6 h-6 block text-accent",children:y.jsx(rh,{})})})}):y.jsxs(ZE,{children:[y.jsxs("div",{className:"w-fit relative",children:[u?y.jsx(Ns,{className:"rounded-inner"}):null,y.jsx(ft,{Icon:dc,label:"Microphone",type:i?"activated":"ghost",onClick:()=>{a(h=>!h)}})]}),y.jsxs("div",{className:"w-fit relative",children:[d?y.jsx(Ns,{className:"rounded-inner"}):null,y.jsx(ft,{Icon:o?hc:pc,label:"Speakers",type:o?"activated":"ghost",onClick:()=>{s(h=>!h)}})]}),y.jsx(ft,{label:"Close",Icon:th,type:"error",onClick:()=>{r(!1)}})]}):y.jsxs(gl,{children:[y.jsx(gy,{soundCheck:l}),y.jsx(Ti,{type:"main",label:"I'm ready",Icon:Ni,onClick:()=>{r(!0)}})]})},Ry=A.forwardRef((t,e)=>{var n,r,i;const a=A.useMemo(()=>fC(t.config),[t.config]),[o,s]=A.useState([]),c=((n=o[o.length-1])==null?void 0:n.type)==="user",l=t.colorMode??"dark",[u,d]=A.useState(t.embedded),h=pC(t.config),[f,v]=A.useState(!1),k=A.useRef(t.embedded),S=t.input??"text",g=A.useCallback(q=>{t.onClose!=null&&(t.onClose(q),q.defaultPrevented||d(!1))},[t.onClose,d]);A.useEffect(()=>{k.current=u},[u]),A.useImperativeHandle(e,()=>({setExpanded:d,getExpanded(){return k.current},getConversationHandler(){return a}}),[a,d]),A.useEffect(()=>{const q=R=>{s(R)};return a.subscribe(q),()=>{a.unsubscribe(q)}},[a,s]);const b=A.useRef(!1);A.useEffect(()=>{!u||b.current||(b.current=!0,t.initializeConversation(a,t.initialContext))},[t.initializeConversation,t.initialContext,a,u]);const p=t.windowSize??(t.embedded?"full":"half"),m=A.useMemo(()=>{const q=sf(z=>z.type==="bot",o);if(q===-1)return null;const R=o[q];return(R==null?void 0:R.type)!=="bot"?null:{index:q,response:R}},[o]),w=A.useMemo(()=>{if(m==null)return;const q=sf(z=>z.choices.length>0,m.response.payload.messages);if(q===-1)return;const R=m.response.payload.messages[q];if(R!=null)return{message:R,messageIndex:q,responseIndex:m.index}},[m]),[T,x]=A.useState(!1),[E,O]=A.useState({}),N=t.customModalities??{},[U,W]=A.useState(!0);return a==null?null:u?S==="voiceMini"?y.jsx(rs,{theme:t.theme,colorMode:l,className:"fixed bottom-2 right-2 w-fit",children:y.jsx(QE,{handler:a,context:t.initialContext})}):y.jsxs(rs,{theme:t.theme,colorMode:l,className:"grid grid-cols-2 xl:grid-cols-[1fr_632px] fixed inset-0 z-touchpoint",children:[p==="half"?y.jsx("div",{className:"hidden md:block bg-overlay"}):null,y.jsxs("div",{className:Y("w-full bg-background text-primary-80 flex relative flex-col h-full backdrop-blur-overlay",{"col-span-2 md:col-span-1":p==="half","col-span-2":p==="full"}),children:[y.jsx(iS,{windowSize:t.embedded?"embedded":p,errorThemedCloseButton:S==="voice"&&T,speakerControls:S==="voice"&&T?{enabled:U,setEnabled:W}:void 0,colorMode:l,brandIcon:t.brandIcon,isSettingsOpen:f,enabled:t.enabled,toggleSettings:t.enableSettings?()=>{v(q=>!q)}:void 0,renderCollapse:t.onClose!=null,collapse:q=>{S==="voice"&&a.reset({clearResponses:!0}),x(!1),g(q)},reset:()=>{a.reset({clearResponses:!0}),S!=="voice"&&t.initializeConversation(a),x(!1)}}),f?y.jsx(Hx,{className:Y("flex-none",p==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{v(!1)},handler:a}):S==="text"?y.jsx(y.Fragment,{children:h?y.jsxs(y.Fragment,{children:[y.jsx(PE,{enabled:t.enabled,userMessageBubble:t.userMessageBubble??!1,agentMessageBubble:t.agentMessageBubble??!1,chatMode:t.chatMode??!1,isWaiting:c,lastBotResponseIndex:m==null?void 0:m.index,responses:o,colorMode:l,handler:a,uploadedFiles:E,customModalities:N,className:Y("flex-grow",p==="full"?"w-full md:max-w-content md:mx-auto":"")}),y.jsxs("div",{className:Y("p-2 md:p-3 flex flex-col flex-none gap-2",p==="full"?"w-full md:max-w-content md:mx-auto":""),children:[w!=null?y.jsx(xE,{...w,handler:a}):null,(w==null?void 0:w.message.selectedChoiceId)!=null?null:y.jsx(qE,{enabled:t.enabled,handler:a,uploadUrl:(i=(r=m==null?void 0:m.response.payload.metadata)==null?void 0:r.uploadUrls)==null?void 0:i[0],onFileUpload:({uploadId:q,file:R})=>{O(z=>({...z,[q]:R}))}})]})]}):y.jsx(P0,{})}):y.jsx(Vx,{active:T,initializeConversation:t.initializeConversation,setActive:x,brandIcon:t.brandIcon,handler:a,speakersEnabled:U,colorMode:l,className:"flex-grow",context:t.initialContext,customModalities:N})]})]}):t.launchIcon!==!1?y.jsx(rs,{className:"font-sans",theme:t.theme,colorMode:l,children:y.jsx(ZC,{className:"fixed z-100 bottom-2 right-2 backdrop-blur z-launchButton",iconUrl:typeof t.launchIcon=="string"?t.launchIcon:void 0,onClick:()=>{d(!0)},label:"Expand chat"})}):null});Ry.displayName="App";const Iy=`*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:var(--font-family);font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*{font-family:var(--font-family)!important}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.visible{visibility:visible}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.inset-x-0{left:0;right:0}.bottom-2{bottom:.5rem}.bottom-4{bottom:1rem}.left-1\\/2{left:50%}.left-4{left:1rem}.right-2{right:.5rem}.right-4{right:1rem}.top-0{top:0}.top-1\\/2{top:50%}.top-4{top:1rem}.z-10{z-index:10}.z-launchButton{z-index:100}.z-touchpoint{z-index:1000}.col-span-1{grid-column:span 1 / span 1}.col-span-2{grid-column:span 2 / span 2}.-mx-2{margin-left:-.5rem;margin-right:-.5rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-auto{margin-left:auto}.mr-10{margin-right:2.5rem}.mr-2{margin-right:.5rem}.block{display:block}.inline{display:inline}.flex{display:flex}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-10{height:2.5rem}.h-20{height:5rem}.h-24{height:6rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-52{height:13rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-72{height:18rem}.h-8{height:2rem}.h-\\[128px\\]{height:128px}.h-\\[1px\\]{height:1px}.h-\\[360px\\]{height:360px}.h-full{height:100%}.max-h-\\[40vh\\]{max-height:40vh}.min-h-full{min-height:100%}.w-10{width:2.5rem}.w-20{width:5rem}.w-24{width:6rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-72{width:18rem}.w-8{width:2rem}.w-80{width:20rem}.w-\\[128px\\]{width:128px}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.max-w-\\[320px\\]{max-width:320px}.max-w-content{max-width:640px}.flex-none{flex:none}.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes ping{75%,to{transform:scale(2);opacity:0}}.animate-ping{animation:ping 1s cubic-bezier(0,0,.2,1) infinite}.cursor-pointer{cursor:pointer}.resize-none{resize:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-\\[320px\\,1fr\\]{grid-template-columns:320px 1fr}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.space-y-px>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1px * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.rounded-full{border-radius:9999px}.rounded-inner{border-radius:var(--inner-border-radius)}.rounded-outer{border-radius:var(--outer-border-radius)}.border{border-width:1px}.border-background{border-color:var(--background)}.bg-\\[rgb\\(175\\,175\\,175\\)\\]{--tw-bg-opacity: 1;background-color:rgb(175 175 175 / var(--tw-bg-opacity))}.bg-\\[rgb\\(40\\,41\\,47\\)\\]{--tw-bg-opacity: 1;background-color:rgb(40 41 47 / var(--tw-bg-opacity))}.bg-accent{background-color:var(--accent)}.bg-accent-20{background-color:var(--accent-20)}.bg-background{background-color:var(--background)}.bg-black\\/50{background-color:#00000080}.bg-error-primary{background-color:var(--error-primary)}.bg-error-secondary{background-color:var(--error-secondary)}.bg-overlay{background-color:var(--overlay)}.bg-primary-5{background-color:var(--primary-5)}.bg-primary-80{background-color:var(--primary-80)}.bg-secondary-40{background-color:var(--secondary-40)}.bg-secondary-60{background-color:var(--secondary-60)}.bg-transparent{background-color:transparent}.bg-cover{background-size:cover}.bg-center{background-position:center}.object-cover{-o-object-fit:cover;object-fit:cover}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-8{padding:2rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\\.5{padding-top:.625rem;padding-bottom:.625rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pb-1{padding-bottom:.25rem}.pl-10{padding-left:2.5rem}.pl-4{padding-left:1rem}.pr-2{padding-right:.5rem}.pt-3{padding-top:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-sans{font-family:var(--font-family)}.text-base{font-size:1rem;line-height:1.5rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-normal{font-weight:400}.text-accent{color:var(--accent)}.text-error-primary{color:var(--error-primary)}.text-primary-20{color:var(--primary-20)}.text-primary-40{color:var(--primary-40)}.text-primary-60{color:var(--primary-60)}.text-primary-80{color:var(--primary-80)}.text-secondary-40{color:var(--secondary-40)}.text-secondary-80{color:var(--secondary-80)}.placeholder-primary-20::-moz-placeholder{color:var(--primary-20)}.placeholder-primary-20::placeholder{color:var(--primary-20)}.placeholder-primary-40::-moz-placeholder{color:var(--primary-40)}.placeholder-primary-40::placeholder{color:var(--primary-40)}.caret-accent{caret-color:var(--accent)}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-\\[0\\.01\\]{opacity:.01}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.outline-0{outline-width:0px}.outline-2{outline-width:2px}.outline-accent{outline-color:var(--accent)}.drop-shadow{--tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / .1)) drop-shadow(0 1px 1px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur{--tw-backdrop-blur: blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-overlay{--tw-backdrop-blur: blur(48px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-500{transition-duration:.5s}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}@property --glow-opacity{syntax: "<percentage>"; inherits: false; initial-value: 0%;}.fullscreen-error svg{animation:error-glow 3s ease infinite;--glow-opacity: 0%;filter:drop-shadow(0 0 6px color-mix(in srgb,transparent,var(--accent) var(--glow-opacity)))}@keyframes error-glow{0%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}22%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}35%{color:var(--accent);fill-opacity:80%;--glow-opacity: 60%}45%{color:var(--accent);fill-opacity:70%;--glow-opacity: 30%}55%{color:var(--accent);fill-opacity:60%;--glow-opacity: 60%}60%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}to{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}}.markdown ul{list-style-position:inside;list-style-type:disc}.markdown ol{list-style-position:inside;list-style-type:decimal}.markdown hr{border-color:var(--primary-20)}.markdown a{text-decoration-line:underline}.markdown h1,.markdown h2,.markdown h3{font-weight:700}.placeholder\\:text-primary-40::-moz-placeholder{color:var(--primary-40)}.placeholder\\:text-primary-40::placeholder{color:var(--primary-40)}.before\\:absolute:before{content:var(--tw-content);position:absolute}.before\\:inset-0:before{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.before\\:-z-10:before{content:var(--tw-content);z-index:-10}.before\\:bg-transparent:before{content:var(--tw-content);background-color:transparent}.before\\:transition-colors:before{content:var(--tw-content);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.before\\:content-\\[\\'\\'\\]:before{--tw-content: "";content:var(--tw-content)}.after\\:pointer-events-none:after{content:var(--tw-content);pointer-events:none}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:inset-0:after{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.after\\:rounded-outer:after{content:var(--tw-content);border-radius:var(--outer-border-radius)}.after\\:content-\\[\\'\\'\\]:after{--tw-content: "";content:var(--tw-content)}.hover\\:bg-primary-10:hover{background-color:var(--primary-10)}.hover\\:bg-primary-5:hover{background-color:var(--primary-5)}.hover\\:bg-primary-80:hover{background-color:var(--primary-80)}.hover\\:bg-secondary-20:hover{background-color:var(--secondary-20)}.hover\\:text-primary-80:hover{color:var(--primary-80)}.hover\\:after\\:bg-primary-10:hover:after{content:var(--tw-content);background-color:var(--primary-10)}.focus\\:outline-0:focus{outline-width:0px}.focus\\:before\\:bg-primary-10:focus:before{content:var(--tw-content);background-color:var(--primary-10)}.focus\\:before\\:bg-primary-40:focus:before{content:var(--tw-content);background-color:var(--primary-40)}.focus\\:before\\:bg-primary-5:focus:before{content:var(--tw-content);background-color:var(--primary-5)}.focus\\:before\\:bg-primary-80:focus:before{content:var(--tw-content);background-color:var(--primary-80)}.enabled\\:hover\\:before\\:bg-primary-10:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-10)}.enabled\\:hover\\:before\\:bg-primary-40:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-40)}.enabled\\:hover\\:before\\:bg-primary-5:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-5)}.enabled\\:hover\\:before\\:bg-primary-80:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-80)}.enabled\\:active\\:before\\:bg-secondary-10:active:enabled:before{content:var(--tw-content);background-color:var(--secondary-10)}.disabled\\:bg-accent-20:disabled{background-color:var(--accent-20)}.disabled\\:bg-primary-10:disabled{background-color:var(--primary-10)}.disabled\\:bg-primary-5:disabled{background-color:var(--primary-5)}.disabled\\:bg-secondary-20:disabled{background-color:var(--secondary-20)}.disabled\\:text-primary-20:disabled{color:var(--primary-20)}.disabled\\:text-primary-40:disabled{color:var(--primary-40)}.disabled\\:text-secondary-40:disabled{color:var(--secondary-40)}@media (min-width: 768px){.md\\:absolute{position:absolute}.md\\:left-0{left:0}.md\\:right-0{right:0}.md\\:top-0{top:0}.md\\:-order-1{order:-1}.md\\:col-span-1{grid-column:span 1 / span 1}.md\\:mx-auto{margin-left:auto;margin-right:auto}.md\\:block{display:block}.md\\:w-fit{width:-moz-fit-content;width:fit-content}.md\\:max-w-content{max-width:640px}.md\\:-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.md\\:flex-col{flex-direction:column}.md\\:p-3{padding:.75rem}}@media (min-width: 1280px){.xl\\:grid-cols-\\[1fr_632px\\]{grid-template-columns:1fr 632px}}`,JE=({children:t,faded:e})=>y.jsx("p",{className:Y("text-base",e?"text-primary-60":"text-primary-80"),children:t}),YE=({children:t})=>y.jsx("p",{className:"text-sm text-primary-60",children:t}),XE=({children:t,selected:e,onClick:n,href:r,newTab:i})=>{const a=Y("block shrink-0 rounded-inner overflow-hidden","w-80 space-y-px",e?"outline outline-2 outline-accent":"",n!=null||r!=null?"hover:bg-primary-5":"");return A.useEffect(()=>{r==null&&i!=null&&console.warn("Setting the `newTab` prop on the `<CustomCard/>` has no effect if the `href` is not also set.")},[r,i]),r!=null?y.jsx("a",{className:a,href:r,onClick:n,...i?{target:"_blank",rel:"noreferrer"}:{},children:t}):n!=null?y.jsx("button",{className:a,onClick:n,children:t}):y.jsx("div",{className:a,children:t})},eP=({src:t,alt:e})=>y.jsx("img",{src:t,alt:e,className:"w-full h-52 object-cover"}),tP=({left:t,right:e,icon:n})=>y.jsxs("div",{className:"flex items-center relative justify-between gap-2 bg-primary-5 px-3 py-4",children:[y.jsx("div",{className:"space-y-1 text-left",children:t}),y.jsx("div",{className:"space-y-1 text-right",children:e}),n!=null?y.jsx(n,{className:"text-primary-60 w-4 h-4 absolute top-1/2 left-1/2 transform -translate-y-1/2 -translate-x-1/2"}):null]});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _y=function(t,e){return(_y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(t,e)},nP,Io,rP=(function(t){/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var a=arguments[i];if(a){var o=typeof a;if(o==="string"||o==="number")r.push(a);else if(Array.isArray(a)&&a.length){var s=n.apply(null,a);s&&r.push(s)}else if(o==="object")for(var c in a)e.call(a,c)&&a[c]&&r.push(c)}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()}(Io={path:nP,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e==null&&Io.path)}},Io.exports),Io.exports);function Qu(t,e,n){var r,i,a,o,s;function c(){var u=Date.now()-o;u<e&&u>=0?r=setTimeout(c,e-u):(r=null,n||(s=t.apply(a,i),a=i=null))}e==null&&(e=100);var l=function(){a=this,i=arguments,o=Date.now();var u=n&&!r;return r||(r=setTimeout(c,e)),u&&(s=t.apply(a,i),a=i=null),s};return l.clear=function(){r&&(clearTimeout(r),r=null)},l.flush=function(){r&&(s=t.apply(a,i),a=i=null,clearTimeout(r),r=null)},l}Qu.debounce=Qu;var iP=Qu;(function(t,e){e===void 0&&(e={});var n=e.insertAt;if(typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",n==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var vl,aP=(vl="indiana-scroll-container",function(t,e){if(!t)return vl;var n;typeof t=="string"?n=t:e=t;var r=vl;return n&&(r+="__"+n),r+(e?Object.keys(e).reduce(function(i,a){var o=e[a];return o&&(i+=" "+(typeof o=="boolean"?r+"--"+a:r+"--"+a+"_"+o)),i},""):"")}),oP=function(t){function e(n){var r=t.call(this,n)||this;return r.onEndScroll=function(){r.scrolling=!1,!r.pressed&&r.started&&r.processEnd()},r.onScroll=function(i){var a=r.container.current;a.scrollLeft===r.scrollLeft&&a.scrollTop===r.scrollTop||(r.scrolling=!0,r.processScroll(i),r.onEndScroll())},r.onTouchStart=function(i){var a=r.props.nativeMobileScroll;if(r.isDraggable(i.target))if(r.internal=!0,a&&r.scrolling)r.pressed=!0;else{var o=i.touches[0];r.processClick(i,o.clientX,o.clientY),!a&&r.props.stopPropagation&&i.stopPropagation()}},r.onTouchEnd=function(i){var a=r.props.nativeMobileScroll;r.pressed&&(!r.started||r.scrolling&&a?r.pressed=!1:r.processEnd(),r.forceUpdate())},r.onTouchMove=function(i){var a=r.props.nativeMobileScroll;if(r.pressed&&(!a||!r.isMobile)){var o=i.touches[0];o&&r.processMove(i,o.clientX,o.clientY),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation()}},r.onMouseDown=function(i){r.isDraggable(i.target)&&r.isScrollable()&&(r.internal=!0,r.props.buttons.indexOf(i.button)!==-1&&(r.processClick(i,i.clientX,i.clientY),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation()))},r.onMouseMove=function(i){r.pressed&&(r.processMove(i,i.clientX,i.clientY),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation())},r.onMouseUp=function(i){r.pressed&&(r.started?r.processEnd():(r.internal=!1,r.pressed=!1,r.forceUpdate(),r.props.onClick&&r.props.onClick(i)),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation())},r.container=wr.createRef(),r.onEndScroll=iP(r.onEndScroll,300),r.scrolling=!1,r.started=!1,r.pressed=!1,r.internal=!1,r.getRef=r.getRef.bind(r),r}return function(n,r){function i(){this.constructor=n}_y(n,r),n.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}(e,t),e.prototype.componentDidMount=function(){var n=this.props.nativeMobileScroll,r=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),r.addEventListener("touchstart",this.onTouchStart,{passive:!1}),r.addEventListener("mousedown",this.onMouseDown,{passive:!1}),n&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},e.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},e.prototype.getElement=function(){return this.container.current},e.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},e.prototype.isDraggable=function(n){var r=this.props.ignoreElements;if(r){var i=n.closest(r);return i===null||i.contains(this.getElement())}return!0},e.prototype.isScrollable=function(){var n=this.container.current;return n&&(n.scrollWidth>n.clientWidth||n.scrollHeight>n.clientHeight)},e.prototype.processClick=function(n,r,i){var a=this.container.current;this.scrollLeft=a.scrollLeft,this.scrollTop=a.scrollTop,this.clientX=r,this.clientY=i,this.pressed=!0},e.prototype.processStart=function(n){n===void 0&&(n=!0);var r=this.props.onStartScroll;this.started=!0,n&&document.body.classList.add("indiana-dragging"),r&&r({external:!this.internal}),this.forceUpdate()},e.prototype.processScroll=function(n){if(this.started){var r=this.props.onScroll;r&&r({external:!this.internal})}else this.processStart(!1)},e.prototype.processMove=function(n,r,i){var a=this.props,o=a.horizontal,s=a.vertical,c=a.activationDistance,l=a.onScroll,u=this.container.current;this.started?(o&&(u.scrollLeft-=r-this.clientX),s&&(u.scrollTop-=i-this.clientY),l&&l({external:!this.internal}),this.clientX=r,this.clientY=i,this.scrollLeft=u.scrollLeft,this.scrollTop=u.scrollTop):(o&&Math.abs(r-this.clientX)>c||s&&Math.abs(i-this.clientY)>c)&&(this.clientX=r,this.clientY=i,this.processStart())},e.prototype.processEnd=function(){var n=this.props.onEndScroll;this.container.current&&n&&n({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},e.prototype.getRef=function(n){[this.container,this.props.innerRef].forEach(function(r){r&&(typeof r=="function"?r(n):r.current=n)})},e.prototype.render=function(){var n=this.props,r=n.children,i=n.draggingClassName,a=n.className,o=n.style,s=n.hideScrollbars,c=n.component;return wr.createElement(c,{className:rP(a,this.pressed&&i,aP({dragging:this.pressed,"hide-scrollbars":s,"native-scroll":this.isMobile})),style:o,ref:this.getRef,onScroll:this.onScroll},r)},e.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},e}(A.PureComponent);const sP=({children:t})=>y.jsx(oP,{className:"flex gap-x-2 pt-3 pb-1 overflow-x-auto no-scrollbar px-2 -mx-2",children:t});function Cm(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function cP(t,e,n){return e=Ks(e),function(r,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(r)}(t,Ly()?Reflect.construct(e,n||[],Ks(t).constructor):e.apply(t,n))}function lP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uP(t,e,n){return Object.defineProperty(t,"prototype",{writable:!1}),t}function Oy(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(c,l){if(c){if(typeof c=="string")return Cm(c,l);var u={}.toString.call(c).slice(8,-1);return u==="Object"&&c.constructor&&(u=c.constructor.name),u==="Map"||u==="Set"?Array.from(c):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?Cm(c,l):void 0}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{o||n.return==null||n.return()}finally{if(s)throw a}}}}function Ny(t,e,n){return(e=function(r){var i=function(a,o){if(typeof a!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var c=s.call(a,o);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(a)}(r,"string");return typeof i=="symbol"?i:i+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ws(){return Ws=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ws.apply(null,arguments)}function Ks(t){return Ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ks(t)}function dP(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ju(t,e)}function Ly(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ly=function(){return!!t})()}function Sm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function _o(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Sm(Object(n),!0).forEach(function(r){Ny(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sm(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function My(t,e){if(t==null)return{};var n,r,i=function(o,s){if(o==null)return{};var c={};for(var l in o)if({}.hasOwnProperty.call(o,l)){if(s.includes(l))continue;c[l]=o[l]}return c}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Ju(t,e){return Ju=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Ju(t,e)}function wa(t,e){var n,r=e.replacementChars,i=e.replacement,a=e.separate,o=r,s="",c=Oy(t);try{for(c.s();!(n=c.n()).done;){var l,u=n.value,d=!Object.prototype.hasOwnProperty.call(i,u)&&((l=i[o[0]])===null||l===void 0?void 0:l.test(u));(a&&u===o[0]||d)&&(o=o.slice(1),s+=u)}}catch(h){c.e(h)}finally{c.f()}return s}function Dy(t,e){var n,r=e.mask,i=e.replacement,a=e.separate,o=e.showMask,s=0,c="",l=Oy(r);try{for(l.s();!(n=l.n()).done;){var u=n.value;if(!o&&t[s]===void 0)break;Object.prototype.hasOwnProperty.call(i,u)&&t[s]!==void 0?c+=t[s++]:c+=u}}catch(h){l.e(h)}finally{l.f()}if(a&&!o){for(var d=r.length-1;d>=0&&c[d]===r[d];d--);c=c.slice(0,d+1)}return c}function jy(t,e){for(var n=e.mask,r=e.replacement,i=[],a=0;a<n.length;a++){var o,s=(o=t[a])!==null&&o!==void 0?o:n[a],c=Object.prototype.hasOwnProperty.call(r,s)?"replacement":t[a]!==void 0&&t[a]!==n[a]?"input":"mask";i.push({type:c,value:s,index:a})}return i}function Mi(t){return t.length>0?Ny({},t,/./):{}}function Yu(t,e){for(var n=e.start,r=n===void 0?0:n,i=e.end,a=e.mask,o=e.replacement,s=e.separate,c=t.slice(r,i),l=a.slice(r,i),u="",d=0;d<l.length;d++){var h=Object.prototype.hasOwnProperty.call(o,l[d]);h&&c[d]!==void 0&&c[d]!==l[d]?u+=c[d]:h&&s&&(u+=l[d])}return u}function Ay(t,e){var n=e.mask,r=e.replacement,i=typeof r=="string"?Mi(r):r,a=RegExp("[^".concat(Object.keys(i).join(""),"]"),"g");return Dy(wa(t,{replacementChars:n.replace(a,""),replacement:i,separate:!1}),{mask:n,replacement:i,separate:!1,showMask:!1})}function hP(t,e){var n=e.mask,r=e.replacement,i=typeof r=="string"?Mi(r):r,a=Yu(t,{mask:n,replacement:i,separate:!1}),o=RegExp("[^".concat(Object.keys(i).join(""),"]"),"g");return wa(a,{replacementChars:n.replace(o,""),replacement:i,separate:!1})}function pP(t,e){var n=e.mask,r=e.replacement,i=typeof r=="string"?Mi(r):r;return jy(Ay(t,{mask:n,replacement:i}),{mask:n,replacement:i})}var fP=["[","]","\\","/","^","$",".","|","?","*","+","(",")","{","}"];function Tm(t){return fP.includes(t)?"\\".concat(t):t}function mP(t,e){for(var n=e.mask,r=e.replacement,i=typeof r=="string"?Mi(r):r,a=t==="partial"||t==="partial-inexact",o=t==="full"||t==="partial",s="",c=0;c<n.length;c++){var l=n[c];c===0&&(s="^"),a&&(s+="("),s+=Object.prototype.hasOwnProperty.call(i,l)?"".concat(o?"(?!".concat(Tm(l),")"):"","(").concat(i[l].source,")"):Tm(l),c===n.length-1&&(a&&(s+=")?".repeat(n.length)),s+="$")}return s}function gP(t,e){return new Proxy(t,{set:function(n,r,i){return r==="current"&&(i!==t.current&&(t.current!==null&&e.unregister(t.current),i!==null&&e.register(i)),n[r]=i,!0)}})}function vP(t,e,n){return e=$a(e),function(r,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(r)}(t,_h()?Reflect.construct(e,n||[],$a(t).constructor):e.apply(t,n))}function Uy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fy(t,e,n){return Object.defineProperty(t,"prototype",{writable:!1}),t}function bP(t,e,n){return(e=function(r){var i=function(a,o){if(typeof a!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var c=s.call(a,o);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(a)}(r,"string");return typeof i=="symbol"?i:i+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $a(t){return $a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$a(t)}function yP(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wa(t,e)}function _h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_h=function(){return!!t})()}function xm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Em(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xm(Object(n),!0).forEach(function(r){bP(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xm(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kP(t,e){if(t==null)return{};var n,r,i=function(o,s){if(o==null)return{};var c={};for(var l in o)if({}.hasOwnProperty.call(o,l)){if(s.includes(l))continue;c[l]=o[l]}return c}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Wa(t,e){return Wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Wa(t,e)}function Xu(t){return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(t)}function ed(t){var e=typeof Map=="function"?new Map:void 0;return ed=function(n){if(n===null||!function(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return function(i,a,o){if(_h())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,a);var c=new(i.bind.apply(i,s));return o&&Wa(c,o.prototype),c}(n,arguments,$a(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Wa(r,n)},ed(t)}var Ca=function(t){function e(n){var r;return Uy(this,e),(r=vP(this,e,[n])).name="SyntheticChangeError",r}return yP(e,t),Fy(e)}(ed(Error)),Pm,wP=["options"],CP=["text","email","tel","search","url"],By=Fy(function t(e){var n=e.init,r=e.tracking;Uy(this,t);var i=new WeakMap;this.register=function(a){var o;if(CP.includes(a.type)){var s=(o=a._wrapperState)!==null&&o!==void 0?o:{},c=s.initialValue,l=c===void 0?"":c,u=s.controlled,d=u!==void 0&&u,h=n({initialValue:a.value||l,controlled:d}),f=h.value,v=h.options,k={value:f,options:v,fallbackOptions:v},S={id:-1,cachedId:-1},g={value:"",selectionStart:0,selectionEnd:0},b=Object.getOwnPropertyDescriptor("_valueTracker"in a?a:HTMLInputElement.prototype,"value");Object.defineProperty(a,"value",Em(Em({},b),{},{set:function(T){var x;g.value=T,b==null||(x=b.set)===null||x===void 0||x.call(a,T)}})),a.value=f;var p=function(){var T=function(){var x,E;g.selectionStart=(x=a.selectionStart)!==null&&x!==void 0?x:0,g.selectionEnd=(E=a.selectionEnd)!==null&&E!==void 0?E:0,S.id=window.setTimeout(T)};S.id=window.setTimeout(T)},m=function(){window.clearTimeout(S.id),S.id=-1,S.cachedId=-1},w=function(T){try{var x,E;if(S.cachedId===S.id)throw new Ca("The input selection has not been updated.");S.cachedId=S.id;var O=a.value,N=a.selectionStart,U=a.selectionEnd;if(N===null||U===null)throw new Ca("The selection attributes have not been initialized.");var W,q=g.value;if(T.inputType===void 0&&(g.selectionStart=0,g.selectionEnd=q.length),N>g.selectionStart?W="insert":N<=g.selectionStart&&N<g.selectionEnd?W="deleteBackward":N===g.selectionEnd&&O.length<q.length&&(W="deleteForward"),W===void 0||(W==="deleteBackward"||W==="deleteForward")&&O.length>q.length)throw new Ca("Input type detection error.");var R="",z=g.selectionStart,H=g.selectionEnd;if(W==="insert")R=O.slice(g.selectionStart,N);else{var Q=q.length-O.length;z=N,H=N+Q}k.value!==q?k.options=k.fallbackOptions:k.fallbackOptions=k.options;var D=k.options,$=r({inputType:W,previousValue:q,previousOptions:D,value:O,addedValue:R,changeStart:z,changeEnd:H,selectionStart:N,selectionEnd:U}),K=$.options,Z=kP($,wP);a.value=Z.value,a.setSelectionRange(Z.selectionStart,Z.selectionEnd),k.value=Z.value,k.options=K,g.selectionStart=Z.selectionStart,g.selectionEnd=Z.selectionEnd,(x=a._valueTracker)===null||x===void 0||(E=x.setValue)===null||E===void 0||E.call(x,q)}catch(he){if(a.value=g.value,a.setSelectionRange(g.selectionStart,g.selectionEnd),T.preventDefault(),T.stopPropagation(),he.name!=="SyntheticChangeError")throw he}};document.activeElement===a&&p(),a.addEventListener("focus",p),a.addEventListener("blur",m),a.addEventListener("input",w),i.set(a,{onFocus:p,onBlur:m,onInput:w})}},this.unregister=function(a){var o=i.get(a);o!==void 0&&(a.removeEventListener("focus",o.onFocus),a.removeEventListener("blur",o.onBlur),a.removeEventListener("input",o.onInput),i.delete(a))}});Pm=By,Object.defineProperty(Pm.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Input"});function SP(t,e){return A.useCallback(function(n){t.current=n,typeof e=="function"?e(n):Xu(e)==="object"&&e!==null&&(e.current=n)},[t,e])}var Rm,TP=["track","modify"];function zr(t){var e,n,r,i;return{mask:(e=t.mask)!==null&&e!==void 0?e:"",replacement:typeof t.replacement=="string"?Mi(t.replacement):(n=t.replacement)!==null&&n!==void 0?n:{},showMask:(r=t.showMask)!==null&&r!==void 0&&r,separate:(i=t.separate)!==null&&i!==void 0&&i,track:t.track,modify:t.modify}}var zy=function(t){function e(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return lP(this,e),(n=cP(this,e,[{init:function(i){var a=i.initialValue,o=i.controlled,s=zr(r),c=s.mask,l=s.replacement,u=s.separate,d=s.showMask;return a=o||a?a:d?c:"",{value:a,options:{mask:c,replacement:l,separate:u}}},tracking:function(i){var a=i.inputType,o=i.previousValue,s=i.previousOptions,c=i.addedValue,l=i.changeStart,u=i.changeEnd,d=zr(r),h=d.track,f=d.modify,v=My(d,TP),k=v.mask,S=v.replacement,g=v.showMask,b=v.separate,p=_o(_o({},a==="insert"?{inputType:a,data:c}:{inputType:a,data:null}),{},{value:o,selectionStart:l,selectionEnd:u}),m=h==null?void 0:h(p);if(m===!1)throw new Ca("Custom tracking stop.");m===null?c="":m!==!0&&m!==void 0&&(c=m);var w=f==null?void 0:f(p);(w==null?void 0:w.mask)!==void 0&&(k=w.mask),(w==null?void 0:w.replacement)!==void 0&&(S=typeof(w==null?void 0:w.replacement)=="string"?Mi(w==null?void 0:w.replacement):w.replacement),(w==null?void 0:w.showMask)!==void 0&&(g=w.showMask),(w==null?void 0:w.separate)!==void 0&&(b=w.separate);var T=Yu(o,_o({end:l},s)),x=Yu(o,_o({start:u},s)),E=RegExp("[^".concat(Object.keys(S).join(""),"]"),"g"),O=k.replace(E,"");if(T&&(T=wa(T,{replacementChars:O,replacement:S,separate:b}),O=O.slice(T.length)),c&&(c=wa(c,{replacementChars:O,replacement:S,separate:!1}),O=O.slice(c.length)),a==="insert"&&c==="")throw new Ca("The character does not match the key value of the `replacement` object.");if(b){var N=k.slice(l,u).replace(E,""),U=N.length-c.length;U<0?x=x.slice(-U):U>0&&(x=N.slice(-U)+x)}x&&(x=wa(x,{replacementChars:O,replacement:S,separate:b}));var W=Dy(T+c+x,{mask:k,replacement:S,separate:b,showMask:g}),q=function(R){var z,H,Q,D=R.inputType,$=R.value,K=R.addedValue,Z=R.beforeChangeValue,he=R.mask,ir=R.replacement,sn=R.separate,ar=jy($,{mask:he,replacement:ir}).filter(function(Cc){var Nh=Cc.type;return Nh==="input"||sn&&Nh==="replacement"}),Kt=(z=ar[Z.length+K.length-1])===null||z===void 0?void 0:z.index,_t=(H=ar[Z.length-1])===null||H===void 0?void 0:H.index,Dr=(Q=ar[Z.length+K.length])===null||Q===void 0?void 0:Q.index;if(D==="insert"){if(Kt!==void 0)return Kt+1;if(Dr!==void 0)return Dr;if(_t!==void 0)return _t+1}if(D==="deleteForward"){if(Dr!==void 0)return Dr;if(_t!==void 0)return _t+1}if(D==="deleteBackward"){if(_t!==void 0)return _t+1;if(Dr!==void 0)return Dr}var Oh=$.split("").findIndex(function(Cc){return Object.prototype.hasOwnProperty.call(ir,Cc)});return Oh!==-1?Oh:$.length}({inputType:a,value:W,addedValue:c,beforeChangeValue:T,mask:k,replacement:S,separate:b});return{value:W,selectionStart:q,selectionEnd:q,options:{mask:k,replacement:S,separate:b}}}}])).format=function(i){return Ay(i,zr(r))},n.formatToParts=function(i){return pP(i,zr(r))},n.unformat=function(i){return hP(i,zr(r))},n.generatePattern=function(i){return mP(i,zr(r))},n}return dP(e,By),uP(e)}();Rm=zy,Object.defineProperty(Rm.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Mask"});function xP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mask,n=t.replacement,r=t.showMask,i=t.separate,a=t.track,o=t.modify,s=A.useRef(null),c=A.useRef({mask:e,replacement:n,showMask:r,separate:i,track:a,modify:o});return c.current.mask=e,c.current.replacement=n,c.current.showMask=r,c.current.separate=i,c.current.track=a,c.current.modify=o,A.useMemo(function(){return gP(s,new zy(c.current))},[])}var EP=["component","mask","replacement","showMask","separate","track","modify"];function PP(t,e){var n=t.component,r=t.mask,i=t.replacement,a=t.showMask,o=t.separate,s=t.track,c=t.modify,l=My(t,EP),u=xP({mask:r,replacement:i,showMask:a,separate:o,track:s,modify:c}),d=SP(u,e);return n?wr.createElement(n,Ws({ref:d},l)):wr.createElement("input",Ws({ref:d},l))}var RP=A.forwardRef(PP);const IP={mask:"MM / DD / YYYY",replacement:{D:/\d/,M:/\d/,Y:/\d/},showMask:!0},_P=({onSubmit:t})=>{const e=t==null,[n,r]=A.useState(null);return y.jsxs("div",{className:Y("relative bg-primary-5 flex items-center justify-between pl-4 py-2 pr-2 rounded-outer transition-colors duration-500 before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",e?"":"hover:bg-secondary-20"),children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx(u0,{className:"w-4 h-4 text-primary-60"}),y.jsx(RP,{...IP,className:Y("bg-transparent text-primary-80 outline-0 ml-2 py-2.5",e?"placeholder-primary-20 pointer-events-none":"placeholder-primary-40"),placeholder:"MM / DD / YYYY",onChange:i=>{const a=i.target.value,[o,s,c]=a.split(" / ");o!=null&&o.length===2&&s!=null&&s.length===2&&c!=null&&c.length===4?r(`${c}-${o}-${s}`):r(null)}})]}),y.jsx(ft,{className:"flex-none",label:"Send message",onClick:n==null||t==null?void 0:()=>{t(n)},type:"main",Icon:Ni})]})};var OP=Object.prototype.toString;function NP(t){return typeof t=="function"||OP.call(t)==="[object Function]"}function LP(t){var e=Number(t);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var MP=Math.pow(2,53)-1;function DP(t){var e=LP(t);return Math.min(Math.max(e,0),MP)}function Ut(t,e){var n=Array,r=Object(t);if(t==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var i=DP(r.length),a=NP(n)?Object(new n(i)):new Array(i),o=0,s;o<i;)s=r[o],a[o]=s,o+=1;return a.length=i,a}function Ka(t){"@babel/helpers - typeof";return Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ka(t)}function jP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vy(r.key),r)}}function UP(t,e,n){return e&&AP(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function FP(t,e,n){return e=Vy(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vy(t){var e=BP(t,"string");return Ka(e)=="symbol"?e:e+""}function BP(t,e){if(Ka(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ka(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var zP=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];jP(this,t),FP(this,"items",void 0),this.items=e}return UP(t,[{key:"add",value:function(e){return this.has(e)===!1&&this.items.push(e),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(e){var n=this.items.length;return this.items=this.items.filter(function(r){return r!==e}),n!==this.items.length}},{key:"forEach",value:function(e){var n=this;this.items.forEach(function(r){e(r,r,n)})}},{key:"has",value:function(e){return this.items.indexOf(e)!==-1}},{key:"size",get:function(){return this.items.length}}])}();const VP=typeof Set>"u"?Set:zP;function Ge(t){var e;return(e=t.localName)!==null&&e!==void 0?e:t.tagName.toLowerCase()}var HP={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},qP={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),none:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function $P(t,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-description","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(n){var r;return t.hasAttribute(n)&&!((r=qP[e])!==null&&r!==void 0&&r.has(n))})}function Hy(t,e){return $P(t,e)}function WP(t){var e=GP(t);if(e===null||td.indexOf(e)!==-1){var n=KP(t);if(td.indexOf(e||"")===-1||Hy(t,n||""))return n}return e}function KP(t){var e=HP[Ge(t)];if(e!==void 0)return e;switch(Ge(t)){case"a":case"area":case"link":if(t.hasAttribute("href"))return"link";break;case"img":return t.getAttribute("alt")===""&&!Hy(t,"img")?"presentation":"img";case"input":{var n=t,r=n.type;switch(r){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return r;case"range":return"slider";case"email":case"tel":case"text":case"url":return t.hasAttribute("list")?"combobox":"textbox";case"search":return t.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return t.hasAttribute("multiple")||t.size>1?"listbox":"combobox"}return null}function GP(t){var e=t.getAttribute("role");if(e!==null){var n=e.trim().split(" ")[0];if(n.length>0)return n}return null}var td=["presentation","none"];function ge(t){return t!==null&&t.nodeType===t.ELEMENT_NODE}function qy(t){return ge(t)&&Ge(t)==="caption"}function is(t){return ge(t)&&Ge(t)==="input"}function ZP(t){return ge(t)&&Ge(t)==="optgroup"}function QP(t){return ge(t)&&Ge(t)==="select"}function JP(t){return ge(t)&&Ge(t)==="table"}function YP(t){return ge(t)&&Ge(t)==="textarea"}function XP(t){var e=t.ownerDocument===null?t:t.ownerDocument,n=e.defaultView;if(n===null)throw new TypeError("no window available");return n}function e3(t){return ge(t)&&Ge(t)==="fieldset"}function t3(t){return ge(t)&&Ge(t)==="legend"}function n3(t){return ge(t)&&Ge(t)==="slot"}function r3(t){return ge(t)&&t.ownerSVGElement!==void 0}function i3(t){return ge(t)&&Ge(t)==="svg"}function a3(t){return r3(t)&&Ge(t)==="title"}function Gs(t,e){if(ge(t)&&t.hasAttribute(e)){var n=t.getAttribute(e).split(" "),r=t.getRootNode?t.getRootNode():t.ownerDocument;return n.map(function(i){return r.getElementById(i)}).filter(function(i){return i!==null})}return[]}function mn(t,e){return ge(t)?e.indexOf(WP(t))!==-1:!1}function o3(t){return t.trim().replace(/\s\s+/g," ")}function s3(t,e){if(!ge(t))return!1;if(t.hasAttribute("hidden")||t.getAttribute("aria-hidden")==="true")return!0;var n=e(t);return n.getPropertyValue("display")==="none"||n.getPropertyValue("visibility")==="hidden"}function c3(t){return mn(t,["button","combobox","listbox","textbox"])||$y(t,"range")}function $y(t,e){if(!ge(t))return!1;switch(e){case"range":return mn(t,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function Im(t,e){var n=Ut(t.querySelectorAll(e));return Gs(t,"aria-owns").forEach(function(r){n.push.apply(n,Ut(r.querySelectorAll(e)))}),n}function l3(t){return QP(t)?t.selectedOptions||Im(t,"[selected]"):Im(t,'[aria-selected="true"]')}function u3(t){return mn(t,td)}function d3(t){return qy(t)}function h3(t){return mn(t,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function p3(t){return!1}function f3(t){return is(t)||YP(t)?t.value:t.textContent||""}function _m(t){var e=t.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function Wy(t){var e=Ge(t);return e==="button"||e==="input"&&t.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function Ky(t){if(Wy(t))return t;var e=null;return t.childNodes.forEach(function(n){if(e===null&&ge(n)){var r=Ky(n);r!==null&&(e=r)}}),e}function m3(t){if(t.control!==void 0)return t.control;var e=t.getAttribute("for");return e!==null?t.ownerDocument.getElementById(e):Ky(t)}function g3(t){var e=t.labels;if(e===null)return e;if(e!==void 0)return Ut(e);if(!Wy(t))return null;var n=t.ownerDocument;return Ut(n.querySelectorAll("label")).filter(function(r){return m3(r)===t})}function v3(t){var e=t.assignedNodes();return e.length===0?Ut(t.childNodes):e}function Gy(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=new VP,r=typeof Map>"u"?void 0:new Map,i=XP(t),a=e.compute,o=a===void 0?"name":a,s=e.computedStyleSupportsPseudoElements,c=s===void 0?e.getComputedStyle!==void 0:s,l=e.getComputedStyle,u=l===void 0?i.getComputedStyle.bind(i):l,d=e.hidden,h=d===void 0?!1:d,f=function(p,m){if(m!==void 0)throw new Error("use uncachedGetComputedStyle directly for pseudo elements");if(r===void 0)return u(p);var w=r.get(p);if(w)return w;var T=u(p,m);return r.set(p,T),T};function v(p,m){var w="";if(ge(p)&&c){var T=u(p,"::before"),x=_m(T);w="".concat(x," ").concat(w)}var E=n3(p)?v3(p):Ut(p.childNodes).concat(Gs(p,"aria-owns"));if(E.forEach(function(U){var W=b(U,{isEmbeddedInLabel:m.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),q=ge(U)?f(U).getPropertyValue("display"):"inline",R=q!=="inline"?" ":"";w+="".concat(R).concat(W).concat(R)}),ge(p)&&c){var O=u(p,"::after"),N=_m(O);w="".concat(w," ").concat(N)}return w.trim()}function k(p,m){var w=p.getAttributeNode(m);return w!==null&&!n.has(w)&&w.value.trim()!==""?(n.add(w),w.value):null}function S(p){return ge(p)?k(p,"title"):null}function g(p){if(!ge(p))return null;if(e3(p)){n.add(p);for(var m=Ut(p.childNodes),w=0;w<m.length;w+=1){var T=m[w];if(t3(T))return b(T,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(JP(p)){n.add(p);for(var x=Ut(p.childNodes),E=0;E<x.length;E+=1){var O=x[E];if(qy(O))return b(O,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(i3(p)){n.add(p);for(var N=Ut(p.childNodes),U=0;U<N.length;U+=1){var W=N[U];if(a3(W))return W.textContent}return null}else if(Ge(p)==="img"||Ge(p)==="area"){var q=k(p,"alt");if(q!==null)return q}else if(ZP(p)){var R=k(p,"label");if(R!==null)return R}if(is(p)&&(p.type==="button"||p.type==="submit"||p.type==="reset")){var z=k(p,"value");if(z!==null)return z;if(p.type==="submit")return"Submit";if(p.type==="reset")return"Reset"}var H=g3(p);if(H!==null&&H.length!==0)return n.add(p),Ut(H).map(function(K){return b(K,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(K){return K.length>0}).join(" ");if(is(p)&&p.type==="image"){var Q=k(p,"alt");if(Q!==null)return Q;var D=k(p,"title");return D!==null?D:"Submit Query"}if(mn(p,["button"])){var $=v(p,{isEmbeddedInLabel:!1});if($!=="")return $}return null}function b(p,m){if(n.has(p))return"";if(!h&&s3(p,f)&&!m.isReferenced)return n.add(p),"";var w=ge(p)?p.getAttributeNode("aria-labelledby"):null,T=w!==null&&!n.has(w)?Gs(p,"aria-labelledby"):[];if(o==="name"&&!m.isReferenced&&T.length>0)return n.add(w),T.map(function(q){return b(q,{isEmbeddedInLabel:m.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var x=m.recursion&&c3(p)&&o==="name";if(!x){var E=(ge(p)&&p.getAttribute("aria-label")||"").trim();if(E!==""&&o==="name")return n.add(p),E;if(!u3(p)){var O=g(p);if(O!==null)return n.add(p),O}}if(mn(p,["menu"]))return n.add(p),"";if(x||m.isEmbeddedInLabel||m.isReferenced){if(mn(p,["combobox","listbox"])){n.add(p);var N=l3(p);return N.length===0?is(p)?p.value:"":Ut(N).map(function(q){return b(q,{isEmbeddedInLabel:m.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if($y(p,"range"))return n.add(p),p.hasAttribute("aria-valuetext")?p.getAttribute("aria-valuetext"):p.hasAttribute("aria-valuenow")?p.getAttribute("aria-valuenow"):p.getAttribute("value")||"";if(mn(p,["textbox"]))return n.add(p),f3(p)}if(h3(p)||ge(p)&&m.isReferenced||d3(p)||p3()){var U=v(p,{isEmbeddedInLabel:m.isEmbeddedInLabel});if(U!=="")return n.add(p),U}if(p.nodeType===p.TEXT_NODE)return n.add(p),p.textContent||"";if(m.recursion)return n.add(p),v(p,{isEmbeddedInLabel:m.isEmbeddedInLabel});var W=S(p);return W!==null?(n.add(p),W):(n.add(p),"")}return o3(b(t,{isEmbeddedInLabel:!1,isReferenced:o==="description",recursion:!1}))}function Ga(t){"@babel/helpers - typeof";return Ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ga(t)}function Om(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Nm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Om(Object(n),!0).forEach(function(r){b3(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Om(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function b3(t,e,n){return e=y3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y3(t){var e=k3(t,"string");return Ga(e)=="symbol"?e:e+""}function k3(t,e){if(Ga(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ga(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Gs(t,"aria-describedby").map(function(a){return Gy(a,Nm(Nm({},e),{},{compute:"description"}))}).join(" ");if(n===""){var r=t.getAttribute("aria-description");n=r===null?"":r}if(n===""){var i=t.getAttribute("title");n=i===null?"":i}return n}function w3(t){return mn(t,["caption","code","deletion","emphasis","generic","insertion","none","paragraph","presentation","strong","subscript","superscript"])}function Mm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return w3(t)?"":Gy(t,e)}const C3=t=>{if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){const e=Mm(t)??"";return{name:e===""?t.name:e,description:Lm(t),type:t.type,placeholder:t.placeholder,value:t.value}}else if(t instanceof HTMLSelectElement){const e=Mm(t)??"";return{name:e===""?t.name:e,description:Lm(t),type:t.type,value:t.value}}throw new TypeError("Unsupported element type")},R3=()=>{const t=Array.from(document.querySelectorAll("input, textarea, select")).map((n,r)=>({index:r,id:`${n.tagName.toLowerCase()}-${r}`,element:n})),e={};return t.forEach(({id:n,element:r})=>{e[n]=r}),{context:t.map(({id:n,element:r})=>({id:n,...C3(r)})),formElements:e}},I3=({children:t,mode:e,theme:n})=>y.jsxs(y.Fragment,{children:[y.jsx("style",{children:Iy}),y.jsx(rs,{className:"bg-background p-4 rounded-outer space-y-4",theme:n,colorMode:e,children:t})]}),S3=t=>Sw.bind((e,...n)=>A.createElement(t[e]??e,...n)),_3=S3({TextButton:Ti,IconButton:ft,BaseText:JE,SmallText:YE,DateInput:_P,Carousel:sP,CustomCard:XE,CustomCardRow:tP,CustomCardImageRow:eP,...GC});var ri,ia,Dn,Sa,as,nd;class T3 extends HTMLElement{constructor(){super(...arguments),Di(this,as),Di(this,ri,null),Di(this,ia,null),Di(this,Dn,null),ie(this,"onRef",null),ie(this,"embedded",!0),ie(this,"onClose",null),ie(this,"enableSettings",!1),Di(this,Sa,!0)}set enabled(e){kt(this,Sa)!==e&&(os(this,Sa,e),Lh(this,as,nd).call(this))}set touchpointConfiguration(e){TC(kt(this,Dn),e)||(os(this,Dn,e),Lh(this,as,nd).call(this))}disconnectedCallback(){var e;(e=kt(this,ri))==null||e.unmount()}}ri=new WeakMap,ia=new WeakMap,Dn=new WeakMap,Sa=new WeakMap,as=new WeakSet,nd=function(){kt(this,ia)??os(this,ia,this.attachShadow({mode:"closed"})),kt(this,ri)??os(this,ri,Qv(kt(this,ia))),kt(this,Dn)!=null&&kt(this,ri).render(y.jsxs(y.Fragment,{children:[y.jsx("style",{children:Iy}),y.jsx(Ry,{...kt(this,Dn),embedded:this.embedded,initializeConversation:kt(this,Dn).initializeConversation??((t,e)=>{var n;(((n=kt(this,Dn))==null?void 0:n.input)??"text")==="text"&&t.sendWelcomeFlow(e)}),onClose:this.onClose,enableSettings:this.enableSettings,enabled:kt(this,Sa),ref:t=>{var e;t!=null&&((e=this.onRef)==null||e.call(this,t))}})]}))};const x3=(t,e)=>{customElements.get(t)==null&&customElements.define(t,e)};x3("nlx-touchpoint",T3);const O3=t=>new Promise(e=>{const n=document.createElement("nlx-touchpoint");n.embedded=!1,n.onRef=r=>{e({set expanded(i){r.setExpanded(i)},get expanded(){return r.getExpanded()},get conversationHandler(){return r.getConversationHandler()},teardown:()=>{document.body.removeChild(n)}})},n.onClose=()=>{},n.enableSettings=!0,n.touchpointConfiguration=t,document.body.appendChild(n)});export{JE as BaseText,sP as Carousel,XE as CustomCard,eP as CustomCardImageRow,tP as CustomCardRow,_P as DateInput,ft as IconButton,GC as Icons,I3 as PreviewContainer,wr as React,YE as SmallText,Ti as TextButton,R3 as analyzePageForms,O3 as create,_3 as html};
