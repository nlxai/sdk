var Dg={},qw=Object.defineProperty,Xb=n=>{throw TypeError(n)},$w=(n,e,t)=>e in n?qw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yt=(n,e,t)=>$w(n,typeof e!="symbol"?e+"":e,t),df=(n,e,t)=>e.has(n)||Xb("Cannot "+t),Or=(n,e,t)=>(df(n,e,"read from private field"),e.get(n)),xl=(n,e,t)=>e.has(n)?Xb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Wu=(n,e,t,r)=>(df(n,e,"write to private field"),e.set(n,t),t),Ug=(n,e,t)=>(df(n,e,"access private method"),t);function Jb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fg={exports:{}},El={},Bg={exports:{}},lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zg;function Ww(){if(zg)return lt;zg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),T=Symbol.iterator;function x(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,N={};function V(L,ee,We){this.props=L,this.context=ee,this.refs=N,this.updater=We||S}V.prototype.isReactComponent={},V.prototype.setState=function(L,ee){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,ee,"setState")},V.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function $(){}$.prototype=V.prototype;function ae(L,ee,We){this.props=L,this.context=ee,this.refs=N,this.updater=We||S}var z=ae.prototype=new $;z.constructor=ae,M(z,V.prototype),z.isPureReactComponent=!0;var A=Array.isArray,F=Object.prototype.hasOwnProperty,J={current:null},de={key:!0,ref:!0,__self:!0,__source:!0};function te(L,ee,We){var Ke,Ye={},ze=null,et=null;if(ee!=null)for(Ke in ee.ref!==void 0&&(et=ee.ref),ee.key!==void 0&&(ze=""+ee.key),ee)F.call(ee,Ke)&&!de.hasOwnProperty(Ke)&&(Ye[Ke]=ee[Ke]);var $e=arguments.length-2;if($e===1)Ye.children=We;else if(1<$e){for(var ct=Array($e),Ot=0;Ot<$e;Ot++)ct[Ot]=arguments[Ot+2];Ye.children=ct}if(L&&L.defaultProps)for(Ke in $e=L.defaultProps,$e)Ye[Ke]===void 0&&(Ye[Ke]=$e[Ke]);return{$$typeof:n,type:L,key:ze,ref:et,props:Ye,_owner:J.current}}function K(L,ee){return{$$typeof:n,type:L.type,key:ee,ref:L.ref,props:L.props,_owner:L._owner}}function ne(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function Y(L){var ee={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(We){return ee[We]})}var me=/\/+/g;function Le(L,ee){return typeof L=="object"&&L!==null&&L.key!=null?Y(""+L.key):ee.toString(36)}function le(L,ee,We,Ke,Ye){var ze=typeof L;(ze==="undefined"||ze==="boolean")&&(L=null);var et=!1;if(L===null)et=!0;else switch(ze){case"string":case"number":et=!0;break;case"object":switch(L.$$typeof){case n:case e:et=!0}}if(et)return et=L,Ye=Ye(et),L=Ke===""?"."+Le(et,0):Ke,A(Ye)?(We="",L!=null&&(We=L.replace(me,"$&/")+"/"),le(Ye,ee,We,"",function(Ot){return Ot})):Ye!=null&&(ne(Ye)&&(Ye=K(Ye,We+(!Ye.key||et&&et.key===Ye.key?"":(""+Ye.key).replace(me,"$&/")+"/")+L)),ee.push(Ye)),1;if(et=0,Ke=Ke===""?".":Ke+":",A(L))for(var $e=0;$e<L.length;$e++){ze=L[$e];var ct=Ke+Le(ze,$e);et+=le(ze,ee,We,ct,Ye)}else if(ct=x(L),typeof ct=="function")for(L=ct.call(L),$e=0;!(ze=L.next()).done;)ze=ze.value,ct=Ke+Le(ze,$e++),et+=le(ze,ee,We,ct,Ye);else if(ze==="object")throw ee=String(L),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.");return et}function pe(L,ee,We){if(L==null)return L;var Ke=[],Ye=0;return le(L,Ke,"","",function(ze){return ee.call(We,ze,Ye++)}),Ke}function Oe(L){if(L._status===-1){var ee=L._result;ee=ee(),ee.then(function(We){(L._status===0||L._status===-1)&&(L._status=1,L._result=We)},function(We){(L._status===0||L._status===-1)&&(L._status=2,L._result=We)}),L._status===-1&&(L._status=0,L._result=ee)}if(L._status===1)return L._result.default;throw L._result}var Ee={current:null},ce={transition:null},Re={ReactCurrentDispatcher:Ee,ReactCurrentBatchConfig:ce,ReactCurrentOwner:J};function ue(){throw Error("act(...) is not supported in production builds of React.")}return lt.Children={map:pe,forEach:function(L,ee,We){pe(L,function(){ee.apply(this,arguments)},We)},count:function(L){var ee=0;return pe(L,function(){ee++}),ee},toArray:function(L){return pe(L,function(ee){return ee})||[]},only:function(L){if(!ne(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},lt.Component=V,lt.Fragment=t,lt.Profiler=o,lt.PureComponent=ae,lt.StrictMode=r,lt.Suspense=f,lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Re,lt.act=ue,lt.cloneElement=function(L,ee,We){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var Ke=M({},L.props),Ye=L.key,ze=L.ref,et=L._owner;if(ee!=null){if(ee.ref!==void 0&&(ze=ee.ref,et=J.current),ee.key!==void 0&&(Ye=""+ee.key),L.type&&L.type.defaultProps)var $e=L.type.defaultProps;for(ct in ee)F.call(ee,ct)&&!de.hasOwnProperty(ct)&&(Ke[ct]=ee[ct]===void 0&&$e!==void 0?$e[ct]:ee[ct])}var ct=arguments.length-2;if(ct===1)Ke.children=We;else if(1<ct){$e=Array(ct);for(var Ot=0;Ot<ct;Ot++)$e[Ot]=arguments[Ot+2];Ke.children=$e}return{$$typeof:n,type:L.type,key:Ye,ref:ze,props:Ke,_owner:et}},lt.createContext=function(L){return L={$$typeof:l,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:s,_context:L},L.Consumer=L},lt.createElement=te,lt.createFactory=function(L){var ee=te.bind(null,L);return ee.type=L,ee},lt.createRef=function(){return{current:null}},lt.forwardRef=function(L){return{$$typeof:d,render:L}},lt.isValidElement=ne,lt.lazy=function(L){return{$$typeof:v,_payload:{_status:-1,_result:L},_init:Oe}},lt.memo=function(L,ee){return{$$typeof:m,type:L,compare:ee===void 0?null:ee}},lt.startTransition=function(L){var ee=ce.transition;ce.transition={};try{L()}finally{ce.transition=ee}},lt.unstable_act=ue,lt.useCallback=function(L,ee){return Ee.current.useCallback(L,ee)},lt.useContext=function(L){return Ee.current.useContext(L)},lt.useDebugValue=function(){},lt.useDeferredValue=function(L){return Ee.current.useDeferredValue(L)},lt.useEffect=function(L,ee){return Ee.current.useEffect(L,ee)},lt.useId=function(){return Ee.current.useId()},lt.useImperativeHandle=function(L,ee,We){return Ee.current.useImperativeHandle(L,ee,We)},lt.useInsertionEffect=function(L,ee){return Ee.current.useInsertionEffect(L,ee)},lt.useLayoutEffect=function(L,ee){return Ee.current.useLayoutEffect(L,ee)},lt.useMemo=function(L,ee){return Ee.current.useMemo(L,ee)},lt.useReducer=function(L,ee,We){return Ee.current.useReducer(L,ee,We)},lt.useRef=function(L){return Ee.current.useRef(L)},lt.useState=function(L){return Ee.current.useState(L)},lt.useSyncExternalStore=function(L,ee,We){return Ee.current.useSyncExternalStore(L,ee,We)},lt.useTransition=function(){return Ee.current.useTransition()},lt.version="18.3.1",lt}var Vg;function hf(){return Vg||(Vg=1,Bg.exports=Ww()),Bg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hg;function Gw(){if(Hg)return El;Hg=1;var n=hf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(d,f,m){var v,T={},x=null,S=null;m!==void 0&&(x=""+m),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(S=f.ref);for(v in f)r.call(f,v)&&!s.hasOwnProperty(v)&&(T[v]=f[v]);if(d&&d.defaultProps)for(v in f=d.defaultProps,f)T[v]===void 0&&(T[v]=f[v]);return{$$typeof:e,type:d,key:x,ref:S,props:T,_owner:o.current}}return El.Fragment=t,El.jsx=l,El.jsxs=l,El}var qg;function Kw(){return qg||(qg=1,Fg.exports=Gw()),Fg.exports}var R=Kw(),Se=hf();const yo=Jb(Se);var gu={},Bh={exports:{}},er={},$g={exports:{}},Wg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function Zw(){return Gg||(Gg=1,function(n){function e(ce,Re){var ue=ce.length;ce.push(Re);e:for(;0<ue;){var L=ue-1>>>1,ee=ce[L];if(0<o(ee,Re))ce[L]=Re,ce[ue]=ee,ue=L;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var Re=ce[0],ue=ce.pop();if(ue!==Re){ce[0]=ue;e:for(var L=0,ee=ce.length,We=ee>>>1;L<We;){var Ke=2*(L+1)-1,Ye=ce[Ke],ze=Ke+1,et=ce[ze];if(0>o(Ye,ue))ze<ee&&0>o(et,Ye)?(ce[L]=et,ce[ze]=ue,L=ze):(ce[L]=Ye,ce[Ke]=ue,L=Ke);else if(ze<ee&&0>o(et,ue))ce[L]=et,ce[ze]=ue,L=ze;else break e}}return Re}function o(ce,Re){var ue=ce.sortIndex-Re.sortIndex;return ue!==0?ue:ce.id-Re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],m=[],v=1,T=null,x=3,S=!1,M=!1,N=!1,V=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,ae=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function z(ce){for(var Re=t(m);Re!==null;){if(Re.callback===null)r(m);else if(Re.startTime<=ce)r(m),Re.sortIndex=Re.expirationTime,e(f,Re);else break;Re=t(m)}}function A(ce){if(N=!1,z(ce),!M)if(t(f)!==null)M=!0,Oe(F);else{var Re=t(m);Re!==null&&Ee(A,Re.startTime-ce)}}function F(ce,Re){M=!1,N&&(N=!1,$(te),te=-1),S=!0;var ue=x;try{for(z(Re),T=t(f);T!==null&&(!(T.expirationTime>Re)||ce&&!Y());){var L=T.callback;if(typeof L=="function"){T.callback=null,x=T.priorityLevel;var ee=L(T.expirationTime<=Re);Re=n.unstable_now(),typeof ee=="function"?T.callback=ee:T===t(f)&&r(f),z(Re)}else r(f);T=t(f)}if(T!==null)var We=!0;else{var Ke=t(m);Ke!==null&&Ee(A,Ke.startTime-Re),We=!1}return We}finally{T=null,x=ue,S=!1}}var J=!1,de=null,te=-1,K=5,ne=-1;function Y(){return!(n.unstable_now()-ne<K)}function me(){if(de!==null){var ce=n.unstable_now();ne=ce;var Re=!0;try{Re=de(!0,ce)}finally{Re?Le():(J=!1,de=null)}}else J=!1}var Le;if(typeof ae=="function")Le=function(){ae(me)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,pe=le.port2;le.port1.onmessage=me,Le=function(){pe.postMessage(null)}}else Le=function(){V(me,0)};function Oe(ce){de=ce,J||(J=!0,Le())}function Ee(ce,Re){te=V(function(){ce(n.unstable_now())},Re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){M||S||(M=!0,Oe(F))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(ce){switch(x){case 1:case 2:case 3:var Re=3;break;default:Re=x}var ue=x;x=Re;try{return ce()}finally{x=ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Re){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var ue=x;x=ce;try{return Re()}finally{x=ue}},n.unstable_scheduleCallback=function(ce,Re,ue){var L=n.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?L+ue:L):ue=L,ce){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=ue+ee,ce={id:v++,callback:Re,priorityLevel:ce,startTime:ue,expirationTime:ee,sortIndex:-1},ue>L?(ce.sortIndex=ue,e(m,ce),t(f)===null&&ce===t(m)&&(N?($(te),te=-1):N=!0,Ee(A,ue-L))):(ce.sortIndex=ee,e(f,ce),M||S||(M=!0,Oe(F))),ce},n.unstable_shouldYield=Y,n.unstable_wrapCallback=function(ce){var Re=x;return function(){var ue=x;x=Re;try{return ce.apply(this,arguments)}finally{x=ue}}}}(Wg)),Wg}var Kg;function Qw(){return Kg||(Kg=1,$g.exports=Zw()),$g.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg;function Xw(){if(Zg)return er;Zg=1;var n=hf(),e=Qw();function t(i){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,o={};function s(i,a){l(i,a),l(i+"Capture",a)}function l(i,a){for(o[i]=a,i=0;i<a.length;i++)r.add(a[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},T={};function x(i){return f.call(T,i)?!0:f.call(v,i)?!1:m.test(i)?T[i]=!0:(v[i]=!0,!1)}function S(i,a,c,p){if(c!==null&&c.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return p?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function M(i,a,c,p){if(a===null||typeof a>"u"||S(i,a,c,p))return!0;if(p)return!1;if(c!==null)switch(c.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function N(i,a,c,p,b,w,P){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=p,this.attributeNamespace=b,this.mustUseProperty=c,this.propertyName=i,this.type=a,this.sanitizeURL=w,this.removeEmptyString=P}var V={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){V[i]=new N(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var a=i[0];V[a]=new N(a,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){V[i]=new N(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){V[i]=new N(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){V[i]=new N(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){V[i]=new N(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){V[i]=new N(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){V[i]=new N(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){V[i]=new N(i,5,!1,i.toLowerCase(),null,!1,!1)});var $=/[\-:]([a-z])/g;function ae(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var a=i.replace($,ae);V[a]=new N(a,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var a=i.replace($,ae);V[a]=new N(a,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var a=i.replace($,ae);V[a]=new N(a,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){V[i]=new N(i,1,!1,i.toLowerCase(),null,!1,!1)}),V.xlinkHref=new N("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){V[i]=new N(i,1,!1,i.toLowerCase(),null,!0,!0)});function z(i,a,c,p){var b=V.hasOwnProperty(a)?V[a]:null;(b!==null?b.type!==0:p||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(M(a,c,b,p)&&(c=null),p||b===null?x(a)&&(c===null?i.removeAttribute(a):i.setAttribute(a,""+c)):b.mustUseProperty?i[b.propertyName]=c===null?b.type===3?!1:"":c:(a=b.attributeName,p=b.attributeNamespace,c===null?i.removeAttribute(a):(b=b.type,c=b===3||b===4&&c===!0?"":""+c,p?i.setAttributeNS(p,a,c):i.setAttribute(a,c))))}var A=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),J=Symbol.for("react.portal"),de=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),Y=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),Le=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),Oe=Symbol.for("react.lazy"),Ee=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Re(i){return i===null||typeof i!="object"?null:(i=ce&&i[ce]||i["@@iterator"],typeof i=="function"?i:null)}var ue=Object.assign,L;function ee(i){if(L===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);L=a&&a[1]||""}return`
`+L+i}var We=!1;function Ke(i,a){if(!i||We)return"";We=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ie){var p=ie}Reflect.construct(i,[],a)}else{try{a.call()}catch(ie){p=ie}i.call(a.prototype)}else{try{throw Error()}catch(ie){p=ie}i()}}catch(ie){if(ie&&p&&typeof ie.stack=="string"){for(var b=ie.stack.split(`
`),w=p.stack.split(`
`),P=b.length-1,j=w.length-1;1<=P&&0<=j&&b[P]!==w[j];)j--;for(;1<=P&&0<=j;P--,j--)if(b[P]!==w[j]){if(P!==1||j!==1)do if(P--,j--,0>j||b[P]!==w[j]){var B=`
`+b[P].replace(" at new "," at ");return i.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",i.displayName)),B}while(1<=P&&0<=j);break}}}finally{We=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?ee(i):""}function Ye(i){switch(i.tag){case 5:return ee(i.type);case 16:return ee("Lazy");case 13:return ee("Suspense");case 19:return ee("SuspenseList");case 0:case 2:case 15:return i=Ke(i.type,!1),i;case 11:return i=Ke(i.type.render,!1),i;case 1:return i=Ke(i.type,!0),i;default:return""}}function ze(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case de:return"Fragment";case J:return"Portal";case K:return"Profiler";case te:return"StrictMode";case Le:return"Suspense";case le:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Y:return(i.displayName||"Context")+".Consumer";case ne:return(i._context.displayName||"Context")+".Provider";case me:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case pe:return a=i.displayName||null,a!==null?a:ze(i.type)||"Memo";case Oe:a=i._payload,i=i._init;try{return ze(i(a))}catch{}}return null}function et(i){var a=i.type;switch(i.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=a.render,i=i.displayName||i.name||"",a.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ze(a);case 8:return a===te?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function $e(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ct(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ot(i){var a=ct(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,a),p=""+i[a];if(!i.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var b=c.get,w=c.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return b.call(this)},set:function(P){p=""+P,w.call(this,P)}}),Object.defineProperty(i,a,{enumerable:c.enumerable}),{getValue:function(){return p},setValue:function(P){p=""+P},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function Ht(i){i._valueTracker||(i._valueTracker=Ot(i))}function $n(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var c=a.getValue(),p="";return i&&(p=ct(i)?i.checked?"true":"false":i.value),i=p,i!==c?(a.setValue(i),!0):!1}function pn(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function gr(i,a){var c=a.checked;return ue({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function vr(i,a){var c=a.defaultValue==null?"":a.defaultValue,p=a.checked!=null?a.checked:a.defaultChecked;c=$e(a.value!=null?a.value:c),i._wrapperState={initialChecked:p,initialValue:c,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Gi(i,a){a=a.checked,a!=null&&z(i,"checked",a,!1)}function Ti(i,a){Gi(i,a);var c=$e(a.value),p=a.type;if(c!=null)p==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(p==="submit"||p==="reset"){i.removeAttribute("value");return}a.hasOwnProperty("value")?fn(i,a.type,c):a.hasOwnProperty("defaultValue")&&fn(i,a.type,$e(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(i.defaultChecked=!!a.defaultChecked)}function Po(i,a,c){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var p=a.type;if(!(p!=="submit"&&p!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+i._wrapperState.initialValue,c||a===i.value||(i.value=a),i.defaultValue=a}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function fn(i,a,c){(a!=="number"||pn(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var xi=Array.isArray;function Nn(i,a,c,p){if(i=i.options,a){a={};for(var b=0;b<c.length;b++)a["$"+c[b]]=!0;for(c=0;c<i.length;c++)b=a.hasOwnProperty("$"+i[c].value),i[c].selected!==b&&(i[c].selected=b),b&&p&&(i[c].defaultSelected=!0)}else{for(c=""+$e(c),a=null,b=0;b<i.length;b++){if(i[b].value===c){i[b].selected=!0,p&&(i[b].defaultSelected=!0);return}a!==null||i[b].disabled||(a=i[b])}a!==null&&(a.selected=!0)}}function Ei(i,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return ue({},a,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function _o(i,a){var c=a.value;if(c==null){if(c=a.children,a=a.defaultValue,c!=null){if(a!=null)throw Error(t(92));if(xi(c)){if(1<c.length)throw Error(t(93));c=c[0]}a=c}a==null&&(a=""),c=a}i._wrapperState={initialValue:$e(c)}}function _(i,a){var c=$e(a.value),p=$e(a.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),a.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),p!=null&&(i.defaultValue=""+p)}function y(i){var a=i.textContent;a===i._wrapperState.initialValue&&a!==""&&a!==null&&(i.value=a)}function C(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function O(i,a){return i==null||i==="http://www.w3.org/1999/xhtml"?C(a):i==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var W,se=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,c,p,b){MSApp.execUnsafeLocalFunction(function(){return i(a,c,p,b)})}:i}(function(i,a){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=a;else{for(W=W||document.createElement("div"),W.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=W.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;a.firstChild;)i.appendChild(a.firstChild)}});function be(i,a){if(a){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=a;return}}i.textContent=a}var Ge={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},it=["Webkit","ms","Moz","O"];Object.keys(Ge).forEach(function(i){it.forEach(function(a){a=a+i.charAt(0).toUpperCase()+i.substring(1),Ge[a]=Ge[i]})});function Ne(i,a,c){return a==null||typeof a=="boolean"||a===""?"":c||typeof a!="number"||a===0||Ge.hasOwnProperty(i)&&Ge[i]?(""+a).trim():a+"px"}function at(i,a){i=i.style;for(var c in a)if(a.hasOwnProperty(c)){var p=c.indexOf("--")===0,b=Ne(c,a[c],p);c==="float"&&(c="cssFloat"),p?i.setProperty(c,b):i[c]=b}}var Ct=ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qt(i,a){if(a){if(Ct[i]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function St(i,a){if(i.indexOf("-")===-1)return typeof a.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jn=null;function Tn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var mn=null,Yt=null,nn=null;function br(i){if(i=ul(i)){if(typeof mn!="function")throw Error(t(280));var a=i.stateNode;a&&(a=Oc(a),mn(i.stateNode,i.type,a))}}function Je(i){Yt?nn?nn.push(i):nn=[i]:Yt=i}function yr(){if(Yt){var i=Yt,a=nn;if(nn=Yt=null,br(i),a)for(i=0;i<a.length;i++)br(a[i])}}function Dn(i,a){return i(a)}function ut(){}var Un=!1;function ac(i,a,c){if(Un)return i(a,c);Un=!0;try{return Dn(i,a,c)}finally{Un=!1,(Yt!==null||nn!==null)&&(ut(),yr())}}function Nr(i,a){var c=i.stateNode;if(c===null)return null;var p=Oc(c);if(p===null)return null;c=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(t(231,a,typeof c));return c}var Ro=!1;if(d)try{var je={};Object.defineProperty(je,"passive",{get:function(){Ro=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch{Ro=!1}function Ds(i,a,c,p,b,w,P,j,B){var ie=Array.prototype.slice.call(arguments,3);try{a.apply(c,ie)}catch(we){this.onError(we)}}var ar=!1,Ia=null,Oa=!1,Ki=null,oc={onError:function(i){ar=!0,Ia=i}};function sc(i,a,c,p,b,w,P,j,B){ar=!1,Ia=null,Ds.apply(oc,arguments)}function Io(i,a,c,p,b,w,P,j,B){if(sc.apply(this,arguments),ar){if(ar){var ie=Ia;ar=!1,Ia=null}else throw Error(t(198));Oa||(Oa=!0,Ki=ie)}}function ii(i){var a=i,c=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(c=a.return),i=a.return;while(i)}return a.tag===3?c:null}function lc(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function jr(i){if(ii(i)!==i)throw Error(t(188))}function cc(i){var a=i.alternate;if(!a){if(a=ii(i),a===null)throw Error(t(188));return a!==i?null:i}for(var c=i,p=a;;){var b=c.return;if(b===null)break;var w=b.alternate;if(w===null){if(p=b.return,p!==null){c=p;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===c)return jr(b),i;if(w===p)return jr(b),a;w=w.sibling}throw Error(t(188))}if(c.return!==p.return)c=b,p=w;else{for(var P=!1,j=b.child;j;){if(j===c){P=!0,c=b,p=w;break}if(j===p){P=!0,p=b,c=w;break}j=j.sibling}if(!P){for(j=w.child;j;){if(j===c){P=!0,c=w,p=b;break}if(j===p){P=!0,p=w,c=b;break}j=j.sibling}if(!P)throw Error(t(189))}}if(c.alternate!==p)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?i:a}function uc(i){return i=cc(i),i!==null?Oo(i):null}function Oo(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var a=Oo(i);if(a!==null)return a;i=i.sibling}return null}var Us=e.unstable_scheduleCallback,Wn=e.unstable_cancelCallback,Mo=e.unstable_shouldYield,Fs=e.unstable_requestPaint,Ft=e.unstable_now,Ao=e.unstable_getCurrentPriorityLevel,Lo=e.unstable_ImmediatePriority,Bs=e.unstable_UserBlockingPriority,Ma=e.unstable_NormalPriority,Aa=e.unstable_LowPriority,No=e.unstable_IdlePriority,wr=null,xn=null;function jo(i){if(xn&&typeof xn.onCommitFiberRoot=="function")try{xn.onCommitFiberRoot(wr,i,void 0,(i.current.flags&128)===128)}catch{}}var gn=Math.clz32?Math.clz32:Do,Dr=Math.log,dc=Math.LN2;function Do(i){return i>>>=0,i===0?32:31-(Dr(i)/dc|0)|0}var La=64,vn=4194304;function kr(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function rt(i,a){var c=i.pendingLanes;if(c===0)return 0;var p=0,b=i.suspendedLanes,w=i.pingedLanes,P=c&268435455;if(P!==0){var j=P&~b;j!==0?p=kr(j):(w&=P,w!==0&&(p=kr(w)))}else P=c&~b,P!==0?p=kr(P):w!==0&&(p=kr(w));if(p===0)return 0;if(a!==0&&a!==p&&(a&b)===0&&(b=p&-p,w=a&-a,b>=w||b===16&&(w&4194240)!==0))return a;if((p&4)!==0&&(p|=c&16),a=i.entangledLanes,a!==0)for(i=i.entanglements,a&=p;0<a;)c=31-gn(a),b=1<<c,p|=i[c],a&=~b;return p}function or(i,a){switch(i){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cr(i,a){for(var c=i.suspendedLanes,p=i.pingedLanes,b=i.expirationTimes,w=i.pendingLanes;0<w;){var P=31-gn(w),j=1<<P,B=b[P];B===-1?((j&c)===0||(j&p)!==0)&&(b[P]=or(j,a)):B<=a&&(i.expiredLanes|=j),w&=~j}}function Uo(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function zs(){var i=La;return La<<=1,(La&4194240)===0&&(La=64),i}function Fo(i){for(var a=[],c=0;31>c;c++)a.push(i);return a}function Tt(i,a,c){i.pendingLanes|=a,a!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,a=31-gn(a),i[a]=c}function Na(i,a){var c=i.pendingLanes&~a;i.pendingLanes=a,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=a,i.mutableReadLanes&=a,i.entangledLanes&=a,a=i.entanglements;var p=i.eventTimes;for(i=i.expirationTimes;0<c;){var b=31-gn(c),w=1<<b;a[b]=0,p[b]=-1,i[b]=-1,c&=~w}}function ja(i,a){var c=i.entangledLanes|=a;for(i=i.entanglements;c;){var p=31-gn(c),b=1<<p;b&a|i[p]&a&&(i[p]|=a),c&=~b}}var dt=0;function Sr(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Bo,Ur,Vs,Zi,Da,Ua=!1,Fa=[],Fr=null,Br=null,ai=null,Qi=new Map,oi=new Map,sr=[],Xi="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ba(i,a){switch(i){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":ai=null;break;case"pointerover":case"pointerout":Qi.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":oi.delete(a.pointerId)}}function zr(i,a,c,p,b,w){return i===null||i.nativeEvent!==w?(i={blockedOn:a,domEventName:c,eventSystemFlags:p,nativeEvent:w,targetContainers:[b]},a!==null&&(a=ul(a),a!==null&&Ur(a)),i):(i.eventSystemFlags|=p,a=i.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),i)}function za(i,a,c,p,b){switch(a){case"focusin":return Fr=zr(Fr,i,a,c,p,b),!0;case"dragenter":return Br=zr(Br,i,a,c,p,b),!0;case"mouseover":return ai=zr(ai,i,a,c,p,b),!0;case"pointerover":var w=b.pointerId;return Qi.set(w,zr(Qi.get(w)||null,i,a,c,p,b)),!0;case"gotpointercapture":return w=b.pointerId,oi.set(w,zr(oi.get(w)||null,i,a,c,p,b)),!0}return!1}function Pi(i){var a=Ya(i.target);if(a!==null){var c=ii(a);if(c!==null){if(a=c.tag,a===13){if(a=lc(c),a!==null){i.blockedOn=a,Da(i.priority,function(){Vs(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function _i(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var c=Ws(i.domEventName,i.eventSystemFlags,a[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var p=new c.constructor(c.type,c);jn=p,c.target.dispatchEvent(p),jn=null}else return a=ul(c),a!==null&&Ur(a),i.blockedOn=c,!1;a.shift()}return!0}function En(i,a,c){_i(i)&&c.delete(a)}function zo(){Ua=!1,Fr!==null&&_i(Fr)&&(Fr=null),Br!==null&&_i(Br)&&(Br=null),ai!==null&&_i(ai)&&(ai=null),Qi.forEach(En),oi.forEach(En)}function Va(i,a){i.blockedOn===a&&(i.blockedOn=null,Ua||(Ua=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,zo)))}function Pn(i){function a(b){return Va(b,i)}if(0<Fa.length){Va(Fa[0],i);for(var c=1;c<Fa.length;c++){var p=Fa[c];p.blockedOn===i&&(p.blockedOn=null)}}for(Fr!==null&&Va(Fr,i),Br!==null&&Va(Br,i),ai!==null&&Va(ai,i),Qi.forEach(a),oi.forEach(a),c=0;c<sr.length;c++)p=sr[c],p.blockedOn===i&&(p.blockedOn=null);for(;0<sr.length&&(c=sr[0],c.blockedOn===null);)Pi(c),c.blockedOn===null&&sr.shift()}var si=A.ReactCurrentBatchConfig,lr=!0;function Hs(i,a,c,p){var b=dt,w=si.transition;si.transition=null;try{dt=1,$s(i,a,c,p)}finally{dt=b,si.transition=w}}function qs(i,a,c,p){var b=dt,w=si.transition;si.transition=null;try{dt=4,$s(i,a,c,p)}finally{dt=b,si.transition=w}}function $s(i,a,c,p){if(lr){var b=Ws(i,a,c,p);if(b===null)Od(i,a,p,Ri,c),Ba(i,p);else if(za(b,i,a,c,p))p.stopPropagation();else if(Ba(i,p),a&4&&-1<Xi.indexOf(i)){for(;b!==null;){var w=ul(b);if(w!==null&&Bo(w),w=Ws(i,a,c,p),w===null&&Od(i,a,p,Ri,c),w===b)break;b=w}b!==null&&p.stopPropagation()}else Od(i,a,p,null,c)}}var Ri=null;function Ws(i,a,c,p){if(Ri=null,i=Tn(p),i=Ya(i),i!==null)if(a=ii(i),a===null)i=null;else if(c=a.tag,c===13){if(i=lc(a),i!==null)return i;i=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null);return Ri=i,null}function hc(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ao()){case Lo:return 1;case Bs:return 4;case Ma:case Aa:return 16;case No:return 536870912;default:return 16}default:return 16}}var li=null,cr=null,Ha=null;function qa(){if(Ha)return Ha;var i,a=cr,c=a.length,p,b="value"in li?li.value:li.textContent,w=b.length;for(i=0;i<c&&a[i]===b[i];i++);var P=c-i;for(p=1;p<=P&&a[c-p]===b[w-p];p++);return Ha=b.slice(i,1<p?1-p:void 0)}function $a(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Vo(){return!0}function rn(){return!1}function _n(i){function a(c,p,b,w,P){this._reactName=c,this._targetInst=b,this.type=p,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var j in i)i.hasOwnProperty(j)&&(c=i[j],this[j]=c?c(w):w[j]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Vo:rn,this.isPropagationStopped=rn,this}return ue(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Vo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Vo)},persist:function(){},isPersistent:Vo}),a}var Rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ji=_n(Rn),ci=ue({},Rn,{view:0,detail:0}),pc=_n(ci),Wa,Gs,Ii,Ho=ue({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ii&&(Ii&&i.type==="mousemove"?(Wa=i.screenX-Ii.screenX,Gs=i.screenY-Ii.screenY):Gs=Wa=0,Ii=i),Wa)},movementY:function(i){return"movementY"in i?i.movementY:Gs}}),fc=_n(Ho),mc=ue({},Ho,{dataTransfer:0}),kd=_n(mc),Cd=ue({},ci,{relatedTarget:0}),Ks=_n(Cd),Sd=ue({},Rn,{animationName:0,elapsedTime:0,pseudoElement:0}),Td=_n(Sd),xd=ue({},Rn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ed=_n(xd),Zs=ue({},Rn,{data:0}),Ga=_n(Zs),Pd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_d={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qs(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=gc[i])?!!a[i]:!1}function qo(){return Qs}var vc=ue({},ci,{key:function(i){if(i.key){var a=Pd[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=$a(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?_d[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qo,charCode:function(i){return i.type==="keypress"?$a(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?$a(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),bc=_n(vc),Ka=ue({},Ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gn=_n(Ka),$o=ue({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qo}),Za=_n($o),Yi=ue({},Rn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tr=_n(Yi),Wo=ue({},Ho,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zt=_n(Wo),yc=[9,13,27,32],Qt=d&&"CompositionEvent"in window,ui=null;d&&"documentMode"in document&&(ui=document.documentMode);var Rd=d&&"TextEvent"in window&&!ui,Go=d&&(!Qt||ui&&8<ui&&11>=ui),wc=" ",Qa=!1;function ur(i,a){switch(i){case"keyup":return yc.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xs(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var di=!1;function kc(i,a){switch(i){case"compositionend":return Xs(a);case"keypress":return a.which!==32?null:(Qa=!0,wc);case"textInput":return i=a.data,i===wc&&Qa?null:i;default:return null}}function Js(i,a){if(di)return i==="compositionend"||!Qt&&ur(i,a)?(i=qa(),Ha=cr=li=null,di=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Go&&a.locale!=="ko"?null:a.data;default:return null}}var Ys={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ea(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!Ys[i.type]:a==="textarea"}function Cc(i,a,c,p){Je(p),a=_c(a,"onChange"),0<a.length&&(c=new Ji("onChange","change",null,c,p),i.push({event:c,listeners:a}))}var hi=null,ta=null;function Sc(i){Jf(i,0)}function Oi(i){var a=Jo(i);if($n(a))return i}function Tc(i,a){if(i==="change")return a}var el=!1;if(d){var tl;if(d){var Ko="oninput"in document;if(!Ko){var nl=document.createElement("div");nl.setAttribute("oninput","return;"),Ko=typeof nl.oninput=="function"}tl=Ko}else tl=!1;el=tl&&(!document.documentMode||9<document.documentMode)}function Xa(){hi&&(hi.detachEvent("onpropertychange",he),ta=hi=null)}function he(i){if(i.propertyName==="value"&&Oi(ta)){var a=[];Cc(a,ta,i,Tn(i)),ac(Sc,a)}}function rl(i,a,c){i==="focusin"?(Xa(),hi=a,ta=c,hi.attachEvent("onpropertychange",he)):i==="focusout"&&Xa()}function xc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Oi(ta)}function Vr(i,a){if(i==="click")return Oi(a)}function Zo(i,a){if(i==="input"||i==="change")return Oi(a)}function Ec(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Kn=typeof Object.is=="function"?Object.is:Ec;function na(i,a){if(Kn(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var c=Object.keys(i),p=Object.keys(a);if(c.length!==p.length)return!1;for(p=0;p<c.length;p++){var b=c[p];if(!f.call(a,b)||!Kn(i[b],a[b]))return!1}return!0}function il(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function al(i,a){var c=il(i);i=0;for(var p;c;){if(c.nodeType===3){if(p=i+c.textContent.length,i<=a&&p>=a)return{node:c,offset:a-i};i=p}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=il(c)}}function Ja(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?Ja(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function ol(){for(var i=window,a=pn();a instanceof i.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)i=a.contentWindow;else break;a=pn(i.document)}return a}function u(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}function h(i){var a=ol(),c=i.focusedElem,p=i.selectionRange;if(a!==c&&c&&c.ownerDocument&&Ja(c.ownerDocument.documentElement,c)){if(p!==null&&u(c)){if(a=p.start,i=p.end,i===void 0&&(i=a),"selectionStart"in c)c.selectionStart=a,c.selectionEnd=Math.min(i,c.value.length);else if(i=(a=c.ownerDocument||document)&&a.defaultView||window,i.getSelection){i=i.getSelection();var b=c.textContent.length,w=Math.min(p.start,b);p=p.end===void 0?w:Math.min(p.end,b),!i.extend&&w>p&&(b=p,p=w,w=b),b=al(c,w);var P=al(c,p);b&&P&&(i.rangeCount!==1||i.anchorNode!==b.node||i.anchorOffset!==b.offset||i.focusNode!==P.node||i.focusOffset!==P.offset)&&(a=a.createRange(),a.setStart(b.node,b.offset),i.removeAllRanges(),w>p?(i.addRange(a),i.extend(P.node,P.offset)):(a.setEnd(P.node,P.offset),i.addRange(a)))}}for(a=[],i=c;i=i.parentNode;)i.nodeType===1&&a.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<a.length;c++)i=a[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var g=d&&"documentMode"in document&&11>=document.documentMode,k=null,E=null,I=null,D=!1;function q(i,a,c){var p=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;D||k==null||k!==pn(p)||(p=k,"selectionStart"in p&&u(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),I&&na(I,p)||(I=p,p=_c(E,"onSelect"),0<p.length&&(a=new Ji("onSelect","select",null,a,c),i.push({event:a,listeners:p}),a.target=k)))}function re(i,a){var c={};return c[i.toLowerCase()]=a.toLowerCase(),c["Webkit"+i]="webkit"+a,c["Moz"+i]="moz"+a,c}var G={animationend:re("Animation","AnimationEnd"),animationiteration:re("Animation","AnimationIteration"),animationstart:re("Animation","AnimationStart"),transitionend:re("Transition","TransitionEnd")},Ce={},Ie={};d&&(Ie=document.createElement("div").style,"AnimationEvent"in window||(delete G.animationend.animation,delete G.animationiteration.animation,delete G.animationstart.animation),"TransitionEvent"in window||delete G.transitionend.transition);function Ue(i){if(Ce[i])return Ce[i];if(!G[i])return i;var a=G[i],c;for(c in a)if(a.hasOwnProperty(c)&&c in Ie)return Ce[i]=a[c];return i}var Q=Ue("animationend"),fe=Ue("animationiteration"),Pe=Ue("animationstart"),He=Ue("transitionend"),Ze=new Map,tt="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ft(i,a){Ze.set(i,a),s(a,[i])}for(var _t=0;_t<tt.length;_t++){var Mt=tt[_t],xt=Mt.toLowerCase(),Hr=Mt[0].toUpperCase()+Mt.slice(1);ft(xt,"on"+Hr)}ft(Q,"onAnimationEnd"),ft(fe,"onAnimationIteration"),ft(Pe,"onAnimationStart"),ft("dblclick","onDoubleClick"),ft("focusin","onFocus"),ft("focusout","onBlur"),ft(He,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mi));function Xf(i,a,c){var p=i.type||"unknown-event";i.currentTarget=c,Io(p,a,void 0,i),i.currentTarget=null}function Jf(i,a){a=(a&4)!==0;for(var c=0;c<i.length;c++){var p=i[c],b=p.event;p=p.listeners;e:{var w=void 0;if(a)for(var P=p.length-1;0<=P;P--){var j=p[P],B=j.instance,ie=j.currentTarget;if(j=j.listener,B!==w&&b.isPropagationStopped())break e;Xf(b,j,ie),w=B}else for(P=0;P<p.length;P++){if(j=p[P],B=j.instance,ie=j.currentTarget,j=j.listener,B!==w&&b.isPropagationStopped())break e;Xf(b,j,ie),w=B}}}if(Oa)throw i=Ki,Oa=!1,Ki=null,i}function At(i,a){var c=a[Dd];c===void 0&&(c=a[Dd]=new Set);var p=i+"__bubble";c.has(p)||(Yf(a,i,2,!1),c.add(p))}function Id(i,a,c){var p=0;a&&(p|=4),Yf(c,i,p,a)}var Pc="_reactListening"+Math.random().toString(36).slice(2);function sl(i){if(!i[Pc]){i[Pc]=!0,r.forEach(function(c){c!=="selectionchange"&&(tw.has(c)||Id(c,!1,i),Id(c,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[Pc]||(a[Pc]=!0,Id("selectionchange",!1,a))}}function Yf(i,a,c,p){switch(hc(a)){case 1:var b=Hs;break;case 4:b=qs;break;default:b=$s}c=b.bind(null,a,c,i),b=void 0,!Ro||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),p?b!==void 0?i.addEventListener(a,c,{capture:!0,passive:b}):i.addEventListener(a,c,!0):b!==void 0?i.addEventListener(a,c,{passive:b}):i.addEventListener(a,c,!1)}function Od(i,a,c,p,b){var w=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var P=p.tag;if(P===3||P===4){var j=p.stateNode.containerInfo;if(j===b||j.nodeType===8&&j.parentNode===b)break;if(P===4)for(P=p.return;P!==null;){var B=P.tag;if((B===3||B===4)&&(B=P.stateNode.containerInfo,B===b||B.nodeType===8&&B.parentNode===b))return;P=P.return}for(;j!==null;){if(P=Ya(j),P===null)return;if(B=P.tag,B===5||B===6){p=w=P;continue e}j=j.parentNode}}p=p.return}ac(function(){var ie=w,we=Tn(c),ke=[];e:{var ye=Ze.get(i);if(ye!==void 0){var De=Ji,Be=i;switch(i){case"keypress":if($a(c)===0)break e;case"keydown":case"keyup":De=bc;break;case"focusin":Be="focus",De=Ks;break;case"focusout":Be="blur",De=Ks;break;case"beforeblur":case"afterblur":De=Ks;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=fc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=kd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=Za;break;case Q:case fe:case Pe:De=Td;break;case He:De=Tr;break;case"scroll":De=pc;break;case"wheel":De=Zt;break;case"copy":case"cut":case"paste":De=Ed;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=Gn}var Ve=(a&4)!==0,Xt=!Ve&&i==="scroll",Z=Ve?ye!==null?ye+"Capture":null:ye;Ve=[];for(var H=ie,X;H!==null;){X=H;var xe=X.stateNode;if(X.tag===5&&xe!==null&&(X=xe,Z!==null&&(xe=Nr(H,Z),xe!=null&&Ve.push(ll(H,xe,X)))),Xt)break;H=H.return}0<Ve.length&&(ye=new De(ye,Be,null,c,we),ke.push({event:ye,listeners:Ve}))}}if((a&7)===0){e:{if(ye=i==="mouseover"||i==="pointerover",De=i==="mouseout"||i==="pointerout",ye&&c!==jn&&(Be=c.relatedTarget||c.fromElement)&&(Ya(Be)||Be[Ai]))break e;if((De||ye)&&(ye=we.window===we?we:(ye=we.ownerDocument)?ye.defaultView||ye.parentWindow:window,De?(Be=c.relatedTarget||c.toElement,De=ie,Be=Be?Ya(Be):null,Be!==null&&(Xt=ii(Be),Be!==Xt||Be.tag!==5&&Be.tag!==6)&&(Be=null)):(De=null,Be=ie),De!==Be)){if(Ve=fc,xe="onMouseLeave",Z="onMouseEnter",H="mouse",(i==="pointerout"||i==="pointerover")&&(Ve=Gn,xe="onPointerLeave",Z="onPointerEnter",H="pointer"),Xt=De==null?ye:Jo(De),X=Be==null?ye:Jo(Be),ye=new Ve(xe,H+"leave",De,c,we),ye.target=Xt,ye.relatedTarget=X,xe=null,Ya(we)===ie&&(Ve=new Ve(Z,H+"enter",Be,c,we),Ve.target=X,Ve.relatedTarget=Xt,xe=Ve),Xt=xe,De&&Be)t:{for(Ve=De,Z=Be,H=0,X=Ve;X;X=Qo(X))H++;for(X=0,xe=Z;xe;xe=Qo(xe))X++;for(;0<H-X;)Ve=Qo(Ve),H--;for(;0<X-H;)Z=Qo(Z),X--;for(;H--;){if(Ve===Z||Z!==null&&Ve===Z.alternate)break t;Ve=Qo(Ve),Z=Qo(Z)}Ve=null}else Ve=null;De!==null&&em(ke,ye,De,Ve,!1),Be!==null&&Xt!==null&&em(ke,Xt,Be,Ve,!0)}}e:{if(ye=ie?Jo(ie):window,De=ye.nodeName&&ye.nodeName.toLowerCase(),De==="select"||De==="input"&&ye.type==="file")var qe=Tc;else if(ea(ye))if(el)qe=Zo;else{qe=xc;var Qe=rl}else(De=ye.nodeName)&&De.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&(qe=Vr);if(qe&&(qe=qe(i,ie))){Cc(ke,qe,c,we);break e}Qe&&Qe(i,ye,ie),i==="focusout"&&(Qe=ye._wrapperState)&&Qe.controlled&&ye.type==="number"&&fn(ye,"number",ye.value)}switch(Qe=ie?Jo(ie):window,i){case"focusin":(ea(Qe)||Qe.contentEditable==="true")&&(k=Qe,E=ie,I=null);break;case"focusout":I=E=k=null;break;case"mousedown":D=!0;break;case"contextmenu":case"mouseup":case"dragend":D=!1,q(ke,c,we);break;case"selectionchange":if(g)break;case"keydown":case"keyup":q(ke,c,we)}var Xe;if(Qt)e:{switch(i){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else di?ur(i,c)&&(nt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(nt="onCompositionStart");nt&&(Go&&c.locale!=="ko"&&(di||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&di&&(Xe=qa()):(li=we,cr="value"in li?li.value:li.textContent,di=!0)),Qe=_c(ie,nt),0<Qe.length&&(nt=new Ga(nt,i,null,c,we),ke.push({event:nt,listeners:Qe}),Xe?nt.data=Xe:(Xe=Xs(c),Xe!==null&&(nt.data=Xe)))),(Xe=Rd?kc(i,c):Js(i,c))&&(ie=_c(ie,"onBeforeInput"),0<ie.length&&(we=new Ga("onBeforeInput","beforeinput",null,c,we),ke.push({event:we,listeners:ie}),we.data=Xe))}Jf(ke,a)})}function ll(i,a,c){return{instance:i,listener:a,currentTarget:c}}function _c(i,a){for(var c=a+"Capture",p=[];i!==null;){var b=i,w=b.stateNode;b.tag===5&&w!==null&&(b=w,w=Nr(i,c),w!=null&&p.unshift(ll(i,w,b)),w=Nr(i,a),w!=null&&p.push(ll(i,w,b))),i=i.return}return p}function Qo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function em(i,a,c,p,b){for(var w=a._reactName,P=[];c!==null&&c!==p;){var j=c,B=j.alternate,ie=j.stateNode;if(B!==null&&B===p)break;j.tag===5&&ie!==null&&(j=ie,b?(B=Nr(c,w),B!=null&&P.unshift(ll(c,B,j))):b||(B=Nr(c,w),B!=null&&P.push(ll(c,B,j)))),c=c.return}P.length!==0&&i.push({event:a,listeners:P})}var nw=/\r\n?/g,rw=/\u0000|\uFFFD/g;function tm(i){return(typeof i=="string"?i:""+i).replace(nw,`
`).replace(rw,"")}function Rc(i,a,c){if(a=tm(a),tm(i)!==a&&c)throw Error(t(425))}function Ic(){}var Md=null,Ad=null;function Ld(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Nd=typeof setTimeout=="function"?setTimeout:void 0,iw=typeof clearTimeout=="function"?clearTimeout:void 0,nm=typeof Promise=="function"?Promise:void 0,aw=typeof queueMicrotask=="function"?queueMicrotask:typeof nm<"u"?function(i){return nm.resolve(null).then(i).catch(ow)}:Nd;function ow(i){setTimeout(function(){throw i})}function jd(i,a){var c=a,p=0;do{var b=c.nextSibling;if(i.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(p===0){i.removeChild(b),Pn(a);return}p--}else c!=="$"&&c!=="$?"&&c!=="$!"||p++;c=b}while(c);Pn(a)}function ra(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return i}function rm(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return i;a--}else c==="/$"&&a++}i=i.previousSibling}return null}var Xo=Math.random().toString(36).slice(2),pi="__reactFiber$"+Xo,cl="__reactProps$"+Xo,Ai="__reactContainer$"+Xo,Dd="__reactEvents$"+Xo,sw="__reactListeners$"+Xo,lw="__reactHandles$"+Xo;function Ya(i){var a=i[pi];if(a)return a;for(var c=i.parentNode;c;){if(a=c[Ai]||c[pi]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(i=rm(i);i!==null;){if(c=i[pi])return c;i=rm(i)}return a}i=c,c=i.parentNode}return null}function ul(i){return i=i[pi]||i[Ai],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Jo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Oc(i){return i[cl]||null}var Ud=[],Yo=-1;function ia(i){return{current:i}}function Lt(i){0>Yo||(i.current=Ud[Yo],Ud[Yo]=null,Yo--)}function It(i,a){Yo++,Ud[Yo]=i.current,i.current=a}var aa={},In=ia(aa),Zn=ia(!1),eo=aa;function es(i,a){var c=i.type.contextTypes;if(!c)return aa;var p=i.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===a)return p.__reactInternalMemoizedMaskedChildContext;var b={},w;for(w in c)b[w]=a[w];return p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=a,i.__reactInternalMemoizedMaskedChildContext=b),b}function Qn(i){return i=i.childContextTypes,i!=null}function Mc(){Lt(Zn),Lt(In)}function im(i,a,c){if(In.current!==aa)throw Error(t(168));It(In,a),It(Zn,c)}function am(i,a,c){var p=i.stateNode;if(a=a.childContextTypes,typeof p.getChildContext!="function")return c;p=p.getChildContext();for(var b in p)if(!(b in a))throw Error(t(108,et(i)||"Unknown",b));return ue({},c,p)}function Ac(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||aa,eo=In.current,It(In,i),It(Zn,Zn.current),!0}function om(i,a,c){var p=i.stateNode;if(!p)throw Error(t(169));c?(i=am(i,a,eo),p.__reactInternalMemoizedMergedChildContext=i,Lt(Zn),Lt(In),It(In,i)):Lt(Zn),It(Zn,c)}var Li=null,Lc=!1,Fd=!1;function sm(i){Li===null?Li=[i]:Li.push(i)}function cw(i){Lc=!0,sm(i)}function oa(){if(!Fd&&Li!==null){Fd=!0;var i=0,a=dt;try{var c=Li;for(dt=1;i<c.length;i++){var p=c[i];do p=p(!0);while(p!==null)}Li=null,Lc=!1}catch(b){throw Li!==null&&(Li=Li.slice(i+1)),Us(Lo,oa),b}finally{dt=a,Fd=!1}}return null}var ts=[],ns=0,Nc=null,jc=0,xr=[],Er=0,to=null,Ni=1,ji="";function no(i,a){ts[ns++]=jc,ts[ns++]=Nc,Nc=i,jc=a}function lm(i,a,c){xr[Er++]=Ni,xr[Er++]=ji,xr[Er++]=to,to=i;var p=Ni;i=ji;var b=32-gn(p)-1;p&=~(1<<b),c+=1;var w=32-gn(a)+b;if(30<w){var P=b-b%5;w=(p&(1<<P)-1).toString(32),p>>=P,b-=P,Ni=1<<32-gn(a)+b|c<<b|p,ji=w+i}else Ni=1<<w|c<<b|p,ji=i}function Bd(i){i.return!==null&&(no(i,1),lm(i,1,0))}function zd(i){for(;i===Nc;)Nc=ts[--ns],ts[ns]=null,jc=ts[--ns],ts[ns]=null;for(;i===to;)to=xr[--Er],xr[Er]=null,ji=xr[--Er],xr[Er]=null,Ni=xr[--Er],xr[Er]=null}var dr=null,hr=null,Nt=!1,qr=null;function cm(i,a){var c=Ir(5,null,null,0);c.elementType="DELETED",c.stateNode=a,c.return=i,a=i.deletions,a===null?(i.deletions=[c],i.flags|=16):a.push(c)}function um(i,a){switch(i.tag){case 5:var c=i.type;return a=a.nodeType!==1||c.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(i.stateNode=a,dr=i,hr=ra(a.firstChild),!0):!1;case 6:return a=i.pendingProps===""||a.nodeType!==3?null:a,a!==null?(i.stateNode=a,dr=i,hr=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(c=to!==null?{id:Ni,overflow:ji}:null,i.memoizedState={dehydrated:a,treeContext:c,retryLane:1073741824},c=Ir(18,null,null,0),c.stateNode=a,c.return=i,i.child=c,dr=i,hr=null,!0):!1;default:return!1}}function Vd(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Hd(i){if(Nt){var a=hr;if(a){var c=a;if(!um(i,a)){if(Vd(i))throw Error(t(418));a=ra(c.nextSibling);var p=dr;a&&um(i,a)?cm(p,c):(i.flags=i.flags&-4097|2,Nt=!1,dr=i)}}else{if(Vd(i))throw Error(t(418));i.flags=i.flags&-4097|2,Nt=!1,dr=i}}}function dm(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;dr=i}function Dc(i){if(i!==dr)return!1;if(!Nt)return dm(i),Nt=!0,!1;var a;if((a=i.tag!==3)&&!(a=i.tag!==5)&&(a=i.type,a=a!=="head"&&a!=="body"&&!Ld(i.type,i.memoizedProps)),a&&(a=hr)){if(Vd(i))throw hm(),Error(t(418));for(;a;)cm(i,a),a=ra(a.nextSibling)}if(dm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(a===0){hr=ra(i.nextSibling);break e}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++}i=i.nextSibling}hr=null}}else hr=dr?ra(i.stateNode.nextSibling):null;return!0}function hm(){for(var i=hr;i;)i=ra(i.nextSibling)}function rs(){hr=dr=null,Nt=!1}function qd(i){qr===null?qr=[i]:qr.push(i)}var uw=A.ReactCurrentBatchConfig;function dl(i,a,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var p=c.stateNode}if(!p)throw Error(t(147,i));var b=p,w=""+i;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===w?a.ref:(a=function(P){var j=b.refs;P===null?delete j[w]:j[w]=P},a._stringRef=w,a)}if(typeof i!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,i))}return i}function Uc(i,a){throw i=Object.prototype.toString.call(a),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i))}function pm(i){var a=i._init;return a(i._payload)}function fm(i){function a(Z,H){if(i){var X=Z.deletions;X===null?(Z.deletions=[H],Z.flags|=16):X.push(H)}}function c(Z,H){if(!i)return null;for(;H!==null;)a(Z,H),H=H.sibling;return null}function p(Z,H){for(Z=new Map;H!==null;)H.key!==null?Z.set(H.key,H):Z.set(H.index,H),H=H.sibling;return Z}function b(Z,H){return Z=fa(Z,H),Z.index=0,Z.sibling=null,Z}function w(Z,H,X){return Z.index=X,i?(X=Z.alternate,X!==null?(X=X.index,X<H?(Z.flags|=2,H):X):(Z.flags|=2,H)):(Z.flags|=1048576,H)}function P(Z){return i&&Z.alternate===null&&(Z.flags|=2),Z}function j(Z,H,X,xe){return H===null||H.tag!==6?(H=Lh(X,Z.mode,xe),H.return=Z,H):(H=b(H,X),H.return=Z,H)}function B(Z,H,X,xe){var qe=X.type;return qe===de?we(Z,H,X.props.children,xe,X.key):H!==null&&(H.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Oe&&pm(qe)===H.type)?(xe=b(H,X.props),xe.ref=dl(Z,H,X),xe.return=Z,xe):(xe=lu(X.type,X.key,X.props,null,Z.mode,xe),xe.ref=dl(Z,H,X),xe.return=Z,xe)}function ie(Z,H,X,xe){return H===null||H.tag!==4||H.stateNode.containerInfo!==X.containerInfo||H.stateNode.implementation!==X.implementation?(H=Nh(X,Z.mode,xe),H.return=Z,H):(H=b(H,X.children||[]),H.return=Z,H)}function we(Z,H,X,xe,qe){return H===null||H.tag!==7?(H=uo(X,Z.mode,xe,qe),H.return=Z,H):(H=b(H,X),H.return=Z,H)}function ke(Z,H,X){if(typeof H=="string"&&H!==""||typeof H=="number")return H=Lh(""+H,Z.mode,X),H.return=Z,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case F:return X=lu(H.type,H.key,H.props,null,Z.mode,X),X.ref=dl(Z,null,H),X.return=Z,X;case J:return H=Nh(H,Z.mode,X),H.return=Z,H;case Oe:var xe=H._init;return ke(Z,xe(H._payload),X)}if(xi(H)||Re(H))return H=uo(H,Z.mode,X,null),H.return=Z,H;Uc(Z,H)}return null}function ye(Z,H,X,xe){var qe=H!==null?H.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return qe!==null?null:j(Z,H,""+X,xe);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case F:return X.key===qe?B(Z,H,X,xe):null;case J:return X.key===qe?ie(Z,H,X,xe):null;case Oe:return qe=X._init,ye(Z,H,qe(X._payload),xe)}if(xi(X)||Re(X))return qe!==null?null:we(Z,H,X,xe,null);Uc(Z,X)}return null}function De(Z,H,X,xe,qe){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return Z=Z.get(X)||null,j(H,Z,""+xe,qe);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case F:return Z=Z.get(xe.key===null?X:xe.key)||null,B(H,Z,xe,qe);case J:return Z=Z.get(xe.key===null?X:xe.key)||null,ie(H,Z,xe,qe);case Oe:var Qe=xe._init;return De(Z,H,X,Qe(xe._payload),qe)}if(xi(xe)||Re(xe))return Z=Z.get(X)||null,we(H,Z,xe,qe,null);Uc(H,xe)}return null}function Be(Z,H,X,xe){for(var qe=null,Qe=null,Xe=H,nt=H=0,dn=null;Xe!==null&&nt<X.length;nt++){Xe.index>nt?(dn=Xe,Xe=null):dn=Xe.sibling;var vt=ye(Z,Xe,X[nt],xe);if(vt===null){Xe===null&&(Xe=dn);break}i&&Xe&&vt.alternate===null&&a(Z,Xe),H=w(vt,H,nt),Qe===null?qe=vt:Qe.sibling=vt,Qe=vt,Xe=dn}if(nt===X.length)return c(Z,Xe),Nt&&no(Z,nt),qe;if(Xe===null){for(;nt<X.length;nt++)Xe=ke(Z,X[nt],xe),Xe!==null&&(H=w(Xe,H,nt),Qe===null?qe=Xe:Qe.sibling=Xe,Qe=Xe);return Nt&&no(Z,nt),qe}for(Xe=p(Z,Xe);nt<X.length;nt++)dn=De(Xe,Z,nt,X[nt],xe),dn!==null&&(i&&dn.alternate!==null&&Xe.delete(dn.key===null?nt:dn.key),H=w(dn,H,nt),Qe===null?qe=dn:Qe.sibling=dn,Qe=dn);return i&&Xe.forEach(function(ma){return a(Z,ma)}),Nt&&no(Z,nt),qe}function Ve(Z,H,X,xe){var qe=Re(X);if(typeof qe!="function")throw Error(t(150));if(X=qe.call(X),X==null)throw Error(t(151));for(var Qe=qe=null,Xe=H,nt=H=0,dn=null,vt=X.next();Xe!==null&&!vt.done;nt++,vt=X.next()){Xe.index>nt?(dn=Xe,Xe=null):dn=Xe.sibling;var ma=ye(Z,Xe,vt.value,xe);if(ma===null){Xe===null&&(Xe=dn);break}i&&Xe&&ma.alternate===null&&a(Z,Xe),H=w(ma,H,nt),Qe===null?qe=ma:Qe.sibling=ma,Qe=ma,Xe=dn}if(vt.done)return c(Z,Xe),Nt&&no(Z,nt),qe;if(Xe===null){for(;!vt.done;nt++,vt=X.next())vt=ke(Z,vt.value,xe),vt!==null&&(H=w(vt,H,nt),Qe===null?qe=vt:Qe.sibling=vt,Qe=vt);return Nt&&no(Z,nt),qe}for(Xe=p(Z,Xe);!vt.done;nt++,vt=X.next())vt=De(Xe,Z,nt,vt.value,xe),vt!==null&&(i&&vt.alternate!==null&&Xe.delete(vt.key===null?nt:vt.key),H=w(vt,H,nt),Qe===null?qe=vt:Qe.sibling=vt,Qe=vt);return i&&Xe.forEach(function(Hw){return a(Z,Hw)}),Nt&&no(Z,nt),qe}function Xt(Z,H,X,xe){if(typeof X=="object"&&X!==null&&X.type===de&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case F:e:{for(var qe=X.key,Qe=H;Qe!==null;){if(Qe.key===qe){if(qe=X.type,qe===de){if(Qe.tag===7){c(Z,Qe.sibling),H=b(Qe,X.props.children),H.return=Z,Z=H;break e}}else if(Qe.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Oe&&pm(qe)===Qe.type){c(Z,Qe.sibling),H=b(Qe,X.props),H.ref=dl(Z,Qe,X),H.return=Z,Z=H;break e}c(Z,Qe);break}else a(Z,Qe);Qe=Qe.sibling}X.type===de?(H=uo(X.props.children,Z.mode,xe,X.key),H.return=Z,Z=H):(xe=lu(X.type,X.key,X.props,null,Z.mode,xe),xe.ref=dl(Z,H,X),xe.return=Z,Z=xe)}return P(Z);case J:e:{for(Qe=X.key;H!==null;){if(H.key===Qe)if(H.tag===4&&H.stateNode.containerInfo===X.containerInfo&&H.stateNode.implementation===X.implementation){c(Z,H.sibling),H=b(H,X.children||[]),H.return=Z,Z=H;break e}else{c(Z,H);break}else a(Z,H);H=H.sibling}H=Nh(X,Z.mode,xe),H.return=Z,Z=H}return P(Z);case Oe:return Qe=X._init,Xt(Z,H,Qe(X._payload),xe)}if(xi(X))return Be(Z,H,X,xe);if(Re(X))return Ve(Z,H,X,xe);Uc(Z,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,H!==null&&H.tag===6?(c(Z,H.sibling),H=b(H,X),H.return=Z,Z=H):(c(Z,H),H=Lh(X,Z.mode,xe),H.return=Z,Z=H),P(Z)):c(Z,H)}return Xt}var is=fm(!0),mm=fm(!1),Fc=ia(null),Bc=null,as=null,$d=null;function Wd(){$d=as=Bc=null}function Gd(i){var a=Fc.current;Lt(Fc),i._currentValue=a}function Kd(i,a,c){for(;i!==null;){var p=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),i===c)break;i=i.return}}function os(i,a){Bc=i,$d=as=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&a)!==0&&(Xn=!0),i.firstContext=null)}function Pr(i){var a=i._currentValue;if($d!==i)if(i={context:i,memoizedValue:a,next:null},as===null){if(Bc===null)throw Error(t(308));as=i,Bc.dependencies={lanes:0,firstContext:i}}else as=as.next=i;return a}var ro=null;function Zd(i){ro===null?ro=[i]:ro.push(i)}function gm(i,a,c,p){var b=a.interleaved;return b===null?(c.next=c,Zd(a)):(c.next=b.next,b.next=c),a.interleaved=c,Di(i,p)}function Di(i,a){i.lanes|=a;var c=i.alternate;for(c!==null&&(c.lanes|=a),c=i,i=i.return;i!==null;)i.childLanes|=a,c=i.alternate,c!==null&&(c.childLanes|=a),c=i,i=i.return;return c.tag===3?c.stateNode:null}var sa=!1;function Qd(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vm(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ui(i,a){return{eventTime:i,lane:a,tag:0,payload:null,callback:null,next:null}}function la(i,a,c){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(mt&2)!==0){var b=p.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),p.pending=a,Di(i,c)}return b=p.interleaved,b===null?(a.next=a,Zd(p)):(a.next=b.next,b.next=a),p.interleaved=a,Di(i,c)}function zc(i,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194240)!==0)){var p=a.lanes;p&=i.pendingLanes,c|=p,a.lanes=c,ja(i,c)}}function bm(i,a){var c=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,c===p)){var b=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var P={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};w===null?b=w=P:w=w.next=P,c=c.next}while(c!==null);w===null?b=w=a:w=w.next=a}else b=w=a;c={baseState:p.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:p.shared,effects:p.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=a:i.next=a,c.lastBaseUpdate=a}function Vc(i,a,c,p){var b=i.updateQueue;sa=!1;var w=b.firstBaseUpdate,P=b.lastBaseUpdate,j=b.shared.pending;if(j!==null){b.shared.pending=null;var B=j,ie=B.next;B.next=null,P===null?w=ie:P.next=ie,P=B;var we=i.alternate;we!==null&&(we=we.updateQueue,j=we.lastBaseUpdate,j!==P&&(j===null?we.firstBaseUpdate=ie:j.next=ie,we.lastBaseUpdate=B))}if(w!==null){var ke=b.baseState;P=0,we=ie=B=null,j=w;do{var ye=j.lane,De=j.eventTime;if((p&ye)===ye){we!==null&&(we=we.next={eventTime:De,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var Be=i,Ve=j;switch(ye=a,De=c,Ve.tag){case 1:if(Be=Ve.payload,typeof Be=="function"){ke=Be.call(De,ke,ye);break e}ke=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Ve.payload,ye=typeof Be=="function"?Be.call(De,ke,ye):Be,ye==null)break e;ke=ue({},ke,ye);break e;case 2:sa=!0}}j.callback!==null&&j.lane!==0&&(i.flags|=64,ye=b.effects,ye===null?b.effects=[j]:ye.push(j))}else De={eventTime:De,lane:ye,tag:j.tag,payload:j.payload,callback:j.callback,next:null},we===null?(ie=we=De,B=ke):we=we.next=De,P|=ye;if(j=j.next,j===null){if(j=b.shared.pending,j===null)break;ye=j,j=ye.next,ye.next=null,b.lastBaseUpdate=ye,b.shared.pending=null}}while(!0);if(we===null&&(B=ke),b.baseState=B,b.firstBaseUpdate=ie,b.lastBaseUpdate=we,a=b.shared.interleaved,a!==null){b=a;do P|=b.lane,b=b.next;while(b!==a)}else w===null&&(b.shared.lanes=0);oo|=P,i.lanes=P,i.memoizedState=ke}}function ym(i,a,c){if(i=a.effects,a.effects=null,i!==null)for(a=0;a<i.length;a++){var p=i[a],b=p.callback;if(b!==null){if(p.callback=null,p=c,typeof b!="function")throw Error(t(191,b));b.call(p)}}}var hl={},fi=ia(hl),pl=ia(hl),fl=ia(hl);function io(i){if(i===hl)throw Error(t(174));return i}function Xd(i,a){switch(It(fl,a),It(pl,i),It(fi,hl),i=a.nodeType,i){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:O(null,"");break;default:i=i===8?a.parentNode:a,a=i.namespaceURI||null,i=i.tagName,a=O(a,i)}Lt(fi),It(fi,a)}function ss(){Lt(fi),Lt(pl),Lt(fl)}function wm(i){io(fl.current);var a=io(fi.current),c=O(a,i.type);a!==c&&(It(pl,i),It(fi,c))}function Jd(i){pl.current===i&&(Lt(fi),Lt(pl))}var Bt=ia(0);function Hc(i){for(var a=i;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Yd=[];function eh(){for(var i=0;i<Yd.length;i++)Yd[i]._workInProgressVersionPrimary=null;Yd.length=0}var qc=A.ReactCurrentDispatcher,th=A.ReactCurrentBatchConfig,ao=0,zt=null,an=null,cn=null,$c=!1,ml=!1,gl=0,dw=0;function On(){throw Error(t(321))}function nh(i,a){if(a===null)return!1;for(var c=0;c<a.length&&c<i.length;c++)if(!Kn(i[c],a[c]))return!1;return!0}function rh(i,a,c,p,b,w){if(ao=w,zt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,qc.current=i===null||i.memoizedState===null?mw:gw,i=c(p,b),ml){w=0;do{if(ml=!1,gl=0,25<=w)throw Error(t(301));w+=1,cn=an=null,a.updateQueue=null,qc.current=vw,i=c(p,b)}while(ml)}if(qc.current=Kc,a=an!==null&&an.next!==null,ao=0,cn=an=zt=null,$c=!1,a)throw Error(t(300));return i}function ih(){var i=gl!==0;return gl=0,i}function mi(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?zt.memoizedState=cn=i:cn=cn.next=i,cn}function _r(){if(an===null){var i=zt.alternate;i=i!==null?i.memoizedState:null}else i=an.next;var a=cn===null?zt.memoizedState:cn.next;if(a!==null)cn=a,an=i;else{if(i===null)throw Error(t(310));an=i,i={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},cn===null?zt.memoizedState=cn=i:cn=cn.next=i}return cn}function vl(i,a){return typeof a=="function"?a(i):a}function ah(i){var a=_r(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var p=an,b=p.baseQueue,w=c.pending;if(w!==null){if(b!==null){var P=b.next;b.next=w.next,w.next=P}p.baseQueue=b=w,c.pending=null}if(b!==null){w=b.next,p=p.baseState;var j=P=null,B=null,ie=w;do{var we=ie.lane;if((ao&we)===we)B!==null&&(B=B.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),p=ie.hasEagerState?ie.eagerState:i(p,ie.action);else{var ke={lane:we,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};B===null?(j=B=ke,P=p):B=B.next=ke,zt.lanes|=we,oo|=we}ie=ie.next}while(ie!==null&&ie!==w);B===null?P=p:B.next=j,Kn(p,a.memoizedState)||(Xn=!0),a.memoizedState=p,a.baseState=P,a.baseQueue=B,c.lastRenderedState=p}if(i=c.interleaved,i!==null){b=i;do w=b.lane,zt.lanes|=w,oo|=w,b=b.next;while(b!==i)}else b===null&&(c.lanes=0);return[a.memoizedState,c.dispatch]}function oh(i){var a=_r(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var p=c.dispatch,b=c.pending,w=a.memoizedState;if(b!==null){c.pending=null;var P=b=b.next;do w=i(w,P.action),P=P.next;while(P!==b);Kn(w,a.memoizedState)||(Xn=!0),a.memoizedState=w,a.baseQueue===null&&(a.baseState=w),c.lastRenderedState=w}return[w,p]}function km(){}function Cm(i,a){var c=zt,p=_r(),b=a(),w=!Kn(p.memoizedState,b);if(w&&(p.memoizedState=b,Xn=!0),p=p.queue,sh(xm.bind(null,c,p,i),[i]),p.getSnapshot!==a||w||cn!==null&&cn.memoizedState.tag&1){if(c.flags|=2048,bl(9,Tm.bind(null,c,p,b,a),void 0,null),un===null)throw Error(t(349));(ao&30)!==0||Sm(c,a,b)}return b}function Sm(i,a,c){i.flags|=16384,i={getSnapshot:a,value:c},a=zt.updateQueue,a===null?(a={lastEffect:null,stores:null},zt.updateQueue=a,a.stores=[i]):(c=a.stores,c===null?a.stores=[i]:c.push(i))}function Tm(i,a,c,p){a.value=c,a.getSnapshot=p,Em(a)&&Pm(i)}function xm(i,a,c){return c(function(){Em(a)&&Pm(i)})}function Em(i){var a=i.getSnapshot;i=i.value;try{var c=a();return!Kn(i,c)}catch{return!0}}function Pm(i){var a=Di(i,1);a!==null&&Kr(a,i,1,-1)}function _m(i){var a=mi();return typeof i=="function"&&(i=i()),a.memoizedState=a.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:i},a.queue=i,i=i.dispatch=fw.bind(null,zt,i),[a.memoizedState,i]}function bl(i,a,c,p){return i={tag:i,create:a,destroy:c,deps:p,next:null},a=zt.updateQueue,a===null?(a={lastEffect:null,stores:null},zt.updateQueue=a,a.lastEffect=i.next=i):(c=a.lastEffect,c===null?a.lastEffect=i.next=i:(p=c.next,c.next=i,i.next=p,a.lastEffect=i)),i}function Rm(){return _r().memoizedState}function Wc(i,a,c,p){var b=mi();zt.flags|=i,b.memoizedState=bl(1|a,c,void 0,p===void 0?null:p)}function Gc(i,a,c,p){var b=_r();p=p===void 0?null:p;var w=void 0;if(an!==null){var P=an.memoizedState;if(w=P.destroy,p!==null&&nh(p,P.deps)){b.memoizedState=bl(a,c,w,p);return}}zt.flags|=i,b.memoizedState=bl(1|a,c,w,p)}function Im(i,a){return Wc(8390656,8,i,a)}function sh(i,a){return Gc(2048,8,i,a)}function Om(i,a){return Gc(4,2,i,a)}function Mm(i,a){return Gc(4,4,i,a)}function Am(i,a){if(typeof a=="function")return i=i(),a(i),function(){a(null)};if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function Lm(i,a,c){return c=c!=null?c.concat([i]):null,Gc(4,4,Am.bind(null,a,i),c)}function lh(){}function Nm(i,a){var c=_r();a=a===void 0?null:a;var p=c.memoizedState;return p!==null&&a!==null&&nh(a,p[1])?p[0]:(c.memoizedState=[i,a],i)}function jm(i,a){var c=_r();a=a===void 0?null:a;var p=c.memoizedState;return p!==null&&a!==null&&nh(a,p[1])?p[0]:(i=i(),c.memoizedState=[i,a],i)}function Dm(i,a,c){return(ao&21)===0?(i.baseState&&(i.baseState=!1,Xn=!0),i.memoizedState=c):(Kn(c,a)||(c=zs(),zt.lanes|=c,oo|=c,i.baseState=!0),a)}function hw(i,a){var c=dt;dt=c!==0&&4>c?c:4,i(!0);var p=th.transition;th.transition={};try{i(!1),a()}finally{dt=c,th.transition=p}}function Um(){return _r().memoizedState}function pw(i,a,c){var p=ha(i);if(c={lane:p,action:c,hasEagerState:!1,eagerState:null,next:null},Fm(i))Bm(a,c);else if(c=gm(i,a,c,p),c!==null){var b=Bn();Kr(c,i,p,b),zm(c,a,p)}}function fw(i,a,c){var p=ha(i),b={lane:p,action:c,hasEagerState:!1,eagerState:null,next:null};if(Fm(i))Bm(a,b);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=a.lastRenderedReducer,w!==null))try{var P=a.lastRenderedState,j=w(P,c);if(b.hasEagerState=!0,b.eagerState=j,Kn(j,P)){var B=a.interleaved;B===null?(b.next=b,Zd(a)):(b.next=B.next,B.next=b),a.interleaved=b;return}}catch{}finally{}c=gm(i,a,b,p),c!==null&&(b=Bn(),Kr(c,i,p,b),zm(c,a,p))}}function Fm(i){var a=i.alternate;return i===zt||a!==null&&a===zt}function Bm(i,a){ml=$c=!0;var c=i.pending;c===null?a.next=a:(a.next=c.next,c.next=a),i.pending=a}function zm(i,a,c){if((c&4194240)!==0){var p=a.lanes;p&=i.pendingLanes,c|=p,a.lanes=c,ja(i,c)}}var Kc={readContext:Pr,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},mw={readContext:Pr,useCallback:function(i,a){return mi().memoizedState=[i,a===void 0?null:a],i},useContext:Pr,useEffect:Im,useImperativeHandle:function(i,a,c){return c=c!=null?c.concat([i]):null,Wc(4194308,4,Am.bind(null,a,i),c)},useLayoutEffect:function(i,a){return Wc(4194308,4,i,a)},useInsertionEffect:function(i,a){return Wc(4,2,i,a)},useMemo:function(i,a){var c=mi();return a=a===void 0?null:a,i=i(),c.memoizedState=[i,a],i},useReducer:function(i,a,c){var p=mi();return a=c!==void 0?c(a):a,p.memoizedState=p.baseState=a,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:a},p.queue=i,i=i.dispatch=pw.bind(null,zt,i),[p.memoizedState,i]},useRef:function(i){var a=mi();return i={current:i},a.memoizedState=i},useState:_m,useDebugValue:lh,useDeferredValue:function(i){return mi().memoizedState=i},useTransition:function(){var i=_m(!1),a=i[0];return i=hw.bind(null,i[1]),mi().memoizedState=i,[a,i]},useMutableSource:function(){},useSyncExternalStore:function(i,a,c){var p=zt,b=mi();if(Nt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=a(),un===null)throw Error(t(349));(ao&30)!==0||Sm(p,a,c)}b.memoizedState=c;var w={value:c,getSnapshot:a};return b.queue=w,Im(xm.bind(null,p,w,i),[i]),p.flags|=2048,bl(9,Tm.bind(null,p,w,c,a),void 0,null),c},useId:function(){var i=mi(),a=un.identifierPrefix;if(Nt){var c=ji,p=Ni;c=(p&~(1<<32-gn(p)-1)).toString(32)+c,a=":"+a+"R"+c,c=gl++,0<c&&(a+="H"+c.toString(32)),a+=":"}else c=dw++,a=":"+a+"r"+c.toString(32)+":";return i.memoizedState=a},unstable_isNewReconciler:!1},gw={readContext:Pr,useCallback:Nm,useContext:Pr,useEffect:sh,useImperativeHandle:Lm,useInsertionEffect:Om,useLayoutEffect:Mm,useMemo:jm,useReducer:ah,useRef:Rm,useState:function(){return ah(vl)},useDebugValue:lh,useDeferredValue:function(i){var a=_r();return Dm(a,an.memoizedState,i)},useTransition:function(){var i=ah(vl)[0],a=_r().memoizedState;return[i,a]},useMutableSource:km,useSyncExternalStore:Cm,useId:Um,unstable_isNewReconciler:!1},vw={readContext:Pr,useCallback:Nm,useContext:Pr,useEffect:sh,useImperativeHandle:Lm,useInsertionEffect:Om,useLayoutEffect:Mm,useMemo:jm,useReducer:oh,useRef:Rm,useState:function(){return oh(vl)},useDebugValue:lh,useDeferredValue:function(i){var a=_r();return an===null?a.memoizedState=i:Dm(a,an.memoizedState,i)},useTransition:function(){var i=oh(vl)[0],a=_r().memoizedState;return[i,a]},useMutableSource:km,useSyncExternalStore:Cm,useId:Um,unstable_isNewReconciler:!1};function $r(i,a){if(i&&i.defaultProps){a=ue({},a),i=i.defaultProps;for(var c in i)a[c]===void 0&&(a[c]=i[c]);return a}return a}function ch(i,a,c,p){a=i.memoizedState,c=c(p,a),c=c==null?a:ue({},a,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Zc={isMounted:function(i){return(i=i._reactInternals)?ii(i)===i:!1},enqueueSetState:function(i,a,c){i=i._reactInternals;var p=Bn(),b=ha(i),w=Ui(p,b);w.payload=a,c!=null&&(w.callback=c),a=la(i,w,b),a!==null&&(Kr(a,i,b,p),zc(a,i,b))},enqueueReplaceState:function(i,a,c){i=i._reactInternals;var p=Bn(),b=ha(i),w=Ui(p,b);w.tag=1,w.payload=a,c!=null&&(w.callback=c),a=la(i,w,b),a!==null&&(Kr(a,i,b,p),zc(a,i,b))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var c=Bn(),p=ha(i),b=Ui(c,p);b.tag=2,a!=null&&(b.callback=a),a=la(i,b,p),a!==null&&(Kr(a,i,p,c),zc(a,i,p))}};function Vm(i,a,c,p,b,w,P){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,w,P):a.prototype&&a.prototype.isPureReactComponent?!na(c,p)||!na(b,w):!0}function Hm(i,a,c){var p=!1,b=aa,w=a.contextType;return typeof w=="object"&&w!==null?w=Pr(w):(b=Qn(a)?eo:In.current,p=a.contextTypes,w=(p=p!=null)?es(i,b):aa),a=new a(c,w),i.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Zc,i.stateNode=a,a._reactInternals=i,p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=b,i.__reactInternalMemoizedMaskedChildContext=w),a}function qm(i,a,c,p){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,p),a.state!==i&&Zc.enqueueReplaceState(a,a.state,null)}function uh(i,a,c,p){var b=i.stateNode;b.props=c,b.state=i.memoizedState,b.refs={},Qd(i);var w=a.contextType;typeof w=="object"&&w!==null?b.context=Pr(w):(w=Qn(a)?eo:In.current,b.context=es(i,w)),b.state=i.memoizedState,w=a.getDerivedStateFromProps,typeof w=="function"&&(ch(i,a,w,c),b.state=i.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(a=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),a!==b.state&&Zc.enqueueReplaceState(b,b.state,null),Vc(i,c,b,p),b.state=i.memoizedState),typeof b.componentDidMount=="function"&&(i.flags|=4194308)}function ls(i,a){try{var c="",p=a;do c+=Ye(p),p=p.return;while(p);var b=c}catch(w){b=`
Error generating stack: `+w.message+`
`+w.stack}return{value:i,source:a,stack:b,digest:null}}function dh(i,a,c){return{value:i,source:null,stack:c??null,digest:a??null}}function hh(i,a){try{console.error(a.value)}catch(c){setTimeout(function(){throw c})}}var bw=typeof WeakMap=="function"?WeakMap:Map;function $m(i,a,c){c=Ui(-1,c),c.tag=3,c.payload={element:null};var p=a.value;return c.callback=function(){nu||(nu=!0,Eh=p),hh(i,a)},c}function Wm(i,a,c){c=Ui(-1,c),c.tag=3;var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var b=a.value;c.payload=function(){return p(b)},c.callback=function(){hh(i,a)}}var w=i.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(c.callback=function(){hh(i,a),typeof p!="function"&&(ua===null?ua=new Set([this]):ua.add(this));var P=a.stack;this.componentDidCatch(a.value,{componentStack:P!==null?P:""})}),c}function Gm(i,a,c){var p=i.pingCache;if(p===null){p=i.pingCache=new bw;var b=new Set;p.set(a,b)}else b=p.get(a),b===void 0&&(b=new Set,p.set(a,b));b.has(c)||(b.add(c),i=Mw.bind(null,i,a,c),a.then(i,i))}function Km(i){do{var a;if((a=i.tag===13)&&(a=i.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return i;i=i.return}while(i!==null);return null}function Zm(i,a,c,p,b){return(i.mode&1)===0?(i===a?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(a=Ui(-1,1),a.tag=2,la(c,a,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=b,i)}var yw=A.ReactCurrentOwner,Xn=!1;function Fn(i,a,c,p){a.child=i===null?mm(a,null,c,p):is(a,i.child,c,p)}function Qm(i,a,c,p,b){c=c.render;var w=a.ref;return os(a,b),p=rh(i,a,c,p,w,b),c=ih(),i!==null&&!Xn?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~b,Fi(i,a,b)):(Nt&&c&&Bd(a),a.flags|=1,Fn(i,a,p,b),a.child)}function Xm(i,a,c,p,b){if(i===null){var w=c.type;return typeof w=="function"&&!Ah(w)&&w.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(a.tag=15,a.type=w,Jm(i,a,w,p,b)):(i=lu(c.type,null,p,a,a.mode,b),i.ref=a.ref,i.return=a,a.child=i)}if(w=i.child,(i.lanes&b)===0){var P=w.memoizedProps;if(c=c.compare,c=c!==null?c:na,c(P,p)&&i.ref===a.ref)return Fi(i,a,b)}return a.flags|=1,i=fa(w,p),i.ref=a.ref,i.return=a,a.child=i}function Jm(i,a,c,p,b){if(i!==null){var w=i.memoizedProps;if(na(w,p)&&i.ref===a.ref)if(Xn=!1,a.pendingProps=p=w,(i.lanes&b)!==0)(i.flags&131072)!==0&&(Xn=!0);else return a.lanes=i.lanes,Fi(i,a,b)}return ph(i,a,c,p,b)}function Ym(i,a,c){var p=a.pendingProps,b=p.children,w=i!==null?i.memoizedState:null;if(p.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(us,pr),pr|=c;else{if((c&1073741824)===0)return i=w!==null?w.baseLanes|c:c,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:i,cachePool:null,transitions:null},a.updateQueue=null,It(us,pr),pr|=i,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=w!==null?w.baseLanes:c,It(us,pr),pr|=p}else w!==null?(p=w.baseLanes|c,a.memoizedState=null):p=c,It(us,pr),pr|=p;return Fn(i,a,b,c),a.child}function eg(i,a){var c=a.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(a.flags|=512,a.flags|=2097152)}function ph(i,a,c,p,b){var w=Qn(c)?eo:In.current;return w=es(a,w),os(a,b),c=rh(i,a,c,p,w,b),p=ih(),i!==null&&!Xn?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~b,Fi(i,a,b)):(Nt&&p&&Bd(a),a.flags|=1,Fn(i,a,c,b),a.child)}function tg(i,a,c,p,b){if(Qn(c)){var w=!0;Ac(a)}else w=!1;if(os(a,b),a.stateNode===null)Xc(i,a),Hm(a,c,p),uh(a,c,p,b),p=!0;else if(i===null){var P=a.stateNode,j=a.memoizedProps;P.props=j;var B=P.context,ie=c.contextType;typeof ie=="object"&&ie!==null?ie=Pr(ie):(ie=Qn(c)?eo:In.current,ie=es(a,ie));var we=c.getDerivedStateFromProps,ke=typeof we=="function"||typeof P.getSnapshotBeforeUpdate=="function";ke||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(j!==p||B!==ie)&&qm(a,P,p,ie),sa=!1;var ye=a.memoizedState;P.state=ye,Vc(a,p,P,b),B=a.memoizedState,j!==p||ye!==B||Zn.current||sa?(typeof we=="function"&&(ch(a,c,we,p),B=a.memoizedState),(j=sa||Vm(a,c,j,p,ye,B,ie))?(ke||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(a.flags|=4194308)):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=B),P.props=p,P.state=B,P.context=ie,p=j):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{P=a.stateNode,vm(i,a),j=a.memoizedProps,ie=a.type===a.elementType?j:$r(a.type,j),P.props=ie,ke=a.pendingProps,ye=P.context,B=c.contextType,typeof B=="object"&&B!==null?B=Pr(B):(B=Qn(c)?eo:In.current,B=es(a,B));var De=c.getDerivedStateFromProps;(we=typeof De=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(j!==ke||ye!==B)&&qm(a,P,p,B),sa=!1,ye=a.memoizedState,P.state=ye,Vc(a,p,P,b);var Be=a.memoizedState;j!==ke||ye!==Be||Zn.current||sa?(typeof De=="function"&&(ch(a,c,De,p),Be=a.memoizedState),(ie=sa||Vm(a,c,ie,p,ye,Be,B)||!1)?(we||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(p,Be,B),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(p,Be,B)),typeof P.componentDidUpdate=="function"&&(a.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof P.componentDidUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=Be),P.props=p,P.state=Be,P.context=B,p=ie):(typeof P.componentDidUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(a.flags|=1024),p=!1)}return fh(i,a,c,p,w,b)}function fh(i,a,c,p,b,w){eg(i,a);var P=(a.flags&128)!==0;if(!p&&!P)return b&&om(a,c,!1),Fi(i,a,w);p=a.stateNode,yw.current=a;var j=P&&typeof c.getDerivedStateFromError!="function"?null:p.render();return a.flags|=1,i!==null&&P?(a.child=is(a,i.child,null,w),a.child=is(a,null,j,w)):Fn(i,a,j,w),a.memoizedState=p.state,b&&om(a,c,!0),a.child}function ng(i){var a=i.stateNode;a.pendingContext?im(i,a.pendingContext,a.pendingContext!==a.context):a.context&&im(i,a.context,!1),Xd(i,a.containerInfo)}function rg(i,a,c,p,b){return rs(),qd(b),a.flags|=256,Fn(i,a,c,p),a.child}var mh={dehydrated:null,treeContext:null,retryLane:0};function gh(i){return{baseLanes:i,cachePool:null,transitions:null}}function ig(i,a,c){var p=a.pendingProps,b=Bt.current,w=!1,P=(a.flags&128)!==0,j;if((j=P)||(j=i!==null&&i.memoizedState===null?!1:(b&2)!==0),j?(w=!0,a.flags&=-129):(i===null||i.memoizedState!==null)&&(b|=1),It(Bt,b&1),i===null)return Hd(a),i=a.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((a.mode&1)===0?a.lanes=1:i.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(P=p.children,i=p.fallback,w?(p=a.mode,w=a.child,P={mode:"hidden",children:P},(p&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=cu(P,p,0,null),i=uo(i,p,c,null),w.return=a,i.return=a,w.sibling=i,a.child=w,a.child.memoizedState=gh(c),a.memoizedState=mh,i):vh(a,P));if(b=i.memoizedState,b!==null&&(j=b.dehydrated,j!==null))return ww(i,a,P,p,j,b,c);if(w){w=p.fallback,P=a.mode,b=i.child,j=b.sibling;var B={mode:"hidden",children:p.children};return(P&1)===0&&a.child!==b?(p=a.child,p.childLanes=0,p.pendingProps=B,a.deletions=null):(p=fa(b,B),p.subtreeFlags=b.subtreeFlags&14680064),j!==null?w=fa(j,w):(w=uo(w,P,c,null),w.flags|=2),w.return=a,p.return=a,p.sibling=w,a.child=p,p=w,w=a.child,P=i.child.memoizedState,P=P===null?gh(c):{baseLanes:P.baseLanes|c,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=i.childLanes&~c,a.memoizedState=mh,p}return w=i.child,i=w.sibling,p=fa(w,{mode:"visible",children:p.children}),(a.mode&1)===0&&(p.lanes=c),p.return=a,p.sibling=null,i!==null&&(c=a.deletions,c===null?(a.deletions=[i],a.flags|=16):c.push(i)),a.child=p,a.memoizedState=null,p}function vh(i,a){return a=cu({mode:"visible",children:a},i.mode,0,null),a.return=i,i.child=a}function Qc(i,a,c,p){return p!==null&&qd(p),is(a,i.child,null,c),i=vh(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function ww(i,a,c,p,b,w,P){if(c)return a.flags&256?(a.flags&=-257,p=dh(Error(t(422))),Qc(i,a,P,p)):a.memoizedState!==null?(a.child=i.child,a.flags|=128,null):(w=p.fallback,b=a.mode,p=cu({mode:"visible",children:p.children},b,0,null),w=uo(w,b,P,null),w.flags|=2,p.return=a,w.return=a,p.sibling=w,a.child=p,(a.mode&1)!==0&&is(a,i.child,null,P),a.child.memoizedState=gh(P),a.memoizedState=mh,w);if((a.mode&1)===0)return Qc(i,a,P,null);if(b.data==="$!"){if(p=b.nextSibling&&b.nextSibling.dataset,p)var j=p.dgst;return p=j,w=Error(t(419)),p=dh(w,p,void 0),Qc(i,a,P,p)}if(j=(P&i.childLanes)!==0,Xn||j){if(p=un,p!==null){switch(P&-P){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(p.suspendedLanes|P))!==0?0:b,b!==0&&b!==w.retryLane&&(w.retryLane=b,Di(i,b),Kr(p,i,b,-1))}return Mh(),p=dh(Error(t(421))),Qc(i,a,P,p)}return b.data==="$?"?(a.flags|=128,a.child=i.child,a=Aw.bind(null,i),b._reactRetry=a,null):(i=w.treeContext,hr=ra(b.nextSibling),dr=a,Nt=!0,qr=null,i!==null&&(xr[Er++]=Ni,xr[Er++]=ji,xr[Er++]=to,Ni=i.id,ji=i.overflow,to=a),a=vh(a,p.children),a.flags|=4096,a)}function ag(i,a,c){i.lanes|=a;var p=i.alternate;p!==null&&(p.lanes|=a),Kd(i.return,a,c)}function bh(i,a,c,p,b){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:c,tailMode:b}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=c,w.tailMode=b)}function og(i,a,c){var p=a.pendingProps,b=p.revealOrder,w=p.tail;if(Fn(i,a,p.children,c),p=Bt.current,(p&2)!==0)p=p&1|2,a.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&ag(i,c,a);else if(i.tag===19)ag(i,c,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}if(It(Bt,p),(a.mode&1)===0)a.memoizedState=null;else switch(b){case"forwards":for(c=a.child,b=null;c!==null;)i=c.alternate,i!==null&&Hc(i)===null&&(b=c),c=c.sibling;c=b,c===null?(b=a.child,a.child=null):(b=c.sibling,c.sibling=null),bh(a,!1,b,c,w);break;case"backwards":for(c=null,b=a.child,a.child=null;b!==null;){if(i=b.alternate,i!==null&&Hc(i)===null){a.child=b;break}i=b.sibling,b.sibling=c,c=b,b=i}bh(a,!0,c,null,w);break;case"together":bh(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Xc(i,a){(a.mode&1)===0&&i!==null&&(i.alternate=null,a.alternate=null,a.flags|=2)}function Fi(i,a,c){if(i!==null&&(a.dependencies=i.dependencies),oo|=a.lanes,(c&a.childLanes)===0)return null;if(i!==null&&a.child!==i.child)throw Error(t(153));if(a.child!==null){for(i=a.child,c=fa(i,i.pendingProps),a.child=c,c.return=a;i.sibling!==null;)i=i.sibling,c=c.sibling=fa(i,i.pendingProps),c.return=a;c.sibling=null}return a.child}function kw(i,a,c){switch(a.tag){case 3:ng(a),rs();break;case 5:wm(a);break;case 1:Qn(a.type)&&Ac(a);break;case 4:Xd(a,a.stateNode.containerInfo);break;case 10:var p=a.type._context,b=a.memoizedProps.value;It(Fc,p._currentValue),p._currentValue=b;break;case 13:if(p=a.memoizedState,p!==null)return p.dehydrated!==null?(It(Bt,Bt.current&1),a.flags|=128,null):(c&a.child.childLanes)!==0?ig(i,a,c):(It(Bt,Bt.current&1),i=Fi(i,a,c),i!==null?i.sibling:null);It(Bt,Bt.current&1);break;case 19:if(p=(c&a.childLanes)!==0,(i.flags&128)!==0){if(p)return og(i,a,c);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),It(Bt,Bt.current),p)break;return null;case 22:case 23:return a.lanes=0,Ym(i,a,c)}return Fi(i,a,c)}var sg,yh,lg,cg;sg=function(i,a){for(var c=a.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},yh=function(){},lg=function(i,a,c,p){var b=i.memoizedProps;if(b!==p){i=a.stateNode,io(fi.current);var w=null;switch(c){case"input":b=gr(i,b),p=gr(i,p),w=[];break;case"select":b=ue({},b,{value:void 0}),p=ue({},p,{value:void 0}),w=[];break;case"textarea":b=Ei(i,b),p=Ei(i,p),w=[];break;default:typeof b.onClick!="function"&&typeof p.onClick=="function"&&(i.onclick=Ic)}qt(c,p);var P;c=null;for(ie in b)if(!p.hasOwnProperty(ie)&&b.hasOwnProperty(ie)&&b[ie]!=null)if(ie==="style"){var j=b[ie];for(P in j)j.hasOwnProperty(P)&&(c||(c={}),c[P]="")}else ie!=="dangerouslySetInnerHTML"&&ie!=="children"&&ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&ie!=="autoFocus"&&(o.hasOwnProperty(ie)?w||(w=[]):(w=w||[]).push(ie,null));for(ie in p){var B=p[ie];if(j=b!=null?b[ie]:void 0,p.hasOwnProperty(ie)&&B!==j&&(B!=null||j!=null))if(ie==="style")if(j){for(P in j)!j.hasOwnProperty(P)||B&&B.hasOwnProperty(P)||(c||(c={}),c[P]="");for(P in B)B.hasOwnProperty(P)&&j[P]!==B[P]&&(c||(c={}),c[P]=B[P])}else c||(w||(w=[]),w.push(ie,c)),c=B;else ie==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,j=j?j.__html:void 0,B!=null&&j!==B&&(w=w||[]).push(ie,B)):ie==="children"?typeof B!="string"&&typeof B!="number"||(w=w||[]).push(ie,""+B):ie!=="suppressContentEditableWarning"&&ie!=="suppressHydrationWarning"&&(o.hasOwnProperty(ie)?(B!=null&&ie==="onScroll"&&At("scroll",i),w||j===B||(w=[])):(w=w||[]).push(ie,B))}c&&(w=w||[]).push("style",c);var ie=w;(a.updateQueue=ie)&&(a.flags|=4)}},cg=function(i,a,c,p){c!==p&&(a.flags|=4)};function yl(i,a){if(!Nt)switch(i.tailMode){case"hidden":a=i.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Mn(i){var a=i.alternate!==null&&i.alternate.child===i.child,c=0,p=0;if(a)for(var b=i.child;b!==null;)c|=b.lanes|b.childLanes,p|=b.subtreeFlags&14680064,p|=b.flags&14680064,b.return=i,b=b.sibling;else for(b=i.child;b!==null;)c|=b.lanes|b.childLanes,p|=b.subtreeFlags,p|=b.flags,b.return=i,b=b.sibling;return i.subtreeFlags|=p,i.childLanes=c,a}function Cw(i,a,c){var p=a.pendingProps;switch(zd(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mn(a),null;case 1:return Qn(a.type)&&Mc(),Mn(a),null;case 3:return p=a.stateNode,ss(),Lt(Zn),Lt(In),eh(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(Dc(a)?a.flags|=4:i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,qr!==null&&(Rh(qr),qr=null))),yh(i,a),Mn(a),null;case 5:Jd(a);var b=io(fl.current);if(c=a.type,i!==null&&a.stateNode!=null)lg(i,a,c,p,b),i.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!p){if(a.stateNode===null)throw Error(t(166));return Mn(a),null}if(i=io(fi.current),Dc(a)){p=a.stateNode,c=a.type;var w=a.memoizedProps;switch(p[pi]=a,p[cl]=w,i=(a.mode&1)!==0,c){case"dialog":At("cancel",p),At("close",p);break;case"iframe":case"object":case"embed":At("load",p);break;case"video":case"audio":for(b=0;b<Mi.length;b++)At(Mi[b],p);break;case"source":At("error",p);break;case"img":case"image":case"link":At("error",p),At("load",p);break;case"details":At("toggle",p);break;case"input":vr(p,w),At("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!w.multiple},At("invalid",p);break;case"textarea":_o(p,w),At("invalid",p)}qt(c,w),b=null;for(var P in w)if(w.hasOwnProperty(P)){var j=w[P];P==="children"?typeof j=="string"?p.textContent!==j&&(w.suppressHydrationWarning!==!0&&Rc(p.textContent,j,i),b=["children",j]):typeof j=="number"&&p.textContent!==""+j&&(w.suppressHydrationWarning!==!0&&Rc(p.textContent,j,i),b=["children",""+j]):o.hasOwnProperty(P)&&j!=null&&P==="onScroll"&&At("scroll",p)}switch(c){case"input":Ht(p),Po(p,w,!0);break;case"textarea":Ht(p),y(p);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(p.onclick=Ic)}p=b,a.updateQueue=p,p!==null&&(a.flags|=4)}else{P=b.nodeType===9?b:b.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=C(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=P.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof p.is=="string"?i=P.createElement(c,{is:p.is}):(i=P.createElement(c),c==="select"&&(P=i,p.multiple?P.multiple=!0:p.size&&(P.size=p.size))):i=P.createElementNS(i,c),i[pi]=a,i[cl]=p,sg(i,a,!1,!1),a.stateNode=i;e:{switch(P=St(c,p),c){case"dialog":At("cancel",i),At("close",i),b=p;break;case"iframe":case"object":case"embed":At("load",i),b=p;break;case"video":case"audio":for(b=0;b<Mi.length;b++)At(Mi[b],i);b=p;break;case"source":At("error",i),b=p;break;case"img":case"image":case"link":At("error",i),At("load",i),b=p;break;case"details":At("toggle",i),b=p;break;case"input":vr(i,p),b=gr(i,p),At("invalid",i);break;case"option":b=p;break;case"select":i._wrapperState={wasMultiple:!!p.multiple},b=ue({},p,{value:void 0}),At("invalid",i);break;case"textarea":_o(i,p),b=Ei(i,p),At("invalid",i);break;default:b=p}qt(c,b),j=b;for(w in j)if(j.hasOwnProperty(w)){var B=j[w];w==="style"?at(i,B):w==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&se(i,B)):w==="children"?typeof B=="string"?(c!=="textarea"||B!=="")&&be(i,B):typeof B=="number"&&be(i,""+B):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(o.hasOwnProperty(w)?B!=null&&w==="onScroll"&&At("scroll",i):B!=null&&z(i,w,B,P))}switch(c){case"input":Ht(i),Po(i,p,!1);break;case"textarea":Ht(i),y(i);break;case"option":p.value!=null&&i.setAttribute("value",""+$e(p.value));break;case"select":i.multiple=!!p.multiple,w=p.value,w!=null?Nn(i,!!p.multiple,w,!1):p.defaultValue!=null&&Nn(i,!!p.multiple,p.defaultValue,!0);break;default:typeof b.onClick=="function"&&(i.onclick=Ic)}switch(c){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Mn(a),null;case 6:if(i&&a.stateNode!=null)cg(i,a,i.memoizedProps,p);else{if(typeof p!="string"&&a.stateNode===null)throw Error(t(166));if(c=io(fl.current),io(fi.current),Dc(a)){if(p=a.stateNode,c=a.memoizedProps,p[pi]=a,(w=p.nodeValue!==c)&&(i=dr,i!==null))switch(i.tag){case 3:Rc(p.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Rc(p.nodeValue,c,(i.mode&1)!==0)}w&&(a.flags|=4)}else p=(c.nodeType===9?c:c.ownerDocument).createTextNode(p),p[pi]=a,a.stateNode=p}return Mn(a),null;case 13:if(Lt(Bt),p=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Nt&&hr!==null&&(a.mode&1)!==0&&(a.flags&128)===0)hm(),rs(),a.flags|=98560,w=!1;else if(w=Dc(a),p!==null&&p.dehydrated!==null){if(i===null){if(!w)throw Error(t(318));if(w=a.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[pi]=a}else rs(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Mn(a),w=!1}else qr!==null&&(Rh(qr),qr=null),w=!0;if(!w)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=c,a):(p=p!==null,p!==(i!==null&&i.memoizedState!==null)&&p&&(a.child.flags|=8192,(a.mode&1)!==0&&(i===null||(Bt.current&1)!==0?on===0&&(on=3):Mh())),a.updateQueue!==null&&(a.flags|=4),Mn(a),null);case 4:return ss(),yh(i,a),i===null&&sl(a.stateNode.containerInfo),Mn(a),null;case 10:return Gd(a.type._context),Mn(a),null;case 17:return Qn(a.type)&&Mc(),Mn(a),null;case 19:if(Lt(Bt),w=a.memoizedState,w===null)return Mn(a),null;if(p=(a.flags&128)!==0,P=w.rendering,P===null)if(p)yl(w,!1);else{if(on!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(P=Hc(i),P!==null){for(a.flags|=128,yl(w,!1),p=P.updateQueue,p!==null&&(a.updateQueue=p,a.flags|=4),a.subtreeFlags=0,p=c,c=a.child;c!==null;)w=c,i=p,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=i,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,i=P.dependencies,w.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return It(Bt,Bt.current&1|2),a.child}i=i.sibling}w.tail!==null&&Ft()>ds&&(a.flags|=128,p=!0,yl(w,!1),a.lanes=4194304)}else{if(!p)if(i=Hc(P),i!==null){if(a.flags|=128,p=!0,c=i.updateQueue,c!==null&&(a.updateQueue=c,a.flags|=4),yl(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Nt)return Mn(a),null}else 2*Ft()-w.renderingStartTime>ds&&c!==1073741824&&(a.flags|=128,p=!0,yl(w,!1),a.lanes=4194304);w.isBackwards?(P.sibling=a.child,a.child=P):(c=w.last,c!==null?c.sibling=P:a.child=P,w.last=P)}return w.tail!==null?(a=w.tail,w.rendering=a,w.tail=a.sibling,w.renderingStartTime=Ft(),a.sibling=null,c=Bt.current,It(Bt,p?c&1|2:c&1),a):(Mn(a),null);case 22:case 23:return Oh(),p=a.memoizedState!==null,i!==null&&i.memoizedState!==null!==p&&(a.flags|=8192),p&&(a.mode&1)!==0?(pr&1073741824)!==0&&(Mn(a),a.subtreeFlags&6&&(a.flags|=8192)):Mn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function Sw(i,a){switch(zd(a),a.tag){case 1:return Qn(a.type)&&Mc(),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return ss(),Lt(Zn),Lt(In),eh(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 5:return Jd(a),null;case 13:if(Lt(Bt),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(t(340));rs()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return Lt(Bt),null;case 4:return ss(),null;case 10:return Gd(a.type._context),null;case 22:case 23:return Oh(),null;case 24:return null;default:return null}}var Jc=!1,An=!1,Tw=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function cs(i,a){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(p){$t(i,a,p)}else c.current=null}function ug(i,a,c){try{c()}catch(p){$t(i,a,p)}}var dg=!1;function xw(i,a){if(Md=lr,i=ol(),u(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var p=c.getSelection&&c.getSelection();if(p&&p.rangeCount!==0){c=p.anchorNode;var b=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var P=0,j=-1,B=-1,ie=0,we=0,ke=i,ye=null;t:for(;;){for(var De;ke!==c||b!==0&&ke.nodeType!==3||(j=P+b),ke!==w||p!==0&&ke.nodeType!==3||(B=P+p),ke.nodeType===3&&(P+=ke.nodeValue.length),(De=ke.firstChild)!==null;)ye=ke,ke=De;for(;;){if(ke===i)break t;if(ye===c&&++ie===b&&(j=P),ye===w&&++we===p&&(B=P),(De=ke.nextSibling)!==null)break;ke=ye,ye=ke.parentNode}ke=De}c=j===-1||B===-1?null:{start:j,end:B}}else c=null}c=c||{start:0,end:0}}else c=null;for(Ad={focusedElem:i,selectionRange:c},lr=!1,Fe=a;Fe!==null;)if(a=Fe,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,Fe=i;else for(;Fe!==null;){a=Fe;try{var Be=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(Be!==null){var Ve=Be.memoizedProps,Xt=Be.memoizedState,Z=a.stateNode,H=Z.getSnapshotBeforeUpdate(a.elementType===a.type?Ve:$r(a.type,Ve),Xt);Z.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var X=a.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(xe){$t(a,a.return,xe)}if(i=a.sibling,i!==null){i.return=a.return,Fe=i;break}Fe=a.return}return Be=dg,dg=!1,Be}function wl(i,a,c){var p=a.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var b=p=p.next;do{if((b.tag&i)===i){var w=b.destroy;b.destroy=void 0,w!==void 0&&ug(a,c,w)}b=b.next}while(b!==p)}}function Yc(i,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&i)===i){var p=c.create;c.destroy=p()}c=c.next}while(c!==a)}}function wh(i){var a=i.ref;if(a!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof a=="function"?a(i):a.current=i}}function hg(i){var a=i.alternate;a!==null&&(i.alternate=null,hg(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&(delete a[pi],delete a[cl],delete a[Dd],delete a[sw],delete a[lw])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function pg(i){return i.tag===5||i.tag===3||i.tag===4}function fg(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||pg(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function kh(i,a,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,a?c.nodeType===8?c.parentNode.insertBefore(i,a):c.insertBefore(i,a):(c.nodeType===8?(a=c.parentNode,a.insertBefore(i,c)):(a=c,a.appendChild(i)),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Ic));else if(p!==4&&(i=i.child,i!==null))for(kh(i,a,c),i=i.sibling;i!==null;)kh(i,a,c),i=i.sibling}function Ch(i,a,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,a?c.insertBefore(i,a):c.appendChild(i);else if(p!==4&&(i=i.child,i!==null))for(Ch(i,a,c),i=i.sibling;i!==null;)Ch(i,a,c),i=i.sibling}var bn=null,Wr=!1;function ca(i,a,c){for(c=c.child;c!==null;)mg(i,a,c),c=c.sibling}function mg(i,a,c){if(xn&&typeof xn.onCommitFiberUnmount=="function")try{xn.onCommitFiberUnmount(wr,c)}catch{}switch(c.tag){case 5:An||cs(c,a);case 6:var p=bn,b=Wr;bn=null,ca(i,a,c),bn=p,Wr=b,bn!==null&&(Wr?(i=bn,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):bn.removeChild(c.stateNode));break;case 18:bn!==null&&(Wr?(i=bn,c=c.stateNode,i.nodeType===8?jd(i.parentNode,c):i.nodeType===1&&jd(i,c),Pn(i)):jd(bn,c.stateNode));break;case 4:p=bn,b=Wr,bn=c.stateNode.containerInfo,Wr=!0,ca(i,a,c),bn=p,Wr=b;break;case 0:case 11:case 14:case 15:if(!An&&(p=c.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){b=p=p.next;do{var w=b,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&ug(c,a,P),b=b.next}while(b!==p)}ca(i,a,c);break;case 1:if(!An&&(cs(c,a),p=c.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=c.memoizedProps,p.state=c.memoizedState,p.componentWillUnmount()}catch(j){$t(c,a,j)}ca(i,a,c);break;case 21:ca(i,a,c);break;case 22:c.mode&1?(An=(p=An)||c.memoizedState!==null,ca(i,a,c),An=p):ca(i,a,c);break;default:ca(i,a,c)}}function gg(i){var a=i.updateQueue;if(a!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new Tw),a.forEach(function(p){var b=Lw.bind(null,i,p);c.has(p)||(c.add(p),p.then(b,b))})}}function Gr(i,a){var c=a.deletions;if(c!==null)for(var p=0;p<c.length;p++){var b=c[p];try{var w=i,P=a,j=P;e:for(;j!==null;){switch(j.tag){case 5:bn=j.stateNode,Wr=!1;break e;case 3:bn=j.stateNode.containerInfo,Wr=!0;break e;case 4:bn=j.stateNode.containerInfo,Wr=!0;break e}j=j.return}if(bn===null)throw Error(t(160));mg(w,P,b),bn=null,Wr=!1;var B=b.alternate;B!==null&&(B.return=null),b.return=null}catch(ie){$t(b,a,ie)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)vg(a,i),a=a.sibling}function vg(i,a){var c=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Gr(a,i),gi(i),p&4){try{wl(3,i,i.return),Yc(3,i)}catch(Ve){$t(i,i.return,Ve)}try{wl(5,i,i.return)}catch(Ve){$t(i,i.return,Ve)}}break;case 1:Gr(a,i),gi(i),p&512&&c!==null&&cs(c,c.return);break;case 5:if(Gr(a,i),gi(i),p&512&&c!==null&&cs(c,c.return),i.flags&32){var b=i.stateNode;try{be(b,"")}catch(Ve){$t(i,i.return,Ve)}}if(p&4&&(b=i.stateNode,b!=null)){var w=i.memoizedProps,P=c!==null?c.memoizedProps:w,j=i.type,B=i.updateQueue;if(i.updateQueue=null,B!==null)try{j==="input"&&w.type==="radio"&&w.name!=null&&Gi(b,w),St(j,P);var ie=St(j,w);for(P=0;P<B.length;P+=2){var we=B[P],ke=B[P+1];we==="style"?at(b,ke):we==="dangerouslySetInnerHTML"?se(b,ke):we==="children"?be(b,ke):z(b,we,ke,ie)}switch(j){case"input":Ti(b,w);break;case"textarea":_(b,w);break;case"select":var ye=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!w.multiple;var De=w.value;De!=null?Nn(b,!!w.multiple,De,!1):ye!==!!w.multiple&&(w.defaultValue!=null?Nn(b,!!w.multiple,w.defaultValue,!0):Nn(b,!!w.multiple,w.multiple?[]:"",!1))}b[cl]=w}catch(Ve){$t(i,i.return,Ve)}}break;case 6:if(Gr(a,i),gi(i),p&4){if(i.stateNode===null)throw Error(t(162));b=i.stateNode,w=i.memoizedProps;try{b.nodeValue=w}catch(Ve){$t(i,i.return,Ve)}}break;case 3:if(Gr(a,i),gi(i),p&4&&c!==null&&c.memoizedState.isDehydrated)try{Pn(a.containerInfo)}catch(Ve){$t(i,i.return,Ve)}break;case 4:Gr(a,i),gi(i);break;case 13:Gr(a,i),gi(i),b=i.child,b.flags&8192&&(w=b.memoizedState!==null,b.stateNode.isHidden=w,!w||b.alternate!==null&&b.alternate.memoizedState!==null||(xh=Ft())),p&4&&gg(i);break;case 22:if(we=c!==null&&c.memoizedState!==null,i.mode&1?(An=(ie=An)||we,Gr(a,i),An=ie):Gr(a,i),gi(i),p&8192){if(ie=i.memoizedState!==null,(i.stateNode.isHidden=ie)&&!we&&(i.mode&1)!==0)for(Fe=i,we=i.child;we!==null;){for(ke=Fe=we;Fe!==null;){switch(ye=Fe,De=ye.child,ye.tag){case 0:case 11:case 14:case 15:wl(4,ye,ye.return);break;case 1:cs(ye,ye.return);var Be=ye.stateNode;if(typeof Be.componentWillUnmount=="function"){p=ye,c=ye.return;try{a=p,Be.props=a.memoizedProps,Be.state=a.memoizedState,Be.componentWillUnmount()}catch(Ve){$t(p,c,Ve)}}break;case 5:cs(ye,ye.return);break;case 22:if(ye.memoizedState!==null){wg(ke);continue}}De!==null?(De.return=ye,Fe=De):wg(ke)}we=we.sibling}e:for(we=null,ke=i;;){if(ke.tag===5){if(we===null){we=ke;try{b=ke.stateNode,ie?(w=b.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(j=ke.stateNode,B=ke.memoizedProps.style,P=B!=null&&B.hasOwnProperty("display")?B.display:null,j.style.display=Ne("display",P))}catch(Ve){$t(i,i.return,Ve)}}}else if(ke.tag===6){if(we===null)try{ke.stateNode.nodeValue=ie?"":ke.memoizedProps}catch(Ve){$t(i,i.return,Ve)}}else if((ke.tag!==22&&ke.tag!==23||ke.memoizedState===null||ke===i)&&ke.child!==null){ke.child.return=ke,ke=ke.child;continue}if(ke===i)break e;for(;ke.sibling===null;){if(ke.return===null||ke.return===i)break e;we===ke&&(we=null),ke=ke.return}we===ke&&(we=null),ke.sibling.return=ke.return,ke=ke.sibling}}break;case 19:Gr(a,i),gi(i),p&4&&gg(i);break;case 21:break;default:Gr(a,i),gi(i)}}function gi(i){var a=i.flags;if(a&2){try{e:{for(var c=i.return;c!==null;){if(pg(c)){var p=c;break e}c=c.return}throw Error(t(160))}switch(p.tag){case 5:var b=p.stateNode;p.flags&32&&(be(b,""),p.flags&=-33);var w=fg(i);Ch(i,w,b);break;case 3:case 4:var P=p.stateNode.containerInfo,j=fg(i);kh(i,j,P);break;default:throw Error(t(161))}}catch(B){$t(i,i.return,B)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function Ew(i,a,c){Fe=i,bg(i)}function bg(i,a,c){for(var p=(i.mode&1)!==0;Fe!==null;){var b=Fe,w=b.child;if(b.tag===22&&p){var P=b.memoizedState!==null||Jc;if(!P){var j=b.alternate,B=j!==null&&j.memoizedState!==null||An;j=Jc;var ie=An;if(Jc=P,(An=B)&&!ie)for(Fe=b;Fe!==null;)P=Fe,B=P.child,P.tag===22&&P.memoizedState!==null?kg(b):B!==null?(B.return=P,Fe=B):kg(b);for(;w!==null;)Fe=w,bg(w),w=w.sibling;Fe=b,Jc=j,An=ie}yg(i)}else(b.subtreeFlags&8772)!==0&&w!==null?(w.return=b,Fe=w):yg(i)}}function yg(i){for(;Fe!==null;){var a=Fe;if((a.flags&8772)!==0){var c=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:An||Yc(5,a);break;case 1:var p=a.stateNode;if(a.flags&4&&!An)if(c===null)p.componentDidMount();else{var b=a.elementType===a.type?c.memoizedProps:$r(a.type,c.memoizedProps);p.componentDidUpdate(b,c.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var w=a.updateQueue;w!==null&&ym(a,w,p);break;case 3:var P=a.updateQueue;if(P!==null){if(c=null,a.child!==null)switch(a.child.tag){case 5:c=a.child.stateNode;break;case 1:c=a.child.stateNode}ym(a,P,c)}break;case 5:var j=a.stateNode;if(c===null&&a.flags&4){c=j;var B=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&c.focus();break;case"img":B.src&&(c.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var ie=a.alternate;if(ie!==null){var we=ie.memoizedState;if(we!==null){var ke=we.dehydrated;ke!==null&&Pn(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}An||a.flags&512&&wh(a)}catch(ye){$t(a,a.return,ye)}}if(a===i){Fe=null;break}if(c=a.sibling,c!==null){c.return=a.return,Fe=c;break}Fe=a.return}}function wg(i){for(;Fe!==null;){var a=Fe;if(a===i){Fe=null;break}var c=a.sibling;if(c!==null){c.return=a.return,Fe=c;break}Fe=a.return}}function kg(i){for(;Fe!==null;){var a=Fe;try{switch(a.tag){case 0:case 11:case 15:var c=a.return;try{Yc(4,a)}catch(B){$t(a,c,B)}break;case 1:var p=a.stateNode;if(typeof p.componentDidMount=="function"){var b=a.return;try{p.componentDidMount()}catch(B){$t(a,b,B)}}var w=a.return;try{wh(a)}catch(B){$t(a,w,B)}break;case 5:var P=a.return;try{wh(a)}catch(B){$t(a,P,B)}}}catch(B){$t(a,a.return,B)}if(a===i){Fe=null;break}var j=a.sibling;if(j!==null){j.return=a.return,Fe=j;break}Fe=a.return}}var Pw=Math.ceil,eu=A.ReactCurrentDispatcher,Sh=A.ReactCurrentOwner,Rr=A.ReactCurrentBatchConfig,mt=0,un=null,en=null,yn=0,pr=0,us=ia(0),on=0,kl=null,oo=0,tu=0,Th=0,Cl=null,Jn=null,xh=0,ds=1/0,Bi=null,nu=!1,Eh=null,ua=null,ru=!1,da=null,iu=0,Sl=0,Ph=null,au=-1,ou=0;function Bn(){return(mt&6)!==0?Ft():au!==-1?au:au=Ft()}function ha(i){return(i.mode&1)===0?1:(mt&2)!==0&&yn!==0?yn&-yn:uw.transition!==null?(ou===0&&(ou=zs()),ou):(i=dt,i!==0||(i=window.event,i=i===void 0?16:hc(i.type)),i)}function Kr(i,a,c,p){if(50<Sl)throw Sl=0,Ph=null,Error(t(185));Tt(i,c,p),((mt&2)===0||i!==un)&&(i===un&&((mt&2)===0&&(tu|=c),on===4&&pa(i,yn)),Yn(i,p),c===1&&mt===0&&(a.mode&1)===0&&(ds=Ft()+500,Lc&&oa()))}function Yn(i,a){var c=i.callbackNode;Cr(i,a);var p=rt(i,i===un?yn:0);if(p===0)c!==null&&Wn(c),i.callbackNode=null,i.callbackPriority=0;else if(a=p&-p,i.callbackPriority!==a){if(c!=null&&Wn(c),a===1)i.tag===0?cw(Sg.bind(null,i)):sm(Sg.bind(null,i)),aw(function(){(mt&6)===0&&oa()}),c=null;else{switch(Sr(p)){case 1:c=Lo;break;case 4:c=Bs;break;case 16:c=Ma;break;case 536870912:c=No;break;default:c=Ma}c=Og(c,Cg.bind(null,i))}i.callbackPriority=a,i.callbackNode=c}}function Cg(i,a){if(au=-1,ou=0,(mt&6)!==0)throw Error(t(327));var c=i.callbackNode;if(hs()&&i.callbackNode!==c)return null;var p=rt(i,i===un?yn:0);if(p===0)return null;if((p&30)!==0||(p&i.expiredLanes)!==0||a)a=su(i,p);else{a=p;var b=mt;mt|=2;var w=xg();(un!==i||yn!==a)&&(Bi=null,ds=Ft()+500,lo(i,a));do try{Iw();break}catch(j){Tg(i,j)}while(!0);Wd(),eu.current=w,mt=b,en!==null?a=0:(un=null,yn=0,a=on)}if(a!==0){if(a===2&&(b=Uo(i),b!==0&&(p=b,a=_h(i,b))),a===1)throw c=kl,lo(i,0),pa(i,p),Yn(i,Ft()),c;if(a===6)pa(i,p);else{if(b=i.current.alternate,(p&30)===0&&!_w(b)&&(a=su(i,p),a===2&&(w=Uo(i),w!==0&&(p=w,a=_h(i,w))),a===1))throw c=kl,lo(i,0),pa(i,p),Yn(i,Ft()),c;switch(i.finishedWork=b,i.finishedLanes=p,a){case 0:case 1:throw Error(t(345));case 2:co(i,Jn,Bi);break;case 3:if(pa(i,p),(p&130023424)===p&&(a=xh+500-Ft(),10<a)){if(rt(i,0)!==0)break;if(b=i.suspendedLanes,(b&p)!==p){Bn(),i.pingedLanes|=i.suspendedLanes&b;break}i.timeoutHandle=Nd(co.bind(null,i,Jn,Bi),a);break}co(i,Jn,Bi);break;case 4:if(pa(i,p),(p&4194240)===p)break;for(a=i.eventTimes,b=-1;0<p;){var P=31-gn(p);w=1<<P,P=a[P],P>b&&(b=P),p&=~w}if(p=b,p=Ft()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*Pw(p/1960))-p,10<p){i.timeoutHandle=Nd(co.bind(null,i,Jn,Bi),p);break}co(i,Jn,Bi);break;case 5:co(i,Jn,Bi);break;default:throw Error(t(329))}}}return Yn(i,Ft()),i.callbackNode===c?Cg.bind(null,i):null}function _h(i,a){var c=Cl;return i.current.memoizedState.isDehydrated&&(lo(i,a).flags|=256),i=su(i,a),i!==2&&(a=Jn,Jn=c,a!==null&&Rh(a)),i}function Rh(i){Jn===null?Jn=i:Jn.push.apply(Jn,i)}function _w(i){for(var a=i;;){if(a.flags&16384){var c=a.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var p=0;p<c.length;p++){var b=c[p],w=b.getSnapshot;b=b.value;try{if(!Kn(w(),b))return!1}catch{return!1}}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function pa(i,a){for(a&=~Th,a&=~tu,i.suspendedLanes|=a,i.pingedLanes&=~a,i=i.expirationTimes;0<a;){var c=31-gn(a),p=1<<c;i[c]=-1,a&=~p}}function Sg(i){if((mt&6)!==0)throw Error(t(327));hs();var a=rt(i,0);if((a&1)===0)return Yn(i,Ft()),null;var c=su(i,a);if(i.tag!==0&&c===2){var p=Uo(i);p!==0&&(a=p,c=_h(i,p))}if(c===1)throw c=kl,lo(i,0),pa(i,a),Yn(i,Ft()),c;if(c===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=a,co(i,Jn,Bi),Yn(i,Ft()),null}function Ih(i,a){var c=mt;mt|=1;try{return i(a)}finally{mt=c,mt===0&&(ds=Ft()+500,Lc&&oa())}}function so(i){da!==null&&da.tag===0&&(mt&6)===0&&hs();var a=mt;mt|=1;var c=Rr.transition,p=dt;try{if(Rr.transition=null,dt=1,i)return i()}finally{dt=p,Rr.transition=c,mt=a,(mt&6)===0&&oa()}}function Oh(){pr=us.current,Lt(us)}function lo(i,a){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,iw(c)),en!==null)for(c=en.return;c!==null;){var p=c;switch(zd(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Mc();break;case 3:ss(),Lt(Zn),Lt(In),eh();break;case 5:Jd(p);break;case 4:ss();break;case 13:Lt(Bt);break;case 19:Lt(Bt);break;case 10:Gd(p.type._context);break;case 22:case 23:Oh()}c=c.return}if(un=i,en=i=fa(i.current,null),yn=pr=a,on=0,kl=null,Th=tu=oo=0,Jn=Cl=null,ro!==null){for(a=0;a<ro.length;a++)if(c=ro[a],p=c.interleaved,p!==null){c.interleaved=null;var b=p.next,w=c.pending;if(w!==null){var P=w.next;w.next=b,p.next=P}c.pending=p}ro=null}return i}function Tg(i,a){do{var c=en;try{if(Wd(),qc.current=Kc,$c){for(var p=zt.memoizedState;p!==null;){var b=p.queue;b!==null&&(b.pending=null),p=p.next}$c=!1}if(ao=0,cn=an=zt=null,ml=!1,gl=0,Sh.current=null,c===null||c.return===null){on=1,kl=a,en=null;break}e:{var w=i,P=c.return,j=c,B=a;if(a=yn,j.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var ie=B,we=j,ke=we.tag;if((we.mode&1)===0&&(ke===0||ke===11||ke===15)){var ye=we.alternate;ye?(we.updateQueue=ye.updateQueue,we.memoizedState=ye.memoizedState,we.lanes=ye.lanes):(we.updateQueue=null,we.memoizedState=null)}var De=Km(P);if(De!==null){De.flags&=-257,Zm(De,P,j,w,a),De.mode&1&&Gm(w,ie,a),a=De,B=ie;var Be=a.updateQueue;if(Be===null){var Ve=new Set;Ve.add(B),a.updateQueue=Ve}else Be.add(B);break e}else{if((a&1)===0){Gm(w,ie,a),Mh();break e}B=Error(t(426))}}else if(Nt&&j.mode&1){var Xt=Km(P);if(Xt!==null){(Xt.flags&65536)===0&&(Xt.flags|=256),Zm(Xt,P,j,w,a),qd(ls(B,j));break e}}w=B=ls(B,j),on!==4&&(on=2),Cl===null?Cl=[w]:Cl.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,a&=-a,w.lanes|=a;var Z=$m(w,B,a);bm(w,Z);break e;case 1:j=B;var H=w.type,X=w.stateNode;if((w.flags&128)===0&&(typeof H.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(ua===null||!ua.has(X)))){w.flags|=65536,a&=-a,w.lanes|=a;var xe=Wm(w,j,a);bm(w,xe);break e}}w=w.return}while(w!==null)}Pg(c)}catch(qe){a=qe,en===c&&c!==null&&(en=c=c.return);continue}break}while(!0)}function xg(){var i=eu.current;return eu.current=Kc,i===null?Kc:i}function Mh(){(on===0||on===3||on===2)&&(on=4),un===null||(oo&268435455)===0&&(tu&268435455)===0||pa(un,yn)}function su(i,a){var c=mt;mt|=2;var p=xg();(un!==i||yn!==a)&&(Bi=null,lo(i,a));do try{Rw();break}catch(b){Tg(i,b)}while(!0);if(Wd(),mt=c,eu.current=p,en!==null)throw Error(t(261));return un=null,yn=0,on}function Rw(){for(;en!==null;)Eg(en)}function Iw(){for(;en!==null&&!Mo();)Eg(en)}function Eg(i){var a=Ig(i.alternate,i,pr);i.memoizedProps=i.pendingProps,a===null?Pg(i):en=a,Sh.current=null}function Pg(i){var a=i;do{var c=a.alternate;if(i=a.return,(a.flags&32768)===0){if(c=Cw(c,a,pr),c!==null){en=c;return}}else{if(c=Sw(c,a),c!==null){c.flags&=32767,en=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{on=6,en=null;return}}if(a=a.sibling,a!==null){en=a;return}en=a=i}while(a!==null);on===0&&(on=5)}function co(i,a,c){var p=dt,b=Rr.transition;try{Rr.transition=null,dt=1,Ow(i,a,c,p)}finally{Rr.transition=b,dt=p}return null}function Ow(i,a,c,p){do hs();while(da!==null);if((mt&6)!==0)throw Error(t(327));c=i.finishedWork;var b=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var w=c.lanes|c.childLanes;if(Na(i,w),i===un&&(en=un=null,yn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||ru||(ru=!0,Og(Ma,function(){return hs(),null})),w=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||w){w=Rr.transition,Rr.transition=null;var P=dt;dt=1;var j=mt;mt|=4,Sh.current=null,xw(i,c),vg(c,i),h(Ad),lr=!!Md,Ad=Md=null,i.current=c,Ew(c),Fs(),mt=j,dt=P,Rr.transition=w}else i.current=c;if(ru&&(ru=!1,da=i,iu=b),w=i.pendingLanes,w===0&&(ua=null),jo(c.stateNode),Yn(i,Ft()),a!==null)for(p=i.onRecoverableError,c=0;c<a.length;c++)b=a[c],p(b.value,{componentStack:b.stack,digest:b.digest});if(nu)throw nu=!1,i=Eh,Eh=null,i;return(iu&1)!==0&&i.tag!==0&&hs(),w=i.pendingLanes,(w&1)!==0?i===Ph?Sl++:(Sl=0,Ph=i):Sl=0,oa(),null}function hs(){if(da!==null){var i=Sr(iu),a=Rr.transition,c=dt;try{if(Rr.transition=null,dt=16>i?16:i,da===null)var p=!1;else{if(i=da,da=null,iu=0,(mt&6)!==0)throw Error(t(331));var b=mt;for(mt|=4,Fe=i.current;Fe!==null;){var w=Fe,P=w.child;if((Fe.flags&16)!==0){var j=w.deletions;if(j!==null){for(var B=0;B<j.length;B++){var ie=j[B];for(Fe=ie;Fe!==null;){var we=Fe;switch(we.tag){case 0:case 11:case 15:wl(8,we,w)}var ke=we.child;if(ke!==null)ke.return=we,Fe=ke;else for(;Fe!==null;){we=Fe;var ye=we.sibling,De=we.return;if(hg(we),we===ie){Fe=null;break}if(ye!==null){ye.return=De,Fe=ye;break}Fe=De}}}var Be=w.alternate;if(Be!==null){var Ve=Be.child;if(Ve!==null){Be.child=null;do{var Xt=Ve.sibling;Ve.sibling=null,Ve=Xt}while(Ve!==null)}}Fe=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,Fe=P;else e:for(;Fe!==null;){if(w=Fe,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:wl(9,w,w.return)}var Z=w.sibling;if(Z!==null){Z.return=w.return,Fe=Z;break e}Fe=w.return}}var H=i.current;for(Fe=H;Fe!==null;){P=Fe;var X=P.child;if((P.subtreeFlags&2064)!==0&&X!==null)X.return=P,Fe=X;else e:for(P=H;Fe!==null;){if(j=Fe,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:Yc(9,j)}}catch(qe){$t(j,j.return,qe)}if(j===P){Fe=null;break e}var xe=j.sibling;if(xe!==null){xe.return=j.return,Fe=xe;break e}Fe=j.return}}if(mt=b,oa(),xn&&typeof xn.onPostCommitFiberRoot=="function")try{xn.onPostCommitFiberRoot(wr,i)}catch{}p=!0}return p}finally{dt=c,Rr.transition=a}}return!1}function _g(i,a,c){a=ls(c,a),a=$m(i,a,1),i=la(i,a,1),a=Bn(),i!==null&&(Tt(i,1,a),Yn(i,a))}function $t(i,a,c){if(i.tag===3)_g(i,i,c);else for(;a!==null;){if(a.tag===3){_g(a,i,c);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(ua===null||!ua.has(p))){i=ls(c,i),i=Wm(a,i,1),a=la(a,i,1),i=Bn(),a!==null&&(Tt(a,1,i),Yn(a,i));break}}a=a.return}}function Mw(i,a,c){var p=i.pingCache;p!==null&&p.delete(a),a=Bn(),i.pingedLanes|=i.suspendedLanes&c,un===i&&(yn&c)===c&&(on===4||on===3&&(yn&130023424)===yn&&500>Ft()-xh?lo(i,0):Th|=c),Yn(i,a)}function Rg(i,a){a===0&&((i.mode&1)===0?a=1:(a=vn,vn<<=1,(vn&130023424)===0&&(vn=4194304)));var c=Bn();i=Di(i,a),i!==null&&(Tt(i,a,c),Yn(i,c))}function Aw(i){var a=i.memoizedState,c=0;a!==null&&(c=a.retryLane),Rg(i,c)}function Lw(i,a){var c=0;switch(i.tag){case 13:var p=i.stateNode,b=i.memoizedState;b!==null&&(c=b.retryLane);break;case 19:p=i.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(a),Rg(i,c)}var Ig;Ig=function(i,a,c){if(i!==null)if(i.memoizedProps!==a.pendingProps||Zn.current)Xn=!0;else{if((i.lanes&c)===0&&(a.flags&128)===0)return Xn=!1,kw(i,a,c);Xn=(i.flags&131072)!==0}else Xn=!1,Nt&&(a.flags&1048576)!==0&&lm(a,jc,a.index);switch(a.lanes=0,a.tag){case 2:var p=a.type;Xc(i,a),i=a.pendingProps;var b=es(a,In.current);os(a,c),b=rh(null,a,p,i,b,c);var w=ih();return a.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Qn(p)?(w=!0,Ac(a)):w=!1,a.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,Qd(a),b.updater=Zc,a.stateNode=b,b._reactInternals=a,uh(a,p,i,c),a=fh(null,a,p,!0,w,c)):(a.tag=0,Nt&&w&&Bd(a),Fn(null,a,b,c),a=a.child),a;case 16:p=a.elementType;e:{switch(Xc(i,a),i=a.pendingProps,b=p._init,p=b(p._payload),a.type=p,b=a.tag=jw(p),i=$r(p,i),b){case 0:a=ph(null,a,p,i,c);break e;case 1:a=tg(null,a,p,i,c);break e;case 11:a=Qm(null,a,p,i,c);break e;case 14:a=Xm(null,a,p,$r(p.type,i),c);break e}throw Error(t(306,p,""))}return a;case 0:return p=a.type,b=a.pendingProps,b=a.elementType===p?b:$r(p,b),ph(i,a,p,b,c);case 1:return p=a.type,b=a.pendingProps,b=a.elementType===p?b:$r(p,b),tg(i,a,p,b,c);case 3:e:{if(ng(a),i===null)throw Error(t(387));p=a.pendingProps,w=a.memoizedState,b=w.element,vm(i,a),Vc(a,p,null,c);var P=a.memoizedState;if(p=P.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},a.updateQueue.baseState=w,a.memoizedState=w,a.flags&256){b=ls(Error(t(423)),a),a=rg(i,a,p,c,b);break e}else if(p!==b){b=ls(Error(t(424)),a),a=rg(i,a,p,c,b);break e}else for(hr=ra(a.stateNode.containerInfo.firstChild),dr=a,Nt=!0,qr=null,c=mm(a,null,p,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(rs(),p===b){a=Fi(i,a,c);break e}Fn(i,a,p,c)}a=a.child}return a;case 5:return wm(a),i===null&&Hd(a),p=a.type,b=a.pendingProps,w=i!==null?i.memoizedProps:null,P=b.children,Ld(p,b)?P=null:w!==null&&Ld(p,w)&&(a.flags|=32),eg(i,a),Fn(i,a,P,c),a.child;case 6:return i===null&&Hd(a),null;case 13:return ig(i,a,c);case 4:return Xd(a,a.stateNode.containerInfo),p=a.pendingProps,i===null?a.child=is(a,null,p,c):Fn(i,a,p,c),a.child;case 11:return p=a.type,b=a.pendingProps,b=a.elementType===p?b:$r(p,b),Qm(i,a,p,b,c);case 7:return Fn(i,a,a.pendingProps,c),a.child;case 8:return Fn(i,a,a.pendingProps.children,c),a.child;case 12:return Fn(i,a,a.pendingProps.children,c),a.child;case 10:e:{if(p=a.type._context,b=a.pendingProps,w=a.memoizedProps,P=b.value,It(Fc,p._currentValue),p._currentValue=P,w!==null)if(Kn(w.value,P)){if(w.children===b.children&&!Zn.current){a=Fi(i,a,c);break e}}else for(w=a.child,w!==null&&(w.return=a);w!==null;){var j=w.dependencies;if(j!==null){P=w.child;for(var B=j.firstContext;B!==null;){if(B.context===p){if(w.tag===1){B=Ui(-1,c&-c),B.tag=2;var ie=w.updateQueue;if(ie!==null){ie=ie.shared;var we=ie.pending;we===null?B.next=B:(B.next=we.next,we.next=B),ie.pending=B}}w.lanes|=c,B=w.alternate,B!==null&&(B.lanes|=c),Kd(w.return,c,a),j.lanes|=c;break}B=B.next}}else if(w.tag===10)P=w.type===a.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(t(341));P.lanes|=c,j=P.alternate,j!==null&&(j.lanes|=c),Kd(P,c,a),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===a){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}Fn(i,a,b.children,c),a=a.child}return a;case 9:return b=a.type,p=a.pendingProps.children,os(a,c),b=Pr(b),p=p(b),a.flags|=1,Fn(i,a,p,c),a.child;case 14:return p=a.type,b=$r(p,a.pendingProps),b=$r(p.type,b),Xm(i,a,p,b,c);case 15:return Jm(i,a,a.type,a.pendingProps,c);case 17:return p=a.type,b=a.pendingProps,b=a.elementType===p?b:$r(p,b),Xc(i,a),a.tag=1,Qn(p)?(i=!0,Ac(a)):i=!1,os(a,c),Hm(a,p,b),uh(a,p,b,c),fh(null,a,p,!0,i,c);case 19:return og(i,a,c);case 22:return Ym(i,a,c)}throw Error(t(156,a.tag))};function Og(i,a){return Us(i,a)}function Nw(i,a,c,p){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(i,a,c,p){return new Nw(i,a,c,p)}function Ah(i){return i=i.prototype,!(!i||!i.isReactComponent)}function jw(i){if(typeof i=="function")return Ah(i)?1:0;if(i!=null){if(i=i.$$typeof,i===me)return 11;if(i===pe)return 14}return 2}function fa(i,a){var c=i.alternate;return c===null?(c=Ir(i.tag,a,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=a,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,a=i.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function lu(i,a,c,p,b,w){var P=2;if(p=i,typeof i=="function")Ah(i)&&(P=1);else if(typeof i=="string")P=5;else e:switch(i){case de:return uo(c.children,b,w,a);case te:P=8,b|=8;break;case K:return i=Ir(12,c,a,b|2),i.elementType=K,i.lanes=w,i;case Le:return i=Ir(13,c,a,b),i.elementType=Le,i.lanes=w,i;case le:return i=Ir(19,c,a,b),i.elementType=le,i.lanes=w,i;case Ee:return cu(c,b,w,a);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ne:P=10;break e;case Y:P=9;break e;case me:P=11;break e;case pe:P=14;break e;case Oe:P=16,p=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return a=Ir(P,c,a,b),a.elementType=i,a.type=p,a.lanes=w,a}function uo(i,a,c,p){return i=Ir(7,i,p,a),i.lanes=c,i}function cu(i,a,c,p){return i=Ir(22,i,p,a),i.elementType=Ee,i.lanes=c,i.stateNode={isHidden:!1},i}function Lh(i,a,c){return i=Ir(6,i,null,a),i.lanes=c,i}function Nh(i,a,c){return a=Ir(4,i.children!==null?i.children:[],i.key,a),a.lanes=c,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}function Dw(i,a,c,p,b){this.tag=a,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fo(0),this.expirationTimes=Fo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fo(0),this.identifierPrefix=p,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function jh(i,a,c,p,b,w,P,j,B){return i=new Dw(i,a,c,j,B),a===1?(a=1,w===!0&&(a|=8)):a=0,w=Ir(3,null,null,a),i.current=w,w.stateNode=i,w.memoizedState={element:p,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qd(w),i}function Uw(i,a,c){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:J,key:p==null?null:""+p,children:i,containerInfo:a,implementation:c}}function Mg(i){if(!i)return aa;i=i._reactInternals;e:{if(ii(i)!==i||i.tag!==1)throw Error(t(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Qn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(i.tag===1){var c=i.type;if(Qn(c))return am(i,c,a)}return a}function Ag(i,a,c,p,b,w,P,j,B){return i=jh(c,p,!0,i,b,w,P,j,B),i.context=Mg(null),c=i.current,p=Bn(),b=ha(c),w=Ui(p,b),w.callback=a??null,la(c,w,b),i.current.lanes=b,Tt(i,b,p),Yn(i,p),i}function uu(i,a,c,p){var b=a.current,w=Bn(),P=ha(b);return c=Mg(c),a.context===null?a.context=c:a.pendingContext=c,a=Ui(w,P),a.payload={element:i},p=p===void 0?null:p,p!==null&&(a.callback=p),i=la(b,a,P),i!==null&&(Kr(i,b,P,w),zc(i,b,P)),P}function du(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Lg(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<a?c:a}}function Dh(i,a){Lg(i,a),(i=i.alternate)&&Lg(i,a)}function Fw(){return null}var Ng=typeof reportError=="function"?reportError:function(i){console.error(i)};function Uh(i){this._internalRoot=i}hu.prototype.render=Uh.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(t(409));uu(i,a,null,null)},hu.prototype.unmount=Uh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;so(function(){uu(null,i,null,null)}),a[Ai]=null}};function hu(i){this._internalRoot=i}hu.prototype.unstable_scheduleHydration=function(i){if(i){var a=Zi();i={blockedOn:null,target:i,priority:a};for(var c=0;c<sr.length&&a!==0&&a<sr[c].priority;c++);sr.splice(c,0,i),c===0&&Pi(i)}};function Fh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function pu(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function jg(){}function Bw(i,a,c,p,b){if(b){if(typeof p=="function"){var w=p;p=function(){var ie=du(P);w.call(ie)}}var P=Ag(a,p,i,0,null,!1,!1,"",jg);return i._reactRootContainer=P,i[Ai]=P.current,sl(i.nodeType===8?i.parentNode:i),so(),P}for(;b=i.lastChild;)i.removeChild(b);if(typeof p=="function"){var j=p;p=function(){var ie=du(B);j.call(ie)}}var B=jh(i,0,!1,null,null,!1,!1,"",jg);return i._reactRootContainer=B,i[Ai]=B.current,sl(i.nodeType===8?i.parentNode:i),so(function(){uu(a,B,c,p)}),B}function fu(i,a,c,p,b){var w=c._reactRootContainer;if(w){var P=w;if(typeof b=="function"){var j=b;b=function(){var B=du(P);j.call(B)}}uu(a,P,i,b)}else P=Bw(c,a,i,b,p);return du(P)}Bo=function(i){switch(i.tag){case 3:var a=i.stateNode;if(a.current.memoizedState.isDehydrated){var c=kr(a.pendingLanes);c!==0&&(ja(a,c|1),Yn(a,Ft()),(mt&6)===0&&(ds=Ft()+500,oa()))}break;case 13:so(function(){var p=Di(i,1);if(p!==null){var b=Bn();Kr(p,i,1,b)}}),Dh(i,1)}},Ur=function(i){if(i.tag===13){var a=Di(i,134217728);if(a!==null){var c=Bn();Kr(a,i,134217728,c)}Dh(i,134217728)}},Vs=function(i){if(i.tag===13){var a=ha(i),c=Di(i,a);if(c!==null){var p=Bn();Kr(c,i,a,p)}Dh(i,a)}},Zi=function(){return dt},Da=function(i,a){var c=dt;try{return dt=i,a()}finally{dt=c}},mn=function(i,a,c){switch(a){case"input":if(Ti(i,c),a=c.name,c.type==="radio"&&a!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<c.length;a++){var p=c[a];if(p!==i&&p.form===i.form){var b=Oc(p);if(!b)throw Error(t(90));$n(p),Ti(p,b)}}}break;case"textarea":_(i,c);break;case"select":a=c.value,a!=null&&Nn(i,!!c.multiple,a,!1)}},Dn=Ih,ut=so;var zw={usingClientEntryPoint:!1,Events:[ul,Jo,Oc,Je,yr,Ih]},Tl={findFiberByHostInstance:Ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Vw={bundleType:Tl.bundleType,version:Tl.version,rendererPackageName:Tl.rendererPackageName,rendererConfig:Tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=uc(i),i===null?null:i.stateNode},findFiberByHostInstance:Tl.findFiberByHostInstance||Fw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mu.isDisabled&&mu.supportsFiber)try{wr=mu.inject(Vw),xn=mu}catch{}}return er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zw,er.createPortal=function(i,a){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fh(a))throw Error(t(200));return Uw(i,a,null,c)},er.createRoot=function(i,a){if(!Fh(i))throw Error(t(299));var c=!1,p="",b=Ng;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(b=a.onRecoverableError)),a=jh(i,1,!1,null,null,c,!1,p,b),i[Ai]=a.current,sl(i.nodeType===8?i.parentNode:i),new Uh(a)},er.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=uc(a),i=i===null?null:i.stateNode,i},er.flushSync=function(i){return so(i)},er.hydrate=function(i,a,c){if(!pu(a))throw Error(t(200));return fu(null,i,a,!0,c)},er.hydrateRoot=function(i,a,c){if(!Fh(i))throw Error(t(405));var p=c!=null&&c.hydratedSources||null,b=!1,w="",P=Ng;if(c!=null&&(c.unstable_strictMode===!0&&(b=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onRecoverableError!==void 0&&(P=c.onRecoverableError)),a=Ag(a,null,i,1,c??null,b,!1,w,P),i[Ai]=a.current,sl(i),p)for(i=0;i<p.length;i++)c=p[i],b=c._getVersion,b=b(c._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[c,b]:a.mutableSourceEagerHydrationData.push(c,b);return new hu(a)},er.render=function(i,a,c){if(!pu(a))throw Error(t(200));return fu(null,i,a,!1,c)},er.unmountComponentAtNode=function(i){if(!pu(i))throw Error(t(40));return i._reactRootContainer?(so(function(){fu(null,null,i,!1,function(){i._reactRootContainer=null,i[Ai]=null})}),!0):!1},er.unstable_batchedUpdates=Ih,er.unstable_renderSubtreeIntoContainer=function(i,a,c,p){if(!pu(c))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return fu(i,a,c,!1,p)},er.version="18.3.1-next-f1338f8080-20240426",er}var Qg;function Jw(){if(Qg)return Bh.exports;Qg=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Bh.exports=Xw(),Bh.exports}var Xg;function Yw(){if(Xg)return gu;Xg=1;var n=Jw();return gu.createRoot=n.createRoot,gu.hydrateRoot=n.hydrateRoot,gu}var ek=Yw(),Yb=function(n,e,t,r){var o;e[0]=0;for(var s=1;s<e.length;s++){var l=e[s++],d=e[s]?(e[0]|=l?1:2,t[e[s++]]):e[++s];l===3?r[0]=d:l===4?r[1]=Object.assign(r[1]||{},d):l===5?(r[1]=r[1]||{})[e[++s]]=d:l===6?r[1][e[++s]]+=d+"":l?(o=n.apply(d,Yb(n,d,t,["",null])),r.push(o),d[0]?e[0]|=2:(e[s-2]=0,e[s]=o)):r.push(d)}return r},Jg=new Map;function tk(n){var e=Jg.get(this);return e||(e=new Map,Jg.set(this,e)),(e=Yb(this,e.get(n)||(e.set(n,e=function(t){for(var r,o,s=1,l="",d="",f=[0],m=function(x){s===1&&(x||(l=l.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?f.push(0,x,l):s===3&&(x||l)?(f.push(3,x,l),s=2):s===2&&l==="..."&&x?f.push(4,x,0):s===2&&l&&!x?f.push(5,0,!0,l):s>=5&&((l||!x&&s===5)&&(f.push(s,0,l,o),s=6),x&&(f.push(s,x,0,o),s=6)),l=""},v=0;v<t.length;v++){v&&(s===1&&m(),m(v));for(var T=0;T<t[v].length;T++)r=t[v][T],s===1?r==="<"?(m(),f=[f],s=3):l+=r:s===4?l==="--"&&r===">"?(s=1,l=""):l=r+l[0]:d?r===d?d="":l+=r:r==='"'||r==="'"?d=r:r===">"?(m(),s=1):s&&(r==="="?(s=5,o=l,l=""):r==="/"&&(s<5||t[v][T+1]===">")?(m(),s===3&&(f=f[0]),s=f,(f=f[0]).push(2,0,s),s=0):r===" "||r==="	"||r===`
`||r==="\r"?(m(),s=2):l+=r),s===3&&l==="!--"&&(s=4,f=f[0])}return m(),f}(n)),e),arguments,[])).length>1?e:e[0]}function ys(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function Ss(n){return function e(t){return arguments.length===0||ys(t)?e:n.apply(this,arguments)}}function pf(n){return function e(t,r){switch(arguments.length){case 0:return e;case 1:return ys(t)?e:Ss(function(o){return n(t,o)});default:return ys(t)&&ys(r)?e:ys(t)?Ss(function(o){return n(o,r)}):ys(r)?Ss(function(o){return n(t,o)}):n(t,r)}}}const nk=Array.isArray||function(n){return n!=null&&n.length>=0&&Object.prototype.toString.call(n)==="[object Array]"};function rk(n){return n!=null&&typeof n["@@transducer/step"]=="function"}function ey(n,e,t){return function(){if(arguments.length===0)return t();var r=arguments[arguments.length-1];if(!nk(r)){for(var o=0;o<n.length;){if(typeof r[n[o]]=="function")return r[n[o]].apply(r,Array.prototype.slice.call(arguments,0,-1));o+=1}if(rk(r)){var s=e.apply(null,Array.prototype.slice.call(arguments,0,-1));return s(r)}}return t.apply(this,arguments)}}const hp={init:function(){return this.xf["@@transducer/init"]()},result:function(n){return this.xf["@@transducer/result"](n)}};function Yg(n){for(var e=[],t;!(t=n.next()).done;)e.push(t.value);return e}function ev(n,e,t){for(var r=0,o=t.length;r<o;){if(n(e,t[r]))return!0;r+=1}return!1}function ik(n){var e=String(n).match(/^function (\w*)/);return e==null?"":e[1]}function Gu(n,e){return Object.prototype.hasOwnProperty.call(e,n)}function ak(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}const zh=typeof Object.is=="function"?Object.is:ak;var tv=Object.prototype.toString,ok=function(){return tv.call(arguments)==="[object Arguments]"?function(n){return tv.call(n)==="[object Arguments]"}:function(n){return Gu("callee",n)}}(),sk=!{toString:null}.propertyIsEnumerable("toString"),nv=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],rv=function(){return arguments.propertyIsEnumerable("length")}(),lk=function(n,e){for(var t=0;t<n.length;){if(n[t]===e)return!0;t+=1}return!1},iv=Ss(typeof Object.keys=="function"&&!rv?function(n){return Object(n)!==n?[]:Object.keys(n)}:function(n){if(Object(n)!==n)return[];var e,t,r=[],o=rv&&ok(n);for(e in n)Gu(e,n)&&(!o||e!=="length")&&(r[r.length]=e);if(sk)for(t=nv.length-1;t>=0;)e=nv[t],Gu(e,n)&&!lk(r,e)&&(r[r.length]=e),t-=1;return r}),av=Ss(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)});function ov(n,e,t,r){var o=Yg(n),s=Yg(e);function l(d,f){return ff(d,f,t.slice(),r.slice())}return!ev(function(d,f){return!ev(l,f,d)},s,o)}function ff(n,e,t,r){if(zh(n,e))return!0;var o=av(n);if(o!==av(e))return!1;if(typeof n["fantasy-land/equals"]=="function"||typeof e["fantasy-land/equals"]=="function")return typeof n["fantasy-land/equals"]=="function"&&n["fantasy-land/equals"](e)&&typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](n);if(typeof n.equals=="function"||typeof e.equals=="function")return typeof n.equals=="function"&&n.equals(e)&&typeof e.equals=="function"&&e.equals(n);switch(o){case"Arguments":case"Array":case"Object":if(typeof n.constructor=="function"&&ik(n.constructor)==="Promise")return n===e;break;case"Boolean":case"Number":case"String":if(!(typeof n==typeof e&&zh(n.valueOf(),e.valueOf())))return!1;break;case"Date":if(!zh(n.valueOf(),e.valueOf()))return!1;break;case"Error":return n.name===e.name&&n.message===e.message;case"RegExp":if(!(n.source===e.source&&n.global===e.global&&n.ignoreCase===e.ignoreCase&&n.multiline===e.multiline&&n.sticky===e.sticky&&n.unicode===e.unicode))return!1;break}for(var s=t.length-1;s>=0;){if(t[s]===n)return r[s]===e;s-=1}switch(o){case"Map":return n.size!==e.size?!1:ov(n.entries(),e.entries(),t.concat([n]),r.concat([e]));case"Set":return n.size!==e.size?!1:ov(n.values(),e.values(),t.concat([n]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var l=iv(n);if(l.length!==iv(e).length)return!1;var d=t.concat([n]),f=r.concat([e]);for(s=l.length-1;s>=0;){var m=l[s];if(!(Gu(m,e)&&ff(e[m],n[m],d,f)))return!1;s-=1}return!0}var mf=pf(function(n,e){return ff(n,e,[],[])});function ck(n,e,t){var r,o;if(typeof n.indexOf=="function")switch(typeof e){case"number":if(e===0){for(r=1/e;t<n.length;){if(o=n[t],o===0&&1/o===r)return t;t+=1}return-1}else if(e!==e){for(;t<n.length;){if(o=n[t],typeof o=="number"&&o!==o)return t;t+=1}return-1}return n.indexOf(e,t);case"string":case"boolean":case"function":case"undefined":return n.indexOf(e,t);case"object":if(e===null)return n.indexOf(e,t)}for(;t<n.length;){if(mf(n[t],e))return t;t+=1}return-1}function sv(n,e){return ck(e,n,0)>=0}function uk(n){return n}var dk=Ss(uk),ty=function(){function n(){this._nativeSet=typeof Set=="function"?new Set:null,this._items={}}return n.prototype.add=function(e){return!lv(e,!0,this)},n.prototype.has=function(e){return lv(e,!1,this)},n}();function lv(n,e,t){var r=typeof n,o,s;switch(r){case"string":case"number":return n===0&&1/n===-1/0?t._items["-0"]?!0:(e&&(t._items["-0"]=!0),!1):t._nativeSet!==null?e?(o=t._nativeSet.size,t._nativeSet.add(n),s=t._nativeSet.size,s===o):t._nativeSet.has(n):r in t._items?n in t._items[r]?!0:(e&&(t._items[r][n]=!0),!1):(e&&(t._items[r]={},t._items[r][n]=!0),!1);case"boolean":if(r in t._items){var l=n?1:0;return t._items[r][l]?!0:(e&&(t._items[r][l]=!0),!1)}else return e&&(t._items[r]=n?[!1,!0]:[!0,!1]),!1;case"function":return t._nativeSet!==null?e?(o=t._nativeSet.size,t._nativeSet.add(n),s=t._nativeSet.size,s===o):t._nativeSet.has(n):r in t._items?sv(n,t._items[r])?!0:(e&&t._items[r].push(n),!1):(e&&(t._items[r]=[n]),!1);case"undefined":return t._items[r]?!0:(e&&(t._items[r]=!0),!1);case"object":if(n===null)return t._items.null?!0:(e&&(t._items.null=!0),!1);default:return r=Object.prototype.toString.call(n),r in t._items?sv(n,t._items[r])?!0:(e&&t._items[r].push(n),!1):(e&&(t._items[r]=[n]),!1)}}var hk=function(){function n(e,t){this.xf=t,this.f=e,this.idx=-1,this.lastIdx=-1}return n.prototype["@@transducer/init"]=hp.init,n.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](e,this.lastIdx))},n.prototype["@@transducer/step"]=function(e,t){return this.idx+=1,this.f(t)&&(this.lastIdx=this.idx),e},n}();function pk(n){return function(e){return new hk(n,e)}}var cv=pf(ey([],pk,function(n,e){for(var t=e.length-1;t>=0;){if(n(e[t]))return t;t-=1}return-1})),fk=function(){function n(e,t){this.xf=t,this.f=e,this.set=new ty}return n.prototype["@@transducer/init"]=hp.init,n.prototype["@@transducer/result"]=hp.result,n.prototype["@@transducer/step"]=function(e,t){return this.set.add(this.f(t))?this.xf["@@transducer/step"](e,t):e},n}();function mk(n){return function(e){return new fk(n,e)}}var gk=pf(ey([],mk,function(n,e){for(var t=new ty,r=[],o=0,s,l;o<e.length;)l=e[o],s=n(l),t.add(s)&&r.push(l),o+=1;return r})),vk=gk(dk);const bk="1.1.8-alpha.4",yk={version:bk};var kn=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},Vn={searchParams:"URLSearchParams"in kn,iterable:"Symbol"in kn&&"iterator"in Symbol,blob:"FileReader"in kn&&"Blob"in kn&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in kn,arrayBuffer:"ArrayBuffer"in kn};function wk(n){return n&&DataView.prototype.isPrototypeOf(n)}if(Vn.arrayBuffer)var kk=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Ck=ArrayBuffer.isView||function(n){return n&&kk.indexOf(Object.prototype.toString.call(n))>-1};function Ls(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(n)||n==="")throw new TypeError('Invalid character in header field name: "'+n+'"');return n.toLowerCase()}function gf(n){return typeof n!="string"&&(n=String(n)),n}function vf(n){var e={next:function(){var t=n.shift();return{done:t===void 0,value:t}}};return Vn.iterable&&(e[Symbol.iterator]=function(){return e}),e}function ln(n){this.map={},n instanceof ln?n.forEach(function(e,t){this.append(t,e)},this):Array.isArray(n)?n.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(e){this.append(e,n[e])},this)}ln.prototype.append=function(n,e){n=Ls(n),e=gf(e);var t=this.map[n];this.map[n]=t?t+", "+e:e};ln.prototype.delete=function(n){delete this.map[Ls(n)]};ln.prototype.get=function(n){return n=Ls(n),this.has(n)?this.map[n]:null};ln.prototype.has=function(n){return this.map.hasOwnProperty(Ls(n))};ln.prototype.set=function(n,e){this.map[Ls(n)]=gf(e)};ln.prototype.forEach=function(n,e){for(var t in this.map)this.map.hasOwnProperty(t)&&n.call(e,this.map[t],t,this)};ln.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),vf(n)};ln.prototype.values=function(){var n=[];return this.forEach(function(e){n.push(e)}),vf(n)};ln.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),vf(n)};Vn.iterable&&(ln.prototype[Symbol.iterator]=ln.prototype.entries);function Vh(n){if(!n._noBody){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}}function ny(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function Sk(n){var e=new FileReader,t=ny(e);return e.readAsArrayBuffer(n),t}function Tk(n){var e=new FileReader,t=ny(e),r=/charset=([A-Za-z0-9_-]+)/.exec(n.type),o=r?r[1]:"utf-8";return e.readAsText(n,o),t}function xk(n){for(var e=new Uint8Array(n),t=new Array(e.length),r=0;r<e.length;r++)t[r]=String.fromCharCode(e[r]);return t.join("")}function uv(n){if(n.slice)return n.slice(0);var e=new Uint8Array(n.byteLength);return e.set(new Uint8Array(n)),e.buffer}function ry(){return this.bodyUsed=!1,this._initBody=function(n){this.bodyUsed=this.bodyUsed,this._bodyInit=n,n?typeof n=="string"?this._bodyText=n:Vn.blob&&Blob.prototype.isPrototypeOf(n)?this._bodyBlob=n:Vn.formData&&FormData.prototype.isPrototypeOf(n)?this._bodyFormData=n:Vn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)?this._bodyText=n.toString():Vn.arrayBuffer&&Vn.blob&&wk(n)?(this._bodyArrayBuffer=uv(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Vn.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||Ck(n))?this._bodyArrayBuffer=uv(n):this._bodyText=n=Object.prototype.toString.call(n):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Vn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Vn.blob&&(this.blob=function(){var n=Vh(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var n=Vh(this);return n||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(Vn.blob)return this.blob().then(Sk);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var n=Vh(this);if(n)return n;if(this._bodyBlob)return Tk(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(xk(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Vn.formData&&(this.formData=function(){return this.text().then(_k)}),this.json=function(){return this.text().then(JSON.parse)},this}var Ek=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Pk(n){var e=n.toUpperCase();return Ek.indexOf(e)>-1?e:n}function wo(n,e){if(!(this instanceof wo))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var t=e.body;if(n instanceof wo){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url,this.credentials=n.credentials,e.headers||(this.headers=new ln(n.headers)),this.method=n.method,this.mode=n.mode,this.signal=n.signal,!t&&n._bodyInit!=null&&(t=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new ln(e.headers)),this.method=Pk(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in kn){var s=new AbortController;return s.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&t)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(t),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var o=/\?/;this.url+=(o.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}wo.prototype.clone=function(){return new wo(this,{body:this._bodyInit})};function _k(n){var e=new FormData;return n.trim().split("&").forEach(function(t){if(t){var r=t.split("="),o=r.shift().replace(/\+/g," "),s=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(s))}}),e}function Rk(n){var e=new ln,t=n.replace(/\r?\n[\t ]+/g," ");return t.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var o=r.split(":"),s=o.shift().trim();if(s){var l=o.join(":").trim();try{e.append(s,l)}catch(d){console.warn("Response "+d.message)}}}),e}ry.call(wo.prototype);function ki(n,e){if(!(this instanceof ki))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new ln(e.headers),this.url=e.url||"",this._initBody(n)}ry.call(ki.prototype);ki.prototype.clone=function(){return new ki(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new ln(this.headers),url:this.url})};ki.error=function(){var n=new ki(null,{status:200,statusText:""});return n.ok=!1,n.status=0,n.type="error",n};var Ik=[301,302,303,307,308];ki.redirect=function(n,e){if(Ik.indexOf(e)===-1)throw new RangeError("Invalid status code");return new ki(null,{status:e,headers:{location:n}})};var mo=kn.DOMException;try{new mo}catch{mo=function(n,e){this.message=n,this.name=e;var t=Error(n);this.stack=t.stack},mo.prototype=Object.create(Error.prototype),mo.prototype.constructor=mo}function iy(n,e){return new Promise(function(t,r){var o=new wo(n,e);if(o.signal&&o.signal.aborted)return r(new mo("Aborted","AbortError"));var s=new XMLHttpRequest;function l(){s.abort()}s.onload=function(){var m={statusText:s.statusText,headers:Rk(s.getAllResponseHeaders()||"")};o.url.indexOf("file://")===0&&(s.status<200||s.status>599)?m.status=200:m.status=s.status,m.url="responseURL"in s?s.responseURL:m.headers.get("X-Request-URL");var v="response"in s?s.response:s.responseText;setTimeout(function(){t(new ki(v,m))},0)},s.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},s.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},s.onabort=function(){setTimeout(function(){r(new mo("Aborted","AbortError"))},0)};function d(m){try{return m===""&&kn.location.href?kn.location.href:m}catch{return m}}if(s.open(o.method,d(o.url),!0),o.credentials==="include"?s.withCredentials=!0:o.credentials==="omit"&&(s.withCredentials=!1),"responseType"in s&&(Vn.blob?s.responseType="blob":Vn.arrayBuffer&&(s.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof ln||kn.Headers&&e.headers instanceof kn.Headers)){var f=[];Object.getOwnPropertyNames(e.headers).forEach(function(m){f.push(Ls(m)),s.setRequestHeader(m,gf(e.headers[m]))}),o.headers.forEach(function(m,v){f.indexOf(v)===-1&&s.setRequestHeader(v,m)})}else o.headers.forEach(function(m,v){s.setRequestHeader(v,m)});o.signal&&(o.signal.addEventListener("abort",l),s.onreadystatechange=function(){s.readyState===4&&o.signal.removeEventListener("abort",l)}),s.send(typeof o._bodyInit>"u"?null:o._bodyInit)})}iy.polyfill=!0;kn.fetch||(kn.fetch=iy,kn.Headers=ln,kn.Request=wo,kn.Response=ki);var dv,hv;function Ok(){return hv||(hv=1,dv=self.fetch.bind(self)),dv}var Mk=Ok();const Hh=Jb(Mk);function Vt(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function go(n){return function e(t){return arguments.length===0||Vt(t)?e:n.apply(this,arguments)}}function ps(n){return function e(t,r){switch(arguments.length){case 0:return e;case 1:return Vt(t)?e:go(function(o){return n(t,o)});default:return Vt(t)&&Vt(r)?e:Vt(t)?go(function(o){return n(o,r)}):Vt(r)?go(function(o){return n(t,o)}):n(t,r)}}}function Ak(n,e){n=n||[],e=e||[];var t,r=n.length,o=e.length,s=[];for(t=0;t<r;)s[s.length]=n[t],t+=1;for(t=0;t<o;)s[s.length]=e[t],t+=1;return s}function Lk(n){return function e(t,r,o){switch(arguments.length){case 0:return e;case 1:return Vt(t)?e:ps(function(s,l){return n(t,s,l)});case 2:return Vt(t)&&Vt(r)?e:Vt(t)?ps(function(s,l){return n(s,r,l)}):Vt(r)?ps(function(s,l){return n(t,s,l)}):go(function(s){return n(t,r,s)});default:return Vt(t)&&Vt(r)&&Vt(o)?e:Vt(t)&&Vt(r)?ps(function(s,l){return n(s,l,o)}):Vt(t)&&Vt(o)?ps(function(s,l){return n(s,r,l)}):Vt(r)&&Vt(o)?ps(function(s,l){return n(t,s,l)}):Vt(t)?go(function(s){return n(s,r,o)}):Vt(r)?go(function(s){return n(t,s,o)}):Vt(o)?go(function(s){return n(t,r,s)}):n(t,r,o)}}}var pv=Lk(function(n,e,t){var r=t.length;if(n>=r||n<-r)return t;var o=(r+n)%r,s=Ak(t);return s[o]=e(t[o]),s});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var pp=function(n,e){return pp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])},pp(n,e)};function ay(n,e){pp(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Nk(n){var e=typeof Symbol=="function"&&n[Symbol.iterator],t=0;return e?e.call(n):{next:function(){return n&&t>=n.length&&(n=void 0),{value:n&&n[t++],done:!n}}}}function jk(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],l;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(d){l={error:d}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(l)throw l.error}}return s}function Dk(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(jk(arguments[e]));return n}var oy=function(){function n(e,t){this.target=t,this.type=e}return n}(),Uk=function(n){ay(e,n);function e(t,r){var o=n.call(this,"error",r)||this;return o.message=t.message,o.error=t,o}return e}(oy),Fk=function(n){ay(e,n);function e(t,r,o){t===void 0&&(t=1e3),r===void 0&&(r="");var s=n.call(this,"close",o)||this;return s.wasClean=!0,s.code=t,s.reason=r,s}return e}(oy);/*!
 * Reconnecting WebSocket
 * by Pedro Ladaria <pedro.ladaria@gmail.com>
 * https://github.com/pladaria/reconnecting-websocket
 * License MIT
 */var Bk=function(){if(typeof WebSocket<"u")return WebSocket},zk=function(n){return typeof n<"u"&&!!n&&n.CLOSING===2},ho={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+Math.random()*4e3,minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},qh=function(){function n(e,t,r){var o=this;r===void 0&&(r={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(s){o._debug("open event");var l=o._options.minUptime,d=l===void 0?ho.minUptime:l;clearTimeout(o._connectTimeout),o._uptimeTimeout=setTimeout(function(){return o._acceptOpen()},d),o._ws.binaryType=o._binaryType,o._messageQueue.forEach(function(f){return o._ws.send(f)}),o._messageQueue=[],o.onopen&&o.onopen(s),o._listeners.open.forEach(function(f){return o._callEventListener(s,f)})},this._handleMessage=function(s){o._debug("message event"),o.onmessage&&o.onmessage(s),o._listeners.message.forEach(function(l){return o._callEventListener(s,l)})},this._handleError=function(s){o._debug("error event",s.message),o._disconnect(void 0,s.message==="TIMEOUT"?"timeout":void 0),o.onerror&&o.onerror(s),o._debug("exec error listeners"),o._listeners.error.forEach(function(l){return o._callEventListener(s,l)}),o._connect()},this._handleClose=function(s){o._debug("close event"),o._clearTimeouts(),o._shouldReconnect&&o._connect(),o.onclose&&o.onclose(s),o._listeners.close.forEach(function(l){return o._callEventListener(s,l)})},this._url=e,this._protocols=t,this._options=r,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(n,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CONNECTING",{get:function(){return n.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OPEN",{get:function(){return n.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CLOSING",{get:function(){return n.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CLOSED",{get:function(){return n.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bufferedAmount",{get:function(){var e=this._messageQueue.reduce(function(t,r){return typeof r=="string"?t+=r.length:r instanceof Blob?t+=r.size:t+=r.byteLength,t},0);return e+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?n.CLOSED:n.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),n.prototype.close=function(e,t){if(e===void 0&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(e,t)},n.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,!this._ws||this._ws.readyState===this.CLOSED?this._connect():(this._disconnect(e,t),this._connect())},n.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,r=t===void 0?ho.maxEnqueuedMessages:t;this._messageQueue.length<r&&(this._debug("enqueue",e),this._messageQueue.push(e))}},n.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},n.prototype.dispatchEvent=function(e){var t,r,o=this._listeners[e.type];if(o)try{for(var s=Nk(o),l=s.next();!l.done;l=s.next()){var d=l.value;this._callEventListener(e,d)}}catch(f){t={error:f}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return!0},n.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(r){return r!==t}))},n.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,Dk(["RWS>"],e))},n.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,r=t===void 0?ho.reconnectionDelayGrowFactor:t,o=e.minReconnectionDelay,s=o===void 0?ho.minReconnectionDelay:o,l=e.maxReconnectionDelay,d=l===void 0?ho.maxReconnectionDelay:l,f=0;return this._retryCount>0&&(f=s*Math.pow(r,this._retryCount-1),f>d&&(f=d)),this._debug("next delay",f),f},n.prototype._wait=function(){var e=this;return new Promise(function(t){setTimeout(t,e._getNextDelay())})},n.prototype._getNextUrl=function(e){if(typeof e=="string")return Promise.resolve(e);if(typeof e=="function"){var t=e();if(typeof t=="string")return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},n.prototype._connect=function(){var e=this;if(!(this._connectLock||!this._shouldReconnect)){this._connectLock=!0;var t=this._options,r=t.maxRetries,o=r===void 0?ho.maxRetries:r,s=t.connectionTimeout,l=s===void 0?ho.connectionTimeout:s,d=t.WebSocket,f=d===void 0?Bk():d;if(this._retryCount>=o){this._debug("max retries reached",this._retryCount,">=",o);return}if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!zk(f))throw Error("No valid WebSocket class provided");this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(m){e._closeCalled||(e._debug("connect",{url:m,protocols:e._protocols}),e._ws=e._protocols?new f(m,e._protocols):new f(m),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},l))})}},n.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new Uk(Error("TIMEOUT"),this))},n.prototype._disconnect=function(e,t){if(e===void 0&&(e=1e3),this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new Fk(e,t,this))}catch{}}},n.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},n.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},n.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},n.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},n.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},n}();let vu;const Vk=new Uint8Array(16);function Hk(){if(!vu&&(vu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vu(Vk)}const wn=[];for(let n=0;n<256;++n)wn.push((n+256).toString(16).slice(1));function qk(n,e=0){return wn[n[e+0]]+wn[n[e+1]]+wn[n[e+2]]+wn[n[e+3]]+"-"+wn[n[e+4]]+wn[n[e+5]]+"-"+wn[n[e+6]]+wn[n[e+7]]+"-"+wn[n[e+8]]+wn[n[e+9]]+"-"+wn[n[e+10]]+wn[n[e+11]]+wn[n[e+12]]+wn[n[e+13]]+wn[n[e+14]]+wn[n[e+15]]}const $k=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fv={randomUUID:$k};function mv(n,e,t){if(fv.randomUUID&&!n)return fv.randomUUID();n=n||{};const r=n.random||(n.rng||Hk)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,qk(r)}var Wk="@nlxai/core",Gk="1.1.8-alpha.0",Kk="Low-level SDK for building NLX experiences",Zk="module",Qk="lib/index.cjs",Xk="lib/index.esm.js",Jk="lib/index.umd.js",Yk="lib/index.d.ts",eC={".":{types:"./lib/index.d.ts",import:"./lib/index.esm.js",require:"./lib/index.cjs"}},tC={build:"rm -rf lib && rollup -c --configPlugin typescript --configImportAttributesKey with",docs:"rm -rf docs/ && typedoc && concat-md --decrease-title-levels --dir-name-as-title docs/ > docs/index.md","lint:check":"eslint src/ --ext .ts,.tsx,.js,.jsx --max-warnings 0",lint:"eslint src/ --ext .ts,.tsx,.js,.jsx --fix",prepublish:"npm run build","preview-docs":"npm run docs && comrak --unsafe --gfm -o docs/index.html docs/index.md && open docs/index.html","publish-docs":"npm run docs && mv docs/index.md ../website/src/content/headless-api-reference.md",test:"typedoc --emit none",tsc:"tsc"},nC="Peter Szerzo <peter@nlx.ai>",rC="MIT",iC={"@types/isomorphic-fetch":"^0.0.36","@types/node":"^22.10.1","@types/ramda":"0.29.1","@types/uuid":"^9.0.7","concat-md":"^0.5.1","eslint-config-nlx":"*",prettier:"^3.1.0","rollup-config-nlx":"*",typedoc:"^0.25.13","typedoc-plugin-markdown":"^3.17.1",typescript:"^5.5.4"},aC={"isomorphic-fetch":"^3.0.0",ramda:"^0.29.1","reconnecting-websocket":"^4.4.0",uuid:"^9.0.1"},oC={access:"public"},sC="c701b502f0398e9956a8b35b711a45f264fa7603",$h={name:Wk,version:Gk,description:Kk,type:Zk,main:Qk,module:Xk,browser:Jk,types:Yk,exports:eC,scripts:tC,author:nC,license:rC,devDependencies:iC,dependencies:aC,publishConfig:oC,gitHead:sC};const fs=console;var Hn;(function(n){n.Application="bot",n.User="user",n.Failure="failure"})(Hn||(Hn={}));const gv="NLX.Welcome",lC="We encountered an issue. Please try again soon.",sy=n=>Array.isArray(n)?n:Object.entries(n).map(([e,t])=>({slotId:e,value:t})),vv=n=>({...n,intentId:n.flowId??n.intentId,slots:n.slots!=null?sy(n.slots):n.slots}),bv=n=>n.responses,Wh=n=>{try{return JSON.parse(n)}catch{return null}},ly=n=>{var e;return((e=n.match(/(bots\.dev\.studio\.nlx\.ai|bots\.studio\.nlx\.ai|apps\.nlx\.ai|dev\.apps\.nlx\.ai)/g))==null?void 0:e[0])??"apps.nlx.ai"},cC=n=>{if(ya(n))return n;const e=ly(n),t=new URL(n).pathname.split("/"),r=t[2],o=t[3];return`wss://us-east-1-ws.${e}?deploymentKey=${r}&channelKey=${o}`},yv=n=>{if(!ya(n))return n;const e=ly(n),t=new URL(n),r=new URLSearchParams(t.search),o=r.get("channelKey"),s=r.get("deploymentKey");return`https://${e}/c/${s}/${o}`},ya=n=>n.indexOf("wss://")===0,uC=n=>(n.applicationUrl??"").length>0;function dC(n){let e,t=[],r=null,o,s=[],l=null;const d=n.applicationUrl??"";/[-|_][a-z]{2,}[-|_][A-Z]{2,}$/.test(d)&&fs.warn("Since v1.0.0, the language code is no longer added at the end of the application URL. Please remove the modifier (e.g. '-en-US') from the URL, and specify it in the `languageCode` parameter instead.");const f={voicePlusCommand:[]},m=n.conversationId??mv();let v={responses:n.responses??[],languageCode:n.languageCode,userId:n.userId,conversationId:m};const T=()=>{var le;return`${yv(d)}${((le=n.experimental)==null?void 0:le.completeApplicationUrl)===!0?"":`-${v.languageCode}`}`},x=(le,pe)=>{v={...v,...le},ae.forEach(Oe=>{Oe(bv(v),pe)})},S=()=>{const le={type:Hn.Failure,receivedAt:new Date().getTime(),payload:{text:n.failureMessage??lC}};x({responses:[...v.responses,le]},le)},M=le=>{if((le==null?void 0:le.messages.length)>0){const pe={type:Hn.Application,receivedAt:new Date().getTime(),payload:{...le,messages:le.messages.map(Oe=>({nodeId:Oe.nodeId,messageId:Oe.messageId,text:Oe.text,choices:Oe.choices??[]}))}};x({responses:[...v.responses,pe]},pe),le.metadata.hasPendingDataRequest&&(K({poll:!0}),setTimeout(()=>{$({request:{structured:{poll:!0}}})},1500))}else fs.warn("Invalid message structure, expected object with field 'messages'."),S()};let N;const V=le=>{(o==null?void 0:o.readyState)===1?o.send(JSON.stringify(le)):s=[...s,le]},$=async le=>{var pe;if(N!=null){N(le,Ee=>{const ce={type:Hn.Application,receivedAt:new Date().getTime(),payload:Ee};x({responses:[...v.responses,ce]},ce)});return}const Oe={userId:v.userId,conversationId:v.conversationId,...le,languageCode:v.languageCode,channelType:(pe=n.experimental)==null?void 0:pe.channelType,environment:n.environment};if(ya(d))(e==null?void 0:e.readyState)===1?e.send(JSON.stringify(Oe)):t=[...t,Oe];else try{const Ee=await Hh(T(),{method:"POST",headers:{...n.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-sdk-version":$h.version},body:JSON.stringify(Oe)});if(Ee.status>=400)throw new Error(`Responded with ${Ee.status}`);const ce=await Ee.json();M(ce)}catch(Ee){fs.warn(Ee),S()}};let ae=[];const z=async()=>{(e==null?void 0:e.readyState)===1&&t[0]!=null&&(await $(t[0]),t=t.slice(1))},A=()=>{(o==null?void 0:o.readyState)===1&&s[0]!=null&&(V(s[0]),s=s.slice(1))},F=()=>{var le;de();const pe=new URL(d);((le=n.experimental)==null?void 0:le.completeApplicationUrl)!==!0&&(pe.searchParams.set("languageCode",v.languageCode),pe.searchParams.set("channelKey",`${pe.searchParams.get("channelKey")??""}-${v.languageCode}`)),pe.searchParams.set("conversationId",v.conversationId),e=new qh(pe.href),r=setInterval(()=>{z()},500),e.onmessage=function(Oe){typeof(Oe==null?void 0:Oe.data)=="string"&&M(Wh(Oe.data))},pe.searchParams.set("voice-plus","true"),o=new qh(pe.href),l=setInterval(()=>{A()},500),o.onmessage=Oe=>{if(typeof(Oe==null?void 0:Oe.data)=="string"){const Ee=Wh(Oe.data);Ee!=null&&f.voicePlusCommand.forEach(ce=>{ce(Ee)})}}},J=()=>{var le;if(te(),n.bidirectional!==!0)return;const pe=new URL(cC(d));((le=n.experimental)==null?void 0:le.completeApplicationUrl)!==!0&&(pe.searchParams.set("languageCode",v.languageCode),pe.searchParams.set("channelKey",`${pe.searchParams.get("channelKey")??""}-${v.languageCode}`)),pe.searchParams.set("conversationId",v.conversationId),pe.searchParams.set("type","voice-plus");const Oe=n.headers["nlx-api-key"];!ya(d)&&Oe!=null&&pe.searchParams.set("apiKey",Oe),o=new qh(pe.href),l=setInterval(()=>{A()},500),o.onmessage=Ee=>{if(typeof(Ee==null?void 0:Ee.data)=="string"){const ce=Wh(Ee.data);ce!=null&&f.voicePlusCommand.forEach(Re=>{Re(ce)})}}},de=()=>{r!=null&&clearInterval(r),e!=null&&(e.onmessage=null,e.close(),e=void 0)},te=()=>{l!=null&&clearInterval(l),o!=null&&(o.onmessage=null,o.close(),o=void 0)};ya(d)&&F(),J();const K=(le,pe)=>{const Oe={type:Hn.User,receivedAt:new Date().getTime(),payload:{type:"structured",...vv(le),context:pe}};x({responses:[...v.responses,Oe]},Oe)},ne=(le,pe)=>{K({intentId:le},pe),$({context:pe,request:{structured:{intentId:le}}})},Y=(le,pe)=>{const Oe={type:Hn.User,receivedAt:new Date().getTime(),payload:{type:"text",text:le,context:pe}};x({responses:[...v.responses,Oe]},Oe),$({context:pe,request:{unstructured:{text:le}}})},me=(le,pe,Oe)=>{let Ee=[...v.responses];const ce={type:Hn.User,receivedAt:new Date().getTime(),payload:{type:"choice",choiceId:le}},Re=(Oe==null?void 0:Oe.responseIndex)??-1,ue=(Oe==null?void 0:Oe.messageIndex)??-1;Re>-1&&ue>-1&&(Ee=pv(Re,L=>L.type===Hn.Application?{...L,payload:{...L.payload,messages:pv(ue,ee=>({...ee,selectedChoiceId:le}),L.payload.messages)}}:L,Ee)),Ee=[...Ee,ce],x({responses:Ee},ce),$({context:pe,request:{structured:{nodeId:Oe==null?void 0:Oe.nodeId,intentId:Oe==null?void 0:Oe.intentId,choiceId:le}}})},Le=le=>{ae=ae.filter(pe=>pe!==le)};return{sendText:Y,sendContext:async le=>{const pe=await Hh(`${T()}/context`,{method:"POST",headers:{...n.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":v.conversationId,"nlx-sdk-version":$h.version},body:JSON.stringify({languageCode:v.languageCode,conversationId:v.conversationId,userId:v.userId,context:le})});if(pe.status>=400)throw new Error(`Responded with ${pe.status}`)},sendStructured:(le,pe)=>{K(le,pe),$({context:pe,request:{structured:vv(le)}})},sendSlots:(le,pe)=>{K({slots:le},pe),$({context:pe,request:{structured:{slots:sy(le)}}})},sendFlow:ne,sendIntent:(le,pe)=>{fs.warn("Calling `sendIntent` is deprecated and will be removed in a future version of the SDK. Use `sendFlow` instead."),ne(le,pe)},sendWelcomeFlow:le=>{ne(gv,le)},sendWelcomeIntent:le=>{fs.warn("Calling `sendWelcomeIntent` is deprecated and will be removed in a future version of the SDK. Use `sendWelcomeFlow` instead."),ne(gv,le)},sendChoice:me,currentConversationId:()=>v.conversationId,setLanguageCode:le=>{if(le===v.languageCode){fs.warn("Attempted to set language code to the one already active.");return}ya(d)&&F(),J(),x({languageCode:le})},currentLanguageCode:()=>v.languageCode,getVoiceCredentials:async le=>{const pe=yv(d),Oe=await Hh(`${pe}-${v.languageCode}/requestToken`,{method:"POST",headers:{...n.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":v.conversationId,"nlx-sdk-version":$h.version},body:JSON.stringify({languageCode:v.languageCode,conversationId:v.conversationId,userId:v.userId,requestToken:!0,context:le})});if(Oe.status>=400)throw new Error(`Responded with ${Oe.status}`);const Ee=await Oe.json();if((Ee==null?void 0:Ee.url)==null)throw new Error("Invalid response");return Ee},subscribe:le=>(ae=[...ae,le],le(bv(v)),()=>{Le(le)}),unsubscribe:Le,unsubscribeAll:()=>{ae=[]},reset:le=>{x({conversationId:mv(),responses:(le==null?void 0:le.clearResponses)===!0?[]:v.responses}),ya(d)&&F(),J()},destroy:()=>{ae=[],ya(d)&&de(),te()},setRequestOverride:le=>{N=le},addEventListener:(le,pe)=>{f[le]=[...f[le],pe]},removeEventListener:(le,pe)=>{f[le]=f[le].filter(Oe=>Oe!==pe)},sendVoicePlusContext:le=>{V({context:le})}}}function cy(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var o=n.length;for(e=0;e<o;e++)n[e]&&(t=cy(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function ot(){for(var n,e,t=0,r="",o=arguments.length;t<o;t++)(n=arguments[t])&&(e=cy(n))&&(r&&(r+=" "),r+=e);return r}const st=n=>({width:n.size!=null?`${n.size}px`:"100%",height:n.size!=null?`${n.size}px`:"100%",className:n.className}),hC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M11 21H10L11 14H7.5C6.92 14 6.93 13.68 7.12 13.34C7.31 13 7.17 13.26 7.19 13.22C8.48 10.94 10.42 7.54 13 3H14L13 10H16.5C16.99 10 17.06 10.33 16.97 10.51L16.9 10.66C12.96 17.55 11 21 11 21Z",fill:"currentColor"})}),Wl=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...st(n),children:[R.jsx("path",{d:"M13.5562 5.34835C12.2796 6.62498 12.4866 8.90179 14.0186 10.4337C14.3377 10.7529 14.5571 11.134 14.6767 11.5383C14.8007 11.9572 14.8177 12.4011 14.7277 12.8268C14.6656 13.1203 14.5526 13.4051 14.3887 13.6672C14.3259 13.7677 14.2557 13.865 14.1778 13.9581C14.1279 14.018 14.0747 14.0761 14.0186 14.1322C13.3341 14.8166 12.3641 15.0421 11.4917 14.8092L11.4728 14.8042C9.38654 14.2543 7.32235 15.2129 6.85652 16.9516C6.5761 17.9979 5.50065 18.6188 4.45431 18.3385C3.40798 18.0581 2.787 16.9826 3.06729 15.9363C3.34209 14.9111 4.38012 14.2942 5.40615 14.5335L5.40666 14.5317C5.42748 14.5378 5.44842 14.5437 5.46962 14.5493C7.21342 15.0166 9.08173 13.699 9.64244 11.6062C9.64857 11.5835 9.65521 11.5608 9.66185 11.5383C9.7815 11.134 10.0009 10.7529 10.32 10.4337L10.332 10.4214C10.339 10.4142 10.346 10.407 10.3533 10.4C11.8549 8.86865 12.0496 6.61566 10.7824 5.34835C10.0163 4.58237 10.0163 3.34047 10.7824 2.57449C11.5483 1.8085 12.7903 1.8085 13.5562 2.57449C14.3066 3.32501 14.3218 4.53237 13.6016 5.30135L13.6029 5.30263C13.5872 5.3177 13.5716 5.33289 13.5562 5.34835Z",fill:"currentColor"}),R.jsx("path",{d:"M19.327 6.83185C20.0311 6.83185 20.6019 7.40264 20.6019 8.10675C20.6019 8.81087 20.0311 9.38166 19.327 9.38166C18.6229 9.38166 18.0521 8.81087 18.0521 8.10675C18.0521 7.40264 18.6229 6.83185 19.327 6.83185Z",fill:"currentColor"}),R.jsx("path",{d:"M21.3237 16.4754C21.3237 15.3741 20.4309 14.4813 19.3297 14.4813C18.2284 14.4813 17.3356 15.3741 17.3356 16.4754C17.3356 17.5767 18.2284 18.4695 19.3297 18.4695C20.4309 18.4695 21.3237 17.5767 21.3237 16.4754Z",fill:"currentColor"}),R.jsx("path",{d:"M12.1025 19.3194C12.8246 19.3194 13.4101 19.9195 13.4101 20.6597C13.4101 21.4 12.8246 22 12.1025 22C11.3804 22 10.7949 21.4 10.7949 20.6597C10.7949 19.9195 11.3804 19.3194 12.1025 19.3194Z",fill:"currentColor"}),R.jsx("path",{d:"M6.28367 8.13944C6.28367 7.41726 5.68363 6.83185 4.94339 6.83185C4.20314 6.83185 3.6031 7.41726 3.6031 8.13944C3.6031 8.86163 4.20314 9.44704 4.94339 9.44704C5.68363 9.44704 6.28367 8.86163 6.28367 8.13944Z",fill:"currentColor"})]}),pC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M6 13C5.45 13 5 13.45 5 14C5 14.55 5.45 15 6 15C6.55 15 7 14.55 7 14C7 13.45 6.55 13 6 13ZM6 17C5.45 17 5 17.45 5 18C5 18.55 5.45 19 6 19C6.55 19 7 18.55 7 18C7 17.45 6.55 17 6 17ZM6 9C5.45 9 5 9.45 5 10C5 10.55 5.45 11 6 11C6.55 11 7 10.55 7 10C7 9.45 6.55 9 6 9ZM3 9.5C2.72 9.5 2.5 9.72 2.5 10C2.5 10.28 2.72 10.5 3 10.5C3.28 10.5 3.5 10.28 3.5 10C3.5 9.72 3.28 9.5 3 9.5ZM6 5C5.45 5 5 5.45 5 6C5 6.55 5.45 7 6 7C6.55 7 7 6.55 7 6C7 5.45 6.55 5 6 5ZM21 10.5C21.28 10.5 21.5 10.28 21.5 10C21.5 9.72 21.28 9.5 21 9.5C20.72 9.5 20.5 9.72 20.5 10C20.5 10.28 20.72 10.5 21 10.5ZM14 7C14.55 7 15 6.55 15 6C15 5.45 14.55 5 14 5C13.45 5 13 5.45 13 6C13 6.55 13.45 7 14 7ZM14 3.5C14.28 3.5 14.5 3.28 14.5 3C14.5 2.72 14.28 2.5 14 2.5C13.72 2.5 13.5 2.72 13.5 3C13.5 3.28 13.72 3.5 14 3.5ZM3 13.5C2.72 13.5 2.5 13.72 2.5 14C2.5 14.28 2.72 14.5 3 14.5C3.28 14.5 3.5 14.28 3.5 14C3.5 13.72 3.28 13.5 3 13.5ZM10 20.5C9.72 20.5 9.5 20.72 9.5 21C9.5 21.28 9.72 21.5 10 21.5C10.28 21.5 10.5 21.28 10.5 21C10.5 20.72 10.28 20.5 10 20.5ZM10 3.5C10.28 3.5 10.5 3.28 10.5 3C10.5 2.72 10.28 2.5 10 2.5C9.72 2.5 9.5 2.72 9.5 3C9.5 3.28 9.72 3.5 10 3.5ZM10 7C10.55 7 11 6.55 11 6C11 5.45 10.55 5 10 5C9.45 5 9 5.45 9 6C9 6.55 9.45 7 10 7ZM10 12.5C9.17 12.5 8.5 13.17 8.5 14C8.5 14.83 9.17 15.5 10 15.5C10.83 15.5 11.5 14.83 11.5 14C11.5 13.17 10.83 12.5 10 12.5ZM18 13C17.45 13 17 13.45 17 14C17 14.55 17.45 15 18 15C18.55 15 19 14.55 19 14C19 13.45 18.55 13 18 13ZM18 17C17.45 17 17 17.45 17 18C17 18.55 17.45 19 18 19C18.55 19 19 18.55 19 18C19 17.45 18.55 17 18 17ZM18 9C17.45 9 17 9.45 17 10C17 10.55 17.45 11 18 11C18.55 11 19 10.55 19 10C19 9.45 18.55 9 18 9ZM18 5C17.45 5 17 5.45 17 6C17 6.55 17.45 7 18 7C18.55 7 19 6.55 19 6C19 5.45 18.55 5 18 5ZM21 13.5C20.72 13.5 20.5 13.72 20.5 14C20.5 14.28 20.72 14.5 21 14.5C21.28 14.5 21.5 14.28 21.5 14C21.5 13.72 21.28 13.5 21 13.5ZM14 17C13.45 17 13 17.45 13 18C13 18.55 13.45 19 14 19C14.55 19 15 18.55 15 18C15 17.45 14.55 17 14 17ZM14 20.5C13.72 20.5 13.5 20.72 13.5 21C13.5 21.28 13.72 21.5 14 21.5C14.28 21.5 14.5 21.28 14.5 21C14.5 20.72 14.28 20.5 14 20.5ZM10 8.5C9.17 8.5 8.5 9.17 8.5 10C8.5 10.83 9.17 11.5 10 11.5C10.83 11.5 11.5 10.83 11.5 10C11.5 9.17 10.83 8.5 10 8.5ZM10 17C9.45 17 9 17.45 9 18C9 18.55 9.45 19 10 19C10.55 19 11 18.55 11 18C11 17.45 10.55 17 10 17ZM14 12.5C13.17 12.5 12.5 13.17 12.5 14C12.5 14.83 13.17 15.5 14 15.5C14.83 15.5 15.5 14.83 15.5 14C15.5 13.17 14.83 12.5 14 12.5ZM14 8.5C13.17 8.5 12.5 9.17 12.5 10C12.5 10.83 13.17 11.5 14 11.5C14.83 11.5 15.5 10.83 15.5 10C15.5 9.17 14.83 8.5 14 8.5Z",fill:"currentColor"})}),fC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z",fill:"currentColor"})}),uy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12 15.41L6 9.40997L7.41 7.99997L12 12.58L16.59 7.99997L18 9.40997L12 15.41Z",fill:"currentColor"})}),mC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M7.59001 12L13.59 18L15 16.59L10.42 12L15 7.41002L13.59 6.00002L7.59001 12Z",fill:"currentColor"})}),dy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M15 12L9.00005 18L7.59005 16.59L12.17 12L7.59005 7.41002L9.00005 6.00002L15 12Z",fill:"currentColor"})}),gC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12 8L6 14L7.41 15.41L12 10.83L16.59 15.41L18 14L12 8Z",fill:"currentColor"})}),hd=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z",fill:"currentColor"})}),fp=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M18.5 16H7C4.79 16 3 14.21 3 12C3 9.79 4.79 8 7 8H19.5C20.88 8 22 9.12 22 10.5C22 11.88 20.88 13 19.5 13H9C8.45 13 8 12.55 8 12C8 11.45 8.45 11 9 11H18.5V9.5H9C7.62 9.5 6.5 10.62 6.5 12C6.5 13.38 7.62 14.5 9 14.5H19.5C21.71 14.5 23.5 12.71 23.5 10.5C23.5 8.29 21.71 6.5 19.5 6.5H7C3.96 6.5 1.5 8.96 1.5 12C1.5 15.04 3.96 17.5 7 17.5H18.5V16Z",fill:"currentColor"})}),vC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...st(n),children:[R.jsx("path",{d:"M12 15.2C13.7673 15.2 15.2 13.7673 15.2 12C15.2 10.2327 13.7673 8.8 12 8.8C10.2327 8.8 8.8 10.2327 8.8 12C8.8 13.7673 10.2327 15.2 12 15.2Z",fill:"currentColor"}),R.jsx("path",{d:"M9 2L7.17 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4H16.83L15 2H9ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z",fill:"currentColor"})]}),hy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M8.99991 16.17L4.82991 12L3.40991 13.41L8.99991 19L20.9999 7L19.5899 5.59L8.99991 16.17Z",fill:"currentColor"})}),Gl=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z",fill:"currentColor"})}),bC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z",fill:"currentColor"})}),py=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3.01 4.9 3.01 6L3 20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM19 20H5V9H19V20Z",fill:"currentColor"})}),fy=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...st(n),children:[R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 21C6.9 21 6 20.1 6 19V7H18V19C18 20.1 17.1 21 16 21H8ZM9.33337 9H8V19H9.33337V9ZM11.3334 9V19H12.6666V9H11.3334ZM16 19H14.6666V9H16V19Z",fill:"currentColor"}),R.jsx("path",{d:"M15.5 4H19V6H5V4H8.5L9.5 3H14.5L15.5 4Z",fill:"currentColor"})]}),my=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...st(n),children:[R.jsx("path",{d:"M21 12.22C21 6.73 16.74 3 12 3C7.31 3 3 6.65 3 12.28C2.4 12.62 2 13.26 2 14V16C2 17.1 2.9 18 4 18H5V11.9C5 8.03 8.13 4.9 12 4.9C15.87 4.9 19 8.03 19 11.9V19H11V21H19C20.1 21 21 20.1 21 19V17.78C21.59 17.47 22 16.86 22 16.14V13.84C22 13.14 21.59 12.53 21 12.22Z",fill:"currentColor"}),R.jsx("path",{d:"M9 14C9.55228 14 10 13.5523 10 13C10 12.4477 9.55228 12 9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14Z",fill:"currentColor"}),R.jsx("path",{d:"M15 14C15.5523 14 16 13.5523 16 13C16 12.4477 15.5523 12 15 12C14.4477 12 14 12.4477 14 13C14 13.5523 14.4477 14 15 14Z",fill:"currentColor"}),R.jsx("path",{d:"M18 11.03C17.52 8.18 15.04 6 12.05 6C9.02 6 5.76 8.51 6.02 12.45C8.49 11.44 10.35 9.24 10.88 6.56C12.19 9.19 14.88 11 18 11.03Z",fill:"currentColor"})]}),mp=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z",fill:"currentColor"})}),yC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M7 14H5V19H10V17H7V14ZM5 10H7V7H10V5H5V10ZM17 17H14V19H19V14H17V17ZM14 5V7H17V10H19V5H14Z",fill:"currentColor"})}),Ku=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12 15C13.66 15 14.99 13.66 14.99 12L15 6C15 4.34 13.66 3 12 3C10.34 3 9 4.34 9 6V12C9 13.66 10.34 15 12 15ZM17.3 12C17.3 15 14.76 17.1 12 17.1C9.24 17.1 6.7 15 6.7 12H5C5 15.42 7.72 18.23 11 18.72V22H13V18.72C16.28 18.24 19 15.42 19 12H17.3Z",fill:"currentColor"})}),bf=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"currentColor"})}),wC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})}),Zu=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M3 9.99999V14C3 14.55 3.45 15 4 15H7L10.29 18.29C10.92 18.92 12 18.47 12 17.58V6.40999C12 5.51999 10.92 5.06999 10.29 5.69999L7 8.99999H4C3.45 8.99999 3 9.44999 3 9.99999ZM16.5 12C16.5 10.23 15.48 8.70999 14 7.96999V16.02C15.48 15.29 16.5 13.77 16.5 12ZM14 4.44999V4.64999C14 5.02999 14.25 5.35999 14.6 5.49999C17.18 6.52999 19 9.05999 19 12C19 14.94 17.18 17.47 14.6 18.5C14.24 18.64 14 18.97 14 19.35V19.55C14 20.18 14.63 20.62 15.21 20.4C18.6 19.11 21 15.84 21 12C21 8.15999 18.6 4.88999 15.21 3.59999C14.63 3.36999 14 3.81999 14 4.44999Z",fill:"currentColor"})}),yf=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M16.5 12C16.5 10.23 15.48 8.71 14 7.97V10.18L16.45 12.63C16.48 12.43 16.5 12.22 16.5 12ZM19 12C19 12.94 18.8 13.82 18.46 14.64L19.97 16.15C20.63 14.91 21 13.5 21 12C21 7.72 18.01 4.14 14 3.23V5.29C16.89 6.15 19 8.83 19 12ZM4.27 3L3 4.27L7.73 9H3V15H7L12 20V13.27L16.25 17.52C15.58 18.04 14.83 18.45 14 18.7V20.76C15.38 20.45 16.63 19.81 17.69 18.95L19.73 21L21 19.73L12 10.73L4.27 3ZM12 4L9.91 6.09L12 8.18V4Z",fill:"currentColor"})}),kC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12.87 15.07L10.33 12.56L10.36 12.53C12.1 10.59 13.34 8.36 14.07 6H17V4H10V2H8V4H1V5.99H12.17C11.5 7.92 10.44 9.75 9 11.35C8.07 10.32 7.3 9.19 6.69 8H4.69C5.42 9.63 6.42 11.17 7.67 12.56L2.58 17.58L4 19L9 14L12.11 17.11L12.87 15.07ZM18.5 10H16.5L12 22H14L15.12 19H19.87L21 22H23L18.5 10ZM15.88 17L17.5 12.67L19.12 17H15.88Z",fill:"currentColor"})}),CC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M19 19H5V5H12V3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V12H19V19ZM14 3V5H17.59L7.76 14.83L9.17 16.24L19 6.41V10H21V3H14Z",fill:"currentColor"})}),SC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M8 5V19L19 12L8 5Z",fill:"currentColor"})}),TC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...st(n),children:[R.jsx("path",{d:"M13 14.5C13 15.3284 12.3284 16 11.5 16C10.6716 16 10 15.3284 10 14.5C10 13.6716 10.6716 13 11.5 13C12.3284 13 13 13.6716 13 14.5Z",fill:"currentColor"}),R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 2H14L20 8V20C20 21.1 19.1 22 18 22H5.99C4.89 22 4 21.1 4 20V4C4 2.9 4.9 2 6 2ZM13.16 17.57L15.04 19.45L16.45 18.04L14.57 16.16C15.29 14.83 15.1 13.15 13.98 12.03C12.61 10.66 10.4 10.66 9.03 12.03C7.66 13.4 7.66 15.61 9.03 16.98C10.15 18.1 11.83 18.28 13.16 17.57ZM13 3.5V9H18.5L13 3.5Z",fill:"currentColor"})]}),xC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M3 15H21V13H3V15ZM3 19H21V17H3V19ZM3 11H21V9H3V11ZM3 5V7H21V5H3Z",fill:"currentColor"})}),Kl=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M10 3C14.97 3 19 7.03 19 12H22L18.11 15.89L18.04 16.03L14 12H17C17 8.13 13.87 5 10 5C6.13 5 3 8.13 3 12C3 15.87 6.13 19 10 19V21C5.03 21 1 16.97 1 12C1 7.03 5.03 3 10 3Z",fill:"currentColor"})}),gy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M19.1064 12.9302C19.1459 12.6333 19.1657 12.3266 19.1657 12C19.1657 11.6833 19.1459 11.3667 19.0965 11.0698L21.1053 9.50625C21.2834 9.36771 21.3329 9.10052 21.2241 8.9026L19.3241 5.61719C19.2053 5.39948 18.9579 5.33021 18.7402 5.39948L16.3751 6.34948C15.8803 5.97344 15.3558 5.65677 14.772 5.41927L14.4157 2.90573C14.3761 2.66823 14.1782 2.5 13.9407 2.5H10.1407C9.90323 2.5 9.71521 2.66823 9.67563 2.90573L9.31938 5.41927C8.73552 5.65677 8.20115 5.98333 7.71625 6.34948L5.35115 5.39948C5.13344 5.32031 4.88604 5.39948 4.7673 5.61719L2.87719 8.9026C2.75844 9.11042 2.79802 9.36771 2.99594 9.50625L5.00479 11.0698C4.95532 11.3667 4.91573 11.6932 4.91573 12C4.91573 12.3068 4.93552 12.6333 4.985 12.9302L2.97615 14.4938C2.79802 14.6323 2.74855 14.8995 2.8574 15.0974L4.7574 18.3828C4.87615 18.6005 5.12354 18.6698 5.34125 18.6005L7.70636 17.6505C8.20115 18.0266 8.72563 18.3432 9.30948 18.5807L9.66573 21.0943C9.71521 21.3318 9.90323 21.5 10.1407 21.5H13.9407C14.1782 21.5 14.3761 21.3318 14.4058 21.0943L14.7621 18.5807C15.3459 18.3432 15.8803 18.0266 16.3652 17.6505L18.7303 18.6005C18.948 18.6797 19.1954 18.6005 19.3142 18.3828L21.2142 15.0974C21.3329 14.8797 21.2834 14.6323 21.0954 14.4938L19.1064 12.9302ZM12.0407 15.5625C10.0814 15.5625 8.47823 13.9594 8.47823 12C8.47823 10.0406 10.0814 8.4375 12.0407 8.4375C14.0001 8.4375 15.6032 10.0406 15.6032 12C15.6032 13.9594 14.0001 15.5625 12.0407 15.5625Z",fill:"currentColor"})}),EC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z",fill:"currentColor"})}),PC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),vy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M1 21H23L12 2L1 21ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z",fill:"currentColor"})}),_C=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M15 3H6C5.17 3 4.46 3.5 4.16 4.22L1.14 11.27C1.05 11.5 1 11.74 1 12V14C1 15.1 1.9 16 3 16H9.31L8.36 20.57L8.33 20.89C8.33 21.3 8.5 21.68 8.77 21.95L9.83 23L16.42 16.41C16.78 16.05 17 15.55 17 15V5C17 3.9 16.1 3 15 3ZM19 3V15H23V3H19Z",fill:"currentColor"})}),RC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M1 21H5V9H1V21ZM23 10C23 8.9 22.1 8 21 8H14.69L15.64 3.43L15.67 3.11C15.67 2.7 15.5 2.32 15.23 2.05L14.17 1L7.59 7.59C7.22 7.95 7 8.45 7 9V19C7 20.1 7.9 21 9 21H18C18.83 21 19.54 20.5 19.84 19.78L22.86 12.73C22.95 12.5 23 12.26 23 12V10Z",fill:"currentColor"})}),IC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...st(n),children:[R.jsx("path",{d:"M11 7H12.5V12.25L17 14.92L16.25 16.15L11 13V7Z",fill:"currentColor"}),R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47997 6.47 1.99997 11.99 1.99997C17.52 1.99997 22 6.47997 22 12C22 17.52 17.52 22 11.99 22C6.47 22 2 17.52 2 12ZM4 12C4 16.42 7.58 20 12 20C16.42 20 20 16.42 20 12C20 7.57997 16.42 3.99997 12 3.99997C7.58 3.99997 4 7.57997 4 12Z",fill:"currentColor"})]}),by=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M13 3C8.03 3 4 7.03 4 12H1L4.89 15.89L4.96 16.03L9 12H6C6 8.13 9.13 5 13 5C16.87 5 20 8.13 20 12C20 15.87 16.87 19 13 19V21C17.97 21 22 16.97 22 12C22 7.03 17.97 3 13 3Z",fill:"currentColor"})}),OC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M12 4V1L8 5L12 9V6C15.31 6 18 8.69 18 12C18 13.01 17.75 13.97 17.3 14.8L18.76 16.26C19.54 15.03 20 13.57 20 12C20 7.58 16.42 4 12 4ZM12 18C8.69 18 6 15.31 6 12C6 10.99 6.25 10.03 6.7 9.2L5.24 7.74C4.46 8.97 4 10.43 4 12C4 16.42 7.58 20 12 20V23L16 19L12 15V18Z",fill:"currentColor"})}),MC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...st(n),children:R.jsx("path",{d:"M11 18H13V16H11V18ZM12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 12 11 11.75 11 15H13C13 12.75 16 12.5 16 10C16 7.79 14.21 6 12 6Z",fill:"currentColor"})}),yy=n=>R.jsxs("svg",{viewBox:"0 0 16 16",...st(n),fill:"currentColor",children:[R.jsx("path",{d:"M12.6667 7.33326V12.6666H3.33333V3.33326H8.66667V1.99992H3.33333C2.6 1.99992 2 2.59992 2 3.33326V12.6666C2 13.3999 2.6 13.9999 3.33333 13.9999H12.6667C13.4 13.9999 14 13.3999 14 12.6666V7.33326H12.6667Z"}),R.jsx("path",{d:"M14.0183 1.97412L10.0699 1.97412L11.5506 3.45477L7.66668 7.33327L8.65378 8.32037L12.5377 4.44188L14.0183 5.92253V1.97412Z"})]}),AC=Object.freeze(Object.defineProperty({__proto__:null,Action:hC,Add:fC,ArrowDown:uy,ArrowForward:hd,ArrowLeft:mC,ArrowRight:dy,ArrowUp:gC,AssistantOld:pC,Attachment:fp,Camera:vC,Check:hy,Close:Gl,Copy:bC,Date:py,Delete:fy,Error:mp,Escalate:my,FullScreen:yC,Help:MC,Location:wC,Mic:Ku,MicOff:bf,OpenInNew:CC,OpenLink:yy,Play:SC,Preview:TC,Refresh:OC,Reorder:xC,Restart:Kl,Search:EC,Settings:gy,Share:PC,ThumbDown:_C,ThumbUp:RC,Time:IC,Touchpoint:Wl,Translate:kC,Undo:by,Volume:Zu,VolumeOff:yf,Warning:vy},Symbol.toStringTag,{value:"Module"})),LC=n=>{const{Custom:e}=n;return e!=null?R.jsx(e,{className:n.className,onClick:n.onClick}):R.jsxs("button",{className:ot("p-3 w-fit bg-background text-primary-80 rounded-outer","after:content-[''] after:rounded-outer after:absolute after:inset-0 after:pointer-events-none","hover:after:bg-primary-10",n.className),disabled:n.onClick==null,onClick:n.onClick,children:[R.jsx("span",{className:"block flex-none w-8 h-8",children:n.iconUrl==null?R.jsx(Wl,{}):R.jsx("img",{src:n.iconUrl,className:"w-8 h-8"})}),n.showLabel??!1?R.jsx("span",{children:n.label}):null]})},wy="p-3 w-10 h-10 transition-colors rounded-inner relative z-10 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent focus:outline-0",ky="bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40",Cy="bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20",Sy="bg-accent text-secondary-80 enabled:hover:before:bg-primary-40 focus:before:bg-primary-40 enabled:active:before:bg-secondary-10 disabled:bg-accent-20",Ty="bg-secondary-60 backdrop-blur text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",xy="bg-background backdrop-blur text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",Ey="bg-error-primary text-secondary-80 enabled:hover:before:bg-primary-10",NC=({type:n,Icon:e})=>R.jsx("span",{className:ot(wy,"block",n==="main"?ky:null,n==="ghost"?Cy:null,n==="activated"?Sy:null,n==="coverup"?Ty:null,n==="overlay"?xy:null,n==="error"?Ey:null),children:R.jsx(e,{})}),Cn=({onClick:n,type:e,label:t,className:r,Icon:o})=>{const s=n==null;return R.jsx("button",{onClick:s?void 0:n,disabled:s,"aria-label":t,className:ot(wy,e==="main"?ky:null,e==="ghost"?Cy:null,e==="activated"?Sy:null,e==="coverup"?Ty:null,e==="overlay"?xy:null,e==="error"?Ey:null,r),children:R.jsx(o,{})})};function jC(n){const e=Se.useRef(n);return e.current=n,Se.useMemo(()=>Object.freeze({get current(){return e.current}}),[])}function DC(n){const e=jC(n);Se.useEffect(()=>()=>{e.current()},[])}function UC(n,e,t,r=0){const o=Se.useRef(),s=Se.useRef(),l=Se.useRef(n),d=Se.useRef(),f=()=>{o.current&&(clearTimeout(o.current),o.current=void 0),s.current&&(clearTimeout(s.current),s.current=void 0)};return DC(f),Se.useEffect(()=>{l.current=n},e),Se.useMemo(()=>{const m=()=>{if(f(),!d.current)return;const T=d.current;d.current=void 0,l.current.apply(T.this,T.args)},v=function(...T){o.current&&clearTimeout(o.current),d.current={args:T,this:this},o.current=setTimeout(m,t),r>0&&!s.current&&(s.current=setTimeout(m,r))};return Object.defineProperties(v,{length:{value:n.length},name:{value:`${n.name||"anonymous"}__debounced__${t}`}}),v},[t,r,...e])}const FC=typeof globalThis<"u"&&typeof navigator<"u"&&typeof document<"u";function wv(n,e,t=0){const[r,o]=Se.useState(n);return[r,UC(o,[],e,t)]}const Is=new Map,Py=n=>{const e=matchMedia(n),t=new Set,r=()=>{for(const o of t)o(e.matches)};return e.addEventListener("change",r,{passive:!0}),{mql:e,dispatchers:t,listener:r}},BC=(n,e)=>{let t=Is.get(n);t||(t=Py(n),Is.set(n,t)),t.dispatchers.add(e),e(t.mql.matches)},zC=(n,e)=>{const t=Is.get(n);if(t){const{mql:r,dispatchers:o,listener:s}=t;o.delete(e),o.size===0&&(Is.delete(n),r.removeEventListener?r.removeEventListener("change",s):r.removeListener(s))}};function VC(n,e={}){let{initializeWithValue:t=!0}=e;FC||(t=!1);const[r,o]=Se.useState(()=>{if(t){let s=Is.get(n);return s||(s=Py(n),Is.set(n,s)),s.mql.matches}});return Se.useEffect(()=>(BC(n,o),()=>{zC(n,o)}),[n]),r}const _y=n=>{let e;switch(n){case"sm":e="(min-width: 640px)";break;case"md":e="(min-width: 768px)";break;case"lg":e="(min-width: 1024px)";break}return VC(e)},HC=({windowSize:n,renderCollapse:e,errorThemedCloseButton:t,speakerControls:r,collapse:o,toggleSettings:s,isSettingsOpen:l,brandIcon:d,reset:f,enabled:m})=>{const v=n==="half",T=_y("md"),x=v&&T?"overlay":"ghost";return R.jsxs("div",{className:ot("flex","p-2 md:p-3 items-center justify-between gap-2",{"md:absolute md:w-fit md:flex-col md:left-0 md:-translate-x-full":n==="half","md:absolute md:left-0 md:right-0 md:top-0":n==="full"||n==="embedded"}),children:[d!=null?R.jsx("img",{className:"w-10 h-10 block",src:d,role:"presentation"}):null,R.jsx(Cn,{label:"Reset",type:x,className:d==null?"":"ml-auto",onClick:m?()=>{f()}:void 0,Icon:by}),s!=null?R.jsx(Cn,{className:d!=null?"":"ml-auto",Icon:gy,label:"Settings",type:l?"activated":x,onClick:m?s:void 0}):null,r!=null?R.jsx(Cn,{Icon:r.enabled?Zu:yf,label:"Speakers",type:r.enabled?"activated":x,onClick:()=>{r.setEnabled(S=>!S)}}):null,e?R.jsx(Cn,{label:"Collapse",type:t??!1?"error":x,className:ot(s==null?"ml-auto":"",v?"md:-order-1":""),onClick:m?()=>{o(new Event("collapse"))}:void 0,Icon:Gl}):null]})},Ry=()=>R.jsxs("div",{className:ot("flex-grow flex flex-col items-center justify-center gap-6 text-primary-80","fullscreen-error"),children:[R.jsx(Wl,{className:"w-20 h-20 text-primary-20"}),R.jsxs("div",{className:"text-center",children:[R.jsx("h3",{className:"text-xl mb-2",children:"Oops!"}),R.jsx("p",{children:"Something went wrong."}),R.jsx("p",{children:"Try again later."})]})]}),bu=({k:n,className:e,style:t})=>{const r=o=>`${o}s`;return R.jsx("div",{className:ot("bg-current animate-ping absolute inset-0",e),style:{animationDelay:r(-1.5*n),animationDuration:r(1.5),...t??{}}})},Zl=({className:n,style:e})=>{const t=ot("text-accent-20",n);return R.jsxs(R.Fragment,{children:[R.jsx(bu,{k:.12,className:t,style:e}),R.jsx(bu,{k:.24,className:t,style:e}),R.jsx(bu,{k:.36,className:t,style:e}),R.jsx(bu,{k:.48,className:t,style:e})]})},qC=30,Pl=17,$C=n=>n<.5?2*n*n:1-Math.pow(-2*n+2,2)/2,gp=990,WC=300,yu=gp+WC,GC=({d:n})=>{const e=Math.PI/2,t=n/Pl/2.8,r=e*Math.min(t,1),o=t<1?(n-Math.sin(r))/Math.cos(r)*.5:0,s=-n,l=n,d=n-Pl*Math.sin(r),f=Pl*Math.cos(r),m=d-o*Math.cos(r),v=f-o*Math.sin(r);return R.jsxs(R.Fragment,{children:[R.jsx("circle",{cx:s,cy:"0",r:Pl}),R.jsx("circle",{cx:l,cy:"0",r:Pl}),t<.45?R.jsx("path",{d:`
            M${-d},${f} 
            C${-m},${v} ${m},${v} ${d},${f} L${d},${-f}
            C${m},${-v} ${-m},${-v} ${-d},${-f} Z
          `}):null]})},KC=n=>n<1/3?n*3:n<2/3?1:3-n*3,kv=n=>n<1/3?0:n<2/3?(n-1/3)*3:1,wf=()=>{const[n,e]=Se.useState(null),t=Se.useRef(!1);if(Se.useEffect(()=>{const T=x=>{e(S=>S==null?{start:x,current:x}:{...S,current:x}),t.current||requestAnimationFrame(T)};t.current||requestAnimationFrame(T)},[t,e]),n==null)return null;let r,o;const s=n.current-n.start,l=s%yu,d=Math.floor(s/yu);if(l<gp){const T=s/yu,x=Math.floor(T),S=$C((T-x)*(yu/gp));r=KC(S),o=d%2?kv(S):1+kv(S)}else r=0,o=0;const f=r>.2?0:5*(.2-r)/.2,m=.3,v=r>m?1-.25*(r-m)/(1-m):1;return R.jsx("svg",{viewBox:"0 0 100 100",stroke:"none",fill:"currentColor",style:{filter:`drop-shadow(0 0 ${f}px var(--accent))`},children:R.jsx("g",{transform:`translate(50 50) rotate(${o*90})`,opacity:v,children:R.jsx(GC,{d:qC*r})})})},Iy=({label:n,className:e})=>R.jsx("div",{className:ot("h-full w-full flex items-center justify-center",e),children:R.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[R.jsx("div",{className:ot("w-8 h-8 block text-accent"),children:R.jsx(wf,{})}),n!=null?R.jsx("p",{className:"text-primary-60",children:n}):null]})}),ko=({onClick:n,label:e,type:t="ghost",Icon:r,className:o})=>R.jsxs("button",{onClick:n,disabled:n==null,className:ot("relative z-10 w-full px-5 py-4 transition-colors rounded-outer flex justify-between items-center focus:outline-0 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",{"bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40":t==="main","bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-5 focus:before:bg-primary-5 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20":t==="ghost"},o),children:[e,R.jsx(r,{size:16})]});function ZC(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}var QC=Object.defineProperty,XC=(n,e,t)=>e in n?QC(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Cv=(n,e,t)=>XC(n,typeof e!="symbol"?e+"":e,t);class mr{constructor(){Cv(this,"_locking"),Cv(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(o=>e=()=>{this._locks-=1,o()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),r}}function Gt(n,e){if(!n)throw new Error(e)}const JC=34028234663852886e22,YC=-34028234663852886e22,eS=4294967295,tS=2147483647,nS=-2147483648;function _u(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>tS||n<nS)throw new Error("invalid int 32: "+n)}function vp(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>eS||n<0)throw new Error("invalid uint 32: "+n)}function Oy(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>JC||n<YC))throw new Error("invalid float 32: "+n)}const My=Symbol("@bufbuild/protobuf/enum-type");function rS(n){const e=n[My];return Gt(e,"missing enum type on enum object"),e}function Ay(n,e,t,r){n[My]=Ly(e,t.map(o=>({no:o.no,name:o.name,localName:n[o.no]})))}function Ly(n,e,t){const r=Object.create(null),o=Object.create(null),s=[];for(const l of e){const d=Ny(l);s.push(d),r[l.name]=d,o[l.no]=d}return{typeName:n,values:s,findName(l){return r[l]},findNumber(l){return o[l]}}}function iS(n,e,t){const r={};for(const o of e){const s=Ny(o);r[s.localName]=s.no,r[s.no]=s.localName}return Ay(r,n,e),r}function Ny(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class kf{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),o=r.runtime.bin,s=o.makeReadOptions(t);return o.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,t){const r=this.getType(),o=r.runtime.json,s=o.makeReadOptions(t);return o.readMessage(r,e,s,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,o=r.makeWriteOptions(e),s=o.writerFactory();return r.writeMessage(this,s,o),s.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,o=r.makeWriteOptions(e);return r.writeMessage(this,o)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function aS(n,e,t,r){var o;const s=(o=r==null?void 0:r.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),l={[s]:function(d){n.util.initFields(this),n.util.initPartial(d,this)}}[s];return Object.setPrototypeOf(l.prototype,new kf),Object.assign(l,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(d,f){return new l().fromBinary(d,f)},fromJson(d,f){return new l().fromJson(d,f)},fromJsonString(d,f){return new l().fromJsonString(d,f)},equals(d,f){return n.util.equals(l,d,f)}}),l}function oS(){let n=0,e=0;for(let r=0;r<28;r+=7){let o=this.buf[this.pos++];if(n|=(o&127)<<r,(o&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<r,(o&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function Gh(n,e,t){for(let s=0;s<28;s=s+7){const l=n>>>s,d=!(!(l>>>7)&&e==0),f=(d?l|128:l)&255;if(t.push(f),!d)return}const r=n>>>28&15|(e&7)<<4,o=e>>3!=0;if(t.push((o?r|128:r)&255),!!o){for(let s=3;s<31;s=s+7){const l=e>>>s,d=!!(l>>>7),f=(d?l|128:l)&255;if(t.push(f),!d)return}t.push(e>>>31&1)}}const Ru=4294967296;function Sv(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,o=0;function s(l,d){const f=Number(n.slice(l,d));o*=t,r=r*t+f,r>=Ru&&(o=o+(r/Ru|0),r=r%Ru)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?Dy(r,o):Cf(r,o)}function sS(n,e){let t=Cf(n,e);const r=t.hi&2147483648;r&&(t=Dy(t.lo,t.hi));const o=jy(t.lo,t.hi);return r?"-"+o:o}function jy(n,e){if({lo:n,hi:e}=lS(n,e),e<=2097151)return String(Ru*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,o=e>>16&65535;let s=t+r*6777216+o*6710656,l=r+o*8147497,d=o*2;const f=1e7;return s>=f&&(l+=Math.floor(s/f),s%=f),l>=f&&(d+=Math.floor(l/f),l%=f),d.toString()+Tv(l)+Tv(s)}function lS(n,e){return{lo:n>>>0,hi:e>>>0}}function Cf(n,e){return{lo:n|0,hi:e|0}}function Dy(n,e){return e=~e,n?n=~n+1:e+=1,Cf(n,e)}const Tv=n=>{const e=String(n);return"0000000".slice(e.length)+e};function xv(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function cS(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function uS(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof Dg!="object"||Dg.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),s=BigInt("0"),l=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(d){const f=typeof d=="bigint"?d:BigInt(d);if(f>o||f<r)throw new Error("int64 invalid: ".concat(d));return f},uParse(d){const f=typeof d=="bigint"?d:BigInt(d);if(f>l||f<s)throw new Error("uint64 invalid: ".concat(d));return f},enc(d){return n.setBigInt64(0,this.parse(d),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(d){return n.setBigInt64(0,this.uParse(d),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(d,f){return n.setInt32(0,d,!0),n.setInt32(4,f,!0),n.getBigInt64(0,!0)},uDec(d,f){return n.setInt32(0,d,!0),n.setInt32(4,f,!0),n.getBigUint64(0,!0)}}}const e=r=>Gt(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),t=r=>Gt(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),e(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),t(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),e(r),Sv(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),t(r),Sv(r)},dec(r,o){return sS(r,o)},uDec(r,o){return jy(r,o)}}}const Ut=uS();var ge;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(ge||(ge={}));var Ea;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(Ea||(Ea={}));function ga(n,e,t){if(e===t)return!0;if(n==ge.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return e==t}return!1}function Os(n,e){switch(n){case ge.BOOL:return!1;case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return e==0?Ut.zero:"0";case ge.DOUBLE:case ge.FLOAT:return 0;case ge.BYTES:return new Uint8Array(0);case ge.STRING:return"";default:return 0}}function Uy(n,e){switch(n){case ge.BOOL:return e===!1;case ge.STRING:return e==="";case ge.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Jt;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Jt||(Jt={}));class dS{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let t=new Uint8Array(e),r=0;for(let o=0;o<this.chunks.length;o++)t.set(this.chunks[o],r),r+=this.chunks[o].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(vp(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return _u(e),xv(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Oy(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){vp(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){_u(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return _u(e),e=(e<<1^e>>31)>>>0,xv(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),o=Ut.enc(e);return r.setInt32(0,o.lo,!0),r.setInt32(4,o.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),o=Ut.uEnc(e);return r.setInt32(0,o.lo,!0),r.setInt32(4,o.hi,!0),this.raw(t)}int64(e){let t=Ut.enc(e);return Gh(t.lo,t.hi,this.buf),this}sint64(e){let t=Ut.enc(e),r=t.hi>>31,o=t.lo<<1^r,s=(t.hi<<1|t.lo>>>31)^r;return Gh(o,s,this.buf),this}uint64(e){let t=Ut.uEnc(e);return Gh(t.lo,t.hi,this.buf),this}}class hS{constructor(e,t){this.varint64=oS,this.uint32=cS,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case Jt.Varint:for(;this.buf[this.pos++]&128;);break;case Jt.Bit64:this.pos+=4;case Jt.Bit32:this.pos+=4;break;case Jt.LengthDelimited:let o=this.uint32();this.pos+=o;break;case Jt.StartGroup:for(;;){const[s,l]=this.tag();if(l===Jt.EndGroup){if(t!==void 0&&s!==t)throw new Error("invalid end group tag");break}this.skip(l,s)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ut.dec(...this.varint64())}uint64(){return Ut.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,Ut.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ut.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ut.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function pS(n,e,t,r){let o;return{typeName:e,extendee:t,get field(){if(!o){const s=typeof r=="function"?r():r;s.name=e.split(".").pop(),s.jsonName="[".concat(e,"]"),o=n.util.newFieldList([s]).list()[0]}return o},runtime:n}}function Fy(n){const e=n.field.localName,t=Object.create(null);return t[e]=fS(n),[t,()=>t[e]]}function fS(n){const e=n.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Os(e.T,e.L);case"message":const t=e.T,r=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function mS(n,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=n.length-1;t>=0;--t)if(n[t].no==e.no)return[n[t]];return[]}return n.filter(t=>t.no===e.no)}let Vi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),pd=[];for(let n=0;n<Vi.length;n++)pd[Vi[n].charCodeAt(0)]=n;pd[45]=Vi.indexOf("+");pd[95]=Vi.indexOf("/");const By={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,o=0,s,l=0;for(let d=0;d<n.length;d++){if(s=pd[n.charCodeAt(d)],s===void 0)switch(n[d]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:l=s,o=1;break;case 1:t[r++]=l<<2|(s&48)>>4,l=s,o=2;break;case 2:t[r++]=(l&15)<<4|(s&60)>>2,l=s,o=3;break;case 3:t[r++]=(l&3)<<6|s,o=0;break}}if(o==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,o=0;for(let s=0;s<n.length;s++)switch(r=n[s],t){case 0:e+=Vi[r>>2],o=(r&3)<<4,t=1;break;case 1:e+=Vi[o|r>>4],o=(r&15)<<2,t=2;break;case 2:e+=Vi[o|r>>6],e+=Vi[r&63],t=0;break}return t&&(e+=Vi[o],e+="=",t==1&&(e+="=")),e}};function gS(n,e,t){Vy(e,n);const r=e.runtime.bin.makeReadOptions(t),o=mS(n.getType().runtime.bin.listUnknownFields(n),e.field),[s,l]=Fy(e);for(const d of o)e.runtime.bin.readField(s,r.readerFactory(d.data),e.field,d.wireType,r);return l()}function vS(n,e,t,r){Vy(e,n);const o=e.runtime.bin.makeReadOptions(r),s=e.runtime.bin.makeWriteOptions(r);if(zy(n,e)){const m=n.getType().runtime.bin.listUnknownFields(n).filter(v=>v.no!=e.field.no);n.getType().runtime.bin.discardUnknownFields(n);for(const v of m)n.getType().runtime.bin.onUnknownField(n,v.no,v.wireType,v.data)}const l=s.writerFactory();let d=e.field;!d.opt&&!d.repeated&&(d.kind=="enum"||d.kind=="scalar")&&(d=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(d,t,l,s);const f=o.readerFactory(l.finish());for(;f.pos<f.len;){const[m,v]=f.tag(),T=f.skip(v,m);n.getType().runtime.bin.onUnknownField(n,m,v,T)}}function zy(n,e){const t=n.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(n).find(r=>r.no==e.field.no)}function Vy(n,e){Gt(n.extendee.typeName==e.getType().typeName,"extension ".concat(n.typeName," can only be applied to message ").concat(n.extendee.typeName))}function Hy(n,e){const t=n.localName;if(n.repeated)return e[t].length>0;if(n.oneof)return e[n.oneof.localName].case===t;switch(n.kind){case"enum":case"scalar":return n.opt||n.req?e[t]!==void 0:n.kind=="enum"?e[t]!==n.T.values[0].no:!Uy(n.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function Ev(n,e){const t=n.localName,r=!n.opt&&!n.req;if(n.repeated)e[t]=[];else if(n.oneof)e[n.oneof.localName]={case:void 0};else switch(n.kind){case"map":e[t]={};break;case"enum":e[t]=r?n.T.values[0].no:void 0;break;case"scalar":e[t]=r?Os(n.T,n.L):void 0;break;case"message":e[t]=void 0;break}}function vo(n,e){if(n===null||typeof n!="object"||!Object.getOwnPropertyNames(kf.prototype).every(r=>r in n&&typeof n[r]=="function"))return!1;const t=n.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function qy(n,e){return vo(e)||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}ge.DOUBLE,ge.FLOAT,ge.INT64,ge.UINT64,ge.INT32,ge.UINT32,ge.BOOL,ge.STRING,ge.BYTES;const Pv={ignoreUnknownFields:!1},_v={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function bS(n){return n?Object.assign(Object.assign({},Pv),n):Pv}function yS(n){return n?Object.assign(Object.assign({},_v),n):_v}const Qu=Symbol(),Iu=Symbol();function wS(){return{makeReadOptions:bS,makeWriteOptions:yS,readMessage(n,e,t,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(yi(e)));r=r??new n;const o=new Map,s=t.typeRegistry;for(const[l,d]of Object.entries(e)){const f=n.fields.findJsonName(l);if(f){if(f.oneof){if(d===null&&f.kind=="scalar")continue;const m=o.get(f.oneof);if(m!==void 0)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(f.oneof.name,'" present: "').concat(m,'", "').concat(l,'"'));o.set(f.oneof,l)}Rv(r,d,f,t,n)}else{let m=!1;if(s!=null&&s.findExtension&&l.startsWith("[")&&l.endsWith("]")){const v=s.findExtension(l.substring(1,l.length-1));if(v&&v.extendee.typeName==n.typeName){m=!0;const[T,x]=Fy(v);Rv(T,d,v.field,t,v),vS(r,v,x(),t)}}if(!m&&!t.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(l,'" is unknown'))}}return r},writeMessage(n,e){const t=n.getType(),r={};let o;try{for(o of t.fields.byNumber()){if(!Hy(o,n)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!CS(o))continue}const l=o.oneof?n[o.oneof.localName].value:n[o.localName],d=Iv(o,l,e);d!==void 0&&(r[e.useProtoFieldName?o.name:o.jsonName]=d)}const s=e.typeRegistry;if(s!=null&&s.findExtensionFor)for(const l of t.runtime.bin.listUnknownFields(n)){const d=s.findExtensionFor(t.typeName,l.no);if(d&&zy(n,d)){const f=gS(n,d,e),m=Iv(d.field,f,e);m!==void 0&&(r[d.field.jsonName]=m)}}}catch(s){const l=o?"cannot encode field ".concat(t.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(t.typeName," to JSON"),d=s instanceof Error?s.message:String(s);throw new Error(l+(d.length>0?": ".concat(d):""))}return r},readScalar(n,e,t){return Dl(n,e,t??Ea.BIGINT,!0)},writeScalar(n,e,t){if(e!==void 0&&(t||Uy(n,e)))return Ou(n,e)},debug:yi}}function yi(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function Rv(n,e,t,r,o){let s=t.localName;if(t.repeated){if(Gt(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(t.name," from JSON: ").concat(yi(e)));const l=n[s];for(const d of e){if(d===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(t.name," from JSON: ").concat(yi(d)));switch(t.kind){case"message":l.push(t.T.fromJson(d,r));break;case"enum":const f=Kh(t.T,d,r.ignoreUnknownFields,!0);f!==Iu&&l.push(f);break;case"scalar":try{l.push(Dl(t.T,d,t.L,!0))}catch(m){let v="cannot decode field ".concat(o.typeName,".").concat(t.name," from JSON: ").concat(yi(d));throw m instanceof Error&&m.message.length>0&&(v+=": ".concat(m.message)),new Error(v)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(t.name," from JSON: ").concat(yi(e)));const l=n[s];for(const[d,f]of Object.entries(e)){if(f===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(t.name," from JSON: map value null"));let m;try{m=kS(t.K,d)}catch(v){let T="cannot decode map key for field ".concat(o.typeName,".").concat(t.name," from JSON: ").concat(yi(e));throw v instanceof Error&&v.message.length>0&&(T+=": ".concat(v.message)),new Error(T)}switch(t.V.kind){case"message":l[m]=t.V.T.fromJson(f,r);break;case"enum":const v=Kh(t.V.T,f,r.ignoreUnknownFields,!0);v!==Iu&&(l[m]=v);break;case"scalar":try{l[m]=Dl(t.V.T,f,Ea.BIGINT,!0)}catch(T){let x="cannot decode map value for field ".concat(o.typeName,".").concat(t.name," from JSON: ").concat(yi(e));throw T instanceof Error&&T.message.length>0&&(x+=": ".concat(T.message)),new Error(x)}break}}}else switch(t.oneof&&(n=n[t.oneof.localName]={case:s},s="value"),t.kind){case"message":const l=t.T;if(e===null&&l.typeName!="google.protobuf.Value")return;let d=n[s];vo(d)?d.fromJson(e,r):(n[s]=d=l.fromJson(e,r),l.fieldWrapper&&!t.oneof&&(n[s]=l.fieldWrapper.unwrapField(d)));break;case"enum":const f=Kh(t.T,e,r.ignoreUnknownFields,!1);switch(f){case Qu:Ev(t,n);break;case Iu:break;default:n[s]=f;break}break;case"scalar":try{const m=Dl(t.T,e,t.L,!1);switch(m){case Qu:Ev(t,n);break;default:n[s]=m;break}}catch(m){let v="cannot decode field ".concat(o.typeName,".").concat(t.name," from JSON: ").concat(yi(e));throw m instanceof Error&&m.message.length>0&&(v+=": ".concat(m.message)),new Error(v)}break}}function kS(n,e){if(n===ge.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Dl(n,e,Ea.BIGINT,!0).toString()}function Dl(n,e,t,r){if(e===null)return r?Os(n,t):Qu;switch(n){case ge.DOUBLE:case ge.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return n==ge.FLOAT&&Oy(o),o;case ge.INT32:case ge.FIXED32:case ge.SFIXED32:case ge.SINT32:case ge.UINT32:let s;if(typeof e=="number"?s=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(s=Number(e)),s===void 0)break;return n==ge.UINT32||n==ge.FIXED32?vp(s):_u(s),s;case ge.INT64:case ge.SFIXED64:case ge.SINT64:if(typeof e!="number"&&typeof e!="string")break;const l=Ut.parse(e);return t?l.toString():l;case ge.FIXED64:case ge.UINT64:if(typeof e!="number"&&typeof e!="string")break;const d=Ut.uParse(e);return t?d.toString():d;case ge.BOOL:if(typeof e!="boolean")break;return e;case ge.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case ge.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return By.dec(e)}throw new Error}function Kh(n,e,t,r){if(e===null)return n.typeName=="google.protobuf.NullValue"?0:r?n.values[0].no:Qu;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=n.findName(e);if(o!==void 0)return o.no;if(t)return Iu;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(yi(e)))}function CS(n){return n.repeated||n.kind=="map"?!0:!(n.oneof||n.kind=="message"||n.opt||n.req)}function Iv(n,e,t){if(n.kind=="map"){Gt(typeof e=="object"&&e!=null);const r={},o=Object.entries(e);switch(n.V.kind){case"scalar":for(const[l,d]of o)r[l.toString()]=Ou(n.V.T,d);break;case"message":for(const[l,d]of o)r[l.toString()]=d.toJson(t);break;case"enum":const s=n.V.T;for(const[l,d]of o)r[l.toString()]=Zh(s,d,t.enumAsInteger);break}return t.emitDefaultValues||o.length>0?r:void 0}if(n.repeated){Gt(Array.isArray(e));const r=[];switch(n.kind){case"scalar":for(let o=0;o<e.length;o++)r.push(Ou(n.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)r.push(Zh(n.T,e[o],t.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)r.push(e[o].toJson(t));break}return t.emitDefaultValues||r.length>0?r:void 0}switch(n.kind){case"scalar":return Ou(n.T,e);case"enum":return Zh(n.T,e,t.enumAsInteger);case"message":return qy(n.T,e).toJson(t)}}function Zh(n,e,t){var r;if(Gt(typeof e=="number"),n.typeName=="google.protobuf.NullValue")return null;if(t)return e;const o=n.findNumber(e);return(r=o==null?void 0:o.name)!==null&&r!==void 0?r:e}function Ou(n,e){switch(n){case ge.INT32:case ge.SFIXED32:case ge.SINT32:case ge.FIXED32:case ge.UINT32:return Gt(typeof e=="number"),e;case ge.FLOAT:case ge.DOUBLE:return Gt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case ge.STRING:return Gt(typeof e=="string"),e;case ge.BOOL:return Gt(typeof e=="boolean"),e;case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return Gt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case ge.BYTES:return Gt(e instanceof Uint8Array),By.enc(e)}}const ms=Symbol("@bufbuild/protobuf/unknown-fields"),Ov={readUnknownFields:!0,readerFactory:n=>new hS(n)},Mv={writeUnknownFields:!0,writerFactory:()=>new dS};function SS(n){return n?Object.assign(Object.assign({},Ov),n):Ov}function TS(n){return n?Object.assign(Object.assign({},Mv),n):Mv}function xS(){return{makeReadOptions:SS,makeWriteOptions:TS,listUnknownFields(n){var e;return(e=n[ms])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[ms]},writeUnknownFields(n,e){const t=n[ms];if(t)for(const r of t)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(n,e,t,r){const o=n;Array.isArray(o[ms])||(o[ms]=[]),o[ms].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r,o){const s=n.getType(),l=o?e.len:e.pos+t;let d,f;for(;e.pos<l&&([d,f]=e.tag(),!(o===!0&&f==Jt.EndGroup));){const m=s.fields.find(d);if(!m){const v=e.skip(f,d);r.readUnknownFields&&this.onUnknownField(n,d,f,v);continue}Av(n,e,m,f,r)}if(o&&(f!=Jt.EndGroup||d!==t))throw new Error("invalid end group tag")},readField:Av,writeMessage(n,e,t){const r=n.getType();for(const o of r.fields.byNumber()){if(!Hy(o,n)){if(o.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(o.name," to binary: required field not set"));continue}const s=o.oneof?n[o.oneof.localName].value:n[o.localName];Lv(o,s,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e},writeField(n,e,t,r){e!==void 0&&Lv(n,e,t,r)}}}function Av(n,e,t,r,o){let{repeated:s,localName:l}=t;switch(t.oneof&&(n=n[t.oneof.localName],n.case!=l&&delete n.value,n.case=l,l="value"),t.kind){case"scalar":case"enum":const d=t.kind=="enum"?ge.INT32:t.T;let f=Xu;if(t.kind=="scalar"&&t.L>0&&(f=PS),s){let x=n[l];if(r==Jt.LengthDelimited&&d!=ge.STRING&&d!=ge.BYTES){let S=e.uint32()+e.pos;for(;e.pos<S;)x.push(f(e,d))}else x.push(f(e,d))}else n[l]=f(e,d);break;case"message":const m=t.T;s?n[l].push(Mu(e,new m,o,t)):vo(n[l])?Mu(e,n[l],o,t):(n[l]=Mu(e,new m,o,t),m.fieldWrapper&&!t.oneof&&!t.repeated&&(n[l]=m.fieldWrapper.unwrapField(n[l])));break;case"map":let[v,T]=ES(t,e,o);n[l][v]=T;break}}function Mu(n,e,t,r){const o=e.getType().runtime.bin,s=r==null?void 0:r.delimited;return o.readMessage(e,n,s?r.no:n.uint32(),t,s),e}function ES(n,e,t){const r=e.uint32(),o=e.pos+r;let s,l;for(;e.pos<o;){const[d]=e.tag();switch(d){case 1:s=Xu(e,n.K);break;case 2:switch(n.V.kind){case"scalar":l=Xu(e,n.V.T);break;case"enum":l=e.int32();break;case"message":l=Mu(e,new n.V.T,t,void 0);break}break}}if(s===void 0&&(s=Os(n.K,Ea.BIGINT)),typeof s!="string"&&typeof s!="number"&&(s=s.toString()),l===void 0)switch(n.V.kind){case"scalar":l=Os(n.V.T,Ea.BIGINT);break;case"enum":l=n.V.T.values[0].no;break;case"message":l=new n.V.T;break}return[s,l]}function PS(n,e){const t=Xu(n,e);return typeof t=="bigint"?t.toString():t}function Xu(n,e){switch(e){case ge.STRING:return n.string();case ge.BOOL:return n.bool();case ge.DOUBLE:return n.double();case ge.FLOAT:return n.float();case ge.INT32:return n.int32();case ge.INT64:return n.int64();case ge.UINT64:return n.uint64();case ge.FIXED64:return n.fixed64();case ge.BYTES:return n.bytes();case ge.FIXED32:return n.fixed32();case ge.SFIXED32:return n.sfixed32();case ge.SFIXED64:return n.sfixed64();case ge.SINT64:return n.sint64();case ge.UINT32:return n.uint32();case ge.SINT32:return n.sint32()}}function Lv(n,e,t,r){Gt(e!==void 0);const o=n.repeated;switch(n.kind){case"scalar":case"enum":let s=n.kind=="enum"?ge.INT32:n.T;if(o)if(Gt(Array.isArray(e)),n.packed)RS(t,s,n.no,e);else for(const l of e)Ul(t,s,n.no,l);else Ul(t,s,n.no,e);break;case"message":if(o){Gt(Array.isArray(e));for(const l of e)Nv(t,r,n,l)}else Nv(t,r,n,e);break;case"map":Gt(typeof e=="object"&&e!=null);for(const[l,d]of Object.entries(e))_S(t,r,n,l,d);break}}function _S(n,e,t,r,o){n.tag(t.no,Jt.LengthDelimited),n.fork();let s=r;switch(t.K){case ge.INT32:case ge.FIXED32:case ge.UINT32:case ge.SFIXED32:case ge.SINT32:s=Number.parseInt(r);break;case ge.BOOL:Gt(r=="true"||r=="false"),s=r=="true";break}switch(Ul(n,t.K,1,s),t.V.kind){case"scalar":Ul(n,t.V.T,2,o);break;case"enum":Ul(n,ge.INT32,2,o);break;case"message":Gt(o!==void 0),n.tag(2,Jt.LengthDelimited).bytes(o.toBinary(e));break}n.join()}function Nv(n,e,t,r){const o=qy(t.T,r);t.delimited?n.tag(t.no,Jt.StartGroup).raw(o.toBinary(e)).tag(t.no,Jt.EndGroup):n.tag(t.no,Jt.LengthDelimited).bytes(o.toBinary(e))}function Ul(n,e,t,r){Gt(r!==void 0);let[o,s]=$y(e);n.tag(t,o)[s](r)}function RS(n,e,t,r){if(!r.length)return;n.tag(t,Jt.LengthDelimited).fork();let[,o]=$y(e);for(let s=0;s<r.length;s++)n[o](r[s]);n.join()}function $y(n){let e=Jt.Varint;switch(n){case ge.BYTES:case ge.STRING:e=Jt.LengthDelimited;break;case ge.DOUBLE:case ge.FIXED64:case ge.SFIXED64:e=Jt.Bit64;break;case ge.FIXED32:case ge.SFIXED32:case ge.FLOAT:e=Jt.Bit32;break}const t=ge[n].toLowerCase();return[e,t]}function IS(){return{setEnumType:Ay,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const o=r.localName,s=e,l=n;if(l[o]!=null)switch(r.kind){case"oneof":const d=l[o].case;if(d===void 0)continue;const f=r.findField(d);let m=l[o].value;f&&f.kind=="message"&&!vo(m,f.T)?m=new f.T(m):f&&f.kind==="scalar"&&f.T===ge.BYTES&&(m=_l(m)),s[o]={case:d,value:m};break;case"scalar":case"enum":let v=l[o];r.T===ge.BYTES&&(v=r.repeated?v.map(_l):_l(v)),s[o]=v;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===ge.BYTES)for(const[S,M]of Object.entries(l[o]))s[o][S]=_l(M);else Object.assign(s[o],l[o]);break;case"message":const x=r.V.T;for(const S of Object.keys(l[o])){let M=l[o][S];x.fieldWrapper||(M=new x(M)),s[o][S]=M}break}break;case"message":const T=r.T;if(r.repeated)s[o]=l[o].map(x=>vo(x,T)?x:new T(x));else{const x=l[o];T.fieldWrapper?T.typeName==="google.protobuf.BytesValue"?s[o]=_l(x):s[o]=x:s[o]=vo(x,T)?x:new T(x)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const o=e[r.localName],s=t[r.localName];if(r.repeated){if(o.length!==s.length)return!1;switch(r.kind){case"message":return o.every((l,d)=>r.T.equals(l,s[d]));case"scalar":return o.every((l,d)=>ga(r.T,l,s[d]));case"enum":return o.every((l,d)=>ga(ge.INT32,l,s[d]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(o,s);case"enum":return ga(ge.INT32,o,s);case"scalar":return ga(r.T,o,s);case"oneof":if(o.case!==s.case)return!1;const l=r.findField(o.case);if(l===void 0)return!0;switch(l.kind){case"message":return l.T.equals(o.value,s.value);case"enum":return ga(ge.INT32,o.value,s.value);case"scalar":return ga(l.T,o.value,s.value)}throw new Error("oneof cannot contain ".concat(l.kind));case"map":const d=Object.keys(o).concat(Object.keys(s));switch(r.V.kind){case"message":const f=r.V.T;return d.every(v=>f.equals(o[v],s[v]));case"enum":return d.every(v=>ga(ge.INT32,o[v],s[v]));case"scalar":const m=r.V.T;return d.every(v=>ga(m,o[v],s[v]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const o of e.fields.byMember()){const s=n[o.localName];let l;if(o.repeated)l=s.map(wu);else if(o.kind=="map"){l=r[o.localName];for(const[d,f]of Object.entries(s))l[d]=wu(f)}else o.kind=="oneof"?l=o.findField(s.case)?{case:s.case,value:wu(s.value)}:{case:void 0}:l=wu(s);r[o.localName]=l}for(const o of e.runtime.bin.listUnknownFields(n))e.runtime.bin.onUnknownField(r,o.no,o.wireType,o.data);return t}}}function wu(n){if(n===void 0)return n;if(vo(n))return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function _l(n){return n instanceof Uint8Array?n:new Uint8Array(n)}function OS(n,e,t){return{syntax:n,json:wS(),bin:xS(),util:Object.assign(Object.assign({},IS()),{newFieldList:e,initFields:t}),makeMessageType(r,o,s){return aS(this,r,o,s)},makeEnum:iS,makeEnumType:Ly,getEnumType:rS,makeExtension(r,o,s){return pS(this,r,o,s)}}}class MS{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function Wy(n,e){const t=Gy(n);return e?t:US(DS(t))}function AS(n){return Wy(n,!1)}const LS=Gy;function Gy(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let o=n.charAt(r);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),t.push(o);break}}return t.join("")}const NS=new Set(["constructor","toString","toJSON","valueOf"]),jS=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Ky=n=>"".concat(n,"$"),DS=n=>jS.has(n)?Ky(n):n,US=n=>NS.has(n)?Ky(n):n;class FS{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=AS(e)}addField(e){Gt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function BS(n,e){var t,r,o,s,l,d;const f=[];let m;for(const v of typeof n=="function"?n():n){const T=v;if(T.localName=Wy(v.name,v.oneof!==void 0),T.jsonName=(t=v.jsonName)!==null&&t!==void 0?t:LS(v.name),T.repeated=(r=v.repeated)!==null&&r!==void 0?r:!1,v.kind=="scalar"&&(T.L=(o=v.L)!==null&&o!==void 0?o:Ea.BIGINT),T.delimited=(s=v.delimited)!==null&&s!==void 0?s:!1,T.req=(l=v.req)!==null&&l!==void 0?l:!1,T.opt=(d=v.opt)!==null&&d!==void 0?d:!1,v.packed===void 0&&(T.packed=v.kind=="enum"||v.kind=="scalar"&&v.T!=ge.BYTES&&v.T!=ge.STRING),v.oneof!==void 0){const x=typeof v.oneof=="string"?v.oneof:v.oneof.name;(!m||m.name!=x)&&(m=new FS(x)),T.oneof=m,m.addField(T)}f.push(T)}return f}const oe=OS("proto3",n=>new MS(n,e=>BS(e)),n=>{for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=Os(e.T,e.L);break}}});class nr extends kf{constructor(e){super(),this.seconds=Ut.zero,this.nanos=0,oe.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(oe.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ut.parse(o/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?r="."+o.substring(0,3)+"Z":o.substring(6)==="000"?r="."+o.substring(0,6)+"Z":r="."+o+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return nr.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new nr({seconds:Ut.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new nr().fromBinary(e,t)}static fromJson(e,t){return new nr().fromJson(e,t)}static fromJsonString(e,t){return new nr().fromJsonString(e,t)}static equals(e,t){return oe.util.equals(nr,e,t)}}nr.runtime=oe;nr.typeName="google.protobuf.Timestamp";nr.fields=oe.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const zS=oe.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:nr},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:VS,repeated:!0},{no:5,name:"events",kind:"message",T:qS,repeated:!0}]),VS=oe.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:HS,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),HS=oe.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:nr},{no:3,name:"value",kind:"scalar",T:2}]),qS=oe.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:nr},{no:7,name:"normalized_end_timestamp",kind:"message",T:nr,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),Zy=oe.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),Yr=oe.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),tn=oe.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),Ts=oe.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Nl=oe.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Ql=oe.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),ti=oe.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),gs=oe.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),$S=oe.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),wi=oe.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),Sf=oe.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ju,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:s0}]),Ju=oe.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),WS=oe.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:oe.getEnumType(tn),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Xl=oe.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:oe.getEnumType(bp)},{no:4,name:"tracks",kind:"message",T:ws,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:WS},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:oe.getEnumType(Yu)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:oe.getEnumType(ti)},{no:18,name:"kind_details",kind:"enum",T:oe.getEnumType(GS),repeated:!0}]),bp=oe.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Yu=oe.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),GS=oe.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),fr=oe.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),KS=oe.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:bo,repeated:!0}]),ws=oe.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:oe.getEnumType(Yr)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:oe.getEnumType(tn)},{no:10,name:"layers",kind:"message",T:bo,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:KS,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:oe.getEnumType(fr)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:s0},{no:19,name:"audio_features",kind:"enum",T:oe.getEnumType(wi),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:oe.getEnumType(Zy)}]),bo=oe.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:oe.getEnumType(Ts)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),tr=oe.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:oe.getEnumType(gt)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:Xy,oneof:"value"},{no:3,name:"speaker",kind:"message",T:ZS,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Jy,oneof:"value"},{no:7,name:"transcription",kind:"message",T:QS,oneof:"value"},{no:8,name:"metrics",kind:"message",T:zS,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:yp,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:Yy,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:e0,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:t0,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:kp,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:Cp,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:Sp,oneof:"value"}]),gt=oe.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),ZS=oe.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Qy,repeated:!0}]),Qy=oe.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),Xy=oe.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Jy=oe.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),QS=oe.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:XS,repeated:!0}]),XS=oe.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),yp=oe.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),Yy=oe.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),e0=oe.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),t0=oe.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:n0,oneof:"value"}]),n0=oe.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),r0=oe.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),JS=oe.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:oe.getEnumType(i0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),i0=oe.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),YS=oe.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:oe.getEnumType(a0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),a0=oe.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),o0=oe.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:jv},{no:2,name:"screen",kind:"message",T:jv},{no:3,name:"resume_connection",kind:"enum",T:oe.getEnumType(Ql)},{no:4,name:"disabled_codecs",kind:"message",T:eT},{no:5,name:"force_relay",kind:"enum",T:oe.getEnumType(Ql)}]),jv=oe.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:oe.getEnumType(Ql)}]),eT=oe.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Ju,repeated:!0},{no:2,name:"publish",kind:"message",T:Ju,repeated:!0}]),s0=oe.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),wp=oe.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),l0=oe.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:oe.getEnumType(wp)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),c0=oe.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),kp=oe.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:oe.getEnumType(fr)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:l0,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:c0,oneof:"content_header"}],{localName:"DataStream_Header"}),Cp=oe.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),Sp=oe.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),ei=oe.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Tp=oe.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),tT=oe.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),nT=oe.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Co,oneof:"message"},{no:2,name:"answer",kind:"message",T:Co,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Tf,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ep,oneof:"message"},{no:5,name:"mute",kind:"message",T:xf,oneof:"message"},{no:6,name:"subscription",kind:"message",T:fd,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:u0,oneof:"message"},{no:8,name:"leave",kind:"message",T:md,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:h0,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:g0,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:v0,oneof:"message"},{no:13,name:"simulate",kind:"message",T:vi,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:p0,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:y0,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:d0,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:sT,oneof:"message"}]),Dv=oe.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:rT,oneof:"message"},{no:2,name:"answer",kind:"message",T:Co,oneof:"message"},{no:3,name:"offer",kind:"message",T:Co,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Tf,oneof:"message"},{no:5,name:"update",kind:"message",T:oT,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Ef,oneof:"message"},{no:8,name:"leave",kind:"message",T:md,oneof:"message"},{no:9,name:"mute",kind:"message",T:xf,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:lT,oneof:"message"},{no:11,name:"room_update",kind:"message",T:cT,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:dT,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:pT,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:mT,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:gT,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:aT,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:iT,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:vT,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:wT,oneof:"message"},{no:22,name:"request_response",kind:"message",T:kT,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:CT,oneof:"message"}]),xp=oe.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),Ep=oe.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:oe.getEnumType(Yr)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:oe.getEnumType(tn)},{no:9,name:"layers",kind:"message",T:bo,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:xp,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:oe.getEnumType(fr)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:oe.getEnumType(Zy)}]),Tf=oe.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:oe.getEnumType(ei)},{no:3,name:"final",kind:"scalar",T:8}]),xf=oe.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),rT=oe.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Sf},{no:2,name:"participant",kind:"message",T:Xl},{no:3,name:"other_participants",kind:"message",T:Xl,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:f0,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:o0},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:JS},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Ju,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),iT=oe.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:f0,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:o0}]),Ef=oe.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ws}]),aT=oe.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Co=oe.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),oT=oe.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Xl,repeated:!0}]),fd=oe.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:r0,repeated:!0}]),u0=oe.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:oe.getEnumType(Ts)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),d0=oe.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:oe.getEnumType(wi),repeated:!0}]),sT=oe.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),md=oe.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:oe.getEnumType(ti)},{no:3,name:"action",kind:"enum",T:oe.getEnumType(xs)},{no:4,name:"regions",kind:"message",T:bT}]),xs=oe.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),h0=oe.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:bo,repeated:!0}]),p0=oe.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),f0=oe.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),lT=oe.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Qy,repeated:!0}]),cT=oe.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Sf}]),uT=oe.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:oe.getEnumType(Nl)},{no:3,name:"score",kind:"scalar",T:2}]),dT=oe.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:uT,repeated:!0}]),hT=oe.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:oe.getEnumType(Tp)}]),pT=oe.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:hT,repeated:!0}]),Pf=oe.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:oe.getEnumType(Ts)},{no:2,name:"enabled",kind:"scalar",T:8}]),fT=oe.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Pf,repeated:!0}]),mT=oe.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Pf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:fT,repeated:!0}]),m0=oe.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),g0=oe.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:m0,repeated:!0}]),gT=oe.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),v0=oe.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Co},{no:2,name:"subscription",kind:"message",T:fd},{no:3,name:"publish_tracks",kind:"message",T:Ef,repeated:!0},{no:4,name:"data_channels",kind:"message",T:b0,repeated:!0},{no:5,name:"offer",kind:"message",T:Co},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),b0=oe.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:oe.getEnumType(ei)}]),vi=oe.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:oe.getEnumType(tT),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),y0=oe.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),vT=oe.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),bT=oe.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:yT,repeated:!0}]),yT=oe.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),wT=oe.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:oe.getEnumType($S)}]),kT=oe.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:oe.getEnumType(_f)},{no:3,name:"message",kind:"scalar",T:9}]),_f=oe.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),CT=oe.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function ST(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Pp={exports:{}},TT=Pp.exports,Uv;function xT(){return Uv||(Uv=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(TT,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],s={},l=null;function d(N,V){var $=N[V];if(typeof $.bind=="function")return $.bind(N);try{return Function.prototype.bind.call($,N)}catch{return function(){return Function.prototype.apply.apply($,[N,arguments])}}}function f(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function m(N){return N==="debug"&&(N="log"),typeof console===t?!1:N==="trace"&&r?f:console[N]!==void 0?d(console,N):console.log!==void 0?d(console,"log"):e}function v(){for(var N=this.getLevel(),V=0;V<o.length;V++){var $=o[V];this[$]=V<N?e:this.methodFactory($,N,this.name)}if(this.log=this.debug,typeof console===t&&N<this.levels.SILENT)return"No console available for logging"}function T(N){return function(){typeof console!==t&&(v.call(this),this[N].apply(this,arguments))}}function x(N,V,$){return m(N)||T.apply(this,arguments)}function S(N,V){var $=this,ae,z,A,F="loglevel";typeof N=="string"?F+=":"+N:typeof N=="symbol"&&(F=void 0);function J(Y){var me=(o[Y]||"silent").toUpperCase();if(!(typeof window===t||!F)){try{window.localStorage[F]=me;return}catch{}try{window.document.cookie=encodeURIComponent(F)+"="+me+";"}catch{}}}function de(){var Y;if(!(typeof window===t||!F)){try{Y=window.localStorage[F]}catch{}if(typeof Y===t)try{var me=window.document.cookie,Le=encodeURIComponent(F),le=me.indexOf(Le+"=");le!==-1&&(Y=/^([^;]+)/.exec(me.slice(le+Le.length+1))[1])}catch{}return $.levels[Y]===void 0&&(Y=void 0),Y}}function te(){if(!(typeof window===t||!F)){try{window.localStorage.removeItem(F)}catch{}try{window.document.cookie=encodeURIComponent(F)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function K(Y){var me=Y;if(typeof me=="string"&&$.levels[me.toUpperCase()]!==void 0&&(me=$.levels[me.toUpperCase()]),typeof me=="number"&&me>=0&&me<=$.levels.SILENT)return me;throw new TypeError("log.setLevel() called with invalid level: "+Y)}$.name=N,$.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},$.methodFactory=V||x,$.getLevel=function(){return A??z??ae},$.setLevel=function(Y,me){return A=K(Y),me!==!1&&J(A),v.call($)},$.setDefaultLevel=function(Y){z=K(Y),de()||$.setLevel(Y,!1)},$.resetLevel=function(){A=null,te(),v.call($)},$.enableAll=function(Y){$.setLevel($.levels.TRACE,Y)},$.disableAll=function(Y){$.setLevel($.levels.SILENT,Y)},$.rebuild=function(){if(l!==$&&(ae=K(l.getLevel())),v.call($),l===$)for(var Y in s)s[Y].rebuild()},ae=K(l?l.getLevel():"WARN");var ne=de();ne!=null&&(A=K(ne)),v.call($)}l=new S,l.getLogger=function(N){if(typeof N!="symbol"&&typeof N!="string"||N==="")throw new TypeError("You must supply a name when creating a logger.");var V=s[N];return V||(V=s[N]=new S(N,l.methodFactory)),V};var M=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=M),l},l.getLoggers=function(){return s},l.default=l,l})}(Pp)),Pp.exports}var gd=xT(),_p;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(_p||(_p={}));var ni;(function(n){n.Default="livekit",n.Room="livekit-room",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(ni||(ni={}));let ht=gd.getLogger("livekit");const ET=Object.values(ni).map(n=>gd.getLogger(n));ht.setDefaultLevel(_p.info);function $i(n){const e=gd.getLogger(n);return e.setDefaultLevel(ht.getLevel()),e}function PT(n,e){for(const t of ET)t.setLevel(n)}const _T=gd.getLogger("lk-e2ee"),Rl=7e3,RT=[0,300,2*2*300,3*3*300,4*4*300,Rl,Rl,Rl,Rl,Rl];class IT{constructor(e){this._retryDelays=e!==void 0?[...e]:RT}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function OT(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function U(n,e,t,r){function o(s){return s instanceof t?s:new t(function(l){l(s)})}return new(t||(t=Promise))(function(s,l){function d(v){try{m(r.next(v))}catch(T){l(T)}}function f(v){try{m(r.throw(v))}catch(T){l(T)}}function m(v){v.done?s(v.value):o(v.value).then(d,f)}m((r=r.apply(n,e||[])).next())})}function Fv(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wa(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Fv=="function"?Fv(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(l){return new Promise(function(d,f){l=n[s](l),o(d,f,l.done,l.value)})}}function o(s,l,d,f){Promise.resolve(f).then(function(m){s({value:m,done:d})},l)}}var ku={exports:{}},Bv;function MT(){if(Bv)return ku.exports;Bv=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(A,F,J){return Function.prototype.apply.call(A,F,J)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:t=function(A){return Object.getOwnPropertyNames(A)};function r(A){console&&console.warn&&console.warn(A)}var o=Number.isNaN||function(A){return A!==A};function s(){s.init.call(this)}ku.exports=s,ku.exports.once=$,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function d(A){if(typeof A!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(A){if(typeof A!="number"||A<0||o(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");l=A}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||o(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function f(A){return A._maxListeners===void 0?s.defaultMaxListeners:A._maxListeners}s.prototype.getMaxListeners=function(){return f(this)},s.prototype.emit=function(A){for(var F=[],J=1;J<arguments.length;J++)F.push(arguments[J]);var de=A==="error",te=this._events;if(te!==void 0)de=de&&te.error===void 0;else if(!de)return!1;if(de){var K;if(F.length>0&&(K=F[0]),K instanceof Error)throw K;var ne=new Error("Unhandled error."+(K?" ("+K.message+")":""));throw ne.context=K,ne}var Y=te[A];if(Y===void 0)return!1;if(typeof Y=="function")e(Y,this,F);else for(var me=Y.length,Le=M(Y,me),J=0;J<me;++J)e(Le[J],this,F);return!0};function m(A,F,J,de){var te,K,ne;if(d(J),K=A._events,K===void 0?(K=A._events=Object.create(null),A._eventsCount=0):(K.newListener!==void 0&&(A.emit("newListener",F,J.listener?J.listener:J),K=A._events),ne=K[F]),ne===void 0)ne=K[F]=J,++A._eventsCount;else if(typeof ne=="function"?ne=K[F]=de?[J,ne]:[ne,J]:de?ne.unshift(J):ne.push(J),te=f(A),te>0&&ne.length>te&&!ne.warned){ne.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+ne.length+" "+String(F)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=A,Y.type=F,Y.count=ne.length,r(Y)}return A}s.prototype.addListener=function(A,F){return m(this,A,F,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(A,F){return m(this,A,F,!0)};function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(A,F,J){var de={fired:!1,wrapFn:void 0,target:A,type:F,listener:J},te=v.bind(de);return te.listener=J,de.wrapFn=te,te}s.prototype.once=function(A,F){return d(F),this.on(A,T(this,A,F)),this},s.prototype.prependOnceListener=function(A,F){return d(F),this.prependListener(A,T(this,A,F)),this},s.prototype.removeListener=function(A,F){var J,de,te,K,ne;if(d(F),de=this._events,de===void 0)return this;if(J=de[A],J===void 0)return this;if(J===F||J.listener===F)--this._eventsCount===0?this._events=Object.create(null):(delete de[A],de.removeListener&&this.emit("removeListener",A,J.listener||F));else if(typeof J!="function"){for(te=-1,K=J.length-1;K>=0;K--)if(J[K]===F||J[K].listener===F){ne=J[K].listener,te=K;break}if(te<0)return this;te===0?J.shift():N(J,te),J.length===1&&(de[A]=J[0]),de.removeListener!==void 0&&this.emit("removeListener",A,ne||F)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(A){var F,J,de;if(J=this._events,J===void 0)return this;if(J.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):J[A]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete J[A]),this;if(arguments.length===0){var te=Object.keys(J),K;for(de=0;de<te.length;++de)K=te[de],K!=="removeListener"&&this.removeAllListeners(K);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(F=J[A],typeof F=="function")this.removeListener(A,F);else if(F!==void 0)for(de=F.length-1;de>=0;de--)this.removeListener(A,F[de]);return this};function x(A,F,J){var de=A._events;if(de===void 0)return[];var te=de[F];return te===void 0?[]:typeof te=="function"?J?[te.listener||te]:[te]:J?V(te):M(te,te.length)}s.prototype.listeners=function(A){return x(this,A,!0)},s.prototype.rawListeners=function(A){return x(this,A,!1)},s.listenerCount=function(A,F){return typeof A.listenerCount=="function"?A.listenerCount(F):S.call(A,F)},s.prototype.listenerCount=S;function S(A){var F=this._events;if(F!==void 0){var J=F[A];if(typeof J=="function")return 1;if(J!==void 0)return J.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function M(A,F){for(var J=new Array(F),de=0;de<F;++de)J[de]=A[de];return J}function N(A,F){for(;F+1<A.length;F++)A[F]=A[F+1];A.pop()}function V(A){for(var F=new Array(A.length),J=0;J<F.length;++J)F[J]=A[J].listener||A[J];return F}function $(A,F){return new Promise(function(J,de){function te(ne){A.removeListener(F,K),de(ne)}function K(){typeof A.removeListener=="function"&&A.removeListener("error",te),J([].slice.call(arguments))}z(A,F,K,{once:!0}),F!=="error"&&ae(A,te,{once:!0})})}function ae(A,F,J){typeof A.on=="function"&&z(A,"error",F,J)}function z(A,F,J,de){if(typeof A.on=="function")de.once?A.once(F,J):A.on(F,J);else if(typeof A.addEventListener=="function")A.addEventListener(F,function te(K){de.once&&A.removeEventListener(F,te),J(K)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A)}return ku.exports}var Si=MT();let w0=!0,k0=!0;function Au(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseInt(r[t],10)}function xo(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(l,d){if(l!==e)return o.apply(this,arguments);const f=m=>{const v=t(m);v&&(d.handleEvent?d.handleEvent(v):d(v))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(d,f),o.apply(this,[l,f])};const s=r.removeEventListener;r.removeEventListener=function(l,d){if(l!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(d))return s.apply(this,arguments);const f=this._eventMap[e].get(d);return this._eventMap[e].delete(d),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[l,f])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(l){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),l&&this.addEventListener(e,this["_on"+e]=l)},enumerable:!0,configurable:!0})}function AT(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(w0=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function LT(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(k0=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function C0(){if(typeof window=="object"){if(w0)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Rf(n,e){k0&&console.warn(n+" is deprecated, please use "+e+" instead.")}function NT(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(o=>o.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=Au(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=Au(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Au(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function zv(n){return Object.prototype.toString.call(n)==="[object Object]"}function S0(n){return zv(n)?Object.keys(n).reduce(function(e,t){const r=zv(n[t]),o=r?S0(n[t]):n[t],s=r&&!Object.keys(o).length;return o===void 0||s?e:Object.assign(e,{[t]:o})},{}):n}function Rp(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Rp(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(o=>{Rp(n,n.get(o),t)})}))}function Vv(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const s=[];return n.forEach(l=>{l.type==="track"&&l.trackIdentifier===e.id&&s.push(l)}),s.forEach(l=>{n.forEach(d=>{d.type===r&&d.trackId===l.id&&Rp(n,d,o)})}),o}const Hv=C0;function T0(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(d){if(typeof d!="object"||d.mandatory||d.optional)return d;const f={};return Object.keys(d).forEach(m=>{if(m==="require"||m==="advanced"||m==="mediaSource")return;const v=typeof d[m]=="object"?d[m]:{ideal:d[m]};v.exact!==void 0&&typeof v.exact=="number"&&(v.min=v.max=v.exact);const T=function(x,S){return x?x+S.charAt(0).toUpperCase()+S.slice(1):S==="deviceId"?"sourceId":S};if(v.ideal!==void 0){f.optional=f.optional||[];let x={};typeof v.ideal=="number"?(x[T("min",m)]=v.ideal,f.optional.push(x),x={},x[T("max",m)]=v.ideal,f.optional.push(x)):(x[T("",m)]=v.ideal,f.optional.push(x))}v.exact!==void 0&&typeof v.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[T("",m)]=v.exact):["min","max"].forEach(x=>{v[x]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[T(x,m)]=v[x])})}),d.advanced&&(f.optional=(f.optional||[]).concat(d.advanced)),f},o=function(d,f){if(e.version>=61)return f(d);if(d=JSON.parse(JSON.stringify(d)),d&&typeof d.audio=="object"){const m=function(v,T,x){T in v&&!(x in v)&&(v[x]=v[T],delete v[T])};d=JSON.parse(JSON.stringify(d)),m(d.audio,"autoGainControl","googAutoGainControl"),m(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=r(d.audio)}if(d&&typeof d.video=="object"){let m=d.video.facingMode;m=m&&(typeof m=="object"?m:{ideal:m});const v=e.version<66;if(m&&(m.exact==="user"||m.exact==="environment"||m.ideal==="user"||m.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!v)){delete d.video.facingMode;let T;if(m.exact==="environment"||m.ideal==="environment"?T=["back","rear"]:(m.exact==="user"||m.ideal==="user")&&(T=["front"]),T)return t.mediaDevices.enumerateDevices().then(x=>{x=x.filter(M=>M.kind==="videoinput");let S=x.find(M=>T.some(N=>M.label.toLowerCase().includes(N)));return!S&&x.length&&T.includes("back")&&(S=x[x.length-1]),S&&(d.video.deviceId=m.exact?{exact:S.deviceId}:{ideal:S.deviceId}),d.video=r(d.video),Hv("chrome: "+JSON.stringify(d)),f(d)})}d.video=r(d.video)}return Hv("chrome: "+JSON.stringify(d)),f(d)},s=function(d){return e.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},l=function(d,f,m){o(d,v=>{t.webkitGetUserMedia(v,f,T=>{m&&m(s(T))})})};if(t.getUserMedia=l.bind(t),t.mediaDevices.getUserMedia){const d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(f){return o(f,m=>d(m).then(v=>{if(m.audio&&!v.getAudioTracks().length||m.video&&!v.getVideoTracks().length)throw v.getTracks().forEach(T=>{T.stop()}),new DOMException("","NotFoundError");return v},v=>Promise.reject(s(v))))}}}function x0(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function E0(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",r=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===r.track.id):o={track:r.track};const s=new Event("track");s.track=r.track,s.receiver=o,s.transceiver={receiver:o},s.streams=[t.stream],this.dispatchEvent(s)}),t.stream.getTracks().forEach(r=>{let o;n.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===r.id):o={track:r};const s=new Event("track");s.track=r,s.receiver=o,s.transceiver={receiver:o},s.streams=[t.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else xo(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function P0(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(o,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=o.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:o}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(l,d){let f=o.apply(this,arguments);return f||(f=e(this,l),this._senders.push(f)),f};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(l){s.apply(this,arguments);const d=this._senders.indexOf(l);d!==-1&&this._senders.splice(d,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(s=>{const l=this._senders.find(d=>d.track===s);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const t=e.apply(this,[]);return t.forEach(r=>r._pc=this),t},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function _0(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const o=t.apply(this,[]);return o.forEach(s=>s._pc=this),o});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),n.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(s=>Vv(s,o.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(o=>o._pc=this),r}),xo(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(o=>Vv(o,r.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const t=arguments[0];let r,o,s;return this.getSenders().forEach(l=>{l.track===t&&(r?s=!0:r=l)}),this.getReceivers().forEach(l=>(l.track===t&&(o?s=!0:o=l),l.track===t)),s||r&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function R0(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(s,l){if(!l)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const d=e.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(d)===-1&&this._shimmedLocalStreams[l.id].push(d):this._shimmedLocalStreams[l.id]=[l,d],d};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(f=>{if(this.getSenders().find(m=>m.track===f))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();t.apply(this,arguments);const d=this.getSenders().filter(f=>l.indexOf(f)===-1);this._shimmedLocalStreams[s.id]=[s].concat(d)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const o=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const d=this._shimmedLocalStreams[l].indexOf(s);d!==-1&&this._shimmedLocalStreams[l].splice(d,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),o.apply(this,arguments)}}function I0(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return R0(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const m=t.apply(this);return this._reverseStreams=this._reverseStreams||{},m.map(v=>this._reverseStreams[v.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(m){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},m.getTracks().forEach(v=>{if(this.getSenders().find(T=>T.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[m.id]){const v=new n.MediaStream(m.getTracks());this._streams[m.id]=v,this._reverseStreams[v.id]=m,m=v}r.apply(this,[m])};const o=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(m){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[m.id]||m]),delete this._reverseStreams[this._streams[m.id]?this._streams[m.id].id:m.id],delete this._streams[m.id]},n.RTCPeerConnection.prototype.addTrack=function(m,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const T=[].slice.call(arguments,1);if(T.length!==1||!T[0].getTracks().find(S=>S===m))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(S=>S.track===m))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const x=this._streams[v.id];if(x)x.addTrack(m),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const S=new n.MediaStream([m]);this._streams[v.id]=S,this._reverseStreams[S.id]=v,this.addStream(S)}return this.getSenders().find(S=>S.track===m)};function s(m,v){let T=v.sdp;return Object.keys(m._reverseStreams||[]).forEach(x=>{const S=m._reverseStreams[x],M=m._streams[S.id];T=T.replace(new RegExp(M.id,"g"),S.id)}),new RTCSessionDescription({type:v.type,sdp:T})}function l(m,v){let T=v.sdp;return Object.keys(m._reverseStreams||[]).forEach(x=>{const S=m._reverseStreams[x],M=m._streams[S.id];T=T.replace(new RegExp(S.id,"g"),M.id)}),new RTCSessionDescription({type:v.type,sdp:T})}["createOffer","createAnswer"].forEach(function(m){const v=n.RTCPeerConnection.prototype[m],T={[m](){const x=arguments;return arguments.length&&typeof arguments[0]=="function"?v.apply(this,[S=>{const M=s(this,S);x[0].apply(null,[M])},S=>{x[1]&&x[1].apply(null,S)},arguments[2]]):v.apply(this,arguments).then(S=>s(this,S))}};n.RTCPeerConnection.prototype[m]=T[m]});const d=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?d.apply(this,arguments):(arguments[0]=l(this,arguments[0]),d.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const m=f.get.apply(this);return m.type===""?m:s(this,m)}}),n.RTCPeerConnection.prototype.removeTrack=function(m){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!m._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(m._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let v;Object.keys(this._streams).forEach(T=>{this._streams[T].getTracks().find(x=>m.track===x)&&(v=this._streams[T])}),v&&(v.getTracks().length===1?this.removeStream(this._reverseStreams[v.id]):v.removeTrack(m.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Ip(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],o={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=o[t]})}function O0(n,e){xo(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}var qv=Object.freeze({__proto__:null,fixNegotiationNeeded:O0,shimAddTrackRemoveTrack:I0,shimAddTrackRemoveTrackWithNative:R0,shimGetSendersWithDtmf:P0,shimGetUserMedia:T0,shimMediaStream:x0,shimOnTrack:E0,shimPeerConnection:Ip,shimSenderReceiverGetStats:_0});function M0(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(o,s,l){Rf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(o).then(s,l)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const o=function(l,d,f){d in l&&!(f in l)&&(l[f]=l[d],delete l[d])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(l){return typeof l=="object"&&typeof l.audio=="object"&&(l=JSON.parse(JSON.stringify(l)),o(l.audio,"autoGainControl","mozAutoGainControl"),o(l.audio,"noiseSuppression","mozNoiseSuppression")),s(l)},r&&r.prototype.getSettings){const l=r.prototype.getSettings;r.prototype.getSettings=function(){const d=l.apply(this,arguments);return o(d,"mozAutoGainControl","autoGainControl"),o(d,"mozNoiseSuppression","noiseSuppression"),d}}if(r&&r.prototype.applyConstraints){const l=r.prototype.applyConstraints;r.prototype.applyConstraints=function(d){return this.kind==="audio"&&typeof d=="object"&&(d=JSON.parse(JSON.stringify(d)),o(d,"autoGainControl","mozAutoGainControl"),o(d,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[d])}}}}function jT(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(t){if(!(t&&t.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return t.video===!0?t.video={mediaSource:e}:t.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(t)})}function A0(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Op(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const s=n.RTCPeerConnection.prototype[o],l={[o](){return arguments[0]=new(o==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[o]=l[o]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[o,s,l]=arguments;return r.apply(this,[o||null]).then(d=>{if(e.version<53&&!s)try{d.forEach(f=>{f.type=t[f.type]||f.type})}catch(f){if(f.name!=="TypeError")throw f;d.forEach((m,v)=>{d.set(v,Object.assign({},m,{type:t[m.type]||m.type}))})}return d}).then(s,l)}}function L0(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(o=>o._pc=this),r});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const r=t.apply(this,arguments);return r._pc=this,r}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function N0(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const t=e.apply(this,[]);return t.forEach(r=>r._pc=this),t}),xo(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function j0(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(e){Rf("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function D0(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function U0(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let t=arguments[1]&&arguments[1].sendEncodings;t===void 0&&(t=[]),t=[...t];const r=t.length>0;r&&t.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(r){const{sender:s}=o,l=s.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=t,s.sendEncodings=t,this.setParametersPromises.push(s.setParameters(l).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return o})}function F0(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const t=e.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}function B0(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function z0(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var $v=Object.freeze({__proto__:null,shimAddTransceiver:U0,shimCreateAnswer:z0,shimCreateOffer:B0,shimGetDisplayMedia:jT,shimGetParameters:F0,shimGetUserMedia:M0,shimOnTrack:A0,shimPeerConnection:Op,shimRTCDataChannel:D0,shimReceiverGetStats:N0,shimRemoveStream:j0,shimSenderGetStats:L0});function V0(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(r=>e.call(this,r,t)),t.getVideoTracks().forEach(r=>e.call(this,r,t))},n.RTCPeerConnection.prototype.addTrack=function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o&&o.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(t===-1)return;this._localStreams.splice(t,1);const r=e.getTracks();this.getSenders().forEach(o=>{r.includes(o.track)&&this.removeTrack(o)})})}}function H0(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,this.dispatchEvent(s)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(o=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(o)>=0)return;t._remoteStreams.push(o);const s=new Event("addstream");s.stream=o,t.dispatchEvent(s)})}),e.apply(t,arguments)}}}function q0(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,o=e.setLocalDescription,s=e.setRemoteDescription,l=e.addIceCandidate;e.createOffer=function(f,m){const v=arguments.length>=2?arguments[2]:arguments[0],T=t.apply(this,[v]);return m?(T.then(f,m),Promise.resolve()):T},e.createAnswer=function(f,m){const v=arguments.length>=2?arguments[2]:arguments[0],T=r.apply(this,[v]);return m?(T.then(f,m),Promise.resolve()):T};let d=function(f,m,v){const T=o.apply(this,[f]);return v?(T.then(m,v),Promise.resolve()):T};e.setLocalDescription=d,d=function(f,m,v){const T=s.apply(this,[f]);return v?(T.then(m,v),Promise.resolve()):T},e.setRemoteDescription=d,d=function(f,m,v){const T=l.apply(this,[f]);return v?(T.then(m,v),Promise.resolve()):T},e.addIceCandidate=d}function $0(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=o=>r(W0(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(t,r,o){e.mediaDevices.getUserMedia(t).then(r,o)}).bind(e))}function W0(n){return n&&n.video!==void 0?Object.assign({},n,{video:S0(n.video)}):n}function G0(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(t,r){if(t&&t.iceServers){const o=[];for(let s=0;s<t.iceServers.length;s++){let l=t.iceServers[s];l.urls===void 0&&l.url?(Rf("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,o.push(l)):o.push(t.iceServers[s])}t.iceServers=o}return new e(t,r)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function K0(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Z0(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(t){if(t){typeof t.offerToReceiveAudio<"u"&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const r=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");t.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):t.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof t.offerToReceiveVideo<"u"&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const o=this.getTransceivers().find(s=>s.receiver.track.kind==="video");t.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):t.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Q0(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var Wv=Object.freeze({__proto__:null,shimAudioContext:Q0,shimCallbacksAPI:q0,shimConstraints:W0,shimCreateOfferLegacy:Z0,shimGetUserMedia:$0,shimLocalStreamsAPI:V0,shimRTCIceServerUrls:G0,shimRemoteStreamsAPI:H0,shimTrackEventTransceiver:K0}),Gv={exports:{}},Kv;function DT(){return Kv||(Kv=1,function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((r,o)=>(o>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(o=>o.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const o={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":o.relatedAddress=r[s+1];break;case"rport":o.relatedPort=parseInt(r[s+1],10);break;case"tcptype":o.tcpType=r[s+1];break;case"ufrag":o.ufrag=r[s+1],o.usernameFragment=r[s+1];break;default:o[r[s]]===void 0&&(o[r[s]]=r[s+1]);break}return o},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const o=t.component;o==="rtp"?r.push(1):o==="rtcp"?r.push(2):r.push(o),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const s=t.type;return r.push("typ"),r.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const o={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),o.name=r[0],o.clockRate=parseInt(r[1],10),o.channels=r.length===3?parseInt(r[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const o=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let o;const s=t.substring(t.indexOf(" ")+1).split(";");for(let l=0;l<s.length;l++)o=s[l].trim().split("="),r[o[0].trim()]=o[1];return r},e.writeFmtp=function(t){let r="",o=t.payloadType;if(t.preferredPayloadType!==void 0&&(o=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(l=>{t.parameters[l]!==void 0?s.push(l+"="+t.parameters[l]):s.push(l)}),r+="a=fmtp:"+o+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",o=t.payloadType;return t.preferredPayloadType!==void 0&&(o=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+o+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),o={ssrc:parseInt(t.substring(7,r),10)},s=t.indexOf(":",r);return s>-1?(o.attribute=t.substring(r+1,s),o.value=t.substring(s+1)):o.attribute=t.substring(r+1),o},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(o=>parseInt(o,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let o="a=setup:"+r+`\r
`;return t.fingerprints.forEach(s=>{o+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),o},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const o=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return o&&s?{usernameFragment:o.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(t)[0].split(" ");r.profile=o[2];for(let l=3;l<o.length;l++){const d=o[l],f=e.matchPrefix(t,"a=rtpmap:"+d+" ")[0];if(f){const m=e.parseRtpMap(f),v=e.matchPrefix(t,"a=fmtp:"+d+" ");switch(m.parameters=v.length?e.parseFmtp(v[0]):{},m.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+d+" ").map(e.parseRtcpFb),r.codecs.push(m),m.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(m.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(l=>{r.headerExtensions.push(e.parseExtmap(l))});const s=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(l=>{s.forEach(d=>{l.rtcpFeedback.find(f=>f.type===d.type&&f.parameter===d.parameter)||l.rtcpFeedback.push(d)})}),r},e.writeRtpDescription=function(t,r){let o="";o+="m="+t+" ",o+=r.codecs.length>0?"9":"0",o+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=r.codecs.map(l=>l.preferredPayloadType!==void 0?l.preferredPayloadType:l.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(l=>{o+=e.writeRtpMap(l),o+=e.writeFmtp(l),o+=e.writeRtcpFb(l)});let s=0;return r.codecs.forEach(l=>{l.maxptime>s&&(s=l.maxptime)}),s>0&&(o+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(l=>{o+=e.writeExtmap(l)}),o},e.parseRtpEncodingParameters=function(t){const r=[],o=e.parseRtpParameters(t),s=o.fecMechanisms.indexOf("RED")!==-1,l=o.fecMechanisms.indexOf("ULPFEC")!==-1,d=e.matchPrefix(t,"a=ssrc:").map(x=>e.parseSsrcMedia(x)).filter(x=>x.attribute==="cname"),f=d.length>0&&d[0].ssrc;let m;const v=e.matchPrefix(t,"a=ssrc-group:FID").map(x=>x.substring(17).split(" ").map(S=>parseInt(S,10)));v.length>0&&v[0].length>1&&v[0][0]===f&&(m=v[0][1]),o.codecs.forEach(x=>{if(x.name.toUpperCase()==="RTX"&&x.parameters.apt){let S={ssrc:f,codecPayloadType:parseInt(x.parameters.apt,10)};f&&m&&(S.rtx={ssrc:m}),r.push(S),s&&(S=JSON.parse(JSON.stringify(S)),S.fec={ssrc:f,mechanism:l?"red+ulpfec":"red"},r.push(S))}}),r.length===0&&f&&r.push({ssrc:f});let T=e.matchPrefix(t,"b=");return T.length&&(T[0].indexOf("b=TIAS:")===0?T=parseInt(T[0].substring(7),10):T[0].indexOf("b=AS:")===0?T=parseInt(T[0].substring(5),10)*1e3*.95-50*40*8:T=void 0,r.forEach(x=>{x.maxBitrate=T})),r},e.parseRtcpParameters=function(t){const r={},o=e.matchPrefix(t,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];o&&(r.cname=o.value,r.ssrc=o.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const l=e.matchPrefix(t,"a=rtcp-mux");return r.mux=l.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const o=e.matchPrefix(t,"a=msid:");if(o.length===1)return r=o[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(t,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),o=e.matchPrefix(t,"a=max-message-size:");let s;o.length>0&&(s=parseInt(o[0].substring(19),10)),isNaN(s)&&(s=65536);const l=e.matchPrefix(t,"a=sctp-port:");if(l.length>0)return{port:parseInt(l[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const d=e.matchPrefix(t,"a=sctpmap:");if(d.length>0){const f=d[0].substring(10).split(" ");return{port:parseInt(f[0],10),protocol:f[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){let o=[];return t.protocol!=="DTLS/SCTP"?o=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:o=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&o.push("a=max-message-size:"+r.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,o){let s;const l=r!==void 0?r:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+s+" "+l+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const o=e.splitLines(t);for(let s=0;s<o.length;s++)switch(o[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const r=e.splitLines(t)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(t){const r=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let o=0;o<r.length;o++)if(r[o].length<2||r[o].charAt(1)!=="=")return!1;return!0},n.exports=e}(Gv)),Gv.exports}var X0=DT(),Es=ST(X0),UT=ZC({__proto__:null,default:Es},[X0]);function Lu(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(t){if(typeof t=="object"&&t.candidate&&t.candidate.indexOf("a=")===0&&(t=JSON.parse(JSON.stringify(t)),t.candidate=t.candidate.substring(2)),t.candidate&&t.candidate.length){const r=new e(t),o=Es.parseCandidate(t.candidate);for(const s in o)s in r||Object.defineProperty(r,s,{value:o[s]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(t)},n.RTCIceCandidate.prototype=e.prototype,xo(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Mp(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||xo(n,"icecandidate",e=>{if(e.candidate){const t=Es.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Nu(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(d){if(!d||!d.sdp)return!1;const f=Es.splitSections(d.sdp);return f.shift(),f.some(m=>{const v=Es.parseMLine(m);return v&&v.kind==="application"&&v.protocol.indexOf("SCTP")!==-1})},r=function(d){const f=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const m=parseInt(f[1],10);return m!==m?-1:m},o=function(d){let f=65536;return e.browser==="firefox"&&(e.version<57?d===-1?f=16384:f=2147483637:e.version<60?f=e.version===57?65535:65536:f=2147483637),f},s=function(d,f){let m=65536;e.browser==="firefox"&&e.version===57&&(m=65535);const v=Es.matchPrefix(d.sdp,"a=max-message-size:");return v.length>0?m=parseInt(v[0].substring(19),10):e.browser==="firefox"&&f!==-1&&(m=2147483637),m},l=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:d}=this.getConfiguration();d==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const d=r(arguments[0]),f=o(d),m=s(arguments[0],d);let v;f===0&&m===0?v=Number.POSITIVE_INFINITY:f===0||m===0?v=Math.max(f,m):v=Math.min(f,m);const T={};Object.defineProperty(T,"maxMessageSize",{get(){return v}}),this._sctp=T}return l.apply(this,arguments)}}function ju(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,o){const s=r.send;r.send=function(){const l=arguments[0],d=l.length||l.size||l.byteLength;if(r.readyState==="open"&&o.sctp&&d>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const r=t.apply(this,arguments);return e(r,this),r},xo(n,"datachannel",r=>(e(r.channel,r.target),r))}function Ap(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const s=o.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const l=new Event("connectionstatechange",o);s.dispatchEvent(l)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Lp(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=r.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&r instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:r.type,sdp:o}):r.sdp=o}return t.apply(this,arguments)}}function Du(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Uu(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return t.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?t.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>t.apply(this,[o]))})}var FT=Object.freeze({__proto__:null,removeExtmapAllowMixed:Lp,shimAddIceCandidateNullOrEmpty:Du,shimConnectionState:Ap,shimMaxMessageSize:Nu,shimParameterlessSetLocalDescription:Uu,shimRTCIceCandidate:Lu,shimRTCIceCandidateRelayProtocol:Mp,shimSendThrowTypeError:ju});function BT(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=C0,r=NT(n),o={browserDetails:r,commonShim:FT,extractVersion:Au,disableLog:AT,disableWarnings:LT,sdp:UT};switch(r.browser){case"chrome":if(!qv||!Ip||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),o;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),o;t("adapter.js shimming chrome."),o.browserShim=qv,Du(n,r),Uu(n),T0(n,r),x0(n),Ip(n,r),E0(n),I0(n,r),P0(n),_0(n),O0(n,r),Lu(n),Mp(n),Ap(n),Nu(n,r),ju(n),Lp(n,r);break;case"firefox":if(!$v||!Op||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),o;t("adapter.js shimming firefox."),o.browserShim=$v,Du(n,r),Uu(n),M0(n,r),Op(n,r),A0(n),j0(n),L0(n),N0(n),D0(n),U0(n),F0(n),B0(n),z0(n),Lu(n),Ap(n),Nu(n,r),ju(n);break;case"safari":if(!Wv||!e.shimSafari)return t("Safari shim is not included in this adapter release."),o;t("adapter.js shimming safari."),o.browserShim=Wv,Du(n,r),Uu(n),G0(n),Z0(n),q0(n),V0(n),H0(n),K0(n),$0(n),Q0(n),Lu(n),Mp(n),Nu(n,r),ju(n),Lp(n,r);break;default:t("Unsupported browser!");break}return o}BT({window:typeof window>"u"?void 0:window});const zT=10,Cu="lk_e2ee",VT="LKFrameEncryptionKey",HT={sharedKey:!1,ratchetSalt:VT,ratchetWindowSize:8,failureTolerance:zT,keyringSize:16};var Ta;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(Ta||(Ta={}));var Zv;(function(n){n.KeyRatcheted="keyRatcheted"})(Zv||(Zv={}));var Sa;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(Sa||(Sa={}));var Qv;(function(n){n.Error="cryptorError"})(Qv||(Qv={}));function qT(){return $T()||Np()}function Np(){return typeof window.RTCRtpScriptTransform<"u"}function $T(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class S_ extends Si.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,r)=>{ht.debug("key ratcheted event received",{material:t,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},HT),e),this.on(Ta.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,r){const o={key:e,participantIdentity:t,keyIndex:r};if(!this.options.sharedKey&&!t)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(t??"shared","-").concat(r??0),o),this.emit(Ta.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(Ta.RatchetRequest,e,t)}}class _a extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var pt;(function(n){n[n.NotAllowed=0]="NotAllowed",n[n.ServerUnreachable=1]="ServerUnreachable",n[n.InternalError=2]="InternalError",n[n.Cancelled=3]="Cancelled",n[n.LeaveRequest=4]="LeaveRequest"})(pt||(pt={}));class Rt extends _a{constructor(e,t,r,o){super(1,e),this.name="ConnectionError",this.status=r,this.reason=t,this.context=o,this.reasonName=pt[t]}}class If extends _a{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class Hi extends _a{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class WT extends _a{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class sn extends _a{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class jp extends _a{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class GT extends _a{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class Xv extends _a{constructor(e,t){super(15,e),this.reason=t,this.reasonName=typeof t=="string"?t:_f[t]}}var ed;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(ed||(ed={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(ed||(ed={}));var Jv;(function(n){n[n.InvalidKey=0]="InvalidKey",n[n.MissingKey=1]="MissingKey",n[n.InternalError=2]="InternalError"})(Jv||(Jv={}));var Te;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.ParticipantAttributesChanged="participantAttributesChanged",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged",n.ChatMessage="chatMessage",n.LocalTrackSubscribed="localTrackSubscribed",n.MetricsReceived="metricsReceived"})(Te||(Te={}));var Ae;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded",n.AttributesChanged="attributesChanged",n.LocalTrackSubscribed="localTrackSubscribed",n.ChatMessage="chatMessage"})(Ae||(Ae={}));var Me;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackSubscribed="localTrackSubscribed",n.Offline="offline",n.SignalRequestResponse="signalRequestResponse"})(Me||(Me={}));var _e;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed",n.TrackProcessorUpdate="trackProcessorUpdate",n.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",n.TranscriptionReceived="transcriptionReceived",n.TimeSyncUpdate="timeSyncUpdate"})(_e||(_e={}));function KT(n){if(!(typeof n>"u"))return typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}const ZT=/version\/(\d+(\.?_?\d+)+)/i;let Qh;function ri(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(Qh===void 0||e){const r=QT.find(o=>{let{test:s}=o;return s.test(t)});Qh=r==null?void 0:r.describe(t)}return Qh}const QT=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:Fu(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:Xh(n)}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:Fu(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0,osVersion:Xh(n)}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:Fu(ZT,n),os:n.includes("mobile/")?"iOS":"macOS",osVersion:Xh(n)}}}];function Fu(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(n);return r&&r.length>=t&&r[t]||""}function Xh(n){return n.includes("mac os")?Fu(/\(.+?(\d+_\d+(:?_\d+)?)/,n,1).replace(/_/g,"."):void 0}var XT="2.10.0";const JT=XT,YT=15;class Sn{}Sn.setTimeout=function(){return setTimeout(...arguments)};Sn.setInterval=function(){return setInterval(...arguments)};Sn.clearTimeout=function(){return clearTimeout(...arguments)};Sn.clearInterval=function(){return clearInterval(...arguments)};const e2=5e3,Il=[];var Mr;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH"})(Mr||(Mr={}));class ve extends Si.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=ve.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=ht,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),e2):this.handleAppVisibilityChanged()},this.log=$i((o=r.loggerName)!==null&&o!==void 0?o:ni.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=ve.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),wt(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===ve.Kind.Video&&(t="video"),this.attachedElements.length===0&&this.kind===ve.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(Il.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&Il.splice(Il.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),ks(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),o=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(o?_e.AudioPlaybackStarted:_e.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(o?_e.AudioPlaybackFailed:_e.VideoPlaybackFailed,s):s.name==="AbortError"?ht.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):ht.warn("could not playback ".concat(o?"audio":"video"),s),o&&e&&r.some(l=>l.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(_e.ElementAttached,e),e}detach(e){try{if(e){Ps(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(_e.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(r=>{Ps(this.mediaStreamTrack,r),t.push(r),this.recycleElement(r),this.emit(_e.ElementDetached,r)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=$i(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),Il.forEach(r=>{r.parentElement||(t=!1)}),t&&Il.push(e)}}handleAppVisibilityChanged(){return U(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===ve.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){rr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){rr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function ks(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let r;n.kind==="audio"?r=t.getAudioTracks():r=t.getVideoTracks(),r.includes(n)||(r.forEach(o=>{t.removeTrack(o)}),t.addTrack(n)),(!Pa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(Pa()||Ms())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function Ps(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(m){m.Audio="audio",m.Video="video",m.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(m){m.Camera="camera",m.Microphone="microphone",m.ScreenShare="screen_share",m.ScreenShareAudio="screen_share_audio",m.Unknown="unknown"})(t=n.Source||(n.Source={}));let r;(function(m){m.Active="active",m.Paused="paused",m.Unknown="unknown"})(r=n.StreamState||(n.StreamState={}));function o(m){switch(m){case e.Audio:return Yr.AUDIO;case e.Video:return Yr.VIDEO;default:return Yr.DATA}}n.kindToProto=o;function s(m){switch(m){case Yr.AUDIO:return e.Audio;case Yr.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=s;function l(m){switch(m){case t.Camera:return tn.CAMERA;case t.Microphone:return tn.MICROPHONE;case t.ScreenShare:return tn.SCREEN_SHARE;case t.ScreenShareAudio:return tn.SCREEN_SHARE_AUDIO;default:return tn.UNKNOWN}}n.sourceToProto=l;function d(m){switch(m){case tn.CAMERA:return t.Camera;case tn.MICROPHONE:return t.Microphone;case tn.SCREEN_SHARE:return t.ScreenShare;case tn.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=d;function f(m){switch(m){case Tp.ACTIVE:return r.Active;case Tp.PAUSED:return r.Paused;default:return r.Unknown}}n.streamStateFromProto=f})(ve||(ve={}));class Et{constructor(e,t,r,o,s){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(t!==void 0&&r!==void 0)this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:r,maxFramerate:o,priority:s};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const t2=["vp8","h264"],n2=["vp8","h264","vp9","av1"];function r2(n){return!!t2.find(e=>e===n)}var Yv;(function(n){n[n.PREFER_REGRESSION=0]="PREFER_REGRESSION",n[n.SIMULCAST=1]="SIMULCAST",n[n.REGRESSION=2]="REGRESSION"})(Yv||(Yv={}));var Dp;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:24e3},n.music={maxBitrate:48e3},n.musicStereo={maxBitrate:64e3},n.musicHighQuality={maxBitrate:96e3},n.musicHighQualityStereo={maxBitrate:128e3}})(Dp||(Dp={}));const Jl={h90:new Et(160,90,9e4,20),h180:new Et(320,180,16e4,20),h216:new Et(384,216,18e4,20),h360:new Et(640,360,45e4,20),h540:new Et(960,540,8e5,25),h720:new Et(1280,720,17e5,30),h1080:new Et(1920,1080,3e6,30),h1440:new Et(2560,1440,5e6,30),h2160:new Et(3840,2160,8e6,30)},Up={h120:new Et(160,120,7e4,20),h180:new Et(240,180,125e3,20),h240:new Et(320,240,14e4,20),h360:new Et(480,360,33e4,20),h480:new Et(640,480,5e5,20),h540:new Et(720,540,6e5,25),h720:new Et(960,720,13e5,30),h1080:new Et(1440,1080,23e5,30),h1440:new Et(1920,1440,38e5,30)},Of={h360fps3:new Et(640,360,2e5,3,"medium"),h360fps15:new Et(640,360,4e5,15,"medium"),h720fps5:new Et(1280,720,8e5,5,"medium"),h720fps15:new Et(1280,720,15e5,15,"medium"),h720fps30:new Et(1280,720,2e6,30,"medium"),h1080fps15:new Et(1920,1080,25e5,15,"medium"),h1080fps30:new Et(1920,1080,5e6,30,"medium"),original:new Et(0,0,7e6,30,"medium")},i2="|",eb="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function a2(n){const e=n.split(i2);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function ir(n){return U(this,void 0,void 0,function*(){return new Promise(e=>Sn.setTimeout(e,n))})}function Fp(){return"addTransceiver"in RTCPeerConnection.prototype}function Bp(){return"addTrack"in RTCPeerConnection.prototype}function o2(){if(!("getCapabilities"in RTCRtpSender)||Pa())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/AV1"){e=!0;break}}return e}function s2(){if(!("getCapabilities"in RTCRtpSender)||Ms())return!1;if(Pa()){const t=ri();if(t!=null&&t.version&&So(t.version,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType==="video/VP9"){e=!0;break}}return e}function Fl(n){return n==="av1"||n==="vp9"}function zp(n){return document?(n||(n=document.createElement("audio")),"setSinkId"in n):!1}function l2(){return typeof RTCPeerConnection>"u"?!1:Fp()||Bp()}function Ms(){var n;return((n=ri())===null||n===void 0?void 0:n.name)==="Firefox"}function Pa(){var n;return((n=ri())===null||n===void 0?void 0:n.name)==="Safari"}function c2(){const n=ri();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")}function J0(){var n,e;return rr()?(e=(n=navigator.userAgentData)===null||n===void 0?void 0:n.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function u2(){const n=ri(),e="17.2";if(n)return n.name!=="Safari"&&n.os!=="iOS"||n.os==="iOS"&&n.osVersion&&So(e,n.osVersion)>=0?!0:n.name==="Safari"&&So(e,n.version)>=0}function rr(){return typeof document<"u"}function Ci(){return navigator.product=="ReactNative"}function Vp(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function Y0(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function e1(){if(!Ci())return;let n=Y0();if(n)return n.platform}function tb(){if(rr())return window.devicePixelRatio;if(Ci()){let n=Y0();if(n)return n.devicePixelRatio}return 1}function So(n,e){const t=n.split("."),r=e.split("."),o=Math.min(t.length,r.length);for(let s=0;s<o;++s){const l=parseInt(t[s],10),d=parseInt(r[s],10);if(l>d)return 1;if(l<d)return-1;if(s===o-1&&l===d)return 0}return n===""&&e!==""?-1:e===""?1:t.length==r.length?0:t.length<r.length?-1:1}function d2(n){for(const e of n)e.target.handleResize(e)}function h2(n){for(const e of n)e.target.handleVisibilityChanged(e)}let Jh=null;const nb=()=>(Jh||(Jh=new ResizeObserver(d2)),Jh);let Yh=null;const rb=()=>(Yh||(Yh=new IntersectionObserver(h2,{root:null,rootMargin:"0px"})),Yh);function p2(){var n;const e=new YS({sdk:a0.JS,protocol:YT,version:JT});return Ci()&&(e.os=(n=e1())!==null&&n!==void 0?n:""),e}function ib(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=n,o.height=e;const s=o.getContext("2d");s==null||s.fillRect(0,0,o.width,o.height),r&&s&&(s.beginPath(),s.arc(n/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const l=o.captureStream(),[d]=l.getTracks();if(!d)throw Error("Could not get empty media stream video track");return d.enabled=t,d}let Ol;function ep(){if(!Ol){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const r=n.createMediaStreamDestination();if(e.connect(t),t.connect(r),e.start(),[Ol]=r.stream.getAudioTracks(),!Ol)throw Error("Could not get empty media stream audio track");Ol.enabled=!1}return Ol.clone()}class t1{constructor(e,t){this.onFinally=t,this.promise=new Promise((r,o)=>U(this,void 0,void 0,function*(){this.resolve=r,this.reject=o,e&&(yield e(r,o))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function f2(n){return n2.includes(n)}function xa(n){if(typeof n=="string"||typeof n=="number")return n;if(Array.isArray(n))return n[0];if(n.exact)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function Hp(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}function m2(n,e){return n.segments.map(t=>{let{id:r,text:o,language:s,startTime:l,endTime:d,final:f}=t;var m;const v=(m=e.get(r))!==null&&m!==void 0?m:Date.now(),T=Date.now();return f?e.delete(r):e.set(r,v),{id:r,text:o,startTime:Number.parseInt(l.toString()),endTime:Number.parseInt(d.toString()),final:f,language:s,firstReceivedTime:v,lastReceivedTime:T}})}function g2(n){const{id:e,timestamp:t,message:r,editTimestamp:o}=n;return{id:e,timestamp:Number.parseInt(t.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:r}}function ab(n){switch(n.reason){case pt.LeaveRequest:return n.context;case pt.Cancelled:return ti.CLIENT_INITIATED;case pt.NotAllowed:return ti.USER_REJECTED;case pt.ServerUnreachable:return ti.JOIN_FAILURE;default:return ti.UNKNOWN_REASON}}function Bu(n){return n!==void 0?Number(n):void 0}function po(n){return n!==void 0?BigInt(n):void 0}function _s(n){return!!n&&!(n instanceof MediaStreamTrack)&&n.isLocal}function Wi(n){return!!n&&n.kind==ve.Kind.Audio}function Ns(n){return!!n&&n.kind==ve.Kind.Video}function va(n){return _s(n)&&Ns(n)}function fo(n){return _s(n)&&Wi(n)}function qp(n){return!!n&&!n.isLocal}function v2(n){return!!n&&!n.isLocal}function tp(n){return qp(n)&&Ns(n)}function b2(n){return n.isLocal}function y2(n,e){const t=[];let r=new TextEncoder().encode(n);for(;r.length>e;){let o=e;for(;o>0;){const s=r[o];if(s!==void 0&&(s&192)!==128)break;o--}t.push(r.slice(0,o)),r=r.slice(o)}return r.length>0&&t.push(r),t}function n1(n,e,t){var r,o,s,l,d;const{optionsWithoutProcessor:f,audioProcessor:m,videoProcessor:v}=Mf(n??{}),T=e==null?void 0:e.processor,x=t==null?void 0:t.processor,S=(r=KT(f))!==null&&r!==void 0?r:{};return S.audio===!0&&(S.audio={}),S.video===!0&&(S.video={}),S.audio&&($p(S.audio,e),(o=(l=S.audio).deviceId)!==null&&o!==void 0||(l.deviceId="default"),(m||T)&&(S.audio.processor=m??T)),S.video&&($p(S.video,t),(s=(d=S.video).deviceId)!==null&&s!==void 0||(d.deviceId="default"),(v||x)&&(S.video.processor=v??x)),S}function $p(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function vd(n){var e,t,r,o;const s={};if(n.video)if(typeof n.video=="object"){const l={},d=l,f=n.video;Object.keys(f).forEach(m=>{switch(m){case"resolution":$p(d,f.resolution);break;default:d[m]=f[m]}}),s.video=l,(e=(r=s.video).deviceId)!==null&&e!==void 0||(r.deviceId="default")}else s.video=n.video?{deviceId:"default"}:!1;else s.video=!1;return n.audio?typeof n.audio=="object"?(s.audio=n.audio,(t=(o=s.audio).deviceId)!==null&&t!==void 0||(o.deviceId="default")):s.audio={deviceId:"default"}:s.audio=!1,s}function r1(n){return U(this,arguments,void 0,function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=i1();if(r){const o=r.createAnalyser();o.fftSize=2048;const s=o.frequencyBinCount,l=new Uint8Array(s);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield ir(t),o.getByteTimeDomainData(l);const d=l.some(f=>f!==128&&f!==0);return r.close(),!d}return!1}()})}function i1(){var n;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const t=new e({latencyHint:"interactive"});if(t.state==="suspended"&&typeof window<"u"&&!((n=window.document)===null||n===void 0)&&n.body){const r=()=>U(this,void 0,void 0,function*(){var o;try{t.state==="suspended"&&(yield t.resume())}catch(s){console.warn("Error trying to auto-resume audio context",s)}(o=window.document.body)===null||o===void 0||o.removeEventListener("click",r)});window.document.body.addEventListener("click",r)}return t}}function ob(n){return n===ve.Source.Microphone?"audioinput":n===ve.Source.Camera?"videoinput":void 0}function w2(n){var e,t;let r=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Pa()?r=Object.assign(Object.assign({},r),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:r,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio,preferCurrentTab:n.preferCurrentTab}}function zu(n){return n.split("/")[1].toLowerCase()}function k2(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new Ef({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function wt(n){return"mediaStreamTrack"in n?{trackID:n.sid,source:n.source,muted:n.isMuted,enabled:n.mediaStreamTrack.enabled,kind:n.kind,streamID:n.mediaStreamID,streamTrackID:n.mediaStreamTrack.id}:{trackID:n.trackSid,enabled:n.isEnabled,muted:n.isMuted,trackInfo:Object.assign({mimeType:n.mimeType,name:n.trackName,encrypted:n.isEncrypted,kind:n.kind,source:n.source},n.track?wt(n.track):{})}}function C2(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function S2(n,e){var t;n===void 0&&(n={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(n)],o={};for(const s of r)n[s]!==e[s]&&(o[s]=(t=e[s])!==null&&t!==void 0?t:"");return o}function Mf(n){const e=Object.assign({},n);let t,r;return typeof e.audio=="object"&&e.audio.processor&&(t=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:t,videoProcessor:r,optionsWithoutProcessor:e}}function T2(n){switch(n){case tn.CAMERA:return ve.Source.Camera;case tn.MICROPHONE:return ve.Source.Microphone;case tn.SCREEN_SHARE:return ve.Source.ScreenShare;case tn.SCREEN_SHARE_AUDIO:return ve.Source.ScreenShareAudio;default:return ve.Source.Unknown}}class x2 extends Si.EventEmitter{constructor(e){super(),this.onWorkerMessage=t=>{var r,o;const{kind:s,data:l}=t.data;switch(s){case"error":ht.error(l.error.message),this.emit(Sa.EncryptionError,l.error);break;case"initAck":l.enabled&&this.keyProvider.getKeys().forEach(d=>{this.postKey(d)});break;case"enable":if(l.enabled&&this.keyProvider.getKeys().forEach(d=>{this.postKey(d)}),this.encryptionEnabled!==l.enabled&&l.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Sa.ParticipantEncryptionStatusChanged,l.enabled,this.room.localParticipant),this.encryptionEnabled=l.enabled;else if(l.participantIdentity){const d=(o=this.room)===null||o===void 0?void 0:o.getParticipantByIdentity(l.participantIdentity);if(!d)throw TypeError("couldn't set encryption status, participant not found".concat(l.participantIdentity));this.emit(Sa.ParticipantEncryptionStatusChanged,l.enabled,d)}break;case"ratchetKey":this.keyProvider.emit(Ta.KeyRatcheted,l.material,l.keyIndex);break}},this.onWorkerError=t=>{ht.error("e2ee worker encountered an error:",{error:t.error}),this.emit(Sa.EncryptionError,t.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!qT())throw new If("tried to setup end-to-end encryption on an unsupported browser");if(ht.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:_T.getLevel()}};this.worker&&(ht.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){ht.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?ht.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Me.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(Te.TrackPublished,(r,o)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==fr.NONE,o.identity)),e.on(Te.ConnectionStateChanged,r=>{r===bt.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==fr.NONE,o.identity)})})}).on(Te.TrackUnsubscribed,(r,o,s)=>{var l;const d={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(l=this.worker)===null||l===void 0||l.postMessage(d)}).on(Te.TrackSubscribed,(r,o,s)=>{this.setupE2EEReceiver(r,s.identity,o.trackInfo)}).on(Te.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Ae.LocalTrackPublished,r=>U(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),t.on(Ta.SetKey,r=>this.postKey(r)).on(Ta.RatchetRequest,(r,o)=>this.postRatchetRequest(r,o))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(r)}postKey(e){let{key:t,participantIdentity:r,keyIndex:o}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const l={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:t,keyIndex:o}};this.worker.postMessage(l)}postEnable(e,t){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?zu(r.mimeType):void 0)}}setupE2EESender(e,t){if(!_s(e)||!t){t||ht.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,r,o){return U(this,void 0,void 0,function*(){if(this.worker){if(Np()){const s={kind:"decode",participantIdentity:r,trackId:t,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(Cu in e&&o){const f={kind:"updateCodec",data:{trackId:t,codec:o,participantIdentity:r}};this.worker.postMessage(f);return}let s=e.writableStream,l=e.readableStream;if(!s||!l){const f=e.createEncodedStreams();e.writableStream=f.writable,s=f.writable,e.readableStream=f.readable,l=f.readable}const d={kind:"decode",data:{readableStream:l,writableStream:s,trackId:t,codec:o,participantIdentity:r}};this.worker.postMessage(d,[l,s])}e[Cu]=!0}})}handleSender(e,t,r){var o;if(!(Cu in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Np()){ht.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{ht.info("initialize encoded streams");const s=e.createEncodedStreams(),l={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(l,[s.readable,s.writable])}e[Cu]=!0}}}const np="default";class hn{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new hn),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return U(this,arguments,void 0,function(t){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;if(((s=hn.userMediaPromiseMap)===null||s===void 0?void 0:s.size)>0){ht.debug("awaiting getUserMedia promise");try{t?yield hn.userMediaPromiseMap.get(t):yield Promise.all(hn.userMediaPromiseMap.values())}catch{ht.warn("error waiting for media permissons")}}let l=yield navigator.mediaDevices.enumerateDevices();if(o&&!(Pa()&&r.hasDeviceInUse(t))&&(l.filter(d=>d.kind===t).length===0||l.some(d=>{const f=d.label==="",m=t?d.kind===t:!0;return f&&m}))){const d={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"&&{deviceId:"default"}},f=yield navigator.mediaDevices.getUserMedia(d);l=yield navigator.mediaDevices.enumerateDevices(),f.getTracks().forEach(m=>{m.stop()})}return r._previousDevices=l,t&&(l=l.filter(d=>d.kind===t)),l}()})}normalizeDeviceId(e,t,r){return U(this,void 0,void 0,function*(){if(t!==np)return t;const o=yield this.getDevices(e),s=o.find(d=>d.deviceId===np);if(!s){ht.warn("could not reliably determine default device");return}const l=o.find(d=>d.deviceId!==np&&d.groupId===(r??s.groupId));if(!l){ht.warn("could not reliably determine default device");return}return l==null?void 0:l.deviceId})}hasDeviceInUse(e){return e?hn.userMediaPromiseMap.has(e):hn.userMediaPromiseMap.size>0}}hn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];hn.userMediaPromiseMap=new Map;var Bl;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(Bl||(Bl={}));class E2{constructor(){this.pendingTasks=new Map,this.taskMutex=new mr,this.nextTaskIndex=0}run(e){return U(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Bl.WAITING};this.pendingTasks.set(t.id,t);const r=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=Bl.RUNNING,yield e()}finally{t.status=Bl.COMPLETED,this.pendingTasks.delete(t.id),r()}})}flush(){return U(this,void 0,void 0,function*(){return this.run(()=>U(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function P2(n,e){const t=new URL(n);return e.forEach((r,o)=>{t.searchParams.set(o,r)}),a1(t,"rtc")}function _2(n){const e=new URL(Hp(n));return a1(e,"validate")}function R2(n){return n.endsWith("/")?n:"".concat(n,"/")}function a1(n,e){const t="".concat(n.protocol,"//").concat(n.host).concat(R2(n.pathname)).concat(e);return n.searchParams.size>0?"".concat(t,"?").concat(n.searchParams.toString()):t}const I2=["syncState","trickle","offer","answer","simulate","leave"];function O2(n){const e=I2.indexOf(n.case)>=0;return ht.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var jt;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})(jt||(jt={}));class Af{get currentState(){return this.state}get isDisconnected(){return this.state===jt.DISCONNECTING||this.state===jt.DISCONNECTED}get isEstablishingConnection(){return this.state===jt.CONNECTING||this.state===jt.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=jt.DISCONNECTED,this.log=ht,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=$i((r=t.loggerName)!==null&&r!==void 0?r:ni.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new E2,this.queuedRequests=[],this.closingLock=new mr,this.connectionLock=new mr,this.state=jt.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,r,o){return U(this,void 0,void 0,function*(){return this.state=jt.CONNECTING,this.options=r,yield this.connect(e,t,r,o)})}reconnect(e,t,r,o){return U(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=jt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:o}))})}connect(e,t,r,o){this.connectOptions=r;const s=p2(),l=M2(t,s,r),d=P2(e,l),f=_2(d);return new Promise((m,v)=>U(this,void 0,void 0,function*(){const T=yield this.connectionLock.lock();try{const x=()=>U(this,void 0,void 0,function*(){this.close(),clearTimeout(S),v(new Rt("room connection has been cancelled (signal)",pt.Cancelled))}),S=setTimeout(()=>{this.close(),v(new Rt("room connection has timed out (signal)",pt.ServerUnreachable))},r.websocketTimeout);o!=null&&o.aborted&&x(),o==null||o.addEventListener("abort",x);const M=new URL(d);M.searchParams.has("access_token")&&M.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(M),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(d),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(S)},this.ws.onerror=N=>U(this,void 0,void 0,function*(){if(this.state!==jt.CONNECTED){this.state=jt.DISCONNECTED,clearTimeout(S);try{const V=yield fetch(f);if(V.status.toFixed(0).startsWith("4")){const $=yield V.text();v(new Rt($,pt.NotAllowed,V.status))}else v(new Rt("Encountered unknown websocket error during connection: ".concat(N.toString()),pt.InternalError,V.status))}catch(V){v(new Rt(V instanceof Error?V.message:"server was not reachable",pt.ServerUnreachable))}return}this.handleWSError(N)}),this.ws.onmessage=N=>U(this,void 0,void 0,function*(){var V,$,ae;let z;if(typeof N.data=="string"){const A=JSON.parse(N.data);z=Dv.fromJson(A,{ignoreUnknownFields:!0})}else if(N.data instanceof ArrayBuffer)z=Dv.fromBinary(new Uint8Array(N.data));else{this.log.error("could not decode websocket message: ".concat(typeof N.data),this.logContext);return}if(this.state!==jt.CONNECTED){let A=!1;if(((V=z.message)===null||V===void 0?void 0:V.case)==="join"?(this.state=jt.CONNECTED,o==null||o.removeEventListener("abort",x),this.pingTimeoutDuration=z.message.value.pingTimeout,this.pingIntervalDuration=z.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),m(z.message.value)):this.state===jt.RECONNECTING&&z.message.case!=="leave"?(this.state=jt.CONNECTED,o==null||o.removeEventListener("abort",x),this.startPingInterval(),(($=z.message)===null||$===void 0?void 0:$.case)==="reconnect"?m(z.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),m(void 0),A=!0)):this.isEstablishingConnection&&z.message.case==="leave"?v(new Rt("Received leave request while trying to (re)connect",pt.LeaveRequest,void 0,z.message.value.reason)):r.reconnect||v(new Rt("did not receive join response, got ".concat((ae=z.message)===null||ae===void 0?void 0:ae.case," instead"),pt.InternalError)),!A)return}this.signalLatency&&(yield ir(this.signalLatency)),this.handleSignalResponse(z)}),this.ws.onclose=N=>{this.isEstablishingConnection&&v(new Rt("Websocket got closed during a (re)connection attempt",pt.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:N.reason,code:N.code,wasClean:N.wasClean,state:this.state})),this.handleOnClose(N.reason)}}finally{T()}}))}close(){return U(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=jt.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const o=new Promise(s=>{e.ws?e.ws.onclose=()=>{s()}:s()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([o,ir(250)])),e.ws=void 0}}finally{t&&(e.state=jt.DISCONNECTED),r()}}()})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:td(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:td(e)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Tf({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new xf({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return U(this,arguments,void 0,function(r,o){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const d=s.getNextRequestId();return yield s.sendRequest({case:"updateMetadata",value:new p0({requestId:d,metadata:r,name:o,attributes:l})}),d}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new h0({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new g0({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ut.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new y0({timestamp:Ut.parse(Date.now()),rtt:Ut.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new d0({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new md({reason:ti.CLIENT_INITIATED,action:xs.DISCONNECT})})}sendRequest(e){return U(this,arguments,void 0,function(t){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!o&&!O2(t)&&r.state===jt.RECONNECTING){r.queuedRequests.push(()=>U(r,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(o||(yield r.requestQueue.flush()),r.signalLatency&&(yield ir(r.signalLatency)),!r.ws||r.ws.readyState!==r.ws.OPEN){r.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),r.logContext);return}const s=new nT({message:t});try{r.useJSON?r.ws.send(s.toJsonString()):r.ws.send(s.toBinary())}catch(l){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:l}))}}()})}handleSignalResponse(e){var t,r;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(o.case==="answer"){const l=sb(o.value);this.onAnswer&&this.onAnswer(l)}else if(o.case==="offer"){const l=sb(o.value);this.onOffer&&this.onOffer(l)}else if(o.case==="trickle"){const l=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(l,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=o.value.participants)!==null&&t!==void 0?t:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=o.value.speakers)!==null&&r!==void 0?r:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return U(this,void 0,void 0,function*(){if(this.state===jt.DISCONNECTED)return;const t=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Sn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Sn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Sn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Sn.clearInterval(this.pingInterval)}}function sb(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function td(n){return new Co({sdp:n.sdp,type:n.type})}function M2(n,e,t){var r;const o=new URLSearchParams;return o.set("access_token",n),t.reconnect&&(o.set("reconnect","1"),t.sid&&o.set("sid",t.sid)),o.set("auto_subscribe",t.autoSubscribe?"1":"0"),o.set("sdk",Ci()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),t.adaptiveStream&&o.set("adaptive_stream","1"),t.reconnectReason&&o.set("reconnect_reason",t.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&o.set("network",navigator.connection.type),o}var Zr={},lb={},rp={exports:{}},cb;function Lf(){if(cb)return rp.exports;cb=1;var n=rp.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),rp.exports}var ub;function A2(){return ub||(ub=1,function(n){var e=function(d){return String(Number(d))===d?Number(d):d},t=function(d,f,m,v){if(v&&!m)f[v]=e(d[1]);else for(var T=0;T<m.length;T+=1)d[T+1]!=null&&(f[m[T]]=e(d[T+1]))},r=function(d,f,m){var v=d.name&&d.names;d.push&&!f[d.push]?f[d.push]=[]:v&&!f[d.name]&&(f[d.name]={});var T=d.push?{}:v?f[d.name]:f;t(m.match(d.reg),T,d.names,d.name),d.push&&f[d.push].push(T)},o=Lf(),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(d){var f={},m=[],v=f;return d.split(/(\r\n|\r|\n)/).filter(s).forEach(function(T){var x=T[0],S=T.slice(2);x==="m"&&(m.push({rtp:[],fmtp:[]}),v=m[m.length-1]);for(var M=0;M<(o[x]||[]).length;M+=1){var N=o[x][M];if(N.reg.test(S))return r(N,v,S)}}),f.media=m,f};var l=function(d,f){var m=f.split(/=(.+)/,2);return m.length===2?d[m[0]]=e(m[1]):m.length===1&&f.length>1&&(d[m[0]]=void 0),d};n.parseParams=function(d){return d.split(/;\s?/).reduce(l,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(d){return d.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(d){for(var f=[],m=d.split(" ").map(e),v=0;v<m.length;v+=3)f.push({component:m[v],ip:m[v+1],port:m[v+2]});return f},n.parseImageAttributes=function(d){return d.split(" ").map(function(f){return f.substring(1,f.length-1).split(",").reduce(l,{})})},n.parseSimulcastStreamList=function(d){return d.split(";").map(function(f){return f.split(",").map(function(m){var v,T=!1;return m[0]!=="~"?v=e(m):(v=e(m.substring(1,m.length)),T=!0),{scid:v,paused:T}})})}}(lb)),lb}var ip,db;function L2(){if(db)return ip;db=1;var n=Lf(),e=/%[sdv%]/g,t=function(l){var d=1,f=arguments,m=f.length;return l.replace(e,function(v){if(d>=m)return v;var T=f[d];switch(d+=1,v){case"%%":return"%";case"%s":return String(T);case"%d":return Number(T);case"%v":return""}})},r=function(l,d,f){var m=d.format instanceof Function?d.format(d.push?f:f[d.name]):d.format,v=[l+"="+m];if(d.names)for(var T=0;T<d.names.length;T+=1){var x=d.names[T];d.name?v.push(f[d.name][x]):v.push(f[d.names[T]])}else v.push(f[d.name]);return t.apply(null,v)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];return ip=function(l,d){d=d||{},l.version==null&&(l.version=0),l.name==null&&(l.name=" "),l.media.forEach(function(T){T.payloads==null&&(T.payloads="")});var f=d.outerOrder||o,m=d.innerOrder||s,v=[];return f.forEach(function(T){n[T].forEach(function(x){x.name in l&&l[x.name]!=null?v.push(r(T,x,l)):x.push in l&&l[x.push]!=null&&l[x.push].forEach(function(S){v.push(r(T,x,S))})})}),l.media.forEach(function(T){v.push(r("m",n.m[0],T)),m.forEach(function(x){n[x].forEach(function(S){S.name in T&&T[S.name]!=null?v.push(r(x,S,T)):S.push in T&&T[S.push]!=null&&T[S.push].forEach(function(M){v.push(r(x,S,M))})})})}),v.join(`\r
`)+`\r
`},ip}var hb;function N2(){if(hb)return Zr;hb=1;var n=A2(),e=L2(),t=Lf();return Zr.grammar=t,Zr.write=e,Zr.parse=n.parse,Zr.parseParams=n.parseParams,Zr.parseFmtpConfig=n.parseFmtpConfig,Zr.parsePayloads=n.parsePayloads,Zr.parseRemoteCandidates=n.parseRemoteCandidates,Zr.parseImageAttributes=n.parseImageAttributes,Zr.parseSimulcastStreamList=n.parseSimulcastStreamList,Zr}var ba=N2();function Nf(n,e,t){var r,o,s;e===void 0&&(e=50),t===void 0&&(t={});var l=(r=t.isImmediate)!=null&&r,d=(o=t.callback)!=null&&o,f=t.maxWait,m=Date.now(),v=[];function T(){if(f!==void 0){var S=Date.now()-m;if(S+e>=f)return f-S}return e}var x=function(){var S=[].slice.call(arguments),M=this;return new Promise(function(N,V){var $=l&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,m=Date.now(),!l){var z=n.apply(M,S);d&&d(z),v.forEach(function(A){return(0,A.resolve)(z)}),v=[]}},T()),$){var ae=n.apply(M,S);return d&&d(ae),N(ae)}v.push({resolve:N,reject:V})})};return x.cancel=function(S){s!==void 0&&clearTimeout(s),v.forEach(function(M){return(0,M.reject)(S)}),v=[]},x}const j2=.7,D2=20,Rs={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class pb extends Si.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=ht,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Nf(o=>U(this,void 0,void 0,function*(){this.emit(Rs.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(o)o(s);else throw s}}),D2),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=$i((r=t.loggerName)!==null&&r!==void 0?r:ni.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC()}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var r;t.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,t.candidate))},e.onicecandidateerror=t=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,t)},e.ontrack=t=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return U(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return U(this,void 0,void 0,function*(){var t;let r;if(e.type==="offer"){let{stereoMids:o,nackMids:s}=U2(e);this.remoteStereoMids=o,this.remoteNackMids=s}else if(e.type==="answer"){const o=ba.parse((t=e.sdp)!==null&&t!==void 0?t:"");o.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(l=>{if(!l.transceiver||s.mid!=l.transceiver.mid)return!1;let d=0;if(s.rtp.some(m=>m.codec.toUpperCase()===l.codec.toUpperCase()?(d=m.payload,!0):!1),d===0)return!0;let f=!1;for(const m of s.fmtp)if(m.payload===d){m.config=m.config.split(";").filter(v=>!v.includes("maxaveragebitrate")).join(";"),l.maxbr>0&&(m.config+=";maxaveragebitrate=".concat(l.maxbr*1e3)),f=!0;break}return f||l.maxbr>0&&s.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(l.maxbr*1e3)}),!0})}),r=ba.write(o)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(o=>{this.pc.addIceCandidate(o)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Rs.NegotiationComplete),e.sdp&&ba.parse(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(Rs.RTPVideoPayloadTypes,o.rtp)}))})}createAndSendOffer(e){return U(this,void 0,void 0,function*(){var t;if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:r.sdp},this.logContext));const o=ba.parse((t=r.sdp)!==null&&t!==void 0?t:"");o.media.forEach(s=>{mb(s),s.type==="audio"?fb(s,[],[]):s.type==="video"&&this.trackBitrates.some(l=>{if(!s.msid||!l.cid||!s.msid.includes(l.cid))return!1;let d=0;if(s.rtp.some(m=>m.codec.toUpperCase()===l.codec.toUpperCase()?(d=m.payload,!0):!1),d===0||(Fl(l.codec)&&this.ensureVideoDDExtensionForSVC(s,o),l.codec!=="av1"))return!0;const f=Math.round(l.maxbr*j2);for(const m of s.fmtp)if(m.payload===d){m.config.includes("x-google-start-bitrate")||(m.config+=";x-google-start-bitrate=".concat(f));break}return!0})}),yield this.setMungedSDP(r,ba.write(o)),this.onOffer(r)})}createAndSetAnswer(){return U(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),r=ba.parse((e=t.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(o=>{mb(o),o.type==="audio"&&fb(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,ba.write(r)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new sn("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new sn("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return U(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const r=new Map,o=new Map;if((yield this._pc.getStats()).forEach(l=>{switch(l.type){case"transport":t=l.selectedCandidatePairId;break;case"candidate-pair":t===""&&l.selected&&(t=l.id),r.set(l.id,l);break;case"remote-candidate":o.set(l.id,"".concat(l.address,":").concat(l.port));break}}),t==="")return;const s=(e=r.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return o.get(s)})}setMungedSDP(e,t,r){return U(this,void 0,void 0,function*(){if(t){const o=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:t})),e.sdp=o}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let s="unknown error";o instanceof Error?s=o.message:typeof o=="string"&&(s=o);const l={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(l.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:l})),new jp(s)}})}ensureVideoDDExtensionForSVC(e,t){var r,o;if(!(!((r=e.ext)===null||r===void 0)&&r.some(s=>s.uri===eb))){if(this.ddExtID===0){let s=0;t.media.forEach(l=>{var d;l.type==="video"&&((d=l.ext)===null||d===void 0||d.forEach(f=>{f.value>s&&(s=f.value)}))}),this.ddExtID=s+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:eb})}}}function fb(n,e,t){let r=0;n.rtp.some(o=>o.codec==="opus"?(r=o.payload,!0):!1),r>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(n.mid)&&!n.rtcpFb.some(o=>o.payload===r&&o.type==="nack")&&n.rtcpFb.push({payload:r,type:"nack"}),e.includes(n.mid)&&n.fmtp.some(o=>o.payload===r?(o.config.includes("stereo=1")||(o.config+=";stereo=1"),!0):!1))}function U2(n){var e;const t=[],r=[],o=ba.parse((e=n.sdp)!==null&&e!==void 0?e:"");let s=0;return o.media.forEach(l=>{var d;l.type==="audio"&&(l.rtp.some(f=>f.codec==="opus"?(s=f.payload,!0):!1),!((d=l.rtcpFb)===null||d===void 0)&&d.some(f=>f.payload===s&&f.type==="nack")&&r.push(l.mid),l.fmtp.some(f=>f.payload===s?(f.config.includes("sprop-stereo=1")&&t.push(l.mid),!0):!1))}),{stereoMids:t,nackMids:r}}function mb(n){if(n.connection){const e=n.connection.ip.indexOf(":")>=0;(n.connection.version===4&&e||n.connection.version===6&&!e)&&(n.connection.ip="0.0.0.0",n.connection.version=4)}}const Wp="vp8",F2={audioPreset:Dp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Of.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Wp,backupCodec:!0},o1={deviceId:"default",autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},s1={deviceId:"default",resolution:Jl.h720.resolution},B2={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new IT,disconnectOnPageLeave:!0,webAudioMix:!1},jf={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Wt;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})(Wt||(Wt={}));class z2{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,r){var o;this.peerConnectionTimeout=jf.peerConnectionTimeout,this.log=ht,this.updateState=()=>{var s;const l=this.state,d=this.requiredTransports.map(f=>f.getConnectionState());d.every(f=>f==="connected")?this.state=Wt.CONNECTED:d.some(f=>f==="failed")?this.state=Wt.FAILED:d.some(f=>f==="connecting")?this.state=Wt.CONNECTING:d.every(f=>f==="closed")?this.state=Wt.CLOSED:d.some(f=>f==="closed")?this.state=Wt.CLOSING:d.every(f=>f==="new")&&(this.state=Wt.NEW),l!==this.state&&(this.log.debug("pc state change: from ".concat(Wt[l]," to ").concat(Wt[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=$i((o=r.loggerName)!==null&&o!==void 0?o:ni.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t,this.publisher=new pb(e,r),this.subscriber=new pb(e,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,s,ei.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,s,ei.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var l;(l=this.onDataChannel)===null||l===void 0||l.call(this,s)},this.subscriber.onTrack=s=>{var l;(l=this.onTrack)===null||l===void 0||l.call(this,s)},this.publisher.onOffer=s=>{var l;(l=this.onPublisherOffer)===null||l===void 0||l.call(this,s)},this.state=Wt.NEW,this.connectionLock=new mr,this.remoteOfferLock=new mr}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return U(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return U(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return U(this,void 0,void 0,function*(){t===ei.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return U(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const t=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()}finally{t()}})}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return U(this,void 0,void 0,function*(){var r;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,t)))}finally{o()}})}negotiate(e){return U(this,void 0,void 0,function*(){return new Promise((t,r)=>U(this,void 0,void 0,function*(){const o=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(o),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(Rs.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Rs.NegotiationComplete,()=>{clearTimeout(o),t()})}),yield this.publisher.negotiate(l=>{clearTimeout(o),r(l)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===ei.PUBLISHER?this.publisher.getConnectedAddress():e===ei.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return U(this,arguments,void 0,function(r,o){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((d,f)=>U(s,void 0,void 0,function*(){const m=()=>{this.log.warn("abort transport connection",this.logContext),Sn.clearTimeout(v),f(new Rt("room connection has been cancelled",pt.Cancelled))};o!=null&&o.signal.aborted&&m(),o==null||o.signal.addEventListener("abort",m);const v=Sn.setTimeout(()=>{o==null||o.signal.removeEventListener("abort",m),f(new Rt("could not establish pc connection",pt.InternalError))},l);for(;this.state!==Wt.CONNECTED;)if(yield ir(50),o!=null&&o.signal.aborted){f(new Rt("room connection has been cancelled",pt.Cancelled));return}Sn.clearTimeout(v),o==null||o.signal.removeEventListener("abort",m),d()}))}()})}}class Kt extends Error{constructor(e,t,r){super(t),this.code=e,this.message=gb(t,Kt.MAX_MESSAGE_BYTES),this.data=r?gb(r,Kt.MAX_DATA_BYTES):void 0}static fromProto(e){return new Kt(e.code,e.message,e.data)}toProto(){return new n0({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Kt(Kt.ErrorCode[e],Kt.ErrorMessage[e],t)}}Kt.MAX_MESSAGE_BYTES=256;Kt.MAX_DATA_BYTES=15360;Kt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Kt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const l1=15360;function Df(n){return new TextEncoder().encode(n).length}function gb(n,e){if(Df(n)<=e)return n;let t=0,r=n.length;const o=new TextEncoder;for(;t<r;){const s=Math.floor((t+r+1)/2);o.encode(n.slice(0,s)).length<=e?t=s:r=s-1}return n.slice(0,t)}const Uf=2e3;function bd(n,e){if(!e)return 0;let t,r;return"bytesReceived"in n?(t=n.bytesReceived,r=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,r=e.bytesSent),t===void 0||r===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-r)*8*1e3/(n.timestamp-e.timestamp)}const V2=1e3;class c1 extends ve{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}constructor(e,t,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(e,t,s),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Nf(()=>U(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>U(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(_e.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new mr,this.pauseUpstreamLock=new mr,this.processorLock=new mr,this.restartLock=new mr,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==ve.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return U(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(s=>{Ps(this._mediaStreamTrack,s)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){const s=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(ks(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}finally{s()}}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(s=>{ks(o??e,s)}))})}waitForDimensions(){return U(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:V2;return function*(){var r;if(e.kind===ve.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=ri())===null||r===void 0?void 0:r.os)==="iOS"&&(yield ir(10));const o=Date.now();for(;Date.now()-o<t;){const s=e.dimensions;if(s)return s;yield ir(50)}throw new Hi("unable to get track dimensions after timeout")}()})}setDeviceId(e){return U(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===xa(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),xa(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return U(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===ve.Source.ScreenShare)return;const{deviceId:r,groupId:o}=e._mediaStreamTrack.getSettings(),s=e.kind===ve.Kind.Audio?"audioinput":"videoinput";return t?hn.getInstance().normalizeDeviceId(s,r,o):r}()})}mute(){return U(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return U(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return U(this,void 0,void 0,function*(){if(!this.sender)throw new Hi("unable to replace an unpublished track");let r,o;return typeof t=="boolean"?r=t:t!==void 0&&(r=t.userProvidedTrack,o=t.stopProcessor),this.providedByUser=r??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),o&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return U(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:o}=e,s=OT(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const l={audio:!1,video:!1};this.kind===ve.Kind.Video?l.video=r||o?{deviceId:r,facingMode:o}:!0:l.audio=r?{deviceId:r}:!0,this.attachedElements.forEach(f=>{Ps(this.mediaStreamTrack,f)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const d=(yield navigator.mediaDevices.getUserMedia(l)).getTracks()[0];return yield d.applyConstraints(s),d.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(d),this._constraints=e,this.emit(_e.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?_e.Muted:_e.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),J0()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return U(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(_e.UpstreamPaused,this);const r=ri();if((r==null?void 0:r.name)==="Safari"&&So(r.version,"12.0")<0)throw new If("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return U(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(_e.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return U(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return U(this,arguments,void 0,function(t){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;const l=yield r.processorLock.lock();try{r.log.debug("setting up processor",r.logContext);const d=document.createElement(r.kind),f={kind:r.kind,track:r._mediaStreamTrack,element:d,audioContext:r.audioContext};if(yield t.init(f),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.stopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(ks(r._mediaStreamTrack,d),d.muted=!0,d.play().catch(m=>r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:m}))),r.processor=t,r.processorElement=d,r.processor.processedTrack){for(const m of r.attachedElements)m!==r.processorElement&&o&&(Ps(r._mediaStreamTrack,m),ks(r.processor.processedTrack,m));yield(s=r.sender)===null||s===void 0?void 0:s.replaceTrack(r.processor.processedTrack)}r.emit(_e.TrackProcessorUpdate,r.processor)}finally{l()}}()})}getProcessor(){return this.processor}stopProcessor(){return U(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,t||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(_e.TrackProcessorUpdate))}()})}}class nd extends c1{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,ve.Kind.Audio,t,r,s),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>U(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(d){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}l&&this.prevStats&&(this._currentBitrate=bd(l,this.prevStats)),this.prevStats=l}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(_e.AudioTrackFeatureUpdate,this,wi.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(_e.AudioTrackFeatureUpdate,this,wi.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return U(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===ve.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return U(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==xa(this._constraints.deviceId);return this.source===ve.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return U(this,void 0,void 0,function*(){let t;if(e){const r=vd({audio:e});typeof r.audio!="boolean"&&(t=r.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return U(this,void 0,void 0,function*(){const r=yield t.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){rr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Uf)))}setProcessor(e){return U(this,void 0,void 0,function*(){var t;const r=yield this.processorLock.lock();try{if(!Ci()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(_e.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return U(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let r;return t.forEach(o=>{o.type==="outbound-rtp"&&(r={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),r})}checkForSilence(){return U(this,void 0,void 0,function*(){const e=yield r1(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(_e.AudioSilenceDetected)),e})}}function u1(n,e,t){switch(n.kind){case"audio":return new nd(n,e,!1,void 0,t);case"video":return new id(n,e,!1,t);default:throw new Hi("unsupported track type: ".concat(n.kind))}}const H2=Object.values(Jl),q2=Object.values(Up),$2=Object.values(Of),W2=[Jl.h180,Jl.h360],G2=[Up.h180,Up.h360],K2=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(e=>{var t,r;return new Et(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*(((t=n.encoding.maxFramerate)!==null&&t!==void 0?t:30)/((r=e.fps)!==null&&r!==void 0?r:30))))),e.fps,n.encoding.priority)}),Gp=["q","h","f"];function Kp(n,e,t,r){var o,s;let l=r==null?void 0:r.videoEncoding;n&&(l=r==null?void 0:r.screenShareEncoding);const d=r==null?void 0:r.simulcast,f=r==null?void 0:r.scalabilityMode,m=r==null?void 0:r.videoCodec;if(!l&&!d&&!f||!e||!t)return[{}];l||(l=Q2(n,e,t,m),ht.debug("using video encoding",l));const v=l.maxFramerate,T=new Et(e,t,l.maxBitrate,l.maxFramerate,l.priority);if(f&&Fl(m)){const M=new rd(f),N=[];if(M.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(f));const V=ri();if(Pa()||Ci()||(V==null?void 0:V.name)==="Chrome"&&So(V==null?void 0:V.version,"113")<0){const $=M.suffix=="h"?2:3;for(let ae=0;ae<M.spatial;ae+=1)N.push({rid:Gp[2-ae],maxBitrate:l.maxBitrate/Math.pow($,ae),maxFramerate:T.encoding.maxFramerate});N[0].scalabilityMode=f}else N.push({maxBitrate:l.maxBitrate,maxFramerate:T.encoding.maxFramerate,scalabilityMode:f});return T.encoding.priority&&(N[0].priority=T.encoding.priority,N[0].networkPriority=T.encoding.priority),ht.debug("using svc encoding",{encodings:N}),N}if(!d)return[l];let x=[];n?x=(o=bb(r==null?void 0:r.screenShareSimulcastLayers))!==null&&o!==void 0?o:vb(n,T):x=(s=bb(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:vb(n,T);let S;if(x.length>0){const M=x[0];x.length>1&&([,S]=x);const N=Math.max(e,t);if(N>=960&&S)return ap(e,t,[M,S,T],v);if(N>=480)return ap(e,t,[M,T],v)}return ap(e,t,[T])}function Z2(n,e,t){var r,o,s,l;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&ht.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const d=n.mediaStreamTrack.getSettings(),f=(r=d.width)!==null&&r!==void 0?r:(o=n.dimensions)===null||o===void 0?void 0:o.width,m=(s=d.height)!==null&&s!==void 0?s:(l=n.dimensions)===null||l===void 0?void 0:l.height;return n.source===ve.Source.ScreenShare&&t.simulcast&&(t.simulcast=!1),Kp(n.source===ve.Source.ScreenShare,f,m,t)}function Q2(n,e,t,r){const o=X2(n,e,t);let{encoding:s}=o[0];const l=Math.max(e,t);for(let d=0;d<o.length;d+=1){const f=o[d];if(s=f.encoding,f.width>=l)break}if(r)switch(r){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function X2(n,e,t){if(n)return $2;const r=e>t?e/t:t/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?H2:q2}function vb(n,e){if(n)return K2(e);const{width:t,height:r}=e,o=t>r?t/r:r/t;return Math.abs(o-16/9)<Math.abs(o-4/3)?W2:G2}function ap(n,e,t,r){const o=[];if(t.forEach((s,l)=>{if(l>=Gp.length)return;const d=Math.min(n,e),f={rid:Gp[l],scaleResolutionDownBy:Math.max(1,d/Math.min(s.width,s.height)),maxBitrate:s.encoding.maxBitrate},m=r&&s.encoding.maxFramerate?Math.min(r,s.encoding.maxFramerate):s.encoding.maxFramerate;m&&(f.maxFramerate=m);const v=Ms()||l===0;s.encoding.priority&&v&&(f.priority=s.encoding.priority,f.networkPriority=s.encoding.priority),o.push(f)}),Ci()&&e1()==="ios"){let s;o.forEach(d=>{s?d.maxFramerate&&d.maxFramerate>s&&(s=d.maxFramerate):s=d.maxFramerate});let l=!0;o.forEach(d=>{var f;d.maxFramerate!=s&&(l&&(l=!1,ht.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),ht.info('Setting framerate of encoding "'.concat((f=d.rid)!==null&&f!==void 0?f:"",'" to ').concat(s)),d.maxFramerate=s)})}return o}function bb(n){if(n)return n.sort((e,t)=>{const{encoding:r}=e,{encoding:o}=t;return r.maxBitrate>o.maxBitrate?1:r.maxBitrate<o.maxBitrate?-1:r.maxBitrate===o.maxBitrate&&r.maxFramerate&&o.maxFramerate?r.maxFramerate>o.maxFramerate?1:-1:0})}class rd{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function J2(n){return n.source===ve.Source.ScreenShare||n.constraints.height&&xa(n.constraints.height)>=1080?"maintain-resolution":"balanced"}const Y2=5e3;class id extends c1{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,ve.Kind.Video,t,r,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>U(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(d){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}const l=new Map(s.map(d=>[d.rid,d]));if(this.prevStats){let d=0;l.forEach((f,m)=>{var v;const T=(v=this.prevStats)===null||v===void 0?void 0:v.get(m);d+=bd(f,T)}),this._currentBitrate=d}this.prevStats=l}),this.senderLock=new mr}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!rr())return;const r=(t=this.sender)===null||t===void 0?void 0:t.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Uf))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return U(this,void 0,void 0,function*(){var t,r,o,s,l;yield e.pauseUpstream.call(this);try{for(var d=!0,f=wa(this.simulcastCodecs.values()),m;m=yield f.next(),t=m.done,!t;d=!0)s=m.value,d=!1,yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(null)}catch(v){r={error:v}}finally{try{!d&&!t&&(o=f.return)&&(yield o.call(f))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return U(this,void 0,void 0,function*(){var t,r,o,s,l;yield e.resumeUpstream.call(this);try{for(var d=!0,f=wa(this.simulcastCodecs.values()),m;m=yield f.next(),t=m.done,!t;d=!0){s=m.value,d=!1;const v=s;yield(l=v.sender)===null||l===void 0?void 0:l.replaceTrack(v.mediaStreamTrack)}}catch(v){r={error:v}}finally{try{!d&&!t&&(o=f.return)&&(yield o.call(f))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return U(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===ve.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return U(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source===ve.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return U(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],r=yield this.sender.getStats();return r.forEach(o=>{var s;if(o.type==="outbound-rtp"){const l={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(s=o.rid)!==null&&s!==void 0?s:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},d=r.get(o.remoteId);d&&(l.jitter=d.jitter,l.packetsLost=d.packetsLost,l.roundTripTime=d.roundTripTime),t.push(l)}}),t.sort((o,s)=>{var l,d;return((l=s.frameWidth)!==null&&l!==void 0?l:0)-((d=o.frameWidth)!==null&&d!==void 0?d:0)}),t})}setPublishingQuality(e){const t=[];for(let r=Mr.LOW;r<=Mr.HIGH;r+=1)t.push(new Pf({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(t)}restartTrack(e){return U(this,void 0,void 0,function*(){var t,r,o,s,l;let d;if(e){const T=vd({video:e});typeof T.video!="boolean"&&(d=T.video)}yield this.restart(d);try{for(var f=!0,m=wa(this.simulcastCodecs.values()),v;v=yield m.next(),t=v.done,!t;f=!0){s=v.value,f=!1;const T=s;T.sender&&((l=T.sender.transport)===null||l===void 0?void 0:l.state)!=="closed"&&(T.mediaStreamTrack=this.mediaStreamTrack.clone(),yield T.sender.replaceTrack(T.mediaStreamTrack))}}catch(T){r={error:T}}finally{try{!f&&!t&&(o=m.return)&&(yield o.call(m))}finally{if(r)throw r.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return U(this,arguments,void 0,function(r){var o=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l,d,f,m,v,T;if(yield t.setProcessor.call(o,r,s),!((v=o.processor)===null||v===void 0)&&v.processedTrack)try{for(var x=!0,S=wa(o.simulcastCodecs.values()),M;M=yield S.next(),l=M.done,!l;x=!0)m=M.value,x=!1,yield(T=m.sender)===null||T===void 0?void 0:T.replaceTrack(o.processor.processedTrack)}catch(N){d={error:N}}finally{try{!x&&!l&&(f=S.return)&&(yield f.call(S))}finally{if(d)throw d.error}}}()})}setDegradationPreference(e){return U(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(t){this.log.warn("failed to set degradationPreference",Object.assign({error:t},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,t){const r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Y2))}setPublishingCodecs(e){return U(this,void 0,void 0,function*(){var t,r,o,s,l,d,f;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const m=[];try{for(t=!0,r=wa(e);o=yield r.next(),s=o.done,!s;t=!0){f=o.value,t=!1;const v=f;if(!this.codec||this.codec===v.codec)yield this.setPublishingLayers(v.qualities);else{const T=this.simulcastCodecs.get(v.codec);if(this.log.debug("try setPublishingCodec for ".concat(v.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:T})),!T||!T.sender){for(const x of v.qualities)if(x.enabled){m.push(v.codec);break}}else T.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(v.codec),this.logContext),yield yb(T.sender,T.encodings,v.qualities,this.senderLock,this.log,this.logContext))}}}catch(v){l={error:v}}finally{try{!t&&!s&&(d=r.return)&&(yield d.call(r))}finally{if(l)throw l.error}}return m})}setPublishingLayers(e){return U(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield yb(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),J0()&&this.isInBackground&&this.source===ve.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function yb(n,e,t,r,o,s){return U(this,void 0,void 0,function*(){const l=yield r.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},s),{sender:n,qualities:t,senderEncodings:e}));try{const d=n.getParameters(),{encodings:f}=d;if(!f)return;if(f.length!==e.length){o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},s),{encodings:f,senderEncodings:e}));return}let m=!1;const v=ri();if((v==null?void 0:v.name)==="Chrome"&&So(v==null?void 0:v.version,"133")>0&&f[0].scalabilityMode){const T=f[0],x=new rd(T.scalabilityMode);let S=Ts.OFF;if(t.forEach(M=>{M.enabled&&(S===Ts.OFF||M.quality>S)&&(S=M.quality)}),S===Ts.OFF)T.active&&(T.active=!1,m=!0);else if(!T.active||x.spatial!==S+1){m=!0,T.active=!0;const M=new rd(e[0].scalabilityMode);x.spatial=S+1,x.suffix=M.suffix,x.spatial===1&&(x.suffix=void 0),T.scalabilityMode=x.toString(),T.scaleResolutionDownBy=Math.pow(2,2-S),e[0].maxBitrate&&(T.maxBitrate=e[0].maxBitrate/(T.scaleResolutionDownBy*T.scaleResolutionDownBy))}}else f.forEach((T,x)=>{var S;let M=(S=T.rid)!==null&&S!==void 0?S:"";M===""&&(M="q");const N=d1(M),V=t.find($=>$.quality===N);V&&T.active!==V.enabled&&(m=!0,T.active=V.enabled,o.debug("setting layer ".concat(V.quality," to ").concat(T.active?"enabled":"disabled"),s),Ms()&&(V.enabled?(T.scaleResolutionDownBy=e[x].scaleResolutionDownBy,T.maxBitrate=e[x].maxBitrate,T.maxFrameRate=e[x].maxFrameRate):(T.scaleResolutionDownBy=4,T.maxBitrate=10,T.maxFrameRate=2)))});m&&(d.encodings=f,o.debug("setting encodings",Object.assign(Object.assign({},s),{encodings:d.encodings})),yield n.setParameters(d))}finally{l()}})}function d1(n){switch(n){case"f":return Mr.HIGH;case"h":return Mr.MEDIUM;case"q":return Mr.LOW;default:return Mr.HIGH}}function wb(n,e,t,r){if(!t)return[new bo({quality:Mr.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(r){const o=t[0].scalabilityMode,s=new rd(o),l=[],d=s.suffix=="h"?1.5:2,f=s.suffix=="h"?2:3;for(let m=0;m<s.spatial;m+=1)l.push(new bo({quality:Math.min(Mr.HIGH,s.spatial-1)-m,width:Math.ceil(n/Math.pow(d,m)),height:Math.ceil(e/Math.pow(d,m)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(f,m)):0,ssrc:0}));return l}return t.map(o=>{var s,l,d;const f=(s=o.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let m=d1((l=o.rid)!==null&&l!==void 0?l:"");return new bo({quality:m,width:Math.ceil(n/f),height:Math.ceil(e/f),bitrate:(d=o.maxBitrate)!==null&&d!==void 0?d:0,ssrc:0})})}const kb="_lossy",Cb="_reliable",ex=2*1e3,op="leave-reconnect";var Qr;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(Qr||(Qr={}));class tx extends Si.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=jf.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Qr.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=ht,this.handleDataChannel=r=>U(this,[r],void 0,function(o){var s=this;let{channel:l}=o;return function*(){if(l){if(l.label===Cb)s.reliableDCSub=l;else if(l.label===kb)s.lossyDCSub=l;else return;s.log.debug("on data channel ".concat(l.id,", ").concat(l.label),s.logContext),l.onmessage=s.handleDataMessage}}()}),this.handleDataMessage=r=>U(this,void 0,void 0,function*(){var o,s;const l=yield this.dataProcessLock.lock();try{let d;if(r.data instanceof ArrayBuffer)d=r.data;else if(r.data instanceof Blob)d=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const f=tr.fromBinary(new Uint8Array(d));((o=f.value)===null||o===void 0?void 0:o.case)==="speaker"?this.emit(Me.ActiveSpeakersUpdate,f.value.value.speakers):(((s=f.value)===null||s===void 0?void 0:s.case)==="user"&&rx(f,f.value.value),this.emit(Me.DataPacketReceived,f))}finally{l()}}),this.handleDataError=r=>{const o=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(o,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const o=r.currentTarget.maxRetransmits===0?gt.LOSSY:gt.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(r,o)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=f=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(f,"ms. giving up"),this.logContext),this.emit(Me.Disconnected),this.close()},l=Date.now()-this.reconnectStart;let d=this.getNextRetryDelay({elapsedMs:l,retryCount:this.reconnectAttempts});if(d===null){s(l);return}r===op&&(d=0),this.log.debug("reconnecting in ".concat(d,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Sn.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),d)},this.waitForRestarted=()=>new Promise((r,o)=>{this.pcState===Qr.Connected&&r();const s=()=>{this.off(Me.Disconnected,l),r()},l=()=>{this.off(Me.Restarted,s),o()};this.once(Me.Restarted,s),this.once(Me.Disconnected,l)}),this.updateAndEmitDCBufferStatus=r=>{const o=this.isBufferStatusLow(r);typeof o<"u"&&o!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,o),this.emit(Me.DCBufferStatusChanged,o,r))},this.isBufferStatusLow=r=>{const o=this.dataChannelForKind(r);if(o)return o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===jt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(gs.RR_SIGNAL_DISCONNECTED))},this.log=$i((t=e.loggerName)!==null&&t!==void 0?t:ni.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Af(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new mr,this.dataProcessLock=new mr,this.dcBufferStatus=new Map([[gt.LOSSY,!0],[gt.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Me.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Me.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Me.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Me.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Me.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Me.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Me.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(Me.SignalRequestResponse,r)}get logContext(){var e,t,r,o,s,l,d,f;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomID:(o=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||o===void 0?void 0:o.sid,participant:(l=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||l===void 0?void 0:l.identity,pID:(f=(d=this.latestJoinResponse)===null||d===void 0?void 0:d.participant)===null||f===void 0?void 0:f.sid}}join(e,t,r,o){return U(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,t,r,o);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),(!this.subscriberPrimary||s.fastPublish)&&this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof Rt&&s.reason===pt.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,r,o);throw s}})}close(){return U(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(Me.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return U(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return U(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Hi("a track with the same ID has already been published");return new Promise((t,r)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Rt("publication of local track timed out, no response from server",pt.InternalError))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(o),t(s)},reject:()=>{clearTimeout(o),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return U(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return U(this,void 0,void 0,function*(){var t,r;if(this.pcManager&&this.pcManager.currentState!==Wt.NEW)return;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid;const o=this.makeRTCConfiguration(e);this.pcManager=new z2(o,e.subscriberPrimary,this.loggerOptions),this.emit(Me.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(s,l)=>{this.client.sendIceCandidate(s,l)},this.pcManager.onPublisherOffer=s=>{this.client.sendOffer(s)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(s,l,d)=>U(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(s),this.logContext),["closed","disconnected","failed"].includes(l)&&(this.publisherConnectionPromise=void 0),s===Wt.CONNECTED){const v=this.pcState===Qr.New;this.pcState=Qr.Connected,v&&this.emit(Me.Connected,e)}else s===Wt.FAILED&&this.pcState===Qr.Connected&&(this.pcState=Qr.Disconnected,this.handleDisconnect("peerconnection failed",d==="failed"?gs.RR_SUBSCRIBER_FAILED:gs.RR_PUBLISHER_FAILED));const f=this.client.isDisconnected||this.client.currentState===jt.RECONNECTING,m=[Wt.FAILED,Wt.CLOSING,Wt.CLOSED].includes(s);f&&m&&!this._isClosed&&this.emit(Me.Offline)}),this.pcManager.onTrack=s=>{this.emit(Me.MediaTrackAdded,s.track,s.streams[0],s.receiver)},nx((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>U(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=e=>U(this,void 0,void 0,function*(){if(!this.pcManager)return;const t=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Me.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Me.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Me.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Me.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",gs.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case xs.DISCONNECT:this.emit(Me.Disconnected,e==null?void 0:e.reason),this.close();break;case xs.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(op);break;case xs.RESUME:this.handleDisconnect(op)}}}makeRTCConfiguration(e){var t;const r=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const o=[];e.iceServers.forEach(s=>{const l={urls:s.urls};s.username&&(l.username=s.username),s.credential&&(l.credential=s.credential),o.push(l)}),r.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Ql.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(kb,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Cb,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,r){return U(this,void 0,void 0,function*(){if(Fp())return yield this.createTransceiverRTCRtpSender(e,t,r);if(Bp())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new sn("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,r,o){return U(this,void 0,void 0,function*(){if(Fp())return this.createSimulcastTransceiverSender(e,t,r,o);if(Bp())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new sn("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,r){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new sn("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),Ns(e)&&(e.codec=t.videoCodec);const s={direction:"sendonly",streams:o};return r&&(s.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s)).sender})}createSimulcastTransceiverSender(e,t,r,o){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new sn("publisher is closed");const s={direction:"sendonly"};o&&(s.sendEncodings=o);const l=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,s);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,l.sender),l.sender})}createRTCRtpSender(e){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new sn("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return U(this,void 0,void 0,function*(){var t,r,o;if(!this._isClosed){if(this.attemptingReconnect){ht.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===Ql.DISABLED||((o=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&o!==void 0?o:Wt.NEW)===Wt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let l=!0;s instanceof sn?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),l=!1):s instanceof vs||(this.fullReconnectOnNext=!0),l?this.handleDisconnect("reconnect",gs.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Me.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){return U(this,void 0,void 0,function*(){var t,r,o;try{if(!this.url||!this.token)throw new sn("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Me.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new vs;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(l){throw l instanceof Rt&&l.reason===pt.NotAllowed?new sn("could not reconnect, token might be expired"):new vs}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Me.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==jt.CONNECTED)throw new vs("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(Me.Restarted)}catch(s){const l=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(l){yield this.restartConnection(l);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),s}})}resumeConnection(e){return U(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new sn("could not reconnect, url or token not saved");if(!this.pcManager)throw new sn("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Me.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let s="";throw o instanceof Error&&(s=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof Rt&&o.reason===pt.NotAllowed?new sn("could not reconnect, token might be expired"):o instanceof Rt&&o.reason===pt.LeaveRequest?o:new vs(s)}if(this.emit(Me.SignalResumed),r){const o=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(o)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==jt.CONNECTED)throw new vs("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Me.Resumed)})}waitForPCInitialConnection(e,t){return U(this,void 0,void 0,function*(){if(!this.pcManager)throw new sn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return U(this,void 0,void 0,function*(){this.pcState=Qr.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield ir(ex),!this.pcManager)throw new sn("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Qr.Connected}catch(e){throw this.pcState=Qr.Disconnected,new Rt("could not establish PC connection, ".concat(e.message),pt.InternalError)}})}publishRpcResponse(e,t,r,o){return U(this,void 0,void 0,function*(){const s=new tr({destinationIdentities:[e],kind:gt.RELIABLE,value:{case:"rpcResponse",value:new t0({requestId:t,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(s,gt.RELIABLE)})}publishRpcAck(e,t){return U(this,void 0,void 0,function*(){const r=new tr({destinationIdentities:[e],kind:gt.RELIABLE,value:{case:"rpcAck",value:new e0({requestId:t})}});yield this.sendDataPacket(r,gt.RELIABLE)})}sendDataPacket(e,t){return U(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(t);const o=this.dataChannelForKind(t);o&&o.send(r),this.updateAndEmitDCBufferStatus(t)})}waitForBufferStatusLow(e){return new Promise((t,r)=>U(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const o=()=>r("Engine closed");for(this.once(Me.Closing,o);!this.dcBufferStatus.get(e);)yield ir(10);this.off(Me.Closing,o),t()}}))}ensureDataTransportConnected(e){return U(this,arguments,void 0,function(t){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var s;if(!r.pcManager)throw new sn("PC manager is closed");const l=o?r.pcManager.subscriber:r.pcManager.publisher,d=o?"Subscriber":"Publisher";if(!l)throw new Rt("".concat(d," connection not set"),pt.InternalError);let f=!1;!o&&!r.dataChannelForKind(t,o)&&(r.createDataChannels(),f=!0),!f&&!o&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(f=!0),f&&r.negotiate();const m=r.dataChannelForKind(t,o);if((m==null?void 0:m.readyState)==="open")return;const v=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<v;){if(l.isICEConnected&&((s=r.dataChannelForKind(t,o))===null||s===void 0?void 0:s.readyState)==="open")return;yield ir(50)}throw new Rt("could not establish ".concat(d," connection, state: ").concat(l.getICEConnectionState()),pt.InternalError)}()})}ensurePublisherConnected(e){return U(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Wt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return U(this,void 0,void 0,function*(){return new Promise((e,t)=>U(this,void 0,void 0,function*(){if(!this.pcManager){t(new jp("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,o=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Me.Closing,o),this.pcManager.publisher.once(Rs.RTPVideoPayloadTypes,s=>{const l=new Map;s.forEach(d=>{const f=d.codec.toLowerCase();f2(f)&&l.set(d.payload,f)}),this.emit(Me.RTPVideoMapUpdate,l)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof jp&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",gs.RR_UNKNOWN),t(s)}finally{this.off(Me.Closing,o)}}))})}dataChannelForKind(e,t){if(t){if(e===gt.LOSSY)return this.lossyDCSub;if(e===gt.RELIABLE)return this.reliableDCSub}else{if(e===gt.LOSSY)return this.lossyDC;if(e===gt.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var r,o;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const s=this.pcManager.subscriber.getLocalDescription(),l=this.pcManager.subscriber.getRemoteDescription(),d=(o=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&o!==void 0?o:!0,f=new Array,m=new Array;e.forEach(v=>{v.isDesired!==d&&f.push(v.trackSid),v.isEnabled||m.push(v.trackSid)}),this.client.sendSyncState(new v0({answer:s?td({sdp:s.sdp,type:s.type}):void 0,offer:l?td({sdp:l.sdp,type:l.type}):void 0,subscription:new fd({trackSids:f,subscribe:!d,participantTracks:[]}),publishTracks:k2(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:m}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(r,o)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new b0({label:r.label,id:r.id,target:o}))};return t(this.dataChannelForKind(gt.LOSSY),ei.PUBLISHER),t(this.dataChannelForKind(gt.RELIABLE),ei.PUBLISHER),t(this.dataChannelForKind(gt.LOSSY,!0),ei.SUBSCRIBER),t(this.dataChannelForKind(gt.RELIABLE,!0),ei.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Sn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){rr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){rr()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class vs extends Error{}function nx(n){return n!==void 0&&n>13}function rx(n,e){const t=n.participantIdentity?n.participantIdentity:e.participantIdentity;n.participantIdentity=t,e.participantIdentity=t;const r=n.destinationIdentities.length!==0?n.destinationIdentities:e.destinationIdentities;n.destinationIdentities=r,e.destinationIdentities=r}class Zp{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Vp(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return U(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(o=>o.url===r.url));if(t.length>0){const r=t[0];return this.attemptedRegions.push(r),ht.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return U(this,void 0,void 0,function*(){const t=yield fetch("".concat(ix(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(t.ok){const r=yield t.json();return this.lastUpdateAt=Date.now(),r}else throw new Rt("Could not fetch region settings: ".concat(t.statusText),t.status===401?pt.NotAllowed:pt.InternalError,t.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function ix(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}class h1{get info(){return this._info}constructor(e,t,r){this.reader=t,this.totalByteSize=r,this._info=e,this.bytesReceived=0}}class ax extends h1{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength;const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>U(this,void 0,void 0,function*(){try{const{done:t,value:r}=yield e.read();return t?{done:!0,value:void 0}:(this.handleChunkReceived(r),{done:!1,value:r.content})}catch{return{done:!0,value:void 0}}}),return(){return U(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return U(this,void 0,void 0,function*(){var e,t,r,o;let s=new Set;try{for(var l=!0,d=wa(this),f;f=yield d.next(),e=f.done,!e;l=!0){o=f.value,l=!1;const m=o;s.add(m)}}catch(m){t={error:m}}finally{try{!l&&!e&&(r=d.return)&&(yield r.call(d))}finally{if(t)throw t.error}}return Array.from(s)})}}class ox extends h1{constructor(e,t,r){super(e,t,r),this.receivedChunks=new Map}handleChunkReceived(e){var t;const r=Bu(e.chunkIndex),o=this.receivedChunks.get(r);if(o&&o.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength;const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder;return{next:()=>U(this,void 0,void 0,function*(){try{const{done:r,value:o}=yield e.read();return r?{done:!0,value:void 0}:(this.handleChunkReceived(o),{done:!1,value:t.decode(o.content)})}catch{return{done:!0,value:void 0}}}),return(){return U(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return U(this,void 0,void 0,function*(){var e,t,r,o;let s="";try{for(var l=!0,d=wa(this),f;f=yield d.next(),e=f.done,!e;l=!0)o=f.value,l=!1,s+=o}catch(m){t={error:m}}finally{try{!l&&!e&&(r=d.return)&&(yield r.call(d))}finally{if(t)throw t.error}}return s})}}class sx{constructor(e,t,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return U(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class lx extends sx{}class p1 extends ve{constructor(e,t,r,o,s){super(e,r,s),this.sid=t,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?_e.Muted:_e.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(_e.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return U(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Uf)),C2()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(t=this.receiver)===null||t===void 0?void 0:t.getSynchronizationSources()[0];if(r){const{timestamp:o,rtpTimestamp:s}=r;s&&this.rtpTimestamp!==s&&(this.emit(_e.TimeSyncUpdate,{timestamp:o,rtpTimestamp:s}),this.rtpTimestamp=s)}};e()}}class cx extends p1{constructor(e,t,r,o,s,l){super(e,t,ve.Kind.Audio,r,l),this.monitorReceiver=()=>U(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const d=yield this.getReceiverStats();d&&this.prevStats&&this.receiver&&(this._currentBitrate=bd(d,this.prevStats)),this.prevStats=d}),this.audioContext=o,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var t;for(const r of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):r.volume=e;Ci()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Ci())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return U(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(zp(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&zp(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{r.connect(o),r=o}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(_e.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit(_e.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return U(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(r=>{r.type==="inbound-rtp"&&(t={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),t})}}const sp=100;class ux extends p1{constructor(e,t,r,o,s){super(e,t,ve.Kind.Video,r,s),this.elementInfos=[],this.monitorReceiver=()=>U(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const l=yield this.getReceiverStats();l&&this.prevStats&&this.receiver&&(this._currentBitrate=bd(l,this.prevStats)),this.prevStats=l}),this.debouncedHandleResize=Nf(()=>{this.updateDimensions()},sp),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?Ps(this._mediaStreamTrack,t):ks(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new dx(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(r=>r===e);for(const r of t)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const r of t)this.stopObservingElement(r);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return U(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,r="",o=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,t={type:"video",streamId:s.id,framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&o.set(s.id,s)}),t&&r!==""&&o.get(r)&&(t.mimeType=o.get(r).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(r=>r.element===e);for(const r of t)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return U(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,t;const r=this.elementInfos.reduce((d,f)=>Math.max(d,f.visibilityChangedAt||0),0),o=!((t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&t!==void 0)||t?this.isInBackground:!1,s=this.elementInfos.some(d=>d.pictureInPicture),l=this.elementInfos.some(d=>d.visible)&&!o||s;if(this.lastVisible!==l){if(!l&&Date.now()-r<sp){Sn.setTimeout(()=>{this.updateVisibility()},sp);return}this.lastVisible=l,this.emit(_e.VisibilityChanged,l,this)}}updateDimensions(){var e,t;let r=0,o=0;const s=this.getPixelDensity();for(const l of this.elementInfos){const d=l.width()*s,f=l.height()*s;d+f>r+o&&(r=d,o=f)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===o||(this.lastDimensions={width:r,height:o},this.emit(_e.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?tb():t||(tb()>2?2:1)}}class dx{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=r=>{var o;const{target:s,isIntersecting:l}=r;s===this.element&&(this.isIntersecting=l,this.isPiP=Ml(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var r,o,s;(o=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Ml(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=Ml(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=t??Qp(e),this.isPiP=rr()&&Ml(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,r;this.isIntersecting=Qp(this.element),this.isPiP=Ml(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,rb().observe(this.element),nb().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,r,o,s;(e=rb())===null||e===void 0||e.unobserve(this.element),(t=nb())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(s=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||s===void 0||s.removeEventListener("pagehide",this.onLeavePiP)}}function Ml(n){var e,t;return document.pictureInPictureElement===n?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Qp(n,(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window):!1}function Qp(n,e){const t=e||window;let r=n.offsetTop,o=n.offsetLeft;const s=n.offsetWidth,l=n.offsetHeight,{hidden:d}=n,{display:f}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,r+=n.offsetTop,o+=n.offsetLeft;return r<t.pageYOffset+t.innerHeight&&o<t.pageXOffset+t.innerWidth&&r+l>t.pageYOffset&&o+s>t.pageXOffset&&!d&&f!=="none"}class zi extends Si.EventEmitter{constructor(e,t,r,o){var s;super(),this.metadataMuted=!1,this.encryption=fr.NONE,this.log=ht,this.handleMuted=()=>{this.emit(_e.Muted)},this.handleUnmuted=()=>{this.emit(_e.Unmuted)},this.log=$i((s=o==null?void 0:o.loggerName)!==null&&s!==void 0?s:ni.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=r,this.source=ve.Source.Unknown}setTrack(e){this.track&&(this.track.off(_e.Muted,this.handleMuted),this.track.off(_e.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(_e.Muted,this.handleMuted),e.on(_e.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),wt(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==fr.NONE}get audioTrack(){if(Wi(this.track))return this.track}get videoTrack(){if(Ns(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=ve.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===ve.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(zi||(zi={}));class Xp extends zi{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,r,o){super(e,t.sid,t.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit(_e.Ended)},this.updateInfo(t),this.setTrack(r)}setTrack(e){this.track&&this.track.off(_e.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(_e.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return U(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return U(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return U(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return U(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Wi(this.track)){const t=this.track.getSourceTrackSettings(),r=new Set;return t.autoGainControl&&r.add(wi.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&r.add(wi.TF_ECHO_CANCELLATION),t.noiseSuppression&&r.add(wi.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&r.add(wi.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(wi.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(wi.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}var ka;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(ka||(ka={}));function hx(n){switch(n){case Nl.EXCELLENT:return ka.Excellent;case Nl.GOOD:return ka.Good;case Nl.POOR:return ka.Poor;case Nl.LOST:return ka.Lost;default:return ka.Unknown}}class f1 extends Si.EventEmitter{get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Yu.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,r,o,s,l){let d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Yu.STANDARD;var f;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ka.Unknown,this.log=ht,this.log=$i((f=l==null?void 0:l.loggerName)!==null&&f!==void 0?f:ni.Participant),this.loggerOptions=l,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=r,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=d,this._attributes=s??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(ve.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(ve.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(ve.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const t=this.metadata!==e,r=this.metadata;this.metadata=e,t&&this.emit(Ae.ParticipantMetadataChanged,r)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Ae.ParticipantNameChanged,e)}_setAttributes(e){const t=S2(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Ae.AttributesChanged,t)}setPermissions(e){var t,r,o,s,l,d;const f=this.permissions,m=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((l=this.permissions)===null||l===void 0?void 0:l.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((v,T)=>{var x;return v!==((x=this.permissions)===null||x===void 0?void 0:x.canPublishSources[T])})||e.canSubscribeMetrics!==((d=this.permissions)===null||d===void 0?void 0:d.canSubscribeMetrics);return this.permissions=e,m&&this.emit(Ae.ParticipantPermissionsChanged,f),m}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Ae.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=hx(e),t!==this._connectionQuality&&this.emit(Ae.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>Wi(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(_e.Muted,()=>{this.emit(Ae.TrackMuted,e)}),e.on(_e.Unmuted,()=>{this.emit(Ae.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case ve.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case ve.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function px(n){var e,t,r;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new m0({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(r=n.allowAll)!==null&&r!==void 0?r:!1,trackSids:n.allowedTrackSids||[]})}const Su=15e3;class fx extends f1{constructor(e,t,r,o,s){super(e,t,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=fr.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new t1)},this.handleReconnected=()=>{var l,d;(d=(l=this.reconnectFuture)===null||l===void 0?void 0:l.resolve)===null||d===void 0||d.call(l),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var l,d;this.reconnectFuture&&(this.reconnectFuture.promise.catch(f=>this.log.warn(f.message,this.logContext)),(d=(l=this.reconnectFuture)===null||l===void 0?void 0:l.reject)===null||d===void 0||d.call(l,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=l=>{const{requestId:d,reason:f,message:m}=l,v=this.pendingSignalRequests.get(d);v&&(f!==_f.OK&&v.reject(new Xv(m,f)),this.pendingSignalRequests.delete(d))},this.handleDataPacket=l=>{switch(l.value.case){case"rpcResponse":let d=l.value.value,f=null,m=null;d.value.case==="payload"?f=d.value.value:d.value.case==="error"&&(m=Kt.fromProto(d.value.value)),this.handleIncomingRpcResponse(d.requestId,f,m);break;case"rpcAck":let v=l.value.value;this.handleIncomingRpcAck(v.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(l=>px(l)))},this.onTrackUnmuted=l=>{this.onTrackMuted(l,l.isUpstreamPaused)},this.onTrackMuted=(l,d)=>{if(d===void 0&&(d=!0),!l.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),wt(l)));return}this.engine.updateMuteStatus(l.sid,d)},this.onTrackUpstreamPaused=l=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),wt(l))),this.onTrackMuted(l,!0)},this.onTrackUpstreamResumed=l=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),wt(l))),this.onTrackMuted(l,l.isMuted)},this.onTrackFeatureUpdate=l=>{const d=this.audioTrackPublications.get(l.sid);if(!d){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(l.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(d.trackSid,d.getTrackFeatures())},this.handleSubscribedQualityUpdate=l=>U(this,void 0,void 0,function*(){var d,f,m,v,T,x;if(!(!((T=this.roomOptions)===null||T===void 0)&&T.dynacast))return;const S=this.videoTrackPublications.get(l.trackSid);if(!S){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:l.trackSid}));return}if(l.subscribedCodecs.length>0){if(!S.videoTrack)return;const $=yield S.videoTrack.setPublishingCodecs(l.subscribedCodecs);try{for(var M=!0,N=wa($),V;V=yield N.next(),d=V.done,!d;M=!0){v=V.value,M=!1;const ae=v;r2(ae)&&(this.log.debug("publish ".concat(ae," for ").concat(S.videoTrack.sid),Object.assign(Object.assign({},this.logContext),wt(S))),yield this.publishAdditionalCodecForTrack(S.videoTrack,ae,S.options))}}catch(ae){f={error:ae}}finally{try{!M&&!d&&(m=N.return)&&(yield m.call(N))}finally{if(f)throw f.error}}}else l.subscribedQualities.length>0&&(yield(x=S.videoTrack)===null||x===void 0?void 0:x.setPublishingLayers(l.subscribedQualities))}),this.handleLocalTrackUnpublished=l=>{const d=this.trackPublications.get(l.trackSid);if(!d){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:l.trackSid}));return}this.unpublishTrack(d.track)},this.handleTrackEnded=l=>U(this,void 0,void 0,function*(){if(l.source===ve.Source.ScreenShare||l.source===ve.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),wt(l))),this.unpublishTrack(l);else if(l.isUserProvided)yield l.mute();else if(fo(l)||va(l))try{if(rr())try{const d=yield navigator==null?void 0:navigator.permissions.query({name:l.source===ve.Source.Camera?"camera":"microphone"});if(d&&d.state==="denied")throw this.log.warn("user has revoked access to ".concat(l.source),Object.assign(Object.assign({},this.logContext),wt(l))),d.onchange=()=>{d.state!=="denied"&&(l.isMuted||l.restartTrack(),d.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}l.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),wt(l))),fo(l)?yield l.restartTrack({deviceId:"default"}):yield l.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),wt(l))),yield l.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=o,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=s}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==fr.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.on(Me.RemoteMute,(t,r)=>{const o=this.trackPublications.get(t);!o||!o.track||(r?o.mute():o.unmute())}),this.engine.on(Me.Connected,this.handleReconnected).on(Me.SignalRestarted,this.handleReconnected).on(Me.SignalResumed,this.handleReconnected).on(Me.Restarting,this.handleReconnecting).on(Me.Resuming,this.handleReconnecting).on(Me.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Me.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Me.Disconnected,this.handleDisconnected).on(Me.SignalRequestResponse,this.handleSignalRequestResponse).on(Me.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return U(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return U(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return U(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return U(this,arguments,void 0,function(t){var r=this;let{metadata:o,name:s,attributes:l}=t;return function*(){return new Promise((d,f)=>U(r,void 0,void 0,function*(){var m,v;try{let T=!1;const x=yield this.engine.client.sendUpdateLocalMetadata((m=o??this.metadata)!==null&&m!==void 0?m:"",(v=s??this.name)!==null&&v!==void 0?v:"",l),S=performance.now();for(this.pendingSignalRequests.set(x,{resolve:d,reject:M=>{f(M),T=!0},values:{name:s,metadata:o,attributes:l}});performance.now()-S<5e3&&!T;){if((!s||this.name===s)&&(!o||this.metadata===o)&&(!l||Object.entries(l).every(M=>{let[N,V]=M;return this.attributes[N]===V||V===""&&!this.attributes[N]}))){this.pendingSignalRequests.delete(x),d();return}yield ir(50)}f(new Xv("Request to update local metadata timed out","TimeoutError"))}catch(T){T instanceof Error&&f(T)}}))}()})}setCameraEnabled(e,t,r){return this.setTrackEnabled(ve.Source.Camera,e,t,r)}setMicrophoneEnabled(e,t,r){return this.setTrackEnabled(ve.Source.Microphone,e,t,r)}setScreenShareEnabled(e,t,r){return this.setTrackEnabled(ve.Source.ScreenShare,e,t,r)}setPermissions(e){const t=this.permissions,r=super.setPermissions(e);return r&&t&&this.emit(Ae.ParticipantPermissionsChanged,t),r}setE2EEEnabled(e){return U(this,void 0,void 0,function*(){this.encryptionType=e?fr.GCM:fr.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,r,o){return U(this,void 0,void 0,function*(){var s,l;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let d=this.getTrackPublication(e);if(t)if(d)yield d.unmute();else{let f;if(this.pendingPublishing.has(e)){const m=yield this.waitForPendingPublicationOfSource(e);return m||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield m==null?void 0:m.unmute(),m}this.pendingPublishing.add(e);try{switch(e){case ve.Source.Camera:f=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case ve.Source.Microphone:f=yield this.createTracks({audio:(l=r)!==null&&l!==void 0?l:!0});break;case ve.Source.ScreenShare:f=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Hi(e)}}catch(m){throw f==null||f.forEach(v=>{v.stop()}),m instanceof Error&&this.emit(Ae.MediaDevicesError,m),this.pendingPublishing.delete(e),m}try{const m=[];for(const v of f)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),wt(v))),m.push(this.publishTrack(v,o));[d]=yield Promise.all(m)}catch(m){throw f==null||f.forEach(v=>{v.stop()}),m}finally{this.pendingPublishing.delete(e)}}else if(!(d!=null&&d.track)&&this.pendingPublishing.has(e)&&(d=yield this.waitForPendingPublicationOfSource(e),d||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),d&&d.track)if(e===ve.Source.ScreenShare){d=yield this.unpublishTrack(d.track);const f=this.getTrackPublication(ve.Source.ScreenShareAudio);f&&f.track&&this.unpublishTrack(f.track)}else yield d.mute();return d})}enableCameraAndMicrophone(){return U(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(ve.Source.Camera)||this.pendingPublishing.has(ve.Source.Microphone))){this.pendingPublishing.add(ve.Source.Camera),this.pendingPublishing.add(ve.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(ve.Source.Camera),this.pendingPublishing.delete(ve.Source.Microphone)}}})}createTracks(e){return U(this,void 0,void 0,function*(){var t,r;e??(e={});const o=n1(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),{audioProcessor:s,videoProcessor:l,optionsWithoutProcessor:d}=Mf(o),f=vd(d);let m;try{m=yield navigator.mediaDevices.getUserMedia(f)}catch(v){throw v instanceof Error&&(f.audio&&(this.microphoneError=v),f.video&&(this.cameraError=v)),v}return f.audio&&(this.microphoneError=void 0,this.emit(Ae.AudioStreamAcquired)),f.video&&(this.cameraError=void 0),Promise.all(m.getTracks().map(v=>U(this,void 0,void 0,function*(){const T=v.kind==="audio";let x;const S=T?f.audio:f.video;typeof S!="boolean"&&(x=S);const M=u1(v,x,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return M.kind===ve.Kind.Video?M.source=ve.Source.Camera:M.kind===ve.Kind.Audio&&(M.source=ve.Source.Microphone,M.setAudioContext(this.audioContext)),M.mediaStream=m,Wi(M)&&s?yield M.setProcessor(s):Ns(M)&&l&&(yield M.setProcessor(l)),M})))})}createScreenTracks(e){return U(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new If("getDisplayMedia not supported");e.resolution===void 0&&!c2()&&(e.resolution=Of.h1080fps30.resolution);const t=w2(e),r=yield navigator.mediaDevices.getDisplayMedia(t),o=r.getVideoTracks();if(o.length===0)throw new Hi("no video track found");const s=new id(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=ve.Source.ScreenShare,e.contentHint&&(s.mediaStreamTrack.contentHint=e.contentHint);const l=[s];if(r.getAudioTracks().length>0){this.emit(Ae.AudioStreamAcquired);const d=new nd(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});d.source=ve.Source.ScreenShareAudio,l.push(d)}return l})}publishTrack(e,t){return U(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return U(this,arguments,void 0,function(r,o){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var d,f,m,v;fo(r)&&r.setAudioContext(s.audioContext),yield(d=s.reconnectFuture)===null||d===void 0?void 0:d.promise,s.republishPromise&&!l&&(yield s.republishPromise),_s(r)&&s.pendingPublishPromises.has(r)&&(yield s.pendingPublishPromises.get(r));let T;if(r instanceof MediaStreamTrack)T=r.getConstraints();else{T=r.constraints;let $;switch(r.source){case ve.Source.Microphone:$="audioinput";break;case ve.Source.Camera:$="videoinput"}$&&s.activeDeviceMap.has($)&&(T=Object.assign(Object.assign({},T),{deviceId:s.activeDeviceMap.get($)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new nd(r,T,!0,s.audioContext,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;case"video":r=new id(r,T,!0,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;default:throw new Hi("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});let x;if(s.trackPublications.forEach($=>{$.track&&$.track===r&&(x=$)}),x)return s.log.warn("track has already been published, skipping",Object.assign(Object.assign({},s.logContext),wt(x))),x;const S="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,M=(f=o==null?void 0:o.forceStereo)!==null&&f!==void 0?f:S;M&&(o||(o={}),o.dtx===void 0&&s.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},s.logContext),wt(r))),o.red===void 0&&s.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(m=o.dtx)!==null&&m!==void 0||(o.dtx=!1),(v=o.red)!==null&&v!==void 0||(o.red=!1));const N=Object.assign(Object.assign({},s.roomOptions.publishDefaults),o);!u2()&&s.roomOptions.e2ee&&(s.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},s.logContext)),N.simulcast=!1),N.source&&(r.source=N.source);const V=s.publish(r,N,M);s.pendingPublishPromises.set(r,V);try{return yield V}catch($){throw $}finally{s.pendingPublishPromises.delete(r)}}()})}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),wt(e))),!1;const{canPublish:t,canPublishSources:r}=this.permissions;return t&&(r.length===0||r.map(o=>T2(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),wt(e))),!1)}publish(e,t,r){return U(this,void 0,void 0,function*(){var o,s,l,d,f,m,v,T,x,S;if(!this.hasPermissionsToPublish(e))throw new GT("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(A=>_s(e)&&A.source===e.source)&&e.source!==ve.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),wt(e))),t.stopMicTrackOnMute&&Wi(e)&&(e.stopOnMute=!0),e.source===ve.Source.ScreenShare&&Ms()&&(t.simulcast=!1),t.videoCodec==="av1"&&!o2()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!s2()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=Wp),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(A=>t.videoCodec===zu(A.mime))||(t.videoCodec=zu(this.enabledPublishVideoCodecs[0].mime)));const M=t.videoCodec;e.on(_e.Muted,this.onTrackMuted),e.on(_e.Unmuted,this.onTrackUnmuted),e.on(_e.Ended,this.handleTrackEnded),e.on(_e.UpstreamPaused,this.onTrackUpstreamPaused),e.on(_e.UpstreamResumed,this.onTrackUpstreamResumed),e.on(_e.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const N=new Ep({cid:e.mediaStreamTrack.id,name:t.name,type:ve.kindToProto(e.kind),muted:e.isMuted,source:ve.sourceToProto(e.source),disableDtx:!(!((o=t.dtx)!==null&&o!==void 0)||o),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=t.red)!==null&&s!==void 0)||s),stream:t==null?void 0:t.stream,backupCodecPolicy:t==null?void 0:t.backupCodecPolicy});let V;if(e.kind===ve.Kind.Video){let A={width:0,height:0};try{A=yield e.waitForDimensions()}catch{const F=(d=(l=this.roomOptions.videoCaptureDefaults)===null||l===void 0?void 0:l.resolution)!==null&&d!==void 0?d:Jl.h720.resolution;A={width:F.width,height:F.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),wt(e)),{dims:A}))}N.width=A.width,N.height=A.height,va(e)&&(Fl(M)&&(e.source===ve.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),wt(e))))),t.scalabilityMode=(f=t.scalabilityMode)!==null&&f!==void 0?f:"L3T3_KEY"),N.simulcastCodecs=[new xp({codec:M,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:Wp}),t.backupCodec&&M!==t.backupCodec.codec&&N.encryption===fr.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),N.simulcastCodecs.push(new xp({codec:t.backupCodec.codec,cid:""})))),V=Kp(e.source===ve.Source.ScreenShare,N.width,N.height,t),N.layers=wb(N.width,N.height,V,Fl(t.videoCodec))}else e.kind===ve.Kind.Audio&&(V=[{maxBitrate:(m=t.audioPreset)===null||m===void 0?void 0:m.maxBitrate,priority:(T=(v=t.audioPreset)===null||v===void 0?void 0:v.priority)!==null&&T!==void 0?T:"high",networkPriority:(S=(x=t.audioPreset)===null||x===void 0?void 0:x.priority)!==null&&S!==void 0?S:"high"}]);if(!this.engine||this.engine.isClosed)throw new sn("cannot publish track when not connected");const $=()=>U(this,void 0,void 0,function*(){var A,F,J;if(!this.engine.pcManager)throw new sn("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,V),va(e)&&((A=t.degradationPreference)!==null&&A!==void 0||(t.degradationPreference=J2(e)),e.setDegradationPreference(t.degradationPreference)),V)if(Ms()&&e.kind===ve.Kind.Audio){let de;for(const te of this.engine.pcManager.publisher.getTransceivers())if(te.sender===e.sender){de=te;break}de&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:de,codec:"opus",maxbr:!((F=V[0])===null||F===void 0)&&F.maxBitrate?V[0].maxBitrate/1e3:0})}else e.codec&&Fl(e.codec)&&!((J=V[0])===null||J===void 0)&&J.maxBitrate&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:N.cid,codec:e.codec,maxbr:V[0].maxBitrate/1e3});yield this.engine.negotiate()});let ae;if(this.enabledPublishVideoCodecs.length>0)ae=(yield Promise.all([this.engine.addTrack(N),$()]))[0];else{ae=yield this.engine.addTrack(N);let A;if(ae.codecs.forEach(F=>{A===void 0&&(A=F.mimeType)}),A&&e.kind===ve.Kind.Video){const F=zu(A);F!==M&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),wt(e)),{codec:F})),t.videoCodec=F,V=Kp(e.source===ve.Source.ScreenShare,N.width,N.height,t))}yield $()}const z=new Xp(e.kind,ae,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return z.options=t,e.sid=ae.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:V,trackInfo:ae})),va(e)?e.startMonitor(this.engine.client):fo(e)&&e.startMonitor(),this.addTrackPublication(z),this.emit(Ae.LocalTrackPublished,z),z})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,r){return U(this,void 0,void 0,function*(){var o;if(this.encryptionType!==fr.NONE)return;let s;if(this.trackPublications.forEach(x=>{x.track&&x.track===e&&(s=x)}),!s)throw new Hi("track is not published");if(!va(e))throw new Hi("track is not a video track");const l=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),r),d=Z2(e,t,l);if(!d){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),wt(e)));return}const f=e.addSimulcastTrack(t,d);if(!f)return;const m=new Ep({cid:f.mediaStreamTrack.id,type:ve.kindToProto(e.kind),muted:e.isMuted,source:ve.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:l.videoCodec,cid:f.mediaStreamTrack.id}]});if(m.layers=wb(m.width,m.height,d),!this.engine||this.engine.isClosed)throw new sn("cannot publish track when not connected");const v=()=>U(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,f,l,d),yield this.engine.negotiate()}),T=(yield Promise.all([this.engine.addTrack(m),v()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:d,trackInfo:T}))})}unpublishTrack(e,t){return U(this,void 0,void 0,function*(){var r,o;if(_s(e)){const m=this.pendingPublishPromises.get(e);m&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),wt(e))),yield m)}const s=this.getPublicationForTrack(e),l=s?wt(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),l)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),l));return}e=s.track,e.off(_e.Muted,this.onTrackMuted),e.off(_e.Unmuted,this.onTrackUnmuted),e.off(_e.Ended,this.handleTrackEnded),e.off(_e.UpstreamPaused,this.onTrackUpstreamPaused),e.off(_e.UpstreamResumed,this.onTrackUpstreamResumed),e.off(_e.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),t===void 0&&(t=(o=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),t?e.stop():e.stopMonitor();let d=!1;const f=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Wt.FAILED&&f)try{for(const m of this.engine.pcManager.publisher.getTransceivers())m.sender===f&&(m.direction="inactive",d=!0);if(this.engine.removeTrack(f)&&(d=!0),va(e)){for(const[,m]of e.simulcastCodecs)m.sender&&(this.engine.removeTrack(m.sender)&&(d=!0),m.sender=void 0);e.simulcastCodecs.clear()}}catch(m){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),l),{error:m}))}switch(this.trackPublications.delete(s.trackSid),s.kind){case ve.Kind.Audio:this.audioTrackPublications.delete(s.trackSid);break;case ve.Kind.Video:this.videoTrackPublications.delete(s.trackSid);break}return this.emit(Ae.LocalTrackUnpublished,s),s.setTrack(void 0),d&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return U(this,void 0,void 0,function*(){return(yield Promise.all(e.map(t=>this.unpublishTrack(t)))).filter(t=>!!t)})}republishAllTracks(e){return U(this,arguments,void 0,function(t){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((s,l)=>U(r,void 0,void 0,function*(){try{const d=[];this.trackPublications.forEach(f=>{f.track&&(t&&(f.options=Object.assign(Object.assign({},f.options),t)),d.push(f))}),yield Promise.all(d.map(f=>U(this,void 0,void 0,function*(){const m=f.track;yield this.unpublishTrack(m,!1),o&&!m.isMuted&&m.source!==ve.Source.ScreenShare&&m.source!==ve.Source.ScreenShareAudio&&(fo(m)||va(m))&&!m.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:f.trackSid})),yield m.restartTrack()),yield this.publishOrRepublishTrack(m,f.options,!0)}))),s()}catch(d){l(d)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return U(this,arguments,void 0,function(t){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const s=o.reliable?gt.RELIABLE:gt.LOSSY,l=o.destinationIdentities,d=o.topic,f=new tr({kind:s,value:{case:"user",value:new Xy({participantIdentity:r.identity,payload:t,destinationIdentities:l,topic:d})}});yield r.engine.sendDataPacket(f,s)}()})}publishDtmf(e,t){return U(this,void 0,void 0,function*(){const r=new tr({kind:gt.RELIABLE,value:{case:"sipDtmf",value:new Jy({code:e,digit:t})}});yield this.engine.sendDataPacket(r,gt.RELIABLE)})}sendChatMessage(e,t){return U(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:t==null?void 0:t.attachments},o=new tr({value:{case:"chatMessage",value:new yp(Object.assign(Object.assign({},r),{timestamp:Ut.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(o,gt.RELIABLE),this.emit(Ae.ChatMessage,r),r})}editChatMessage(e,t){return U(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),o=new tr({value:{case:"chatMessage",value:new yp(Object.assign(Object.assign({},r),{timestamp:Ut.parse(r.timestamp),editTimestamp:Ut.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,gt.RELIABLE),this.emit(Ae.ChatMessage,r),r})}sendText(e,t){return U(this,void 0,void 0,function*(){var r;const o=crypto.randomUUID(),s=new TextEncoder().encode(e).byteLength,l=(r=t==null?void 0:t.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),d=new Array(l?l.length+1:1).fill(0),f=(v,T)=>{var x;d[T]=v;const S=d.reduce((M,N)=>M+N,0);(x=t==null?void 0:t.onProgress)===null||x===void 0||x.call(t,S)},m=yield this.streamText({streamId:o,totalSize:s,destinationIdentities:t==null?void 0:t.destinationIdentities,topic:t==null?void 0:t.topic,attachedStreamIds:l,attributes:t==null?void 0:t.attributes});return yield m.write(e),f(1,0),yield m.close(),t!=null&&t.attachments&&l&&(yield Promise.all(t.attachments.map((v,T)=>U(this,void 0,void 0,function*(){return this._sendFile(l[T],v,{topic:t.topic,mimeType:v.type,onProgress:x=>{f(x,T+1)}})})))),m.info})}streamText(e){return U(this,void 0,void 0,function*(){var t,r;const o=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),s={id:o,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes},l=new kp({streamId:o,mimeType:s.mimeType,topic:s.topic,timestamp:po(s.timestamp),totalLength:po(e==null?void 0:e.totalSize),attributes:s.attributes,contentHeader:{case:"textHeader",value:new l0({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?wp.UPDATE:wp.CREATE})}}),d=e==null?void 0:e.destinationIdentities,f=new tr({destinationIdentities:d,value:{case:"streamHeader",value:l}});yield this.engine.sendDataPacket(f,gt.RELIABLE);let m=0;const v=this,T=new WritableStream({write(M){return U(this,void 0,void 0,function*(){for(const N of y2(M,Su)){yield v.engine.waitForBufferStatusLow(gt.RELIABLE);const V=new Cp({content:N,streamId:o,chunkIndex:po(m)}),$=new tr({destinationIdentities:d,value:{case:"streamChunk",value:V}});yield v.engine.sendDataPacket($,gt.RELIABLE),m+=1}})},close(){return U(this,void 0,void 0,function*(){const M=new Sp({streamId:o}),N=new tr({destinationIdentities:d,value:{case:"streamTrailer",value:M}});yield v.engine.sendDataPacket(N,gt.RELIABLE)})},abort(M){console.log("Sink error:",M)}});let x=()=>U(this,void 0,void 0,function*(){yield S.close()});v.engine.once(Me.Closing,x);const S=new lx(T,s,()=>this.engine.off(Me.Closing,x));return S})}sendFile(e,t){return U(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,t),{id:r}})}_sendFile(e,t,r){return U(this,void 0,void 0,function*(){var o,s;const l=t.size,d=new kp({totalLength:po(l),mimeType:(o=r==null?void 0:r.mimeType)!==null&&o!==void 0?o:t.type,streamId:e,topic:r==null?void 0:r.topic,encryptionType:r==null?void 0:r.encryptionType,timestamp:po(Date.now()),contentHeader:{case:"byteHeader",value:new c0({name:t.name})}}),f=r==null?void 0:r.destinationIdentities,m=new tr({destinationIdentities:f,value:{case:"streamHeader",value:d}});yield this.engine.sendDataPacket(m,gt.RELIABLE);function v(M){return new Promise(N=>{const V=new FileReader;V.onload=()=>{N(new Uint8Array(V.result))},V.readAsArrayBuffer(M)})}const T=Math.ceil(l/Su);for(let M=0;M<T;M++){const N=yield v(t.slice(M*Su,Math.min((M+1)*Su,l)));yield this.engine.waitForBufferStatusLow(gt.RELIABLE);const V=new Cp({content:N,streamId:e,chunkIndex:po(M)}),$=new tr({destinationIdentities:f,value:{case:"streamChunk",value:V}});yield this.engine.sendDataPacket($,gt.RELIABLE),(s=r==null?void 0:r.onProgress)===null||s===void 0||s.call(r,(M+1)/T)}const x=new Sp({streamId:e}),S=new tr({destinationIdentities:f,value:{case:"streamTrailer",value:x}});yield this.engine.sendDataPacket(S,gt.RELIABLE)})}performRpc(e){return U(this,arguments,void 0,function(t){var r=this;let{destinationIdentity:o,method:s,payload:l,responseTimeout:d=1e4}=t;return function*(){return new Promise((f,m)=>U(r,void 0,void 0,function*(){var v,T,x,S;if(Df(l)>l1){m(Kt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((T=(v=this.engine.latestJoinResponse)===null||v===void 0?void 0:v.serverInfo)===null||T===void 0)&&T.version&&So((S=(x=this.engine.latestJoinResponse)===null||x===void 0?void 0:x.serverInfo)===null||S===void 0?void 0:S.version,"1.8.0")<0){m(Kt.builtIn("UNSUPPORTED_SERVER"));return}const M=crypto.randomUUID();yield this.publishRpcRequest(o,M,s,l,d-2e3);const N=setTimeout(()=>{this.pendingAcks.delete(M),m(Kt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(M),clearTimeout(V)},2e3);this.pendingAcks.set(M,{resolve:()=>{clearTimeout(N)},participantIdentity:o});const V=setTimeout(()=>{this.pendingResponses.delete(M),m(Kt.builtIn("RESPONSE_TIMEOUT"))},d);this.pendingResponses.set(M,{resolve:($,ae)=>{clearTimeout(V),this.pendingAcks.has(M)&&(console.warn("RPC response received before ack",M),this.pendingAcks.delete(M),clearTimeout(N)),ae?m(ae):f($??"")},participantIdentity:o})}))}()})}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,r){const o=this.pendingResponses.get(e);o?(o.resolve(t,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,r,o,s){return U(this,void 0,void 0,function*(){const l=new tr({destinationIdentities:[e],kind:gt.RELIABLE,value:{case:"rpcRequest",value:new Yy({id:t,method:r,payload:o,responseTimeoutMs:s,version:1})}});yield this.engine.sendDataPacket(l,gt.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:r,resolve:o}]of this.pendingResponses)r===e&&(o(null,Kt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(t=>t.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(t=>{var r,o;const s=this.trackPublications.get(t.sid);if(s){const l=s.isMuted||((o=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&o!==void 0?o:!1);l!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),wt(s)),{mutedOnServer:l})),this.engine.client.sendMuteTrack(t.sid,l))}}),!0)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(r=>{const o=r.track;o&&(e instanceof MediaStreamTrack?(fo(o)||va(o))&&o.mediaStreamTrack===e&&(t=r):e===o&&(t=r))}),t}waitForPendingPublicationOfSource(e){return U(this,void 0,void 0,function*(){const t=Date.now();for(;Date.now()<t+1e4;){const r=Array.from(this.pendingPublishPromises.entries()).find(o=>{let[s]=o;return s.source===e});if(r)return r[1];yield ir(20)}})}}class mx extends zi{constructor(e,t,r,o){super(e,t.sid,t.name,o),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Mr.HIGH,this.handleEnded=s=>{this.setTrack(void 0),this.emit(_e.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensions=s,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new fd({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new r0({participantSid:"",trackSids:[this.trackSid]})]});this.emit(_e.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?zi.SubscriptionStatus.Unsubscribed:super.isSubscribed?zi.SubscriptionStatus.Subscribed:zi.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?zi.PermissionStatus.Allowed:zi.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,r;this.isManualOperationAllowed()&&(((t=this.videoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(tp(this.track)&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&tp(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const t=this.subscriptionStatus,r=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off(_e.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off(_e.VisibilityChanged,this.handleVisibilityChange),o.off(_e.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit(_e.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(_e.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(_e.VisibilityChanged,this.handleVisibilityChange),e.on(_e.Ended,this.handleEnded),this.emit(_e.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(_e.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?_e.Muted:_e.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(_e.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(_e.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===ve.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return tp(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new u0({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=Mr.HIGH,this.emit(_e.UpdateSettings,e)}}class ad extends f1{static fromParticipantInfo(e,t,r){return new ad(e,t.sid,t.identity,t.name,t.metadata,t.attributes,r,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,r,o,s,l,d){let f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Yu.STANDARD;super(t,r||"",o,s,l,d,f),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(_e.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),wt(e))),this.signalClient.sendUpdateTrackSettings(t)}),e.on(_e.UpdateSubscription,t=>{t.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(_e.SubscriptionPermissionChanged,t=>{this.emit(Ae.TrackSubscriptionPermissionChanged,e,t)}),e.on(_e.SubscriptionStatusChanged,t=>{this.emit(Ae.TrackSubscriptionStatusChanged,e,t)}),e.on(_e.Subscribed,t=>{this.emit(Ae.TrackSubscribed,t,e)}),e.on(_e.Unsubscribed,t=>{this.emit(Ae.TrackUnsubscribed,t,e)}),e.on(_e.SubscriptionFailed,t=>{this.emit(Ae.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve.Source.Microphone;this.volumeMap.set(t,e);const r=this.getTrackPublication(t);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ve.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,r,o,s,l){let d=this.getTrackPublicationBySid(t);if(d||t.startsWith("TR")||this.trackPublications.forEach(v=>{!d&&e.kind===v.kind.toString()&&(d=v)}),!d){if(l===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit(Ae.TrackSubscriptionFailed,t);return}l===void 0&&(l=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,r,o,s,l-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),wt(d))),this.emit(Ae.TrackSubscriptionFailed,t);return}const f=e.kind==="video";let m;return f?m=new ux(e,t,o,s):m=new cx(e,t,o,this.audioContext,this.audioOutput),m.source=d.source,m.isMuted=d.isMuted,m.setMediaStream(r),m.start(),d.setTrack(m),this.volumeMap.has(d.source)&&qp(m)&&Wi(m)&&m.setVolume(this.volumeMap.get(d.source)),d}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,r=new Map;return e.tracks.forEach(o=>{var s,l;let d=this.getTrackPublicationBySid(o.sid);if(d)d.updateInfo(o);else{const f=ve.kindFromProto(o.type);if(!f)return;d=new mx(f,o,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(l=this.loggerOptions)===null||l===void 0?void 0:l.loggerName}),d.updateInfo(o),r.set(o.sid,d);const m=Array.from(this.trackPublications.values()).find(v=>v.source===(d==null?void 0:d.source));m&&d.source!==ve.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(d.source),Object.assign(Object.assign({},this.logContext),{oldTrack:wt(m),newTrack:wt(d)})),this.addTrackPublication(d)}t.set(o.sid,d)}),this.trackPublications.forEach(o=>{t.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),wt(o))),this.unpublishTrack(o.trackSid,!0))}),r.forEach(o=>{this.emit(Ae.TrackPublished,o)}),!0}unpublishTrack(e,t){const r=this.trackPublications.get(e);if(!r)return;const{track:o}=r;switch(o&&(o.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case ve.Kind.Audio:this.audioTrackPublications.delete(e);break;case ve.Kind.Video:this.videoTrackPublications.delete(e);break}t&&this.emit(Ae.TrackUnpublished,r)}setAudioOutput(e){return U(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(r=>{var o;Wi(r.track)&&qp(r.track)&&t.push(r.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var bt;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting"})(bt||(bt={}));const gx=4*1e3;class As extends Si.EventEmitter{constructor(e){var t,r,o,s;if(super(),t=this,this.state=bt.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=ht,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(l,d,f)=>U(this,void 0,void 0,function*(){var m;if(!l2())throw Ci()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const v=yield this.disconnectLock.lock();if(this.state===bt.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),v(),Promise.resolve();if(this.connectFuture)return v(),this.connectFuture.promise;this.setAndEmitConnectionState(bt.Connecting),((m=this.regionUrlProvider)===null||m===void 0?void 0:m.getServerUrl().toString())!==l&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Vp(new URL(l))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Zp(l,d):this.regionUrlProvider.updateToken(d),this.regionUrlProvider.fetchRegionSettings().then(S=>{var M;(M=this.regionUrlProvider)===null||M===void 0||M.setServerReportedRegions(S)}).catch(S=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:S}))}));const T=(S,M,N)=>U(this,void 0,void 0,function*(){var V,$;this.abortController&&this.abortController.abort();const ae=new AbortController;this.abortController=ae,v==null||v();try{yield this.attemptConnection(N??l,d,f,ae),this.abortController=void 0,S()}catch(z){if(this.regionUrlProvider&&z instanceof Rt&&z.reason!==pt.Cancelled&&z.reason!==pt.NotAllowed){let A=null;try{A=yield this.regionUrlProvider.getNextBestRegionUrl((V=this.abortController)===null||V===void 0?void 0:V.signal)}catch(F){if(F instanceof Rt&&(F.status===401||F.reason===pt.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),M(F);return}}A&&!(!(($=this.abortController)===null||$===void 0)&&$.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(z.message,". Retrying with another region: ").concat(A),this.logContext),this.recreateEngine(),yield T(S,M,A)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ab(z)),M(z))}else{let A=ti.UNKNOWN_REASON;z instanceof Rt&&(A=ab(z)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,A),M(z)}}}),x=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new t1((S,M)=>{T(S,M,x)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(l,d,f,m,v,T)=>U(this,void 0,void 0,function*(){var x,S,M;const N=yield f.join(l,d,{autoSubscribe:m.autoSubscribe,adaptiveStream:typeof v.adaptiveStream=="object"?!0:v.adaptiveStream,maxRetries:m.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:m.websocketTimeout},T.signal);let V=N.serverInfo;if(V||(V={version:N.serverVersion,region:N.serverRegion}),this.serverInfo=V,this.log.debug("connected to Livekit Server ".concat(Object.entries(V).map($=>{let[ae,z]=$;return"".concat(ae,": ").concat(z)}).join(", ")),{room:(x=N.room)===null||x===void 0?void 0:x.name,roomSid:(S=N.room)===null||S===void 0?void 0:S.sid,identity:(M=N.participant)===null||M===void 0?void 0:M.identity}),!V.version)throw new WT("unknown server version");return V.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),v.dynacast=!1),N}),this.applyJoinResponse=l=>{const d=l.participant;if(this.localParticipant.sid=d.sid,this.localParticipant.identity=d.identity,this.localParticipant.setEnabledPublishCodecs(l.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(l.sifTrailer)}catch(f){this.log.error(f instanceof Error?f.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:f}))}this.handleParticipantUpdates([d,...l.otherParticipants]),l.room&&this.handleRoomUpdate(l.room)},this.attemptConnection=(l,d,f,m)=>U(this,void 0,void 0,function*(){var v,T;this.state===bt.Reconnecting||this.isResuming||!((v=this.engine)===null||v===void 0)&&v.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((T=this.regionUrlProvider)===null||T===void 0)&&T.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},jf),f),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const x=yield this.connectSignal(l,d,this.engine,this.connOptions,this.options,m);this.applyJoinResponse(x),this.setupLocalParticipantEvents(),this.emit(Te.SignalConnected)}catch(x){yield this.engine.close(),this.recreateEngine();const S=new Rt("could not establish signal connection",pt.ServerUnreachable);throw x instanceof Error&&(S.message="".concat(S.message,": ").concat(x.message)),x instanceof Rt&&(S.reason=x.reason,S.status=x.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:x})),S}if(m.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Rt("Connection attempt aborted",pt.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,m)}catch(x){throw yield this.engine.close(),this.recreateEngine(),x}rr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),rr()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(bt.Connected),this.emit(Te.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var l=arguments.length,d=new Array(l),f=0;f<l;f++)d[f]=arguments[f];return U(t,[...d],void 0,function(){var m=this;let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var T,x,S,M;const N=yield m.disconnectLock.lock();try{if(m.state===bt.Disconnected){m.log.debug("already disconnected",m.logContext);return}m.log.info("disconnect from room",Object.assign({},m.logContext)),(m.state===bt.Connecting||m.state===bt.Reconnecting||m.isResuming)&&(m.log.warn("abort connection attempt",m.logContext),(T=m.abortController)===null||T===void 0||T.abort(),(S=(x=m.connectFuture)===null||x===void 0?void 0:x.reject)===null||S===void 0||S.call(x,new Rt("Client initiated disconnect",pt.Cancelled)),m.connectFuture=void 0),!((M=m.engine)===null||M===void 0)&&M.client.isDisconnected||(yield m.engine.client.sendLeave()),m.engine&&(yield m.engine.close()),m.handleDisconnect(v,ti.CLIENT_INITIATED),m.engine=void 0}finally{N()}}()})},this.onPageLeave=()=>U(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>U(this,void 0,void 0,function*(){const l=[],d=ri();if(d&&d.os==="iOS"){const f="livekit-dummy-audio-el";let m=document.getElementById(f);if(!m){m=document.createElement("audio"),m.id=f,m.autoplay=!0,m.hidden=!0;const v=ep();v.enabled=!0;const T=new MediaStream([v]);m.srcObject=T,document.addEventListener("visibilitychange",()=>{m&&(m.srcObject=document.hidden?null:T,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(m),this.once(Te.Disconnected,()=>{m==null||m.remove(),m=null})}l.push(m)}this.remoteParticipants.forEach(f=>{f.audioTrackPublications.forEach(m=>{m.track&&m.track.attachedElements.forEach(v=>{l.push(v)})})});try{yield Promise.all([this.acquireAudioContext(),...l.map(f=>(f.muted=!1,f.play()))]),this.handleAudioPlaybackStarted()}catch(f){throw this.handleAudioPlaybackFailed(f),f}}),this.startVideo=()=>U(this,void 0,void 0,function*(){const l=[];for(const d of this.remoteParticipants.values())d.videoTrackPublications.forEach(f=>{var m;(m=f.track)===null||m===void 0||m.attachedElements.forEach(v=>{l.includes(v)||l.push(v)})});yield Promise.all(l.map(d=>d.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(d=>{d.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const l of this.remoteParticipants.values())this.handleParticipantDisconnected(l.identity,l);this.setAndEmitConnectionState(bt.Reconnecting)&&this.emit(Te.Reconnecting)},this.handleSignalRestarted=l=>U(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(l.serverRegion),Object.assign(Object.assign({},this.logContext),{region:l.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(l);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(d){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:d}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:l.serverRegion}))}catch{return}this.setAndEmitConnectionState(bt.Connected),this.emit(Te.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=l=>{l.forEach(d=>{var f;if(d.identity===this.localParticipant.identity){this.localParticipant.updateInfo(d);return}d.identity===""&&(d.identity=(f=this.sidToIdentity.get(d.sid))!==null&&f!==void 0?f:"");let m=this.remoteParticipants.get(d.identity);d.state===bp.DISCONNECTED?this.handleParticipantDisconnected(d.identity,m):m=this.getOrCreateParticipant(d.identity,d)})},this.handleActiveSpeakersUpdate=l=>{const d=[],f={};l.forEach(m=>{if(f[m.sid]=!0,m.sid===this.localParticipant.sid)this.localParticipant.audioLevel=m.level,this.localParticipant.setIsSpeaking(!0),d.push(this.localParticipant);else{const v=this.getRemoteParticipantBySid(m.sid);v&&(v.audioLevel=m.level,v.setIsSpeaking(!0),d.push(v))}}),f[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(m=>{f[m.sid]||(m.audioLevel=0,m.setIsSpeaking(!1))}),this.activeSpeakers=d,this.emitWhenConnected(Te.ActiveSpeakersChanged,d)},this.handleSpeakersChanged=l=>{const d=new Map;this.activeSpeakers.forEach(m=>{const v=this.remoteParticipants.get(m.identity);v&&v.sid!==m.sid||d.set(m.sid,m)}),l.forEach(m=>{let v=this.getRemoteParticipantBySid(m.sid);m.sid===this.localParticipant.sid&&(v=this.localParticipant),v&&(v.audioLevel=m.level,v.setIsSpeaking(m.active),m.active?d.set(m.sid,v):d.delete(m.sid))});const f=Array.from(d.values());f.sort((m,v)=>v.audioLevel-m.audioLevel),this.activeSpeakers=f,this.emitWhenConnected(Te.ActiveSpeakersChanged,f)},this.handleStreamStateUpdate=l=>{l.streamStates.forEach(d=>{const f=this.getRemoteParticipantBySid(d.participantSid);if(!f)return;const m=f.getTrackPublicationBySid(d.trackSid);if(!m||!m.track)return;const v=ve.streamStateFromProto(d.state);v!==m.track.streamState&&(m.track.streamState=v,f.emit(Ae.TrackStreamStateChanged,m,m.track.streamState),this.emitWhenConnected(Te.TrackStreamStateChanged,m,m.track.streamState,f))})},this.handleSubscriptionPermissionUpdate=l=>{const d=this.getRemoteParticipantBySid(l.participantSid);if(!d)return;const f=d.getTrackPublicationBySid(l.trackSid);f&&f.setAllowed(l.allowed)},this.handleSubscriptionError=l=>{const d=Array.from(this.remoteParticipants.values()).find(m=>m.trackPublications.has(l.trackSid));if(!d)return;const f=d.getTrackPublicationBySid(l.trackSid);f&&f.setSubscriptionError(l.err)},this.handleDataPacket=l=>{const d=this.remoteParticipants.get(l.participantIdentity);if(l.value.case==="user")this.handleUserPacket(d,l.value.value,l.kind);else if(l.value.case==="transcription")this.handleTranscription(d,l.value.value);else if(l.value.case==="sipDtmf")this.handleSipDtmf(d,l.value.value);else if(l.value.case==="chatMessage")this.handleChatMessage(d,l.value.value);else if(l.value.case==="metrics")this.handleMetrics(l.value.value,d);else if(l.value.case==="streamHeader")this.handleStreamHeader(l.value.value,l.participantIdentity);else if(l.value.case==="streamChunk")this.handleStreamChunk(l.value.value);else if(l.value.case==="streamTrailer")this.handleStreamTrailer(l.value.value);else if(l.value.case==="rpcRequest"){const f=l.value.value;this.handleIncomingRpcRequest(l.participantIdentity,f.id,f.method,f.payload,f.responseTimeoutMs,f.version)}},this.handleUserPacket=(l,d,f)=>{this.emit(Te.DataReceived,d.payload,l,f,d.topic),l==null||l.emit(Ae.DataReceived,d.payload,f)},this.handleSipDtmf=(l,d)=>{this.emit(Te.SipDTMFReceived,d,l),l==null||l.emit(Ae.SipDTMFReceived,d)},this.bufferedSegments=new Map,this.handleTranscription=(l,d)=>{const f=d.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(d.transcribedParticipantIdentity),m=f==null?void 0:f.trackPublications.get(d.trackId),v=m2(d,this.transcriptionReceivedTimes);m==null||m.emit(_e.TranscriptionReceived,v),f==null||f.emit(Ae.TranscriptionReceived,v,m),this.emit(Te.TranscriptionReceived,v,f,m)},this.handleChatMessage=(l,d)=>{const f=g2(d);this.emit(Te.ChatMessage,f,l)},this.handleMetrics=(l,d)=>{this.emit(Te.MetricsReceived,l,d)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Te.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=l=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:l})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Te.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Te.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Te.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>U(this,void 0,void 0,function*(){var l,d;const f=hn.getInstance().previousDevices,m=yield hn.getInstance().getDevices(void 0,!1),v=ri();if((v==null?void 0:v.name)==="Chrome"&&v.os!=="iOS")for(let x of m){const S=f.find(M=>M.deviceId===x.deviceId);S&&S.label!==""&&S.kind===x.kind&&S.label!==x.label&&this.getActiveDevice(x.kind)==="default"&&this.emit(Te.ActiveDeviceChanged,x.kind,x.deviceId)}const T=["audiooutput","audioinput","videoinput"];for(let x of T){const S=m.filter(N=>N.kind===x),M=this.getActiveDevice(x);if(M===((l=f.filter(N=>N.kind===x)[0])===null||l===void 0?void 0:l.deviceId)&&S.length>0&&((d=S[0])===null||d===void 0?void 0:d.deviceId)!==M){yield this.switchActiveDevice(x,S[0].deviceId);continue}x==="audioinput"&&!Pa()||x==="videoinput"||S.length>0&&!S.find(N=>N.deviceId===this.getActiveDevice(x))&&(yield this.switchActiveDevice(x,S[0].deviceId))}this.emit(Te.MediaDevicesChanged)}),this.handleRoomUpdate=l=>{const d=this.roomInfo;this.roomInfo=l,d&&d.metadata!==l.metadata&&this.emitWhenConnected(Te.RoomMetadataChanged,l.metadata),(d==null?void 0:d.activeRecording)!==l.activeRecording&&this.emitWhenConnected(Te.RecordingStatusChanged,l.activeRecording)},this.handleConnectionQualityUpdate=l=>{l.updates.forEach(d=>{if(d.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(d.quality);return}const f=this.getRemoteParticipantBySid(d.participantSid);f&&f.setConnectionQuality(d.quality)})},this.onLocalParticipantMetadataChanged=l=>{this.emit(Te.ParticipantMetadataChanged,l,this.localParticipant)},this.onLocalParticipantNameChanged=l=>{this.emit(Te.ParticipantNameChanged,l,this.localParticipant)},this.onLocalAttributesChanged=l=>{this.emit(Te.ParticipantAttributesChanged,l,this.localParticipant)},this.onLocalTrackMuted=l=>{this.emit(Te.TrackMuted,l,this.localParticipant)},this.onLocalTrackUnmuted=l=>{this.emit(Te.TrackUnmuted,l,this.localParticipant)},this.onTrackProcessorUpdate=l=>{var d;(d=l==null?void 0:l.onPublish)===null||d===void 0||d.call(l,this)},this.onLocalTrackPublished=l=>U(this,void 0,void 0,function*(){var d,f,m,v,T,x;(d=l.track)===null||d===void 0||d.on(_e.TrackProcessorUpdate,this.onTrackProcessorUpdate),(f=l.track)===null||f===void 0||f.on(_e.Restarted,this.onLocalTrackRestarted),(T=(v=(m=l.track)===null||m===void 0?void 0:m.getProcessor())===null||v===void 0?void 0:v.onPublish)===null||T===void 0||T.call(v,this),this.emit(Te.LocalTrackPublished,l,this.localParticipant),fo(l.track)&&(yield l.track.checkForSilence())&&this.emit(Te.LocalAudioSilenceDetected,l);const S=yield(x=l.track)===null||x===void 0?void 0:x.getDeviceId(!1),M=ob(l.source);M&&S&&S!==this.localParticipant.activeDeviceMap.get(M)&&(this.localParticipant.activeDeviceMap.set(M,S),this.emit(Te.ActiveDeviceChanged,M,S))}),this.onLocalTrackUnpublished=l=>{var d,f;(d=l.track)===null||d===void 0||d.off(_e.TrackProcessorUpdate,this.onTrackProcessorUpdate),(f=l.track)===null||f===void 0||f.off(_e.Restarted,this.onLocalTrackRestarted),this.emit(Te.LocalTrackUnpublished,l,this.localParticipant)},this.onLocalTrackRestarted=l=>U(this,void 0,void 0,function*(){const d=yield l.getDeviceId(!1),f=ob(l.source);f&&d&&d!==this.localParticipant.activeDeviceMap.get(f)&&(this.log.debug("local track restarted, setting ".concat(f," ").concat(d," active"),this.logContext),this.localParticipant.activeDeviceMap.set(f,d),this.emit(Te.ActiveDeviceChanged,f,d))}),this.onLocalConnectionQualityChanged=l=>{this.emit(Te.ConnectionQualityChanged,l,this.localParticipant)},this.onMediaDevicesError=l=>{this.emit(Te.MediaDevicesError,l)},this.onLocalParticipantPermissionsChanged=l=>{this.emit(Te.ParticipantPermissionsChanged,l,this.localParticipant)},this.onLocalChatMessageSent=l=>{this.emit(Te.ChatMessage,l,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},B2),e),this.log=$i((r=this.options.loggerName)!==null&&r!==void 0?r:ni.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},o1),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},s1),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},F2),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new mr,this.localParticipant=new fx("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",xa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",xa(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",xa(this.options.audioOutput.deviceId)).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),rr()){const l=new AbortController;(s=navigator.mediaDevices)===null||s===void 0||s.addEventListener("devicechange",this.handleDeviceChange,{signal:l.signal}),As.cleanupRegistry&&As.cleanupRegistry.register(this,()=>{l.abort()})}}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,t,r,o,s,l){return U(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),l!==1){yield this.engine.publishRpcResponse(e,t,null,Kt.builtIn("UNSUPPORTED_VERSION"));return}const d=this.rpcHandlers.get(r);if(!d){yield this.engine.publishRpcResponse(e,t,null,Kt.builtIn("UNSUPPORTED_METHOD"));return}let f=null,m=null;try{const v=yield d({requestId:t,callerIdentity:e,payload:o,responseTimeout:s});Df(v)>l1?(f=Kt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):m=v}catch(v){v instanceof Kt?f=v:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),v),f=Kt.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,m,f)})}setE2EEEnabled(e){return U(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new x2(this.options.e2ee),this.e2eeManager.on(Sa.ParticipantEncryptionStatusChanged,(t,r)=>{b2(r)&&(this.isE2EEEnabled=t),this.emit(Te.ParticipantEncryptionStatusChanged,t,r)}),this.e2eeManager.on(Sa.EncryptionError,t=>this.emit(Te.EncryptionError,t)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}getSid(){return U(this,void 0,void 0,function*(){return this.state===bt.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,t)=>{const r=o=>{o.sid!==""&&(this.engine.off(Me.RoomUpdate,r),e(o.sid))};this.engine.on(Me.RoomUpdate,r),this.once(Te.Disconnected,()=>{this.engine.off(Me.RoomUpdate,r),t("Room disconnected before room server id was available")})})})}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new tx(this.options),this.engine.on(Me.ParticipantUpdate,this.handleParticipantUpdates).on(Me.RoomUpdate,this.handleRoomUpdate).on(Me.SpeakersChanged,this.handleSpeakersChanged).on(Me.StreamStateChanged,this.handleStreamStateUpdate).on(Me.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Me.SubscriptionError,this.handleSubscriptionError).on(Me.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Me.MediaTrackAdded,(e,t,r)=>{this.onTrackAdded(e,t,r)}).on(Me.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Me.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Me.DataPacketReceived,this.handleDataPacket).on(Me.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(bt.SignalReconnecting)&&this.emit(Te.SignalReconnecting)}).on(Me.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(bt.Connected)&&this.emit(Te.Reconnected)}).on(Me.SignalResumed,()=>{this.bufferedEvents=[],(this.state===bt.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(Me.Restarting,this.handleRestarting).on(Me.SignalRestarted,this.handleSignalRestarted).on(Me.Offline,()=>{this.setAndEmitConnectionState(bt.Reconnecting)&&this.emit(Te.Reconnecting)}).on(Me.DCBufferStatusChanged,(e,t)=>{this.emit(Te.DCBufferStatusChanged,e,t)}).on(Me.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:o}=r;return o===e});if(!t){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(Ae.LocalTrackSubscribed,t),this.emitWhenConnected(Te.LocalTrackSubscribed,t,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return hn.getInstance().getDevices(e,t)}prepareConnection(e,t){return U(this,void 0,void 0,function*(){if(this.state===bt.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Vp(new URL(e))&&t){this.regionUrlProvider=new Zp(e,t);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===bt.Disconnected&&(this.regionUrl=r,yield fetch(Hp(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(Hp(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return U(this,void 0,void 0,function*(){let r=()=>{},o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new vi({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new vi({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new vi({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new vi({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>U(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new vi({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>U(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new vi({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new vi({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>U(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new md({reason:ti.CLIENT_INITIATED,action:xs.RECONNECT}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new vi({scenario:{case:"subscriberBandwidth",value:po(t)}});break;case"leave-full-reconnect":o=new vi({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return U(this,arguments,void 0,function(r,o){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var d,f,m,v,T,x,S,M;let N=!0,V=!1;const $=l?{exact:o}:o;if(r==="audioinput"){V=s.localParticipant.audioTrackPublications.size===0;const ae=(d=s.getActiveDevice(r))!==null&&d!==void 0?d:s.options.audioCaptureDefaults.deviceId;s.options.audioCaptureDefaults.deviceId=$;const z=Array.from(s.localParticipant.audioTrackPublications.values()).filter(A=>A.source===ve.Source.Microphone);try{N=(yield Promise.all(z.map(A=>{var F;return(F=A.audioTrack)===null||F===void 0?void 0:F.setDeviceId($)}))).every(A=>A===!0)}catch(A){throw s.options.audioCaptureDefaults.deviceId=ae,A}}else if(r==="videoinput"){V=s.localParticipant.videoTrackPublications.size===0;const ae=(f=s.getActiveDevice(r))!==null&&f!==void 0?f:s.options.videoCaptureDefaults.deviceId;s.options.videoCaptureDefaults.deviceId=$;const z=Array.from(s.localParticipant.videoTrackPublications.values()).filter(A=>A.source===ve.Source.Camera);try{N=(yield Promise.all(z.map(A=>{var F;return(F=A.videoTrack)===null||F===void 0?void 0:F.setDeviceId($)}))).every(A=>A===!0)}catch(A){throw s.options.videoCaptureDefaults.deviceId=ae,A}}else if(r==="audiooutput"){if(!zp()&&!s.options.webAudioMix||s.options.webAudioMix&&s.audioContext&&!("setSinkId"in s.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");s.options.webAudioMix&&(o=(m=yield hn.getInstance().normalizeDeviceId("audiooutput",o))!==null&&m!==void 0?m:""),(v=(M=s.options).audioOutput)!==null&&v!==void 0||(M.audioOutput={});const ae=(T=s.getActiveDevice(r))!==null&&T!==void 0?T:s.options.audioOutput.deviceId;s.options.audioOutput.deviceId=o;try{s.options.webAudioMix&&((x=s.audioContext)===null||x===void 0||x.setSinkId(o)),yield Promise.all(Array.from(s.remoteParticipants.values()).map(z=>z.setAudioOutput({deviceId:o})))}catch(z){throw s.options.audioOutput.deviceId=ae,z}}return(V||r==="audiooutput")&&(s.localParticipant.activeDeviceMap.set(r,r==="audiooutput"&&((S=s.options.audioOutput)===null||S===void 0?void 0:S.deviceId)||o),s.emit(Te.ActiveDeviceChanged,r,o)),N}()})}setupLocalParticipantEvents(){this.localParticipant.on(Ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Ae.AttributesChanged,this.onLocalAttributesChanged).on(Ae.TrackMuted,this.onLocalTrackMuted).on(Ae.TrackUnmuted,this.onLocalTrackUnmuted).on(Ae.LocalTrackPublished,this.onLocalTrackPublished).on(Ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Ae.MediaDevicesError,this.onMediaDevicesError).on(Ae.AudioStreamAcquired,this.startAudio).on(Ae.ChatMessage,this.onLocalChatMessageSent).on(Ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,r){if(this.state===bt.Connecting||this.state===bt.Reconnecting){const v=()=>{this.onTrackAdded(e,t,r),T()},T=()=>{this.off(Te.Reconnected,v),this.off(Te.Connected,v),this.off(Te.Disconnected,T)};this.once(Te.Reconnected,v),this.once(Te.Connected,v),this.once(Te.Disconnected,T);return}if(this.state===bt.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=a2(t.id),s=o[0];let l=o[1],d=e.id;if(l&&l.startsWith("TR")&&(d=l),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const f=Array.from(this.remoteParticipants.values()).find(v=>v.sid===s);if(!f){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}let m;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?m=this.options.adaptiveStream:m={}),f.addSubscribedMediaTrack(e,d,t,r,m)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==bt.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(o=>{o.trackPublications.forEach(s=>{o.unpublishTrack(s.trackSid)})}),this.localParticipant.trackPublications.forEach(o=>{var s,l,d;o.track&&this.localParticipant.unpublishTrack(o.track,e),e?((s=o.track)===null||s===void 0||s.detach(),(l=o.track)===null||l===void 0||l.stop()):(d=o.track)===null||d===void 0||d.stopMonitor()}),this.localParticipant.off(Ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Ae.AttributesChanged,this.onLocalAttributesChanged).off(Ae.TrackMuted,this.onLocalTrackMuted).off(Ae.TrackUnmuted,this.onLocalTrackUnmuted).off(Ae.LocalTrackPublished,this.onLocalTrackPublished).off(Ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Ae.MediaDevicesError,this.onMediaDevicesError).off(Ae.AudioStreamAcquired,this.startAudio).off(Ae.ChatMessage,this.onLocalChatMessageSent).off(Ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),rr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(bt.Disconnected),this.emit(Te.Disconnected,t)}}}handleParticipantDisconnected(e,t){var r;this.remoteParticipants.delete(e),t&&(t.trackPublications.forEach(o=>{t.unpublishTrack(o.trackSid,!0)}),this.emit(Te.ParticipantDisconnected,t),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(t.identity))}handleStreamHeader(e,t){return U(this,void 0,void 0,function*(){var r;if(e.contentHeader.case==="byteHeader"){const o=this.byteStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let s;const l={id:e.streamId,name:(r=e.contentHeader.value.name)!==null&&r!==void 0?r:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Bu(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:f=>{s=f,this.byteStreamControllers.set(e.streamId,{info:l,controller:s,startTime:Date.now()})}});o(new ax(l,d,Bu(e.totalLength)),{identity:t})}else if(e.contentHeader.case==="textHeader"){const o=this.textStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let s;const l={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:f=>{s=f,this.textStreamControllers.set(e.streamId,{info:l,controller:s,startTime:Date.now()})}});o(new ox(l,d,Bu(e.totalLength)),{identity:t})}})}handleStreamChunk(e){const t=this.byteStreamControllers.get(e.streamId);t&&e.content.length>0&&t.controller.enqueue(e);const r=this.textStreamControllers.get(e.streamId);r&&e.content.length>0&&r.controller.enqueue(e)}handleStreamTrailer(e){const t=this.textStreamControllers.get(e.streamId);t&&(t.info.attributes=Object.assign(Object.assign({},t.info.attributes),e.attributes),t.controller.close(),this.textStreamControllers.delete(e.streamId));const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.byteStreamControllers.delete(e.streamId))}acquireAudioContext(){return U(this,void 0,void 0,function*(){var e,t;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=i1())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),ir(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const r=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(Te.AudioPlaybackStatusChanged,r))})}createParticipant(e,t){var r;let o;return t?o=ad.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new ad(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),o}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return t&&o.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),o}const r=this.createParticipant(e,t);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(Te.ParticipantConnected,r),r.on(Ae.TrackPublished,o=>{this.emitWhenConnected(Te.TrackPublished,o,r)}).on(Ae.TrackSubscribed,(o,s)=>{o.kind===ve.Kind.Audio?(o.on(_e.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on(_e.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===ve.Kind.Video&&(o.on(_e.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on(_e.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Te.TrackSubscribed,o,s,r)}).on(Ae.TrackUnpublished,o=>{this.emit(Te.TrackUnpublished,o,r)}).on(Ae.TrackUnsubscribed,(o,s)=>{this.emit(Te.TrackUnsubscribed,o,s,r)}).on(Ae.TrackMuted,o=>{this.emitWhenConnected(Te.TrackMuted,o,r)}).on(Ae.TrackUnmuted,o=>{this.emitWhenConnected(Te.TrackUnmuted,o,r)}).on(Ae.ParticipantMetadataChanged,o=>{this.emitWhenConnected(Te.ParticipantMetadataChanged,o,r)}).on(Ae.ParticipantNameChanged,o=>{this.emitWhenConnected(Te.ParticipantNameChanged,o,r)}).on(Ae.AttributesChanged,o=>{this.emitWhenConnected(Te.ParticipantAttributesChanged,o,r)}).on(Ae.ConnectionQualityChanged,o=>{this.emitWhenConnected(Te.ConnectionQualityChanged,o,r)}).on(Ae.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(Te.ParticipantPermissionsChanged,o,r)}).on(Ae.TrackSubscriptionStatusChanged,(o,s)=>{this.emitWhenConnected(Te.TrackSubscriptionStatusChanged,o,s,r)}).on(Ae.TrackSubscriptionFailed,(o,s)=>{this.emit(Te.TrackSubscriptionFailed,o,r,s)}).on(Ae.TrackSubscriptionPermissionChanged,(o,s)=>{this.emitWhenConnected(Te.TrackSubscriptionPermissionChanged,o,s,r)}),t&&r.updateInfo(t),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,o)=>(r.push(...o.getTrackPublications()),r),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&v2(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Sn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ti.STATE_MISMATCH))):e=0},gx)}clearConnectionReconcile(){this.connectionReconcileInterval&&Sn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(Te.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,r]=e;this.emit(t,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];if(this.state===bt.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===bt.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return U(this,void 0,void 0,function*(){var t,r;const o=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Sf({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ut.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Xl({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Te.SignalConnected),this.emit(Te.Connected),this.setAndEmitConnectionState(bt.Connected),o.video){const l=new Xp(ve.Kind.Video,new ws({source:tn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Yr.AUDIO,name:"video-dummy"}),new id(o.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:ib(160*((t=s.aspectRatios[0])!==null&&t!==void 0?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Ae.LocalTrackPublished,l)}if(o.audio){const l=new Xp(ve.Kind.Audio,new ws({source:tn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Yr.AUDIO}),new nd(o.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:ep(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Ae.LocalTrackPublished,l)}for(let l=0;l<s.count-1;l+=1){let d=new Xl({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(l),state:bp.ACTIVE,tracks:[],joinedAt:Ut.parse(Date.now())});const f=this.getOrCreateParticipant(d.identity,d);if(s.video){const m=ib(160*((r=s.aspectRatios[l%s.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),v=new ws({source:tn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Yr.AUDIO});f.addSubscribedMediaTrack(m,v.sid,new MediaStream([m]),new RTCRtpReceiver),d.tracks=[...d.tracks,v]}if(s.audio){const m=ep(),v=new ws({source:tn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Yr.AUDIO});f.addSubscribedMediaTrack(m,v.sid,new MediaStream([m]),new RTCRtpReceiver),d.tracks=[...d.tracks,v]}f.updateInfo(d)}})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];if(e!==Te.ActiveSpeakersChanged&&e!==Te.TranscriptionReceived){const s=m1(r).filter(l=>l!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s}))}return super.emit(e,...r)}}As.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(n=>{n()});function m1(n){return n.map(e=>{if(e)return Array.isArray(e)?m1(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var Xr;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(Xr||(Xr={}));class Ra extends Si.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Xr.IDLE,this.logs=[],this.options={},this.url=e,this.token=t,this.name=this.constructor.name,this.room=new As(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return U(this,void 0,void 0,function*(){if(this.status!==Xr.IDLE)throw Error("check is running already");this.setStatus(Xr.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==Xr.SKIPPED&&this.setStatus(this.isSuccess()?Xr.SUCCESS:Xr.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return U(this,void 0,void 0,function*(){return this.room.state===bt.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return U(this,void 0,void 0,function*(){this.room&&this.room.state!==bt.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Xr.SKIPPED)}switchProtocol(e){return U(this,void 0,void 0,function*(){let t=!1,r=!1;if(this.room.on(Te.Reconnecting,()=>{t=!0}),this.room.once(Te.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(s=>setTimeout(s,1e3)),!t)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(r)return;yield ir(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class vx extends Ra{get description(){return"Cloud regions"}perform(){return U(this,void 0,void 0,function*(){const e=new Zp(this.url,this.token);if(!e.isCloud()){this.skip();return}const t=[],r=new Set;for(let s=0;s<3;s++){const l=yield e.getNextBestRegionUrl();if(!l)break;if(r.has(l))continue;r.add(l);const d=yield this.checkCloudRegion(l);this.appendMessage("".concat(d.region," RTT: ").concat(d.rtt,"ms, duration: ").concat(d.duration,"ms")),t.push(d)}t.sort((s,l)=>(s.duration-l.duration)*.5+(s.rtt-l.rtt)*.5);const o=t[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return U(this,void 0,void 0,function*(){var t,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(t=this.room.serverInfo)===null||t===void 0?void 0:t.region;if(!o)throw new Error("Region not found");const s=yield this.room.localParticipant.streamText({topic:"test"}),l=1e3,d=1e6/l,f="A".repeat(l),m=Date.now();for(let S=0;S<d;S++)yield s.write(f);yield s.close();const v=Date.now(),T=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),x={region:o,rtt:1e4,duration:v-m};return T==null||T.forEach(S=>{S.type==="candidate-pair"&&S.nominated&&(x.rtt=S.currentRoundTripTime*1e3)}),yield this.disconnect(),x})}}const lp=1e4;class bx extends Ra{get description(){return"Connection via UDP vs TCP"}perform(){return U(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),t=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-t.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-t.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=t):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(lp/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(lp/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return U(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const t=document.createElement("canvas");t.width=1280,t.height=720;const r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context");let o=0;const s=()=>{o=(o+1)%360,r.fillStyle="hsl(".concat(o,", 100%, 50%)"),r.fillRect(0,0,t.width,t.height),requestAnimationFrame(s)};s();const l=t.captureStream(30).getVideoTracks()[0],d=(yield this.room.localParticipant.publishTrack(l,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,f={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},m=setInterval(()=>U(this,void 0,void 0,function*(){const v=yield d.getRTCStatsReport();v==null||v.forEach(T=>{T.type==="outbound-rtp"?(f.packetsSent=T.packetsSent,f.qualityLimitationDurations=T.qualityLimitationDurations,f.bitrateTotal+=T.targetBitrate,f.count++):T.type==="remote-inbound-rtp"&&(f.packetsLost=T.packetsLost,f.rttTotal+=T.roundTripTime,f.jitterTotal+=T.jitter)})}),1e3);return yield new Promise(v=>setTimeout(v,lp)),clearInterval(m),l.stop(),t.remove(),yield this.disconnect(),f})}}function g1(n){return U(this,void 0,void 0,function*(){var e,t;n??(n={}),(e=n.audio)!==null&&e!==void 0||(n.audio={deviceId:"default"}),(t=n.video)!==null&&t!==void 0||(n.video={deviceId:"default"});const{audioProcessor:r,videoProcessor:o}=Mf(n),s=n1(n,o1,s1),l=vd(s),d=navigator.mediaDevices.getUserMedia(l);n.audio&&(hn.userMediaPromiseMap.set("audioinput",d),d.catch(()=>hn.userMediaPromiseMap.delete("audioinput"))),n.video&&(hn.userMediaPromiseMap.set("videoinput",d),d.catch(()=>hn.userMediaPromiseMap.delete("videoinput")));const f=yield d;return Promise.all(f.getTracks().map(m=>U(this,void 0,void 0,function*(){const v=m.kind==="audio";v?s.audio:s.video;let T;const x=v?l.audio:l.video;typeof x!="boolean"&&(T=x);const S=m.getSettings().deviceId;T!=null&&T.deviceId&&xa(T.deviceId)!==S?T.deviceId=S:T||(T={deviceId:S});const M=u1(m,T);return M.kind===ve.Kind.Video?M.source=ve.Source.Camera:M.kind===ve.Kind.Audio&&(M.source=ve.Source.Microphone),M.mediaStream=f,Wi(M)&&r?yield M.setProcessor(r):Ns(M)&&o&&(yield M.setProcessor(o)),M})))})}function yx(n){return U(this,void 0,void 0,function*(){return(yield g1({audio:!1,video:n}))[0]})}function wx(n){return U(this,void 0,void 0,function*(){return(yield g1({audio:n,video:!1}))[0]})}class kx extends Ra{get description(){return"Can publish audio"}perform(){return U(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield wx();if(yield r1(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),t.localParticipant.publishTrack(r),yield new Promise(l=>setTimeout(l,3e3));const o=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let s=0;if(o.forEach(l=>{l.type==="outbound-rtp"&&(l.kind==="audio"||!l.kind&&l.mediaType==="audio")&&(s=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class Cx extends Ra{get description(){return"Can publish video"}perform(){return U(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield yx();yield this.checkForVideo(r.mediaStreamTrack),t.localParticipant.publishTrack(r),yield new Promise(l=>setTimeout(l,5e3));const o=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let s=0;if(o.forEach(l=>{l.type==="outbound-rtp"&&(l.kind==="video"||!l.kind&&l.mediaType==="video")&&(s+=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}checkForVideo(e){return U(this,void 0,void 0,function*(){const t=new MediaStream;t.addTrack(e.clone());const r=document.createElement("video");r.srcObject=t,r.muted=!0,yield new Promise(o=>{r.onplay=()=>{setTimeout(()=>{var s,l,d,f;const m=document.createElement("canvas"),v=e.getSettings(),T=(l=(s=v.width)!==null&&s!==void 0?s:r.videoWidth)!==null&&l!==void 0?l:1280,x=(f=(d=v.height)!==null&&d!==void 0?d:r.videoHeight)!==null&&f!==void 0?f:720;m.width=T,m.height=x;const S=m.getContext("2d");S.drawImage(r,0,0);const M=S.getImageData(0,0,m.width,m.height).data;let N=!0;for(let V=0;V<M.length;V+=4)if(M[V]!==0||M[V+1]!==0||M[V+2]!==0){N=!1;break}N?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},r.play()}),r.remove()})}}class Sx extends Ra{get description(){return"Resuming connection after interruption"}perform(){return U(this,void 0,void 0,function*(){var e;const t=yield this.connect();let r=!1,o=!1,s;const l=new Promise(m=>{setTimeout(m,5e3),s=m}),d=()=>{r=!0};t.on(Te.SignalReconnecting,d).on(Te.Reconnecting,d).on(Te.Reconnected,()=>{o=!0,s(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const f=t.engine.client.onClose;if(f&&f(""),yield l,r){if(!o||t.state!==bt.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Tx extends Ra{get description(){return"Can connect via TURN"}perform(){return U(this,void 0,void 0,function*(){var e,t;const r=new Af,o=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,l=!1,d=!1;for(let f of o.iceServers)for(let m of f.urls)m.startsWith("turn:")?(l=!0,d=!0):m.startsWith("turns:")&&(l=!0,d=!0,s=!0),m.startsWith("stun:")&&(d=!0);d?l&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((t=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||t===void 0)&&t.iceServers||l?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(f=>setTimeout(f,0)))})}}class xx extends Ra{get description(){return"Establishing WebRTC connection"}perform(){return U(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(Te.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(o,s)=>{if(o.candidate){const l=new RTCIceCandidate(o);let d="".concat(l.protocol," ").concat(l.address,":").concat(l.port," ").concat(l.type);l.address&&(Ex(l.address)?d+=" (private)":l.protocol==="tcp"&&l.tcpType==="passive"?(e=!0,d+=" (passive)"):l.protocol==="udp"&&(t=!0)),this.appendMessage(d)}r&&r(o,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=o=>{o instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(o.errorCode," ").concat(o.errorText," ").concat(o.url))})});try{yield this.connect(),ht.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Ex(n){const e=n.split(".");if(e.length===4){if(e[0]==="10"||e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class Px extends Ra{get description(){return"Connecting to signal connection via WebSocket"}perform(){return U(this,void 0,void 0,function*(){var e,t,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new Af;const s=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===i0.Cloud&&!((t=s.serverInfo)===null||t===void 0)&&t.region&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield o.close()})}}class T_ extends Si.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=t,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Xr.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Xr.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return U(this,void 0,void 0,function*(){const t=this.getNextCheckId(),r=new e(this.url,this.token,this.options),o=l=>{this.updateCheck(t,l)};r.on("update",o);const s=yield r.run();return r.off("update",o),s})}checkWebsocket(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(Px)})}checkWebRTC(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(xx)})}checkTURN(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(Tx)})}checkReconnect(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(Sx)})}checkPublishAudio(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(kx)})}checkPublishVideo(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(Cx)})}checkConnectionProtocol(){return U(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(bx);if(e.data&&"protocol"in e.data){const t=e.data;this.options.protocol=t.protocol}return e})}checkCloudRegion(){return U(this,void 0,void 0,function*(){return this.createAndRunCheck(vx)})}}PT("error");const _x=n=>{const e=new TextDecoder().decode(n);if(e!==null&&typeof e=="object")return e;try{const t=JSON.parse(e);if(t===null||typeof t!="object")throw new Error("Invalid parsed");return t}catch{return null}},v1=({handler:n,context:e,speakersEnabled:t,micEnabled:r})=>{const[o,s]=Se.useState("pending"),[l,d]=wv(!1,100),[f,m]=wv(!1,100),[v,T]=Se.useState([]),x=Se.useRef(null),S=Se.useRef(null),M=Se.useRef(null),[N,V]=Se.useState(null),$=Se.useCallback(async()=>{const A=x.current;A!=null&&(S.current!=null&&(S.current.stop(),S.current=null),M.current!=null&&(M.current.getTracks().forEach(F=>{F.stop()}),M.current=null),V(null),x.current=null,T([]),n.setRequestOverride(void 0),await A.disconnect())},[T,V,n]);Se.useEffect(()=>{const A=x.current;A!=null&&A.localParticipant.setMicrophoneEnabled(r)},[r]),Se.useEffect(()=>{if(N==null)return;const A=t?1:0;N.volume=A},[N,t]);const ae=Se.useCallback(async()=>{s("pending");let A=null;try{A=await n.getVoiceCredentials(e)}catch{s("error");return}if(A==null)return;const F=te=>{const K=te.some(Y=>Y.isAgent),ne=te.some(Y=>Y.isLocal);m(K),d(ne)},J=te=>{if(te.kind===ve.Kind.Audio){S.current=te;const K=te.attach();V(K),K.play()}},de=te=>{d(te)};try{const te=new As;x.current=te,M.current=await navigator.mediaDevices.getUserMedia({audio:!0}),te.on(Te.TrackSubscribed,J),te.on(Te.ActiveSpeakersChanged,F),te.localParticipant.on(Ae.IsSpeakingChanged,de),te.on(Te.MediaDevicesError,()=>{console.info("media devices error")}),te.on(Te.Disconnected,()=>{s("terminated"),d(!1),m(!1),$()}),n.setRequestOverride(K=>{const ne=new TextEncoder().encode(JSON.stringify(K.request));te.localParticipant.publishData(ne).catch(Y=>{console.error("Failed to publish data to LiveKit:",Y)})}),te.on(Te.DataReceived,(K,ne)=>{T(Y=>[...Y,{modalities:_x(K)??{},from:ne==null?void 0:ne.identity,timestamp:Date.now()}])}),await te.connect(A.url,A.token,{autoSubscribe:!0}),await te.localParticipant.setMicrophoneEnabled(!0),te.startAudio(),s("active")}catch(te){te instanceof DOMException&&te.name==="NotAllowedError"?s("noAudioPermissions"):s("error")}},[n,e,s,m,V,T,$,d]),z=async()=>{await $(),ae()};return Se.useEffect(()=>(ae(),()=>{$()}),[ae,$]),{roomState:o,isUserSpeaking:l,isApplicationSpeaking:f,retry:z,modalities:v}},Tu=({className:n,children:e})=>R.jsx("div",{className:ot("relative flex flex-col items-center justify-center",n),children:e}),b1=({className:n,modalities:e,customModalities:t,handler:r})=>{const o=Se.useRef(null),s=e.map(l=>{const d=Object.entries(l.modalities).map(([f,m])=>{const v=t[f];return v==null?null:{key:f,value:m,Component:v}}).filter(f=>f!=null);return d.length===0?null:R.jsx("div",{className:"space-y-2 last:h-full",children:d.map(({key:f,value:m,Component:v})=>R.jsx(v,{className:"backdrop-blur-overlay",data:m,conversationHandler:r,enabled:!0},f))},l.timestamp)}).filter(Boolean);return Se.useEffect(()=>{const l=o.current;if(l==null)return;const d=l.lastChild;d instanceof HTMLElement&&d.scrollIntoView({behavior:"smooth"})},[s.length]),s.length===0?null:R.jsx("div",{className:n,ref:o,children:s})},Rx=({handler:n,speakersEnabled:e,colorMode:t,brandIcon:r,className:o,context:s,customModalities:l={}})=>{const[d,f]=Se.useState(!0),{roomState:m,isUserSpeaking:v,isApplicationSpeaking:T,retry:x,modalities:S}=v1({micEnabled:d,speakersEnabled:e,handler:n,context:s});return m==="pending"?R.jsx(Tu,{className:o,children:R.jsx(Iy,{})}):m==="error"||m==="noAudioPermissions"?R.jsxs(Tu,{className:o,children:[R.jsx(Ry,{}),R.jsx("div",{className:"w-full px-3 h-20 flex items-center",children:R.jsx(ko,{type:"ghost",label:"Retry",Icon:Kl,onClick:()=>{x()}})})]}):m==="terminated"?R.jsx(Tu,{className:o,children:R.jsxs("div",{className:ot("flex-grow flex flex-col items-center justify-center gap-6 text-primary-80"),children:[R.jsx(Wl,{className:"w-20 h-20 text-primary-20"}),R.jsxs("div",{className:"text-center",children:[R.jsx("h3",{className:"text-xl mb-2",children:"The conversation has ended"}),R.jsx("p",{children:"You can close this panel now or restart."})]})]})}):R.jsxs(Tu,{className:o,children:[R.jsxs("div",{className:"rounded-full w-fit relative",children:[R.jsx("div",{className:ot("w-[128px] h-[128px] p-4 z-10 relative rounded-full overflow-hidden bg-cover bg-center",r!=null?"":t==="dark"?"bg-[rgb(40,41,47)]":"bg-[rgb(175,175,175)]"),style:r!=null?{backgroundImage:`url(${r})`}:{},children:r==null?R.jsx(Wl,{className:"w-full h-full text-primary-40"}):null}),T?R.jsx(Zl,{className:"rounded-full"}):null]}),R.jsx(b1,{className:"absolute p-4 top-0 left-0 right-0 bottom-[72px] z-10 space-y-2 max-h-full overflow-auto border-b border-primary-10",modalities:S,customModalities:l,handler:n}),R.jsxs("div",{className:"w-fit flex-none absolute bottom-4 left-1/2 transform -translate-x-1/2",children:[v?R.jsx(Zl,{className:"rounded-inner"}):null,R.jsx(Cn,{Icon:d?Ku:bf,label:"Voice",type:d?"activated":"ghost",onClick:()=>{f(M=>!M)}})]})]})},Sb=({onClose:n,handler:e,reset:t,className:r})=>R.jsxs("div",{className:ot("p-2 md:p-3 flex flex-col flex-grow justify-center gap-2",r),children:[R.jsx(ko,{label:"Restart conversation",Icon:Kl,type:"ghost",onClick:t}),R.jsx(ko,{label:"Talk to an agent",Icon:my,type:"ghost",onClick:()=>{e.sendIntent("NLX.Escalation"),n()}})]});function Ff(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Eo=Ff();function y1(n){Eo=n}const zl={exec:()=>null};function Pt(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(o,s)=>{let l=typeof s=="string"?s:s.source;return l=l.replace(qn.caret,"$1"),t=t.replace(o,l),r},getRegex:()=>new RegExp(t,e)};return r}const qn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},Ix=/^(?:[ \t]*(?:\n|$))+/,Ox=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Mx=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ic=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ax=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,w1=/(?:[*+-]|\d{1,9}[.)])/,k1=Pt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,w1).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Bf=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Lx=/^[^\n]+/,zf=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Nx=Pt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",zf).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),jx=Pt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,w1).getRegex(),yd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Vf=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Dx=Pt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Vf).replace("tag",yd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),C1=Pt(Bf).replace("hr",ic).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yd).getRegex(),Ux=Pt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",C1).getRegex(),Hf={blockquote:Ux,code:Ox,def:Nx,fences:Mx,heading:Ax,hr:ic,html:Dx,lheading:k1,list:jx,newline:Ix,paragraph:C1,table:zl,text:Lx},Tb=Pt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ic).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yd).getRegex(),Fx={...Hf,table:Tb,paragraph:Pt(Bf).replace("hr",ic).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Tb).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",yd).getRegex()},Bx={...Hf,html:Pt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Vf).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:zl,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Pt(Bf).replace("hr",ic).replace("heading",` *#{1,6} *[^
]`).replace("lheading",k1).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},zx=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Vx=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,S1=/^( {2,}|\\)\n(?!\s*$)/,Hx=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,wd=/[\p{P}\p{S}]/u,qf=/[\s\p{P}\p{S}]/u,T1=/[^\s\p{P}\p{S}]/u,qx=Pt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,qf).getRegex(),$x=/(?!~)[\p{P}\p{S}]/u,Wx=/(?!~)[\s\p{P}\p{S}]/u,Gx=/(?:[^\s\p{P}\p{S}]|~)/u,Kx=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Zx=Pt(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,wd).getRegex(),x1="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Qx=Pt(x1,"gu").replace(/notPunctSpace/g,T1).replace(/punctSpace/g,qf).replace(/punct/g,wd).getRegex(),Xx=Pt(x1,"gu").replace(/notPunctSpace/g,Gx).replace(/punctSpace/g,Wx).replace(/punct/g,$x).getRegex(),Jx=Pt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,T1).replace(/punctSpace/g,qf).replace(/punct/g,wd).getRegex(),Yx=Pt(/\\(punct)/,"gu").replace(/punct/g,wd).getRegex(),eE=Pt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),tE=Pt(Vf).replace("(?:-->|$)","-->").getRegex(),nE=Pt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",tE).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),od=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,rE=Pt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",od).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),E1=Pt(/^!?\[(label)\]\[(ref)\]/).replace("label",od).replace("ref",zf).getRegex(),P1=Pt(/^!?\[(ref)\](?:\[\])?/).replace("ref",zf).getRegex(),iE=Pt("reflink|nolink(?!\\()","g").replace("reflink",E1).replace("nolink",P1).getRegex(),$f={_backpedal:zl,anyPunctuation:Yx,autolink:eE,blockSkip:Kx,br:S1,code:Vx,del:zl,emStrongLDelim:Zx,emStrongRDelimAst:Qx,emStrongRDelimUnd:Jx,escape:zx,link:rE,nolink:P1,punctuation:qx,reflink:E1,reflinkSearch:iE,tag:nE,text:Hx,url:zl},aE={...$f,link:Pt(/^!?\[(label)\]\((.*?)\)/).replace("label",od).getRegex(),reflink:Pt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",od).getRegex()},Jp={...$f,emStrongRDelimAst:Xx,url:Pt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},oE={...Jp,br:Pt(S1).replace("{2,}","*").getRegex(),text:Pt(Jp.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},xu={normal:Hf,gfm:Fx,pedantic:Bx},Al={normal:$f,gfm:Jp,breaks:oE,pedantic:aE},sE={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},xb=n=>sE[n];function bi(n,e){if(e){if(qn.escapeTest.test(n))return n.replace(qn.escapeReplace,xb)}else if(qn.escapeTestNoEncode.test(n))return n.replace(qn.escapeReplaceNoEncode,xb);return n}function Eb(n){try{n=encodeURI(n).replace(qn.percentDecode,"%")}catch{return null}return n}function Pb(n,e){var t;const r=n.replace(qn.findPipe,(l,d,f)=>{let m=!1,v=d;for(;--v>=0&&f[v]==="\\";)m=!m;return m?"|":" |"}),o=r.split(qn.splitPipe);let s=0;if(o[0].trim()||o.shift(),o.length>0&&!((t=o.at(-1))!=null&&t.trim())&&o.pop(),e)if(o.length>e)o.splice(e);else for(;o.length<e;)o.push("");for(;s<o.length;s++)o[s]=o[s].trim().replace(qn.slashPipe,"|");return o}function Ll(n,e,t){const r=n.length;if(r===0)return"";let o=0;for(;o<r&&n.charAt(r-o-1)===e;)o++;return n.slice(0,r-o)}function lE(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function _b(n,e,t,r,o){const s=e.href,l=e.title||null,d=n[1].replace(o.other.outputLinkReplace,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const f={type:"link",raw:t,href:s,title:l,text:d,tokens:r.inlineTokens(d)};return r.state.inLink=!1,f}return{type:"image",raw:t,href:s,title:l,text:d}}function cE(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const o=r[1];return e.split(`
`).map(s=>{const l=s.match(t.other.beginningSpace);if(l===null)return s;const[d]=l;return d.length>=o.length?s.slice(o.length):s}).join(`
`)}class sd{constructor(e){yt(this,"options"),yt(this,"rules"),yt(this,"lexer"),this.options=e||Eo}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ll(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],o=cE(r,t[3]||"",this.rules);return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:o}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(this.rules.other.endingHash.test(r)){const o=Ll(r,"#");(this.options.pedantic||!o||this.rules.other.endingSpaceChar.test(o))&&(r=o.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Ll(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=Ll(t[0],`
`).split(`
`),o="",s="";const l=[];for(;r.length>0;){let d=!1;const f=[];let m;for(m=0;m<r.length;m++)if(this.rules.other.blockquoteStart.test(r[m]))f.push(r[m]),d=!0;else if(!d)f.push(r[m]);else break;r=r.slice(m);const v=f.join(`
`),T=v.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");o=o?`${o}
${v}`:v,s=s?`${s}
${T}`:T;const x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(T,l,!0),this.lexer.state.top=x,r.length===0)break;const S=l.at(-1);if((S==null?void 0:S.type)==="code")break;if((S==null?void 0:S.type)==="blockquote"){const M=S,N=M.raw+`
`+r.join(`
`),V=this.blockquote(N);l[l.length-1]=V,o=o.substring(0,o.length-M.raw.length)+V.raw,s=s.substring(0,s.length-M.text.length)+V.text;break}else if((S==null?void 0:S.type)==="list"){const M=S,N=M.raw+`
`+r.join(`
`),V=this.list(N);l[l.length-1]=V,o=o.substring(0,o.length-S.raw.length)+V.raw,s=s.substring(0,s.length-M.raw.length)+V.raw,r=N.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:o,tokens:l,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const o=r.length>1,s={type:"list",raw:"",ordered:o,start:o?+r.slice(0,-1):"",loose:!1,items:[]};r=o?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=o?r:"[*+-]");const l=this.rules.other.listItemRegex(r);let d=!1;for(;e;){let m=!1,v="",T="";if(!(t=l.exec(e))||this.rules.block.hr.test(e))break;v=t[0],e=e.substring(v.length);let x=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,ae=>" ".repeat(3*ae.length)),S=e.split(`
`,1)[0],M=!x.trim(),N=0;if(this.options.pedantic?(N=2,T=x.trimStart()):M?N=t[1].length+1:(N=t[2].search(this.rules.other.nonSpaceChar),N=N>4?1:N,T=x.slice(N),N+=t[1].length),M&&this.rules.other.blankLine.test(S)&&(v+=S+`
`,e=e.substring(S.length+1),m=!0),!m){const ae=this.rules.other.nextBulletRegex(N),z=this.rules.other.hrRegex(N),A=this.rules.other.fencesBeginRegex(N),F=this.rules.other.headingBeginRegex(N),J=this.rules.other.htmlBeginRegex(N);for(;e;){const de=e.split(`
`,1)[0];let te;if(S=de,this.options.pedantic?(S=S.replace(this.rules.other.listReplaceNesting,"  "),te=S):te=S.replace(this.rules.other.tabCharGlobal,"    "),A.test(S)||F.test(S)||J.test(S)||ae.test(S)||z.test(S))break;if(te.search(this.rules.other.nonSpaceChar)>=N||!S.trim())T+=`
`+te.slice(N);else{if(M||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||A.test(x)||F.test(x)||z.test(x))break;T+=`
`+S}!M&&!S.trim()&&(M=!0),v+=de+`
`,e=e.substring(de.length+1),x=te.slice(N)}}s.loose||(d?s.loose=!0:this.rules.other.doubleBlankLine.test(v)&&(d=!0));let V=null,$;this.options.gfm&&(V=this.rules.other.listIsTask.exec(T),V&&($=V[0]!=="[ ] ",T=T.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:v,task:!!V,checked:$,loose:!1,text:T,tokens:[]}),s.raw+=v}const f=s.items.at(-1);if(f)f.raw=f.raw.trimEnd(),f.text=f.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let m=0;m<s.items.length;m++)if(this.lexer.state.top=!1,s.items[m].tokens=this.lexer.blockTokens(s.items[m].text,[]),!s.loose){const v=s.items[m].tokens.filter(x=>x.type==="space"),T=v.length>0&&v.some(x=>this.rules.other.anyLine.test(x.raw));s.loose=T}if(s.loose)for(let m=0;m<s.items.length;m++)s.items[m].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),o=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:o,title:s}}}table(e){var t;const r=this.rules.block.table.exec(e);if(!r||!this.rules.other.tableDelimiter.test(r[2]))return;const o=Pb(r[1]),s=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),l=(t=r[3])!=null&&t.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],d={type:"table",raw:r[0],header:[],align:[],rows:[]};if(o.length===s.length){for(const f of s)this.rules.other.tableAlignRight.test(f)?d.align.push("right"):this.rules.other.tableAlignCenter.test(f)?d.align.push("center"):this.rules.other.tableAlignLeft.test(f)?d.align.push("left"):d.align.push(null);for(let f=0;f<o.length;f++)d.header.push({text:o[f],tokens:this.lexer.inline(o[f]),header:!0,align:d.align[f]});for(const f of l)d.rows.push(Pb(f,d.header.length).map((m,v)=>({text:m,tokens:this.lexer.inline(m),header:!1,align:d.align[v]})));return d}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const l=Ll(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{const l=lE(t[2],"()");if(l>-1){const d=(t[0].indexOf("!")===0?5:4)+t[1].length+l;t[2]=t[2].substring(0,l),t[0]=t[0].substring(0,d).trim(),t[3]=""}}let o=t[2],s="";if(this.options.pedantic){const l=this.rules.other.pedanticHrefTitle.exec(o);l&&(o=l[1],s=l[3])}else s=t[3]?t[3].slice(1,-1):"";return o=o.trim(),this.rules.other.startAngleBracket.test(o)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?o=o.slice(1):o=o.slice(1,-1)),_b(t,{href:o&&o.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const o=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[o.toLowerCase()];if(!s){const l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return _b(r,s,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let o=this.rules.inline.emStrongLDelim.exec(e);if(!(!o||o[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(o[1]||o[2])||!r||this.rules.inline.punctuation.exec(r))){const s=[...o[0]].length-1;let l,d,f=s,m=0;const v=o[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,t=t.slice(-1*e.length+s);(o=v.exec(t))!=null;){if(l=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!l)continue;if(d=[...l].length,o[3]||o[4]){f+=d;continue}else if((o[5]||o[6])&&s%3&&!((s+d)%3)){m+=d;continue}if(f-=d,f>0)continue;d=Math.min(d,d+f+m);const T=[...o[0]][0].length,x=e.slice(0,s+o.index+T+d);if(Math.min(s,d)%2){const M=x.slice(1,-1);return{type:"em",raw:x,text:M,tokens:this.lexer.inlineTokens(M)}}const S=x.slice(2,-2);return{type:"strong",raw:x,text:S,tokens:this.lexer.inlineTokens(S)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(this.rules.other.newLineCharGlobal," ");const o=this.rules.other.nonSpaceChar.test(r),s=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return o&&s&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,o;return t[2]==="@"?(r=t[1],o="mailto:"+r):(r=t[1],o=r),{type:"link",raw:t[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var t;let r;if(r=this.rules.inline.url.exec(e)){let o,s;if(r[2]==="@")o=r[0],s="mailto:"+o;else{let l;do l=r[0],r[0]=((t=this.rules.inline._backpedal.exec(r[0]))==null?void 0:t[0])??"";while(l!==r[0]);o=r[0],r[1]==="www."?s="http://"+r[0]:s=r[0]}return{type:"link",raw:r[0],text:o,href:s,tokens:[{type:"text",raw:o,text:o}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const r=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:r}}}}class Ar{constructor(e){yt(this,"tokens"),yt(this,"options"),yt(this,"state"),yt(this,"tokenizer"),yt(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Eo,this.options.tokenizer=this.options.tokenizer||new sd,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:qn,block:xu.normal,inline:Al.normal};this.options.pedantic?(t.block=xu.pedantic,t.inline=Al.pedantic):this.options.gfm&&(t.block=xu.gfm,this.options.breaks?t.inline=Al.breaks:t.inline=Al.gfm),this.tokenizer.rules=t}static get rules(){return{block:xu,inline:Al}}static lex(e,t){return new Ar(t).lex(e)}static lexInline(e,t){return new Ar(t).inlineTokens(e)}lex(e){e=e.replace(qn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){var o,s,l;for(this.options.pedantic&&(e=e.replace(qn.tabCharGlobal,"    ").replace(qn.spaceLine,""));e;){let d;if((s=(o=this.options.extensions)==null?void 0:o.block)!=null&&s.some(m=>(d=m.call({lexer:this},e,t))?(e=e.substring(d.raw.length),t.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);const m=t.at(-1);d.raw.length===1&&m!==void 0?m.raw+=`
`:t.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);const m=t.at(-1);(m==null?void 0:m.type)==="paragraph"||(m==null?void 0:m.type)==="text"?(m.raw+=`
`+d.raw,m.text+=`
`+d.text,this.inlineQueue.at(-1).src=m.text):t.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);const m=t.at(-1);(m==null?void 0:m.type)==="paragraph"||(m==null?void 0:m.type)==="text"?(m.raw+=`
`+d.raw,m.text+=`
`+d.raw,this.inlineQueue.at(-1).src=m.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title});continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),t.push(d);continue}let f=e;if((l=this.options.extensions)!=null&&l.startBlock){let m=1/0;const v=e.slice(1);let T;this.options.extensions.startBlock.forEach(x=>{T=x.call({lexer:this},v),typeof T=="number"&&T>=0&&(m=Math.min(m,T))}),m<1/0&&m>=0&&(f=e.substring(0,m+1))}if(this.state.top&&(d=this.tokenizer.paragraph(f))){const m=t.at(-1);r&&(m==null?void 0:m.type)==="paragraph"?(m.raw+=`
`+d.raw,m.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=m.text):t.push(d),r=f.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);const m=t.at(-1);(m==null?void 0:m.type)==="text"?(m.raw+=`
`+d.raw,m.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=m.text):t.push(d);continue}if(e){const m="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(m);break}else throw new Error(m)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var r,o,s;let l=e,d=null;if(this.tokens.links){const v=Object.keys(this.tokens.links);if(v.length>0)for(;(d=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)v.includes(d[0].slice(d[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,d.index)+"["+"a".repeat(d[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(d=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,d.index)+"["+"a".repeat(d[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(d=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,d.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let f=!1,m="";for(;e;){f||(m=""),f=!1;let v;if((o=(r=this.options.extensions)==null?void 0:r.inline)!=null&&o.some(x=>(v=x.call({lexer:this},e,t))?(e=e.substring(v.raw.length),t.push(v),!0):!1))continue;if(v=this.tokenizer.escape(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.tag(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.link(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(v.raw.length);const x=t.at(-1);v.type==="text"&&(x==null?void 0:x.type)==="text"?(x.raw+=v.raw,x.text+=v.text):t.push(v);continue}if(v=this.tokenizer.emStrong(e,l,m)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.codespan(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.br(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.del(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.autolink(e)){e=e.substring(v.raw.length),t.push(v);continue}if(!this.state.inLink&&(v=this.tokenizer.url(e))){e=e.substring(v.raw.length),t.push(v);continue}let T=e;if((s=this.options.extensions)!=null&&s.startInline){let x=1/0;const S=e.slice(1);let M;this.options.extensions.startInline.forEach(N=>{M=N.call({lexer:this},S),typeof M=="number"&&M>=0&&(x=Math.min(x,M))}),x<1/0&&x>=0&&(T=e.substring(0,x+1))}if(v=this.tokenizer.inlineText(T)){e=e.substring(v.raw.length),v.raw.slice(-1)!=="_"&&(m=v.raw.slice(-1)),f=!0;const x=t.at(-1);(x==null?void 0:x.type)==="text"?(x.raw+=v.raw,x.text+=v.text):t.push(v);continue}if(e){const x="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(x);break}else throw new Error(x)}}return t}}class ld{constructor(e){yt(this,"options"),yt(this,"parser"),this.options=e||Eo}space(e){return""}code({text:e,lang:t,escaped:r}){var o;const s=(o=(t||"").match(qn.notSpaceStart))==null?void 0:o[0],l=e.replace(qn.endingNewline,"")+`
`;return s?'<pre><code class="language-'+bi(s)+'">'+(r?l:bi(l,!0))+`</code></pre>
`:"<pre><code>"+(r?l:bi(l,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,r=e.start;let o="";for(let d=0;d<e.items.length;d++){const f=e.items[d];o+=this.listitem(f)}const s=t?"ol":"ul",l=t&&r!==1?' start="'+r+'"':"";return"<"+s+l+`>
`+o+"</"+s+`>
`}listitem(e){var t;let r="";if(e.task){const o=this.checkbox({checked:!!e.checked});e.loose?((t=e.tokens[0])==null?void 0:t.type)==="paragraph"?(e.tokens[0].text=o+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=o+" "+bi(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:o+" ",text:o+" ",escaped:!0}):r+=o+" "}return r+=this.parser.parse(e.tokens,!!e.loose),`<li>${r}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let s=0;s<e.header.length;s++)r+=this.tablecell(e.header[s]);t+=this.tablerow({text:r});let o="";for(let s=0;s<e.rows.length;s++){const l=e.rows[s];r="";for(let d=0;d<l.length;d++)r+=this.tablecell(l[d]);o+=this.tablerow({text:r})}return o&&(o=`<tbody>${o}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+o+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${bi(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){const o=this.parser.parseInline(r),s=Eb(e);if(s===null)return o;e=s;let l='<a href="'+e+'"';return t&&(l+=' title="'+bi(t)+'"'),l+=">"+o+"</a>",l}image({href:e,title:t,text:r}){const o=Eb(e);if(o===null)return bi(r);e=o;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${bi(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:bi(e.text)}}class Wf{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Lr{constructor(e){yt(this,"options"),yt(this,"renderer"),yt(this,"textRenderer"),this.options=e||Eo,this.options.renderer=this.options.renderer||new ld,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Wf}static parse(e,t){return new Lr(t).parse(e)}static parseInline(e,t){return new Lr(t).parseInline(e)}parse(e,t=!0){var r,o;let s="";for(let l=0;l<e.length;l++){const d=e[l];if((o=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&o[d.type]){const m=d,v=this.options.extensions.renderers[m.type].call({parser:this},m);if(v!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type)){s+=v||"";continue}}const f=d;switch(f.type){case"space":{s+=this.renderer.space(f);continue}case"hr":{s+=this.renderer.hr(f);continue}case"heading":{s+=this.renderer.heading(f);continue}case"code":{s+=this.renderer.code(f);continue}case"table":{s+=this.renderer.table(f);continue}case"blockquote":{s+=this.renderer.blockquote(f);continue}case"list":{s+=this.renderer.list(f);continue}case"html":{s+=this.renderer.html(f);continue}case"paragraph":{s+=this.renderer.paragraph(f);continue}case"text":{let m=f,v=this.renderer.text(m);for(;l+1<e.length&&e[l+1].type==="text";)m=e[++l],v+=`
`+this.renderer.text(m);t?s+=this.renderer.paragraph({type:"paragraph",raw:v,text:v,tokens:[{type:"text",raw:v,text:v,escaped:!0}]}):s+=v;continue}default:{const m='Token with "'+f.type+'" type was not found.';if(this.options.silent)return console.error(m),"";throw new Error(m)}}}return s}parseInline(e,t=this.renderer){var r,o;let s="";for(let l=0;l<e.length;l++){const d=e[l];if((o=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&o[d.type]){const m=this.options.extensions.renderers[d.type].call({parser:this},d);if(m!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){s+=m||"";continue}}const f=d;switch(f.type){case"escape":{s+=t.text(f);break}case"html":{s+=t.html(f);break}case"link":{s+=t.link(f);break}case"image":{s+=t.image(f);break}case"strong":{s+=t.strong(f);break}case"em":{s+=t.em(f);break}case"codespan":{s+=t.codespan(f);break}case"br":{s+=t.br(f);break}case"del":{s+=t.del(f);break}case"text":{s+=t.text(f);break}default:{const m='Token with "'+f.type+'" type was not found.';if(this.options.silent)return console.error(m),"";throw new Error(m)}}}return s}}class Vl{constructor(e){yt(this,"options"),yt(this,"block"),this.options=e||Eo}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Ar.lex:Ar.lexInline}provideParser(){return this.block?Lr.parse:Lr.parseInline}}yt(Vl,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class uE{constructor(...e){yt(this,"defaults",Ff()),yt(this,"options",this.setOptions),yt(this,"parse",this.parseMarkdown(!0)),yt(this,"parseInline",this.parseMarkdown(!1)),yt(this,"Parser",Lr),yt(this,"Renderer",ld),yt(this,"TextRenderer",Wf),yt(this,"Lexer",Ar),yt(this,"Tokenizer",sd),yt(this,"Hooks",Vl),this.use(...e)}walkTokens(e,t){var r,o;let s=[];for(const l of e)switch(s=s.concat(t.call(this,l)),l.type){case"table":{const d=l;for(const f of d.header)s=s.concat(this.walkTokens(f.tokens,t));for(const f of d.rows)for(const m of f)s=s.concat(this.walkTokens(m.tokens,t));break}case"list":{const d=l;s=s.concat(this.walkTokens(d.items,t));break}default:{const d=l;(o=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&o[d.type]?this.defaults.extensions.childTokens[d.type].forEach(f=>{const m=d[f].flat(1/0);s=s.concat(this.walkTokens(m,t))}):d.tokens&&(s=s.concat(this.walkTokens(d.tokens,t)))}}return s}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const o={...r};if(o.async=this.defaults.async||o.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const l=t.renderers[s.name];l?t.renderers[s.name]=function(...d){let f=s.renderer.apply(this,d);return f===!1&&(f=l.apply(this,d)),f}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const l=t[s.level];l?l.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),o.extensions=t),r.renderer){const s=this.defaults.renderer||new ld(this.defaults);for(const l in r.renderer){if(!(l in s))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;const d=l,f=r.renderer[d],m=s[d];s[d]=(...v)=>{let T=f.apply(s,v);return T===!1&&(T=m.apply(s,v)),T||""}}o.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new sd(this.defaults);for(const l in r.tokenizer){if(!(l in s))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;const d=l,f=r.tokenizer[d],m=s[d];s[d]=(...v)=>{let T=f.apply(s,v);return T===!1&&(T=m.apply(s,v)),T}}o.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new Vl;for(const l in r.hooks){if(!(l in s))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;const d=l,f=r.hooks[d],m=s[d];Vl.passThroughHooks.has(l)?s[d]=v=>{if(this.defaults.async)return Promise.resolve(f.call(s,v)).then(x=>m.call(s,x));const T=f.call(s,v);return m.call(s,T)}:s[d]=(...v)=>{let T=f.apply(s,v);return T===!1&&(T=m.apply(s,v)),T}}o.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,l=r.walkTokens;o.walkTokens=function(d){let f=[];return f.push(l.call(this,d)),s&&(f=f.concat(s.call(this,d))),f}}this.defaults={...this.defaults,...o}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ar.lex(e,t??this.defaults)}parser(e,t){return Lr.parse(e,t??this.defaults)}parseMarkdown(e){return(t,r)=>{const o={...r},s={...this.defaults,...o},l=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&o.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const d=s.hooks?s.hooks.provideLexer():e?Ar.lex:Ar.lexInline,f=s.hooks?s.hooks.provideParser():e?Lr.parse:Lr.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then(m=>d(m,s)).then(m=>s.hooks?s.hooks.processAllTokens(m):m).then(m=>s.walkTokens?Promise.all(this.walkTokens(m,s.walkTokens)).then(()=>m):m).then(m=>f(m,s)).then(m=>s.hooks?s.hooks.postprocess(m):m).catch(l);try{s.hooks&&(t=s.hooks.preprocess(t));let m=d(t,s);s.hooks&&(m=s.hooks.processAllTokens(m)),s.walkTokens&&this.walkTokens(m,s.walkTokens);let v=f(m,s);return s.hooks&&(v=s.hooks.postprocess(v)),v}catch(m){return l(m)}}}onError(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const o="<p>An error occurred:</p><pre>"+bi(r.message+"",!0)+"</pre>";return t?Promise.resolve(o):o}if(t)return Promise.reject(r);throw r}}}const To=new uE;function kt(n,e){return To.parse(n,e)}kt.options=kt.setOptions=function(n){return To.setOptions(n),kt.defaults=To.defaults,y1(kt.defaults),kt};kt.getDefaults=Ff;kt.defaults=Eo;kt.use=function(...n){return To.use(...n),kt.defaults=To.defaults,y1(kt.defaults),kt};kt.walkTokens=function(n,e){return To.walkTokens(n,e)};kt.parseInline=To.parseInline;kt.Parser=Lr;kt.parser=Lr.parse;kt.Renderer=ld;kt.TextRenderer=Wf;kt.Lexer=Ar;kt.lexer=Ar.lex;kt.Tokenizer=sd;kt.Hooks=Vl;kt.parse=kt;kt.options;kt.setOptions;kt.use;kt.walkTokens;kt.parseInline;Lr.parse;Ar.lex;const Yp=({message:n})=>R.jsxs("div",{className:"bg-error-secondary text-error-primary text-base p-3 rounded-inner flex items-center gap-2",children:[R.jsx(vy,{className:"w-4 h-4 flex-none"}),R.jsx("p",{className:"text-primary-80",children:n})]}),dE=({handler:n,message:e,responseIndex:t,messageIndex:r})=>e.choices.length>0?R.jsx("ul",{className:"space-y-2 max-h-[40vh] overflow-auto no-scrollbar",children:e.choices.map((o,s)=>e.selectedChoiceId==null||o.choiceId===e.selectedChoiceId?R.jsx("li",{className:"w-full",children:R.jsx(ko,{type:"ghost",Icon:hd,onClick:e.selectedChoiceId==null?()=>{n.sendChoice(o.choiceId,{},{responseIndex:t,messageIndex:r})}:void 0,label:o.choiceText})},s):null)}):null,cp=({text:n,bubble:e,files:t})=>R.jsxs("div",{className:"space-y-2",children:[R.jsx("div",{className:"flex justify-end pl-10 text-base",children:R.jsx("div",{className:ot("text-primary-60 rounded-inner whitespace-pre-wrap",e?"bg-primary-5 p-3":""),children:n})}),t!=null?R.jsx("div",{className:"flex flex-wrap justify-end gap-2",children:t.map((r,o)=>R.jsx("img",{className:"rounded-inner h-20",src:URL.createObjectURL(r)},o))}):null]}),Rb=({text:n,number:e})=>R.jsxs("span",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"bg-primary-10 text-primary-60 text-xs px-1.5 py-0.5 rounded-inner",children:e}),n]}),hE=n=>{const e=new Map;return n.forEach((t,r)=>{const o={fileName:t.fileName,content:t.content,presignedUrl:t.presignedUrl,metadata:void 0,pageNumber:void 0},s=JSON.stringify(o),l=e.get(s);e.set(s,l==null?{source:o,indices:[r]}:{...l,indices:[...l.indices,r]})}),[...e.values()]},pE=({sources:n})=>{const[e,t]=Se.useState(!1),r=Se.useMemo(()=>hE(n),[n]);return r.length===0?null:R.jsxs("details",{className:"space-y-2",open:e,onToggle:o=>{t(o.currentTarget.open)},children:[R.jsxs("summary",{className:"flex cursor-pointer items-center gap-2 rounded-inner hover:bg-primary-5 text-primary-80",children:[R.jsx(NC,{type:"ghost",Icon:e?uy:dy}),"Sources"]}),R.jsx("ol",{className:"space-y-2",children:r.map(({source:o,indices:s},l)=>{const d=o.fileName??o.content??"Source",f="p-3 bg-primary-5 rounded-inner w-full flex items-center justify-between text-primary-80",m=s.map(v=>String(v+1)).join(", ");return R.jsx("li",{children:o.presignedUrl!=null?R.jsxs("a",{href:o.presignedUrl,className:ot(f,"hover:bg-primary-10"),children:[R.jsx(Rb,{text:d,number:m}),R.jsx(yy,{className:"w-4 h-4 text-primary-60"})]}):R.jsx("div",{className:f,children:R.jsx(Rb,{text:d,number:m})})},l)})})]})},fE=({responses:n,colorMode:e,chatMode:t,uploadedFiles:r,userMessageBubble:o,agentMessageBubble:s,lastApplicationResponseIndex:l,isWaiting:d,customModalities:f,handler:m,className:v,enabled:T})=>{const x=Se.useRef(null),S=Se.useRef(null);return Se.useEffect(()=>{!t&&!d&&setTimeout(()=>{var M;(M=S.current)==null||M.scrollIntoView({behavior:"smooth"})})},[d,t]),Se.useEffect(()=>{var M;if(t){const N=(M=x.current)==null?void 0:M.lastChild;N instanceof HTMLElement&&N.scrollIntoView({behavior:"smooth"})}},[n.length,t]),R.jsxs("div",{className:ot("relative",v),children:[R.jsx("div",{"data-theme":e==="dark"?"light":"dark",className:ot("absolute inset-x-0 h-[1px] top-0 bg-background opacity-[0.01] backdrop-blur-md")}),!t&&d?R.jsx(Iy,{label:"Thinking",className:"absolute inset-0"}):null,R.jsxs("div",{className:ot("absolute inset-0 p-2 md:p-3 overflow-y-auto no-scrollbar space-y-8",!t&&d?"opacity-0":"opacity-100"),ref:x,children:[n.map((M,N)=>{var V;if(M.type===Hn.User)return M.payload.type==="text"?R.jsx(cp,{text:M.payload.text,bubble:o},N):M.payload.type==="structured"&&M.payload.utterance!=null&&M.payload.uploadIds!=null?R.jsx(cp,{bubble:o,text:M.payload.utterance,files:M.payload.uploadIds.map(ae=>r[ae]).filter(ae=>ae!=null)},N):null;if(M.type===Hn.Failure)return R.jsx(Yp,{message:M.payload.text},N);const $=l!=null&&N===l;return R.jsxs(Se.Fragment,{children:[R.jsxs("div",{className:ot("space-y-2",!t&&$?"min-h-full":""),ref:$?S:void 0,children:[M.payload.messages.map((ae,z)=>R.jsx("div",{className:"text-base",children:R.jsx("div",{className:ot("space-y-6 markdown",s?"p-3 w-fit bg-secondary-40 mr-10 rounded-inner":""),dangerouslySetInnerHTML:{__html:kt(ae.text,{async:!1})}})},z)),((V=M.payload.metadata)==null?void 0:V.sources)!=null?R.jsx(pE,{sources:M.payload.metadata.sources}):null,Object.entries(M.payload.modalities??{}).map(([ae,z])=>{const A=f[ae];return A==null?(console.warn(`Custom component implementation missing for the ${ae} modality.`),null):R.jsx(A,{data:z,conversationHandler:m,enabled:T},ae)})]}),M.payload.messages.map((ae,z)=>{if(ae.selectedChoiceId!=null){const A=ae.choices.find(F=>F.choiceId===ae.selectedChoiceId);return A==null?null:R.jsx(cp,{text:A.choiceText,bubble:o},z)}return null})]},N)}),t&&d?R.jsxs("div",{className:"text-primary-60 flex items-center gap-1 text-base",children:[R.jsx("span",{className:"w-5 h-5 block flex-none text-accent",children:R.jsx(wf,{})}),"Thinking..."]}):null]},"messages")]})};function ef(){return ef=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ef.apply(null,arguments)}function mE(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}var gE=Se.useLayoutEffect,vE=function(n){var e=yo.useRef(n);return gE(function(){e.current=n}),e},Ib=function(n,e){if(typeof n=="function"){n(e);return}n.current=e},bE=function(n,e){var t=yo.useRef();return yo.useCallback(function(r){n.current=r,t.current&&Ib(t.current,null),t.current=e,e&&Ib(e,r)},[e])},Ob={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},yE=function(n){Object.keys(Ob).forEach(function(e){n.style.setProperty(e,Ob[e],"important")})},Mb=yE,zn=null,Ab=function(n,e){var t=n.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?t+e.borderSize:t-e.paddingSize};function wE(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=1/0),zn||(zn=document.createElement("textarea"),zn.setAttribute("tabindex","-1"),zn.setAttribute("aria-hidden","true"),Mb(zn)),zn.parentNode===null&&document.body.appendChild(zn);var o=n.paddingSize,s=n.borderSize,l=n.sizingStyle,d=l.boxSizing;Object.keys(l).forEach(function(x){var S=x;zn.style[S]=l[S]}),Mb(zn),zn.value=e;var f=Ab(zn,n);zn.value=e,f=Ab(zn,n),zn.value="x";var m=zn.scrollHeight-o,v=m*t;d==="border-box"&&(v=v+o+s),f=Math.max(v,f);var T=m*r;return d==="border-box"&&(T=T+o+s),f=Math.min(T,f),[f,m]}var Lb=function(){},kE=function(n,e){return n.reduce(function(t,r){return t[r]=e[r],t},{})},CE=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],SE=!!document.documentElement.currentStyle,TE=function(n){var e=window.getComputedStyle(n);if(e===null)return null;var t=kE(CE,e),r=t.boxSizing;if(r==="")return null;SE&&r==="border-box"&&(t.width=parseFloat(t.width)+parseFloat(t.borderRightWidth)+parseFloat(t.borderLeftWidth)+parseFloat(t.paddingRight)+parseFloat(t.paddingLeft)+"px");var o=parseFloat(t.paddingBottom)+parseFloat(t.paddingTop),s=parseFloat(t.borderBottomWidth)+parseFloat(t.borderTopWidth);return{sizingStyle:t,paddingSize:o,borderSize:s}},xE=TE;function _1(n,e,t){var r=vE(t);Se.useLayoutEffect(function(){var o=function(s){return r.current(s)};if(n)return n.addEventListener(e,o),function(){return n.removeEventListener(e,o)}},[])}var EE=function(n){_1(window,"resize",n)},PE=function(n){_1(document.fonts,"loadingdone",n)},_E=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],RE=function(n,e){var t=n.cacheMeasurements,r=n.maxRows,o=n.minRows,s=n.onChange,l=s===void 0?Lb:s,d=n.onHeightChange,f=d===void 0?Lb:d,m=mE(n,_E),v=m.value!==void 0,T=Se.useRef(null),x=bE(T,e),S=Se.useRef(0),M=Se.useRef(),N=function(){var $=T.current,ae=t&&M.current?M.current:xE($);if(ae){M.current=ae;var z=wE(ae,$.value||$.placeholder||"x",o,r),A=z[0],F=z[1];S.current!==A&&(S.current=A,$.style.setProperty("height",A+"px","important"),f(A,{rowHeight:F}))}},V=function($){v||N(),l($)};return Se.useLayoutEffect(N),EE(N),PE(N),Se.createElement("textarea",ef({},m,{onChange:V,ref:x}))},IE=Se.forwardRef(RE);const Nb=8,OE=({className:n,handler:e,uploadUrl:t,onFileUpload:r,enabled:o})=>{const[s,l]=Se.useState(!1),[d,f]=Se.useState(""),[m,v]=Se.useState(null),[T,x]=Se.useState(null),S=Se.useRef(null),M=Se.useRef(null),N=_y("md");Se.useEffect(()=>{var te;N&&((te=M.current)==null||te.focus())},[N]);const V=Se.useMemo(()=>d.trim()==="",[d]),[$,ae]=Se.useState(!1),z=V&&T==null||$||!o,A=()=>{if(z)return;const te=(K,ne)=>{(ne==null?void 0:ne.type)===Hn.Application&&(ae(!1),e.unsubscribe(te),f(""),x(null),N&&setTimeout(()=>{var Y;(Y=M.current)==null||Y.focus()}))};e.subscribe(te),ae(!0),t!=null&&T!=null?e.sendStructured({uploadIds:[t.uploadId],utterance:d}):e.sendText(d)},F=t!=null&&o,J=()=>{v("Something went wrong. Please try again.")},de=te=>{var K,ne;if(t==null){J();return}const Y=(ne=(K=te.target)==null?void 0:K.files)==null?void 0:ne[0];if(Y==null){J();return}const{name:me,size:Le,type:le}=Y;if(x({name:me,size:Le,type:le}),Le/1024**2>Nb){v(`The file is too big. Max file size: ${Nb}mb`);return}fetch(t.url,{method:"PUT",headers:{"Content-Type":"image/jpeg"},body:Y}).then(()=>{v(null),r({uploadId:t.uploadId,file:Y})}).catch(()=>{J()})};return R.jsx("div",{className:ot("relative",n),children:R.jsxs("div",{className:ot("bg-primary-5 transition-colors duration-200 p-2 rounded-outer text-base font-normal",s?"":"hover:bg-secondary-20"),children:[m!=null&&R.jsxs("div",{className:"flex items-center py-1 mb-2 w-full bg-error-secondary rounded-inner",children:[R.jsx(mp,{size:16}),R.jsx("span",{className:"truncate ml-1",children:m})]}),T&&R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[R.jsxs("p",{className:"flex items-center truncate mx-2",children:[m!=null?R.jsx(mp,{size:16,className:"text-error-primary"}):R.jsx(hy,{size:16,className:"text-primary-60"}),R.jsx("span",{className:"truncate ml-3",children:T.name})]}),R.jsx(Cn,{className:"flex-none",Icon:fy,label:"Delete",onClick:F?()=>{x(null),v(null),S.current!=null&&(S.current.value="")}:void 0,type:"ghost"})]}),R.jsx("hr",{className:"border-b-px border-background mb-2 -mx-2"})]}),R.jsxs("div",{className:ot("flex items-end gap-1"),children:[F&&T==null?R.jsxs(R.Fragment,{children:[R.jsx("label",{htmlFor:"file-upload",className:"p-3 w-10 h-10 flex-none block transition-colors rounded-inner bg-primary-80 hover:bg-primary-80 text-secondary-80 cursor-pointer",children:R.jsx(fp,{})}),R.jsx("input",{type:"file",id:"file-upload",className:"sr-only",accept:".jpg, .jpeg, .png, .webp, .mp4, .mpeg4, .avi, .mov, .pdf",onChange:de,ref:S})]}):R.jsx(Cn,{className:"flex-none",Icon:fp,label:"Upload file",type:"ghost"}),R.jsx(IE,{disabled:$||!o,className:ot("h-10 w-full resize-none mr-2 px-2 py-2 outline-none","bg-transparent text-primary-80 placeholder:text-primary-40 caret-accent","disabled:text-primary-40"),placeholder:"Type something",maxRows:10,onFocus:()=>{l(!0)},onBlur:()=>{l(!1)},value:d,onChange:te=>{f(te.target.value)},onKeyDown:te=>{te.key==="Enter"&&!te.shiftKey&&(te.preventDefault(),A())},ref:M}),R.jsx(Cn,{className:"flex-none",label:"Send message",onClick:z?void 0:()=>{A()},type:"main",Icon:hd})]})]})})},ME=n=>({"--font-family":n.fontFamily,"--inner-border-radius":n.innerBorderRadius,"--outer-border-radius":n.outerBorderRadius,"--primary-80":n.primary80,"--primary-60":n.primary60,"--primary-40":n.primary40,"--primary-20":n.primary20,"--primary-10":n.primary10,"--primary-5":n.primary5,"--primary-1":n.primary1,"--secondary-80":n.secondary80,"--secondary-60":n.secondary60,"--secondary-40":n.secondary40,"--secondary-20":n.secondary20,"--secondary-10":n.secondary10,"--secondary-5":n.secondary5,"--secondary-1":n.secondary1,"--accent":n.accent,"--accent-20":n.accent20,"--background":n.background,"--overlay":n.overlay,"--warning-primary":n.warningPrimary,"--warning-secondary":n.warningSecondary,"--error-primary":n.errorPrimary,"--error-secondary":n.errorSecondary}),AE={fontFamily:'"Neue Haas Grotesk", sans-serif',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"rgba(0, 2, 9, 0.8)",primary60:"rgba(0, 2, 9, 0.6)",primary40:"rgba(0, 2, 9, 0.4)",primary20:"rgba(0, 2, 9, 0.2)",primary10:"rgba(0, 2, 9, 0.1)",primary5:"rgba(0, 2, 9, 0.05)",primary1:"rgba(0, 2, 9, 0.01)",secondary80:"rgba(255, 255, 255, 0.85)",secondary60:"rgba(255, 255, 255, 0.65)",secondary40:"rgba(255, 255, 255, 0.45)",secondary20:"rgba(255, 255, 255, 0.25)",secondary10:"rgba(255, 255, 255, 0.15)",secondary5:"rgba(255, 255, 255, 0.08)",secondary1:"rgba(255, 255, 255, 0.01)",accent:"rgb(28, 99, 218)",accent20:"rgba(28, 99, 218, 0.2)",background:"rgba(220, 220, 220, 0.9)",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"rgb(220, 159, 3)",warningSecondary:"rgb(255, 242, 209)",errorPrimary:"rgb(157, 3, 3)",errorSecondary:"rgb(255, 223, 230)"},LE={fontFamily:'"Neue Haas Grotesk", sans-serif',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"rgba(255, 255, 255, 0.85)",primary60:"rgba(255, 255, 255, 0.65)",primary40:"rgba(255, 255, 255, 0.45)",primary20:"rgba(255, 255, 255, 0.25)",primary10:"rgba(255, 255, 255, 0.15)",primary5:"rgba(255, 255, 255, 0.08)",primary1:"rgba(255, 255, 255, 0.01)",secondary80:"rgba(0, 2, 9, 0.8)",secondary60:"rgba(0, 2, 9, 0.6)",secondary40:"rgba(0, 2, 9, 0.4)",secondary20:"rgba(0, 2, 9, 0.2)",secondary10:"rgba(0, 2, 9, 0.1)",secondary5:"rgba(0, 2, 9, 0.05)",secondary1:"rgba(0, 2, 9, 0.01)",accent:"rgb(174, 202, 255)",accent20:"rgba(174, 202, 255, 0.25)",background:"rgba(0, 2, 9, 0.9)",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"rgb(255, 214, 108)",warningSecondary:"rgb(95, 65, 29)",errorPrimary:"rgb(255, 133, 162)",errorSecondary:"rgb(94, 4, 4)"},NE=(n,e)=>{const t={};return n.accent!=null&&n.accent20==null&&(t.accent20=`color-mix(in srgb, ${n.accent} 20%, transparent)`),n.primary80!=null&&(n.primary60==null&&(t.primary60=`rgb(from ${n.primary80} r g b / 0.6)`),n.primary40==null&&(t.primary40=`rgb(from ${n.primary80} r g b / 0.4)`),n.primary20==null&&(t.primary20=`rgb(from ${n.primary80} r g b / 0.2)`),n.primary10==null&&(t.primary10=`rgb(from ${n.primary80} r g b / 0.1)`),n.primary5==null&&(t.primary5=`rgb(from ${n.primary80} r g b / 0.05)`),n.primary1==null&&(t.primary1=`rgb(from ${n.primary80} r g b / 0.01)`)),n.secondary80!=null&&(n.secondary60==null&&(t.secondary60=`rgb(from ${n.secondary80} r g b / 0.6)`),n.secondary40==null&&(t.secondary40=`rgb(from ${n.secondary80} r g b / 0.4)`),n.secondary20==null&&(t.secondary20=`rgb(from ${n.secondary80} r g b / 0.2)`),n.secondary10==null&&(t.secondary10=`rgb(from ${n.secondary80} r g b / 0.1)`),n.secondary5==null&&(t.secondary5=`rgb(from ${n.secondary80} r g b / 0.05)`),n.secondary1==null&&(t.secondary1=`rgb(from ${n.secondary80} r g b / 0.01)`)),{...e,...t,...n}},Vu=({colorMode:n,children:e,theme:t,className:r})=>{const o=NE(t??{},n==="dark"?LE:AE);return R.jsx("div",{className:ot(r,"font-sans"),style:{...ME(o),colorScheme:n},children:e})},R1="bg-background backdrop-blur text-primary-80 rounded-outer p-2 w-[calc(100vw-16px)] max-w-[360px] space-y-4",jb=({children:n,renderCollapse:e,onClose:t})=>R.jsxs("div",{className:R1,children:[e&&R.jsx("div",{className:"flex items-center justify-end",children:R.jsx(Cn,{onClick:t,Icon:Gl,type:"ghost",label:"Close"})}),n]}),Db=({children:n,className:e})=>R.jsx("div",{className:ot("bg-background rounded-outer p-2 w-fit flex items-center gap-2",e),children:n}),jE=({handler:n,context:e,onClose:t,customModalities:r,renderCollapse:o})=>{const[s,l]=Se.useState(!0),[d,f]=Se.useState(!0),m=()=>{t(new Event("close"))},{roomState:v,isUserSpeaking:T,isApplicationSpeaking:x,retry:S,modalities:M}=v1({micEnabled:s,speakersEnabled:d,handler:n,context:e});return v==="error"?R.jsxs(jb,{renderCollapse:o,onClose:m,children:[R.jsx(Yp,{message:"I couldnt connect"}),R.jsx(ko,{type:"ghost",label:"Retry",Icon:Kl,onClick:()=>{S()}})]}):v==="noAudioPermissions"?R.jsxs(jb,{renderCollapse:o,onClose:m,children:[R.jsx(Yp,{message:"Connect your microphone and speaker"}),R.jsx(ko,{type:"ghost",label:"Retry",Icon:Kl,onClick:()=>{S()}})]}):v==="pending"?R.jsxs(Db,{className:"relative",children:[R.jsx(Cn,{Icon:Ku,label:"Microphone",type:"ghost",className:"invisible"}),R.jsx(Cn,{Icon:Zu,label:"Speakers",type:"ghost",className:"invisible"}),R.jsx(Cn,{Icon:Gl,label:"Close",type:"ghost",className:"invisible"}),R.jsx("span",{className:"w-6 h-6 block text-accent absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:R.jsx(wf,{})})]}):R.jsxs(Db,{children:[R.jsxs("div",{className:"w-fit relative",children:[T?R.jsx(Zl,{className:"rounded-inner"}):null,R.jsx(Cn,{Icon:s?Ku:bf,label:"Microphone",type:s?"activated":"ghost",onClick:()=>{l(N=>!N)}})]}),R.jsxs("div",{className:"w-fit relative",children:[x?R.jsx(Zl,{className:"rounded-inner"}):null,R.jsx(Cn,{Icon:d?Zu:yf,label:"Speakers",type:d?"activated":"ghost",onClick:()=>{f(N=>!N)}})]}),R.jsx(Cn,{label:"Close",Icon:Gl,type:"error",onClick:()=>{m()}}),R.jsx(b1,{className:ot(R1,"absolute right-0 -top-2 transform -translate-y-full max-h-[360px] overflow-auto"),modalities:M,customModalities:r,handler:n})]})};var DE=Object.prototype.toString;function UE(n){return typeof n=="function"||DE.call(n)==="[object Function]"}function FE(n){var e=Number(n);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var BE=Math.pow(2,53)-1;function zE(n){var e=FE(n);return Math.min(Math.max(e,0),BE)}function Jr(n,e){var t=Array,r=Object(n);if(n==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var o=zE(r.length),s=UE(t)?Object(new t(o)):new Array(o),l=0,d;l<o;)d=r[l],s[l]=d,l+=1;return s.length=o,s}function Yl(n){"@babel/helpers - typeof";return Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yl(n)}function VE(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function HE(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,I1(r.key),r)}}function qE(n,e,t){return e&&HE(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function $E(n,e,t){return e=I1(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I1(n){var e=WE(n,"string");return Yl(e)=="symbol"?e:e+""}function WE(n,e){if(Yl(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Yl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var GE=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];VE(this,n),$E(this,"items",void 0),this.items=e}return qE(n,[{key:"add",value:function(e){return this.has(e)===!1&&this.items.push(e),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(e){var t=this.items.length;return this.items=this.items.filter(function(r){return r!==e}),t!==this.items.length}},{key:"forEach",value:function(e){var t=this;this.items.forEach(function(r){e(r,r,t)})}},{key:"has",value:function(e){return this.items.indexOf(e)!==-1}},{key:"size",get:function(){return this.items.length}}])}();const KE=typeof Set>"u"?Set:GE;function Ln(n){var e;return(e=n.localName)!==null&&e!==void 0?e:n.tagName.toLowerCase()}var ZE={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},QE={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),none:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function XE(n,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-description","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(t){var r;return n.hasAttribute(t)&&!((r=QE[e])!==null&&r!==void 0&&r.has(t))})}function O1(n,e){return XE(n,e)}function JE(n){var e=eP(n);if(e===null||tf.indexOf(e)!==-1){var t=YE(n);if(tf.indexOf(e||"")===-1||O1(n,t||""))return t}return e}function YE(n){var e=ZE[Ln(n)];if(e!==void 0)return e;switch(Ln(n)){case"a":case"area":case"link":if(n.hasAttribute("href"))return"link";break;case"img":return n.getAttribute("alt")===""&&!O1(n,"img")?"presentation":"img";case"input":{var t=n,r=t.type;switch(r){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return r;case"range":return"slider";case"email":case"tel":case"text":case"url":return n.hasAttribute("list")?"combobox":"textbox";case"search":return n.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return n.hasAttribute("multiple")||n.size>1?"listbox":"combobox"}return null}function eP(n){var e=n.getAttribute("role");if(e!==null){var t=e.trim().split(" ")[0];if(t.length>0)return t}return null}var tf=["presentation","none"];function Dt(n){return n!==null&&n.nodeType===n.ELEMENT_NODE}function M1(n){return Dt(n)&&Ln(n)==="caption"}function Hu(n){return Dt(n)&&Ln(n)==="input"}function tP(n){return Dt(n)&&Ln(n)==="optgroup"}function nP(n){return Dt(n)&&Ln(n)==="select"}function rP(n){return Dt(n)&&Ln(n)==="table"}function iP(n){return Dt(n)&&Ln(n)==="textarea"}function aP(n){var e=n.ownerDocument===null?n:n.ownerDocument,t=e.defaultView;if(t===null)throw new TypeError("no window available");return t}function oP(n){return Dt(n)&&Ln(n)==="fieldset"}function sP(n){return Dt(n)&&Ln(n)==="legend"}function lP(n){return Dt(n)&&Ln(n)==="slot"}function cP(n){return Dt(n)&&n.ownerSVGElement!==void 0}function uP(n){return Dt(n)&&Ln(n)==="svg"}function dP(n){return cP(n)&&Ln(n)==="title"}function cd(n,e){if(Dt(n)&&n.hasAttribute(e)){var t=n.getAttribute(e).split(" "),r=n.getRootNode?n.getRootNode():n.ownerDocument;return t.map(function(o){return r.getElementById(o)}).filter(function(o){return o!==null})}return[]}function qi(n,e){return Dt(n)?e.indexOf(JE(n))!==-1:!1}function hP(n){return n.trim().replace(/\s\s+/g," ")}function pP(n,e){if(!Dt(n))return!1;if(n.hasAttribute("hidden")||n.getAttribute("aria-hidden")==="true")return!0;var t=e(n);return t.getPropertyValue("display")==="none"||t.getPropertyValue("visibility")==="hidden"}function fP(n){return qi(n,["button","combobox","listbox","textbox"])||A1(n,"range")}function A1(n,e){if(!Dt(n))return!1;switch(e){case"range":return qi(n,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function Ub(n,e){var t=Jr(n.querySelectorAll(e));return cd(n,"aria-owns").forEach(function(r){t.push.apply(t,Jr(r.querySelectorAll(e)))}),t}function mP(n){return nP(n)?n.selectedOptions||Ub(n,"[selected]"):Ub(n,'[aria-selected="true"]')}function gP(n){return qi(n,tf)}function vP(n){return M1(n)}function bP(n){return qi(n,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function yP(n){return!1}function wP(n){return Hu(n)||iP(n)?n.value:n.textContent||""}function Fb(n){var e=n.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function L1(n){var e=Ln(n);return e==="button"||e==="input"&&n.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function N1(n){if(L1(n))return n;var e=null;return n.childNodes.forEach(function(t){if(e===null&&Dt(t)){var r=N1(t);r!==null&&(e=r)}}),e}function kP(n){if(n.control!==void 0)return n.control;var e=n.getAttribute("for");return e!==null?n.ownerDocument.getElementById(e):N1(n)}function CP(n){var e=n.labels;if(e===null)return e;if(e!==void 0)return Jr(e);if(!L1(n))return null;var t=n.ownerDocument;return Jr(t.querySelectorAll("label")).filter(function(r){return kP(r)===n})}function SP(n){var e=n.assignedNodes();return e.length===0?Jr(n.childNodes):e}function j1(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new KE,r=typeof Map>"u"?void 0:new Map,o=aP(n),s=e.compute,l=s===void 0?"name":s,d=e.computedStyleSupportsPseudoElements,f=d===void 0?e.getComputedStyle!==void 0:d,m=e.getComputedStyle,v=m===void 0?o.getComputedStyle.bind(o):m,T=e.hidden,x=T===void 0?!1:T,S=function(z,A){if(A!==void 0)throw new Error("use uncachedGetComputedStyle directly for pseudo elements");if(r===void 0)return v(z);var F=r.get(z);if(F)return F;var J=v(z,A);return r.set(z,J),J};function M(z,A){var F="";if(Dt(z)&&f){var J=v(z,"::before"),de=Fb(J);F="".concat(de," ").concat(F)}var te=lP(z)?SP(z):Jr(z.childNodes).concat(cd(z,"aria-owns"));if(te.forEach(function(Y){var me=ae(Y,{isEmbeddedInLabel:A.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),Le=Dt(Y)?S(Y).getPropertyValue("display"):"inline",le=Le!=="inline"?" ":"";F+="".concat(le).concat(me).concat(le)}),Dt(z)&&f){var K=v(z,"::after"),ne=Fb(K);F="".concat(F," ").concat(ne)}return F.trim()}function N(z,A){var F=z.getAttributeNode(A);return F!==null&&!t.has(F)&&F.value.trim()!==""?(t.add(F),F.value):null}function V(z){return Dt(z)?N(z,"title"):null}function $(z){if(!Dt(z))return null;if(oP(z)){t.add(z);for(var A=Jr(z.childNodes),F=0;F<A.length;F+=1){var J=A[F];if(sP(J))return ae(J,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(rP(z)){t.add(z);for(var de=Jr(z.childNodes),te=0;te<de.length;te+=1){var K=de[te];if(M1(K))return ae(K,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(uP(z)){t.add(z);for(var ne=Jr(z.childNodes),Y=0;Y<ne.length;Y+=1){var me=ne[Y];if(dP(me))return me.textContent}return null}else if(Ln(z)==="img"||Ln(z)==="area"){var Le=N(z,"alt");if(Le!==null)return Le}else if(tP(z)){var le=N(z,"label");if(le!==null)return le}if(Hu(z)&&(z.type==="button"||z.type==="submit"||z.type==="reset")){var pe=N(z,"value");if(pe!==null)return pe;if(z.type==="submit")return"Submit";if(z.type==="reset")return"Reset"}var Oe=CP(z);if(Oe!==null&&Oe.length!==0)return t.add(z),Jr(Oe).map(function(ue){return ae(ue,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(ue){return ue.length>0}).join(" ");if(Hu(z)&&z.type==="image"){var Ee=N(z,"alt");if(Ee!==null)return Ee;var ce=N(z,"title");return ce!==null?ce:"Submit Query"}if(qi(z,["button"])){var Re=M(z,{isEmbeddedInLabel:!1});if(Re!=="")return Re}return null}function ae(z,A){if(t.has(z))return"";if(!x&&pP(z,S)&&!A.isReferenced)return t.add(z),"";var F=Dt(z)?z.getAttributeNode("aria-labelledby"):null,J=F!==null&&!t.has(F)?cd(z,"aria-labelledby"):[];if(l==="name"&&!A.isReferenced&&J.length>0)return t.add(F),J.map(function(Le){return ae(Le,{isEmbeddedInLabel:A.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var de=A.recursion&&fP(z)&&l==="name";if(!de){var te=(Dt(z)&&z.getAttribute("aria-label")||"").trim();if(te!==""&&l==="name")return t.add(z),te;if(!gP(z)){var K=$(z);if(K!==null)return t.add(z),K}}if(qi(z,["menu"]))return t.add(z),"";if(de||A.isEmbeddedInLabel||A.isReferenced){if(qi(z,["combobox","listbox"])){t.add(z);var ne=mP(z);return ne.length===0?Hu(z)?z.value:"":Jr(ne).map(function(Le){return ae(Le,{isEmbeddedInLabel:A.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(A1(z,"range"))return t.add(z),z.hasAttribute("aria-valuetext")?z.getAttribute("aria-valuetext"):z.hasAttribute("aria-valuenow")?z.getAttribute("aria-valuenow"):z.getAttribute("value")||"";if(qi(z,["textbox"]))return t.add(z),wP(z)}if(bP(z)||Dt(z)&&A.isReferenced||vP(z)||yP()){var Y=M(z,{isEmbeddedInLabel:A.isEmbeddedInLabel});if(Y!=="")return t.add(z),Y}if(z.nodeType===z.TEXT_NODE)return t.add(z),z.textContent||"";if(A.recursion)return t.add(z),M(z,{isEmbeddedInLabel:A.isEmbeddedInLabel});var me=V(z);return me!==null?(t.add(z),me):(t.add(z),"")}return hP(ae(n,{isEmbeddedInLabel:!1,isReferenced:l==="description",recursion:!1}))}function ec(n){"@babel/helpers - typeof";return ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ec(n)}function Bb(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function zb(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bb(Object(t),!0).forEach(function(r){TP(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Bb(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function TP(n,e,t){return e=xP(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xP(n){var e=EP(n,"string");return ec(e)=="symbol"?e:e+""}function EP(n,e){if(ec(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(ec(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Vb(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=cd(n,"aria-describedby").map(function(s){return j1(s,zb(zb({},e),{},{compute:"description"}))}).join(" ");if(t===""){var r=n.getAttribute("aria-description");t=r===null?"":r}if(t===""){var o=n.getAttribute("title");t=o===null?"":o}return t}function PP(n){return qi(n,["caption","code","deletion","emphasis","generic","insertion","none","paragraph","presentation","strong","subscript","superscript"])}function nf(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return PP(n)?"":j1(n,e)}const _P=n=>n instanceof HTMLTextAreaElement?{value:n.value}:n.type==="checkbox"?{value:n.checked,options:[{value:!0,selected:n.checked,text:"checked"},{value:!1,selected:!n.checked,text:"unchecked"}]}:{value:n.value},RP=n=>{if(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement){const e=nf(n)??"";return{name:e===""?n.name:e,description:Vb(n),type:n.type,placeholder:n.placeholder,..._P(n)}}else if(n instanceof HTMLSelectElement){const e=nf(n)??"";return{name:e===""?n.name:e,description:Vb(n),type:n.type,value:n.value,options:Array.from(n.options).map(t=>({value:t.value,text:t.text,selected:t.selected}))}}throw new TypeError("Unsupported element type")},IP=()=>{const n=Array.from(document.querySelectorAll("input, textarea, select")).map((t,r)=>({index:r,id:`${t.tagName.toLowerCase()}-${r}`,element:t})),e={};return n.forEach(({id:t,element:r})=>{e[t]=r}),{context:n.map(({id:t,element:r})=>({id:t,...RP(r)})),formElements:e}},qu=(n,...e)=>{console.debug(`[NLX V+] ${n}`,...e)},OP=(n,e=50,t=1/0)=>{let r=null,o=null,s=Promise.resolve();return(...l)=>{o??(o=Date.now());const d=()=>{s=s.then(async()=>{try{await n.apply(null,l)}catch{}}),o=null};r&&clearTimeout(r),Date.now()-o>t?d():r=setTimeout(()=>{d()},e)}},MP=(n,e,t,r)=>{let o={fields:[],destinations:[],actions:[]};const s=OP(async()=>{const{context:d,state:f}=t(AP(e));if(!mf(o,d)){try{qu("Automatic context sent:",d),await n.sendContext({"nlx:vpContext":d})}catch{}r(f),o=d}},50,300);s();const l=new MutationObserver(s);return l.observe(document.body,{subtree:!0,childList:!0,attributes:!0}),{teardown:()=>{l.disconnect()},onCustomCommandsChange:d=>{e=d,s()}}},AP=n=>{const{context:e,formElements:t}=IP(),{context:r,links:o}=LP();return{context:{uri:window.location.pathname,fields:e,destinations:r,actions:n.filter(s=>s.schema!=null).map(s=>{const{handler:l,...d}=s;return d})},state:{formElements:t,links:o,customCommands:new Map(n.map(s=>[s.action,s.handler]))}}},LP=()=>{const n=Object.fromEntries(vk(Array.from(document.querySelectorAll("a")).map(e=>[nf(e),e.getAttribute("href")??""])));return{context:Object.keys(n),links:n}},NP=(n,e,t)=>{const r=o=>{switch(qu("Command received",o),o.classification){case"navigation":if(e.navigation!=null)e.navigation(o.action,o.destination,t.current.links);else if(e.automaticContext!==!1)switch(o.action){case"page_next":window.history.forward();break;case"page_previous":window.history.back();break;case"page_custom":if(o.destination!=null){const s=t.current.links[o.destination];if(s!=null)window.location.href=s;else try{new URL(o.destination),window.location.href=o.destination}catch{qu('Custom page navigation action received, but no URL found for destination".',o.destination)}}break;case"page_unknown":qu("Unknown page navigation action received, no automatic handling available.")}break;case"input":(e==null?void 0:e.input)!=null?e.input(o.fields,t.current.formElements):(e==null?void 0:e.automaticContext)!==!1&&o.fields.forEach(s=>{if(t.current.formElements[s.id]!=null){const l=t.current.formElements[s.id];typeof s.value=="string"?l.value=s.value:l instanceof HTMLInputElement&&l.type==="checkbox"&&(l.checked=s.value),l.classList.add("voice-updated"),l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0})),setTimeout(()=>{l.classList.remove("voice-updated")},2e3)}});break;case"custom":if(t.current.customCommands.has(o.action)){const s=t.current.customCommands.get(o.action);o.payload!=null&&s(o.payload)}(e==null?void 0:e.custom)!=null&&(e.automaticContext!==!1&&console.warn("bidirectional.custom is deprecated in automatic context mode. Please use `setCustomBidirectionalCommands` instead."),e.custom(o.action,o.payload));break}};return n.addEventListener("voicePlusCommand",r),()=>{n.removeEventListener("voicePlusCommand",r)}};var rf={exports:{}},jP=rf.exports,Hb;function DP(){return Hb||(Hb=1,function(n,e){(function(t,r){n.exports=r()})(jP,()=>(()=>{var t=[,(l,d,f)=>{f.r(d),f.d(d,{default:()=>v});var m=(()=>{var T=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(x={}){var S=x,M,N;S.ready=new Promise((u,h)=>{M=u,N=h});function V(){function u(D){const q=k;g=h=0,k=new Map,q.forEach(re=>{try{re(D)}catch(G){console.error(G)}}),this.ob(),E&&E.Qb()}let h=0,g=0,k=new Map,E=null,I=null;this.requestAnimationFrame=function(D){h||(h=requestAnimationFrame(u.bind(this)));const q=++g;return k.set(q,D),q},this.cancelAnimationFrame=function(D){k.delete(D),h&&k.size==0&&(cancelAnimationFrame(h),h=0)},this.Ob=function(D){I&&(document.body.remove(I),I=null),D||(I=document.createElement("div"),I.style.backgroundColor="black",I.style.position="fixed",I.style.right=0,I.style.top=0,I.style.color="white",I.style.padding="4px",I.innerHTML="RIVE FPS",D=function(q){I.innerHTML="RIVE FPS "+q.toFixed(1)},document.body.appendChild(I)),E=new function(){let q=0,re=0;this.Qb=function(){var G=performance.now();re?(++q,G-=re,1e3<G&&(D(1e3*q/G),q=re=0)):(re=G,q=0)}}},this.ob=function(){}}function $(){console.assert(!0);const u=new Map;let h=-1/0;this.push=function(g){return g=g+255>>8,u.has(g)&&clearTimeout(u.get(g)),u.set(g,setTimeout(function(){u.delete(g),u.length==0?h=-1/0:g==h&&(h=Math.max(...u.keys()),console.assert(h<g))},1e3)),h=Math.max(g,h),h<<8}}const ae=S.onRuntimeInitialized;S.onRuntimeInitialized=function(){ae&&ae();let u=S.decodeAudio;S.decodeAudio=function(E,I){E=u(E),I(E)};let h=S.decodeFont;S.decodeFont=function(E,I){E=h(E),I(E)};const g=S.FileAssetLoader;S.ptrToAsset=E=>{let I=S.ptrToFileAsset(E);return I.isImage?S.ptrToImageAsset(E):I.isFont?S.ptrToFontAsset(E):I.isAudio?S.ptrToAudioAsset(E):I},S.CustomFileAssetLoader=g.extend("CustomFileAssetLoader",{__construct:function({loadContents:E}){this.__parent.__construct.call(this),this.Eb=E},loadContents:function(E,I){return E=S.ptrToAsset(E),this.Eb(E,I)}}),S.CDNFileAssetLoader=g.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(E){let I=S.ptrToAsset(E);return E=I.cdnUuid,E===""?!1:(function(D,q){var re=new XMLHttpRequest;re.responseType="arraybuffer",re.onreadystatechange=function(){re.readyState==4&&re.status==200&&q(re)},re.open("GET",D,!0),re.send(null)}(I.cdnBaseUrl+"/"+E,D=>{I.decode(new Uint8Array(D.response))}),!0)}}),S.FallbackFileAssetLoader=g.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.kb=[]},addLoader:function(E){this.kb.push(E)},loadContents:function(E,I){for(let D of this.kb)if(D.loadContents(E,I))return!0;return!1}});let k=S.computeAlignment;S.computeAlignment=function(E,I,D,q,re=1){return k.call(this,E,I,D,q,re)}};const z=S.onRuntimeInitialized;S.onRuntimeInitialized=function(){function u(fe){this.F=fe,this.Db=fe.getContext("2d"),this.Gb=k,this.S=[],this.la=0,this.clear=function(){console.assert(this.la==0),this.S=[],E.delete(this)},this.save=function(){++this.la,this.S.push(k.save.bind(k))},this.restore=function(){0<this.la&&(this.S.push(k.restore.bind(k)),--this.la)},this.transform=function(Pe){this.S.push(k.transform.bind(k,Pe))},this.align=function(Pe,He,Ze,tt,ft=1){this.S.push(k.align.bind(k,Pe,He,Ze,tt,ft))},this.flush=function(){console.assert(this.la==0),E.add(this),k.$a||g()},this.delete=function(){}}function h(fe,Pe=!1){var He={alpha:!0,depth:Pe,stencil:Pe,antialias:Pe,premultipliedAlpha:!0,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:!1,explicitSwapControl:0,renderViaOffscreenBackBuffer:0};if(Pe=fe.getContext("webgl2",He),!Pe)return null;He=Rd(Pe,He),Go(He);const Ze=I(fe.width,fe.height);Ze.Na=He,Ze.F=fe,Ze.Oa=fe.width,Ze.ab=fe.height,Ze.T=Pe;var tt=Ze.delete;return Ze.delete=function(){tt.call(this);var ft=this.Na;ur===Zt[ft]&&(ur=null),typeof JSEvents=="object"&&JSEvents.Oc(Zt[ft].C.canvas),Zt[ft]&&Zt[ft].C.canvas&&(Zt[ft].C.canvas.Cb=void 0),this.Na=this.F=this.Oa=this.T=Zt[ft]=null},Ze}function g(){if(k){var fe=k.Fb,Pe=0,He=0,Ze=0,tt=Array(E.size),ft=0;for(var _t of E)_t.ga=Math.min(_t.F.width,fe),_t.fa=Math.min(_t.F.height,fe),_t.La=_t.fa*_t.ga,Pe=Math.max(Pe,_t.ga),He=Math.max(He,_t.fa),Ze+=_t.La,tt[ft++]=_t;if(E.clear(),!(0>=Ze)){for(Pe=1<<(0>=Pe?0:32-Math.clz32(Pe-1)),He=1<<(0>=He?0:32-Math.clz32(He-1));He*Pe<Ze;)Pe<=He?Pe*=2:He*=2;for(Pe=Math.min(Pe,fe),Pe=Math.min(He,fe),tt.sort((Hr,Mi)=>Mi.La-Hr.La),Ze=new S.DynamicRectanizer(fe),_t=0;_t<tt.length;){for(Ze.reset(Pe,He),ft=_t;ft<tt.length;++ft){var Mt=tt[ft],xt=Ze.addRect(Mt.ga,Mt.fa);if(0>xt){console.assert(ft>_t);break}Mt.ra=xt&65535,Mt.sa=xt>>16}for(Mt=re.push(Ze.drawWidth()),xt=G.push(Ze.drawHeight()),console.assert(Mt>=Ze.drawWidth()),console.assert(xt>=Ze.drawHeight()),console.assert(Mt<=fe),console.assert(xt<=fe),k.F.width!=Mt&&(k.F.width=Mt),k.F.height!=xt&&(k.F.height=xt),k.clear(),Mt=_t;Mt<ft;++Mt){xt=tt[Mt],k.saveClipRect(xt.ra,xt.sa,xt.ra+xt.ga,xt.sa+xt.fa);let Hr=new S.Mat2D;Hr.xx=xt.ga/xt.F.width,Hr.yy=xt.fa/xt.F.height,Hr.xy=Hr.yx=0,Hr.tx=xt.ra,Hr.ty=xt.sa,k.transform(Hr);for(const Mi of xt.S)Mi();k.restoreClipRect(),xt.S=[]}for(k.flush();_t<ft;++_t)Mt=tt[_t],xt=Mt.Db,xt.globalCompositeOperation="copy",xt.drawImage(k.F,Mt.ra,Mt.sa,Mt.ga,Mt.fa,0,0,Mt.F.width,Mt.F.height);_t=ft}}}}z&&z();let k=null;const E=new Set,I=S.makeRenderer;S.makeRenderer=function(fe,Pe){if(!k){let He=function(Ze){var tt=document.createElement("canvas");return tt.width=1,tt.height=1,k=h(tt,Ze),k.$a=!!k.T.getExtension("WEBGL_shader_pixel_local_storage"),k.Fb=Math.min(k.T.getParameter(k.T.MAX_RENDERBUFFER_SIZE),k.T.getParameter(k.T.MAX_TEXTURE_SIZE)),k.Ma=!k.$a,(Ze=k.T.getExtension("WEBGL_debug_renderer_info"))&&(tt=k.T.getParameter(Ze.UNMASKED_RENDERER_WEBGL),k.T.getParameter(Ze.UNMASKED_VENDOR_WEBGL).includes("Google")&&tt.includes("ANGLE Metal Renderer")&&(k.Ma=!1)),k};k=He(!0),k.Ma||(k=He(!1))}return Pe?new u(fe):h(fe,k.Ma)};const D=S.Artboard.prototype.delete;S.Artboard.prototype.delete=function(){this.Hb=!0,D.call(this)};const q=S.Artboard.prototype.draw;S.Artboard.prototype.draw=function(fe){fe.S?fe.S.push(()=>{this.Hb||q.call(this,fe.Gb)}):q.call(this,fe)};const re=new $,G=new $,Ce=new V;S.requestAnimationFrame=Ce.requestAnimationFrame.bind(Ce),S.cancelAnimationFrame=Ce.cancelAnimationFrame.bind(Ce),S.enableFPSCounter=Ce.Ob.bind(Ce),Ce.ob=g,S.resolveAnimationFrame=g;let Ie=S.load;S.load=function(fe,Pe,He=!0){const Ze=new S.FallbackFileAssetLoader;return Pe!==void 0&&Ze.addLoader(Pe),He&&(Pe=new S.CDNFileAssetLoader,Ze.addLoader(Pe)),Promise.resolve(Ie(fe,Ze))};const Ue=S.WebGL2Renderer.prototype.clear;S.WebGL2Renderer.prototype.clear=function(){Go(this.Na);const fe=this.F;(this.Oa!=fe.width||this.ab!=fe.height)&&(this.resize(fe.width,fe.height),this.Oa=fe.width,this.ab=fe.height),Ue.call(this)},S.decodeImage=function(fe,Pe){fe=S.decodeWebGL2Image(fe),Pe(fe)};let Q=S.Renderer.prototype.align;S.Renderer.prototype.align=function(fe,Pe,He,Ze,tt=1){Q.call(this,fe,Pe,He,Ze,tt)}};var A=Object.assign({},S),F="./this.program",J=typeof window=="object",de=typeof importScripts=="function",te="",K,ne;(J||de)&&(de?te=self.location.href:typeof document<"u"&&document.currentScript&&(te=document.currentScript.src),T&&(te=T),te.indexOf("blob:")!==0?te=te.substr(0,te.replace(/[?#].*/,"").lastIndexOf("/")+1):te="",de&&(ne=u=>{var h=new XMLHttpRequest;return h.open("GET",u,!1),h.responseType="arraybuffer",h.send(null),new Uint8Array(h.response)}),K=(u,h,g)=>{var k=new XMLHttpRequest;k.open("GET",u,!0),k.responseType="arraybuffer",k.onload=()=>{k.status==200||k.status==0&&k.response?h(k.response):g()},k.onerror=g,k.send(null)});var Y=S.print||console.log.bind(console),me=S.printErr||console.error.bind(console);Object.assign(S,A),A=null,S.thisProgram&&(F=S.thisProgram);var Le;S.wasmBinary&&(Le=S.wasmBinary),S.noExitRuntime,typeof WebAssembly!="object"&&pn("no native wasm support detected");var le,pe,Oe=!1,Ee,ce,Re,ue,L,ee,We,Ke;function Ye(){var u=le.buffer;S.HEAP8=Ee=new Int8Array(u),S.HEAP16=Re=new Int16Array(u),S.HEAP32=L=new Int32Array(u),S.HEAPU8=ce=new Uint8Array(u),S.HEAPU16=ue=new Uint16Array(u),S.HEAPU32=ee=new Uint32Array(u),S.HEAPF32=We=new Float32Array(u),S.HEAPF64=Ke=new Float64Array(u)}var ze,et=[],$e=[],ct=[];function Ot(){var u=S.preRun.shift();et.unshift(u)}var Ht=0,$n=null;function pn(u){throw S.onAbort&&S.onAbort(u),u="Aborted("+u+")",me(u),Oe=!0,u=new WebAssembly.RuntimeError(u+". Build with -sASSERTIONS for more info."),N(u),u}function gr(u){return u.startsWith("data:application/octet-stream;base64,")}var vr;if(vr="webgl2_advanced.wasm",!gr(vr)){var Gi=vr;vr=S.locateFile?S.locateFile(Gi,te):te+Gi}function Ti(u){if(u==vr&&Le)return new Uint8Array(Le);if(ne)return ne(u);throw"both async and sync fetching of the wasm failed"}function Po(u){if(!Le&&(J||de)){if(typeof fetch=="function"&&!u.startsWith("file://"))return fetch(u,{credentials:"same-origin"}).then(h=>{if(!h.ok)throw"failed to load wasm binary file at '"+u+"'";return h.arrayBuffer()}).catch(()=>Ti(u));if(K)return new Promise((h,g)=>{K(u,k=>h(new Uint8Array(k)),g)})}return Promise.resolve().then(()=>Ti(u))}function fn(u,h,g){return Po(u).then(k=>WebAssembly.instantiate(k,h)).then(k=>k).then(g,k=>{me("failed to asynchronously prepare wasm: "+k),pn(k)})}function xi(u,h){var g=vr;return Le||typeof WebAssembly.instantiateStreaming!="function"||gr(g)||g.startsWith("file://")||typeof fetch!="function"?fn(g,u,h):fetch(g,{credentials:"same-origin"}).then(k=>WebAssembly.instantiateStreaming(k,u).then(h,function(E){return me("wasm streaming compile failed: "+E),me("falling back to ArrayBuffer instantiation"),fn(g,u,h)}))}var Nn,Ei,_o={534231:(u,h,g,k,E)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Ga:0},window.h.I={},window.h.I.Ea=u,window.h.I.capture=h,window.h.I.Ra=g,window.h.ja={},window.h.ja.stopped=k,window.h.ja.xb=E;let I=window.h;I.D=[],I.rc=function(D){for(var q=0;q<I.D.length;++q)if(I.D[q]==null)return I.D[q]=D,q;return I.D.push(D),I.D.length-1},I.Bb=function(D){for(I.D[D]=null;0<I.D.length&&I.D[I.D.length-1]==null;)I.D.pop()},I.Qc=function(D){for(var q=0;q<I.D.length;++q)if(I.D[q]==D)return I.Bb(q)},I.va=function(D){return I.D[D]},I.Za=["touchend","click"],I.unlock=function(){for(var D=0;D<I.D.length;++D){var q=I.D[D];q!=null&&q.J!=null&&q.state===I.ja.xb&&q.J.resume().then(()=>{Kn(q.pb)},re=>{console.error("Failed to resume audiocontext",re)})}I.Za.map(function(re){document.removeEventListener(re,I.unlock,!0)})},I.Za.map(function(D){document.addEventListener(D,I.unlock,!0)})}return window.h.Ga+=1,1},536409:()=>{typeof window.h<"u"&&(window.h.Za.map(function(u){document.removeEventListener(u,window.h.unlock,!0)}),--window.h.Ga,window.h.Ga===0&&delete window.h)},536713:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,536817:()=>{try{var u=new(window.AudioContext||window.webkitAudioContext),h=u.sampleRate;return u.close(),h}catch{return 0}},536988:(u,h,g,k,E,I)=>{if(typeof window.h>"u")return-1;var D={},q={};return u==window.h.I.Ea&&g!=0&&(q.sampleRate=g),D.J=new(window.AudioContext||window.webkitAudioContext)(q),D.J.suspend(),D.state=window.h.ja.stopped,g=0,u!=window.h.I.Ea&&(g=h),D.Z=D.J.createScriptProcessor(k,g,h),D.Z.onaudioprocess=function(re){if((D.wa==null||D.wa.length==0)&&(D.wa=new Float32Array(We.buffer,E,k*h)),u==window.h.I.capture||u==window.h.I.Ra){for(var G=0;G<h;G+=1)for(var Ce=re.inputBuffer.getChannelData(G),Ie=D.wa,Ue=0;Ue<k;Ue+=1)Ie[Ue*h+G]=Ce[Ue];na(I,k,E)}if(u==window.h.I.Ea||u==window.h.I.Ra)for(il(I,k,E),G=0;G<re.outputBuffer.numberOfChannels;++G)for(Ce=re.outputBuffer.getChannelData(G),Ie=D.wa,Ue=0;Ue<k;Ue+=1)Ce[Ue]=Ie[Ue*h+G];else for(G=0;G<re.outputBuffer.numberOfChannels;++G)re.outputBuffer.getChannelData(G).fill(0)},u!=window.h.I.capture&&u!=window.h.I.Ra||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(re){D.Ha=D.J.createMediaStreamSource(re),D.Ha.connect(D.Z),D.Z.connect(D.J.destination)}).catch(function(re){console.log("Failed to get user media: "+re)}),u==window.h.I.Ea&&D.Z.connect(D.J.destination),D.pb=I,window.h.rc(D)},539865:u=>window.h.va(u).J.sampleRate,539938:u=>{u=window.h.va(u),u.Z!==void 0&&(u.Z.onaudioprocess=function(){},u.Z.disconnect(),u.Z=void 0),u.Ha!==void 0&&(u.Ha.disconnect(),u.Ha=void 0),u.J.close(),u.J=void 0,u.pb=void 0},540338:u=>{window.h.Bb(u)},540388:u=>{u=window.h.va(u),u.J.resume(),u.state=window.h.ja.xb},540527:u=>{u=window.h.va(u),u.J.suspend(),u.state=window.h.ja.stopped}},_=u=>{for(;0<u.length;)u.shift()(S)},y=(u,h)=>{for(var g=0,k=u.length-1;0<=k;k--){var E=u[k];E==="."?u.splice(k,1):E===".."?(u.splice(k,1),g++):g&&(u.splice(k,1),g--)}if(h)for(;g;g--)u.unshift("..");return u},C=u=>{var h=u.charAt(0)==="/",g=u.substr(-1)==="/";return(u=y(u.split("/").filter(k=>!!k),!h).join("/"))||h||(u="."),u&&g&&(u+="/"),(h?"/":"")+u},O=u=>{var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(u).slice(1);return u=h[0],h=h[1],!u&&!h?".":(h&&(h=h.substr(0,h.length-1)),u+h)},W=u=>{if(u==="/")return"/";u=C(u),u=u.replace(/\/$/,"");var h=u.lastIndexOf("/");return h===-1?u:u.substr(h+1)},se=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return u=>crypto.getRandomValues(u);pn("initRandomDevice")},be=u=>(be=se())(u);function Ge(){for(var u="",h=!1,g=arguments.length-1;-1<=g&&!h;g--){if(h=0<=g?arguments[g]:"/",typeof h!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!h)return"";u=h+"/"+u,h=h.charAt(0)==="/"}return u=y(u.split("/").filter(k=>!!k),!h).join("/"),(h?"/":"")+u||"."}var it=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ne=(u,h,g)=>{var k=h+g;for(g=h;u[g]&&!(g>=k);)++g;if(16<g-h&&u.buffer&&it)return it.decode(u.subarray(h,g));for(k="";h<g;){var E=u[h++];if(E&128){var I=u[h++]&63;if((E&224)==192)k+=String.fromCharCode((E&31)<<6|I);else{var D=u[h++]&63;E=(E&240)==224?(E&15)<<12|I<<6|D:(E&7)<<18|I<<12|D<<6|u[h++]&63,65536>E?k+=String.fromCharCode(E):(E-=65536,k+=String.fromCharCode(55296|E>>10,56320|E&1023))}}else k+=String.fromCharCode(E)}return k},at=[],Ct=u=>{for(var h=0,g=0;g<u.length;++g){var k=u.charCodeAt(g);127>=k?h++:2047>=k?h+=2:55296<=k&&57343>=k?(h+=4,++g):h+=3}return h},qt=(u,h,g,k)=>{if(!(0<k))return 0;var E=g;k=g+k-1;for(var I=0;I<u.length;++I){var D=u.charCodeAt(I);if(55296<=D&&57343>=D){var q=u.charCodeAt(++I);D=65536+((D&1023)<<10)|q&1023}if(127>=D){if(g>=k)break;h[g++]=D}else{if(2047>=D){if(g+1>=k)break;h[g++]=192|D>>6}else{if(65535>=D){if(g+2>=k)break;h[g++]=224|D>>12}else{if(g+3>=k)break;h[g++]=240|D>>18,h[g++]=128|D>>12&63}h[g++]=128|D>>6&63}h[g++]=128|D&63}}return h[g]=0,g-E};function St(u,h){var g=Array(Ct(u)+1);return u=qt(u,g,0,g.length),h&&(g.length=u),g}var jn=[];function Tn(u,h){jn[u]={input:[],G:[],V:h},Oo(u,mn)}var mn={open:function(u){var h=jn[u.node.Fa];if(!h)throw new je(43);u.s=h,u.seekable=!1},close:function(u){u.s.V.ua(u.s)},ua:function(u){u.s.V.ua(u.s)},read:function(u,h,g,k){if(!u.s||!u.s.V.jb)throw new je(60);for(var E=0,I=0;I<k;I++){try{var D=u.s.V.jb(u.s)}catch{throw new je(29)}if(D===void 0&&E===0)throw new je(6);if(D==null)break;E++,h[g+I]=D}return E&&(u.node.timestamp=Date.now()),E},write:function(u,h,g,k){if(!u.s||!u.s.V.Ua)throw new je(60);try{for(var E=0;E<k;E++)u.s.V.Ua(u.s,h[g+E])}catch{throw new je(29)}return k&&(u.node.timestamp=Date.now()),E}},Yt={jb:function(){e:{if(!at.length){var u=null;if(typeof window<"u"&&typeof window.prompt=="function"?(u=window.prompt("Input: "),u!==null&&(u+=`
`)):typeof readline=="function"&&(u=readline(),u!==null&&(u+=`
`)),!u){u=null;break e}at=St(u,!0)}u=at.shift()}return u},Ua:function(u,h){h===null||h===10?(Y(Ne(u.G,0)),u.G=[]):h!=0&&u.G.push(h)},ua:function(u){u.G&&0<u.G.length&&(Y(Ne(u.G,0)),u.G=[])},$b:function(){return{xc:25856,zc:5,wc:191,yc:35387,vc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ac:function(){return 0},bc:function(){return[24,80]}},nn={Ua:function(u,h){h===null||h===10?(me(Ne(u.G,0)),u.G=[]):h!=0&&u.G.push(h)},ua:function(u){u.G&&0<u.G.length&&(me(Ne(u.G,0)),u.G=[])}};function br(u,h){var g=u.j?u.j.length:0;g>=h||(h=Math.max(h,g*(1048576>g?2:1.125)>>>0),g!=0&&(h=Math.max(h,256)),g=u.j,u.j=new Uint8Array(h),0<u.v&&u.j.set(g.subarray(0,u.v),0))}var Je={O:null,U(){return Je.createNode(null,"/",16895,0)},createNode(u,h,g,k){if((g&61440)===24576||(g&61440)===4096)throw new je(63);return Je.O||(Je.O={dir:{node:{Y:Je.l.Y,P:Je.l.P,ma:Je.l.ma,Ca:Je.l.Ca,vb:Je.l.vb,Ab:Je.l.Ab,wb:Je.l.wb,tb:Je.l.tb,Ia:Je.l.Ia},stream:{ba:Je.m.ba}},file:{node:{Y:Je.l.Y,P:Je.l.P},stream:{ba:Je.m.ba,read:Je.m.read,write:Je.m.write,ta:Je.m.ta,lb:Je.m.lb,nb:Je.m.nb}},link:{node:{Y:Je.l.Y,P:Je.l.P,na:Je.l.na},stream:{}},bb:{node:{Y:Je.l.Y,P:Je.l.P},stream:uc}}),g=oc(u,h,g,k),(g.mode&61440)===16384?(g.l=Je.O.dir.node,g.m=Je.O.dir.stream,g.j={}):(g.mode&61440)===32768?(g.l=Je.O.file.node,g.m=Je.O.file.stream,g.v=0,g.j=null):(g.mode&61440)===40960?(g.l=Je.O.link.node,g.m=Je.O.link.stream):(g.mode&61440)===8192&&(g.l=Je.O.bb.node,g.m=Je.O.bb.stream),g.timestamp=Date.now(),u&&(u.j[h]=g,u.timestamp=g.timestamp),g},Ec(u){return u.j?u.j.subarray?u.j.subarray(0,u.v):new Uint8Array(u.j):new Uint8Array(0)},l:{Y(u){var h={};return h.Cc=(u.mode&61440)===8192?u.id:1,h.Gc=u.id,h.mode=u.mode,h.Lc=1,h.uid=0,h.Fc=0,h.Fa=u.Fa,(u.mode&61440)===16384?h.size=4096:(u.mode&61440)===32768?h.size=u.v:(u.mode&61440)===40960?h.size=u.link.length:h.size=0,h.tc=new Date(u.timestamp),h.Jc=new Date(u.timestamp),h.Ac=new Date(u.timestamp),h.Ib=4096,h.uc=Math.ceil(h.size/h.Ib),h},P(u,h){if(h.mode!==void 0&&(u.mode=h.mode),h.timestamp!==void 0&&(u.timestamp=h.timestamp),h.size!==void 0&&(h=h.size,u.v!=h))if(h==0)u.j=null,u.v=0;else{var g=u.j;u.j=new Uint8Array(h),g&&u.j.set(g.subarray(0,Math.min(h,u.v))),u.v=h}},ma(){throw Ds[44]},Ca(u,h,g,k){return Je.createNode(u,h,g,k)},vb(u,h,g){if((u.mode&61440)===16384){try{var k=Ki(h,g)}catch{}if(k)for(var E in k.j)throw new je(55)}delete u.parent.j[u.name],u.parent.timestamp=Date.now(),u.name=g,h.j[g]=u,h.timestamp=u.parent.timestamp,u.parent=h},Ab(u,h){delete u.j[h],u.timestamp=Date.now()},wb(u,h){var g=Ki(u,h),k;for(k in g.j)throw new je(55);delete u.j[h],u.timestamp=Date.now()},tb(u){var h=[".",".."],g;for(g in u.j)u.j.hasOwnProperty(g)&&h.push(g);return h},Ia(u,h,g){return u=Je.createNode(u,h,41471,0),u.link=g,u},na(u){if((u.mode&61440)!==40960)throw new je(28);return u.link}},m:{read(u,h,g,k,E){var I=u.node.j;if(E>=u.node.v)return 0;if(u=Math.min(u.node.v-E,k),8<u&&I.subarray)h.set(I.subarray(E,E+u),g);else for(k=0;k<u;k++)h[g+k]=I[E+k];return u},write(u,h,g,k,E,I){if(h.buffer===Ee.buffer&&(I=!1),!k)return 0;if(u=u.node,u.timestamp=Date.now(),h.subarray&&(!u.j||u.j.subarray)){if(I)return u.j=h.subarray(g,g+k),u.v=k;if(u.v===0&&E===0)return u.j=h.slice(g,g+k),u.v=k;if(E+k<=u.v)return u.j.set(h.subarray(g,g+k),E),k}if(br(u,E+k),u.j.subarray&&h.subarray)u.j.set(h.subarray(g,g+k),E);else for(I=0;I<k;I++)u.j[E+I]=h[g+I];return u.v=Math.max(u.v,E+k),k},ba(u,h,g){if(g===1?h+=u.position:g===2&&(u.node.mode&61440)===32768&&(h+=u.node.v),0>h)throw new je(28);return h},ta(u,h,g){br(u.node,h+g),u.node.v=Math.max(u.node.v,h+g)},lb(u,h,g,k,E){if((u.node.mode&61440)!==32768)throw new je(43);if(u=u.node.j,E&2||u.buffer!==Ee.buffer){if((0<g||g+h<u.length)&&(u.subarray?u=u.subarray(g,g+h):u=Array.prototype.slice.call(u,g,g+h)),g=!0,pn(),h=void 0,!h)throw new je(48);Ee.set(u,h)}else g=!1,h=u.byteOffset;return{o:h,M:g}},nb(u,h,g,k){return Je.m.write(u,h,0,k,g,!1),0}}};function yr(u,h){var g=0;return u&&(g|=365),h&&(g|=146),g}var Dn=null,ut={},Un=[],ac=1,Nr=null,Ro=!0,je=null,Ds={},ar=(u,h={})=>{if(u=Ge(u),!u)return{path:"",node:null};if(h=Object.assign({hb:!0,Wa:0},h),8<h.Wa)throw new je(32);u=u.split("/").filter(D=>!!D);for(var g=Dn,k="/",E=0;E<u.length;E++){var I=E===u.length-1;if(I&&h.parent)break;if(g=Ki(g,u[E]),k=C(k+"/"+u[E]),g.Da&&(!I||I&&h.hb)&&(g=g.Da.root),!I||h.gb){for(I=0;(g.mode&61440)===40960;)if(g=Ft(k),k=Ge(O(k),g),g=ar(k,{Wa:h.Wa+1}).node,40<I++)throw new je(32)}}return{path:k,node:g}},Ia=u=>{for(var h;;){if(u===u.parent)return u=u.U.mb,h?u[u.length-1]!=="/"?`${u}/${h}`:u+h:u;h=h?`${u.name}/${h}`:u.name,u=u.parent}},Oa=(u,h)=>{for(var g=0,k=0;k<h.length;k++)g=(g<<5)-g+h.charCodeAt(k)|0;return(u+g>>>0)%Nr.length},Ki=(u,h)=>{var g;if(g=(g=Io(u,"x"))?g:u.l.ma?0:2)throw new je(g,u);for(g=Nr[Oa(u.id,h)];g;g=g.ec){var k=g.name;if(g.parent.id===u.id&&k===h)return g}return u.l.ma(u,h)},oc=(u,h,g,k)=>(u=new Ko(u,h,g,k),h=Oa(u.parent.id,u.name),u.ec=Nr[h],Nr[h]=u),sc=u=>{var h=["r","w","rw"][u&3];return u&512&&(h+="w"),h},Io=(u,h)=>{if(Ro)return 0;if(!h.includes("r")||u.mode&292){if(h.includes("w")&&!(u.mode&146)||h.includes("x")&&!(u.mode&73))return 2}else return 2;return 0},ii=(u,h)=>{try{return Ki(u,h),20}catch{}return Io(u,"wx")},lc=()=>{for(var u=0;4096>=u;u++)if(!Un[u])return u;throw new je(33)},jr=u=>{if(u=Un[u],!u)throw new je(8);return u},cc=(u,h=-1)=>(xn||(xn=function(){this.h={}},xn.prototype={},Object.defineProperties(xn.prototype,{object:{get(){return this.node},set(g){this.node=g}},flags:{get(){return this.h.flags},set(g){this.h.flags=g}},position:{get(){return this.h.position},set(g){this.h.position=g}}})),u=Object.assign(new xn,u),h==-1&&(h=lc()),u.X=h,Un[h]=u),uc={open:u=>{u.m=ut[u.node.Fa].m,u.m.open&&u.m.open(u)},ba:()=>{throw new je(70)}},Oo=(u,h)=>{ut[u]={m:h}},Us=(u,h)=>{var g=h==="/",k=!h;if(g&&Dn)throw new je(10);if(!g&&!k){var E=ar(h,{hb:!1});if(h=E.path,E=E.node,E.Da)throw new je(10);if((E.mode&61440)!==16384)throw new je(54)}h={type:u,Nc:{},mb:h,dc:[]},u=u.U(h),u.U=h,h.root=u,g?Dn=u:E&&(E.Da=h,E.U&&E.U.dc.push(h))},Wn=(u,h,g)=>{var k=ar(u,{parent:!0}).node;if(u=W(u),!u||u==="."||u==="..")throw new je(28);var E=ii(k,u);if(E)throw new je(E);if(!k.l.Ca)throw new je(63);return k.l.Ca(k,u,h,g)},Mo=(u,h,g)=>{typeof g>"u"&&(g=h,h=438),Wn(u,h|8192,g)},Fs=(u,h)=>{if(!Ge(u))throw new je(44);var g=ar(h,{parent:!0}).node;if(!g)throw new je(44);h=W(h);var k=ii(g,h);if(k)throw new je(k);if(!g.l.Ia)throw new je(63);g.l.Ia(g,h,u)},Ft=u=>{if(u=ar(u).node,!u)throw new je(44);if(!u.l.na)throw new je(28);return Ge(Ia(u.parent),u.l.na(u))},Ao=(u,h,g)=>{if(u==="")throw new je(44);if(typeof h=="string"){var k={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[h];if(typeof k>"u")throw Error(`Unknown file open mode: ${h}`);h=k}if(g=h&64?(typeof g>"u"?438:g)&4095|32768:0,typeof u=="object")var E=u;else{u=C(u);try{E=ar(u,{gb:!(h&131072)}).node}catch{}}if(k=!1,h&64)if(E){if(h&128)throw new je(20)}else E=Wn(u,g,0),k=!0;if(!E)throw new je(44);if((E.mode&61440)===8192&&(h&=-513),h&65536&&(E.mode&61440)!==16384)throw new je(54);if(!k&&(g=E?(E.mode&61440)===40960?32:(E.mode&61440)===16384&&(sc(h)!=="r"||h&512)?31:Io(E,sc(h)):44))throw new je(g);if(h&512&&!k){if(g=E,g=typeof g=="string"?ar(g,{gb:!0}).node:g,!g.l.P)throw new je(63);if((g.mode&61440)===16384)throw new je(31);if((g.mode&61440)!==32768)throw new je(28);if(k=Io(g,"w"))throw new je(k);g.l.P(g,{size:0,timestamp:Date.now()})}return h&=-131713,E=cc({node:E,path:Ia(E),flags:h,seekable:!0,position:0,m:E.m,sc:[],error:!1}),E.m.open&&E.m.open(E),!S.logReadFiles||h&1||(jo||(jo={}),u in jo||(jo[u]=1)),E},Lo=(u,h,g)=>{if(u.X===null)throw new je(8);if(!u.seekable||!u.m.ba)throw new je(70);if(g!=0&&g!=1&&g!=2)throw new je(28);u.position=u.m.ba(u,h,g),u.sc=[]},Bs=()=>{je||(je=function(u,h){this.name="ErrnoError",this.node=h,this.ic=function(g){this.aa=g},this.ic(u),this.message="FS error"},je.prototype=Error(),je.prototype.constructor=je,[44].forEach(u=>{Ds[u]=new je(u),Ds[u].stack="<generic error, no stack>"}))},Ma,Aa=(u,h,g)=>{u=C("/dev/"+u);var k=yr(!!h,!!g);No||(No=64);var E=No++<<8|0;Oo(E,{open:I=>{I.seekable=!1},close:()=>{g&&g.buffer&&g.buffer.length&&g(10)},read:(I,D,q,re)=>{for(var G=0,Ce=0;Ce<re;Ce++){try{var Ie=h()}catch{throw new je(29)}if(Ie===void 0&&G===0)throw new je(6);if(Ie==null)break;G++,D[q+Ce]=Ie}return G&&(I.node.timestamp=Date.now()),G},write:(I,D,q,re)=>{for(var G=0;G<re;G++)try{g(D[q+G])}catch{throw new je(29)}return re&&(I.node.timestamp=Date.now()),G}}),Mo(u,k,E)},No,wr={},xn,jo,gn=void 0;function Dr(){return gn+=4,L[gn-4>>2]}function dc(u){if(u===void 0)return"_unknown";u=u.replace(/[^a-zA-Z0-9_]/g,"$");var h=u.charCodeAt(0);return 48<=h&&57>=h?`_${u}`:u}function Do(u,h){return u=dc(u),{[u]:function(){return h.apply(this,arguments)}}[u]}function La(){this.M=[void 0],this.ib=[]}var vn=new La,kr=void 0;function rt(u){throw new kr(u)}var or=u=>(u||rt("Cannot use deleted val. handle = "+u),vn.get(u).value),Cr=u=>{switch(u){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return vn.ta({ub:1,value:u})}};function Uo(u){var h=Error,g=Do(u,function(k){this.name=u,this.message=k,k=Error(k).stack,k!==void 0&&(this.stack=this.toString()+`
`+k.replace(/^Error(:[^\n]*)?\n/,""))});return g.prototype=Object.create(h.prototype),g.prototype.constructor=g,g.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},g}var zs=void 0,Fo=void 0;function Tt(u){for(var h="";ce[u];)h+=Fo[ce[u++]];return h}var Na=[];function ja(){for(;Na.length;){var u=Na.pop();u.g.ia=!1,u.delete()}}var dt=void 0,Sr={};function Bo(u,h){for(h===void 0&&rt("ptr should not be undefined");u.A;)h=u.pa(h),u=u.A;return h}var Ur={};function Vs(u){u=al(u);var h=Tt(u);return Vr(u),h}function Zi(u,h){var g=Ur[u];return g===void 0&&rt(h+" has unknown type "+Vs(u)),g}function Da(){}var Ua=!1;function Fa(u){--u.count.value,u.count.value===0&&(u.H?u.L.W(u.H):u.u.i.W(u.o))}function Fr(u,h,g){return h===g?u:g.A===void 0?null:(u=Fr(u,h,g.A),u===null?null:g.Mb(u))}var Br={};function ai(u,h){return h=Bo(u,h),Sr[h]}var Qi=void 0;function oi(u){throw new Qi(u)}function sr(u,h){return h.u&&h.o||oi("makeClassHandle requires ptr and ptrType"),!!h.L!=!!h.H&&oi("Both smartPtrType and smartPtr must be specified"),h.count={value:1},Xi(Object.create(u,{g:{value:h}}))}function Xi(u){return typeof FinalizationRegistry>"u"?(Xi=h=>h,u):(Ua=new FinalizationRegistry(h=>{Fa(h.g)}),Xi=h=>{var g=h.g;return g.H&&Ua.register(h,{g},h),h},Da=h=>{Ua.unregister(h)},Xi(u))}var Ba={};function zr(u){for(;u.length;){var h=u.pop();u.pop()(h)}}function za(u){return this.fromWireType(L[u>>2])}var Pi={},_i={};function En(u,h,g){function k(q){q=g(q),q.length!==u.length&&oi("Mismatched type converter count");for(var re=0;re<u.length;++re)Pn(u[re],q[re])}u.forEach(function(q){_i[q]=h});var E=Array(h.length),I=[],D=0;h.forEach((q,re)=>{Ur.hasOwnProperty(q)?E[re]=Ur[q]:(I.push(q),Pi.hasOwnProperty(q)||(Pi[q]=[]),Pi[q].push(()=>{E[re]=Ur[q],++D,D===I.length&&k(E)}))}),I.length===0&&k(E)}function zo(u){switch(u){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${u}`)}}function Va(u,h,g={}){var k=h.name;if(u||rt(`type "${k}" must have a positive integer typeid pointer`),Ur.hasOwnProperty(u)){if(g.Xb)return;rt(`Cannot register type '${k}' twice`)}Ur[u]=h,delete _i[u],Pi.hasOwnProperty(u)&&(h=Pi[u],delete Pi[u],h.forEach(E=>E()))}function Pn(u,h,g={}){if(!("argPackAdvance"in h))throw new TypeError("registerType registeredInstance requires argPackAdvance");Va(u,h,g)}function si(u){rt(u.g.u.i.name+" instance already deleted")}function lr(){}function Hs(u,h,g){if(u[h].B===void 0){var k=u[h];u[h]=function(){return u[h].B.hasOwnProperty(arguments.length)||rt(`Function '${g}' called with an invalid number of arguments (${arguments.length}) - expects one of (${u[h].B})!`),u[h].B[arguments.length].apply(this,arguments)},u[h].B=[],u[h].B[k.ha]=k}}function qs(u,h,g){S.hasOwnProperty(u)?((g===void 0||S[u].B!==void 0&&S[u].B[g]!==void 0)&&rt(`Cannot register public name '${u}' twice`),Hs(S,u,u),S.hasOwnProperty(g)&&rt(`Cannot register multiple overloads of a function with the same number of arguments (${g})!`),S[u].B[g]=h):(S[u]=h,g!==void 0&&(S[u].Mc=g))}function $s(u,h,g,k,E,I,D,q){this.name=u,this.constructor=h,this.N=g,this.W=k,this.A=E,this.Rb=I,this.pa=D,this.Mb=q,this.qb=[]}function Ri(u,h,g){for(;h!==g;)h.pa||rt(`Expected null or instance of ${g.name}, got an instance of ${h.name}`),u=h.pa(u),h=h.A;return u}function Ws(u,h){return h===null?(this.Ta&&rt(`null is not a valid ${this.name}`),0):(h.g||rt(`Cannot pass "${Ii(h)}" as a ${this.name}`),h.g.o||rt(`Cannot pass deleted object as a pointer of type ${this.name}`),Ri(h.g.o,h.g.u.i,this.i))}function hc(u,h){if(h===null){if(this.Ta&&rt(`null is not a valid ${this.name}`),this.ya){var g=this.Va();return u!==null&&u.push(this.W,g),g}return 0}if(h.g||rt(`Cannot pass "${Ii(h)}" as a ${this.name}`),h.g.o||rt(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.xa&&h.g.u.xa&&rt(`Cannot convert argument of type ${h.g.L?h.g.L.name:h.g.u.name} to parameter type ${this.name}`),g=Ri(h.g.o,h.g.u.i,this.i),this.ya)switch(h.g.H===void 0&&rt("Passing raw pointer to smart pointer is illegal"),this.mc){case 0:h.g.L===this?g=h.g.H:rt(`Cannot convert argument of type ${h.g.L?h.g.L.name:h.g.u.name} to parameter type ${this.name}`);break;case 1:g=h.g.H;break;case 2:if(h.g.L===this)g=h.g.H;else{var k=h.clone();g=this.hc(g,Cr(function(){k.delete()})),u!==null&&u.push(this.W,g)}break;default:rt("Unsupporting sharing policy")}return g}function li(u,h){return h===null?(this.Ta&&rt(`null is not a valid ${this.name}`),0):(h.g||rt(`Cannot pass "${Ii(h)}" as a ${this.name}`),h.g.o||rt(`Cannot pass deleted object as a pointer of type ${this.name}`),h.g.u.xa&&rt(`Cannot convert argument of type ${h.g.u.name} to parameter type ${this.name}`),Ri(h.g.o,h.g.u.i,this.i))}function cr(u,h,g,k){this.name=u,this.i=h,this.Ta=g,this.xa=k,this.ya=!1,this.W=this.hc=this.Va=this.sb=this.mc=this.fc=void 0,h.A!==void 0?this.toWireType=hc:(this.toWireType=k?Ws:li,this.K=null)}function Ha(u,h,g){S.hasOwnProperty(u)||oi("Replacing nonexistant public symbol"),S[u].B!==void 0&&g!==void 0?S[u].B[g]=h:(S[u]=h,S[u].ha=g)}var qa=[],$a=u=>{var h=qa[u];return h||(u>=qa.length&&(qa.length=u+1),qa[u]=h=ze.get(u)),h},Vo=(u,h)=>{var g=[];return function(){if(g.length=0,Object.assign(g,arguments),u.includes("j")){var k=S["dynCall_"+u];k=g&&g.length?k.apply(null,[h].concat(g)):k.call(null,h)}else k=$a(h).apply(null,g);return k}};function rn(u,h){u=Tt(u);var g=u.includes("j")?Vo(u,h):$a(h);return typeof g!="function"&&rt(`unknown function pointer with signature ${u}: ${h}`),g}var _n=void 0;function Rn(u,h){function g(I){E[I]||Ur[I]||(_i[I]?_i[I].forEach(g):(k.push(I),E[I]=!0))}var k=[],E={};throw h.forEach(g),new _n(`${u}: `+k.map(Vs).join([", "]))}function Ji(u,h,g,k,E){var I=h.length;2>I&&rt("argTypes array size mismatch! Must at least get return value and 'this' types!");var D=h[1]!==null&&g!==null,q=!1;for(g=1;g<h.length;++g)if(h[g]!==null&&h[g].K===void 0){q=!0;break}var re=h[0].name!=="void",G=I-2,Ce=Array(G),Ie=[],Ue=[];return function(){if(arguments.length!==G&&rt(`function ${u} called with ${arguments.length} arguments, expected ${G} args!`),Ue.length=0,Ie.length=D?2:1,Ie[0]=E,D){var Q=h[1].toWireType(Ue,this);Ie[1]=Q}for(var fe=0;fe<G;++fe)Ce[fe]=h[fe+2].toWireType(Ue,arguments[fe]),Ie.push(Ce[fe]);if(fe=k.apply(null,Ie),q)zr(Ue);else for(var Pe=D?1:2;Pe<h.length;Pe++){var He=Pe===1?Q:Ce[Pe-2];h[Pe].K!==null&&h[Pe].K(He)}return Q=re?h[0].fromWireType(fe):void 0,Q}}function ci(u,h){for(var g=[],k=0;k<u;k++)g.push(ee[h+4*k>>2]);return g}function pc(u,h,g){return u instanceof Object||rt(`${g} with invalid "this": ${u}`),u instanceof h.i.constructor||rt(`${g} incompatible with "this" of type ${u.constructor.name}`),u.g.o||rt(`cannot call emscripten binding method ${g} on deleted object`),Ri(u.g.o,u.g.u.i,h.i)}function Wa(u){u>=vn.h&&--vn.get(u).ub===0&&vn.Wb(u)}function Gs(u,h,g){switch(h){case 0:return function(k){return this.fromWireType((g?Ee:ce)[k])};case 1:return function(k){return this.fromWireType((g?Re:ue)[k>>1])};case 2:return function(k){return this.fromWireType((g?L:ee)[k>>2])};default:throw new TypeError("Unknown integer type: "+u)}}function Ii(u){if(u===null)return"null";var h=typeof u;return h==="object"||h==="array"||h==="function"?u.toString():""+u}function Ho(u,h){switch(h){case 2:return function(g){return this.fromWireType(We[g>>2])};case 3:return function(g){return this.fromWireType(Ke[g>>3])};default:throw new TypeError("Unknown float type: "+u)}}function fc(u,h,g){switch(h){case 0:return g?function(k){return Ee[k]}:function(k){return ce[k]};case 1:return g?function(k){return Re[k>>1]}:function(k){return ue[k>>1]};case 2:return g?function(k){return L[k>>2]}:function(k){return ee[k>>2]};default:throw new TypeError("Unknown integer type: "+u)}}var mc=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,kd=(u,h)=>{for(var g=u>>1,k=g+h/2;!(g>=k)&&ue[g];)++g;if(g<<=1,32<g-u&&mc)return mc.decode(ce.subarray(u,g));for(g="",k=0;!(k>=h/2);++k){var E=Re[u+2*k>>1];if(E==0)break;g+=String.fromCharCode(E)}return g},Cd=(u,h,g)=>{if(g===void 0&&(g=2147483647),2>g)return 0;g-=2;var k=h;g=g<2*u.length?g/2:u.length;for(var E=0;E<g;++E)Re[h>>1]=u.charCodeAt(E),h+=2;return Re[h>>1]=0,h-k},Ks=u=>2*u.length,Sd=(u,h)=>{for(var g=0,k="";!(g>=h/4);){var E=L[u+4*g>>2];if(E==0)break;++g,65536<=E?(E-=65536,k+=String.fromCharCode(55296|E>>10,56320|E&1023)):k+=String.fromCharCode(E)}return k},Td=(u,h,g)=>{if(g===void 0&&(g=2147483647),4>g)return 0;var k=h;g=k+g-4;for(var E=0;E<u.length;++E){var I=u.charCodeAt(E);if(55296<=I&&57343>=I){var D=u.charCodeAt(++E);I=65536+((I&1023)<<10)|D&1023}if(L[h>>2]=I,h+=4,h+4>g)break}return L[h>>2]=0,h-k},xd=u=>{for(var h=0,g=0;g<u.length;++g){var k=u.charCodeAt(g);55296<=k&&57343>=k&&++g,h+=4}return h},Ed={};function Zs(u){var h=Ed[u];return h===void 0?Tt(u):h}var Ga=[];function Pd(u){var h=Ga.length;return Ga.push(u),h}function _d(u,h){for(var g=Array(u),k=0;k<u;++k)g[k]=Zi(ee[h+4*k>>2],"parameter "+k);return g}var gc=[],Qs=[];function qo(u){u.Dc=u.getExtension("WEBGL_draw_instanced_base_vertex_base_instance")}function vc(u){u.Ic=u.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance")}var bc=1,Ka=[],Gn=[],$o=[],Za=[],Yi=[],Tr=[],Wo=[],Zt=[],yc={};function Qt(u){Qa||(Qa=u)}function ui(u){for(var h=bc++,g=u.length;g<h;g++)u[g]=null;return h}function Rd(u,h){var g=ui(Zt),k={handle:g,attributes:h,version:h.Hc,C:u};return u.canvas&&(u.canvas.Cb=k),Zt[g]=k,(typeof h.Nb>"u"||h.Nb)&&wc(k),g}function Go(u){return ur=Zt[u],S.Bc=he=ur&&ur.C,!(u&&!he)}function wc(u){if(u||(u=ur),!u.Yb){u.Yb=!0;var h=u.C;qo(h),vc(h),2<=u.version&&(h.eb=h.getExtension("EXT_disjoint_timer_query_webgl2")),(2>u.version||!h.eb)&&(h.eb=h.getExtension("EXT_disjoint_timer_query")),Xs(h),(h.getSupportedExtensions()||[]).forEach(function(g){g.includes("lose_context")||g.includes("debug")||h.getExtension(g)})}}var Qa,ur;function Xs(u){u.Kc=u.getExtension("WEBGL_multi_draw")}var di={},kc=()=>{if(!Js){var u={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:F||"./this.program"},h;for(h in di)di[h]===void 0?delete u[h]:u[h]=di[h];var g=[];for(h in u)g.push(`${h}=${u[h]}`);Js=g}return Js},Js,Ys=[];function ea(u,h,g,k){for(var E=0;E<u;E++){var I=he[g](),D=I&&ui(k);I?(I.name=D,k[D]=I):Qt(1282),L[h+4*E>>2]=D}}function Cc(u,h){if(h){var g=void 0;switch(u){case 36346:g=1;break;case 36344:return;case 34814:case 36345:g=0;break;case 34466:var k=he.getParameter(34467);g=k?k.length:0;break;case 33309:if(2>ur.version){Qt(1282);return}g=2*(he.getSupportedExtensions()||[]).length;break;case 33307:case 33308:if(2>ur.version){Qt(1280);return}g=u==33307?3:0}if(g===void 0)switch(k=he.getParameter(u),typeof k){case"number":g=k;break;case"boolean":g=k?1:0;break;case"string":Qt(1280);return;case"object":if(k===null)switch(u){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:g=0;break;default:Qt(1280);return}else{if(k instanceof Float32Array||k instanceof Uint32Array||k instanceof Int32Array||k instanceof Array){for(u=0;u<k.length;++u)L[h+4*u>>2]=k[u];return}try{g=k.name|0}catch(E){Qt(1280),me("GL_INVALID_ENUM in glGet0v: Unknown object returned from WebGL getParameter("+u+")! (error: "+E+")");return}}break;default:Qt(1280),me("GL_INVALID_ENUM in glGet0v: Native code calling glGet0v("+u+") and it returns "+k+" of type "+typeof k+"!");return}L[h>>2]=g}else Qt(1281)}var hi=u=>{var h=Ct(u)+1,g=Zo(h);return g&&qt(u,ce,g,h),g};function ta(u){return u.slice(-1)=="]"&&u.lastIndexOf("[")}function Sc(u){return u-=5120,u==0?Ee:u==1?ce:u==2?Re:u==4?L:u==6?We:u==5||u==28922||u==28520||u==30779||u==30782?ee:ue}var Oi=u=>u%4===0&&(u%100!==0||u%400===0),Tc=[31,29,31,30,31,30,31,31,30,31,30,31],el=[31,28,31,30,31,30,31,31,30,31,30,31],tl=(u,h,g,k)=>{function E(Q,fe,Pe){for(Q=typeof Q=="number"?Q.toString():Q||"";Q.length<fe;)Q=Pe[0]+Q;return Q}function I(Q,fe){return E(Q,fe,"0")}function D(Q,fe){function Pe(Ze){return 0>Ze?-1:0<Ze?1:0}var He;return(He=Pe(Q.getFullYear()-fe.getFullYear()))===0&&(He=Pe(Q.getMonth()-fe.getMonth()))===0&&(He=Pe(Q.getDate()-fe.getDate())),He}function q(Q){switch(Q.getDay()){case 0:return new Date(Q.getFullYear()-1,11,29);case 1:return Q;case 2:return new Date(Q.getFullYear(),0,3);case 3:return new Date(Q.getFullYear(),0,2);case 4:return new Date(Q.getFullYear(),0,1);case 5:return new Date(Q.getFullYear()-1,11,31);case 6:return new Date(Q.getFullYear()-1,11,30)}}function re(Q){var fe=Q.da;for(Q=new Date(new Date(Q.ea+1900,0,1).getTime());0<fe;){var Pe=Q.getMonth(),He=(Oi(Q.getFullYear())?Tc:el)[Pe];if(fe>He-Q.getDate())fe-=He-Q.getDate()+1,Q.setDate(1),11>Pe?Q.setMonth(Pe+1):(Q.setMonth(0),Q.setFullYear(Q.getFullYear()+1));else{Q.setDate(Q.getDate()+fe);break}}return Pe=new Date(Q.getFullYear()+1,0,4),fe=q(new Date(Q.getFullYear(),0,4)),Pe=q(Pe),0>=D(fe,Q)?0>=D(Pe,Q)?Q.getFullYear()+1:Q.getFullYear():Q.getFullYear()-1}var G=L[k+40>>2];k={pc:L[k>>2],oc:L[k+4>>2],Ja:L[k+8>>2],Xa:L[k+12>>2],Ka:L[k+16>>2],ea:L[k+20>>2],R:L[k+24>>2],da:L[k+28>>2],Pc:L[k+32>>2],nc:L[k+36>>2],qc:G&&G?Ne(ce,G):""},g=g?Ne(ce,g):"",G={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var Ce in G)g=g.replace(new RegExp(Ce,"g"),G[Ce]);var Ie="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ue="January February March April May June July August September October November December".split(" ");G={"%a":Q=>Ie[Q.R].substring(0,3),"%A":Q=>Ie[Q.R],"%b":Q=>Ue[Q.Ka].substring(0,3),"%B":Q=>Ue[Q.Ka],"%C":Q=>I((Q.ea+1900)/100|0,2),"%d":Q=>I(Q.Xa,2),"%e":Q=>E(Q.Xa,2," "),"%g":Q=>re(Q).toString().substring(2),"%G":Q=>re(Q),"%H":Q=>I(Q.Ja,2),"%I":Q=>(Q=Q.Ja,Q==0?Q=12:12<Q&&(Q-=12),I(Q,2)),"%j":Q=>{for(var fe=0,Pe=0;Pe<=Q.Ka-1;fe+=(Oi(Q.ea+1900)?Tc:el)[Pe++]);return I(Q.Xa+fe,3)},"%m":Q=>I(Q.Ka+1,2),"%M":Q=>I(Q.oc,2),"%n":()=>`
`,"%p":Q=>0<=Q.Ja&&12>Q.Ja?"AM":"PM","%S":Q=>I(Q.pc,2),"%t":()=>"	","%u":Q=>Q.R||7,"%U":Q=>I(Math.floor((Q.da+7-Q.R)/7),2),"%V":Q=>{var fe=Math.floor((Q.da+7-(Q.R+6)%7)/7);if(2>=(Q.R+371-Q.da-2)%7&&fe++,fe)fe==53&&(Pe=(Q.R+371-Q.da)%7,Pe==4||Pe==3&&Oi(Q.ea)||(fe=1));else{fe=52;var Pe=(Q.R+7-Q.da-1)%7;(Pe==4||Pe==5&&Oi(Q.ea%400-1))&&fe++}return I(fe,2)},"%w":Q=>Q.R,"%W":Q=>I(Math.floor((Q.da+7-(Q.R+6)%7)/7),2),"%y":Q=>(Q.ea+1900).toString().substring(2),"%Y":Q=>Q.ea+1900,"%z":Q=>{Q=Q.nc;var fe=0<=Q;return Q=Math.abs(Q)/60,(fe?"+":"-")+("0000"+(Q/60*100+Q%60)).slice(-4)},"%Z":Q=>Q.qc,"%%":()=>"%"},g=g.replace(/%%/g,"\0\0");for(Ce in G)g.includes(Ce)&&(g=g.replace(new RegExp(Ce,"g"),G[Ce](k)));return g=g.replace(/\0\0/g,"%"),Ce=St(g,!1),Ce.length>h?0:(Ee.set(Ce,u),Ce.length-1)};function Ko(u,h,g,k){u||(u=this),this.parent=u,this.U=u.U,this.Da=null,this.id=ac++,this.name=h,this.mode=g,this.l={},this.m={},this.Fa=k}Object.defineProperties(Ko.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(u){u?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(u){u?this.mode|=146:this.mode&=-147}}}),Bs(),Nr=Array(4096),Us(Je,"/"),Wn("/tmp",16895,0),Wn("/home",16895,0),Wn("/home/web_user",16895,0),(()=>{Wn("/dev",16895,0),Oo(259,{read:()=>0,write:(k,E,I,D)=>D}),Mo("/dev/null",259),Tn(1280,Yt),Tn(1536,nn),Mo("/dev/tty",1280),Mo("/dev/tty1",1536);var u=new Uint8Array(1024),h=0,g=()=>(h===0&&(h=be(u).byteLength),u[--h]);Aa("random",g),Aa("urandom",g),Wn("/dev/shm",16895,0),Wn("/dev/shm/tmp",16895,0)})(),(()=>{Wn("/proc",16895,0);var u=Wn("/proc/self",16895,0);Wn("/proc/self/fd",16895,0),Us({U:()=>{var h=oc(u,"fd",16895,73);return h.l={ma:(g,k)=>{var E=jr(+k);return g={parent:null,U:{mb:"fake"},l:{na:()=>E.path}},g.parent=g}},h}},"/proc/self/fd")})(),Object.assign(La.prototype,{get(u){return this.M[u]},has(u){return this.M[u]!==void 0},ta(u){var h=this.ib.pop()||this.M.length;return this.M[h]=u,h},Wb(u){this.M[u]=void 0,this.ib.push(u)}}),kr=S.BindingError=class extends Error{constructor(u){super(u),this.name="BindingError"}},vn.M.push({value:void 0},{value:null},{value:!0},{value:!1}),vn.h=vn.M.length,S.count_emval_handles=function(){for(var u=0,h=vn.h;h<vn.M.length;++h)vn.M[h]!==void 0&&++u;return u},zs=S.PureVirtualError=Uo("PureVirtualError");for(var nl=Array(256),Xa=0;256>Xa;++Xa)nl[Xa]=String.fromCharCode(Xa);Fo=nl,S.getInheritedInstanceCount=function(){return Object.keys(Sr).length},S.getLiveInheritedInstances=function(){var u=[],h;for(h in Sr)Sr.hasOwnProperty(h)&&u.push(Sr[h]);return u},S.flushPendingDeletes=ja,S.setDelayFunction=function(u){dt=u,Na.length&&dt&&dt(ja)},Qi=S.InternalError=class extends Error{constructor(u){super(u),this.name="InternalError"}},lr.prototype.isAliasOf=function(u){if(!(this instanceof lr&&u instanceof lr))return!1;var h=this.g.u.i,g=this.g.o,k=u.g.u.i;for(u=u.g.o;h.A;)g=h.pa(g),h=h.A;for(;k.A;)u=k.pa(u),k=k.A;return h===k&&g===u},lr.prototype.clone=function(){if(this.g.o||si(this),this.g.ka)return this.g.count.value+=1,this;var u=Xi,h=Object,g=h.create,k=Object.getPrototypeOf(this),E=this.g;return u=u(g.call(h,k,{g:{value:{count:E.count,ia:E.ia,ka:E.ka,o:E.o,u:E.u,H:E.H,L:E.L}}})),u.g.count.value+=1,u.g.ia=!1,u},lr.prototype.delete=function(){this.g.o||si(this),this.g.ia&&!this.g.ka&&rt("Object already scheduled for deletion"),Da(this),Fa(this.g),this.g.ka||(this.g.H=void 0,this.g.o=void 0)},lr.prototype.isDeleted=function(){return!this.g.o},lr.prototype.deleteLater=function(){return this.g.o||si(this),this.g.ia&&!this.g.ka&&rt("Object already scheduled for deletion"),Na.push(this),Na.length===1&&dt&&dt(ja),this.g.ia=!0,this},cr.prototype.Sb=function(u){return this.sb&&(u=this.sb(u)),u},cr.prototype.cb=function(u){this.W&&this.W(u)},cr.prototype.argPackAdvance=8,cr.prototype.readValueFromPointer=za,cr.prototype.deleteObject=function(u){u!==null&&u.delete()},cr.prototype.fromWireType=function(u){function h(){return this.ya?sr(this.i.N,{u:this.fc,o:g,L:this,H:u}):sr(this.i.N,{u:this,o:u})}var g=this.Sb(u);if(!g)return this.cb(u),null;var k=ai(this.i,g);if(k!==void 0)return k.g.count.value===0?(k.g.o=g,k.g.H=u,k.clone()):(k=k.clone(),this.cb(u),k);if(k=this.i.Rb(g),k=Br[k],!k)return h.call(this);k=this.xa?k.Jb:k.pointerType;var E=Fr(g,this.i,k.i);return E===null?h.call(this):this.ya?sr(k.i.N,{u:k,o:E,L:this,H:u}):sr(k.i.N,{u:k,o:E})},_n=S.UnboundTypeError=Uo("UnboundTypeError");for(var he,rl=0;32>rl;++rl)Ys.push(Array(rl));var xc={__syscall_fcntl64:function(u,h,g){gn=g;try{var k=jr(u);switch(h){case 0:var E=Dr();return 0>E?-28:cc(k,E).X;case 1:case 2:return 0;case 3:return k.flags;case 4:return E=Dr(),k.flags|=E,0;case 5:return E=Dr(),Re[E+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return L[Ec()>>2]=28,-1;default:return-28}}catch(I){if(typeof wr>"u"||I.name!=="ErrnoError")throw I;return-I.aa}},__syscall_ioctl:function(u,h,g){gn=g;try{var k=jr(u);switch(h){case 21509:return k.s?0:-59;case 21505:if(!k.s)return-59;if(k.s.V.$b){h=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var E=Dr();L[E>>2]=25856,L[E+4>>2]=5,L[E+8>>2]=191,L[E+12>>2]=35387;for(var I=0;32>I;I++)Ee[E+I+17>>0]=h[I]||0}return 0;case 21510:case 21511:case 21512:return k.s?0:-59;case 21506:case 21507:case 21508:if(!k.s)return-59;if(k.s.V.ac)for(E=Dr(),h=[],I=0;32>I;I++)h.push(Ee[E+I+17>>0]);return 0;case 21519:return k.s?(E=Dr(),L[E>>2]=0):-59;case 21520:return k.s?-28:-59;case 21531:if(E=Dr(),!k.m.Zb)throw new je(59);return k.m.Zb(k,h,E);case 21523:return k.s?(k.s.V.bc&&(I=[24,80],E=Dr(),Re[E>>1]=I[0],Re[E+2>>1]=I[1]),0):-59;case 21524:return k.s?0:-59;case 21515:return k.s?0:-59;default:return-28}}catch(D){if(typeof wr>"u"||D.name!=="ErrnoError")throw D;return-D.aa}},__syscall_openat:function(u,h,g,k){gn=k;try{h=h?Ne(ce,h):"";var E=h;if(E.charAt(0)==="/")h=E;else{var I=u===-100?"/":jr(u).path;if(E.length==0)throw new je(44);h=C(I+"/"+E)}var D=k?Dr():0;return Ao(h,g,D).X}catch(q){if(typeof wr>"u"||q.name!=="ErrnoError")throw q;return-q.aa}},_embind_create_inheriting_constructor:function(u,h,g){u=Tt(u),h=Zi(h,"wrapper"),g=or(g);var k=[].slice,E=h.i,I=E.N,D=E.A.N,q=E.A.constructor;u=Do(u,function(){E.A.qb.forEach((function(G){if(this[G]===D[G])throw new zs(`Pure virtual function ${G} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:I}),this.__construct.apply(this,k.call(arguments))}),I.__construct=function(){this===I&&rt("Pass correct 'this' to __construct");var G=q.implement.apply(void 0,[this].concat(k.call(arguments)));Da(G);var Ce=G.g;G.notifyOnDestruction(),Ce.ka=!0,Object.defineProperties(this,{g:{value:Ce}}),Xi(this),G=Ce.o,G=Bo(E,G),Sr.hasOwnProperty(G)?rt(`Tried to register registered instance: ${G}`):Sr[G]=this},I.__destruct=function(){this===I&&rt("Pass correct 'this' to __destruct"),Da(this);var G=this.g.o;G=Bo(E,G),Sr.hasOwnProperty(G)?delete Sr[G]:rt(`Tried to unregister unregistered instance: ${G}`)},u.prototype=Object.create(I);for(var re in g)u.prototype[re]=g[re];return Cr(u)},_embind_finalize_value_object:function(u){var h=Ba[u];delete Ba[u];var g=h.Va,k=h.W,E=h.fb,I=E.map(D=>D.Vb).concat(E.map(D=>D.kc));En([u],I,D=>{var q={};return E.forEach((re,G)=>{var Ce=D[G],Ie=re.Tb,Ue=re.Ub,Q=D[G+E.length],fe=re.jc,Pe=re.lc;q[re.Pb]={read:He=>Ce.fromWireType(Ie(Ue,He)),write:(He,Ze)=>{var tt=[];fe(Pe,He,Q.toWireType(tt,Ze)),zr(tt)}}}),[{name:h.name,fromWireType:function(re){var G={},Ce;for(Ce in q)G[Ce]=q[Ce].read(re);return k(re),G},toWireType:function(re,G){for(var Ce in q)if(!(Ce in G))throw new TypeError(`Missing field: "${Ce}"`);var Ie=g();for(Ce in q)q[Ce].write(Ie,G[Ce]);return re!==null&&re.push(k,Ie),Ie},argPackAdvance:8,readValueFromPointer:za,K:k}]})},_embind_register_bigint:function(){},_embind_register_bool:function(u,h,g,k,E){var I=zo(g);h=Tt(h),Pn(u,{name:h,fromWireType:function(D){return!!D},toWireType:function(D,q){return q?k:E},argPackAdvance:8,readValueFromPointer:function(D){if(g===1)var q=Ee;else if(g===2)q=Re;else if(g===4)q=L;else throw new TypeError("Unknown boolean type size: "+h);return this.fromWireType(q[D>>I])},K:null})},_embind_register_class:function(u,h,g,k,E,I,D,q,re,G,Ce,Ie,Ue){Ce=Tt(Ce),I=rn(E,I),q&&(q=rn(D,q)),G&&(G=rn(re,G)),Ue=rn(Ie,Ue);var Q=dc(Ce);qs(Q,function(){Rn(`Cannot construct ${Ce} due to unbound types`,[k])}),En([u,h,g],k?[k]:[],function(fe){if(fe=fe[0],k)var Pe=fe.i,He=Pe.N;else He=lr.prototype;fe=Do(Q,function(){if(Object.getPrototypeOf(this)!==Ze)throw new kr("Use 'new' to construct "+Ce);if(tt.$===void 0)throw new kr(Ce+" has no accessible constructor");var _t=tt.$[arguments.length];if(_t===void 0)throw new kr(`Tried to invoke ctor of ${Ce} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(tt.$).toString()}) parameters instead!`);return _t.apply(this,arguments)});var Ze=Object.create(He,{constructor:{value:fe}});fe.prototype=Ze;var tt=new $s(Ce,fe,Ze,Ue,Pe,I,q,G);tt.A&&(tt.A.qa===void 0&&(tt.A.qa=[]),tt.A.qa.push(tt)),Pe=new cr(Ce,tt,!0,!1),He=new cr(Ce+"*",tt,!1,!1);var ft=new cr(Ce+" const*",tt,!1,!0);return Br[u]={pointerType:He,Jb:ft},Ha(Q,fe),[Pe,He,ft]})},_embind_register_class_class_function:function(u,h,g,k,E,I,D){var q=ci(g,k);h=Tt(h),I=rn(E,I),En([],[u],function(re){function G(){Rn(`Cannot call ${Ce} due to unbound types`,q)}re=re[0];var Ce=`${re.name}.${h}`;h.startsWith("@@")&&(h=Symbol[h.substring(2)]);var Ie=re.i.constructor;return Ie[h]===void 0?(G.ha=g-1,Ie[h]=G):(Hs(Ie,h,Ce),Ie[h].B[g-1]=G),En([],q,function(Ue){if(Ue=Ji(Ce,[Ue[0],null].concat(Ue.slice(1)),null,I,D),Ie[h].B===void 0?(Ue.ha=g-1,Ie[h]=Ue):Ie[h].B[g-1]=Ue,re.i.qa)for(const Q of re.i.qa)Q.constructor.hasOwnProperty(h)||(Q.constructor[h]=Ue);return[]}),[]})},_embind_register_class_class_property:function(u,h,g,k,E,I,D,q){h=Tt(h),I=rn(E,I),En([],[u],function(re){re=re[0];var G=`${re.name}.${h}`,Ce={get(){Rn(`Cannot access ${G} due to unbound types`,[g])},enumerable:!0,configurable:!0};return Ce.set=q?()=>{Rn(`Cannot access ${G} due to unbound types`,[g])}:()=>{rt(`${G} is a read-only property`)},Object.defineProperty(re.i.constructor,h,Ce),En([],[g],function(Ie){Ie=Ie[0];var Ue={get(){return Ie.fromWireType(I(k))},enumerable:!0};return q&&(q=rn(D,q),Ue.set=Q=>{var fe=[];q(k,Ie.toWireType(fe,Q)),zr(fe)}),Object.defineProperty(re.i.constructor,h,Ue),[]}),[]})},_embind_register_class_constructor:function(u,h,g,k,E,I){var D=ci(h,g);E=rn(k,E),En([],[u],function(q){q=q[0];var re=`constructor ${q.name}`;if(q.i.$===void 0&&(q.i.$=[]),q.i.$[h-1]!==void 0)throw new kr(`Cannot register multiple constructors with identical number of parameters (${h-1}) for class '${q.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return q.i.$[h-1]=()=>{Rn(`Cannot construct ${q.name} due to unbound types`,D)},En([],D,function(G){return G.splice(1,0,null),q.i.$[h-1]=Ji(re,G,null,E,I),[]}),[]})},_embind_register_class_function:function(u,h,g,k,E,I,D,q){var re=ci(g,k);h=Tt(h),I=rn(E,I),En([],[u],function(G){function Ce(){Rn(`Cannot call ${Ie} due to unbound types`,re)}G=G[0];var Ie=`${G.name}.${h}`;h.startsWith("@@")&&(h=Symbol[h.substring(2)]),q&&G.i.qb.push(h);var Ue=G.i.N,Q=Ue[h];return Q===void 0||Q.B===void 0&&Q.className!==G.name&&Q.ha===g-2?(Ce.ha=g-2,Ce.className=G.name,Ue[h]=Ce):(Hs(Ue,h,Ie),Ue[h].B[g-2]=Ce),En([],re,function(fe){return fe=Ji(Ie,fe,G,I,D),Ue[h].B===void 0?(fe.ha=g-2,Ue[h]=fe):Ue[h].B[g-2]=fe,[]}),[]})},_embind_register_class_property:function(u,h,g,k,E,I,D,q,re,G){h=Tt(h),E=rn(k,E),En([],[u],function(Ce){Ce=Ce[0];var Ie=`${Ce.name}.${h}`,Ue={get(){Rn(`Cannot access ${Ie} due to unbound types`,[g,D])},enumerable:!0,configurable:!0};return Ue.set=re?()=>{Rn(`Cannot access ${Ie} due to unbound types`,[g,D])}:()=>{rt(Ie+" is a read-only property")},Object.defineProperty(Ce.i.N,h,Ue),En([],re?[g,D]:[g],function(Q){var fe=Q[0],Pe={get(){var Ze=pc(this,Ce,Ie+" getter");return fe.fromWireType(E(I,Ze))},enumerable:!0};if(re){re=rn(q,re);var He=Q[1];Pe.set=function(Ze){var tt=pc(this,Ce,Ie+" setter"),ft=[];re(G,tt,He.toWireType(ft,Ze)),zr(ft)}}return Object.defineProperty(Ce.i.N,h,Pe),[]}),[]})},_embind_register_emval:function(u,h){h=Tt(h),Pn(u,{name:h,fromWireType:function(g){var k=or(g);return Wa(g),k},toWireType:function(g,k){return Cr(k)},argPackAdvance:8,readValueFromPointer:za,K:null})},_embind_register_enum:function(u,h,g,k){function E(){}g=zo(g),h=Tt(h),E.values={},Pn(u,{name:h,constructor:E,fromWireType:function(I){return this.constructor.values[I]},toWireType:function(I,D){return D.value},argPackAdvance:8,readValueFromPointer:Gs(h,g,k),K:null}),qs(h,E)},_embind_register_enum_value:function(u,h,g){var k=Zi(u,"enum");h=Tt(h),u=k.constructor,k=Object.create(k.constructor.prototype,{value:{value:g},constructor:{value:Do(`${k.name}_${h}`,function(){})}}),u.values[g]=k,u[h]=k},_embind_register_float:function(u,h,g){g=zo(g),h=Tt(h),Pn(u,{name:h,fromWireType:function(k){return k},toWireType:function(k,E){return E},argPackAdvance:8,readValueFromPointer:Ho(h,g),K:null})},_embind_register_function:function(u,h,g,k,E,I){var D=ci(h,g);u=Tt(u),E=rn(k,E),qs(u,function(){Rn(`Cannot call ${u} due to unbound types`,D)},h-1),En([],D,function(q){return Ha(u,Ji(u,[q[0],null].concat(q.slice(1)),null,E,I),h-1),[]})},_embind_register_integer:function(u,h,g,k,E){h=Tt(h),E===-1&&(E=4294967295),E=zo(g);var I=q=>q;if(k===0){var D=32-8*g;I=q=>q<<D>>>D}g=h.includes("unsigned")?function(q,re){return re>>>0}:function(q,re){return re},Pn(u,{name:h,fromWireType:I,toWireType:g,argPackAdvance:8,readValueFromPointer:fc(h,E,k!==0),K:null})},_embind_register_memory_view:function(u,h,g){function k(I){I>>=2;var D=ee;return new E(D.buffer,D[I+1],D[I])}var E=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][h];g=Tt(g),Pn(u,{name:g,fromWireType:k,argPackAdvance:8,readValueFromPointer:k},{Xb:!0})},_embind_register_std_string:function(u,h){h=Tt(h);var g=h==="std::string";Pn(u,{name:h,fromWireType:function(k){var E=ee[k>>2],I=k+4;if(g)for(var D=I,q=0;q<=E;++q){var re=I+q;if(q==E||ce[re]==0){if(D=D?Ne(ce,D,re-D):"",G===void 0)var G=D;else G+="\0",G+=D;D=re+1}}else{for(G=Array(E),q=0;q<E;++q)G[q]=String.fromCharCode(ce[I+q]);G=G.join("")}return Vr(k),G},toWireType:function(k,E){E instanceof ArrayBuffer&&(E=new Uint8Array(E));var I=typeof E=="string";I||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int8Array||rt("Cannot pass non-string to std::string");var D=g&&I?Ct(E):E.length,q=Zo(4+D+1),re=q+4;if(ee[q>>2]=D,g&&I)qt(E,ce,re,D+1);else if(I)for(I=0;I<D;++I){var G=E.charCodeAt(I);255<G&&(Vr(re),rt("String has UTF-16 code units that do not fit in 8 bits")),ce[re+I]=G}else for(I=0;I<D;++I)ce[re+I]=E[I];return k!==null&&k.push(Vr,q),q},argPackAdvance:8,readValueFromPointer:za,K:function(k){Vr(k)}})},_embind_register_std_wstring:function(u,h,g){if(g=Tt(g),h===2)var k=kd,E=Cd,I=Ks,D=()=>ue,q=1;else h===4&&(k=Sd,E=Td,I=xd,D=()=>ee,q=2);Pn(u,{name:g,fromWireType:function(re){for(var G=ee[re>>2],Ce=D(),Ie,Ue=re+4,Q=0;Q<=G;++Q){var fe=re+4+Q*h;(Q==G||Ce[fe>>q]==0)&&(Ue=k(Ue,fe-Ue),Ie===void 0?Ie=Ue:(Ie+="\0",Ie+=Ue),Ue=fe+h)}return Vr(re),Ie},toWireType:function(re,G){typeof G!="string"&&rt(`Cannot pass non-string to C++ string type ${g}`);var Ce=I(G),Ie=Zo(4+Ce+h);return ee[Ie>>2]=Ce>>q,E(G,Ie+4,Ce+h),re!==null&&re.push(Vr,Ie),Ie},argPackAdvance:8,readValueFromPointer:za,K:function(re){Vr(re)}})},_embind_register_value_object:function(u,h,g,k,E,I){Ba[u]={name:Tt(h),Va:rn(g,k),W:rn(E,I),fb:[]}},_embind_register_value_object_field:function(u,h,g,k,E,I,D,q,re,G){Ba[u].fb.push({Pb:Tt(h),Vb:g,Tb:rn(k,E),Ub:I,kc:D,jc:rn(q,re),lc:G})},_embind_register_void:function(u,h){h=Tt(h),Pn(u,{cc:!0,name:h,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(u,h,g){u=or(u),h=Zi(h,"emval::as");var k=[],E=Cr(k);return ee[g>>2]=E,h.toWireType(k,u)},_emval_call_method:function(u,h,g,k,E){u=Ga[u],h=or(h),g=Zs(g);var I=[];return ee[k>>2]=Cr(I),u(h,g,I,E)},_emval_call_void_method:function(u,h,g,k){u=Ga[u],h=or(h),g=Zs(g),u(h,g,null,k)},_emval_decref:Wa,_emval_get_method_caller:function(u,h){var g=_d(u,h),k=g[0];h=k.name+"_$"+g.slice(1).map(function(D){return D.name}).join("_")+"$";var E=gc[h];if(E!==void 0)return E;var I=Array(u-1);return E=Pd((D,q,re,G)=>{for(var Ce=0,Ie=0;Ie<u-1;++Ie)I[Ie]=g[Ie+1].readValueFromPointer(G+Ce),Ce+=g[Ie+1].argPackAdvance;for(D=D[q].apply(D,I),Ie=0;Ie<u-1;++Ie)g[Ie+1].Lb&&g[Ie+1].Lb(I[Ie]);if(!k.cc)return k.toWireType(re,D)}),gc[h]=E},_emval_get_property:function(u,h){return u=or(u),h=or(h),Cr(u[h])},_emval_incref:function(u){4<u&&(vn.get(u).ub+=1)},_emval_new_array:function(){return Cr([])},_emval_new_cstring:function(u){return Cr(Zs(u))},_emval_new_object:function(){return Cr({})},_emval_run_destructors:function(u){var h=or(u);zr(h),Wa(u)},_emval_set_property:function(u,h,g){u=or(u),h=or(h),g=or(g),u[h]=g},_emval_take_value:function(u,h){return u=Zi(u,"_emval_take_value"),u=u.readValueFromPointer(h),Cr(u)},abort:()=>{pn("")},beginPixelLocalStorageWEBGL:function(u,h,g){(u=Zt[u].C.ca)&&u.beginPixelLocalStorageWEBGL(S.HEAPU32.subarray(g,g+h))},decode_image:function(u,h,g){var k=S.images;k||(k=new Map,S.images=k);var E=new Image;k.set(u,E),h=S.HEAP8.subarray(h,h+g),g=new Uint8Array(g),g.set(h),E.src=URL.createObjectURL(new Blob([g],{type:"image/png"})),E.onload=function(){S._setWebImage(u,E.width,E.height)}},delete_image:function(u){var h=S.images;h&&h.get(u)&&h.delete(u)},emscripten_asm_const_int:(u,h,g)=>{Qs.length=0;var k;for(g>>=2;k=ce[h++];)g+=k!=105&g,Qs.push(k==105?L[g]:Ke[g++>>1]),++g;return _o[u].apply(null,Qs)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(u,h,g)=>ce.copyWithin(u,h,h+g),emscripten_resize_heap:u=>{var h=ce.length;if(u>>>=0,2147483648<u)return!1;for(var g=1;4>=g;g*=2){var k=h*(1+.2/g);k=Math.min(k,u+100663296);var E=Math;k=Math.max(u,k);e:{E=E.min.call(E,2147483648,k+(65536-k%65536)%65536)-le.buffer.byteLength+65535>>>16;try{le.grow(E),Ye();var I=1;break e}catch{}I=void 0}if(I)return!0}return!1},emscripten_webgl_enable_extension:function(u,h){return u=Zt[u],h=h?Ne(ce,h):"",h.startsWith("GL_")&&(h=h.substr(3)),h=="WEBGL_draw_instanced_base_vertex_base_instance"&&qo(he),h=="WEBGL_multi_draw_instanced_base_vertex_base_instance"&&vc(he),h=="WEBGL_multi_draw"&&Xs(he),!!u.C.getExtension(h)},emscripten_webgl_get_current_context:function(){return ur?ur.handle:0},emscripten_webgl_make_context_current:function(u){return Go(u)?0:-5},enable_WEBGL_provoking_vertex:function(u){return u=Zt[u].C,u.rb=u.getExtension("WEBGL_provoking_vertex"),!!u.rb},enable_WEBGL_shader_pixel_local_storage_coherent:function(u){return u=Zt[u].C,u.ca=u.getExtension("WEBGL_shader_pixel_local_storage"),!(!u.ca||!u.ca.isCoherent())},endPixelLocalStorageWEBGL:function(u,h,g){(u=Zt[u].C.ca)&&u.endPixelLocalStorageWEBGL(S.HEAPU32.subarray(g,g+h))},environ_get:(u,h)=>{var g=0;return kc().forEach(function(k,E){var I=h+g;for(E=ee[u+4*E>>2]=I,I=0;I<k.length;++I)Ee[E++>>0]=k.charCodeAt(I);Ee[E>>0]=0,g+=k.length+1}),0},environ_sizes_get:(u,h)=>{var g=kc();ee[u>>2]=g.length;var k=0;return g.forEach(function(E){k+=E.length+1}),ee[h>>2]=k,0},fd_close:function(u){try{var h=jr(u);if(h.X===null)throw new je(8);h.Sa&&(h.Sa=null);try{h.m.close&&h.m.close(h)}catch(g){throw g}finally{Un[h.X]=null}return h.X=null,0}catch(g){if(typeof wr>"u"||g.name!=="ErrnoError")throw g;return g.aa}},fd_read:function(u,h,g,k){try{e:{var E=jr(u);u=h;for(var I,D=h=0;D<g;D++){var q=ee[u>>2],re=ee[u+4>>2];u+=8;var G=E,Ce=q,Ie=re,Ue=I,Q=Ee;if(0>Ie||0>Ue)throw new je(28);if(G.X===null)throw new je(8);if((G.flags&2097155)===1)throw new je(8);if((G.node.mode&61440)===16384)throw new je(31);if(!G.m.read)throw new je(28);var fe=typeof Ue<"u";if(!fe)Ue=G.position;else if(!G.seekable)throw new je(70);var Pe=G.m.read(G,Q,Ce,Ie,Ue);fe||(G.position+=Pe);var He=Pe;if(0>He){var Ze=-1;break e}if(h+=He,He<re)break;typeof I<"u"&&(I+=He)}Ze=h}return ee[k>>2]=Ze,0}catch(tt){if(typeof wr>"u"||tt.name!=="ErrnoError")throw tt;return tt.aa}},fd_seek:function(u,h,g,k,E){h=g+2097152>>>0<4194305-!!h?(h>>>0)+4294967296*g:NaN;try{if(isNaN(h))return 61;var I=jr(u);return Lo(I,h,k),Ei=[I.position>>>0,(Nn=I.position,1<=+Math.abs(Nn)?0<Nn?+Math.floor(Nn/4294967296)>>>0:~~+Math.ceil((Nn-+(~~Nn>>>0))/4294967296)>>>0:0)],L[E>>2]=Ei[0],L[E+4>>2]=Ei[1],I.Sa&&h===0&&k===0&&(I.Sa=null),0}catch(D){if(typeof wr>"u"||D.name!=="ErrnoError")throw D;return D.aa}},fd_write:function(u,h,g,k){try{e:{var E=jr(u);u=h;for(var I,D=h=0;D<g;D++){var q=ee[u>>2],re=ee[u+4>>2];u+=8;var G=E,Ce=q,Ie=re,Ue=I,Q=Ee;if(0>Ie||0>Ue)throw new je(28);if(G.X===null)throw new je(8);if((G.flags&2097155)===0)throw new je(8);if((G.node.mode&61440)===16384)throw new je(31);if(!G.m.write)throw new je(28);G.seekable&&G.flags&1024&&Lo(G,0,2);var fe=typeof Ue<"u";if(!fe)Ue=G.position;else if(!G.seekable)throw new je(70);var Pe=G.m.write(G,Q,Ce,Ie,Ue,void 0);fe||(G.position+=Pe);var He=Pe;if(0>He){var Ze=-1;break e}h+=He,typeof I<"u"&&(I+=He)}Ze=h}return ee[k>>2]=Ze,0}catch(tt){if(typeof wr>"u"||tt.name!=="ErrnoError")throw tt;return tt.aa}},framebufferPixelLocalClearValuefvWEBGL:function(u,h,g,k,E,I){(u=Zt[u].C.ca)&&u.framebufferPixelLocalClearValuefvWEBGL(h,[g,k,E,I])},framebufferTexturePixelLocalStorageWEBGL:function(u,h,g,k,E){(u=Zt[u].C.ca)&&u.framebufferTexturePixelLocalStorageWEBGL(h,Yi[g],k,E)},getFramebufferPixelLocalStorageParameterivWEBGL:function(u,h,g){return(u=Zt[u].C.ca)?u.getFramebufferPixelLocalStorageParameterWEBGL(h,g):0},glActiveTexture:function(u){he.activeTexture(u)},glAttachShader:function(u,h){he.attachShader(Gn[u],Tr[h])},glBindBuffer:function(u,h){u==35051?he.Pa=h:u==35052&&(he.Qa=h),he.bindBuffer(u,Ka[h])},glBindBufferRange:function(u,h,g,k,E){he.bindBufferRange(u,h,Ka[g],k,E)},glBindFramebuffer:function(u,h){he.bindFramebuffer(u,$o[h])},glBindRenderbuffer:function(u,h){he.bindRenderbuffer(u,Za[h])},glBindTexture:function(u,h){he.bindTexture(u,Yi[h])},glBindVertexArray:function(u){he.bindVertexArray(Wo[u])},glBlendEquation:function(u){he.blendEquation(u)},glBlendFunc:function(u,h){he.blendFunc(u,h)},glBlitFramebuffer:function(u,h,g,k,E,I,D,q,re,G){he.blitFramebuffer(u,h,g,k,E,I,D,q,re,G)},glBufferData:function(u,h,g,k){g&&h?he.bufferData(u,ce,k,g,h):he.bufferData(u,h,k)},glBufferSubData:function(u,h,g,k){g&&he.bufferSubData(u,h,ce,k,g)},glClear:function(u){he.clear(u)},glClearBufferfv:function(u,h,g){he.clearBufferfv(u,h,We,g>>2)},glClearBufferuiv:function(u,h,g){he.clearBufferuiv(u,h,ee,g>>2)},glClearColor:function(u,h,g,k){he.clearColor(u,h,g,k)},glClearDepthf:function(u){he.clearDepth(u)},glClearStencil:function(u){he.clearStencil(u)},glColorMask:function(u,h,g,k){he.colorMask(!!u,!!h,!!g,!!k)},glCompileShader:function(u){he.compileShader(Tr[u])},glCreateProgram:function(){var u=ui(Gn),h=he.createProgram();return h.name=u,h.Ba=h.za=h.Aa=0,h.Ya=1,Gn[u]=h,u},glCreateShader:function(u){var h=ui(Tr);return Tr[h]=he.createShader(u),h},glCullFace:function(u){he.cullFace(u)},glDeleteBuffers:function(u,h){for(var g=0;g<u;g++){var k=L[h+4*g>>2],E=Ka[k];E&&(he.deleteBuffer(E),E.name=0,Ka[k]=null,k==he.Pa&&(he.Pa=0),k==he.Qa&&(he.Qa=0))}},glDeleteFramebuffers:function(u,h){for(var g=0;g<u;++g){var k=L[h+4*g>>2],E=$o[k];E&&(he.deleteFramebuffer(E),E.name=0,$o[k]=null)}},glDeleteProgram:function(u){if(u){var h=Gn[u];h?(he.deleteProgram(h),h.name=0,Gn[u]=null):Qt(1281)}},glDeleteRenderbuffers:function(u,h){for(var g=0;g<u;g++){var k=L[h+4*g>>2],E=Za[k];E&&(he.deleteRenderbuffer(E),E.name=0,Za[k]=null)}},glDeleteShader:function(u){if(u){var h=Tr[u];h?(he.deleteShader(h),Tr[u]=null):Qt(1281)}},glDeleteTextures:function(u,h){for(var g=0;g<u;g++){var k=L[h+4*g>>2],E=Yi[k];E&&(he.deleteTexture(E),E.name=0,Yi[k]=null)}},glDeleteVertexArrays:function(u,h){for(var g=0;g<u;g++){var k=L[h+4*g>>2];he.deleteVertexArray(Wo[k]),Wo[k]=null}},glDepthFunc:function(u){he.depthFunc(u)},glDepthMask:function(u){he.depthMask(!!u)},glDepthRangef:function(u,h){he.depthRange(u,h)},glDisable:function(u){he.disable(u)},glDrawArrays:function(u,h,g){he.drawArrays(u,h,g)},glDrawArraysInstanced:function(u,h,g,k){he.drawArraysInstanced(u,h,g,k)},glDrawBuffers:function(u,h){for(var g=Ys[u],k=0;k<u;k++)g[k]=L[h+4*k>>2];he.drawBuffers(g)},glDrawElements:function(u,h,g,k){he.drawElements(u,h,g,k)},glDrawElementsInstanced:function(u,h,g,k,E){he.drawElementsInstanced(u,h,g,k,E)},glEnable:function(u){he.enable(u)},glEnableVertexAttribArray:function(u){he.enableVertexAttribArray(u)},glFlush:function(){he.flush()},glFramebufferRenderbuffer:function(u,h,g,k){he.framebufferRenderbuffer(u,h,g,Za[k])},glFramebufferTexture2D:function(u,h,g,k,E){he.framebufferTexture2D(u,h,g,Yi[k],E)},glFrontFace:function(u){he.frontFace(u)},glGenBuffers:function(u,h){ea(u,h,"createBuffer",Ka)},glGenFramebuffers:function(u,h){ea(u,h,"createFramebuffer",$o)},glGenRenderbuffers:function(u,h){ea(u,h,"createRenderbuffer",Za)},glGenTextures:function(u,h){ea(u,h,"createTexture",Yi)},glGenVertexArrays:function(u,h){ea(u,h,"createVertexArray",Wo)},glGenerateMipmap:function(u){he.generateMipmap(u)},glGetError:function(){var u=he.getError()||Qa;return Qa=0,u},glGetIntegerv:function(u,h){Cc(u,h)},glGetProgramiv:function(u,h,g){if(g)if(u>=bc)Qt(1281);else if(u=Gn[u],h==35716)u=he.getProgramInfoLog(u),u===null&&(u="(unknown error)"),L[g>>2]=u.length+1;else if(h==35719){if(!u.Ba)for(h=0;h<he.getProgramParameter(u,35718);++h)u.Ba=Math.max(u.Ba,he.getActiveUniform(u,h).name.length+1);L[g>>2]=u.Ba}else if(h==35722){if(!u.za)for(h=0;h<he.getProgramParameter(u,35721);++h)u.za=Math.max(u.za,he.getActiveAttrib(u,h).name.length+1);L[g>>2]=u.za}else if(h==35381){if(!u.Aa)for(h=0;h<he.getProgramParameter(u,35382);++h)u.Aa=Math.max(u.Aa,he.getActiveUniformBlockName(u,h).length+1);L[g>>2]=u.Aa}else L[g>>2]=he.getProgramParameter(u,h);else Qt(1281)},glGetShaderiv:function(u,h,g){g?h==35716?(u=he.getShaderInfoLog(Tr[u]),u===null&&(u="(unknown error)"),L[g>>2]=u?u.length+1:0):h==35720?(u=he.getShaderSource(Tr[u]),L[g>>2]=u?u.length+1:0):L[g>>2]=he.getShaderParameter(Tr[u],h):Qt(1281)},glGetString:function(u){var h=yc[u];if(!h){switch(u){case 7939:h=he.getSupportedExtensions()||[],h=h.concat(h.map(function(k){return"GL_"+k})),h=hi(h.join(" "));break;case 7936:case 7937:case 37445:case 37446:(h=he.getParameter(u))||Qt(1280),h=h&&hi(h);break;case 7938:h=hi("OpenGL ES 3.0 ("+he.getParameter(7938)+")");break;case 35724:h=he.getParameter(35724);var g=h.match(/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/);g!==null&&(g[1].length==3&&(g[1]+="0"),h="OpenGL ES GLSL ES "+g[1]+" ("+h+")"),h=hi(h);break;default:Qt(1280)}yc[u]=h}return h},glGetUniformBlockIndex:function(u,h){return he.getUniformBlockIndex(Gn[u],h?Ne(ce,h):"")},glGetUniformLocation:function(u,h){if(h=h?Ne(ce,h):"",u=Gn[u]){var g=u,k=g.oa,E=g.zb,I;if(!k)for(g.oa=k={},g.yb={},I=0;I<he.getProgramParameter(g,35718);++I){var D=he.getActiveUniform(g,I),q=D.name;D=D.size;var re=ta(q);re=0<re?q.slice(0,re):q;var G=g.Ya;for(g.Ya+=D,E[re]=[D,G],q=0;q<D;++q)k[G]=q,g.yb[G++]=re}if(g=u.oa,k=0,E=h,I=ta(h),0<I&&(k=parseInt(h.slice(I+1))>>>0,E=h.slice(0,I)),(E=u.zb[E])&&k<E[0]&&(k+=E[1],g[k]=g[k]||he.getUniformLocation(u,h)))return k}else Qt(1281);return-1},glInvalidateFramebuffer:function(u,h,g){for(var k=Ys[h],E=0;E<h;E++)k[E]=L[g+4*E>>2];he.invalidateFramebuffer(u,k)},glLinkProgram:function(u){u=Gn[u],he.linkProgram(u),u.oa=0,u.zb={}},glPixelStorei:function(u,h){he.pixelStorei(u,h)},glReadPixels:function(u,h,g,k,E,I,D){if(he.Pa)he.readPixels(u,h,g,k,E,I,D);else{var q=Sc(I);he.readPixels(u,h,g,k,E,I,q,D>>31-Math.clz32(q.BYTES_PER_ELEMENT))}},glRenderbufferStorageMultisample:function(u,h,g,k,E){he.renderbufferStorageMultisample(u,h,g,k,E)},glScissor:function(u,h,g,k){he.scissor(u,h,g,k)},glShaderSource:function(u,h,g,k){for(var E="",I=0;I<h;++I){var D=k?L[k+4*I>>2]:-1,q=L[g+4*I>>2];D=q?Ne(ce,q,0>D?void 0:D):"",E+=D}he.shaderSource(Tr[u],E)},glStencilFunc:function(u,h,g){he.stencilFunc(u,h,g)},glStencilFuncSeparate:function(u,h,g,k){he.stencilFuncSeparate(u,h,g,k)},glStencilMask:function(u){he.stencilMask(u)},glStencilOp:function(u,h,g){he.stencilOp(u,h,g)},glStencilOpSeparate:function(u,h,g,k){he.stencilOpSeparate(u,h,g,k)},glTexParameteri:function(u,h,g){he.texParameteri(u,h,g)},glTexStorage2D:function(u,h,g,k,E){he.texStorage2D(u,h,g,k,E)},glTexSubImage2D:function(u,h,g,k,E,I,D,q,re){if(he.Qa)he.texSubImage2D(u,h,g,k,E,I,D,q,re);else if(re){var G=Sc(q);he.texSubImage2D(u,h,g,k,E,I,D,q,G,re>>31-Math.clz32(G.BYTES_PER_ELEMENT))}else he.texSubImage2D(u,h,g,k,E,I,D,q,null)},glUniform1i:function(u,h){var g=he,k=g.uniform1i,E=he.Kb;if(E){var I=E.oa[u];typeof I=="number"&&(E.oa[u]=I=he.getUniformLocation(E,E.yb[u]+(0<I?"["+I+"]":""))),u=I}else Qt(1282),u=void 0;k.call(g,u,h)},glUniformBlockBinding:function(u,h,g){u=Gn[u],he.uniformBlockBinding(u,h,g)},glUseProgram:function(u){u=Gn[u],he.useProgram(u),he.Kb=u},glVertexAttribDivisor:function(u,h){he.vertexAttribDivisor(u,h)},glVertexAttribIPointer:function(u,h,g,k,E){he.vertexAttribIPointer(u,h,g,k,E)},glVertexAttribPointer:function(u,h,g,k,E,I){he.vertexAttribPointer(u,h,g,!!k,E,I)},glViewport:function(u,h,g,k){he.viewport(u,h,g,k)},provokingVertexWEBGL:function(u,h){(u=Zt[u].C.rb)&&u.provokingVertexWEBGL(h)},strftime_l:(u,h,g,k)=>tl(u,h,g,k),upload_image:function(u,h){var g=S.images;g&&(h=g.get(h))&&(u=Zt[u].C,u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,h),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1))}};(function(){function u(g){if(pe=g=g.exports,le=pe.memory,Ye(),ze=pe.__indirect_function_table,$e.unshift(pe.__wasm_call_ctors),Ht--,S.monitorRunDependencies&&S.monitorRunDependencies(Ht),Ht==0&&$n){var k=$n;$n=null,k()}return g}var h={env:xc,wasi_snapshot_preview1:xc};if(Ht++,S.monitorRunDependencies&&S.monitorRunDependencies(Ht),S.instantiateWasm)try{return S.instantiateWasm(h,u)}catch(g){me("Module.instantiateWasm callback failed with error: "+g),N(g)}return xi(h,function(g){u(g.instance)}).catch(N),{}})();var Vr=u=>(Vr=pe.free)(u),Zo=u=>(Zo=pe.malloc)(u);S._setWebImage=(u,h,g)=>(S._setWebImage=pe.setWebImage)(u,h,g);var Ec=()=>(Ec=pe.__errno_location)(),Kn=S._ma_device__on_notification_unlocked=u=>(Kn=S._ma_device__on_notification_unlocked=pe.ma_device__on_notification_unlocked)(u);S._ma_malloc_emscripten=(u,h)=>(S._ma_malloc_emscripten=pe.ma_malloc_emscripten)(u,h),S._ma_free_emscripten=(u,h)=>(S._ma_free_emscripten=pe.ma_free_emscripten)(u,h);var na=S._ma_device_process_pcm_frames_capture__webaudio=(u,h,g)=>(na=S._ma_device_process_pcm_frames_capture__webaudio=pe.ma_device_process_pcm_frames_capture__webaudio)(u,h,g),il=S._ma_device_process_pcm_frames_playback__webaudio=(u,h,g)=>(il=S._ma_device_process_pcm_frames_playback__webaudio=pe.ma_device_process_pcm_frames_playback__webaudio)(u,h,g),al=u=>(al=pe.__getTypeName)(u);S.__embind_initialize_bindings=()=>(S.__embind_initialize_bindings=pe._embind_initialize_bindings)(),S.dynCall_iiiji=(u,h,g,k,E,I)=>(S.dynCall_iiiji=pe.dynCall_iiiji)(u,h,g,k,E,I),S.dynCall_iij=(u,h,g,k)=>(S.dynCall_iij=pe.dynCall_iij)(u,h,g,k),S.dynCall_iiji=(u,h,g,k,E)=>(S.dynCall_iiji=pe.dynCall_iiji)(u,h,g,k,E),S.dynCall_jii=(u,h,g)=>(S.dynCall_jii=pe.dynCall_jii)(u,h,g),S.dynCall_vijj=(u,h,g,k,E,I)=>(S.dynCall_vijj=pe.dynCall_vijj)(u,h,g,k,E,I),S.dynCall_jiji=(u,h,g,k,E)=>(S.dynCall_jiji=pe.dynCall_jiji)(u,h,g,k,E),S.dynCall_viijii=(u,h,g,k,E,I,D)=>(S.dynCall_viijii=pe.dynCall_viijii)(u,h,g,k,E,I,D),S.dynCall_iiiiij=(u,h,g,k,E,I,D)=>(S.dynCall_iiiiij=pe.dynCall_iiiiij)(u,h,g,k,E,I,D),S.dynCall_iiiiijj=(u,h,g,k,E,I,D,q,re)=>(S.dynCall_iiiiijj=pe.dynCall_iiiiijj)(u,h,g,k,E,I,D,q,re),S.dynCall_iiiiiijj=(u,h,g,k,E,I,D,q,re,G)=>(S.dynCall_iiiiiijj=pe.dynCall_iiiiiijj)(u,h,g,k,E,I,D,q,re,G),S.___start_em_js=531476,S.___stop_em_js=534231;var Ja;$n=function u(){Ja||ol(),Ja||($n=u)};function ol(){function u(){if(!Ja&&(Ja=!0,S.calledRun=!0,!Oe)){if(S.noFSInit||Ma||(Ma=!0,Bs(),S.stdin=S.stdin,S.stdout=S.stdout,S.stderr=S.stderr,S.stdin?Aa("stdin",S.stdin):Fs("/dev/tty","/dev/stdin"),S.stdout?Aa("stdout",null,S.stdout):Fs("/dev/tty","/dev/stdout"),S.stderr?Aa("stderr",null,S.stderr):Fs("/dev/tty1","/dev/stderr"),Ao("/dev/stdin",0),Ao("/dev/stdout",1),Ao("/dev/stderr",1)),Ro=!1,_($e),M(S),S.onRuntimeInitialized&&S.onRuntimeInitialized(),S.postRun)for(typeof S.postRun=="function"&&(S.postRun=[S.postRun]);S.postRun.length;){var h=S.postRun.shift();ct.unshift(h)}_(ct)}}if(!(0<Ht)){if(S.preRun)for(typeof S.preRun=="function"&&(S.preRun=[S.preRun]);S.preRun.length;)Ot();_(et),0<Ht||(S.setStatus?(S.setStatus("Running..."),setTimeout(function(){setTimeout(function(){S.setStatus("")},1),u()},1)):u())}}if(S.preInit)for(typeof S.preInit=="function"&&(S.preInit=[S.preInit]);0<S.preInit.length;)S.preInit.pop()();return ol(),x.ready}})();const v=m},l=>{l.exports=JSON.parse(`{"name":"@rive-app/webgl2","version":"2.31.5","description":"Rive's webgl2 based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)","Chris Dalton <chris@rive.app> (https://rive.app)"],"license":"MIT","files":["rive.js","rive.wasm","rive.js.map","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)},(l,d,f)=>{f.r(d),f.d(d,{Animation:()=>m.Animation});var m=f(4)},(l,d,f)=>{f.r(d),f.d(d,{Animation:()=>m});var m=function(){function v(T,x,S,M){this.animation=T,this.artboard=x,this.playing=M,this.loopCount=0,this.scrubTo=null,this.instance=new S.LinearAnimationInstance(T,x)}return Object.defineProperty(v.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"time",{get:function(){return this.instance.time},set:function(T){this.instance.time=T},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),v.prototype.advance=function(T){this.scrubTo===null?this.instance.advance(T):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},v.prototype.apply=function(T){this.instance.apply(T)},v.prototype.cleanup=function(){this.instance.delete()},v}()},(l,d,f)=>{f.r(d),f.d(d,{AudioAssetWrapper:()=>T.AudioAssetWrapper,AudioWrapper:()=>T.AudioWrapper,BLANK_URL:()=>v.BLANK_URL,CustomFileAssetLoaderWrapper:()=>T.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>T.FileAssetWrapper,FileFinalizer:()=>T.FileFinalizer,FontAssetWrapper:()=>T.FontAssetWrapper,FontWrapper:()=>T.FontWrapper,ImageAssetWrapper:()=>T.ImageAssetWrapper,ImageWrapper:()=>T.ImageWrapper,createFinalization:()=>T.createFinalization,finalizationRegistry:()=>T.finalizationRegistry,registerTouchInteractions:()=>m.registerTouchInteractions,sanitizeUrl:()=>v.sanitizeUrl});var m=f(6),v=f(7),T=f(8)},(l,d,f)=>{f.r(d),f.d(d,{registerTouchInteractions:()=>T});var m=void 0,v=function(x,S){var M,N;return["touchstart","touchmove"].indexOf(x.type)>-1&&!((M=x.touches)===null||M===void 0)&&M.length?(S||x.preventDefault(),{clientX:x.touches[0].clientX,clientY:x.touches[0].clientY}):x.type==="touchend"&&!((N=x.changedTouches)===null||N===void 0)&&N.length?{clientX:x.changedTouches[0].clientX,clientY:x.changedTouches[0].clientY}:{clientX:x.clientX,clientY:x.clientY}},T=function(x){var S=x.canvas,M=x.artboard,N=x.stateMachines,V=N===void 0?[]:N,$=x.renderer,ae=x.rive,z=x.fit,A=x.alignment,F=x.isTouchScrollEnabled,J=F===void 0?!1:F,de=x.layoutScaleFactor,te=de===void 0?1:de;if(!S||!V.length||!$||!ae||!M||typeof window>"u")return null;var K=null,ne=!1,Y=function(Le){if(ne&&Le instanceof MouseEvent){Le.type=="mouseup"&&(ne=!1);return}ne=J&&Le.type==="touchend"&&K==="touchstart",K=Le.type;var le=Le.currentTarget.getBoundingClientRect(),pe=v(Le,J),Oe=pe.clientX,Ee=pe.clientY;if(!(!Oe&&!Ee)){var ce=Oe-le.left,Re=Ee-le.top,ue=ae.computeAlignment(z,A,{minX:0,minY:0,maxX:le.width,maxY:le.height},M.bounds,te),L=new ae.Mat2D;ue.invert(L);var ee=new ae.Vec2D(ce,Re),We=ae.mapXY(L,ee),Ke=We.x(),Ye=We.y();switch(We.delete(),L.delete(),ee.delete(),ue.delete(),Le.type){case"mouseout":for(var ze=0,et=V;ze<et.length;ze++){var $e=et[ze];$e.pointerMove(Ke,Ye)}break;case"touchmove":case"mouseover":case"mousemove":{for(var ct=0,Ot=V;ct<Ot.length;ct++){var $e=Ot[ct];$e.pointerMove(Ke,Ye)}break}case"touchstart":case"mousedown":{for(var Ht=0,$n=V;Ht<$n.length;Ht++){var $e=$n[Ht];$e.pointerDown(Ke,Ye)}break}case"touchend":case"mouseup":{for(var pn=0,gr=V;pn<gr.length;pn++){var $e=gr[pn];$e.pointerUp(Ke,Ye)}break}}}},me=Y.bind(m);return S.addEventListener("mouseover",me),S.addEventListener("mouseout",me),S.addEventListener("mousemove",me),S.addEventListener("mousedown",me),S.addEventListener("mouseup",me),S.addEventListener("touchmove",me,{passive:J}),S.addEventListener("touchstart",me,{passive:J}),S.addEventListener("touchend",me),function(){S.removeEventListener("mouseover",me),S.removeEventListener("mouseout",me),S.removeEventListener("mousemove",me),S.removeEventListener("mousedown",me),S.removeEventListener("mouseup",me),S.removeEventListener("touchmove",me),S.removeEventListener("touchstart",me),S.removeEventListener("touchend",me)}}},(l,d,f)=>{f.r(d),f.d(d,{BLANK_URL:()=>N,sanitizeUrl:()=>ae});var m=/^([^\w]*)(javascript|data|vbscript)/im,v=/&#(\w+)(^\w|;)?/g,T=/&(newline|tab);/gi,x=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,S=/^.+(:|&colon;)/gim,M=[".","/"],N="about:blank";function V(z){return M.indexOf(z[0])>-1}function $(z){var A=z.replace(x,"");return A.replace(v,function(F,J){return String.fromCharCode(J)})}function ae(z){if(!z)return N;var A=$(z).replace(T,"").replace(x,"").trim();if(!A)return N;if(V(A))return A;var F=A.match(S);if(!F)return A;var J=F[0];return m.test(J)?N:A}},(l,d,f)=>{f.r(d),f.d(d,{AudioAssetWrapper:()=>z,AudioWrapper:()=>M,CustomFileAssetLoaderWrapper:()=>V,FileAssetWrapper:()=>$,FileFinalizer:()=>v,FontAssetWrapper:()=>A,FontWrapper:()=>N,ImageAssetWrapper:()=>ae,ImageWrapper:()=>S,createFinalization:()=>te,finalizationRegistry:()=>de});var m=function(){var K=function(ne,Y){return K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(me,Le){me.__proto__=Le}||function(me,Le){for(var le in Le)Object.prototype.hasOwnProperty.call(Le,le)&&(me[le]=Le[le])},K(ne,Y)};return function(ne,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Class extends value "+String(Y)+" is not a constructor or null");K(ne,Y);function me(){this.constructor=ne}ne.prototype=Y===null?Object.create(Y):(me.prototype=Y.prototype,new me)}}(),v=function(){function K(ne){this.selfUnref=!1,this._file=ne}return K.prototype.unref=function(){this._file&&this._file.unref()},K}(),T=function(){function K(ne){this._finalizableObject=ne}return K.prototype.unref=function(){this._finalizableObject.unref()},K}(),x=function(){function K(){this.selfUnref=!1}return K.prototype.unref=function(){},K}(),S=function(K){m(ne,K);function ne(Y){var me=K.call(this)||this;return me._nativeImage=Y,me}return Object.defineProperty(ne.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),ne.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},ne}(x),M=function(K){m(ne,K);function ne(Y){var me=K.call(this)||this;return me._nativeAudio=Y,me}return Object.defineProperty(ne.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),ne.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},ne}(x),N=function(K){m(ne,K);function ne(Y){var me=K.call(this)||this;return me._nativeFont=Y,me}return Object.defineProperty(ne.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),ne.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},ne}(x),V=function(){function K(ne,Y){this._assetLoaderCallback=Y,this.assetLoader=new ne.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return K.prototype.loadContents=function(ne,Y){var me;return ne.isImage?me=new ae(ne):ne.isAudio?me=new z(ne):ne.isFont&&(me=new A(ne)),this._assetLoaderCallback(me,Y)},K}(),$=function(){function K(ne){this._nativeFileAsset=ne}return K.prototype.decode=function(ne){this._nativeFileAsset.decode(ne)},Object.defineProperty(K.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),K}(),ae=function(K){m(ne,K);function ne(){return K!==null&&K.apply(this,arguments)||this}return ne.prototype.setRenderImage=function(Y){this._nativeFileAsset.setRenderImage(Y.nativeImage)},ne}($),z=function(K){m(ne,K);function ne(){return K!==null&&K.apply(this,arguments)||this}return ne.prototype.setAudioSource=function(Y){this._nativeFileAsset.setAudioSource(Y.nativeAudio)},ne}($),A=function(K){m(ne,K);function ne(){return K!==null&&K.apply(this,arguments)||this}return ne.prototype.setFont=function(Y){this._nativeFileAsset.setFont(Y.nativeFont)},ne}($),F=function(){function K(ne){}return K.prototype.register=function(ne){ne.selfUnref=!0},K.prototype.unregister=function(ne){},K}(),J=typeof FinalizationRegistry<"u"?FinalizationRegistry:F,de=new J(function(K){K==null||K.unref()}),te=function(K,ne){var Y=new T(ne);de.register(K,Y)}}],r={};function o(l){var d=r[l];if(d!==void 0)return d.exports;var f=r[l]={exports:{}};return t[l](f,f.exports,o),f.exports}o.d=(l,d)=>{for(var f in d)o.o(d,f)&&!o.o(l,f)&&Object.defineProperty(l,f,{enumerable:!0,get:d[f]})},o.o=(l,d)=>Object.prototype.hasOwnProperty.call(l,d),o.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{Alignment:()=>ae,DataEnum:()=>Ye,EventType:()=>Y,Fit:()=>$,Layout:()=>z,LoopType:()=>me,Rive:()=>We,RiveEventType:()=>de,RiveFile:()=>ee,RuntimeLoader:()=>A,StateMachineInput:()=>J,StateMachineInputType:()=>F,Testing:()=>xi,ViewModel:()=>Ke,ViewModelInstance:()=>et,ViewModelInstanceArtboard:()=>Ti,ViewModelInstanceAssetImage:()=>Gi,ViewModelInstanceBoolean:()=>Ht,ViewModelInstanceColor:()=>vr,ViewModelInstanceEnum:()=>pn,ViewModelInstanceList:()=>gr,ViewModelInstanceNumber:()=>Ot,ViewModelInstanceString:()=>ct,ViewModelInstanceTrigger:()=>$n,ViewModelInstanceValue:()=>$e,decodeAudio:()=>Nn,decodeFont:()=>_o,decodeImage:()=>Ei});var l=o(1),d=o(2),f=o(3),m=o(5),v=function(){var _=function(y,C){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,W){O.__proto__=W}||function(O,W){for(var se in W)Object.prototype.hasOwnProperty.call(W,se)&&(O[se]=W[se])},_(y,C)};return function(y,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");_(y,C);function O(){this.constructor=y}y.prototype=C===null?Object.create(C):(O.prototype=C.prototype,new O)}}(),T=function(){return T=Object.assign||function(_){for(var y,C=1,O=arguments.length;C<O;C++){y=arguments[C];for(var W in y)Object.prototype.hasOwnProperty.call(y,W)&&(_[W]=y[W])}return _},T.apply(this,arguments)},x=function(_,y,C,O){function W(se){return se instanceof C?se:new C(function(be){be(se)})}return new(C||(C=Promise))(function(se,be){function Ge(at){try{Ne(O.next(at))}catch(Ct){be(Ct)}}function it(at){try{Ne(O.throw(at))}catch(Ct){be(Ct)}}function Ne(at){at.done?se(at.value):W(at.value).then(Ge,it)}Ne((O=O.apply(_,[])).next())})},S=function(_,y){var C={label:0,sent:function(){if(se[0]&1)throw se[1];return se[1]},trys:[],ops:[]},O,W,se,be=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return be.next=Ge(0),be.throw=Ge(1),be.return=Ge(2),typeof Symbol=="function"&&(be[Symbol.iterator]=function(){return this}),be;function Ge(Ne){return function(at){return it([Ne,at])}}function it(Ne){if(O)throw new TypeError("Generator is already executing.");for(;be&&(be=0,Ne[0]&&(C=0)),C;)try{if(O=1,W&&(se=Ne[0]&2?W.return:Ne[0]?W.throw||((se=W.return)&&se.call(W),0):W.next)&&!(se=se.call(W,Ne[1])).done)return se;switch(W=0,se&&(Ne=[Ne[0]&2,se.value]),Ne[0]){case 0:case 1:se=Ne;break;case 4:return C.label++,{value:Ne[1],done:!1};case 5:C.label++,W=Ne[1],Ne=[0];continue;case 7:Ne=C.ops.pop(),C.trys.pop();continue;default:if(se=C.trys,!(se=se.length>0&&se[se.length-1])&&(Ne[0]===6||Ne[0]===2)){C=0;continue}if(Ne[0]===3&&(!se||Ne[1]>se[0]&&Ne[1]<se[3])){C.label=Ne[1];break}if(Ne[0]===6&&C.label<se[1]){C.label=se[1],se=Ne;break}if(se&&C.label<se[2]){C.label=se[2],C.ops.push(Ne);break}se[2]&&C.ops.pop(),C.trys.pop();continue}Ne=y.call(_,C)}catch(at){Ne=[6,at],W=0}finally{O=se=0}if(Ne[0]&5)throw Ne[1];return{value:Ne[0]?Ne[1]:void 0,done:!0}}},M=function(_,y,C){for(var O=0,W=y.length,se;O<W;O++)(se||!(O in y))&&(se||(se=Array.prototype.slice.call(y,0,O)),se[O]=y[O]);return _.concat(se||Array.prototype.slice.call(y))},N=function(_){v(y,_);function y(){var C=_!==null&&_.apply(this,arguments)||this;return C.isHandledError=!0,C}return y}(Error),V=function(_){return _&&_.isHandledError?_.message:"Problem loading file; may be corrupt!"},$;(function(_){_.Cover="cover",_.Contain="contain",_.Fill="fill",_.FitWidth="fitWidth",_.FitHeight="fitHeight",_.None="none",_.ScaleDown="scaleDown",_.Layout="layout"})($||($={}));var ae;(function(_){_.Center="center",_.TopLeft="topLeft",_.TopCenter="topCenter",_.TopRight="topRight",_.CenterLeft="centerLeft",_.CenterRight="centerRight",_.BottomLeft="bottomLeft",_.BottomCenter="bottomCenter",_.BottomRight="bottomRight"})(ae||(ae={}));var z=function(){function _(y){var C,O,W,se,be,Ge,it;this.fit=(C=y==null?void 0:y.fit)!==null&&C!==void 0?C:$.Contain,this.alignment=(O=y==null?void 0:y.alignment)!==null&&O!==void 0?O:ae.Center,this.layoutScaleFactor=(W=y==null?void 0:y.layoutScaleFactor)!==null&&W!==void 0?W:1,this.minX=(se=y==null?void 0:y.minX)!==null&&se!==void 0?se:0,this.minY=(be=y==null?void 0:y.minY)!==null&&be!==void 0?be:0,this.maxX=(Ge=y==null?void 0:y.maxX)!==null&&Ge!==void 0?Ge:0,this.maxY=(it=y==null?void 0:y.maxY)!==null&&it!==void 0?it:0}return _.new=function(y){var C=y.fit,O=y.alignment,W=y.minX,se=y.minY,be=y.maxX,Ge=y.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new _({fit:C,alignment:O,minX:W,minY:se,maxX:be,maxY:Ge})},_.prototype.copyWith=function(y){var C=y.fit,O=y.alignment,W=y.layoutScaleFactor,se=y.minX,be=y.minY,Ge=y.maxX,it=y.maxY;return new _({fit:C??this.fit,alignment:O??this.alignment,layoutScaleFactor:W??this.layoutScaleFactor,minX:se??this.minX,minY:be??this.minY,maxX:Ge??this.maxX,maxY:it??this.maxY})},_.prototype.runtimeFit=function(y){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var C;return this.fit===$.Cover?C=y.Fit.cover:this.fit===$.Contain?C=y.Fit.contain:this.fit===$.Fill?C=y.Fit.fill:this.fit===$.FitWidth?C=y.Fit.fitWidth:this.fit===$.FitHeight?C=y.Fit.fitHeight:this.fit===$.ScaleDown?C=y.Fit.scaleDown:this.fit===$.Layout?C=y.Fit.layout:C=y.Fit.none,this.cachedRuntimeFit=C,C},_.prototype.runtimeAlignment=function(y){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var C;return this.alignment===ae.TopLeft?C=y.Alignment.topLeft:this.alignment===ae.TopCenter?C=y.Alignment.topCenter:this.alignment===ae.TopRight?C=y.Alignment.topRight:this.alignment===ae.CenterLeft?C=y.Alignment.centerLeft:this.alignment===ae.CenterRight?C=y.Alignment.centerRight:this.alignment===ae.BottomLeft?C=y.Alignment.bottomLeft:this.alignment===ae.BottomCenter?C=y.Alignment.bottomCenter:this.alignment===ae.BottomRight?C=y.Alignment.bottomRight:C=y.Alignment.center,this.cachedRuntimeAlignment=C,C},_}(),A=function(){function _(){}return _.loadRuntime=function(){l.default({locateFile:function(){return _.wasmURL}}).then(function(y){var C;for(_.runtime=y;_.callBackQueue.length>0;)(C=_.callBackQueue.shift())===null||C===void 0||C(_.runtime)}).catch(function(y){var C={message:(y==null?void 0:y.message)||"Unknown error",type:(y==null?void 0:y.name)||"Error",wasmError:y instanceof WebAssembly.CompileError||y instanceof WebAssembly.RuntimeError,originalError:y};console.debug("Rive WASM load error details:",C);var O="https://cdn.jsdelivr.net/npm/".concat(d.name,"@").concat(d.version,"/rive_fallback.wasm");if(_.wasmURL.toLowerCase()!==O)console.warn("Failed to load WASM from ".concat(_.wasmURL," (").concat(C.message,"), trying jsdelivr as a backup")),_.setWasmUrl(O),_.loadRuntime();else{var W=["Could not load Rive WASM file from ".concat(_.wasmURL," or ").concat(O,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(C.type),"- Message: ".concat(C.message),"- WebAssembly-specific error: ".concat(C.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(W)}})},_.getInstance=function(y){_.isLoading||(_.isLoading=!0,_.loadRuntime()),_.runtime?y(_.runtime):_.callBackQueue.push(y)},_.awaitInstance=function(){return new Promise(function(y){return _.getInstance(function(C){return y(C)})})},_.setWasmUrl=function(y){_.wasmURL=y},_.getWasmUrl=function(){return _.wasmURL},_.isLoading=!1,_.callBackQueue=[],_.wasmURL="https://unpkg.com/".concat(d.name,"@").concat(d.version,"/rive.wasm"),_}(),F;(function(_){_[_.Number=56]="Number",_[_.Trigger=58]="Trigger",_[_.Boolean=59]="Boolean"})(F||(F={}));var J=function(){function _(y,C){this.type=y,this.runtimeInput=C}return Object.defineProperty(_.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(y){this.runtimeInput.value=y},enumerable:!1,configurable:!0}),_.prototype.fire=function(){this.type===F.Trigger&&this.runtimeInput.fire()},_.prototype.delete=function(){this.runtimeInput=null},_}(),de;(function(_){_[_.General=128]="General",_[_.OpenUrl=131]="OpenUrl"})(de||(de={}));var te=function(){function _(y){this.nativeArtboard=y}return _}(),K=function(){function _(y,C,O,W){this.stateMachine=y,this.playing=O,this.artboard=W,this.inputs=[],this.instance=new C.StateMachineInstance(y,W),this.initInputs(C)}return Object.defineProperty(_.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"statesChanged",{get:function(){for(var y=[],C=0;C<this.instance.stateChangedCount();C++)y.push(this.instance.stateChangedNameByIndex(C));return y},enumerable:!1,configurable:!0}),_.prototype.advance=function(y){this.instance.advance(y)},_.prototype.advanceAndApply=function(y){this.instance.advanceAndApply(y)},_.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},_.prototype.reportedEventAt=function(y){return this.instance.reportedEventAt(y)},_.prototype.initInputs=function(y){for(var C=0;C<this.instance.inputCount();C++){var O=this.instance.input(C);this.inputs.push(this.mapRuntimeInput(O,y))}},_.prototype.mapRuntimeInput=function(y,C){if(y.type===C.SMIInput.bool)return new J(F.Boolean,y.asBool());if(y.type===C.SMIInput.number)return new J(F.Number,y.asNumber());if(y.type===C.SMIInput.trigger)return new J(F.Trigger,y.asTrigger())},_.prototype.cleanup=function(){this.inputs.forEach(function(y){y.delete()}),this.inputs.length=0,this.instance.delete()},_.prototype.bindViewModelInstance=function(y){y.runtimeInstance!=null&&this.instance.bindViewModelInstance(y.runtimeInstance)},_}(),ne=function(){function _(y,C,O,W,se){W===void 0&&(W=[]),se===void 0&&(se=[]),this.runtime=y,this.artboard=C,this.eventManager=O,this.animations=W,this.stateMachines=se}return _.prototype.add=function(y,C,O){if(O===void 0&&(O=!0),y=fn(y),y.length===0)this.animations.forEach(function(St){return St.playing=C}),this.stateMachines.forEach(function(St){return St.playing=C});else for(var W=this.animations.map(function(St){return St.name}),se=this.stateMachines.map(function(St){return St.name}),be=0;be<y.length;be++){var Ge=W.indexOf(y[be]),it=se.indexOf(y[be]);if(Ge>=0||it>=0)Ge>=0?this.animations[Ge].playing=C:this.stateMachines[it].playing=C;else{var Ne=this.artboard.animationByName(y[be]);if(Ne){var at=new f.Animation(Ne,this.artboard,this.runtime,C);at.advance(0),at.apply(1),this.animations.push(at)}else{var Ct=this.artboard.stateMachineByName(y[be]);if(Ct){var qt=new K(Ct,this.runtime,C,this.artboard);this.stateMachines.push(qt)}}}}return O&&(C?this.eventManager.fire({type:Y.Play,data:this.playing}):this.eventManager.fire({type:Y.Pause,data:this.paused})),C?this.playing:this.paused},_.prototype.initLinearAnimations=function(y,C){for(var O=this.animations.map(function(it){return it.name}),W=0;W<y.length;W++){var se=O.indexOf(y[W]);if(se>=0)this.animations[se].playing=C;else{var be=this.artboard.animationByName(y[W]);if(be){var Ge=new f.Animation(be,this.artboard,this.runtime,C);Ge.advance(0),Ge.apply(1),this.animations.push(Ge)}else console.error("Animation with name ".concat(y[W]," not found."))}}},_.prototype.initStateMachines=function(y,C){for(var O=this.stateMachines.map(function(it){return it.name}),W=0;W<y.length;W++){var se=O.indexOf(y[W]);if(se>=0)this.stateMachines[se].playing=C;else{var be=this.artboard.stateMachineByName(y[W]);if(be){var Ge=new K(be,this.runtime,C,this.artboard);this.stateMachines.push(Ge)}else console.warn("State Machine with name ".concat(y[W]," not found.")),this.initLinearAnimations([y[W]],C)}}},_.prototype.play=function(y){return this.add(y,!0)},_.prototype.advanceIfPaused=function(){this.stateMachines.forEach(function(y){y.playing||y.advanceAndApply(0)})},_.prototype.pause=function(y){return this.add(y,!1)},_.prototype.scrub=function(y,C){var O=this.animations.filter(function(W){return y.includes(W.name)});return O.forEach(function(W){return W.scrubTo=C}),O.map(function(W){return W.name})},Object.defineProperty(_.prototype,"playing",{get:function(){return this.animations.filter(function(y){return y.playing}).map(function(y){return y.name}).concat(this.stateMachines.filter(function(y){return y.playing}).map(function(y){return y.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"paused",{get:function(){return this.animations.filter(function(y){return!y.playing}).map(function(y){return y.name}).concat(this.stateMachines.filter(function(y){return!y.playing}).map(function(y){return y.name}))},enumerable:!1,configurable:!0}),_.prototype.stop=function(y){var C=this;y=fn(y);var O=[];if(y.length===0)O=this.animations.map(function(be){return be.name}).concat(this.stateMachines.map(function(be){return be.name})),this.animations.forEach(function(be){return be.cleanup()}),this.stateMachines.forEach(function(be){return be.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var W=this.animations.filter(function(be){return y.includes(be.name)});W.forEach(function(be){be.cleanup(),C.animations.splice(C.animations.indexOf(be),1)});var se=this.stateMachines.filter(function(be){return y.includes(be.name)});se.forEach(function(be){be.cleanup(),C.stateMachines.splice(C.stateMachines.indexOf(be),1)}),O=W.map(function(be){return be.name}).concat(se.map(function(be){return be.name}))}return this.eventManager.fire({type:Y.Stop,data:O}),O},Object.defineProperty(_.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(y,C){return y||C.playing},!1)||this.stateMachines.reduce(function(y,C){return y||C.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),_.prototype.atLeastOne=function(y,C){C===void 0&&(C=!0);var O;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([O=this.artboard.animationByIndex(0).name],y,C):this.artboard.stateMachineCount()>0&&this.add([O=this.artboard.stateMachineByIndex(0).name],y,C)),O},_.prototype.handleLooping=function(){for(var y=0,C=this.animations.filter(function(W){return W.playing});y<C.length;y++){var O=C[y];O.loopValue===0&&O.loopCount?(O.loopCount=0,this.stop(O.name)):O.loopValue===1&&O.loopCount?(this.eventManager.fire({type:Y.Loop,data:{animation:O.name,type:me.Loop}}),O.loopCount=0):O.loopValue===2&&O.loopCount>1&&(this.eventManager.fire({type:Y.Loop,data:{animation:O.name,type:me.PingPong}}),O.loopCount=0)}},_.prototype.handleStateChanges=function(){for(var y=[],C=0,O=this.stateMachines.filter(function(se){return se.playing});C<O.length;C++){var W=O[C];y.push.apply(y,W.statesChanged)}y.length>0&&this.eventManager.fire({type:Y.StateChange,data:y})},_.prototype.handleAdvancing=function(y){this.eventManager.fire({type:Y.Advance,data:y})},_}(),Y;(function(_){_.Load="load",_.LoadError="loaderror",_.Play="play",_.Pause="pause",_.Stop="stop",_.Loop="loop",_.Draw="draw",_.Advance="advance",_.StateChange="statechange",_.RiveEvent="riveevent",_.AudioStatusChange="audiostatuschange"})(Y||(Y={}));var me;(function(_){_.OneShot="oneshot",_.Loop="loop",_.PingPong="pingpong"})(me||(me={}));var Le=function(){function _(y){y===void 0&&(y=[]),this.listeners=y}return _.prototype.getListeners=function(y){return this.listeners.filter(function(C){return C.type===y})},_.prototype.add=function(y){this.listeners.includes(y)||this.listeners.push(y)},_.prototype.remove=function(y){for(var C=0;C<this.listeners.length;C++){var O=this.listeners[C];if(O.type===y.type&&O.callback===y.callback){this.listeners.splice(C,1);break}}},_.prototype.removeAll=function(y){var C=this;y?this.listeners.filter(function(O){return O.type===y}).forEach(function(O){return C.remove(O)}):this.listeners.splice(0,this.listeners.length)},_.prototype.fire=function(y){var C=this.getListeners(y.type);C.forEach(function(O){return O.callback(y)})},_}(),le=function(){function _(y){this.eventManager=y,this.queue=[]}return _.prototype.add=function(y){this.queue.push(y)},_.prototype.process=function(){for(;this.queue.length>0;){var y=this.queue.shift();y!=null&&y.action&&y.action(),y!=null&&y.event&&this.eventManager.fire(y.event)}},_}(),pe;(function(_){_[_.AVAILABLE=0]="AVAILABLE",_[_.UNAVAILABLE=1]="UNAVAILABLE"})(pe||(pe={}));var Oe=function(_){v(y,_);function y(){var C=_!==null&&_.apply(this,arguments)||this;return C._started=!1,C._enabled=!1,C._status=pe.UNAVAILABLE,C}return y.prototype.delay=function(C){return x(this,void 0,void 0,function(){return S(this,function(O){return[2,new Promise(function(W){return setTimeout(W,C)})]})})},y.prototype.timeout=function(){return x(this,void 0,void 0,function(){return S(this,function(C){return[2,new Promise(function(O,W){return setTimeout(W,50)})]})})},y.prototype.reportToListeners=function(){this.fire({type:Y.AudioStatusChange}),this.removeAll()},y.prototype.enableAudio=function(){return x(this,void 0,void 0,function(){return S(this,function(C){return this._enabled||(this._enabled=!0,this._status=pe.AVAILABLE,this.reportToListeners()),[2]})})},y.prototype.testAudio=function(){return x(this,void 0,void 0,function(){return S(this,function(C){switch(C.label){case 0:if(!(this._status===pe.UNAVAILABLE&&this._audioContext!==null))return[3,4];C.label=1;case 1:return C.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return C.sent(),this.enableAudio(),[3,4];case 3:return C.sent(),[3,4];case 4:return[2]}})})},y.prototype._establishAudio=function(){return x(this,void 0,void 0,function(){return S(this,function(C){switch(C.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),C.label=2;case 2:return this._status!==pe.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return C.sent(),[4,this.delay(1e3)];case 4:return C.sent(),[3,2];case 5:return[2]}})})},y.prototype.listenForUserAction=function(){var C=this,O=function(){return x(C,void 0,void 0,function(){return S(this,function(W){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",O,{once:!0})},y.prototype.establishAudio=function(){return x(this,void 0,void 0,function(){return S(this,function(C){return this._establishAudio(),[2]})})},Object.defineProperty(y.prototype,"systemVolume",{get:function(){return this._status===pe.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),y}(Le),Ee=new Oe,ce=function(){function _(){}return _.prototype.observe=function(){},_.prototype.unobserve=function(){},_.prototype.disconnect=function(){},_}(),Re=globalThis.ResizeObserver||ce,ue=function(){function _(){var y=this;this._elementsMap=new Map,this._onObservedEntry=function(C){var O=y._elementsMap.get(C.target);O!==null?O.onResize(C.target.clientWidth==0||C.target.clientHeight==0):y._resizeObserver.unobserve(C.target)},this._onObserved=function(C){C.forEach(y._onObservedEntry)},this._resizeObserver=new Re(this._onObserved)}return _.prototype.add=function(y,C){var O={onResize:C,element:y};return this._elementsMap.set(y,O),this._resizeObserver.observe(y),O},_.prototype.remove=function(y){this._resizeObserver.unobserve(y.element),this._elementsMap.delete(y.element)},_}(),L=new ue,ee=function(){function _(y){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.selfUnref=!1,this.src=y.src,this.buffer=y.buffer,y.assetLoader&&(this.assetLoader=y.assetLoader),this.enableRiveAssetCDN=typeof y.enableRiveAssetCDN=="boolean"?y.enableRiveAssetCDN:!0,this.eventManager=new Le,y.onLoad&&this.on(Y.Load,y.onLoad),y.onLoadError&&this.on(Y.LoadError,y.onLoadError)}return _.prototype.releaseFile=function(){var y;this.selfUnref&&((y=this.file)===null||y===void 0||y.unref()),this.file=null},_.prototype.initData=function(){return x(this,void 0,void 0,function(){var y,C,O,W,se;return S(this,function(be){switch(be.label){case 0:return this.src?(y=this,[4,Po(this.src)]):[3,2];case 1:y.buffer=be.sent(),be.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(O=new m.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),C=O.assetLoader),W=this,[4,this.runtime.load(new Uint8Array(this.buffer),C,this.enableRiveAssetCDN)]);case 3:return W.file=be.sent(),se=new m.FileFinalizer(this.file),m.finalizationRegistry.register(this,se),this.destroyed?(this.releaseFile(),[2]):(this.file!==null?this.eventManager.fire({type:Y.Load,data:this}):this.fireLoadError(_.fileLoadErrorMessage),[2])}})})},_.prototype.init=function(){return x(this,void 0,void 0,function(){var y,C;return S(this,function(O){switch(O.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(_.missingErrorMessage),[2];O.label=1;case 1:return O.trys.push([1,4,,5]),y=this,[4,A.awaitInstance()];case 2:return y.runtime=O.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return O.sent(),[3,5];case 4:return C=O.sent(),this.fireLoadError(C instanceof Error?C.message:_.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},_.prototype.fireLoadError=function(y){throw this.eventManager.fire({type:Y.LoadError,data:y}),new Error(y)},_.prototype.on=function(y,C){this.eventManager.add({type:y,callback:C})},_.prototype.off=function(y,C){this.eventManager.remove({type:y,callback:C})},_.prototype.cleanup=function(){this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),this.releaseFile(),this.destroyed=!0)},_.prototype.removeAllRiveEventListeners=function(y){this.eventManager.removeAll(y)},_.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},_.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},_.prototype.getArtboard=function(y){var C=this.file.artboardByName(y);return C!=null?new te(C):null},_.missingErrorMessage="Rive source file or data buffer required",_.fileLoadErrorMessage="The file failed to load",_}(),We=function(){function _(y){var C=this,O;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(W){var se=C._hasZeroSize!==W;C._hasZeroSize=W,W?(!C._layout.maxX||!C._layout.maxY)&&C.resizeToCanvas():se&&C.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=y.canvas,y.canvas.constructor===HTMLCanvasElement&&(this._observed=L.add(this.canvas,this.onCanvasResize)),this.src=y.src,this.buffer=y.buffer,this.riveFile=y.riveFile,this.layout=(O=y.layout)!==null&&O!==void 0?O:new z,this.shouldDisableRiveListeners=!!y.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!y.isTouchScrollEnabled,this.automaticallyHandleEvents=!!y.automaticallyHandleEvents,this.enableRiveAssetCDN=y.enableRiveAssetCDN===void 0?!0:y.enableRiveAssetCDN,this.eventManager=new Le,y.onLoad&&this.on(Y.Load,y.onLoad),y.onLoadError&&this.on(Y.LoadError,y.onLoadError),y.onPlay&&this.on(Y.Play,y.onPlay),y.onPause&&this.on(Y.Pause,y.onPause),y.onStop&&this.on(Y.Stop,y.onStop),y.onLoop&&this.on(Y.Loop,y.onLoop),y.onStateChange&&this.on(Y.StateChange,y.onStateChange),y.onAdvance&&this.on(Y.Advance,y.onAdvance),y.onload&&!y.onLoad&&this.on(Y.Load,y.onload),y.onloaderror&&!y.onLoadError&&this.on(Y.LoadError,y.onloaderror),y.onplay&&!y.onPlay&&this.on(Y.Play,y.onplay),y.onpause&&!y.onPause&&this.on(Y.Pause,y.onpause),y.onstop&&!y.onStop&&this.on(Y.Stop,y.onstop),y.onloop&&!y.onLoop&&this.on(Y.Loop,y.onloop),y.onstatechange&&!y.onStateChange&&this.on(Y.StateChange,y.onstatechange),y.assetLoader&&(this.assetLoader=y.assetLoader),this.taskQueue=new le(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:y.autoplay,autoBind:y.autoBind,animations:y.animations,stateMachines:y.stateMachines,artboard:y.artboard,useOffscreenRenderer:y.useOffscreenRenderer})}return Object.defineProperty(_.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),_.new=function(y){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new _(y)},_.prototype.onSystemAudioChanged=function(){this.volume=this._volume},_.prototype.init=function(y){var C=this,O=y.src,W=y.buffer,se=y.riveFile,be=y.animations,Ge=y.stateMachines,it=y.artboard,Ne=y.autoplay,at=Ne===void 0?!1:Ne,Ct=y.useOffscreenRenderer,qt=Ct===void 0?!1:Ct,St=y.autoBind,jn=St===void 0?!1:St;if(!this.destroyed){if(this.src=O,this.buffer=W,this.riveFile=se,!this.src&&!this.buffer&&!this.riveFile)throw new N(_.missingErrorMessage);var Tn=fn(be),mn=fn(Ge);this.loaded=!1,this.readyForPlaying=!1,A.awaitInstance().then(function(Yt){C.destroyed||(C.runtime=Yt,C.removeRiveListeners(),C.deleteRiveRenderer(),C.renderer=C.runtime.makeRenderer(C.canvas,qt),C.canvas.width||C.canvas.height||C.resizeDrawingSurfaceToCanvas(),C.initData(it,Tn,mn,at,jn).then(function(nn){if(nn)return C.setupRiveListeners()}).catch(function(nn){console.error(nn)}))}).catch(function(Yt){console.error(Yt)})}},_.prototype.setupRiveListeners=function(y){var C=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var O=(this.animator.stateMachines||[]).filter(function(se){return se.playing&&C.runtime.hasListeners(se.instance)}).map(function(se){return se.instance}),W=this.isTouchScrollEnabled;y&&"isTouchScrollEnabled"in y&&(W=y.isTouchScrollEnabled),this.eventCleanup=(0,m.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:O,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:W,layoutScaleFactor:this._layout.layoutScaleFactor})}},_.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},_.prototype.initializeAudio=function(){var y=this,C;Ee.status==pe.UNAVAILABLE&&!((C=this.artboard)===null||C===void 0)&&C.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:Y.AudioStatusChange,callback:function(){return y.onSystemAudioChanged()}},Ee.add(this._audioEventListener),Ee.establishAudio())},_.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},_.prototype.initData=function(y,C,O,W,se){return x(this,void 0,void 0,function(){var be,Ge,it,Ne;return S(this,function(at){switch(at.label){case 0:return at.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(be=new ee({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=be,[4,be.init()]);case 1:if(at.sent(),this.destroyed)return be.destroyIfUnused(),[2,!1];at.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(y,C,O,W,se),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:Y.Load,data:(Ne=this.src)!==null&&Ne!==void 0?Ne:"buffer"}),this.animator.advanceIfPaused(),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return Ge=at.sent(),it=V(Ge),console.warn(it),this.eventManager.fire({type:Y.LoadError,data:it}),[2,Promise.reject(it)];case 4:return[2]}})})},_.prototype.initArtboard=function(y,C,O,W,se){if(this.file){var be=y?this.file.artboardByName(y):this.file.defaultArtboard();if(!be){var Ge="Invalid artboard name or no default artboard";console.warn(Ge),this.eventManager.fire({type:Y.LoadError,data:Ge});return}this.artboard=be,be.volume=this._volume*Ee.systemVolume,this.animator=new ne(this.runtime,this.artboard,this.eventManager);var it;if(C.length>0||O.length>0?(it=C.concat(O),this.animator.initLinearAnimations(C,W),this.animator.initStateMachines(O,W)):it=[this.animator.atLeastOne(W,!1)],this.taskQueue.add({event:{type:W?Y.Play:Y.Pause,data:it}}),se){var Ne=this.file.defaultArtboardViewModel(be);if(Ne!==null){var at=Ne.defaultInstance();if(at!==null){var Ct=new et(at,null);this.bindViewModelInstance(Ct)}}}}},_.prototype.drawFrame=function(){var y,C;!((y=document==null?void 0:document.timeline)===null||y===void 0)&&y.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(C=this.runtime)===null||C===void 0||C.resolveAnimationFrame()):this.startRendering()},_.prototype.draw=function(y,C){var O;this.frameRequestId=null;var W=performance.now();this.lastRenderTime||(this.lastRenderTime=y),this.renderSecondTimer+=y-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,C==null||C());var se=(y-this.lastRenderTime)/1e3;this.lastRenderTime=y;for(var be=this.animator.animations.filter(function(Un){return Un.playing||Un.needsScrub}).sort(function(Un){return Un.needsScrub?-1:1}),Ge=0,it=be;Ge<it.length;Ge++){var Ne=it[Ge];Ne.advance(se),Ne.instance.didLoop&&(Ne.loopCount+=1),Ne.apply(1)}for(var at=this.animator.stateMachines.filter(function(Un){return Un.playing}),Ct=0,qt=at;Ct<qt.length;Ct++){var St=qt[Ct],jn=St.reportedEventCount();if(jn)for(var Tn=0;Tn<jn;Tn++){var mn=St.reportedEventAt(Tn);if(mn)if(mn.type===de.OpenUrl){if(this.eventManager.fire({type:Y.RiveEvent,data:mn}),this.automaticallyHandleEvents){var Yt=document.createElement("a"),nn=mn,br=nn.url,Je=nn.target,yr=(0,m.sanitizeUrl)(br);br&&Yt.setAttribute("href",yr),Je&&Yt.setAttribute("target",Je),yr&&yr!==m.BLANK_URL&&Yt.click()}}else this.eventManager.fire({type:Y.RiveEvent,data:mn})}St.advanceAndApply(se)}this.animator.stateMachines.length==0&&this.artboard.advance(se);var Dn=this.renderer;Dn.clear(),Dn.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(Dn),Dn.restore(),Dn.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(se),this.frameCount++;var ut=performance.now();for(this.frameTimes.push(ut),this.durations.push(ut-W);this.frameTimes[0]<=ut-1e3;)this.frameTimes.shift(),this.durations.shift();(O=this._viewModelInstance)===null||O===void 0||O.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},_.prototype.alignRenderer=function(){var y=this,C=y.renderer,O=y.runtime,W=y._layout,se=y.artboard;C.align(W.runtimeFit(O),W.runtimeAlignment(O),{minX:W.minX,minY:W.minY,maxX:W.maxX,maxY:W.maxY},se.bounds,this._devicePixelRatioUsed*W.layoutScaleFactor)},Object.defineProperty(_.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(y,C){return y+C},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),_.prototype.cleanup=function(){var y,C;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&L.remove(this._observed),this.removeRiveListeners(),this.file&&((y=this.riveFile)===null||y===void 0||y.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(Ee.remove(this._audioEventListener),this._audioEventListener=null),(C=this._viewModelInstance)===null||C===void 0||C.cleanup(),this._viewModelInstance=null,this._dataEnums=null},_.prototype.deleteRiveRenderer=function(){var y;(y=this.renderer)===null||y===void 0||y.delete(),this.renderer=null},_.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},_.prototype.retrieveTextRun=function(y){var C;if(!y){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var O=this.artboard.textRun(y);if(!O){console.warn("Could not access a text run with name '".concat(y,"' in the '").concat((C=this.artboard)===null||C===void 0?void 0:C.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return O},_.prototype.getTextRunValue=function(y){var C=this.retrieveTextRun(y);return C?C.text:void 0},_.prototype.setTextRunValue=function(y,C){var O=this.retrieveTextRun(y);O&&(O.text=C)},_.prototype.play=function(y,C){var O=this;if(y=fn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return O.play(y,C)}});return}this.animator.play(y),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},_.prototype.pause=function(y){var C=this;if(y=fn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return C.pause(y)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(y)},_.prototype.scrub=function(y,C){var O=this;if(y=fn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return O.scrub(y,C)}});return}this.animator.scrub(y,C||0),this.drawFrame()},_.prototype.stop=function(y){var C=this;if(y=fn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return C.stop(y)}});return}this.animator&&this.animator.stop(y),this.eventCleanup&&this.eventCleanup()},_.prototype.reset=function(y){var C,O,W=y==null?void 0:y.artboard,se=fn(y==null?void 0:y.animations),be=fn(y==null?void 0:y.stateMachines),Ge=(C=y==null?void 0:y.autoplay)!==null&&C!==void 0?C:!1,it=(O=y==null?void 0:y.autoBind)!==null&&O!==void 0?O:!1;this.cleanupInstances(),this.initArtboard(W,se,be,Ge,it),this.taskQueue.process()},_.prototype.load=function(y){this.file=null,this.stop(),this.init(y)},Object.defineProperty(_.prototype,"layout",{get:function(){return this._layout},set:function(y){this._layout=y,(!y.maxX||!y.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),_.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},_.prototype.resizeDrawingSurfaceToCanvas=function(y){if(this.canvas instanceof HTMLCanvasElement&&window){var C=this.canvas.getBoundingClientRect(),O=C.width,W=C.height,se=y||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=se,this.canvas.width=se*O,this.canvas.height=se*W,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===$.Layout){var be=this._layout.layoutScaleFactor;this.artboard.width=O/be,this.artboard.height=W/be}}},Object.defineProperty(_.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var y=[],C=0;C<this.artboard.animationCount();C++)y.push(this.artboard.animationByIndex(C).name);return y},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var y=[],C=0;C<this.artboard.stateMachineCount();C++)y.push(this.artboard.stateMachineByIndex(C).name);return y},enumerable:!1,configurable:!0}),_.prototype.stateMachineInputs=function(y){if(this.loaded){var C=this.animator.stateMachines.find(function(O){return O.name===y});return C==null?void 0:C.inputs}},_.prototype.retrieveInputAtPath=function(y,C){if(!y){console.warn("No input name provided for path '".concat(C,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(y,"', at path: '").concat(C,"', but the Artboard is null"));return}var O=this.artboard.inputByPath(y,C);if(!O){console.warn("Could not access an input with name: '".concat(y,"', at path:'").concat(C,"'"));return}return O},_.prototype.setBooleanStateAtPath=function(y,C,O){var W=this.retrieveInputAtPath(y,O);W&&(W.type===F.Boolean?W.asBool().value=C:console.warn("Input with name: '".concat(y,"', at path:'").concat(O,"' is not a boolean")))},_.prototype.setNumberStateAtPath=function(y,C,O){var W=this.retrieveInputAtPath(y,O);W&&(W.type===F.Number?W.asNumber().value=C:console.warn("Input with name: '".concat(y,"', at path:'").concat(O,"' is not a number")))},_.prototype.fireStateAtPath=function(y,C){var O=this.retrieveInputAtPath(y,C);O&&(O.type===F.Trigger?O.asTrigger().fire():console.warn("Input with name: '".concat(y,"', at path:'").concat(C,"' is not a trigger")))},_.prototype.retrieveTextAtPath=function(y,C){if(!y){console.warn("No text name provided for path '".concat(C,"'"));return}if(!C){console.warn("No path provided for text '".concat(y,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(y,"', at path: '").concat(C,"', but the Artboard is null"));return}var O=this.artboard.textByPath(y,C);if(!O){console.warn("Could not access text with name: '".concat(y,"', at path:'").concat(C,"'"));return}return O},_.prototype.getTextRunValueAtPath=function(y,C){var O=this.retrieveTextAtPath(y,C);if(!O){console.warn("Could not get text with name: '".concat(y,"', at path:'").concat(C,"'"));return}return O.text},_.prototype.setTextRunValueAtPath=function(y,C,O){var W=this.retrieveTextAtPath(y,O);if(!W){console.warn("Could not set text with name: '".concat(y,"', at path:'").concat(O,"'"));return}W.text=C},Object.defineProperty(_.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(y){return y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(y){return y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(y){return!y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(y){return!y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),_.prototype.on=function(y,C){this.eventManager.add({type:y,callback:C})},_.prototype.off=function(y,C){this.eventManager.remove({type:y,callback:C})},_.prototype.unsubscribe=function(y,C){console.warn("This function is deprecated: please use `off()` instead."),this.off(y,C)},_.prototype.removeAllRiveEventListeners=function(y){this.eventManager.removeAll(y)},_.prototype.unsubscribeAll=function(y){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(y)},_.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},_.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},_.prototype.enableFPSCounter=function(y){this.runtime.enableFPSCounter(y)},_.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(_.prototype,"contents",{get:function(){if(this.loaded){for(var y={artboards:[]},C=0;C<this.file.artboardCount();C++){for(var O=this.file.artboardByIndex(C),W={name:O.name,animations:[],stateMachines:[]},se=0;se<O.animationCount();se++){var be=O.animationByIndex(se);W.animations.push(be.name)}for(var Ge=0;Ge<O.stateMachineCount();Ge++){for(var it=O.stateMachineByIndex(Ge),Ne=it.name,at=new this.runtime.StateMachineInstance(it,O),Ct=[],qt=0;qt<at.inputCount();qt++){var St=at.input(qt);Ct.push({name:St.name,type:St.type})}W.stateMachines.push({name:Ne,inputs:Ct})}y.artboards.push(W)}return y}},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(y){this._volume=y,this.artboard&&(this.artboard.volume=y*Ee.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"artboardWidth",{get:function(){var y;return this.artboard?this.artboard.width:(y=this._artboardWidth)!==null&&y!==void 0?y:0},set:function(y){this._artboardWidth=y,this.artboard&&(this.artboard.width=y)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"artboardHeight",{get:function(){var y;return this.artboard?this.artboard.height:(y=this._artboardHeight)!==null&&y!==void 0?y:0},set:function(y){this._artboardHeight=y,this.artboard&&(this.artboard.height=y)},enumerable:!1,configurable:!0}),_.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(_.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(y){this._devicePixelRatioUsed=y},enumerable:!1,configurable:!0}),_.prototype.bindViewModelInstance=function(y){var C;this.artboard&&!this.destroyed&&y&&y.runtimeInstance&&(y.internalIncrementReferenceCount(),(C=this._viewModelInstance)===null||C===void 0||C.cleanup(),this._viewModelInstance=y,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(O){return O.bindViewModelInstance(y)}):this.artboard.bindViewModelInstance(y.runtimeInstance))},Object.defineProperty(_.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),_.prototype.viewModelByIndex=function(y){var C=this.file.viewModelByIndex(y);return C!==null?new Ke(C):null},_.prototype.viewModelByName=function(y){var C=this.file.viewModelByName(y);return C!==null?new Ke(C):null},_.prototype.enums=function(){if(this._dataEnums===null){var y=this.file.enums();this._dataEnums=y.map(function(C){return new Ye(C)})}return this._dataEnums},_.prototype.defaultViewModel=function(){if(this.artboard){var y=this.file.defaultArtboardViewModel(this.artboard);if(y)return new Ke(y)}return null},_.prototype.getArtboard=function(y){var C,O;return(O=(C=this.riveFile)===null||C===void 0?void 0:C.getArtboard(y))!==null&&O!==void 0?O:null},_.missingErrorMessage="Rive source file or data buffer required",_.cleanupErrorMessage="Attempt to use file after calling cleanup.",_}(),Ke=function(){function _(y){this._viewModel=y}return Object.defineProperty(_.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),_.prototype.instanceByIndex=function(y){var C=this._viewModel.instanceByIndex(y);return C!==null?new et(C,null):null},_.prototype.instanceByName=function(y){var C=this._viewModel.instanceByName(y);return C!==null?new et(C,null):null},_.prototype.defaultInstance=function(){var y=this._viewModel.defaultInstance();return y!==null?new et(y,null):null},_.prototype.instance=function(){var y=this._viewModel.instance();return y!==null?new et(y,null):null},Object.defineProperty(_.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),_}(),Ye=function(){function _(y){this._dataEnum=y}return Object.defineProperty(_.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),_}(),ze;(function(_){_.Number="number",_.String="string",_.Boolean="boolean",_.Color="color",_.Trigger="trigger",_.Enum="enum",_.List="list",_.Image="image",_.Artboard="artboard"})(ze||(ze={}));var et=function(){function _(y,C){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=y,C!==null&&this._parents.push(C)}return Object.defineProperty(_.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),_.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(y){y.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(y){y.clearChanges()})),this._children.forEach(function(y){return y.handleCallbacks()})},_.prototype.addParent=function(y){this._parents.includes(y)||(this._parents.push(y),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&y.addToViewModelCallbacks(this))},_.prototype.removeParent=function(y){var C=this._parents.indexOf(y);if(C!==-1){var O=this._parents[C];O.removeFromViewModelCallbacks(this),this._parents.splice(C,1)}},_.prototype.addToPropertyCallbacks=function(y){var C=this;this._propertiesWithCallbacks.includes(y)||(this._propertiesWithCallbacks.push(y),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(O){O.addToViewModelCallbacks(C)}))},_.prototype.removeFromPropertyCallbacks=function(y){var C=this;this._propertiesWithCallbacks.includes(y)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(O){return O!==y}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(O){O.removeFromViewModelCallbacks(C)}))},_.prototype.addToViewModelCallbacks=function(y){var C=this;this._children.includes(y)||(this._children.push(y),this._parents.forEach(function(O){O.addToViewModelCallbacks(C)}))},_.prototype.removeFromViewModelCallbacks=function(y){var C=this;this._children.includes(y)&&(this._children=this._children.filter(function(O){return O!==y}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(O){O.removeFromViewModelCallbacks(C)}))},_.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(y){y.clearCallbacks()})},_.prototype.propertyFromPath=function(y,C){var O=y.split("/");return this.propertyFromPathSegments(O,0,C)},_.prototype.viewModelFromPathSegments=function(y,C){var O=this.internalViewModelInstance(y[C]);return O!==null?C==y.length-1?O:O.viewModelFromPathSegments(y,C++):null},_.prototype.propertyFromPathSegments=function(y,C,O){var W,se,be,Ge,it,Ne,at,Ct,qt,St,jn,Tn,mn,Yt,nn,br,Je,yr;if(C<y.length-1){var Dn=this.internalViewModelInstance(y[C]);return Dn!==null?Dn.propertyFromPathSegments(y,C+1,O):null}var ut=null;switch(O){case ze.Number:if(ut=(se=(W=this._runtimeInstance)===null||W===void 0?void 0:W.number(y[C]))!==null&&se!==void 0?se:null,ut!==null)return new Ot(ut,this);break;case ze.String:if(ut=(Ge=(be=this._runtimeInstance)===null||be===void 0?void 0:be.string(y[C]))!==null&&Ge!==void 0?Ge:null,ut!==null)return new ct(ut,this);break;case ze.Boolean:if(ut=(Ne=(it=this._runtimeInstance)===null||it===void 0?void 0:it.boolean(y[C]))!==null&&Ne!==void 0?Ne:null,ut!==null)return new Ht(ut,this);break;case ze.Color:if(ut=(Ct=(at=this._runtimeInstance)===null||at===void 0?void 0:at.color(y[C]))!==null&&Ct!==void 0?Ct:null,ut!==null)return new vr(ut,this);break;case ze.Trigger:if(ut=(St=(qt=this._runtimeInstance)===null||qt===void 0?void 0:qt.trigger(y[C]))!==null&&St!==void 0?St:null,ut!==null)return new $n(ut,this);break;case ze.Enum:if(ut=(Tn=(jn=this._runtimeInstance)===null||jn===void 0?void 0:jn.enum(y[C]))!==null&&Tn!==void 0?Tn:null,ut!==null)return new pn(ut,this);break;case ze.List:if(ut=(Yt=(mn=this._runtimeInstance)===null||mn===void 0?void 0:mn.list(y[C]))!==null&&Yt!==void 0?Yt:null,ut!==null)return new gr(ut,this);break;case ze.Image:if(ut=(br=(nn=this._runtimeInstance)===null||nn===void 0?void 0:nn.image(y[C]))!==null&&br!==void 0?br:null,ut!==null)return new Gi(ut,this);break;case ze.Artboard:if(ut=(yr=(Je=this._runtimeInstance)===null||Je===void 0?void 0:Je.artboard(y[C]))!==null&&yr!==void 0?yr:null,ut!==null)return new Ti(ut,this);break}return null},_.prototype.internalViewModelInstance=function(y){var C;if(this._viewModelInstances.has(y))return this._viewModelInstances.get(y);var O=(C=this._runtimeInstance)===null||C===void 0?void 0:C.viewModel(y);if(O!==null){var W=new _(O,this);return W.internalIncrementReferenceCount(),this._viewModelInstances.set(y,W),W}return null},_.prototype.number=function(y){var C=this.propertyFromPath(y,ze.Number);return C},_.prototype.string=function(y){var C=this.propertyFromPath(y,ze.String);return C},_.prototype.boolean=function(y){var C=this.propertyFromPath(y,ze.Boolean);return C},_.prototype.color=function(y){var C=this.propertyFromPath(y,ze.Color);return C},_.prototype.trigger=function(y){var C=this.propertyFromPath(y,ze.Trigger);return C},_.prototype.enum=function(y){var C=this.propertyFromPath(y,ze.Enum);return C},_.prototype.list=function(y){var C=this.propertyFromPath(y,ze.List);return C},_.prototype.image=function(y){var C=this.propertyFromPath(y,ze.Image);return C},_.prototype.artboard=function(y){var C=this.propertyFromPath(y,ze.Artboard);return C},_.prototype.viewModel=function(y){var C=y.split("/"),O=C.length>1?this.viewModelFromPathSegments(C.slice(0,C.length-1),0):this;return O!=null?O.internalViewModelInstance(C[C.length-1]):null},_.prototype.internalReplaceViewModel=function(y,C){var O;if(C.runtimeInstance!==null){var W=((O=this._runtimeInstance)===null||O===void 0?void 0:O.replaceViewModel(y,C.runtimeInstance))||!1;if(W){C.internalIncrementReferenceCount();var se=this.internalViewModelInstance(y);se!==null&&(se.removeParent(this),this._children.includes(se)&&(this._children=this._children.filter(function(be){return be!==se})),se.cleanup()),this._viewModelInstances.set(y,C),C.addParent(this)}return W}return!1},_.prototype.replaceViewModel=function(y,C){var O,W=y.split("/"),se=W.length>1?this.viewModelFromPathSegments(W.slice(0,W.length-1),0):this;return(O=se==null?void 0:se.internalReplaceViewModel(W[W.length-1],C))!==null&&O!==void 0?O:!1},_.prototype.incrementReferenceCount=function(){var y;this._referenceCount++,(y=this._runtimeInstance)===null||y===void 0||y.incrementReferenceCount()},_.prototype.decrementReferenceCount=function(){var y;this._referenceCount--,(y=this._runtimeInstance)===null||y===void 0||y.decrementReferenceCount()},Object.defineProperty(_.prototype,"properties",{get:function(){var y;return((y=this._runtimeInstance)===null||y===void 0?void 0:y.getProperties().map(function(C){return T({},C)}))||[]},enumerable:!1,configurable:!0}),_.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},_.prototype.cleanup=function(){var y=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(W){W.cleanup()}),this._viewModelInstances.clear();var C=M([],this._children);this._children.length=0;var O=M([],this._parents);this._parents.length=0,C.forEach(function(W){W.removeParent(y)}),O.forEach(function(W){W.removeFromViewModelCallbacks(y)})}},_}(),$e=function(){function _(y,C){this.callbacks=[],this._viewModelInstanceValue=y,this._parentViewModel=C}return _.prototype.on=function(y){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(y)||(this.callbacks.push(y),this._parentViewModel.addToPropertyCallbacks(this))},_.prototype.off=function(y){y?this.callbacks=this.callbacks.filter(function(C){return C!==y}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},_.prototype.internalHandleCallback=function(y){},_.prototype.handleCallbacks=function(){var y=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(C){y.internalHandleCallback(C)})},_.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},_.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(_.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),_}(),ct=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(C){this._viewModelInstanceValue.value=C},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(C){C(this.value)},y}($e),Ot=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(C){this._viewModelInstanceValue.value=C},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(C){C(this.value)},y}($e),Ht=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(C){this._viewModelInstanceValue.value=C},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(C){C(this.value)},y}($e),$n=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return y.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},y.prototype.internalHandleCallback=function(C){C()},y}($e),pn=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(C){this._viewModelInstanceValue.value=C},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(C){this._viewModelInstanceValue.valueIndex=C},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(C){C(this.value)},y}($e),gr=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),y.prototype.addInstance=function(C){C.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(C.runtimeInstance),C.addParent(this._parentViewModel))},y.prototype.addInstanceAt=function(C,O){return C.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(C.runtimeInstance,O)?(C.addParent(this._parentViewModel),!0):!1},y.prototype.removeInstance=function(C){C.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(C.runtimeInstance),C.removeParent(this._parentViewModel))},y.prototype.removeInstanceAt=function(C){this._viewModelInstanceValue.removeInstanceAt(C)},y.prototype.instanceAt=function(C){var O=this._viewModelInstanceValue.instanceAt(C);if(O!=null){var W=new et(O,this._parentViewModel);return W}return null},y.prototype.swap=function(C,O){this._viewModelInstanceValue.swap(C,O)},y.prototype.internalHandleCallback=function(C){C()},y}($e),vr=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(C){this._viewModelInstanceValue.value=C},enumerable:!1,configurable:!0}),y.prototype.rgb=function(C,O,W){this._viewModelInstanceValue.rgb(C,O,W)},y.prototype.rgba=function(C,O,W,se){this._viewModelInstanceValue.argb(se,C,O,W)},y.prototype.argb=function(C,O,W,se){this._viewModelInstanceValue.argb(C,O,W,se)},y.prototype.alpha=function(C){this._viewModelInstanceValue.alpha(C)},y.prototype.opacity=function(C){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,C))*255))},y.prototype.internalHandleCallback=function(C){C(this.value)},y}($e),Gi=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"value",{set:function(C){var O;this._viewModelInstanceValue.value((O=C==null?void 0:C.nativeImage)!==null&&O!==void 0?O:null)},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(C){C()},y}($e),Ti=function(_){v(y,_);function y(C,O){return _.call(this,C,O)||this}return Object.defineProperty(y.prototype,"value",{set:function(C){var O;this._viewModelInstanceValue.value((O=C==null?void 0:C.nativeArtboard)!==null&&O!==void 0?O:null)},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(C){C()},y}($e),Po=function(_){return x(void 0,void 0,void 0,function(){var y,C,O;return S(this,function(W){switch(W.label){case 0:return y=new Request(_),[4,fetch(y)];case 1:return C=W.sent(),[4,C.arrayBuffer()];case 2:return O=W.sent(),[2,O]}})})},fn=function(_){return typeof _=="string"?[_]:_ instanceof Array?_:[]},xi={EventManager:Le,TaskQueueManager:le},Nn=function(_){return x(void 0,void 0,void 0,function(){var y,C,O;return S(this,function(W){switch(W.label){case 0:return y=new Promise(function(se){return A.getInstance(function(be){be.decodeAudio(_,se)})}),[4,y];case 1:return C=W.sent(),O=new m.AudioWrapper(C),m.finalizationRegistry.register(O,C),[2,O]}})})},Ei=function(_){return x(void 0,void 0,void 0,function(){var y,C,O;return S(this,function(W){switch(W.label){case 0:return y=new Promise(function(se){return A.getInstance(function(be){be.decodeImage(_,se)})}),[4,y];case 1:return C=W.sent(),O=new m.ImageWrapper(C),m.finalizationRegistry.register(O,C),[2,O]}})})},_o=function(_){return x(void 0,void 0,void 0,function(){var y,C,O;return S(this,function(W){switch(W.label){case 0:return y=new Promise(function(se){return A.getInstance(function(be){be.decodeFont(_,se)})}),[4,y];case 1:return C=W.sent(),O=new m.FontWrapper(C),m.finalizationRegistry.register(O,C),[2,O]}})})}})(),s})())}(rf)),rf.exports}var up=DP();function UP(n,e){e.style.borderColor=n;const t=getComputedStyle(e).getPropertyValue("border-color"),r=e.getContext("2d");return r?(r.fillStyle=t,r.fillRect(0,0,1,1),e.style.display="none",[...r.getImageData(0,0,1,1).data]):[0,0,0,255]}const FP=({restored:n})=>{const e=Se.useRef(null),t=Se.useRef(null);return Se.useEffect(()=>{const r=t.current,o=e.current;if(r==null||o==null)return;const s=new up.Rive({src:"https://assets.nlx.ai/touchpoint/voice-plus-animation.riv",canvas:r,autoBind:!0,autoplay:!0,stateMachines:"State Machine 1",layout:new up.Layout({fit:up.Fit.Fill}),onLoad:()=>{s.resizeDrawingSurfaceToCanvas();const d=s.viewModelInstance;if(d!=null){const f=d.trigger("run"),m=d.trigger("runNoWave"),v=d.color("color"),T=d.number("voiceInput");T!=null&&(T.value=100),v==null||v.rgba(...UP("var(--accent)",o)),n?m==null||m.trigger():f==null||f.trigger()}}}),l=()=>{s.resizeDrawingSurfaceToCanvas()};return window.addEventListener("resize",l,!1),()=>{s.cleanup(),window.removeEventListener("resize",l,!1)}},[n]),R.jsxs(R.Fragment,{children:[R.jsx("canvas",{ref:e,width:"1",height:"1"}),R.jsx("canvas",{className:"pointer-events-none fixed inset-0",ref:t,style:{width:"100%",height:"100%"}})]})},D1=Se.forwardRef((n,e)=>{var t;const r=sessionStorage.getItem("nlxActiveVoiceConversationId")===n.config.conversationId,o=Se.useMemo(()=>{const ue=sessionStorage.getItem("nlxActiveConversationResponses")??"{}";try{const L=JSON.parse(ue);if(Array.isArray(L[n.config.conversationId]))return L[n.config.conversationId]}catch{return null}},[n.config.conversationId]),s=Se.useMemo(()=>dC({responses:o,...n.config}),[n.config,o]),[l,d]=Se.useState([]),f=((t=l[l.length-1])==null?void 0:t.type)===Hn.User,m=n.colorMode??"dark",[v,T]=Se.useState(n.embedded||r),x=uC(n.config),[S,M]=Se.useState(!1),N=Se.useRef(n.embedded||r),V=n.input??"text",$=Se.useCallback(()=>{sessionStorage.removeItem("nlxActiveVoiceConversationId"),(V==="voice"||V==="voiceMini")&&(A.current=!1,s.reset({clearResponses:!0}),sessionStorage.removeItem("nlxConversationId"))},[s,V]),ae=n.onClose,z=Se.useCallback(ue=>{ae!=null&&(ae(ue),$(),ue.defaultPrevented||T(!1))},[ae,T,$]);Se.useEffect(()=>{N.current=v},[v]),Se.useImperativeHandle(e,()=>({setExpanded(ue){ue?T(!0):($(),T(!1))},getExpanded(){return N.current},getConversationHandler(){return s},setCustomBidirectionalCommands:ue=>{de.current(ue)}}),[s,T,$]),Se.useEffect(()=>{const ue=L=>{d(L);const ee=s.currentConversationId();V==="text"&&ee!=null&&sessionStorage.setItem("nlxActiveConversationResponses",JSON.stringify({[ee]:L}))};return s.subscribe(ue),()=>{s.unsubscribe(ue)}},[s,d,V]);const A=Se.useRef(r);Se.useEffect(()=>{if(!v||A.current)return;A.current=!0,(V!=="text"||o==null||o.length===0)&&n.initializeConversation(s,n.initialContext);const ue=s.currentConversationId();ue!=null&&sessionStorage.setItem("nlxActiveVoiceConversationId",ue)},[s,v,$,V,n,o]);const F=Se.useRef({formElements:{},links:{},customCommands:new Map}),J=Se.useRef([]),de=Se.useRef(ue=>{var L;if(((L=n.bidirectional)==null?void 0:L.automaticContext)!==!1)J.current=ue;else throw new Error("Custom commands can only be set when automatic context is enabled.")});Se.useEffect(()=>{if(v&&n.bidirectional!=null&&n.bidirectional.automaticContext!==!1){const{teardown:ue,onCustomCommandsChange:L}=MP(s,J.current,n.bidirectional.customizeAutomaticContext??(ee=>ee),ee=>{F.current=ee});return de.current=L,ue}},[v,s,n.bidirectional]),Se.useEffect(()=>{if(n.bidirectional!=null&&(n.bidirectional.navigation!=null||n.bidirectional.input!=null||n.bidirectional.custom!=null||n.bidirectional.automaticContext!==!1))return NP(s,n.bidirectional,F)},[n.bidirectional,s]);const te=n.windowSize??(n.embedded?"full":"half"),K=Se.useMemo(()=>{const ue=cv(ee=>ee.type===Hn.Application,l);if(ue===-1)return null;const L=l[ue];return(L==null?void 0:L.type)!==Hn.Application?null:{index:ue,response:L}},[l]),ne=Se.useMemo(()=>{if(K==null)return;const ue=cv(ee=>ee.choices.length>0,K.response.payload.messages);if(ue===-1)return;const L=K.response.payload.messages[ue];if(L!=null)return{message:L,messageIndex:ue,responseIndex:K.index}},[K]),[Y,me]=Se.useState({}),Le=n.customModalities??{},[le,pe]=Se.useState(!0),[Oe,Ee]=Se.useState(0),ce=()=>{s.reset({clearResponses:!0}),$(),V!=="voice"&&n.initializeConversation(s,n.initialContext);const ue=s.currentConversationId();sessionStorage.getItem("nlxConversationId")!==null&&(ue==null?sessionStorage.removeItem("nlxConversationId"):sessionStorage.setItem("nlxConversationId",ue)),ue!=null&&sessionStorage.setItem("nlxActiveVoiceConversationId",ue),Ee(L=>L+1)};if(s==null)return null;if(!v)return n.launchIcon!==!1?R.jsx(Vu,{className:"fixed z-launchButton bottom-2 right-2 w-fit",theme:n.theme,colorMode:m,children:R.jsx(LC,{className:"backdrop-blur",iconUrl:typeof n.launchIcon=="string"?n.launchIcon:void 0,Custom:typeof n.launchIcon=="function"?n.launchIcon:void 0,onClick:()=>{T(!0)},label:"Expand chat"})}):null;if(V==="voiceMini")return R.jsx(R.Fragment,{children:R.jsxs(Vu,{theme:n.theme,colorMode:m,className:ot("w-fit",n.embedded?"":"fixed z-touchpoint bottom-2 right-2"),children:[n.animate?R.jsx(FP,{restored:r}):null,R.jsx(jE,{handler:s,context:n.initialContext,onClose:()=>{z(new Event("close"))},renderCollapse:n.onClose!=null,customModalities:Le},Oe)]})});const Re=()=>{var ue,L;return S?R.jsx(Sb,{reset:()=>{ce(),M(!1)},className:ot("flex-none",te==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{M(!1)},handler:s}):x?R.jsxs(R.Fragment,{children:[R.jsx(fE,{enabled:n.enabled,userMessageBubble:n.userMessageBubble??!1,agentMessageBubble:n.agentMessageBubble??!1,chatMode:n.chatMode??!1,isWaiting:f,lastApplicationResponseIndex:K==null?void 0:K.index,responses:l,colorMode:m,handler:s,uploadedFiles:Y,customModalities:Le,className:ot("flex-grow",te==="full"?"w-full md:max-w-content md:mx-auto":"")}),R.jsxs("div",{className:ot("p-2 md:p-3 flex flex-col flex-none gap-2",te==="full"?"w-full md:max-w-content md:mx-auto":""),children:[ne!=null?R.jsx(dE,{...ne,handler:s}):null,(ne==null?void 0:ne.message.selectedChoiceId)!=null?null:R.jsx(OE,{enabled:n.enabled,handler:s,uploadUrl:(L=(ue=K==null?void 0:K.response.payload.metadata)==null?void 0:ue.uploadUrls)==null?void 0:L[0],onFileUpload:({uploadId:ee,file:We})=>{me(Ke=>({...Ke,[ee]:We}))}})]})]}):R.jsx(Ry,{})};return R.jsxs(Vu,{theme:n.theme,colorMode:m,className:ot("grid grid-cols-2 xl:grid-cols-[1fr_632px]",n.embedded?"w-full h-full":"fixed inset-0 z-touchpoint"),children:[te==="half"?R.jsx("div",{className:"hidden md:block bg-overlay"}):null,R.jsxs("div",{className:ot("w-full bg-background text-primary-80 flex relative flex-col h-full backdrop-blur-overlay",{"col-span-2 md:col-span-1":te==="half","col-span-2":te==="full"}),children:[R.jsx(HC,{windowSize:n.embedded?"embedded":te,errorThemedCloseButton:V==="voice",speakerControls:V==="voice"?{enabled:le,setEnabled:pe}:void 0,colorMode:m,brandIcon:n.brandIcon,isSettingsOpen:S,enabled:n.enabled,toggleSettings:n.enableSettings?()=>{M(ue=>!ue)}:void 0,renderCollapse:n.onClose!=null,collapse:z,reset:ce}),V==="text"?Re():R.jsxs(R.Fragment,{children:[S?R.jsx(Sb,{className:ot("flex-none",te==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{M(!1)},reset:()=>{ce(),M(!1)},handler:s}):null,R.jsx(Rx,{brandIcon:n.brandIcon,handler:s,speakersEnabled:le,colorMode:m,className:S?"hidden":"flex-grow",context:n.initialContext,customModalities:Le},Oe)]})]})]})});D1.displayName="App";const U1=`*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:var(--font-family);font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*{font-family:var(--font-family)!important}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.visible{visibility:visible}.invisible{visibility:hidden}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.inset-x-0{left:0;right:0}.-top-2{top:-.5rem}.bottom-2{bottom:.5rem}.bottom-4{bottom:1rem}.bottom-\\[72px\\]{bottom:72px}.left-0{left:0}.left-1\\/2{left:50%}.right-0{right:0}.right-2{right:.5rem}.top-0{top:0}.top-1\\/2{top:50%}.z-10{z-index:10}.z-launchButton{z-index:100}.z-touchpoint{z-index:1000}.col-span-1{grid-column:span 1 / span 1}.col-span-2{grid-column:span 2 / span 2}.-mx-2{margin-left:-.5rem;margin-right:-.5rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-auto{margin-left:auto}.mr-10{margin-right:2.5rem}.mr-2{margin-right:.5rem}.block{display:block}.inline{display:inline}.flex{display:flex}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-10{height:2.5rem}.h-20{height:5rem}.h-24{height:6rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-52{height:13rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-72{height:18rem}.h-8{height:2rem}.h-\\[128px\\]{height:128px}.h-\\[1px\\]{height:1px}.h-\\[360px\\]{height:360px}.h-full{height:100%}.max-h-\\[360px\\]{max-height:360px}.max-h-\\[40vh\\]{max-height:40vh}.max-h-full{max-height:100%}.min-h-full{min-height:100%}.w-10{width:2.5rem}.w-20{width:5rem}.w-24{width:6rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-72{width:18rem}.w-8{width:2rem}.w-80{width:20rem}.w-\\[128px\\]{width:128px}.w-\\[calc\\(100vw-16px\\)\\]{width:calc(100vw - 16px)}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.max-w-\\[360px\\]{max-width:360px}.max-w-content{max-width:640px}.flex-none{flex:none}.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-full{--tw-translate-y: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes ping{75%,to{transform:scale(2);opacity:0}}.animate-ping{animation:ping 1s cubic-bezier(0,0,.2,1) infinite}.cursor-pointer{cursor:pointer}.resize-none{resize:none}.resize{resize:both}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-\\[320px\\,1fr\\]{grid-template-columns:320px 1fr}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.space-y-px>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1px * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.rounded-full{border-radius:9999px}.rounded-inner{border-radius:var(--inner-border-radius)}.rounded-outer{border-radius:var(--outer-border-radius)}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-background{border-color:var(--background)}.border-primary-10{border-color:var(--primary-10)}.bg-\\[rgb\\(175\\,175\\,175\\)\\]{--tw-bg-opacity: 1;background-color:rgb(175 175 175 / var(--tw-bg-opacity))}.bg-\\[rgb\\(40\\,41\\,47\\)\\]{--tw-bg-opacity: 1;background-color:rgb(40 41 47 / var(--tw-bg-opacity))}.bg-accent{background-color:var(--accent)}.bg-background{background-color:var(--background)}.bg-black\\/50{background-color:#00000080}.bg-current{background-color:currentColor}.bg-error-primary{background-color:var(--error-primary)}.bg-error-secondary{background-color:var(--error-secondary)}.bg-overlay{background-color:var(--overlay)}.bg-primary-10{background-color:var(--primary-10)}.bg-primary-5{background-color:var(--primary-5)}.bg-primary-80{background-color:var(--primary-80)}.bg-secondary-40{background-color:var(--secondary-40)}.bg-secondary-60{background-color:var(--secondary-60)}.bg-transparent{background-color:transparent}.bg-cover{background-size:cover}.bg-center{background-position:center}.object-cover{-o-object-fit:cover;object-fit:cover}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-0{padding-top:0;padding-bottom:0}.py-0\\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\\.5{padding-top:.625rem;padding-bottom:.625rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pl-10{padding-left:2.5rem}.pl-4{padding-left:1rem}.pr-2{padding-right:.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-sans{font-family:var(--font-family)}.text-base{font-size:1rem;line-height:1.5rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-normal{font-weight:400}.text-accent{color:var(--accent)}.text-accent-20{color:var(--accent-20)}.text-error-primary{color:var(--error-primary)}.text-primary-20{color:var(--primary-20)}.text-primary-40{color:var(--primary-40)}.text-primary-60{color:var(--primary-60)}.text-primary-80{color:var(--primary-80)}.text-secondary-40{color:var(--secondary-40)}.text-secondary-80{color:var(--secondary-80)}.placeholder-primary-20::-moz-placeholder{color:var(--primary-20)}.placeholder-primary-20::placeholder{color:var(--primary-20)}.placeholder-primary-40::-moz-placeholder{color:var(--primary-40)}.placeholder-primary-40::placeholder{color:var(--primary-40)}.caret-accent{caret-color:var(--accent)}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-\\[0\\.01\\]{opacity:.01}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.outline-0{outline-width:0px}.outline-2{outline-width:2px}.outline-accent{outline-color:var(--accent)}.drop-shadow{--tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / .1)) drop-shadow(0 1px 1px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur{--tw-backdrop-blur: blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-overlay{--tw-backdrop-blur: blur(48px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-500{transition-duration:.5s}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}@property --glow-opacity{syntax: "<percentage>"; inherits: false; initial-value: 0%;}.fullscreen-error svg{animation:error-glow 3s ease infinite;--glow-opacity: 0%;filter:drop-shadow(0 0 6px color-mix(in srgb,transparent,var(--accent) var(--glow-opacity)))}@keyframes error-glow{0%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}22%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}35%{color:var(--accent);fill-opacity:80%;--glow-opacity: 60%}45%{color:var(--accent);fill-opacity:70%;--glow-opacity: 30%}55%{color:var(--accent);fill-opacity:60%;--glow-opacity: 60%}60%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}to{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}}.markdown ul{list-style-position:inside;list-style-type:disc}.markdown ol{list-style-position:inside;list-style-type:decimal}.markdown hr{border-color:var(--primary-20)}.markdown a{text-decoration-line:underline}.markdown h1,.markdown h2,.markdown h3{font-weight:700}.placeholder\\:text-primary-40::-moz-placeholder{color:var(--primary-40)}.placeholder\\:text-primary-40::placeholder{color:var(--primary-40)}.before\\:absolute:before{content:var(--tw-content);position:absolute}.before\\:inset-0:before{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.before\\:-z-10:before{content:var(--tw-content);z-index:-10}.before\\:bg-transparent:before{content:var(--tw-content);background-color:transparent}.before\\:transition-colors:before{content:var(--tw-content);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.before\\:content-\\[\\'\\'\\]:before{--tw-content: "";content:var(--tw-content)}.after\\:pointer-events-none:after{content:var(--tw-content);pointer-events:none}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:inset-0:after{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.after\\:rounded-outer:after{content:var(--tw-content);border-radius:var(--outer-border-radius)}.after\\:content-\\[\\'\\'\\]:after{--tw-content: "";content:var(--tw-content)}.last\\:h-full:last-child{height:100%}.hover\\:bg-primary-10:hover{background-color:var(--primary-10)}.hover\\:bg-primary-5:hover{background-color:var(--primary-5)}.hover\\:bg-primary-80:hover{background-color:var(--primary-80)}.hover\\:bg-secondary-20:hover{background-color:var(--secondary-20)}.hover\\:text-primary-80:hover{color:var(--primary-80)}.hover\\:after\\:bg-primary-10:hover:after{content:var(--tw-content);background-color:var(--primary-10)}.focus\\:outline-0:focus{outline-width:0px}.focus\\:before\\:bg-primary-10:focus:before{content:var(--tw-content);background-color:var(--primary-10)}.focus\\:before\\:bg-primary-40:focus:before{content:var(--tw-content);background-color:var(--primary-40)}.focus\\:before\\:bg-primary-5:focus:before{content:var(--tw-content);background-color:var(--primary-5)}.focus\\:before\\:bg-primary-80:focus:before{content:var(--tw-content);background-color:var(--primary-80)}.enabled\\:hover\\:before\\:bg-primary-10:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-10)}.enabled\\:hover\\:before\\:bg-primary-40:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-40)}.enabled\\:hover\\:before\\:bg-primary-5:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-5)}.enabled\\:hover\\:before\\:bg-primary-80:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-80)}.enabled\\:active\\:before\\:bg-secondary-10:active:enabled:before{content:var(--tw-content);background-color:var(--secondary-10)}.disabled\\:bg-accent-20:disabled{background-color:var(--accent-20)}.disabled\\:bg-primary-10:disabled{background-color:var(--primary-10)}.disabled\\:bg-primary-5:disabled{background-color:var(--primary-5)}.disabled\\:bg-secondary-20:disabled{background-color:var(--secondary-20)}.disabled\\:text-primary-20:disabled{color:var(--primary-20)}.disabled\\:text-primary-40:disabled{color:var(--primary-40)}.disabled\\:text-secondary-40:disabled{color:var(--secondary-40)}@media (min-width: 768px){.md\\:absolute{position:absolute}.md\\:left-0{left:0}.md\\:right-0{right:0}.md\\:top-0{top:0}.md\\:-order-1{order:-1}.md\\:col-span-1{grid-column:span 1 / span 1}.md\\:mx-auto{margin-left:auto;margin-right:auto}.md\\:block{display:block}.md\\:w-fit{width:-moz-fit-content;width:fit-content}.md\\:max-w-content{max-width:640px}.md\\:-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.md\\:flex-col{flex-direction:column}.md\\:p-3{padding:.75rem}}@media (min-width: 1280px){.xl\\:grid-cols-\\[1fr_632px\\]{grid-template-columns:1fr 632px}}`,tc=({children:n,className:e,faded:t})=>R.jsx("p",{className:ot("text-base",t?"text-primary-60":"text-primary-80",e),children:n}),BP=({children:n,className:e})=>R.jsx("p",{className:ot("text-sm text-primary-60",e),children:n}),Gf=({children:n,className:e,selected:t,onClick:r,href:o,newTab:s})=>{const l=ot("block shrink-0 rounded-inner overflow-hidden","w-80 space-y-px",t?"outline outline-2 outline-accent":"",r!=null||o!=null?"hover:bg-primary-5":"",e);return Se.useEffect(()=>{o==null&&s!=null&&console.warn("Setting the `newTab` prop on the `<CustomCard/>` has no effect if the `href` is not also set.")},[o,s]),o!=null?R.jsx("a",{className:l,href:o,onClick:r,...s?{target:"_blank",rel:"noreferrer"}:{},children:n}):r!=null?R.jsx("button",{className:l,onClick:r,children:n}):R.jsx("div",{className:l,children:n})},Kf=({src:n,alt:e})=>R.jsx("img",{src:n,alt:e,className:"w-full h-52 object-cover"}),Zf=({left:n,right:e,icon:t})=>R.jsxs("div",{className:"flex items-center relative justify-between gap-2 bg-primary-5 px-3 py-4",children:[R.jsx("div",{className:"space-y-1 text-left",children:n}),R.jsx("div",{className:"space-y-1 text-right",children:e}),t!=null?R.jsx(t,{className:"text-primary-60 w-4 h-4 absolute top-1/2 left-1/2 transform -translate-y-1/2 -translate-x-1/2"}):null]});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var F1=function(n,e){return(F1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(n,e)},zP,Eu,VP=(function(n){/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function t(){for(var r=[],o=0;o<arguments.length;o++){var s=arguments[o];if(s){var l=typeof s;if(l==="string"||l==="number")r.push(s);else if(Array.isArray(s)&&s.length){var d=t.apply(null,s);d&&r.push(d)}else if(l==="object")for(var f in s)e.call(s,f)&&s[f]&&r.push(f)}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()}(Eu={path:zP,exports:{},require:function(n,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e==null&&Eu.path)}},Eu.exports),Eu.exports);function af(n,e,t){var r,o,s,l,d;function f(){var v=Date.now()-l;v<e&&v>=0?r=setTimeout(f,e-v):(r=null,t||(d=n.apply(s,o),s=o=null))}e==null&&(e=100);var m=function(){s=this,o=arguments,l=Date.now();var v=t&&!r;return r||(r=setTimeout(f,e)),v&&(d=n.apply(s,o),s=o=null),d};return m.clear=function(){r&&(clearTimeout(r),r=null)},m.flush=function(){r&&(d=n.apply(s,o),s=o=null,clearTimeout(r),r=null)},m}af.debounce=af;var HP=af;(function(n,e){e===void 0&&(e={});var t=e.insertAt;if(typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",t==="top"&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var dp,qP=(dp="indiana-scroll-container",function(n,e){if(!n)return dp;var t;typeof n=="string"?t=n:e=n;var r=dp;return t&&(r+="__"+t),r+(e?Object.keys(e).reduce(function(o,s){var l=e[s];return l&&(o+=" "+(typeof l=="boolean"?r+"--"+s:r+"--"+s+"_"+l)),o},""):"")}),$P=function(n){function e(t){var r=n.call(this,t)||this;return r.onEndScroll=function(){r.scrolling=!1,!r.pressed&&r.started&&r.processEnd()},r.onScroll=function(o){var s=r.container.current;s.scrollLeft===r.scrollLeft&&s.scrollTop===r.scrollTop||(r.scrolling=!0,r.processScroll(o),r.onEndScroll())},r.onTouchStart=function(o){var s=r.props.nativeMobileScroll;if(r.isDraggable(o.target))if(r.internal=!0,s&&r.scrolling)r.pressed=!0;else{var l=o.touches[0];r.processClick(o,l.clientX,l.clientY),!s&&r.props.stopPropagation&&o.stopPropagation()}},r.onTouchEnd=function(o){var s=r.props.nativeMobileScroll;r.pressed&&(!r.started||r.scrolling&&s?r.pressed=!1:r.processEnd(),r.forceUpdate())},r.onTouchMove=function(o){var s=r.props.nativeMobileScroll;if(r.pressed&&(!s||!r.isMobile)){var l=o.touches[0];l&&r.processMove(o,l.clientX,l.clientY),o.preventDefault(),r.props.stopPropagation&&o.stopPropagation()}},r.onMouseDown=function(o){r.isDraggable(o.target)&&r.isScrollable()&&(r.internal=!0,r.props.buttons.indexOf(o.button)!==-1&&(r.processClick(o,o.clientX,o.clientY),o.preventDefault(),r.props.stopPropagation&&o.stopPropagation()))},r.onMouseMove=function(o){r.pressed&&(r.processMove(o,o.clientX,o.clientY),o.preventDefault(),r.props.stopPropagation&&o.stopPropagation())},r.onMouseUp=function(o){r.pressed&&(r.started?r.processEnd():(r.internal=!1,r.pressed=!1,r.forceUpdate(),r.props.onClick&&r.props.onClick(o)),o.preventDefault(),r.props.stopPropagation&&o.stopPropagation())},r.container=yo.createRef(),r.onEndScroll=HP(r.onEndScroll,300),r.scrolling=!1,r.started=!1,r.pressed=!1,r.internal=!1,r.getRef=r.getRef.bind(r),r}return function(t,r){function o(){this.constructor=t}F1(t,r),t.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}(e,n),e.prototype.componentDidMount=function(){var t=this.props.nativeMobileScroll,r=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),r.addEventListener("touchstart",this.onTouchStart,{passive:!1}),r.addEventListener("mousedown",this.onMouseDown,{passive:!1}),t&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},e.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},e.prototype.getElement=function(){return this.container.current},e.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},e.prototype.isDraggable=function(t){var r=this.props.ignoreElements;if(r){var o=t.closest(r);return o===null||o.contains(this.getElement())}return!0},e.prototype.isScrollable=function(){var t=this.container.current;return t&&(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)},e.prototype.processClick=function(t,r,o){var s=this.container.current;this.scrollLeft=s.scrollLeft,this.scrollTop=s.scrollTop,this.clientX=r,this.clientY=o,this.pressed=!0},e.prototype.processStart=function(t){t===void 0&&(t=!0);var r=this.props.onStartScroll;this.started=!0,t&&document.body.classList.add("indiana-dragging"),r&&r({external:!this.internal}),this.forceUpdate()},e.prototype.processScroll=function(t){if(this.started){var r=this.props.onScroll;r&&r({external:!this.internal})}else this.processStart(!1)},e.prototype.processMove=function(t,r,o){var s=this.props,l=s.horizontal,d=s.vertical,f=s.activationDistance,m=s.onScroll,v=this.container.current;this.started?(l&&(v.scrollLeft-=r-this.clientX),d&&(v.scrollTop-=o-this.clientY),m&&m({external:!this.internal}),this.clientX=r,this.clientY=o,this.scrollLeft=v.scrollLeft,this.scrollTop=v.scrollTop):(l&&Math.abs(r-this.clientX)>f||d&&Math.abs(o-this.clientY)>f)&&(this.clientX=r,this.clientY=o,this.processStart())},e.prototype.processEnd=function(){var t=this.props.onEndScroll;this.container.current&&t&&t({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},e.prototype.getRef=function(t){[this.container,this.props.innerRef].forEach(function(r){r&&(typeof r=="function"?r(t):r.current=t)})},e.prototype.render=function(){var t=this.props,r=t.children,o=t.draggingClassName,s=t.className,l=t.style,d=t.hideScrollbars,f=t.component;return yo.createElement(f,{className:VP(s,this.pressed&&o,qP({dragging:this.pressed,"hide-scrollbars":d,"native-scroll":this.isMobile})),style:l,ref:this.getRef,onScroll:this.onScroll},r)},e.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},e}(Se.PureComponent);const B1=({className:n,children:e})=>R.jsx($P,{className:ot("flex gap-x-2 overflow-x-auto no-scrollbar px-2 -mx-2",n),children:e});function qb(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function WP(n,e,t){return e=dd(e),function(r,o){if(o&&(typeof o=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(r)}(n,H1()?Reflect.construct(e,t||[],dd(n).constructor):e.apply(n,t))}function GP(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function KP(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function z1(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(f,m){if(f){if(typeof f=="string")return qb(f,m);var v={}.toString.call(f).slice(8,-1);return v==="Object"&&f.constructor&&(v=f.constructor.name),v==="Map"||v==="Set"?Array.from(f):v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?qb(f,m):void 0}}(n))||e){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(f){throw f},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,l=!0,d=!1;return{s:function(){t=t.call(n)},n:function(){var f=t.next();return l=f.done,f},e:function(f){d=!0,s=f},f:function(){try{l||t.return==null||t.return()}finally{if(d)throw s}}}}function V1(n,e,t){return(e=function(r){var o=function(s,l){if(typeof s!="object"||!s)return s;var d=s[Symbol.toPrimitive];if(d!==void 0){var f=d.call(s,l);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return typeof o=="symbol"?o:o+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ud(){return ud=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ud.apply(null,arguments)}function dd(n){return dd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dd(n)}function ZP(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&of(n,e)}function H1(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H1=function(){return!!n})()}function $b(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function Pu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$b(Object(t),!0).forEach(function(r){V1(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):$b(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function q1(n,e){if(n==null)return{};var t,r,o=function(l,d){if(l==null)return{};var f={};for(var m in l)if({}.hasOwnProperty.call(l,m)){if(d.includes(m))continue;f[m]=l[m]}return f}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}function of(n,e){return of=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},of(n,e)}function Hl(n,e){var t,r=e.replacementChars,o=e.replacement,s=e.separate,l=r,d="",f=z1(n);try{for(f.s();!(t=f.n()).done;){var m,v=t.value,T=!Object.prototype.hasOwnProperty.call(o,v)&&((m=o[l[0]])===null||m===void 0?void 0:m.test(v));(s&&v===l[0]||T)&&(l=l.slice(1),d+=v)}}catch(x){f.e(x)}finally{f.f()}return d}function $1(n,e){var t,r=e.mask,o=e.replacement,s=e.separate,l=e.showMask,d=0,f="",m=z1(r);try{for(m.s();!(t=m.n()).done;){var v=t.value;if(!l&&n[d]===void 0)break;Object.prototype.hasOwnProperty.call(o,v)&&n[d]!==void 0?f+=n[d++]:f+=v}}catch(x){m.e(x)}finally{m.f()}if(s&&!l){for(var T=r.length-1;T>=0&&f[T]===r[T];T--);f=f.slice(0,T+1)}return f}function W1(n,e){for(var t=e.mask,r=e.replacement,o=[],s=0;s<t.length;s++){var l,d=(l=n[s])!==null&&l!==void 0?l:t[s],f=Object.prototype.hasOwnProperty.call(r,d)?"replacement":n[s]!==void 0&&n[s]!==t[s]?"input":"mask";o.push({type:f,value:d,index:s})}return o}function js(n){return n.length>0?V1({},n,/./):{}}function sf(n,e){for(var t=e.start,r=t===void 0?0:t,o=e.end,s=e.mask,l=e.replacement,d=e.separate,f=n.slice(r,o),m=s.slice(r,o),v="",T=0;T<m.length;T++){var x=Object.prototype.hasOwnProperty.call(l,m[T]);x&&f[T]!==void 0&&f[T]!==m[T]?v+=f[T]:x&&d&&(v+=m[T])}return v}function G1(n,e){var t=e.mask,r=e.replacement,o=typeof r=="string"?js(r):r,s=RegExp("[^".concat(Object.keys(o).join(""),"]"),"g");return $1(Hl(n,{replacementChars:t.replace(s,""),replacement:o,separate:!1}),{mask:t,replacement:o,separate:!1,showMask:!1})}function QP(n,e){var t=e.mask,r=e.replacement,o=typeof r=="string"?js(r):r,s=sf(n,{mask:t,replacement:o,separate:!1}),l=RegExp("[^".concat(Object.keys(o).join(""),"]"),"g");return Hl(s,{replacementChars:t.replace(l,""),replacement:o,separate:!1})}function XP(n,e){var t=e.mask,r=e.replacement,o=typeof r=="string"?js(r):r;return W1(G1(n,{mask:t,replacement:o}),{mask:t,replacement:o})}var JP=["[","]","\\","/","^","$",".","|","?","*","+","(",")","{","}"];function Wb(n){return JP.includes(n)?"\\".concat(n):n}function YP(n,e){for(var t=e.mask,r=e.replacement,o=typeof r=="string"?js(r):r,s=n==="partial"||n==="partial-inexact",l=n==="full"||n==="partial",d="",f=0;f<t.length;f++){var m=t[f];f===0&&(d="^"),s&&(d+="("),d+=Object.prototype.hasOwnProperty.call(o,m)?"".concat(l?"(?!".concat(Wb(m),")"):"","(").concat(o[m].source,")"):Wb(m),f===t.length-1&&(s&&(d+=")?".repeat(t.length)),d+="$")}return d}function e_(n,e){return new Proxy(n,{set:function(t,r,o){return r==="current"&&(o!==n.current&&(n.current!==null&&e.unregister(n.current),o!==null&&e.register(o)),t[r]=o,!0)}})}function t_(n,e,t){return e=nc(e),function(r,o){if(o&&(typeof o=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(r)}(n,Qf()?Reflect.construct(e,t||[],nc(n).constructor):e.apply(n,t))}function K1(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Z1(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function n_(n,e,t){return(e=function(r){var o=function(s,l){if(typeof s!="object"||!s)return s;var d=s[Symbol.toPrimitive];if(d!==void 0){var f=d.call(s,l);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return typeof o=="symbol"?o:o+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nc(n){return nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nc(n)}function r_(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&rc(n,e)}function Qf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Qf=function(){return!!n})()}function Gb(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function Kb(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Gb(Object(t),!0).forEach(function(r){n_(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Gb(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function i_(n,e){if(n==null)return{};var t,r,o=function(l,d){if(l==null)return{};var f={};for(var m in l)if({}.hasOwnProperty.call(l,m)){if(d.includes(m))continue;f[m]=l[m]}return f}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}function rc(n,e){return rc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},rc(n,e)}function lf(n){return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lf(n)}function cf(n){var e=typeof Map=="function"?new Map:void 0;return cf=function(t){if(t===null||!function(o){try{return Function.toString.call(o).indexOf("[native code]")!==-1}catch{return typeof o=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(o,s,l){if(Qf())return Reflect.construct.apply(null,arguments);var d=[null];d.push.apply(d,s);var f=new(o.bind.apply(o,d));return l&&rc(f,l.prototype),f}(t,arguments,nc(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),rc(r,t)},cf(n)}var ql=function(n){function e(t){var r;return K1(this,e),(r=t_(this,e,[t])).name="SyntheticChangeError",r}return r_(e,n),Z1(e)}(cf(Error)),Zb,a_=["options"],o_=["text","email","tel","search","url"],Q1=Z1(function n(e){var t=e.init,r=e.tracking;K1(this,n);var o=new WeakMap;this.register=function(s){var l;if(o_.includes(s.type)){var d=(l=s._wrapperState)!==null&&l!==void 0?l:{},f=d.initialValue,m=f===void 0?"":f,v=d.controlled,T=v!==void 0&&v,x=t({initialValue:s.value||m,controlled:T}),S=x.value,M=x.options,N={value:S,options:M,fallbackOptions:M},V={id:-1,cachedId:-1},$={value:"",selectionStart:0,selectionEnd:0},ae=Object.getOwnPropertyDescriptor("_valueTracker"in s?s:HTMLInputElement.prototype,"value");Object.defineProperty(s,"value",Kb(Kb({},ae),{},{set:function(J){var de;$.value=J,ae==null||(de=ae.set)===null||de===void 0||de.call(s,J)}})),s.value=S;var z=function(){var J=function(){var de,te;$.selectionStart=(de=s.selectionStart)!==null&&de!==void 0?de:0,$.selectionEnd=(te=s.selectionEnd)!==null&&te!==void 0?te:0,V.id=window.setTimeout(J)};V.id=window.setTimeout(J)},A=function(){window.clearTimeout(V.id),V.id=-1,V.cachedId=-1},F=function(J){try{var de,te;if(V.cachedId===V.id)throw new ql("The input selection has not been updated.");V.cachedId=V.id;var K=s.value,ne=s.selectionStart,Y=s.selectionEnd;if(ne===null||Y===null)throw new ql("The selection attributes have not been initialized.");var me,Le=$.value;if(J.inputType===void 0&&($.selectionStart=0,$.selectionEnd=Le.length),ne>$.selectionStart?me="insert":ne<=$.selectionStart&&ne<$.selectionEnd?me="deleteBackward":ne===$.selectionEnd&&K.length<Le.length&&(me="deleteForward"),me===void 0||(me==="deleteBackward"||me==="deleteForward")&&K.length>Le.length)throw new ql("Input type detection error.");var le="",pe=$.selectionStart,Oe=$.selectionEnd;if(me==="insert")le=K.slice($.selectionStart,ne);else{var Ee=Le.length-K.length;pe=ne,Oe=ne+Ee}N.value!==Le?N.options=N.fallbackOptions:N.fallbackOptions=N.options;var ce=N.options,Re=r({inputType:me,previousValue:Le,previousOptions:ce,value:K,addedValue:le,changeStart:pe,changeEnd:Oe,selectionStart:ne,selectionEnd:Y}),ue=Re.options,L=i_(Re,a_);s.value=L.value,s.setSelectionRange(L.selectionStart,L.selectionEnd),N.value=L.value,N.options=ue,$.selectionStart=L.selectionStart,$.selectionEnd=L.selectionEnd,(de=s._valueTracker)===null||de===void 0||(te=de.setValue)===null||te===void 0||te.call(de,Le)}catch(ee){if(s.value=$.value,s.setSelectionRange($.selectionStart,$.selectionEnd),J.preventDefault(),J.stopPropagation(),ee.name!=="SyntheticChangeError")throw ee}};document.activeElement===s&&z(),s.addEventListener("focus",z),s.addEventListener("blur",A),s.addEventListener("input",F),o.set(s,{onFocus:z,onBlur:A,onInput:F})}},this.unregister=function(s){var l=o.get(s);l!==void 0&&(s.removeEventListener("focus",l.onFocus),s.removeEventListener("blur",l.onBlur),s.removeEventListener("input",l.onInput),o.delete(s))}});Zb=Q1,Object.defineProperty(Zb.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Input"});function s_(n,e){return Se.useCallback(function(t){n.current=t,typeof e=="function"?e(t):lf(e)==="object"&&e!==null&&(e.current=t)},[n,e])}var Qb,l_=["track","modify"];function bs(n){var e,t,r,o;return{mask:(e=n.mask)!==null&&e!==void 0?e:"",replacement:typeof n.replacement=="string"?js(n.replacement):(t=n.replacement)!==null&&t!==void 0?t:{},showMask:(r=n.showMask)!==null&&r!==void 0&&r,separate:(o=n.separate)!==null&&o!==void 0&&o,track:n.track,modify:n.modify}}var X1=function(n){function e(){var t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return GP(this,e),(t=WP(this,e,[{init:function(o){var s=o.initialValue,l=o.controlled,d=bs(r),f=d.mask,m=d.replacement,v=d.separate,T=d.showMask;return s=l||s?s:T?f:"",{value:s,options:{mask:f,replacement:m,separate:v}}},tracking:function(o){var s=o.inputType,l=o.previousValue,d=o.previousOptions,f=o.addedValue,m=o.changeStart,v=o.changeEnd,T=bs(r),x=T.track,S=T.modify,M=q1(T,l_),N=M.mask,V=M.replacement,$=M.showMask,ae=M.separate,z=Pu(Pu({},s==="insert"?{inputType:s,data:f}:{inputType:s,data:null}),{},{value:l,selectionStart:m,selectionEnd:v}),A=x==null?void 0:x(z);if(A===!1)throw new ql("Custom tracking stop.");A===null?f="":A!==!0&&A!==void 0&&(f=A);var F=S==null?void 0:S(z);(F==null?void 0:F.mask)!==void 0&&(N=F.mask),(F==null?void 0:F.replacement)!==void 0&&(V=typeof(F==null?void 0:F.replacement)=="string"?js(F==null?void 0:F.replacement):F.replacement),(F==null?void 0:F.showMask)!==void 0&&($=F.showMask),(F==null?void 0:F.separate)!==void 0&&(ae=F.separate);var J=sf(l,Pu({end:m},d)),de=sf(l,Pu({start:v},d)),te=RegExp("[^".concat(Object.keys(V).join(""),"]"),"g"),K=N.replace(te,"");if(J&&(J=Hl(J,{replacementChars:K,replacement:V,separate:ae}),K=K.slice(J.length)),f&&(f=Hl(f,{replacementChars:K,replacement:V,separate:!1}),K=K.slice(f.length)),s==="insert"&&f==="")throw new ql("The character does not match the key value of the `replacement` object.");if(ae){var ne=N.slice(m,v).replace(te,""),Y=ne.length-f.length;Y<0?de=de.slice(-Y):Y>0&&(de=ne.slice(-Y)+de)}de&&(de=Hl(de,{replacementChars:K,replacement:V,separate:ae}));var me=$1(J+f+de,{mask:N,replacement:V,separate:ae,showMask:$}),Le=function(le){var pe,Oe,Ee,ce=le.inputType,Re=le.value,ue=le.addedValue,L=le.beforeChangeValue,ee=le.mask,We=le.replacement,Ke=le.separate,Ye=W1(Re,{mask:ee,replacement:We}).filter(function(Ot){var Ht=Ot.type;return Ht==="input"||Ke&&Ht==="replacement"}),ze=(pe=Ye[L.length+ue.length-1])===null||pe===void 0?void 0:pe.index,et=(Oe=Ye[L.length-1])===null||Oe===void 0?void 0:Oe.index,$e=(Ee=Ye[L.length+ue.length])===null||Ee===void 0?void 0:Ee.index;if(ce==="insert"){if(ze!==void 0)return ze+1;if($e!==void 0)return $e;if(et!==void 0)return et+1}if(ce==="deleteForward"){if($e!==void 0)return $e;if(et!==void 0)return et+1}if(ce==="deleteBackward"){if(et!==void 0)return et+1;if($e!==void 0)return $e}var ct=Re.split("").findIndex(function(Ot){return Object.prototype.hasOwnProperty.call(We,Ot)});return ct!==-1?ct:Re.length}({inputType:s,value:me,addedValue:f,beforeChangeValue:J,mask:N,replacement:V,separate:ae});return{value:me,selectionStart:Le,selectionEnd:Le,options:{mask:N,replacement:V,separate:ae}}}}])).format=function(o){return G1(o,bs(r))},t.formatToParts=function(o){return XP(o,bs(r))},t.unformat=function(o){return QP(o,bs(r))},t.generatePattern=function(o){return YP(o,bs(r))},t}return ZP(e,Q1),KP(e)}();Qb=X1,Object.defineProperty(Qb.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Mask"});function c_(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.mask,t=n.replacement,r=n.showMask,o=n.separate,s=n.track,l=n.modify,d=Se.useRef(null),f=Se.useRef({mask:e,replacement:t,showMask:r,separate:o,track:s,modify:l});return f.current.mask=e,f.current.replacement=t,f.current.showMask=r,f.current.separate=o,f.current.track=s,f.current.modify=l,Se.useMemo(function(){return e_(d,new X1(f.current))},[])}var u_=["component","mask","replacement","showMask","separate","track","modify"];function d_(n,e){var t=n.component,r=n.mask,o=n.replacement,s=n.showMask,l=n.separate,d=n.track,f=n.modify,m=q1(n,u_),v=c_({mask:r,replacement:o,showMask:s,separate:l,track:d,modify:f}),T=s_(v,e);return t?yo.createElement(t,ud({ref:T},m)):yo.createElement("input",ud({ref:T},m))}var h_=Se.forwardRef(d_);const p_={mask:"MM / DD / YYYY",replacement:{D:/\d/,M:/\d/,Y:/\d/},showMask:!0},J1=({onSubmit:n,className:e})=>{const t=n==null,[r,o]=Se.useState(null);return R.jsxs("div",{className:ot("relative bg-primary-5 flex items-center justify-between pl-4 py-2 pr-2 rounded-outer transition-colors duration-500 before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",t?"":"hover:bg-secondary-20",e),children:[R.jsxs("div",{className:"flex items-center",children:[R.jsx(py,{className:"w-4 h-4 text-primary-60"}),R.jsx(h_,{...p_,className:ot("bg-transparent text-primary-80 outline-0 ml-2 py-2.5",t?"placeholder-primary-20 pointer-events-none":"placeholder-primary-40"),placeholder:"MM / DD / YYYY",onChange:s=>{const l=s.target.value,[d,f,m]=l.split(" / ");d!=null&&d.length===2&&f!=null&&f.length===2&&m!=null&&m.length===4?o(`${m}-${d}-${f}`):o(null)}})]}),R.jsx(Cn,{className:"flex-none",label:"Send message",onClick:r==null||n==null?void 0:()=>{n(r)},type:"main",Icon:hd})]})},Y1=(n,e)=>t=>{n.type==="slot"&&e.sendSlots({[n.id]:t}),n.type==="context"&&e.sendContext({[n.id]:t})},f_=({data:n,conversationHandler:e})=>{const t=Se.useMemo(()=>Y1(n.$saveAs,e),[n.$saveAs,e]);return R.jsx(J1,{onSubmit:t})},m_=({data:n})=>R.jsxs(Gf,{children:[n.thumbnail!=null?R.jsx(Kf,{src:n.thumbnail,alt:n.thumbnailAlt}):null,n.rows!=null?n.rows.map((e,t)=>R.jsx(Zf,{left:R.jsx(tc,{faded:!0,children:e.label}),right:R.jsx(tc,{children:e.value})},t)):null]}),g_=({data:n,conversationHandler:e})=>{const[t,r]=Se.useState(null),o=Se.useMemo(()=>Y1(n.$saveAs,e),[n.$saveAs,e]),s=l=>{r(l),o(l)};return R.jsx(B1,{children:n.cards.map((l,d)=>R.jsxs(Gf,{selected:l.id===t,onClick:l.id!=null?()=>{l.id!=null&&s(l.id)}:void 0,children:[l.thumbnail!=null?R.jsx(Kf,{src:l.thumbnail,alt:l.thumbnailAlt}):null,l.rows!=null?l.rows.map((f,m)=>R.jsx(Zf,{left:R.jsx(tc,{faded:!0,children:f.label}),right:R.jsx(tc,{children:f.value})},m)):null]},l.id??d))})},x_=({children:n,mode:e,theme:t})=>R.jsxs(R.Fragment,{children:[R.jsx("style",{children:U1}),R.jsx(Vu,{className:"bg-background p-4 rounded-outer space-y-4",theme:t,colorMode:e,children:n})]}),E_=yk.version,v_=n=>tk.bind((e,...t)=>Se.createElement(n[e]??e,...t)),P_=v_({TextButton:ko,IconButton:Cn,BaseText:tc,SmallText:BP,DateInput:J1,Carousel:B1,CustomCard:Gf,CustomCardRow:Zf,CustomCardImageRow:Kf,Ripple:Zl,...AC}),b_=()=>{const n=crypto.randomUUID();return sessionStorage.setItem("nlxConversationId",n),n},y_=()=>{const n=crypto.randomUUID();return localStorage.setItem("nlxUserId",n),n},w_=n=>{const e=n.config.applicationUrl??("botUrl"in n.config?n.config.botUrl:void 0);"botUrl"in n.config&&console.warn("The 'botUrl' configuration option is deprecated. Use 'applicationUrl' instead.");const t={...n.customModalities??{},DefaultDateInput:f_,DefaultCard:m_,DefaultCarousel:g_};return{...n,config:{...n.config,applicationUrl:e,conversationId:n.config.conversationId??sessionStorage.getItem("nlxConversationId")??b_(),userId:n.config.userId??localStorage.getItem("nlxUserId")??y_(),bidirectional:n.bidirectional==null?n.config.bidirectional??!1:!0},input:n.input??"text",customModalities:t,initializeConversation:n.initializeConversation??((r,o)=>{((n==null?void 0:n.input)??"text")==="text"&&r.sendWelcomeFlow(o)})}};let ew=()=>{const n=document.createElement("style");n.textContent=`:where(nlx-touchpoint.nlx-text, nlx-touchpoint.nlx-voice) {
    display: block;
    height: 350px;
  }
  :where(nlx-touchpoint.nlx-voiceMini) {
   display: inline-block;

  }`,document.head.appendChild(n),ew=()=>{}};var Cs,jl,Ca,$l,$u,uf;class k_ extends HTMLElement{constructor(){super(...arguments),xl(this,$u),xl(this,Cs,null),xl(this,jl,null),xl(this,Ca,null),yt(this,"onRef",null),yt(this,"embedded",!0),yt(this,"onClose",null),yt(this,"enableSettings",!1),xl(this,$l,!0)}set enabled(e){Or(this,$l)!==e&&(Wu(this,$l,e),Ug(this,$u,uf).call(this))}set touchpointConfiguration(e){mf(Or(this,Ca),e)||(Wu(this,Ca,e),Ug(this,$u,uf).call(this))}connectedCallback(){var e;if(Or(this,Ca)==null&&this.getAttribute("configuration")!=null)try{this.touchpointConfiguration=JSON.parse(this.getAttribute("configuration")??"")}catch(t){throw new Error("Failed to parse touchpoint configuration: "+(t instanceof Error?t.message:String(t)))}this.embedded&&(ew(),this.classList.add(`nlx-${((e=Or(this,Ca))==null?void 0:e.input)??"text"}`))}disconnectedCallback(){var e;(e=Or(this,Cs))==null||e.unmount()}}Cs=new WeakMap,jl=new WeakMap,Ca=new WeakMap,$l=new WeakMap,$u=new WeakSet,uf=function(){if(Or(this,jl)??Wu(this,jl,this.attachShadow({mode:"closed"})),Or(this,Cs)??Wu(this,Cs,ek.createRoot(Or(this,jl))),Or(this,Ca)!=null){const n=w_(Or(this,Ca));Or(this,Cs).render(R.jsxs(R.Fragment,{children:[R.jsx("style",{children:U1}),R.jsx(D1,{...n,embedded:this.embedded,onClose:this.onClose,enableSettings:this.enableSettings,enabled:Or(this,$l),ref:e=>{var t;e!=null&&((t=this.onRef)==null||t.call(this,e))}})]}))}};const C_=(n,e)=>{customElements.get(n)==null&&customElements.define(n,e)};C_("nlx-touchpoint",k_);const __=n=>new Promise(e=>{const t=document.createElement("nlx-touchpoint");t.embedded=!1,t.onRef=r=>{e({set expanded(o){r.setExpanded(o)},get expanded(){return r.getExpanded()},get conversationHandler(){return r.getConversationHandler()},teardown:()=>{document.body.removeChild(t)},setCustomBidirectionalCommands(o){r.setCustomBidirectionalCommands(o)}})},t.onClose=()=>{},t.enableSettings=!0,t.touchpointConfiguration=n,document.body.appendChild(t)});export{tc as BaseText,B1 as Carousel,Gf as CustomCard,Kf as CustomCardImageRow,Zf as CustomCardRow,J1 as DateInput,Cn as IconButton,AC as Icons,x_ as PreviewContainer,yo as React,Zl as Ripple,BP as SmallText,ko as TextButton,IP as analyzePageForms,__ as create,P_ as html,E_ as version};
