var Yb=Object.defineProperty,im=t=>{throw TypeError(t)},Xb=(t,e,n)=>e in t?Yb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X=(t,e,n)=>Xb(t,typeof e!="symbol"?e+"":e,n),ju=(t,e,n)=>e.has(t)||im("Cannot "+n),_t=(t,e,n)=>(ju(t,e,"read from private field"),n?n.call(t):e.get(t)),Pi=(t,e,n)=>e.has(t)?im("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ho=(t,e,n,r)=>(ju(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),dh=(t,e,n)=>(ju(t,e,"access private method"),n);function am(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var om={exports:{}},Os={},sm={exports:{}},W={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ja=Symbol.for("react.element"),e1=Symbol.for("react.portal"),t1=Symbol.for("react.fragment"),n1=Symbol.for("react.strict_mode"),r1=Symbol.for("react.profiler"),i1=Symbol.for("react.provider"),a1=Symbol.for("react.context"),o1=Symbol.for("react.forward_ref"),s1=Symbol.for("react.suspense"),c1=Symbol.for("react.memo"),l1=Symbol.for("react.lazy"),hh=Symbol.iterator;function u1(t){return t===null||typeof t!="object"?null:(t=hh&&t[hh]||t["@@iterator"],typeof t=="function"?t:null)}var cm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lm=Object.assign,um={};function wi(t,e,n){this.props=t,this.context=e,this.refs=um,this.updater=n||cm}wi.prototype.isReactComponent={};wi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dm(){}dm.prototype=wi.prototype;function Uu(t,e,n){this.props=t,this.context=e,this.refs=um,this.updater=n||cm}var Fu=Uu.prototype=new dm;Fu.constructor=Uu;lm(Fu,wi.prototype);Fu.isPureReactComponent=!0;var ph=Array.isArray,hm=Object.prototype.hasOwnProperty,Bu={current:null},pm={key:!0,ref:!0,__self:!0,__source:!0};function fm(t,e,n){var r,i={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)hm.call(e,r)&&!pm.hasOwnProperty(r)&&(i[r]=e[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:ja,type:t,key:a,ref:o,props:i,_owner:Bu.current}}function d1(t,e){return{$$typeof:ja,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zu(t){return typeof t=="object"&&t!==null&&t.$$typeof===ja}function h1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var fh=/\/+/g;function rc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?h1(""+t.key):e.toString(36)}function go(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ja:case e1:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+rc(o,0):r,ph(i)?(n="",t!=null&&(n=t.replace(fh,"$&/")+"/"),go(i,e,n,"",function(l){return l})):i!=null&&(zu(i)&&(i=d1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(fh,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",ph(t))for(var s=0;s<t.length;s++){a=t[s];var c=r+rc(a,s);o+=go(a,e,n,c,i)}else if(c=u1(t),typeof c=="function")for(t=c.call(t),s=0;!(a=t.next()).done;)a=a.value,c=r+rc(a,s++),o+=go(a,e,n,c,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ha(t,e,n){if(t==null)return t;var r=[],i=0;return go(t,r,"","",function(a){return e.call(n,a,i++)}),r}function p1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Je={current:null},vo={transition:null},f1={ReactCurrentDispatcher:Je,ReactCurrentBatchConfig:vo,ReactCurrentOwner:Bu};function mm(){throw Error("act(...) is not supported in production builds of React.")}W.Children={map:Ha,forEach:function(t,e,n){Ha(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ha(t,function(){e++}),e},toArray:function(t){return Ha(t,function(e){return e})||[]},only:function(t){if(!zu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};W.Component=wi;W.Fragment=t1;W.Profiler=r1;W.PureComponent=Uu;W.StrictMode=n1;W.Suspense=s1;W.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f1;W.act=mm;W.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lm({},t.props),i=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=Bu.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(c in e)hm.call(e,c)&&!pm.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&s!==void 0?s[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:ja,type:t.type,key:i,ref:a,props:r,_owner:o}};W.createContext=function(t){return t={$$typeof:a1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:i1,_context:t},t.Consumer=t};W.createElement=fm;W.createFactory=function(t){var e=fm.bind(null,t);return e.type=t,e};W.createRef=function(){return{current:null}};W.forwardRef=function(t){return{$$typeof:o1,render:t}};W.isValidElement=zu;W.lazy=function(t){return{$$typeof:l1,_payload:{_status:-1,_result:t},_init:p1}};W.memo=function(t,e){return{$$typeof:c1,type:t,compare:e===void 0?null:e}};W.startTransition=function(t){var e=vo.transition;vo.transition={};try{t()}finally{vo.transition=e}};W.unstable_act=mm;W.useCallback=function(t,e){return Je.current.useCallback(t,e)};W.useContext=function(t){return Je.current.useContext(t)};W.useDebugValue=function(){};W.useDeferredValue=function(t){return Je.current.useDeferredValue(t)};W.useEffect=function(t,e){return Je.current.useEffect(t,e)};W.useId=function(){return Je.current.useId()};W.useImperativeHandle=function(t,e,n){return Je.current.useImperativeHandle(t,e,n)};W.useInsertionEffect=function(t,e){return Je.current.useInsertionEffect(t,e)};W.useLayoutEffect=function(t,e){return Je.current.useLayoutEffect(t,e)};W.useMemo=function(t,e){return Je.current.useMemo(t,e)};W.useReducer=function(t,e,n){return Je.current.useReducer(t,e,n)};W.useRef=function(t){return Je.current.useRef(t)};W.useState=function(t){return Je.current.useState(t)};W.useSyncExternalStore=function(t,e,n){return Je.current.useSyncExternalStore(t,e,n)};W.useTransition=function(){return Je.current.useTransition()};W.version="18.3.1";sm.exports=W;var B=sm.exports;const mr=am(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m1=B,g1=Symbol.for("react.element"),v1=Symbol.for("react.fragment"),b1=Object.prototype.hasOwnProperty,y1=m1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,k1={key:!0,ref:!0,__self:!0,__source:!0};function gm(t,e,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)b1.call(e,r)&&!k1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:g1,type:t,key:a,ref:o,props:i,_owner:y1.current}}Os.Fragment=v1;Os.jsx=gm;Os.jsxs=gm;om.exports=Os;var C=om.exports,vm={exports:{}},ft={},bm={exports:{}},ym={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,z){var V=j.length;j.push(z);e:for(;0<V;){var J=V-1>>>1,fe=j[J];if(0<i(fe,z))j[J]=z,j[V]=fe,V=J;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var z=j[0],V=j.pop();if(V!==z){j[0]=V;e:for(var J=0,fe=j.length,Yn=fe>>>1;J<Yn;){var nn=2*(J+1)-1,Xn=j[nn],Ht=nn+1,Et=j[Ht];if(0>i(Xn,V))Ht<fe&&0>i(Et,Xn)?(j[J]=Et,j[Ht]=V,J=Ht):(j[J]=Xn,j[nn]=V,J=nn);else if(Ht<fe&&0>i(Et,V))j[J]=Et,j[Ht]=V,J=Ht;else break e}}return z}function i(j,z){var V=j.sortIndex-z.sortIndex;return V!==0?V:j.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var c=[],l=[],u=1,d=null,h=3,p=!1,f=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(j){for(var z=n(l);z!==null;){if(z.callback===null)r(l);else if(z.startTime<=j)r(l),z.sortIndex=z.expirationTime,e(c,z);else break;z=n(l)}}function g(j){if(b=!1,y(j),!f)if(n(c)!==null)f=!0,ze(S);else{var z=n(l);z!==null&&Le(g,z.startTime-j)}}function S(j,z){f=!1,b&&(b=!1,m(E),E=-1),p=!0;var V=h;try{for(y(z),d=n(c);d!==null&&(!(d.expirationTime>z)||j&&!F());){var J=d.callback;if(typeof J=="function"){d.callback=null,h=d.priorityLevel;var fe=J(d.expirationTime<=z);z=t.unstable_now(),typeof fe=="function"?d.callback=fe:d===n(c)&&r(c),y(z)}else r(c);d=n(c)}if(d!==null)var Yn=!0;else{var nn=n(l);nn!==null&&Le(g,nn.startTime-z),Yn=!1}return Yn}finally{d=null,h=V,p=!1}}var w=!1,T=null,E=-1,_=5,M=-1;function F(){return!(t.unstable_now()-M<_)}function H(){if(T!==null){var j=t.unstable_now();M=j;var z=!0;try{z=T(!0,j)}finally{z?ee():(w=!1,T=null)}}else w=!1}var ee;if(typeof v=="function")ee=function(){v(H)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,gt=G.port2;G.port1.onmessage=H,ee=function(){gt.postMessage(null)}}else ee=function(){x(H,0)};function ze(j){T=j,w||(w=!0,ee())}function Le(j,z){E=x(function(){j(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,ze(S))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(j){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var V=h;h=z;try{return j()}finally{h=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,z){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var V=h;h=j;try{return z()}finally{h=V}},t.unstable_scheduleCallback=function(j,z,V){var J=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?J+V:J):V=J,j){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=V+fe,j={id:u++,callback:z,priorityLevel:j,startTime:V,expirationTime:fe,sortIndex:-1},V>J?(j.sortIndex=V,e(l,j),n(c)===null&&j===n(l)&&(b?(m(E),E=-1):b=!0,Le(g,V-J))):(j.sortIndex=fe,e(c,j),f||p||(f=!0,ze(S))),j},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(j){var z=h;return function(){var V=h;h=z;try{return j.apply(this,arguments)}finally{h=V}}}})(ym);bm.exports=ym;var w1=bm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C1=B,pt=w1;function O(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var km=new Set,ma={};function xr(t,e){ui(t,e),ui(t+"Capture",e)}function ui(t,e){for(ma[t]=e,t=0;t<e.length;t++)km.add(e[t])}var pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yc=Object.prototype.hasOwnProperty,S1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mh={},gh={};function T1(t){return Yc.call(gh,t)?!0:Yc.call(mh,t)?!1:S1.test(t)?gh[t]=!0:(mh[t]=!0,!1)}function x1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function E1(t,e,n,r){if(e===null||typeof e>"u"||x1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ye(t,e,n,r,i,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var Be={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Be[t]=new Ye(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Be[e]=new Ye(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Be[t]=new Ye(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Be[t]=new Ye(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Be[t]=new Ye(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Be[t]=new Ye(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Be[t]=new Ye(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Be[t]=new Ye(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Be[t]=new Ye(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vu=/[\-:]([a-z])/g;function Hu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vu,Hu);Be[e]=new Ye(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vu,Hu);Be[e]=new Ye(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vu,Hu);Be[e]=new Ye(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Be[t]=new Ye(t,1,!1,t.toLowerCase(),null,!1,!1)});Be.xlinkHref=new Ye("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Be[t]=new Ye(t,1,!1,t.toLowerCase(),null,!0,!0)});function qu(t,e,n,r){var i=Be.hasOwnProperty(e)?Be[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E1(e,n,i,r)&&(n=null),r||i===null?T1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var yn=C1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qa=Symbol.for("react.element"),jr=Symbol.for("react.portal"),Ur=Symbol.for("react.fragment"),Wu=Symbol.for("react.strict_mode"),Xc=Symbol.for("react.profiler"),wm=Symbol.for("react.provider"),Cm=Symbol.for("react.context"),$u=Symbol.for("react.forward_ref"),el=Symbol.for("react.suspense"),tl=Symbol.for("react.suspense_list"),Gu=Symbol.for("react.memo"),Tn=Symbol.for("react.lazy"),Sm=Symbol.for("react.offscreen"),vh=Symbol.iterator;function Ri(t){return t===null||typeof t!="object"?null:(t=vh&&t[vh]||t["@@iterator"],typeof t=="function"?t:null)}var be=Object.assign,ic;function qi(t){if(ic===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ic=e&&e[1]||""}return`
`+ic+t}var ac=!1;function oc(t,e){if(!t||ac)return"";ac=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(o!==1||s!==1)do if(o--,s--,0>s||i[o]!==a[s]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=s);break}}}finally{ac=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?qi(t):""}function P1(t){switch(t.tag){case 5:return qi(t.type);case 16:return qi("Lazy");case 13:return qi("Suspense");case 19:return qi("SuspenseList");case 0:case 2:case 15:return t=oc(t.type,!1),t;case 11:return t=oc(t.type.render,!1),t;case 1:return t=oc(t.type,!0),t;default:return""}}function nl(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ur:return"Fragment";case jr:return"Portal";case Xc:return"Profiler";case Wu:return"StrictMode";case el:return"Suspense";case tl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Cm:return(t.displayName||"Context")+".Consumer";case wm:return(t._context.displayName||"Context")+".Provider";case $u:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gu:return e=t.displayName||null,e!==null?e:nl(t.type)||"Memo";case Tn:e=t._payload,t=t._init;try{return nl(t(e))}catch{}}return null}function R1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nl(e);case 8:return e===Wu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Tm(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function I1(t){var e=Tm(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Wa(t){t._valueTracker||(t._valueTracker=I1(t))}function xm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Tm(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function qo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function rl(t,e){var n=e.checked;return be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function bh(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Em(t,e){e=e.checked,e!=null&&qu(t,"checked",e,!1)}function il(t,e){Em(t,e);var n=Hn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?al(t,e.type,n):e.hasOwnProperty("defaultValue")&&al(t,e.type,Hn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yh(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function al(t,e,n){(e!=="number"||qo(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wi=Array.isArray;function Yr(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ol(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(O(91));return be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kh(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(O(92));if(Wi(n)){if(1<n.length)throw Error(O(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hn(n)}}function Pm(t,e){var n=Hn(e.value),r=Hn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Rm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sl(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Rm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $a,Im=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($a=$a||document.createElement("div"),$a.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$a.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ga(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Qi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_1=["Webkit","ms","Moz","O"];Object.keys(Qi).forEach(function(t){_1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Qi[e]=Qi[t]})});function _m(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Qi.hasOwnProperty(t)&&Qi[t]?(""+e).trim():e+"px"}function Om(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=_m(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var O1=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cl(t,e){if(e){if(O1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(O(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(O(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(O(61))}if(e.style!=null&&typeof e.style!="object")throw Error(O(62))}}function ll(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ul=null;function Ku(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var dl=null,Xr=null,ei=null;function Ch(t){if(t=Ba(t)){if(typeof dl!="function")throw Error(O(280));var e=t.stateNode;e&&(e=As(e),dl(t.stateNode,t.type,e))}}function Mm(t){Xr?ei?ei.push(t):ei=[t]:Xr=t}function Nm(){if(Xr){var t=Xr,e=ei;if(ei=Xr=null,Ch(t),e)for(t=0;t<e.length;t++)Ch(e[t])}}function Lm(t,e){return t(e)}function Dm(){}var sc=!1;function Am(t,e,n){if(sc)return t(e,n);sc=!0;try{return Lm(t,e,n)}finally{sc=!1,(Xr!==null||ei!==null)&&(Dm(),Nm())}}function va(t,e){var n=t.stateNode;if(n===null)return null;var r=As(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(O(231,e,typeof n));return n}var hl=!1;if(pn)try{var Ii={};Object.defineProperty(Ii,"passive",{get:function(){hl=!0}}),window.addEventListener("test",Ii,Ii),window.removeEventListener("test",Ii,Ii)}catch{hl=!1}function M1(t,e,n,r,i,a,o,s,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var Ji=!1,Wo=null,$o=!1,pl=null,N1={onError:function(t){Ji=!0,Wo=t}};function L1(t,e,n,r,i,a,o,s,c){Ji=!1,Wo=null,M1.apply(N1,arguments)}function D1(t,e,n,r,i,a,o,s,c){if(L1.apply(this,arguments),Ji){if(Ji){var l=Wo;Ji=!1,Wo=null}else throw Error(O(198));$o||($o=!0,pl=l)}}function Er(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function jm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Sh(t){if(Er(t)!==t)throw Error(O(188))}function A1(t){var e=t.alternate;if(!e){if(e=Er(t),e===null)throw Error(O(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Sh(i),t;if(a===r)return Sh(i),e;a=a.sibling}throw Error(O(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,s=i.child;s;){if(s===n){o=!0,n=i,r=a;break}if(s===r){o=!0,r=i,n=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===n){o=!0,n=a,r=i;break}if(s===r){o=!0,r=a,n=i;break}s=s.sibling}if(!o)throw Error(O(189))}}if(n.alternate!==r)throw Error(O(190))}if(n.tag!==3)throw Error(O(188));return n.stateNode.current===n?t:e}function Um(t){return t=A1(t),t!==null?Fm(t):null}function Fm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Fm(t);if(e!==null)return e;t=t.sibling}return null}var Bm=pt.unstable_scheduleCallback,Th=pt.unstable_cancelCallback,j1=pt.unstable_shouldYield,U1=pt.unstable_requestPaint,Se=pt.unstable_now,F1=pt.unstable_getCurrentPriorityLevel,Zu=pt.unstable_ImmediatePriority,zm=pt.unstable_UserBlockingPriority,Go=pt.unstable_NormalPriority,B1=pt.unstable_LowPriority,Vm=pt.unstable_IdlePriority,Ms=null,Jt=null;function z1(t){if(Jt&&typeof Jt.onCommitFiberRoot=="function")try{Jt.onCommitFiberRoot(Ms,t,void 0,(t.current.flags&128)===128)}catch{}}var Ut=Math.clz32?Math.clz32:q1,V1=Math.log,H1=Math.LN2;function q1(t){return t>>>=0,t===0?32:31-(V1(t)/H1|0)|0}var Ga=64,Ka=4194304;function $i(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ko(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var s=o&~i;s!==0?r=$i(s):(a&=o,a!==0&&(r=$i(a)))}else o=n&~i,o!==0?r=$i(o):a!==0&&(r=$i(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ut(e),i=1<<n,r|=t[n],e&=~i;return r}function W1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-Ut(a),s=1<<o,c=i[o];c===-1?(!(s&n)||s&r)&&(i[o]=W1(s,e)):c<=e&&(t.expiredLanes|=s),a&=~s}}function fl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Hm(){var t=Ga;return Ga<<=1,!(Ga&4194240)&&(Ga=64),t}function cc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ua(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ut(e),t[e]=n}function G1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ut(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function Qu(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ut(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var re=0;function qm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Wm,Ju,$m,Gm,Km,ml=!1,Za=[],Nn=null,Ln=null,Dn=null,ba=new Map,ya=new Map,En=[],K1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xh(t,e){switch(t){case"focusin":case"focusout":Nn=null;break;case"dragenter":case"dragleave":Ln=null;break;case"mouseover":case"mouseout":Dn=null;break;case"pointerover":case"pointerout":ba.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ya.delete(e.pointerId)}}function _i(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Ba(e),e!==null&&Ju(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Z1(t,e,n,r,i){switch(e){case"focusin":return Nn=_i(Nn,t,e,n,r,i),!0;case"dragenter":return Ln=_i(Ln,t,e,n,r,i),!0;case"mouseover":return Dn=_i(Dn,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return ba.set(a,_i(ba.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,ya.set(a,_i(ya.get(a)||null,t,e,n,r,i)),!0}return!1}function Zm(t){var e=or(t.target);if(e!==null){var n=Er(e);if(n!==null){if(e=n.tag,e===13){if(e=jm(n),e!==null){t.blockedOn=e,Km(t.priority,function(){$m(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function bo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=gl(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ul=r,n.target.dispatchEvent(r),ul=null}else return e=Ba(n),e!==null&&Ju(e),t.blockedOn=n,!1;e.shift()}return!0}function Eh(t,e,n){bo(t)&&n.delete(e)}function Q1(){ml=!1,Nn!==null&&bo(Nn)&&(Nn=null),Ln!==null&&bo(Ln)&&(Ln=null),Dn!==null&&bo(Dn)&&(Dn=null),ba.forEach(Eh),ya.forEach(Eh)}function Oi(t,e){t.blockedOn===e&&(t.blockedOn=null,ml||(ml=!0,pt.unstable_scheduleCallback(pt.unstable_NormalPriority,Q1)))}function ka(t){function e(i){return Oi(i,t)}if(0<Za.length){Oi(Za[0],t);for(var n=1;n<Za.length;n++){var r=Za[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Nn!==null&&Oi(Nn,t),Ln!==null&&Oi(Ln,t),Dn!==null&&Oi(Dn,t),ba.forEach(e),ya.forEach(e),n=0;n<En.length;n++)r=En[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<En.length&&(n=En[0],n.blockedOn===null);)Zm(n),n.blockedOn===null&&En.shift()}var ti=yn.ReactCurrentBatchConfig,Zo=!0;function J1(t,e,n,r){var i=re,a=ti.transition;ti.transition=null;try{re=1,Yu(t,e,n,r)}finally{re=i,ti.transition=a}}function Y1(t,e,n,r){var i=re,a=ti.transition;ti.transition=null;try{re=4,Yu(t,e,n,r)}finally{re=i,ti.transition=a}}function Yu(t,e,n,r){if(Zo){var i=gl(t,e,n,r);if(i===null)bc(t,e,r,Qo,n),xh(t,r);else if(Z1(i,t,e,n,r))r.stopPropagation();else if(xh(t,r),e&4&&-1<K1.indexOf(t)){for(;i!==null;){var a=Ba(i);if(a!==null&&Wm(a),a=gl(t,e,n,r),a===null&&bc(t,e,r,Qo,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else bc(t,e,r,null,n)}}var Qo=null;function gl(t,e,n,r){if(Qo=null,t=Ku(r),t=or(t),t!==null)if(e=Er(t),e===null)t=null;else if(n=e.tag,n===13){if(t=jm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qo=t,null}function Qm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(F1()){case Zu:return 1;case zm:return 4;case Go:case B1:return 16;case Vm:return 536870912;default:return 16}default:return 16}}var _n=null,Xu=null,yo=null;function Jm(){if(yo)return yo;var t,e=Xu,n=e.length,r,i="value"in _n?_n.value:_n.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[a-r];r++);return yo=i.slice(t,1<r?1-r:void 0)}function ko(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Qa(){return!0}function Ph(){return!1}function mt(t){function e(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Qa:Ph,this.isPropagationStopped=Ph,this}return be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Qa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Qa)},persist:function(){},isPersistent:Qa}),e}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ed=mt(Ci),Fa=be({},Ci,{view:0,detail:0}),X1=mt(Fa),lc,uc,Mi,Ns=be({},Fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:td,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mi&&(Mi&&t.type==="mousemove"?(lc=t.screenX-Mi.screenX,uc=t.screenY-Mi.screenY):uc=lc=0,Mi=t),lc)},movementY:function(t){return"movementY"in t?t.movementY:uc}}),Rh=mt(Ns),ey=be({},Ns,{dataTransfer:0}),ty=mt(ey),ny=be({},Fa,{relatedTarget:0}),dc=mt(ny),ry=be({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),iy=mt(ry),ay=be({},Ci,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oy=mt(ay),sy=be({},Ci,{data:0}),Ih=mt(sy),cy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ly={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dy(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=uy[t])?!!e[t]:!1}function td(){return dy}var hy=be({},Fa,{key:function(t){if(t.key){var e=cy[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ko(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ly[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:td,charCode:function(t){return t.type==="keypress"?ko(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ko(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),py=mt(hy),fy=be({},Ns,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_h=mt(fy),my=be({},Fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:td}),gy=mt(my),vy=be({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),by=mt(vy),yy=be({},Ns,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ky=mt(yy),wy=[9,13,27,32],nd=pn&&"CompositionEvent"in window,Yi=null;pn&&"documentMode"in document&&(Yi=document.documentMode);var Cy=pn&&"TextEvent"in window&&!Yi,Ym=pn&&(!nd||Yi&&8<Yi&&11>=Yi),Oh=" ",Mh=!1;function Xm(t,e){switch(t){case"keyup":return wy.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fr=!1;function Sy(t,e){switch(t){case"compositionend":return eg(e);case"keypress":return e.which!==32?null:(Mh=!0,Oh);case"textInput":return t=e.data,t===Oh&&Mh?null:t;default:return null}}function Ty(t,e){if(Fr)return t==="compositionend"||!nd&&Xm(t,e)?(t=Jm(),yo=Xu=_n=null,Fr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ym&&e.locale!=="ko"?null:e.data;default:return null}}var xy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!xy[t.type]:e==="textarea"}function tg(t,e,n,r){Mm(r),e=Jo(e,"onChange"),0<e.length&&(n=new ed("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xi=null,wa=null;function Ey(t){hg(t,0)}function Ls(t){var e=Vr(t);if(xm(e))return t}function Py(t,e){if(t==="change")return e}var ng=!1;if(pn){var hc;if(pn){var pc="oninput"in document;if(!pc){var Lh=document.createElement("div");Lh.setAttribute("oninput","return;"),pc=typeof Lh.oninput=="function"}hc=pc}else hc=!1;ng=hc&&(!document.documentMode||9<document.documentMode)}function Dh(){Xi&&(Xi.detachEvent("onpropertychange",rg),wa=Xi=null)}function rg(t){if(t.propertyName==="value"&&Ls(wa)){var e=[];tg(e,wa,t,Ku(t)),Am(Ey,e)}}function Ry(t,e,n){t==="focusin"?(Dh(),Xi=e,wa=n,Xi.attachEvent("onpropertychange",rg)):t==="focusout"&&Dh()}function Iy(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ls(wa)}function _y(t,e){if(t==="click")return Ls(e)}function Oy(t,e){if(t==="input"||t==="change")return Ls(e)}function My(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bt=typeof Object.is=="function"?Object.is:My;function Ca(t,e){if(Bt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Yc.call(e,i)||!Bt(t[i],e[i]))return!1}return!0}function Ah(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jh(t,e){var n=Ah(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ah(n)}}function ig(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ig(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ag(){for(var t=window,e=qo();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=qo(t.document)}return e}function rd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ny(t){var e=ag(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ig(n.ownerDocument.documentElement,n)){if(r!==null&&rd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=jh(n,a);var o=jh(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ly=pn&&"documentMode"in document&&11>=document.documentMode,Br=null,vl=null,ea=null,bl=!1;function Uh(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bl||Br==null||Br!==qo(r)||(r=Br,"selectionStart"in r&&rd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ea&&Ca(ea,r)||(ea=r,r=Jo(vl,"onSelect"),0<r.length&&(e=new ed("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Br)))}function Ja(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var zr={animationend:Ja("Animation","AnimationEnd"),animationiteration:Ja("Animation","AnimationIteration"),animationstart:Ja("Animation","AnimationStart"),transitionend:Ja("Transition","TransitionEnd")},fc={},og={};pn&&(og=document.createElement("div").style,"AnimationEvent"in window||(delete zr.animationend.animation,delete zr.animationiteration.animation,delete zr.animationstart.animation),"TransitionEvent"in window||delete zr.transitionend.transition);function Ds(t){if(fc[t])return fc[t];if(!zr[t])return t;var e=zr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in og)return fc[t]=e[n];return t}var sg=Ds("animationend"),cg=Ds("animationiteration"),lg=Ds("animationstart"),ug=Ds("transitionend"),dg=new Map,Fh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gn(t,e){dg.set(t,e),xr(e,[t])}for(var mc=0;mc<Fh.length;mc++){var gc=Fh[mc],Dy=gc.toLowerCase(),Ay=gc[0].toUpperCase()+gc.slice(1);Gn(Dy,"on"+Ay)}Gn(sg,"onAnimationEnd");Gn(cg,"onAnimationIteration");Gn(lg,"onAnimationStart");Gn("dblclick","onDoubleClick");Gn("focusin","onFocus");Gn("focusout","onBlur");Gn(ug,"onTransitionEnd");ui("onMouseEnter",["mouseout","mouseover"]);ui("onMouseLeave",["mouseout","mouseover"]);ui("onPointerEnter",["pointerout","pointerover"]);ui("onPointerLeave",["pointerout","pointerover"]);xr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xr("onBeforeInput",["compositionend","keypress","textInput","paste"]);xr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gi));function Bh(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,D1(r,e,void 0,t),t.currentTarget=null}function hg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==a&&i.isPropagationStopped())break e;Bh(i,s,l),a=c}else for(o=0;o<r.length;o++){if(s=r[o],c=s.instance,l=s.currentTarget,s=s.listener,c!==a&&i.isPropagationStopped())break e;Bh(i,s,l),a=c}}}if($o)throw t=pl,$o=!1,pl=null,t}function le(t,e){var n=e[Sl];n===void 0&&(n=e[Sl]=new Set);var r=t+"__bubble";n.has(r)||(pg(e,t,2,!1),n.add(r))}function vc(t,e,n){var r=0;e&&(r|=4),pg(n,t,r,e)}var Ya="_reactListening"+Math.random().toString(36).slice(2);function Sa(t){if(!t[Ya]){t[Ya]=!0,km.forEach(function(n){n!=="selectionchange"&&(jy.has(n)||vc(n,!1,t),vc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ya]||(e[Ya]=!0,vc("selectionchange",!1,e))}}function pg(t,e,n,r){switch(Qm(e)){case 1:var i=J1;break;case 4:i=Y1;break;default:i=Yu}n=i.bind(null,e,n,t),i=void 0,!hl||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function bc(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;s!==null;){if(o=or(s),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}s=s.parentNode}}r=r.return}Am(function(){var l=a,u=Ku(n),d=[];e:{var h=dg.get(t);if(h!==void 0){var p=ed,f=t;switch(t){case"keypress":if(ko(n)===0)break e;case"keydown":case"keyup":p=py;break;case"focusin":f="focus",p=dc;break;case"focusout":f="blur",p=dc;break;case"beforeblur":case"afterblur":p=dc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=ty;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=gy;break;case sg:case cg:case lg:p=iy;break;case ug:p=by;break;case"scroll":p=X1;break;case"wheel":p=ky;break;case"copy":case"cut":case"paste":p=oy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=_h}var b=(e&4)!==0,x=!b&&t==="scroll",m=b?h!==null?h+"Capture":null:h;b=[];for(var v=l,y;v!==null;){y=v;var g=y.stateNode;if(y.tag===5&&g!==null&&(y=g,m!==null&&(g=va(v,m),g!=null&&b.push(Ta(v,g,y)))),x)break;v=v.return}0<b.length&&(h=new p(h,f,null,n,u),d.push({event:h,listeners:b}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==ul&&(f=n.relatedTarget||n.fromElement)&&(or(f)||f[fn]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(f=n.relatedTarget||n.toElement,p=l,f=f?or(f):null,f!==null&&(x=Er(f),f!==x||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=l),p!==f)){if(b=Rh,g="onMouseLeave",m="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(b=_h,g="onPointerLeave",m="onPointerEnter",v="pointer"),x=p==null?h:Vr(p),y=f==null?h:Vr(f),h=new b(g,v+"leave",p,n,u),h.target=x,h.relatedTarget=y,g=null,or(u)===l&&(b=new b(m,v+"enter",f,n,u),b.target=y,b.relatedTarget=x,g=b),x=g,p&&f)t:{for(b=p,m=f,v=0,y=b;y;y=_r(y))v++;for(y=0,g=m;g;g=_r(g))y++;for(;0<v-y;)b=_r(b),v--;for(;0<y-v;)m=_r(m),y--;for(;v--;){if(b===m||m!==null&&b===m.alternate)break t;b=_r(b),m=_r(m)}b=null}else b=null;p!==null&&zh(d,h,p,b,!1),f!==null&&x!==null&&zh(d,x,f,b,!0)}}e:{if(h=l?Vr(l):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var S=Py;else if(Nh(h))if(ng)S=Oy;else{S=Iy;var w=Ry}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=_y);if(S&&(S=S(t,l))){tg(d,S,n,u);break e}w&&w(t,h,l),t==="focusout"&&(w=h._wrapperState)&&w.controlled&&h.type==="number"&&al(h,"number",h.value)}switch(w=l?Vr(l):window,t){case"focusin":(Nh(w)||w.contentEditable==="true")&&(Br=w,vl=l,ea=null);break;case"focusout":ea=vl=Br=null;break;case"mousedown":bl=!0;break;case"contextmenu":case"mouseup":case"dragend":bl=!1,Uh(d,n,u);break;case"selectionchange":if(Ly)break;case"keydown":case"keyup":Uh(d,n,u)}var T;if(nd)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Fr?Xm(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Ym&&n.locale!=="ko"&&(Fr||E!=="onCompositionStart"?E==="onCompositionEnd"&&Fr&&(T=Jm()):(_n=u,Xu="value"in _n?_n.value:_n.textContent,Fr=!0)),w=Jo(l,E),0<w.length&&(E=new Ih(E,t,null,n,u),d.push({event:E,listeners:w}),T?E.data=T:(T=eg(n),T!==null&&(E.data=T)))),(T=Cy?Sy(t,n):Ty(t,n))&&(l=Jo(l,"onBeforeInput"),0<l.length&&(u=new Ih("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=T))}hg(d,e)})}function Ta(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Jo(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=va(t,n),a!=null&&r.unshift(Ta(t,a,i)),a=va(t,e),a!=null&&r.push(Ta(t,a,i))),t=t.return}return r}function _r(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function zh(t,e,n,r,i){for(var a=e._reactName,o=[];n!==null&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(c!==null&&c===r)break;s.tag===5&&l!==null&&(s=l,i?(c=va(n,a),c!=null&&o.unshift(Ta(n,c,s))):i||(c=va(n,a),c!=null&&o.push(Ta(n,c,s)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Uy=/\r\n?/g,Fy=/\u0000|\uFFFD/g;function Vh(t){return(typeof t=="string"?t:""+t).replace(Uy,`
`).replace(Fy,"")}function Xa(t,e,n){if(e=Vh(e),Vh(t)!==e&&n)throw Error(O(425))}function Yo(){}var yl=null,kl=null;function wl(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Cl=typeof setTimeout=="function"?setTimeout:void 0,By=typeof clearTimeout=="function"?clearTimeout:void 0,Hh=typeof Promise=="function"?Promise:void 0,zy=typeof queueMicrotask=="function"?queueMicrotask:typeof Hh<"u"?function(t){return Hh.resolve(null).then(t).catch(Vy)}:Cl;function Vy(t){setTimeout(function(){throw t})}function yc(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ka(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ka(e)}function An(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qh(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Si=Math.random().toString(36).slice(2),Qt="__reactFiber$"+Si,xa="__reactProps$"+Si,fn="__reactContainer$"+Si,Sl="__reactEvents$"+Si,Hy="__reactListeners$"+Si,qy="__reactHandles$"+Si;function or(t){var e=t[Qt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fn]||n[Qt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qh(t);t!==null;){if(n=t[Qt])return n;t=qh(t)}return e}t=n,n=t.parentNode}return null}function Ba(t){return t=t[Qt]||t[fn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(O(33))}function As(t){return t[xa]||null}var Tl=[],Hr=-1;function Kn(t){return{current:t}}function ue(t){0>Hr||(t.current=Tl[Hr],Tl[Hr]=null,Hr--)}function ce(t,e){Hr++,Tl[Hr]=t.current,t.current=e}var qn={},We=Kn(qn),it=Kn(!1),gr=qn;function di(t,e){var n=t.type.contextTypes;if(!n)return qn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function at(t){return t=t.childContextTypes,t!=null}function Xo(){ue(it),ue(We)}function Wh(t,e,n){if(We.current!==qn)throw Error(O(168));ce(We,e),ce(it,n)}function fg(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(O(108,R1(t)||"Unknown",i));return be({},n,r)}function es(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qn,gr=We.current,ce(We,t),ce(it,it.current),!0}function $h(t,e,n){var r=t.stateNode;if(!r)throw Error(O(169));n?(t=fg(t,e,gr),r.__reactInternalMemoizedMergedChildContext=t,ue(it),ue(We),ce(We,t)):ue(it),ce(it,n)}var an=null,js=!1,kc=!1;function mg(t){an===null?an=[t]:an.push(t)}function Wy(t){js=!0,mg(t)}function Zn(){if(!kc&&an!==null){kc=!0;var t=0,e=re;try{var n=an;for(re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}an=null,js=!1}catch(i){throw an!==null&&(an=an.slice(t+1)),Bm(Zu,Zn),i}finally{re=e,kc=!1}}return null}var qr=[],Wr=0,ts=null,ns=0,vt=[],bt=0,vr=null,ln=1,un="";function tr(t,e){qr[Wr++]=ns,qr[Wr++]=ts,ts=t,ns=e}function gg(t,e,n){vt[bt++]=ln,vt[bt++]=un,vt[bt++]=vr,vr=t;var r=ln;t=un;var i=32-Ut(r)-1;r&=~(1<<i),n+=1;var a=32-Ut(e)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ln=1<<32-Ut(e)+i|n<<i|r,un=a+t}else ln=1<<a|n<<i|r,un=t}function id(t){t.return!==null&&(tr(t,1),gg(t,1,0))}function ad(t){for(;t===ts;)ts=qr[--Wr],qr[Wr]=null,ns=qr[--Wr],qr[Wr]=null;for(;t===vr;)vr=vt[--bt],vt[bt]=null,un=vt[--bt],vt[bt]=null,ln=vt[--bt],vt[bt]=null}var ht=null,ut=null,he=!1,Lt=null;function vg(t,e){var n=yt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Gh(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ht=t,ut=An(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ht=t,ut=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vr!==null?{id:ln,overflow:un}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=yt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ht=t,ut=null,!0):!1;default:return!1}}function xl(t){return(t.mode&1)!==0&&(t.flags&128)===0}function El(t){if(he){var e=ut;if(e){var n=e;if(!Gh(t,e)){if(xl(t))throw Error(O(418));e=An(n.nextSibling);var r=ht;e&&Gh(t,e)?vg(r,n):(t.flags=t.flags&-4097|2,he=!1,ht=t)}}else{if(xl(t))throw Error(O(418));t.flags=t.flags&-4097|2,he=!1,ht=t}}}function Kh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ht=t}function eo(t){if(t!==ht)return!1;if(!he)return Kh(t),he=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!wl(t.type,t.memoizedProps)),e&&(e=ut)){if(xl(t))throw bg(),Error(O(418));for(;e;)vg(t,e),e=An(e.nextSibling)}if(Kh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(O(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ut=An(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ut=null}}else ut=ht?An(t.stateNode.nextSibling):null;return!0}function bg(){for(var t=ut;t;)t=An(t.nextSibling)}function hi(){ut=ht=null,he=!1}function od(t){Lt===null?Lt=[t]:Lt.push(t)}var $y=yn.ReactCurrentBatchConfig;function Ni(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(O(309));var r=n.stateNode}if(!r)throw Error(O(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var s=i.refs;o===null?delete s[a]:s[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(O(284));if(!n._owner)throw Error(O(290,t))}return t}function to(t,e){throw t=Object.prototype.toString.call(e),Error(O(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Zh(t){var e=t._init;return e(t._payload)}function yg(t){function e(m,v){if(t){var y=m.deletions;y===null?(m.deletions=[v],m.flags|=16):y.push(v)}}function n(m,v){if(!t)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=Bn(m,v),m.index=0,m.sibling=null,m}function a(m,v,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<v?(m.flags|=2,v):y):(m.flags|=2,v)):(m.flags|=1048576,v)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function s(m,v,y,g){return v===null||v.tag!==6?(v=Pc(y,m.mode,g),v.return=m,v):(v=i(v,y),v.return=m,v)}function c(m,v,y,g){var S=y.type;return S===Ur?u(m,v,y.props.children,g,y.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Tn&&Zh(S)===v.type)?(g=i(v,y.props),g.ref=Ni(m,v,y),g.return=m,g):(g=Po(y.type,y.key,y.props,null,m.mode,g),g.ref=Ni(m,v,y),g.return=m,g)}function l(m,v,y,g){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=Rc(y,m.mode,g),v.return=m,v):(v=i(v,y.children||[]),v.return=m,v)}function u(m,v,y,g,S){return v===null||v.tag!==7?(v=hr(y,m.mode,g,S),v.return=m,v):(v=i(v,y),v.return=m,v)}function d(m,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Pc(""+v,m.mode,y),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case qa:return y=Po(v.type,v.key,v.props,null,m.mode,y),y.ref=Ni(m,null,v),y.return=m,y;case jr:return v=Rc(v,m.mode,y),v.return=m,v;case Tn:var g=v._init;return d(m,g(v._payload),y)}if(Wi(v)||Ri(v))return v=hr(v,m.mode,y,null),v.return=m,v;to(m,v)}return null}function h(m,v,y,g){var S=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:s(m,v,""+y,g);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case qa:return y.key===S?c(m,v,y,g):null;case jr:return y.key===S?l(m,v,y,g):null;case Tn:return S=y._init,h(m,v,S(y._payload),g)}if(Wi(y)||Ri(y))return S!==null?null:u(m,v,y,g,null);to(m,y)}return null}function p(m,v,y,g,S){if(typeof g=="string"&&g!==""||typeof g=="number")return m=m.get(y)||null,s(v,m,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case qa:return m=m.get(g.key===null?y:g.key)||null,c(v,m,g,S);case jr:return m=m.get(g.key===null?y:g.key)||null,l(v,m,g,S);case Tn:var w=g._init;return p(m,v,y,w(g._payload),S)}if(Wi(g)||Ri(g))return m=m.get(y)||null,u(v,m,g,S,null);to(v,g)}return null}function f(m,v,y,g){for(var S=null,w=null,T=v,E=v=0,_=null;T!==null&&E<y.length;E++){T.index>E?(_=T,T=null):_=T.sibling;var M=h(m,T,y[E],g);if(M===null){T===null&&(T=_);break}t&&T&&M.alternate===null&&e(m,T),v=a(M,v,E),w===null?S=M:w.sibling=M,w=M,T=_}if(E===y.length)return n(m,T),he&&tr(m,E),S;if(T===null){for(;E<y.length;E++)T=d(m,y[E],g),T!==null&&(v=a(T,v,E),w===null?S=T:w.sibling=T,w=T);return he&&tr(m,E),S}for(T=r(m,T);E<y.length;E++)_=p(T,m,E,y[E],g),_!==null&&(t&&_.alternate!==null&&T.delete(_.key===null?E:_.key),v=a(_,v,E),w===null?S=_:w.sibling=_,w=_);return t&&T.forEach(function(F){return e(m,F)}),he&&tr(m,E),S}function b(m,v,y,g){var S=Ri(y);if(typeof S!="function")throw Error(O(150));if(y=S.call(y),y==null)throw Error(O(151));for(var w=S=null,T=v,E=v=0,_=null,M=y.next();T!==null&&!M.done;E++,M=y.next()){T.index>E?(_=T,T=null):_=T.sibling;var F=h(m,T,M.value,g);if(F===null){T===null&&(T=_);break}t&&T&&F.alternate===null&&e(m,T),v=a(F,v,E),w===null?S=F:w.sibling=F,w=F,T=_}if(M.done)return n(m,T),he&&tr(m,E),S;if(T===null){for(;!M.done;E++,M=y.next())M=d(m,M.value,g),M!==null&&(v=a(M,v,E),w===null?S=M:w.sibling=M,w=M);return he&&tr(m,E),S}for(T=r(m,T);!M.done;E++,M=y.next())M=p(T,m,E,M.value,g),M!==null&&(t&&M.alternate!==null&&T.delete(M.key===null?E:M.key),v=a(M,v,E),w===null?S=M:w.sibling=M,w=M);return t&&T.forEach(function(H){return e(m,H)}),he&&tr(m,E),S}function x(m,v,y,g){if(typeof y=="object"&&y!==null&&y.type===Ur&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case qa:e:{for(var S=y.key,w=v;w!==null;){if(w.key===S){if(S=y.type,S===Ur){if(w.tag===7){n(m,w.sibling),v=i(w,y.props.children),v.return=m,m=v;break e}}else if(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Tn&&Zh(S)===w.type){n(m,w.sibling),v=i(w,y.props),v.ref=Ni(m,w,y),v.return=m,m=v;break e}n(m,w);break}else e(m,w);w=w.sibling}y.type===Ur?(v=hr(y.props.children,m.mode,g,y.key),v.return=m,m=v):(g=Po(y.type,y.key,y.props,null,m.mode,g),g.ref=Ni(m,v,y),g.return=m,m=g)}return o(m);case jr:e:{for(w=y.key;v!==null;){if(v.key===w)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){n(m,v.sibling),v=i(v,y.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else e(m,v);v=v.sibling}v=Rc(y,m.mode,g),v.return=m,m=v}return o(m);case Tn:return w=y._init,x(m,v,w(y._payload),g)}if(Wi(y))return f(m,v,y,g);if(Ri(y))return b(m,v,y,g);to(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,y),v.return=m,m=v):(n(m,v),v=Pc(y,m.mode,g),v.return=m,m=v),o(m)):n(m,v)}return x}var pi=yg(!0),kg=yg(!1),rs=Kn(null),is=null,$r=null,sd=null;function cd(){sd=$r=is=null}function ld(t){var e=rs.current;ue(rs),t._currentValue=e}function Pl(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ni(t,e){is=t,sd=$r=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(nt=!0),t.firstContext=null)}function Tt(t){var e=t._currentValue;if(sd!==t)if(t={context:t,memoizedValue:e,next:null},$r===null){if(is===null)throw Error(O(308));$r=t,is.dependencies={lanes:0,firstContext:t}}else $r=$r.next=t;return e}var sr=null;function ud(t){sr===null?sr=[t]:sr.push(t)}function wg(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,ud(e)):(n.next=i.next,i.next=n),e.interleaved=n,mn(t,r)}function mn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xn=!1;function dd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cg(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function hn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function jn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Q&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,mn(t,n)}return i=r.interleaved,i===null?(e.next=e,ud(r)):(e.next=i.next,i.next=e),r.interleaved=e,mn(t,n)}function wo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Qu(t,n)}}function Qh(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function as(t,e,n,r){var i=t.updateQueue;xn=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var c=s,l=c.next;c.next=null,o===null?a=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,s=u.lastBaseUpdate,s!==o&&(s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(a!==null){var d=i.baseState;o=0,u=l=c=null,s=a;do{var h=s.lane,p=s.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=t,b=s;switch(h=e,p=n,b.tag){case 1:if(f=b.payload,typeof f=="function"){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=b.payload,h=typeof f=="function"?f.call(p,d,h):f,h==null)break e;d=be({},d,h);break e;case 2:xn=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},u===null?(l=u=p,c=d):u=u.next=p,o|=h;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;h=s,s=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);yr|=o,t.lanes=o,t.memoizedState=d}}function Jh(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(O(191,i));i.call(r)}}}var za={},Yt=Kn(za),Ea=Kn(za),Pa=Kn(za);function cr(t){if(t===za)throw Error(O(174));return t}function hd(t,e){switch(ce(Pa,e),ce(Ea,t),ce(Yt,za),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sl(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sl(e,t)}ue(Yt),ce(Yt,e)}function fi(){ue(Yt),ue(Ea),ue(Pa)}function Sg(t){cr(Pa.current);var e=cr(Yt.current),n=sl(e,t.type);e!==n&&(ce(Ea,t),ce(Yt,n))}function pd(t){Ea.current===t&&(ue(Yt),ue(Ea))}var ge=Kn(0);function os(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wc=[];function fd(){for(var t=0;t<wc.length;t++)wc[t]._workInProgressVersionPrimary=null;wc.length=0}var Co=yn.ReactCurrentDispatcher,Cc=yn.ReactCurrentBatchConfig,br=0,ve=null,Re=null,Oe=null,ss=!1,ta=!1,Ra=0,Gy=0;function Ve(){throw Error(O(321))}function md(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Bt(t[n],e[n]))return!1;return!0}function gd(t,e,n,r,i,a){if(br=a,ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Co.current=t===null||t.memoizedState===null?Jy:Yy,t=n(r,i),ta){a=0;do{if(ta=!1,Ra=0,25<=a)throw Error(O(301));a+=1,Oe=Re=null,e.updateQueue=null,Co.current=Xy,t=n(r,i)}while(ta)}if(Co.current=cs,e=Re!==null&&Re.next!==null,br=0,Oe=Re=ve=null,ss=!1,e)throw Error(O(300));return t}function vd(){var t=Ra!==0;return Ra=0,t}function Gt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Oe===null?ve.memoizedState=Oe=t:Oe=Oe.next=t,Oe}function xt(){if(Re===null){var t=ve.alternate;t=t!==null?t.memoizedState:null}else t=Re.next;var e=Oe===null?ve.memoizedState:Oe.next;if(e!==null)Oe=e,Re=t;else{if(t===null)throw Error(O(310));Re=t,t={memoizedState:Re.memoizedState,baseState:Re.baseState,baseQueue:Re.baseQueue,queue:Re.queue,next:null},Oe===null?ve.memoizedState=Oe=t:Oe=Oe.next=t}return Oe}function Ia(t,e){return typeof e=="function"?e(t):e}function Sc(t){var e=xt(),n=e.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=t;var r=Re,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var s=o=null,c=null,l=a;do{var u=l.lane;if((br&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(s=c=d,o=r):c=c.next=d,ve.lanes|=u,yr|=u}l=l.next}while(l!==null&&l!==a);c===null?o=r:c.next=s,Bt(r,e.memoizedState)||(nt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,ve.lanes|=a,yr|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Tc(t){var e=xt(),n=e.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);Bt(a,e.memoizedState)||(nt=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Tg(){}function xg(t,e){var n=ve,r=xt(),i=e(),a=!Bt(r.memoizedState,i);if(a&&(r.memoizedState=i,nt=!0),r=r.queue,bd(Rg.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Oe!==null&&Oe.memoizedState.tag&1){if(n.flags|=2048,_a(9,Pg.bind(null,n,r,i,e),void 0,null),Ne===null)throw Error(O(349));br&30||Eg(n,e,i)}return i}function Eg(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Pg(t,e,n,r){e.value=n,e.getSnapshot=r,Ig(e)&&_g(t)}function Rg(t,e,n){return n(function(){Ig(e)&&_g(t)})}function Ig(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Bt(t,n)}catch{return!0}}function _g(t){var e=mn(t,1);e!==null&&Ft(e,t,1,-1)}function Yh(t){var e=Gt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:t},e.queue=t,t=t.dispatch=Qy.bind(null,ve,t),[e.memoizedState,t]}function _a(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Og(){return xt().memoizedState}function So(t,e,n,r){var i=Gt();ve.flags|=t,i.memoizedState=_a(1|e,n,void 0,r===void 0?null:r)}function Us(t,e,n,r){var i=xt();r=r===void 0?null:r;var a=void 0;if(Re!==null){var o=Re.memoizedState;if(a=o.destroy,r!==null&&md(r,o.deps)){i.memoizedState=_a(e,n,a,r);return}}ve.flags|=t,i.memoizedState=_a(1|e,n,a,r)}function Xh(t,e){return So(8390656,8,t,e)}function bd(t,e){return Us(2048,8,t,e)}function Mg(t,e){return Us(4,2,t,e)}function Ng(t,e){return Us(4,4,t,e)}function Lg(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Dg(t,e,n){return n=n!=null?n.concat([t]):null,Us(4,4,Lg.bind(null,e,t),n)}function yd(){}function Ag(t,e){var n=xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&md(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function jg(t,e){var n=xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&md(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ug(t,e,n){return br&21?(Bt(n,e)||(n=Hm(),ve.lanes|=n,yr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,nt=!0),t.memoizedState=n)}function Ky(t,e){var n=re;re=n!==0&&4>n?n:4,t(!0);var r=Cc.transition;Cc.transition={};try{t(!1),e()}finally{re=n,Cc.transition=r}}function Fg(){return xt().memoizedState}function Zy(t,e,n){var r=Fn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Bg(t))zg(e,n);else if(n=wg(t,e,n,r),n!==null){var i=Qe();Ft(n,t,r,i),Vg(n,e,r)}}function Qy(t,e,n){var r=Fn(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Bg(t))zg(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,Bt(s,o)){var c=e.interleaved;c===null?(i.next=i,ud(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=wg(t,e,i,r),n!==null&&(i=Qe(),Ft(n,t,r,i),Vg(n,e,r))}}function Bg(t){var e=t.alternate;return t===ve||e!==null&&e===ve}function zg(t,e){ta=ss=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Vg(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Qu(t,n)}}var cs={readContext:Tt,useCallback:Ve,useContext:Ve,useEffect:Ve,useImperativeHandle:Ve,useInsertionEffect:Ve,useLayoutEffect:Ve,useMemo:Ve,useReducer:Ve,useRef:Ve,useState:Ve,useDebugValue:Ve,useDeferredValue:Ve,useTransition:Ve,useMutableSource:Ve,useSyncExternalStore:Ve,useId:Ve,unstable_isNewReconciler:!1},Jy={readContext:Tt,useCallback:function(t,e){return Gt().memoizedState=[t,e===void 0?null:e],t},useContext:Tt,useEffect:Xh,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,So(4194308,4,Lg.bind(null,e,t),n)},useLayoutEffect:function(t,e){return So(4194308,4,t,e)},useInsertionEffect:function(t,e){return So(4,2,t,e)},useMemo:function(t,e){var n=Gt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Zy.bind(null,ve,t),[r.memoizedState,t]},useRef:function(t){var e=Gt();return t={current:t},e.memoizedState=t},useState:Yh,useDebugValue:yd,useDeferredValue:function(t){return Gt().memoizedState=t},useTransition:function(){var t=Yh(!1),e=t[0];return t=Ky.bind(null,t[1]),Gt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ve,i=Gt();if(he){if(n===void 0)throw Error(O(407));n=n()}else{if(n=e(),Ne===null)throw Error(O(349));br&30||Eg(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,Xh(Rg.bind(null,r,a,t),[t]),r.flags|=2048,_a(9,Pg.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=Gt(),e=Ne.identifierPrefix;if(he){var n=un,r=ln;n=(r&~(1<<32-Ut(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ra++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Gy++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Yy={readContext:Tt,useCallback:Ag,useContext:Tt,useEffect:bd,useImperativeHandle:Dg,useInsertionEffect:Mg,useLayoutEffect:Ng,useMemo:jg,useReducer:Sc,useRef:Og,useState:function(){return Sc(Ia)},useDebugValue:yd,useDeferredValue:function(t){var e=xt();return Ug(e,Re.memoizedState,t)},useTransition:function(){var t=Sc(Ia)[0],e=xt().memoizedState;return[t,e]},useMutableSource:Tg,useSyncExternalStore:xg,useId:Fg,unstable_isNewReconciler:!1},Xy={readContext:Tt,useCallback:Ag,useContext:Tt,useEffect:bd,useImperativeHandle:Dg,useInsertionEffect:Mg,useLayoutEffect:Ng,useMemo:jg,useReducer:Tc,useRef:Og,useState:function(){return Tc(Ia)},useDebugValue:yd,useDeferredValue:function(t){var e=xt();return Re===null?e.memoizedState=t:Ug(e,Re.memoizedState,t)},useTransition:function(){var t=Tc(Ia)[0],e=xt().memoizedState;return[t,e]},useMutableSource:Tg,useSyncExternalStore:xg,useId:Fg,unstable_isNewReconciler:!1};function Ot(t,e){if(t&&t.defaultProps){e=be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Rl(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fs={isMounted:function(t){return(t=t._reactInternals)?Er(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Qe(),i=Fn(t),a=hn(r,i);a.payload=e,n!=null&&(a.callback=n),e=jn(t,a,i),e!==null&&(Ft(e,t,i,r),wo(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Qe(),i=Fn(t),a=hn(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=jn(t,a,i),e!==null&&(Ft(e,t,i,r),wo(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Qe(),r=Fn(t),i=hn(n,r);i.tag=2,e!=null&&(i.callback=e),e=jn(t,i,r),e!==null&&(Ft(e,t,r,n),wo(e,t,r))}};function ep(t,e,n,r,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!Ca(n,r)||!Ca(i,a):!0}function Hg(t,e,n){var r=!1,i=qn,a=e.contextType;return typeof a=="object"&&a!==null?a=Tt(a):(i=at(e)?gr:We.current,r=e.contextTypes,a=(r=r!=null)?di(t,i):qn),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fs,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function tp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Fs.enqueueReplaceState(e,e.state,null)}function Il(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},dd(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Tt(a):(a=at(e)?gr:We.current,i.context=di(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Rl(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Fs.enqueueReplaceState(i,i.state,null),as(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function mi(t,e){try{var n="",r=e;do n+=P1(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function xc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function _l(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ek=typeof WeakMap=="function"?WeakMap:Map;function qg(t,e,n){n=hn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){us||(us=!0,Fl=r),_l(t,e)},n}function Wg(t,e,n){n=hn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){_l(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){_l(t,e),typeof r!="function"&&(Un===null?Un=new Set([this]):Un.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function np(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ek;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=fk.bind(null,t,e,n),e.then(t,t))}function rp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ip(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=hn(-1,1),e.tag=2,jn(n,e,1))),n.lanes|=1),t)}var tk=yn.ReactCurrentOwner,nt=!1;function Ke(t,e,n,r){e.child=t===null?kg(e,null,n,r):pi(e,t.child,n,r)}function ap(t,e,n,r,i){n=n.render;var a=e.ref;return ni(e,i),r=gd(t,e,n,r,a,i),n=vd(),t!==null&&!nt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gn(t,e,i)):(he&&n&&id(e),e.flags|=1,Ke(t,e,r,i),e.child)}function op(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!Pd(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,$g(t,e,a,r,i)):(t=Po(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ca,n(o,r)&&t.ref===e.ref)return gn(t,e,i)}return e.flags|=1,t=Bn(a,r),t.ref=e.ref,t.return=e,e.child=t}function $g(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(Ca(a,r)&&t.ref===e.ref)if(nt=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(nt=!0);else return e.lanes=t.lanes,gn(t,e,i)}return Ol(t,e,n,r,i)}function Gg(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ce(Kr,ct),ct|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ce(Kr,ct),ct|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,ce(Kr,ct),ct|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,ce(Kr,ct),ct|=r;return Ke(t,e,i,n),e.child}function Kg(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ol(t,e,n,r,i){var a=at(n)?gr:We.current;return a=di(e,a),ni(e,i),n=gd(t,e,n,r,a,i),r=vd(),t!==null&&!nt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gn(t,e,i)):(he&&r&&id(e),e.flags|=1,Ke(t,e,n,i),e.child)}function sp(t,e,n,r,i){if(at(n)){var a=!0;es(e)}else a=!1;if(ni(e,i),e.stateNode===null)To(t,e),Hg(e,n,r),Il(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,s=e.memoizedProps;o.props=s;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Tt(l):(l=at(n)?gr:We.current,l=di(e,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==r||c!==l)&&tp(e,o,r,l),xn=!1;var h=e.memoizedState;o.state=h,as(e,r,o,i),c=e.memoizedState,s!==r||h!==c||it.current||xn?(typeof u=="function"&&(Rl(e,n,u,r),c=e.memoizedState),(s=xn||ep(e,n,s,r,h,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=s):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Cg(t,e),s=e.memoizedProps,l=e.type===e.elementType?s:Ot(e.type,s),o.props=l,d=e.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Tt(c):(c=at(n)?gr:We.current,c=di(e,c));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==d||h!==c)&&tp(e,o,r,c),xn=!1,h=e.memoizedState,o.state=h,as(e,r,o,i);var f=e.memoizedState;s!==d||h!==f||it.current||xn?(typeof p=="function"&&(Rl(e,n,p,r),f=e.memoizedState),(l=xn||ep(e,n,l,r,h,f,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,f,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,f,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=f),o.props=r,o.state=f,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Ml(t,e,n,r,a,i)}function Ml(t,e,n,r,i,a){Kg(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&$h(e,n,!1),gn(t,e,a);r=e.stateNode,tk.current=e;var s=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=pi(e,t.child,null,a),e.child=pi(e,null,s,a)):Ke(t,e,s,a),e.memoizedState=r.state,i&&$h(e,n,!0),e.child}function Zg(t){var e=t.stateNode;e.pendingContext?Wh(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Wh(t,e.context,!1),hd(t,e.containerInfo)}function cp(t,e,n,r,i){return hi(),od(i),e.flags|=256,Ke(t,e,n,r),e.child}var Nl={dehydrated:null,treeContext:null,retryLane:0};function Ll(t){return{baseLanes:t,cachePool:null,transitions:null}}function Qg(t,e,n){var r=e.pendingProps,i=ge.current,a=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=t!==null&&t.memoizedState===null?!1:(i&2)!==0),s?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ce(ge,i&1),t===null)return El(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Vs(o,r,0,null),t=hr(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Ll(n),e.memoizedState=Nl,t):kd(e,o));if(i=t.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return nk(t,e,o,r,s,i,n);if(a){a=r.fallback,o=e.mode,i=t.child,s=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Bn(i,c),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?a=Bn(s,a):(a=hr(a,o,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?Ll(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=Nl,r}return a=t.child,t=a.sibling,r=Bn(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function kd(t,e){return e=Vs({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function no(t,e,n,r){return r!==null&&od(r),pi(e,t.child,null,n),t=kd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function nk(t,e,n,r,i,a,o){if(n)return e.flags&256?(e.flags&=-257,r=xc(Error(O(422))),no(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=Vs({mode:"visible",children:r.children},i,0,null),a=hr(a,i,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&pi(e,t.child,null,o),e.child.memoizedState=Ll(o),e.memoizedState=Nl,a);if(!(e.mode&1))return no(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,a=Error(O(419)),r=xc(a,r,void 0),no(t,e,o,r)}if(s=(o&t.childLanes)!==0,nt||s){if(r=Ne,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,mn(t,i),Ft(r,t,i,-1))}return Ed(),r=xc(Error(O(421))),no(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=mk.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,ut=An(i.nextSibling),ht=e,he=!0,Lt=null,t!==null&&(vt[bt++]=ln,vt[bt++]=un,vt[bt++]=vr,ln=t.id,un=t.overflow,vr=e),e=kd(e,r.children),e.flags|=4096,e)}function lp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Pl(t.return,e,n)}function Ec(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Jg(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(Ke(t,e,r.children,n),r=ge.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lp(t,n,e);else if(t.tag===19)lp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ce(ge,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&os(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ec(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&os(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ec(e,!0,n,null,a);break;case"together":Ec(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function To(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),yr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(O(153));if(e.child!==null){for(t=e.child,n=Bn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Bn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function rk(t,e,n){switch(e.tag){case 3:Zg(e),hi();break;case 5:Sg(e);break;case 1:at(e.type)&&es(e);break;case 4:hd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ce(rs,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ce(ge,ge.current&1),e.flags|=128,null):n&e.child.childLanes?Qg(t,e,n):(ce(ge,ge.current&1),t=gn(t,e,n),t!==null?t.sibling:null);ce(ge,ge.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Jg(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ce(ge,ge.current),r)break;return null;case 22:case 23:return e.lanes=0,Gg(t,e,n)}return gn(t,e,n)}var Yg,Dl,Xg,ev;Yg=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Dl=function(){};Xg=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,cr(Yt.current);var a=null;switch(n){case"input":i=rl(t,i),r=rl(t,r),a=[];break;case"select":i=be({},i,{value:void 0}),r=be({},r,{value:void 0}),a=[];break;case"textarea":i=ol(t,i),r=ol(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Yo)}cl(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var s=i[l];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ma.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in r){var c=r[l];if(s=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(c!=null||s!=null))if(l==="style")if(s){for(o in s)!s.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&s[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,s=s?s.__html:void 0,c!=null&&s!==c&&(a=a||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(ma.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&le("scroll",t),a||s===c||(a=[])):(a=a||[]).push(l,c))}n&&(a=a||[]).push("style",n);var l=a;(e.updateQueue=l)&&(e.flags|=4)}};ev=function(t,e,n,r){n!==r&&(e.flags|=4)};function Li(t,e){if(!he)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function He(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ik(t,e,n){var r=e.pendingProps;switch(ad(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return He(e),null;case 1:return at(e.type)&&Xo(),He(e),null;case 3:return r=e.stateNode,fi(),ue(it),ue(We),fd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(eo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Lt!==null&&(Vl(Lt),Lt=null))),Dl(t,e),He(e),null;case 5:pd(e);var i=cr(Pa.current);if(n=e.type,t!==null&&e.stateNode!=null)Xg(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(O(166));return He(e),null}if(t=cr(Yt.current),eo(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Qt]=e,r[xa]=a,t=(e.mode&1)!==0,n){case"dialog":le("cancel",r),le("close",r);break;case"iframe":case"object":case"embed":le("load",r);break;case"video":case"audio":for(i=0;i<Gi.length;i++)le(Gi[i],r);break;case"source":le("error",r);break;case"img":case"image":case"link":le("error",r),le("load",r);break;case"details":le("toggle",r);break;case"input":bh(r,a),le("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},le("invalid",r);break;case"textarea":kh(r,a),le("invalid",r)}cl(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];o==="children"?typeof s=="string"?r.textContent!==s&&(a.suppressHydrationWarning!==!0&&Xa(r.textContent,s,t),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&Xa(r.textContent,s,t),i=["children",""+s]):ma.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&le("scroll",r)}switch(n){case"input":Wa(r),yh(r,a,!0);break;case"textarea":Wa(r),wh(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Yo)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Rm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Qt]=e,t[xa]=r,Yg(t,e,!1,!1),e.stateNode=t;e:{switch(o=ll(n,r),n){case"dialog":le("cancel",t),le("close",t),i=r;break;case"iframe":case"object":case"embed":le("load",t),i=r;break;case"video":case"audio":for(i=0;i<Gi.length;i++)le(Gi[i],t);i=r;break;case"source":le("error",t),i=r;break;case"img":case"image":case"link":le("error",t),le("load",t),i=r;break;case"details":le("toggle",t),i=r;break;case"input":bh(t,r),i=rl(t,r),le("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=be({},r,{value:void 0}),le("invalid",t);break;case"textarea":kh(t,r),i=ol(t,r),le("invalid",t);break;default:i=r}cl(n,i),s=i;for(a in s)if(s.hasOwnProperty(a)){var c=s[a];a==="style"?Om(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Im(t,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ga(t,c):typeof c=="number"&&ga(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ma.hasOwnProperty(a)?c!=null&&a==="onScroll"&&le("scroll",t):c!=null&&qu(t,a,c,o))}switch(n){case"input":Wa(t),yh(t,r,!1);break;case"textarea":Wa(t),wh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hn(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Yr(t,!!r.multiple,a,!1):r.defaultValue!=null&&Yr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Yo)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return He(e),null;case 6:if(t&&e.stateNode!=null)ev(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(O(166));if(n=cr(Pa.current),cr(Yt.current),eo(e)){if(r=e.stateNode,n=e.memoizedProps,r[Qt]=e,(a=r.nodeValue!==n)&&(t=ht,t!==null))switch(t.tag){case 3:Xa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Xa(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qt]=e,e.stateNode=r}return He(e),null;case 13:if(ue(ge),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(he&&ut!==null&&e.mode&1&&!(e.flags&128))bg(),hi(),e.flags|=98560,a=!1;else if(a=eo(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(O(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(O(317));a[Qt]=e}else hi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;He(e),a=!1}else Lt!==null&&(Vl(Lt),Lt=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ge.current&1?Ie===0&&(Ie=3):Ed())),e.updateQueue!==null&&(e.flags|=4),He(e),null);case 4:return fi(),Dl(t,e),t===null&&Sa(e.stateNode.containerInfo),He(e),null;case 10:return ld(e.type._context),He(e),null;case 17:return at(e.type)&&Xo(),He(e),null;case 19:if(ue(ge),a=e.memoizedState,a===null)return He(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)Li(a,!1);else{if(Ie!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=os(t),o!==null){for(e.flags|=128,Li(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ce(ge,ge.current&1|2),e.child}t=t.sibling}a.tail!==null&&Se()>gi&&(e.flags|=128,r=!0,Li(a,!1),e.lanes=4194304)}else{if(!r)if(t=os(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Li(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!he)return He(e),null}else 2*Se()-a.renderingStartTime>gi&&n!==1073741824&&(e.flags|=128,r=!0,Li(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Se(),e.sibling=null,n=ge.current,ce(ge,r?n&1|2:n&1),e):(He(e),null);case 22:case 23:return xd(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ct&1073741824&&(He(e),e.subtreeFlags&6&&(e.flags|=8192)):He(e),null;case 24:return null;case 25:return null}throw Error(O(156,e.tag))}function ak(t,e){switch(ad(e),e.tag){case 1:return at(e.type)&&Xo(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fi(),ue(it),ue(We),fd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pd(e),null;case 13:if(ue(ge),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(O(340));hi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ue(ge),null;case 4:return fi(),null;case 10:return ld(e.type._context),null;case 22:case 23:return xd(),null;case 24:return null;default:return null}}var ro=!1,qe=!1,ok=typeof WeakSet=="function"?WeakSet:Set,U=null;function Gr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ke(t,e,r)}else n.current=null}function tv(t,e,n){try{n()}catch(r){ke(t,e,r)}}var up=!1;function sk(t,e){if(yl=Zo,t=ag(),rd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,s=-1,c=-1,l=0,u=0,d=t,h=null;t:for(;;){for(var p;d!==n||i!==0&&d.nodeType!==3||(s=o+i),d!==a||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++l===i&&(s=o),h===a&&++u===r&&(c=o),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=s===-1||c===-1?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(kl={focusedElem:t,selectionRange:n},Zo=!1,U=e;U!==null;)if(e=U,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,U=t;else for(;U!==null;){e=U;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var b=f.memoizedProps,x=f.memoizedState,m=e.stateNode,v=m.getSnapshotBeforeUpdate(e.elementType===e.type?b:Ot(e.type,b),x);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(O(163))}}catch(g){ke(e,e.return,g)}if(t=e.sibling,t!==null){t.return=e.return,U=t;break}U=e.return}return f=up,up=!1,f}function na(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&tv(e,n,a)}i=i.next}while(i!==r)}}function Bs(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Al(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function nv(t){var e=t.alternate;e!==null&&(t.alternate=null,nv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qt],delete e[xa],delete e[Sl],delete e[Hy],delete e[qy])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rv(t){return t.tag===5||t.tag===3||t.tag===4}function dp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jl(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Yo));else if(r!==4&&(t=t.child,t!==null))for(jl(t,e,n),t=t.sibling;t!==null;)jl(t,e,n),t=t.sibling}function Ul(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ul(t,e,n),t=t.sibling;t!==null;)Ul(t,e,n),t=t.sibling}var Ae=null,Mt=!1;function kn(t,e,n){for(n=n.child;n!==null;)iv(t,e,n),n=n.sibling}function iv(t,e,n){if(Jt&&typeof Jt.onCommitFiberUnmount=="function")try{Jt.onCommitFiberUnmount(Ms,n)}catch{}switch(n.tag){case 5:qe||Gr(n,e);case 6:var r=Ae,i=Mt;Ae=null,kn(t,e,n),Ae=r,Mt=i,Ae!==null&&(Mt?(t=Ae,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ae.removeChild(n.stateNode));break;case 18:Ae!==null&&(Mt?(t=Ae,n=n.stateNode,t.nodeType===8?yc(t.parentNode,n):t.nodeType===1&&yc(t,n),ka(t)):yc(Ae,n.stateNode));break;case 4:r=Ae,i=Mt,Ae=n.stateNode.containerInfo,Mt=!0,kn(t,e,n),Ae=r,Mt=i;break;case 0:case 11:case 14:case 15:if(!qe&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&tv(n,e,o),i=i.next}while(i!==r)}kn(t,e,n);break;case 1:if(!qe&&(Gr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){ke(n,e,s)}kn(t,e,n);break;case 21:kn(t,e,n);break;case 22:n.mode&1?(qe=(r=qe)||n.memoizedState!==null,kn(t,e,n),qe=r):kn(t,e,n);break;default:kn(t,e,n)}}function hp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ok),e.forEach(function(r){var i=gk.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Pt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,o=e,s=o;e:for(;s!==null;){switch(s.tag){case 5:Ae=s.stateNode,Mt=!1;break e;case 3:Ae=s.stateNode.containerInfo,Mt=!0;break e;case 4:Ae=s.stateNode.containerInfo,Mt=!0;break e}s=s.return}if(Ae===null)throw Error(O(160));iv(a,o,i),Ae=null,Mt=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){ke(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)av(e,t),e=e.sibling}function av(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Pt(e,t),qt(t),r&4){try{na(3,t,t.return),Bs(3,t)}catch(b){ke(t,t.return,b)}try{na(5,t,t.return)}catch(b){ke(t,t.return,b)}}break;case 1:Pt(e,t),qt(t),r&512&&n!==null&&Gr(n,n.return);break;case 5:if(Pt(e,t),qt(t),r&512&&n!==null&&Gr(n,n.return),t.flags&32){var i=t.stateNode;try{ga(i,"")}catch(b){ke(t,t.return,b)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,s=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&Em(i,a),ll(s,o);var l=ll(s,a);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?Om(i,d):u==="dangerouslySetInnerHTML"?Im(i,d):u==="children"?ga(i,d):qu(i,u,d,l)}switch(s){case"input":il(i,a);break;case"textarea":Pm(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Yr(i,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?Yr(i,!!a.multiple,a.defaultValue,!0):Yr(i,!!a.multiple,a.multiple?[]:"",!1))}i[xa]=a}catch(b){ke(t,t.return,b)}}break;case 6:if(Pt(e,t),qt(t),r&4){if(t.stateNode===null)throw Error(O(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(b){ke(t,t.return,b)}}break;case 3:if(Pt(e,t),qt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ka(e.containerInfo)}catch(b){ke(t,t.return,b)}break;case 4:Pt(e,t),qt(t);break;case 13:Pt(e,t),qt(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Sd=Se())),r&4&&hp(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(qe=(l=qe)||u,Pt(e,t),qe=l):Pt(e,t),qt(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(U=t,u=t.child;u!==null;){for(d=U=u;U!==null;){switch(h=U,p=h.child,h.tag){case 0:case 11:case 14:case 15:na(4,h,h.return);break;case 1:Gr(h,h.return);var f=h.stateNode;if(typeof f.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(b){ke(r,n,b)}}break;case 5:Gr(h,h.return);break;case 22:if(h.memoizedState!==null){fp(d);continue}}p!==null?(p.return=h,U=p):fp(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,s.style.display=_m("display",o))}catch(b){ke(t,t.return,b)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(b){ke(t,t.return,b)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Pt(e,t),qt(t),r&4&&hp(t);break;case 21:break;default:Pt(e,t),qt(t)}}function qt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(rv(n)){var r=n;break e}n=n.return}throw Error(O(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ga(i,""),r.flags&=-33);var a=dp(t);Ul(t,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,s=dp(t);jl(t,s,o);break;default:throw Error(O(161))}}catch(c){ke(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ck(t,e,n){U=t,ov(t)}function ov(t,e,n){for(var r=(t.mode&1)!==0;U!==null;){var i=U,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||ro;if(!o){var s=i.alternate,c=s!==null&&s.memoizedState!==null||qe;s=ro;var l=qe;if(ro=o,(qe=c)&&!l)for(U=i;U!==null;)o=U,c=o.child,o.tag===22&&o.memoizedState!==null?mp(i):c!==null?(c.return=o,U=c):mp(i);for(;a!==null;)U=a,ov(a),a=a.sibling;U=i,ro=s,qe=l}pp(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,U=a):pp(t)}}function pp(t){for(;U!==null;){var e=U;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qe||Bs(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!qe)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ot(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Jh(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Jh(e,o,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ka(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(O(163))}qe||e.flags&512&&Al(e)}catch(h){ke(e,e.return,h)}}if(e===t){U=null;break}if(n=e.sibling,n!==null){n.return=e.return,U=n;break}U=e.return}}function fp(t){for(;U!==null;){var e=U;if(e===t){U=null;break}var n=e.sibling;if(n!==null){n.return=e.return,U=n;break}U=e.return}}function mp(t){for(;U!==null;){var e=U;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bs(4,e)}catch(c){ke(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){ke(e,i,c)}}var a=e.return;try{Al(e)}catch(c){ke(e,a,c)}break;case 5:var o=e.return;try{Al(e)}catch(c){ke(e,o,c)}}}catch(c){ke(e,e.return,c)}if(e===t){U=null;break}var s=e.sibling;if(s!==null){s.return=e.return,U=s;break}U=e.return}}var lk=Math.ceil,ls=yn.ReactCurrentDispatcher,wd=yn.ReactCurrentOwner,St=yn.ReactCurrentBatchConfig,Q=0,Ne=null,Ee=null,Fe=0,ct=0,Kr=Kn(0),Ie=0,Oa=null,yr=0,zs=0,Cd=0,ra=null,et=null,Sd=0,gi=1/0,rn=null,us=!1,Fl=null,Un=null,io=!1,On=null,ds=0,ia=0,Bl=null,xo=-1,Eo=0;function Qe(){return Q&6?Se():xo!==-1?xo:xo=Se()}function Fn(t){return t.mode&1?Q&2&&Fe!==0?Fe&-Fe:$y.transition!==null?(Eo===0&&(Eo=Hm()),Eo):(t=re,t!==0||(t=window.event,t=t===void 0?16:Qm(t.type)),t):1}function Ft(t,e,n,r){if(50<ia)throw ia=0,Bl=null,Error(O(185));Ua(t,n,r),(!(Q&2)||t!==Ne)&&(t===Ne&&(!(Q&2)&&(zs|=n),Ie===4&&Pn(t,Fe)),ot(t,r),n===1&&Q===0&&!(e.mode&1)&&(gi=Se()+500,js&&Zn()))}function ot(t,e){var n=t.callbackNode;$1(t,e);var r=Ko(t,t===Ne?Fe:0);if(r===0)n!==null&&Th(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Th(n),e===1)t.tag===0?Wy(gp.bind(null,t)):mg(gp.bind(null,t)),zy(function(){!(Q&6)&&Zn()}),n=null;else{switch(qm(r)){case 1:n=Zu;break;case 4:n=zm;break;case 16:n=Go;break;case 536870912:n=Vm;break;default:n=Go}n=fv(n,sv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sv(t,e){if(xo=-1,Eo=0,Q&6)throw Error(O(327));var n=t.callbackNode;if(ri()&&t.callbackNode!==n)return null;var r=Ko(t,t===Ne?Fe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hs(t,r);else{e=r;var i=Q;Q|=2;var a=lv();(Ne!==t||Fe!==e)&&(rn=null,gi=Se()+500,dr(t,e));do try{hk();break}catch(s){cv(t,s)}while(!0);cd(),ls.current=a,Q=i,Ee!==null?e=0:(Ne=null,Fe=0,e=Ie)}if(e!==0){if(e===2&&(i=fl(t),i!==0&&(r=i,e=zl(t,i))),e===1)throw n=Oa,dr(t,0),Pn(t,r),ot(t,Se()),n;if(e===6)Pn(t,r);else{if(i=t.current.alternate,!(r&30)&&!uk(i)&&(e=hs(t,r),e===2&&(a=fl(t),a!==0&&(r=a,e=zl(t,a))),e===1))throw n=Oa,dr(t,0),Pn(t,r),ot(t,Se()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(O(345));case 2:nr(t,et,rn);break;case 3:if(Pn(t,r),(r&130023424)===r&&(e=Sd+500-Se(),10<e)){if(Ko(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Qe(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Cl(nr.bind(null,t,et,rn),e);break}nr(t,et,rn);break;case 4:if(Pn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Ut(r);a=1<<o,o=e[o],o>i&&(i=o),r&=~a}if(r=i,r=Se()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lk(r/1960))-r,10<r){t.timeoutHandle=Cl(nr.bind(null,t,et,rn),r);break}nr(t,et,rn);break;case 5:nr(t,et,rn);break;default:throw Error(O(329))}}}return ot(t,Se()),t.callbackNode===n?sv.bind(null,t):null}function zl(t,e){var n=ra;return t.current.memoizedState.isDehydrated&&(dr(t,e).flags|=256),t=hs(t,e),t!==2&&(e=et,et=n,e!==null&&Vl(e)),t}function Vl(t){et===null?et=t:et.push.apply(et,t)}function uk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Bt(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pn(t,e){for(e&=~Cd,e&=~zs,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ut(e),r=1<<n;t[n]=-1,e&=~r}}function gp(t){if(Q&6)throw Error(O(327));ri();var e=Ko(t,0);if(!(e&1))return ot(t,Se()),null;var n=hs(t,e);if(t.tag!==0&&n===2){var r=fl(t);r!==0&&(e=r,n=zl(t,r))}if(n===1)throw n=Oa,dr(t,0),Pn(t,e),ot(t,Se()),n;if(n===6)throw Error(O(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nr(t,et,rn),ot(t,Se()),null}function Td(t,e){var n=Q;Q|=1;try{return t(e)}finally{Q=n,Q===0&&(gi=Se()+500,js&&Zn())}}function kr(t){On!==null&&On.tag===0&&!(Q&6)&&ri();var e=Q;Q|=1;var n=St.transition,r=re;try{if(St.transition=null,re=1,t)return t()}finally{re=r,St.transition=n,Q=e,!(Q&6)&&Zn()}}function xd(){ct=Kr.current,ue(Kr)}function dr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,By(n)),Ee!==null)for(n=Ee.return;n!==null;){var r=n;switch(ad(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Xo();break;case 3:fi(),ue(it),ue(We),fd();break;case 5:pd(r);break;case 4:fi();break;case 13:ue(ge);break;case 19:ue(ge);break;case 10:ld(r.type._context);break;case 22:case 23:xd()}n=n.return}if(Ne=t,Ee=t=Bn(t.current,null),Fe=ct=e,Ie=0,Oa=null,Cd=zs=yr=0,et=ra=null,sr!==null){for(e=0;e<sr.length;e++)if(n=sr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}sr=null}return t}function cv(t,e){do{var n=Ee;try{if(cd(),Co.current=cs,ss){for(var r=ve.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ss=!1}if(br=0,Oe=Re=ve=null,ta=!1,Ra=0,wd.current=null,n===null||n.return===null){Ie=1,Oa=e,Ee=null;break}e:{var a=t,o=n.return,s=n,c=e;if(e=Fe,s.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=s,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=rp(o);if(p!==null){p.flags&=-257,ip(p,o,s,a,e),p.mode&1&&np(a,l,e),e=p,c=l;var f=e.updateQueue;if(f===null){var b=new Set;b.add(c),e.updateQueue=b}else f.add(c);break e}else{if(!(e&1)){np(a,l,e),Ed();break e}c=Error(O(426))}}else if(he&&s.mode&1){var x=rp(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),ip(x,o,s,a,e),od(mi(c,s));break e}}a=c=mi(c,s),Ie!==4&&(Ie=2),ra===null?ra=[a]:ra.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var m=qg(a,c,e);Qh(a,m);break e;case 1:s=c;var v=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Un===null||!Un.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var g=Wg(a,s,e);Qh(a,g);break e}}a=a.return}while(a!==null)}dv(n)}catch(S){e=S,Ee===n&&n!==null&&(Ee=n=n.return);continue}break}while(!0)}function lv(){var t=ls.current;return ls.current=cs,t===null?cs:t}function Ed(){(Ie===0||Ie===3||Ie===2)&&(Ie=4),Ne===null||!(yr&268435455)&&!(zs&268435455)||Pn(Ne,Fe)}function hs(t,e){var n=Q;Q|=2;var r=lv();(Ne!==t||Fe!==e)&&(rn=null,dr(t,e));do try{dk();break}catch(i){cv(t,i)}while(!0);if(cd(),Q=n,ls.current=r,Ee!==null)throw Error(O(261));return Ne=null,Fe=0,Ie}function dk(){for(;Ee!==null;)uv(Ee)}function hk(){for(;Ee!==null&&!j1();)uv(Ee)}function uv(t){var e=pv(t.alternate,t,ct);t.memoizedProps=t.pendingProps,e===null?dv(t):Ee=e,wd.current=null}function dv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ak(n,e),n!==null){n.flags&=32767,Ee=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ie=6,Ee=null;return}}else if(n=ik(n,e,ct),n!==null){Ee=n;return}if(e=e.sibling,e!==null){Ee=e;return}Ee=e=t}while(e!==null);Ie===0&&(Ie=5)}function nr(t,e,n){var r=re,i=St.transition;try{St.transition=null,re=1,pk(t,e,n,r)}finally{St.transition=i,re=r}return null}function pk(t,e,n,r){do ri();while(On!==null);if(Q&6)throw Error(O(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(O(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(G1(t,a),t===Ne&&(Ee=Ne=null,Fe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||io||(io=!0,fv(Go,function(){return ri(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=St.transition,St.transition=null;var o=re;re=1;var s=Q;Q|=4,wd.current=null,sk(t,n),av(n,t),Ny(kl),Zo=!!yl,kl=yl=null,t.current=n,ck(n),U1(),Q=s,re=o,St.transition=a}else t.current=n;if(io&&(io=!1,On=t,ds=i),a=t.pendingLanes,a===0&&(Un=null),z1(n.stateNode),ot(t,Se()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(us)throw us=!1,t=Fl,Fl=null,t;return ds&1&&t.tag!==0&&ri(),a=t.pendingLanes,a&1?t===Bl?ia++:(ia=0,Bl=t):ia=0,Zn(),null}function ri(){if(On!==null){var t=qm(ds),e=St.transition,n=re;try{if(St.transition=null,re=16>t?16:t,On===null)var r=!1;else{if(t=On,On=null,ds=0,Q&6)throw Error(O(331));var i=Q;for(Q|=4,U=t.current;U!==null;){var a=U,o=a.child;if(U.flags&16){var s=a.deletions;if(s!==null){for(var c=0;c<s.length;c++){var l=s[c];for(U=l;U!==null;){var u=U;switch(u.tag){case 0:case 11:case 15:na(8,u,a)}var d=u.child;if(d!==null)d.return=u,U=d;else for(;U!==null;){u=U;var h=u.sibling,p=u.return;if(nv(u),u===l){U=null;break}if(h!==null){h.return=p,U=h;break}U=p}}}var f=a.alternate;if(f!==null){var b=f.child;if(b!==null){f.child=null;do{var x=b.sibling;b.sibling=null,b=x}while(b!==null)}}U=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,U=o;else e:for(;U!==null;){if(a=U,a.flags&2048)switch(a.tag){case 0:case 11:case 15:na(9,a,a.return)}var m=a.sibling;if(m!==null){m.return=a.return,U=m;break e}U=a.return}}var v=t.current;for(U=v;U!==null;){o=U;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,U=y;else e:for(o=v;U!==null;){if(s=U,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Bs(9,s)}}catch(S){ke(s,s.return,S)}if(s===o){U=null;break e}var g=s.sibling;if(g!==null){g.return=s.return,U=g;break e}U=s.return}}if(Q=i,Zn(),Jt&&typeof Jt.onPostCommitFiberRoot=="function")try{Jt.onPostCommitFiberRoot(Ms,t)}catch{}r=!0}return r}finally{re=n,St.transition=e}}return!1}function vp(t,e,n){e=mi(n,e),e=qg(t,e,1),t=jn(t,e,1),e=Qe(),t!==null&&(Ua(t,1,e),ot(t,e))}function ke(t,e,n){if(t.tag===3)vp(t,t,n);else for(;e!==null;){if(e.tag===3){vp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Un===null||!Un.has(r))){t=mi(n,t),t=Wg(e,t,1),e=jn(e,t,1),t=Qe(),e!==null&&(Ua(e,1,t),ot(e,t));break}}e=e.return}}function fk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Qe(),t.pingedLanes|=t.suspendedLanes&n,Ne===t&&(Fe&n)===n&&(Ie===4||Ie===3&&(Fe&130023424)===Fe&&500>Se()-Sd?dr(t,0):Cd|=n),ot(t,e)}function hv(t,e){e===0&&(t.mode&1?(e=Ka,Ka<<=1,!(Ka&130023424)&&(Ka=4194304)):e=1);var n=Qe();t=mn(t,e),t!==null&&(Ua(t,e,n),ot(t,n))}function mk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),hv(t,n)}function gk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(O(314))}r!==null&&r.delete(e),hv(t,n)}var pv;pv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||it.current)nt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return nt=!1,rk(t,e,n);nt=!!(t.flags&131072)}else nt=!1,he&&e.flags&1048576&&gg(e,ns,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;To(t,e),t=e.pendingProps;var i=di(e,We.current);ni(e,n),i=gd(null,e,r,t,i,n);var a=vd();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,at(r)?(a=!0,es(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,dd(e),i.updater=Fs,e.stateNode=i,i._reactInternals=e,Il(e,r,t,n),e=Ml(null,e,r,!0,a,n)):(e.tag=0,he&&a&&id(e),Ke(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(To(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=bk(r),t=Ot(r,t),i){case 0:e=Ol(null,e,r,t,n);break e;case 1:e=sp(null,e,r,t,n);break e;case 11:e=ap(null,e,r,t,n);break e;case 14:e=op(null,e,r,Ot(r.type,t),n);break e}throw Error(O(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),Ol(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),sp(t,e,r,i,n);case 3:e:{if(Zg(e),t===null)throw Error(O(387));r=e.pendingProps,a=e.memoizedState,i=a.element,Cg(t,e),as(e,r,null,n);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=mi(Error(O(423)),e),e=cp(t,e,r,n,i);break e}else if(r!==i){i=mi(Error(O(424)),e),e=cp(t,e,r,n,i);break e}else for(ut=An(e.stateNode.containerInfo.firstChild),ht=e,he=!0,Lt=null,n=kg(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hi(),r===i){e=gn(t,e,n);break e}Ke(t,e,r,n)}e=e.child}return e;case 5:return Sg(e),t===null&&El(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,o=i.children,wl(r,i)?o=null:a!==null&&wl(r,a)&&(e.flags|=32),Kg(t,e),Ke(t,e,o,n),e.child;case 6:return t===null&&El(e),null;case 13:return Qg(t,e,n);case 4:return hd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pi(e,null,r,n):Ke(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),ap(t,e,r,i,n);case 7:return Ke(t,e,e.pendingProps,n),e.child;case 8:return Ke(t,e,e.pendingProps.children,n),e.child;case 12:return Ke(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value,ce(rs,r._currentValue),r._currentValue=o,a!==null)if(Bt(a.value,o)){if(a.children===i.children&&!it.current){e=gn(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var s=a.dependencies;if(s!==null){o=a.child;for(var c=s.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=hn(-1,n&-n),c.tag=2;var l=a.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Pl(a.return,n,e),s.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(O(341));o.lanes|=n,s=o.alternate,s!==null&&(s.lanes|=n),Pl(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Ke(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ni(e,n),i=Tt(i),r=r(i),e.flags|=1,Ke(t,e,r,n),e.child;case 14:return r=e.type,i=Ot(r,e.pendingProps),i=Ot(r.type,i),op(t,e,r,i,n);case 15:return $g(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),To(t,e),e.tag=1,at(r)?(t=!0,es(e)):t=!1,ni(e,n),Hg(e,r,i),Il(e,r,i,n),Ml(null,e,r,!0,t,n);case 19:return Jg(t,e,n);case 22:return Gg(t,e,n)}throw Error(O(156,e.tag))};function fv(t,e){return Bm(t,e)}function vk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yt(t,e,n,r){return new vk(t,e,n,r)}function Pd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function bk(t){if(typeof t=="function")return Pd(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$u)return 11;if(t===Gu)return 14}return 2}function Bn(t,e){var n=t.alternate;return n===null?(n=yt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Po(t,e,n,r,i,a){var o=2;if(r=t,typeof t=="function")Pd(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ur:return hr(n.children,i,a,e);case Wu:o=8,i|=8;break;case Xc:return t=yt(12,n,e,i|2),t.elementType=Xc,t.lanes=a,t;case el:return t=yt(13,n,e,i),t.elementType=el,t.lanes=a,t;case tl:return t=yt(19,n,e,i),t.elementType=tl,t.lanes=a,t;case Sm:return Vs(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wm:o=10;break e;case Cm:o=9;break e;case $u:o=11;break e;case Gu:o=14;break e;case Tn:o=16,r=null;break e}throw Error(O(130,t==null?t:typeof t,""))}return e=yt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function hr(t,e,n,r){return t=yt(7,t,r,e),t.lanes=n,t}function Vs(t,e,n,r){return t=yt(22,t,r,e),t.elementType=Sm,t.lanes=n,t.stateNode={isHidden:!1},t}function Pc(t,e,n){return t=yt(6,t,null,e),t.lanes=n,t}function Rc(t,e,n){return e=yt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yk(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cc(0),this.expirationTimes=cc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Rd(t,e,n,r,i,a,o,s,c){return t=new yk(t,e,n,s,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=yt(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},dd(a),t}function kk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function mv(t){if(!t)return qn;t=t._reactInternals;e:{if(Er(t)!==t||t.tag!==1)throw Error(O(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(at(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(O(171))}if(t.tag===1){var n=t.type;if(at(n))return fg(t,n,e)}return e}function gv(t,e,n,r,i,a,o,s,c){return t=Rd(n,r,!0,t,i,a,o,s,c),t.context=mv(null),n=t.current,r=Qe(),i=Fn(n),a=hn(r,i),a.callback=e??null,jn(n,a,i),t.current.lanes=i,Ua(t,i,r),ot(t,r),t}function Hs(t,e,n,r){var i=e.current,a=Qe(),o=Fn(i);return n=mv(n),e.context===null?e.context=n:e.pendingContext=n,e=hn(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=jn(i,e,o),t!==null&&(Ft(t,i,o,a),wo(t,i,o)),o}function ps(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function bp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Id(t,e){bp(t,e),(t=t.alternate)&&bp(t,e)}function wk(){return null}var vv=typeof reportError=="function"?reportError:function(t){console.error(t)};function _d(t){this._internalRoot=t}qs.prototype.render=_d.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(O(409));Hs(t,e,null,null)};qs.prototype.unmount=_d.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;kr(function(){Hs(null,t,null,null)}),e[fn]=null}};function qs(t){this._internalRoot=t}qs.prototype.unstable_scheduleHydration=function(t){if(t){var e=Gm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<En.length&&e!==0&&e<En[n].priority;n++);En.splice(n,0,t),n===0&&Zm(t)}};function Od(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ws(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yp(){}function Ck(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var l=ps(o);a.call(l)}}var o=gv(e,r,t,0,null,!1,!1,"",yp);return t._reactRootContainer=o,t[fn]=o.current,Sa(t.nodeType===8?t.parentNode:t),kr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var l=ps(c);s.call(l)}}var c=Rd(t,0,!1,null,null,!1,!1,"",yp);return t._reactRootContainer=c,t[fn]=c.current,Sa(t.nodeType===8?t.parentNode:t),kr(function(){Hs(e,c,n,r)}),c}function $s(t,e,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var s=i;i=function(){var c=ps(o);s.call(c)}}Hs(e,o,t,i)}else o=Ck(n,e,t,i,r);return ps(o)}Wm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=$i(e.pendingLanes);n!==0&&(Qu(e,n|1),ot(e,Se()),!(Q&6)&&(gi=Se()+500,Zn()))}break;case 13:kr(function(){var r=mn(t,1);if(r!==null){var i=Qe();Ft(r,t,1,i)}}),Id(t,1)}};Ju=function(t){if(t.tag===13){var e=mn(t,134217728);if(e!==null){var n=Qe();Ft(e,t,134217728,n)}Id(t,134217728)}};$m=function(t){if(t.tag===13){var e=Fn(t),n=mn(t,e);if(n!==null){var r=Qe();Ft(n,t,e,r)}Id(t,e)}};Gm=function(){return re};Km=function(t,e){var n=re;try{return re=t,e()}finally{re=n}};dl=function(t,e,n){switch(e){case"input":if(il(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=As(r);if(!i)throw Error(O(90));xm(r),il(r,i)}}}break;case"textarea":Pm(t,n);break;case"select":e=n.value,e!=null&&Yr(t,!!n.multiple,e,!1)}};Lm=Td;Dm=kr;var Sk={usingClientEntryPoint:!1,Events:[Ba,Vr,As,Mm,Nm,Td]},Di={findFiberByHostInstance:or,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tk={bundleType:Di.bundleType,version:Di.version,rendererPackageName:Di.rendererPackageName,rendererConfig:Di.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Um(t),t===null?null:t.stateNode},findFiberByHostInstance:Di.findFiberByHostInstance||wk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ao=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ao.isDisabled&&ao.supportsFiber)try{Ms=ao.inject(Tk),Jt=ao}catch{}}ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sk;ft.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Od(e))throw Error(O(200));return kk(t,e,null,n)};ft.createRoot=function(t,e){if(!Od(t))throw Error(O(299));var n=!1,r="",i=vv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Rd(t,1,!1,null,null,n,!1,r,i),t[fn]=e.current,Sa(t.nodeType===8?t.parentNode:t),new _d(e)};ft.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(O(188)):(t=Object.keys(t).join(","),Error(O(268,t)));return t=Um(e),t=t===null?null:t.stateNode,t};ft.flushSync=function(t){return kr(t)};ft.hydrate=function(t,e,n){if(!Ws(e))throw Error(O(200));return $s(null,t,e,!0,n)};ft.hydrateRoot=function(t,e,n){if(!Od(t))throw Error(O(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=vv;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=gv(e,null,t,1,n??null,i,!1,a,o),t[fn]=e.current,Sa(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new qs(e)};ft.render=function(t,e,n){if(!Ws(e))throw Error(O(200));return $s(null,t,e,!1,n)};ft.unmountComponentAtNode=function(t){if(!Ws(t))throw Error(O(40));return t._reactRootContainer?(kr(function(){$s(null,null,t,!1,function(){t._reactRootContainer=null,t[fn]=null})}),!0):!1};ft.unstable_batchedUpdates=Td;ft.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ws(n))throw Error(O(200));if(t==null||t._reactInternals===void 0)throw Error(O(38));return $s(t,e,n,!1,r)};ft.version="18.3.1-next-f1338f8080-20240426";function bv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bv)}catch(t){console.error(t)}}bv(),vm.exports=ft;var xk=vm.exports,yv,kp=xk;yv=kp.createRoot,kp.hydrateRoot;var kv=function(t,e,n,r){var i;e[0]=0;for(var a=1;a<e.length;a++){var o=e[a++],s=e[a]?(e[0]|=o?1:2,n[e[a++]]):e[++a];o===3?r[0]=s:o===4?r[1]=Object.assign(r[1]||{},s):o===5?(r[1]=r[1]||{})[e[++a]]=s:o===6?r[1][e[++a]]+=s+"":o?(i=t.apply(s,kv(t,s,n,["",null])),r.push(i),s[0]?e[0]|=2:(e[a-2]=0,e[a]=i)):r.push(s)}return r},wp=new Map;function Ek(t){var e=wp.get(this);return e||(e=new Map,wp.set(this,e)),(e=kv(this,e.get(t)||(e.set(t,e=function(n){for(var r,i,a=1,o="",s="",c=[0],l=function(h){a===1&&(h||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?c.push(0,h,o):a===3&&(h||o)?(c.push(3,h,o),a=2):a===2&&o==="..."&&h?c.push(4,h,0):a===2&&o&&!h?c.push(5,0,!0,o):a>=5&&((o||!h&&a===5)&&(c.push(a,0,o,i),a=6),h&&(c.push(a,h,0,i),a=6)),o=""},u=0;u<n.length;u++){u&&(a===1&&l(),l(u));for(var d=0;d<n[u].length;d++)r=n[u][d],a===1?r==="<"?(l(),c=[c],a=3):o+=r:a===4?o==="--"&&r===">"?(a=1,o=""):o=r+o[0]:s?r===s?s="":o+=r:r==='"'||r==="'"?s=r:r===">"?(l(),a=1):a&&(r==="="?(a=5,i=o,o=""):r==="/"&&(a<5||n[u][d+1]===">")?(l(),a===3&&(c=c[0]),a=c,(c=c[0]).push(2,0,a),a=0):r===" "||r==="	"||r===`
`||r==="\r"?(l(),a=2):o+=r),a===3&&o==="!--"&&(a=4,c=c[0])}return l(),c}(t)),e),arguments,[])).length>1?e:e[0]}var je=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},Ge={searchParams:"URLSearchParams"in je,iterable:"Symbol"in je&&"iterator"in Symbol,blob:"FileReader"in je&&"Blob"in je&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in je,arrayBuffer:"ArrayBuffer"in je};function Pk(t){return t&&DataView.prototype.isPrototypeOf(t)}if(Ge.arrayBuffer)var Rk=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Ik=ArrayBuffer.isView||function(t){return t&&Rk.indexOf(Object.prototype.toString.call(t))>-1};function Ti(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function Md(t){return typeof t!="string"&&(t=String(t)),t}function Nd(t){var e={next:function(){var n=t.shift();return{done:n===void 0,value:n}}};return Ge.iterable&&(e[Symbol.iterator]=function(){return e}),e}function _e(t){this.map={},t instanceof _e?t.forEach(function(e,n){this.append(n,e)},this):Array.isArray(t)?t.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}_e.prototype.append=function(t,e){t=Ti(t),e=Md(e);var n=this.map[t];this.map[t]=n?n+", "+e:e};_e.prototype.delete=function(t){delete this.map[Ti(t)]};_e.prototype.get=function(t){return t=Ti(t),this.has(t)?this.map[t]:null};_e.prototype.has=function(t){return this.map.hasOwnProperty(Ti(t))};_e.prototype.set=function(t,e){this.map[Ti(t)]=Md(e)};_e.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)};_e.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),Nd(t)};_e.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),Nd(t)};_e.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),Nd(t)};Ge.iterable&&(_e.prototype[Symbol.iterator]=_e.prototype.entries);function Ic(t){if(!t._noBody){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}}function wv(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function _k(t){var e=new FileReader,n=wv(e);return e.readAsArrayBuffer(t),n}function Ok(t){var e=new FileReader,n=wv(e),r=/charset=([A-Za-z0-9_-]+)/.exec(t.type),i=r?r[1]:"utf-8";return e.readAsText(t,i),n}function Mk(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function Cp(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function Cv(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:Ge.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:Ge.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:Ge.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():Ge.arrayBuffer&&Ge.blob&&Pk(t)?(this._bodyArrayBuffer=Cp(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Ge.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||Ik(t))?this._bodyArrayBuffer=Cp(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Ge.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Ge.blob&&(this.blob=function(){var t=Ic(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=Ic(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(Ge.blob)return this.blob().then(_k);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var t=Ic(this);if(t)return t;if(this._bodyBlob)return Ok(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Mk(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Ge.formData&&(this.formData=function(){return this.text().then(Dk)}),this.json=function(){return this.text().then(JSON.parse)},this}var Nk=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Lk(t){var e=t.toUpperCase();return Nk.indexOf(e)>-1?e:t}function wr(t,e){if(!(this instanceof wr))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var n=e.body;if(t instanceof wr){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new _e(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!n&&t._bodyInit!=null&&(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new _e(e.headers)),this.method=Lk(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in je){var a=new AbortController;return a.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var i=/\?/;this.url+=(i.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}wr.prototype.clone=function(){return new wr(this,{body:this._bodyInit})};function Dk(t){var e=new FormData;return t.trim().split("&").forEach(function(n){if(n){var r=n.split("="),i=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(a))}}),e}function Ak(t){var e=new _e,n=t.replace(/\r?\n[\t ]+/g," ");return n.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var i=r.split(":"),a=i.shift().trim();if(a){var o=i.join(":").trim();try{e.append(a,o)}catch(s){console.warn("Response "+s.message)}}}),e}Cv.call(wr.prototype);function Xt(t,e){if(!(this instanceof Xt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new _e(e.headers),this.url=e.url||"",this._initBody(t)}Cv.call(Xt.prototype);Xt.prototype.clone=function(){return new Xt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _e(this.headers),url:this.url})};Xt.error=function(){var t=new Xt(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var jk=[301,302,303,307,308];Xt.redirect=function(t,e){if(jk.indexOf(e)===-1)throw new RangeError("Invalid status code");return new Xt(null,{status:e,headers:{location:t}})};var ar=je.DOMException;try{new ar}catch{ar=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},ar.prototype=Object.create(Error.prototype),ar.prototype.constructor=ar}function Sv(t,e){return new Promise(function(n,r){var i=new wr(t,e);if(i.signal&&i.signal.aborted)return r(new ar("Aborted","AbortError"));var a=new XMLHttpRequest;function o(){a.abort()}a.onload=function(){var l={statusText:a.statusText,headers:Ak(a.getAllResponseHeaders()||"")};i.url.indexOf("file://")===0&&(a.status<200||a.status>599)?l.status=200:l.status=a.status,l.url="responseURL"in a?a.responseURL:l.headers.get("X-Request-URL");var u="response"in a?a.response:a.responseText;setTimeout(function(){n(new Xt(u,l))},0)},a.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},a.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},a.onabort=function(){setTimeout(function(){r(new ar("Aborted","AbortError"))},0)};function s(l){try{return l===""&&je.location.href?je.location.href:l}catch{return l}}if(a.open(i.method,s(i.url),!0),i.credentials==="include"?a.withCredentials=!0:i.credentials==="omit"&&(a.withCredentials=!1),"responseType"in a&&(Ge.blob?a.responseType="blob":Ge.arrayBuffer&&(a.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof _e||je.Headers&&e.headers instanceof je.Headers)){var c=[];Object.getOwnPropertyNames(e.headers).forEach(function(l){c.push(Ti(l)),a.setRequestHeader(l,Md(e.headers[l]))}),i.headers.forEach(function(l,u){c.indexOf(u)===-1&&a.setRequestHeader(u,l)})}else i.headers.forEach(function(l,u){a.setRequestHeader(u,l)});i.signal&&(i.signal.addEventListener("abort",o),a.onreadystatechange=function(){a.readyState===4&&i.signal.removeEventListener("abort",o)}),a.send(typeof i._bodyInit>"u"?null:i._bodyInit)})}Sv.polyfill=!0;je.fetch||(je.fetch=Sv,je.Headers=_e,je.Request=wr,je.Response=Xt);var Uk=self.fetch.bind(self);const _c=am(Uk);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Hl=function(t,e){return Hl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Hl(t,e)};function Tv(t,e){Hl(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Fk(t){var e=typeof Symbol=="function"&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function Bk(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function zk(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Bk(arguments[e]));return t}var xv=function(){function t(e,n){this.target=n,this.type=e}return t}(),Vk=function(t){Tv(e,t);function e(n,r){var i=t.call(this,"error",r)||this;return i.message=n.message,i.error=n,i}return e}(xv),Hk=function(t){Tv(e,t);function e(n,r,i){n===void 0&&(n=1e3),r===void 0&&(r="");var a=t.call(this,"close",i)||this;return a.wasClean=!0,a.code=n,a.reason=r,a}return e}(xv);/*!
 * Reconnecting WebSocket
 * by Pedro Ladaria <pedro.ladaria@gmail.com>
 * https://github.com/pladaria/reconnecting-websocket
 * License MIT
 */var qk=function(){if(typeof WebSocket<"u")return WebSocket},Wk=function(t){return typeof t<"u"&&!!t&&t.CLOSING===2},er={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+Math.random()*4e3,minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},$k=function(){function t(e,n,r){var i=this;r===void 0&&(r={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(a){i._debug("open event");var o=i._options.minUptime,s=o===void 0?er.minUptime:o;clearTimeout(i._connectTimeout),i._uptimeTimeout=setTimeout(function(){return i._acceptOpen()},s),i._ws.binaryType=i._binaryType,i._messageQueue.forEach(function(c){return i._ws.send(c)}),i._messageQueue=[],i.onopen&&i.onopen(a),i._listeners.open.forEach(function(c){return i._callEventListener(a,c)})},this._handleMessage=function(a){i._debug("message event"),i.onmessage&&i.onmessage(a),i._listeners.message.forEach(function(o){return i._callEventListener(a,o)})},this._handleError=function(a){i._debug("error event",a.message),i._disconnect(void 0,a.message==="TIMEOUT"?"timeout":void 0),i.onerror&&i.onerror(a),i._debug("exec error listeners"),i._listeners.error.forEach(function(o){return i._callEventListener(a,o)}),i._connect()},this._handleClose=function(a){i._debug("close event"),i._clearTimeouts(),i._shouldReconnect&&i._connect(),i.onclose&&i.onclose(a),i._listeners.close.forEach(function(o){return i._callEventListener(a,o)})},this._url=e,this._protocols=n,this._options=r,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(t,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CONNECTING",{get:function(){return t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OPEN",{get:function(){return t.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSING",{get:function(){return t.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSED",{get:function(){return t.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferedAmount",{get:function(){var e=this._messageQueue.reduce(function(n,r){return typeof r=="string"?n+=r.length:r instanceof Blob?n+=r.size:n+=r.byteLength,n},0);return e+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?t.CLOSED:t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),t.prototype.close=function(e,n){if(e===void 0&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(e,n)},t.prototype.reconnect=function(e,n){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,!this._ws||this._ws.readyState===this.CLOSED?this._connect():(this._disconnect(e,n),this._connect())},t.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var n=this._options.maxEnqueuedMessages,r=n===void 0?er.maxEnqueuedMessages:n;this._messageQueue.length<r&&(this._debug("enqueue",e),this._messageQueue.push(e))}},t.prototype.addEventListener=function(e,n){this._listeners[e]&&this._listeners[e].push(n)},t.prototype.dispatchEvent=function(e){var n,r,i=this._listeners[e.type];if(i)try{for(var a=Fk(i),o=a.next();!o.done;o=a.next()){var s=o.value;this._callEventListener(e,s)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!0},t.prototype.removeEventListener=function(e,n){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(r){return r!==n}))},t.prototype._debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._options.debug&&console.log.apply(console,zk(["RWS>"],e))},t.prototype._getNextDelay=function(){var e=this._options,n=e.reconnectionDelayGrowFactor,r=n===void 0?er.reconnectionDelayGrowFactor:n,i=e.minReconnectionDelay,a=i===void 0?er.minReconnectionDelay:i,o=e.maxReconnectionDelay,s=o===void 0?er.maxReconnectionDelay:o,c=0;return this._retryCount>0&&(c=a*Math.pow(r,this._retryCount-1),c>s&&(c=s)),this._debug("next delay",c),c},t.prototype._wait=function(){var e=this;return new Promise(function(n){setTimeout(n,e._getNextDelay())})},t.prototype._getNextUrl=function(e){if(typeof e=="string")return Promise.resolve(e);if(typeof e=="function"){var n=e();if(typeof n=="string")return Promise.resolve(n);if(n.then)return n}throw Error("Invalid URL")},t.prototype._connect=function(){var e=this;if(!(this._connectLock||!this._shouldReconnect)){this._connectLock=!0;var n=this._options,r=n.maxRetries,i=r===void 0?er.maxRetries:r,a=n.connectionTimeout,o=a===void 0?er.connectionTimeout:a,s=n.WebSocket,c=s===void 0?qk():s;if(this._retryCount>=i){this._debug("max retries reached",this._retryCount,">=",i);return}if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!Wk(c))throw Error("No valid WebSocket class provided");this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(l){e._closeCalled||(e._debug("connect",{url:l,protocols:e._protocols}),e._ws=e._protocols?new c(l,e._protocols):new c(l),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},o))})}},t.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new Vk(Error("TIMEOUT"),this))},t.prototype._disconnect=function(e,n){if(e===void 0&&(e=1e3),this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(e,n),this._handleClose(new Hk(e,n,this))}catch{}}},t.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},t.prototype._callEventListener=function(e,n){"handleEvent"in n?n.handleEvent(e):n(e)},t.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},t.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},t.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},t}();function me(t){return t!=null&&typeof t=="object"&&t["@@functional/placeholder"]===!0}function lr(t){return function e(n){return arguments.length===0||me(n)?e:t.apply(this,arguments)}}function Or(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return me(n)?e:lr(function(i){return t(n,i)});default:return me(n)&&me(r)?e:me(n)?lr(function(i){return t(i,r)}):me(r)?lr(function(i){return t(n,i)}):t(n,r)}}}function Gk(t,e){t=t||[],e=e||[];var n,r=t.length,i=e.length,a=[];for(n=0;n<r;)a[a.length]=t[n],n+=1;for(n=0;n<i;)a[a.length]=e[n],n+=1;return a}function Kk(t){return function e(n,r,i){switch(arguments.length){case 0:return e;case 1:return me(n)?e:Or(function(a,o){return t(n,a,o)});case 2:return me(n)&&me(r)?e:me(n)?Or(function(a,o){return t(a,r,o)}):me(r)?Or(function(a,o){return t(n,a,o)}):lr(function(a){return t(n,r,a)});default:return me(n)&&me(r)&&me(i)?e:me(n)&&me(r)?Or(function(a,o){return t(a,o,i)}):me(n)&&me(i)?Or(function(a,o){return t(a,r,o)}):me(r)&&me(i)?Or(function(a,o){return t(n,a,o)}):me(n)?lr(function(a){return t(a,r,i)}):me(r)?lr(function(a){return t(n,a,i)}):me(i)?lr(function(a){return t(n,r,a)}):t(n,r,i)}}}var Sp=Kk(function(t,e,n){var r=n.length;if(t>=r||t<-r)return n;var i=(r+t)%r,a=Gk(n);return a[i]=e(n[i]),a});let oo;const Zk=new Uint8Array(16);function Qk(){if(!oo&&(oo=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!oo))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return oo(Zk)}const De=[];for(let t=0;t<256;++t)De.push((t+256).toString(16).slice(1));function Jk(t,e=0){return De[t[e+0]]+De[t[e+1]]+De[t[e+2]]+De[t[e+3]]+"-"+De[t[e+4]]+De[t[e+5]]+"-"+De[t[e+6]]+De[t[e+7]]+"-"+De[t[e+8]]+De[t[e+9]]+"-"+De[t[e+10]]+De[t[e+11]]+De[t[e+12]]+De[t[e+13]]+De[t[e+14]]+De[t[e+15]]}const Yk=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Tp={randomUUID:Yk};function xp(t,e,n){if(Tp.randomUUID&&!e&&!t)return Tp.randomUUID();t=t||{};const r=t.random||(t.rng||Qk)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Jk(r)}var Xk="@nlxai/chat-core",ew="1.0.5-alpha.0",tw="NLX Chat SDK core",nw="module",rw="lib/index.cjs",iw="lib/index.esm.js",aw="lib/index.umd.js",ow="lib/index.d.ts",sw={".":{types:"./lib/index.d.ts",import:"./lib/index.esm.js",require:"./lib/index.cjs"}},cw={build:"rm -rf lib && rollup -c --configPlugin typescript",docs:"rm -rf docs/ && typedoc && concat-md --decrease-title-levels --dir-name-as-title docs/ > docs/index.md","lint:check":"eslint src/ --ext .ts,.tsx,.js,.jsx --max-warnings 0",lint:"eslint src/ --ext .ts,.tsx,.js,.jsx --fix",prepublish:"npm run build","preview-docs":"npm run docs && comrak --unsafe --gfm -o docs/index.html docs/index.md && open docs/index.html","publish-docs":"npm run docs && mv docs/index.md ../website/src/content/headless-api-reference.md",test:"typedoc --emit none",tsc:"tsc"},lw="Peter Szerzo <peter@nlx.ai>",uw="MIT",dw={"@types/isomorphic-fetch":"^0.0.36","@types/node":"^22.10.1","@types/ramda":"0.29.1","@types/uuid":"^9.0.7","concat-md":"^0.5.1","eslint-config-nlx":"*",prettier:"^3.1.0","rollup-config-nlx":"*",typedoc:"^0.25.13","typedoc-plugin-markdown":"^3.17.1",typescript:"^5.5.4"},hw={"isomorphic-fetch":"^3.0.0",ramda:"^0.29.1","reconnecting-websocket":"^4.4.0",uuid:"^9.0.1"},pw={access:"public"},fw="52817ba637a5d33ccf2ab6b3efd7e446bec7b7f8",Oc={name:Xk,version:ew,description:tw,type:nw,main:rw,module:iw,browser:aw,types:ow,exports:sw,scripts:cw,author:lw,license:uw,devDependencies:dw,dependencies:hw,publishConfig:pw,gitHead:fw};const Mc=console,mw="NLX.Welcome",gw="We encountered an issue. Please try again soon.",Ev=t=>Array.isArray(t)?t:Object.entries(t).map(([e,n])=>({slotId:e,value:n})),Ep=t=>({...t,slots:t.slots!=null?Ev(t.slots):t.slots}),Pp=t=>t.responses,vw=t=>{try{return JSON.parse(t)}catch{return null}},bw=t=>(t.applicationUrl??t.botUrl??"").length>0;function yw(t){let e;const n=t.applicationUrl??t.botUrl??"";/[-|_][a-z]{2,}[-|_][A-Z]{2,}$/.test(n)&&Mc.warn("Since v1.0.0, the language code is no longer added at the end of the application URL. Please remove the modifier (e.g. '-en-US') from the URL, and specify it in the `languageCode` parameter instead.");const r=t.conversationId??xp();let i={responses:t.responses??[],languageCode:t.languageCode,userId:t.userId,conversationId:r};const a=()=>{var w;return`${n}${((w=t.experimental)==null?void 0:w.completeBotUrl)===!0?"":`-${i.languageCode}`}`},o=(w,T)=>{i={...i,...w},f.forEach(E=>{E(Pp(i),T)})},s=()=>{const w={type:"failure",receivedAt:new Date().getTime(),payload:{text:t.failureMessage??gw}};o({responses:[...i.responses,w]},w)},c=w=>{if((w==null?void 0:w.messages.length)>0){const T={type:"bot",receivedAt:new Date().getTime(),payload:{...w,messages:w.messages.map(E=>({nodeId:E.nodeId,messageId:E.messageId,text:E.text,choices:E.choices??[]}))}};o({responses:[...i.responses,T]},T),w.metadata.hasPendingDataRequest&&(m({poll:!0}),setTimeout(()=>{h({request:{structured:{poll:!0}}})},1500))}else Mc.warn("Invalid message structure, expected object with field 'messages'."),s()};let l,u=[],d=null;const h=async w=>{var T;if(l!=null){l(w,_=>{const M={type:"bot",receivedAt:new Date().getTime(),payload:_};o({responses:[...i.responses,M]},M)});return}const E={userId:i.userId,conversationId:i.conversationId,...w,languageCode:i.languageCode,channelType:(T=t.experimental)==null?void 0:T.channelType,environment:t.environment};if(p())(e==null?void 0:e.readyState)===1?e.send(JSON.stringify(E)):u=[...u,E];else try{const _=await _c(a(),{method:"POST",headers:{...t.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-sdk-version":Oc.version},body:JSON.stringify(E)});if(_.status>=400)throw new Error(`Responded with ${_.status}`);const M=await _.json();c(M)}catch(_){Mc.warn(_),s()}},p=()=>n.indexOf("wss://")===0;let f=[];const b=()=>{var w;const T=new URL(n);((w=t.experimental)==null?void 0:w.completeBotUrl)!==!0&&(T.searchParams.set("languageCode",i.languageCode),T.searchParams.set("channelKey",`${T.searchParams.get("channelKey")??""}-${i.languageCode}`)),T.searchParams.set("conversationId",i.conversationId),e=new $k(T.href),d=setInterval(()=>{},500),e.onmessage=function(E){typeof(E==null?void 0:E.data)=="string"&&c(vw(E.data))}},x=()=>{d!=null&&clearInterval(d),e!=null&&(e.onmessage=null,e.close(),e=void 0)};p()&&b();const m=(w,T)=>{const E={type:"user",receivedAt:new Date().getTime(),payload:{type:"structured",...Ep(w),context:T}};o({responses:[...i.responses,E]},E)},v=(w,T)=>{m({intentId:w},T),h({context:T,request:{structured:{intentId:w}}})},y=(w,T)=>{const E={type:"user",receivedAt:new Date().getTime(),payload:{type:"text",text:w,context:T}};o({responses:[...i.responses,E]},E),h({context:T,request:{unstructured:{text:w}}})},g=(w,T,E)=>{let _=[...i.responses];const M={type:"user",receivedAt:new Date().getTime(),payload:{type:"choice",choiceId:w}},F=(E==null?void 0:E.responseIndex)??-1,H=(E==null?void 0:E.messageIndex)??-1;F>-1&&H>-1&&(_=Sp(F,ee=>ee.type==="bot"?{...ee,payload:{...ee.payload,messages:Sp(H,G=>({...G,selectedChoiceId:w}),ee.payload.messages)}}:ee,_)),_=[..._,M],o({responses:_},M),h({context:T,request:{structured:{nodeId:E==null?void 0:E.nodeId,intentId:E==null?void 0:E.intentId,choiceId:w}}})},S=w=>{f=f.filter(T=>T!==w)};return{sendText:y,sendStructured:(w,T)=>{m(w,T),h({context:T,request:{structured:Ep(w)}})},sendSlots:(w,T)=>{m({slots:w},T),h({context:T,request:{structured:{slots:Ev(w)}}})},sendIntent:v,sendWelcomeIntent:w=>{v(mw,w)},sendChoice:g,currentConversationId:()=>i.conversationId,setLanguageCode:w=>{if(w===i.languageCode){console.warn("Attempted to set language code to the one already active.");return}p()&&(x(),b()),o({languageCode:w})},currentLanguageCode:()=>i.languageCode,getLiveKitCredentials:async()=>{const w=await _c(`${a()}/requestToken`,{method:"POST",headers:{...t.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":i.conversationId,"nlx-sdk-version":Oc.version},body:JSON.stringify({languageCode:i.languageCode,conversationId:i.conversationId,userId:i.userId,requestToken:!0})});if(w.status>=400)throw new Error(`Responded with ${w.status}`);const T=await w.json();if((T==null?void 0:T.url)==null)throw new Error("Invalid response");return T},terminateLiveKitCall:async()=>{const w=await _c(`${a()}/terminateVoice`,{method:"POST",headers:{...t.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":i.conversationId,"nlx-sdk-version":Oc.version},body:JSON.stringify({languageCode:i.languageCode,conversationId:i.conversationId,userId:i.userId})});if(w.status>=400)throw new Error(`Responded with ${w.status}`)},subscribe:w=>(f=[...f,w],w(Pp(i)),()=>{S(w)}),unsubscribe:S,unsubscribeAll:()=>{f=[]},reset:w=>{o({conversationId:xp(),responses:(w==null?void 0:w.clearResponses)===!0?[]:i.responses}),p()&&(x(),b())},destroy:()=>{f=[],p()&&x()},setBotRequestOverride:w=>{l=w}}}function Pv(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=Pv(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function ae(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=Pv(t))&&(r&&(r+=" "),r+=e);return r}function Ar(t){return t!=null&&typeof t=="object"&&t["@@functional/placeholder"]===!0}function aa(t){return function e(n){return arguments.length===0||Ar(n)?e:t.apply(this,arguments)}}function Rv(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return Ar(n)?e:aa(function(i){return t(n,i)});default:return Ar(n)&&Ar(r)?e:Ar(n)?aa(function(i){return t(i,r)}):Ar(r)?aa(function(i){return t(n,i)}):t(n,r)}}}const kw=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};function ww(t){return t!=null&&typeof t["@@transducer/step"]=="function"}function Cw(t,e,n){return function(){if(arguments.length===0)return n();var r=arguments[arguments.length-1];if(!kw(r)){for(var i=0;i<t.length;){if(typeof r[t[i]]=="function")return r[t[i]].apply(r,Array.prototype.slice.call(arguments,0,-1));i+=1}if(ww(r)){var a=e.apply(null,Array.prototype.slice.call(arguments,0,-1));return a(r)}}return n.apply(this,arguments)}}const Sw={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}};function Rp(t){for(var e=[],n;!(n=t.next()).done;)e.push(n.value);return e}function Ip(t,e,n){for(var r=0,i=n.length;r<i;){if(t(e,n[r]))return!0;r+=1}return!1}function Tw(t){var e=String(t).match(/^function (\w*)/);return e==null?"":e[1]}function fs(t,e){return Object.prototype.hasOwnProperty.call(e,t)}function xw(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}const Nc=typeof Object.is=="function"?Object.is:xw;var _p=Object.prototype.toString,Ew=function(){return _p.call(arguments)==="[object Arguments]"?function(t){return _p.call(t)==="[object Arguments]"}:function(t){return fs("callee",t)}}(),Pw=!{toString:null}.propertyIsEnumerable("toString"),Op=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Mp=function(){return arguments.propertyIsEnumerable("length")}(),Rw=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},Np=aa(typeof Object.keys=="function"&&!Mp?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(t){if(Object(t)!==t)return[];var e,n,r=[],i=Mp&&Ew(t);for(e in t)fs(e,t)&&(!i||e!=="length")&&(r[r.length]=e);if(Pw)for(n=Op.length-1;n>=0;)e=Op[n],fs(e,t)&&!Rw(r,e)&&(r[r.length]=e),n-=1;return r}),Lp=aa(function(t){return t===null?"Null":t===void 0?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function Dp(t,e,n,r){var i=Rp(t),a=Rp(e);function o(s,c){return Ld(s,c,n.slice(),r.slice())}return!Ip(function(s,c){return!Ip(o,c,s)},a,i)}function Ld(t,e,n,r){if(Nc(t,e))return!0;var i=Lp(t);if(i!==Lp(e))return!1;if(typeof t["fantasy-land/equals"]=="function"||typeof e["fantasy-land/equals"]=="function")return typeof t["fantasy-land/equals"]=="function"&&t["fantasy-land/equals"](e)&&typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](t);if(typeof t.equals=="function"||typeof e.equals=="function")return typeof t.equals=="function"&&t.equals(e)&&typeof e.equals=="function"&&e.equals(t);switch(i){case"Arguments":case"Array":case"Object":if(typeof t.constructor=="function"&&Tw(t.constructor)==="Promise")return t===e;break;case"Boolean":case"Number":case"String":if(!(typeof t==typeof e&&Nc(t.valueOf(),e.valueOf())))return!1;break;case"Date":if(!Nc(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(!(t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode))return!1;break}for(var a=n.length-1;a>=0;){if(n[a]===t)return r[a]===e;a-=1}switch(i){case"Map":return t.size!==e.size?!1:Dp(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size!==e.size?!1:Dp(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var o=Np(t);if(o.length!==Np(e).length)return!1;var s=n.concat([t]),c=r.concat([e]);for(a=o.length-1;a>=0;){var l=o[a];if(!(fs(l,e)&&Ld(e[l],t[l],s,c)))return!1;a-=1}return!0}var Iw=Rv(function(t,e){return Ld(t,e,[],[])}),_w=function(){function t(e,n){this.xf=n,this.f=e,this.idx=-1,this.lastIdx=-1}return t.prototype["@@transducer/init"]=Sw.init,t.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](e,this.lastIdx))},t.prototype["@@transducer/step"]=function(e,n){return this.idx+=1,this.f(n)&&(this.lastIdx=this.idx),e},t}();function Ow(t){return function(e){return new _w(t,e)}}var Ap=Rv(Cw([],Ow,function(t,e){for(var n=e.length-1;n>=0;){if(t(e[n]))return n;n-=1}return-1}));const q=t=>({width:t.size!=null?`${t.size}px`:"100%",height:t.size!=null?`${t.size}px`:"100%",className:t.className}),Mw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M11 21H10L11 14H7.5C6.92 14 6.93 13.68 7.12 13.34C7.31 13 7.17 13.26 7.19 13.22C8.48 10.94 10.42 7.54 13 3H14L13 10H16.5C16.99 10 17.06 10.33 16.97 10.51L16.9 10.66C12.96 17.55 11 21 11 21Z",fill:"currentColor"})}),Dd=t=>C.jsxs("svg",{viewBox:"0 0 24 24",...q(t),children:[C.jsx("path",{d:"M13.5562 5.34835C12.2796 6.62498 12.4866 8.90179 14.0186 10.4337C14.3377 10.7529 14.5571 11.134 14.6767 11.5383C14.8007 11.9572 14.8177 12.4011 14.7277 12.8268C14.6656 13.1203 14.5526 13.4051 14.3887 13.6672C14.3259 13.7677 14.2557 13.865 14.1778 13.9581C14.1279 14.018 14.0747 14.0761 14.0186 14.1322C13.3341 14.8166 12.3641 15.0421 11.4917 14.8092L11.4728 14.8042C9.38654 14.2543 7.32235 15.2129 6.85652 16.9516C6.5761 17.9979 5.50065 18.6188 4.45431 18.3385C3.40798 18.0581 2.787 16.9826 3.06729 15.9363C3.34209 14.9111 4.38012 14.2942 5.40615 14.5335L5.40666 14.5317C5.42748 14.5378 5.44842 14.5437 5.46962 14.5493C7.21342 15.0166 9.08173 13.699 9.64244 11.6062C9.64857 11.5835 9.65521 11.5608 9.66185 11.5383C9.7815 11.134 10.0009 10.7529 10.32 10.4337L10.332 10.4214C10.339 10.4142 10.346 10.407 10.3533 10.4C11.8549 8.86865 12.0496 6.61566 10.7824 5.34835C10.0163 4.58237 10.0163 3.34047 10.7824 2.57449C11.5483 1.8085 12.7903 1.8085 13.5562 2.57449C14.3066 3.32501 14.3218 4.53237 13.6016 5.30135L13.6029 5.30263C13.5872 5.3177 13.5716 5.33289 13.5562 5.34835Z",fill:"currentColor"}),C.jsx("path",{d:"M19.327 6.83185C20.0311 6.83185 20.6019 7.40264 20.6019 8.10675C20.6019 8.81087 20.0311 9.38166 19.327 9.38166C18.6229 9.38166 18.0521 8.81087 18.0521 8.10675C18.0521 7.40264 18.6229 6.83185 19.327 6.83185Z",fill:"currentColor"}),C.jsx("path",{d:"M21.3237 16.4754C21.3237 15.3741 20.4309 14.4813 19.3297 14.4813C18.2284 14.4813 17.3356 15.3741 17.3356 16.4754C17.3356 17.5767 18.2284 18.4695 19.3297 18.4695C20.4309 18.4695 21.3237 17.5767 21.3237 16.4754Z",fill:"currentColor"}),C.jsx("path",{d:"M12.1025 19.3194C12.8246 19.3194 13.4101 19.9195 13.4101 20.6597C13.4101 21.4 12.8246 22 12.1025 22C11.3804 22 10.7949 21.4 10.7949 20.6597C10.7949 19.9195 11.3804 19.3194 12.1025 19.3194Z",fill:"currentColor"}),C.jsx("path",{d:"M6.28367 8.13944C6.28367 7.41726 5.68363 6.83185 4.94339 6.83185C4.20314 6.83185 3.6031 7.41726 3.6031 8.13944C3.6031 8.86163 4.20314 9.44704 4.94339 9.44704C5.68363 9.44704 6.28367 8.86163 6.28367 8.13944Z",fill:"currentColor"})]}),Nw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M6 13C5.45 13 5 13.45 5 14C5 14.55 5.45 15 6 15C6.55 15 7 14.55 7 14C7 13.45 6.55 13 6 13ZM6 17C5.45 17 5 17.45 5 18C5 18.55 5.45 19 6 19C6.55 19 7 18.55 7 18C7 17.45 6.55 17 6 17ZM6 9C5.45 9 5 9.45 5 10C5 10.55 5.45 11 6 11C6.55 11 7 10.55 7 10C7 9.45 6.55 9 6 9ZM3 9.5C2.72 9.5 2.5 9.72 2.5 10C2.5 10.28 2.72 10.5 3 10.5C3.28 10.5 3.5 10.28 3.5 10C3.5 9.72 3.28 9.5 3 9.5ZM6 5C5.45 5 5 5.45 5 6C5 6.55 5.45 7 6 7C6.55 7 7 6.55 7 6C7 5.45 6.55 5 6 5ZM21 10.5C21.28 10.5 21.5 10.28 21.5 10C21.5 9.72 21.28 9.5 21 9.5C20.72 9.5 20.5 9.72 20.5 10C20.5 10.28 20.72 10.5 21 10.5ZM14 7C14.55 7 15 6.55 15 6C15 5.45 14.55 5 14 5C13.45 5 13 5.45 13 6C13 6.55 13.45 7 14 7ZM14 3.5C14.28 3.5 14.5 3.28 14.5 3C14.5 2.72 14.28 2.5 14 2.5C13.72 2.5 13.5 2.72 13.5 3C13.5 3.28 13.72 3.5 14 3.5ZM3 13.5C2.72 13.5 2.5 13.72 2.5 14C2.5 14.28 2.72 14.5 3 14.5C3.28 14.5 3.5 14.28 3.5 14C3.5 13.72 3.28 13.5 3 13.5ZM10 20.5C9.72 20.5 9.5 20.72 9.5 21C9.5 21.28 9.72 21.5 10 21.5C10.28 21.5 10.5 21.28 10.5 21C10.5 20.72 10.28 20.5 10 20.5ZM10 3.5C10.28 3.5 10.5 3.28 10.5 3C10.5 2.72 10.28 2.5 10 2.5C9.72 2.5 9.5 2.72 9.5 3C9.5 3.28 9.72 3.5 10 3.5ZM10 7C10.55 7 11 6.55 11 6C11 5.45 10.55 5 10 5C9.45 5 9 5.45 9 6C9 6.55 9.45 7 10 7ZM10 12.5C9.17 12.5 8.5 13.17 8.5 14C8.5 14.83 9.17 15.5 10 15.5C10.83 15.5 11.5 14.83 11.5 14C11.5 13.17 10.83 12.5 10 12.5ZM18 13C17.45 13 17 13.45 17 14C17 14.55 17.45 15 18 15C18.55 15 19 14.55 19 14C19 13.45 18.55 13 18 13ZM18 17C17.45 17 17 17.45 17 18C17 18.55 17.45 19 18 19C18.55 19 19 18.55 19 18C19 17.45 18.55 17 18 17ZM18 9C17.45 9 17 9.45 17 10C17 10.55 17.45 11 18 11C18.55 11 19 10.55 19 10C19 9.45 18.55 9 18 9ZM18 5C17.45 5 17 5.45 17 6C17 6.55 17.45 7 18 7C18.55 7 19 6.55 19 6C19 5.45 18.55 5 18 5ZM21 13.5C20.72 13.5 20.5 13.72 20.5 14C20.5 14.28 20.72 14.5 21 14.5C21.28 14.5 21.5 14.28 21.5 14C21.5 13.72 21.28 13.5 21 13.5ZM14 17C13.45 17 13 17.45 13 18C13 18.55 13.45 19 14 19C14.55 19 15 18.55 15 18C15 17.45 14.55 17 14 17ZM14 20.5C13.72 20.5 13.5 20.72 13.5 21C13.5 21.28 13.72 21.5 14 21.5C14.28 21.5 14.5 21.28 14.5 21C14.5 20.72 14.28 20.5 14 20.5ZM10 8.5C9.17 8.5 8.5 9.17 8.5 10C8.5 10.83 9.17 11.5 10 11.5C10.83 11.5 11.5 10.83 11.5 10C11.5 9.17 10.83 8.5 10 8.5ZM10 17C9.45 17 9 17.45 9 18C9 18.55 9.45 19 10 19C10.55 19 11 18.55 11 18C11 17.45 10.55 17 10 17ZM14 12.5C13.17 12.5 12.5 13.17 12.5 14C12.5 14.83 13.17 15.5 14 15.5C14.83 15.5 15.5 14.83 15.5 14C15.5 13.17 14.83 12.5 14 12.5ZM14 8.5C13.17 8.5 12.5 9.17 12.5 10C12.5 10.83 13.17 11.5 14 11.5C14.83 11.5 15.5 10.83 15.5 10C15.5 9.17 14.83 8.5 14 8.5Z",fill:"currentColor"})}),Lw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z",fill:"currentColor"})}),Dw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12 15.41L6 9.40997L7.41 7.99997L12 12.58L16.59 7.99997L18 9.40997L12 15.41Z",fill:"currentColor"})}),Aw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M7.59001 12L13.59 18L15 16.59L10.42 12L15 7.41002L13.59 6.00002L7.59001 12Z",fill:"currentColor"})}),jw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M15 12L9.00005 18L7.59005 16.59L12.17 12L7.59005 7.41002L9.00005 6.00002L15 12Z",fill:"currentColor"})}),Uw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12 8L6 14L7.41 15.41L12 10.83L16.59 15.41L18 14L12 8Z",fill:"currentColor"})}),Gs=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z",fill:"currentColor"})}),ql=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M18.5 16H7C4.79 16 3 14.21 3 12C3 9.79 4.79 8 7 8H19.5C20.88 8 22 9.12 22 10.5C22 11.88 20.88 13 19.5 13H9C8.45 13 8 12.55 8 12C8 11.45 8.45 11 9 11H18.5V9.5H9C7.62 9.5 6.5 10.62 6.5 12C6.5 13.38 7.62 14.5 9 14.5H19.5C21.71 14.5 23.5 12.71 23.5 10.5C23.5 8.29 21.71 6.5 19.5 6.5H7C3.96 6.5 1.5 8.96 1.5 12C1.5 15.04 3.96 17.5 7 17.5H18.5V16Z",fill:"currentColor"})}),Fw=t=>C.jsxs("svg",{viewBox:"0 0 24 24",...q(t),children:[C.jsx("path",{d:"M12 15.2C13.7673 15.2 15.2 13.7673 15.2 12C15.2 10.2327 13.7673 8.8 12 8.8C10.2327 8.8 8.8 10.2327 8.8 12C8.8 13.7673 10.2327 15.2 12 15.2Z",fill:"currentColor"}),C.jsx("path",{d:"M9 2L7.17 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4H16.83L15 2H9ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z",fill:"currentColor"})]}),Iv=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M8.99991 16.17L4.82991 12L3.40991 13.41L8.99991 19L20.9999 7L19.5899 5.59L8.99991 16.17Z",fill:"currentColor"})}),_v=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z",fill:"currentColor"})}),Bw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z",fill:"currentColor"})}),Ov=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3.01 4.9 3.01 6L3 20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM19 20H5V9H19V20Z",fill:"currentColor"})}),Mv=t=>C.jsxs("svg",{viewBox:"0 0 24 24",...q(t),children:[C.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 21C6.9 21 6 20.1 6 19V7H18V19C18 20.1 17.1 21 16 21H8ZM9.33337 9H8V19H9.33337V9ZM11.3334 9V19H12.6666V9H11.3334ZM16 19H14.6666V9H16V19Z",fill:"currentColor"}),C.jsx("path",{d:"M15.5 4H19V6H5V4H8.5L9.5 3H14.5L15.5 4Z",fill:"currentColor"})]}),Nv=t=>C.jsxs("svg",{viewBox:"0 0 24 24",...q(t),children:[C.jsx("path",{d:"M21 12.22C21 6.73 16.74 3 12 3C7.31 3 3 6.65 3 12.28C2.4 12.62 2 13.26 2 14V16C2 17.1 2.9 18 4 18H5V11.9C5 8.03 8.13 4.9 12 4.9C15.87 4.9 19 8.03 19 11.9V19H11V21H19C20.1 21 21 20.1 21 19V17.78C21.59 17.47 22 16.86 22 16.14V13.84C22 13.14 21.59 12.53 21 12.22Z",fill:"currentColor"}),C.jsx("path",{d:"M9 14C9.55228 14 10 13.5523 10 13C10 12.4477 9.55228 12 9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14Z",fill:"currentColor"}),C.jsx("path",{d:"M15 14C15.5523 14 16 13.5523 16 13C16 12.4477 15.5523 12 15 12C14.4477 12 14 12.4477 14 13C14 13.5523 14.4477 14 15 14Z",fill:"currentColor"}),C.jsx("path",{d:"M18 11.03C17.52 8.18 15.04 6 12.05 6C9.02 6 5.76 8.51 6.02 12.45C8.49 11.44 10.35 9.24 10.88 6.56C12.19 9.19 14.88 11 18 11.03Z",fill:"currentColor"})]}),Wl=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z",fill:"currentColor"})}),zw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M7 14H5V19H10V17H7V14ZM5 10H7V7H10V5H5V10ZM17 17H14V19H19V14H17V17ZM14 5V7H17V10H19V5H14Z",fill:"currentColor"})}),Lv=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12 15C13.66 15 14.99 13.66 14.99 12L15 6C15 4.34 13.66 3 12 3C10.34 3 9 4.34 9 6V12C9 13.66 10.34 15 12 15ZM17.3 12C17.3 15 14.76 17.1 12 17.1C9.24 17.1 6.7 15 6.7 12H5C5 15.42 7.72 18.23 11 18.72V22H13V18.72C16.28 18.24 19 15.42 19 12H17.3Z",fill:"currentColor"})}),Dv=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"currentColor"})}),Vw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})}),Hw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M3 9.99999V14C3 14.55 3.45 15 4 15H7L10.29 18.29C10.92 18.92 12 18.47 12 17.58V6.40999C12 5.51999 10.92 5.06999 10.29 5.69999L7 8.99999H4C3.45 8.99999 3 9.44999 3 9.99999ZM16.5 12C16.5 10.23 15.48 8.70999 14 7.96999V16.02C15.48 15.29 16.5 13.77 16.5 12ZM14 4.44999V4.64999C14 5.02999 14.25 5.35999 14.6 5.49999C17.18 6.52999 19 9.05999 19 12C19 14.94 17.18 17.47 14.6 18.5C14.24 18.64 14 18.97 14 19.35V19.55C14 20.18 14.63 20.62 15.21 20.4C18.6 19.11 21 15.84 21 12C21 8.15999 18.6 4.88999 15.21 3.59999C14.63 3.36999 14 3.81999 14 4.44999Z",fill:"currentColor"})}),qw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M16.5 12C16.5 10.23 15.48 8.71 14 7.97V10.18L16.45 12.63C16.48 12.43 16.5 12.22 16.5 12ZM19 12C19 12.94 18.8 13.82 18.46 14.64L19.97 16.15C20.63 14.91 21 13.5 21 12C21 7.72 18.01 4.14 14 3.23V5.29C16.89 6.15 19 8.83 19 12ZM4.27 3L3 4.27L7.73 9H3V15H7L12 20V13.27L16.25 17.52C15.58 18.04 14.83 18.45 14 18.7V20.76C15.38 20.45 16.63 19.81 17.69 18.95L19.73 21L21 19.73L12 10.73L4.27 3ZM12 4L9.91 6.09L12 8.18V4Z",fill:"currentColor"})}),Ww=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12.87 15.07L10.33 12.56L10.36 12.53C12.1 10.59 13.34 8.36 14.07 6H17V4H10V2H8V4H1V5.99H12.17C11.5 7.92 10.44 9.75 9 11.35C8.07 10.32 7.3 9.19 6.69 8H4.69C5.42 9.63 6.42 11.17 7.67 12.56L2.58 17.58L4 19L9 14L12.11 17.11L12.87 15.07ZM18.5 10H16.5L12 22H14L15.12 19H19.87L21 22H23L18.5 10ZM15.88 17L17.5 12.67L19.12 17H15.88Z",fill:"currentColor"})}),$w=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M19 19H5V5H12V3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V12H19V19ZM14 3V5H17.59L7.76 14.83L9.17 16.24L19 6.41V10H21V3H14Z",fill:"currentColor"})}),Gw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M8 5V19L19 12L8 5Z",fill:"currentColor"})}),Kw=t=>C.jsxs("svg",{viewBox:"0 0 24 24",...q(t),children:[C.jsx("path",{d:"M13 14.5C13 15.3284 12.3284 16 11.5 16C10.6716 16 10 15.3284 10 14.5C10 13.6716 10.6716 13 11.5 13C12.3284 13 13 13.6716 13 14.5Z",fill:"currentColor"}),C.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 2H14L20 8V20C20 21.1 19.1 22 18 22H5.99C4.89 22 4 21.1 4 20V4C4 2.9 4.9 2 6 2ZM13.16 17.57L15.04 19.45L16.45 18.04L14.57 16.16C15.29 14.83 15.1 13.15 13.98 12.03C12.61 10.66 10.4 10.66 9.03 12.03C7.66 13.4 7.66 15.61 9.03 16.98C10.15 18.1 11.83 18.28 13.16 17.57ZM13 3.5V9H18.5L13 3.5Z",fill:"currentColor"})]}),Zw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M3 15H21V13H3V15ZM3 19H21V17H3V19ZM3 11H21V9H3V11ZM3 5V7H21V5H3Z",fill:"currentColor"})}),Av=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M10 3C14.97 3 19 7.03 19 12H22L18.11 15.89L18.04 16.03L14 12H17C17 8.13 13.87 5 10 5C6.13 5 3 8.13 3 12C3 15.87 6.13 19 10 19V21C5.03 21 1 16.97 1 12C1 7.03 5.03 3 10 3Z",fill:"currentColor"})}),jv=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M19.1064 12.9302C19.1459 12.6333 19.1657 12.3266 19.1657 12C19.1657 11.6833 19.1459 11.3667 19.0965 11.0698L21.1053 9.50625C21.2834 9.36771 21.3329 9.10052 21.2241 8.9026L19.3241 5.61719C19.2053 5.39948 18.9579 5.33021 18.7402 5.39948L16.3751 6.34948C15.8803 5.97344 15.3558 5.65677 14.772 5.41927L14.4157 2.90573C14.3761 2.66823 14.1782 2.5 13.9407 2.5H10.1407C9.90323 2.5 9.71521 2.66823 9.67563 2.90573L9.31938 5.41927C8.73552 5.65677 8.20115 5.98333 7.71625 6.34948L5.35115 5.39948C5.13344 5.32031 4.88604 5.39948 4.7673 5.61719L2.87719 8.9026C2.75844 9.11042 2.79802 9.36771 2.99594 9.50625L5.00479 11.0698C4.95532 11.3667 4.91573 11.6932 4.91573 12C4.91573 12.3068 4.93552 12.6333 4.985 12.9302L2.97615 14.4938C2.79802 14.6323 2.74855 14.8995 2.8574 15.0974L4.7574 18.3828C4.87615 18.6005 5.12354 18.6698 5.34125 18.6005L7.70636 17.6505C8.20115 18.0266 8.72563 18.3432 9.30948 18.5807L9.66573 21.0943C9.71521 21.3318 9.90323 21.5 10.1407 21.5H13.9407C14.1782 21.5 14.3761 21.3318 14.4058 21.0943L14.7621 18.5807C15.3459 18.3432 15.8803 18.0266 16.3652 17.6505L18.7303 18.6005C18.948 18.6797 19.1954 18.6005 19.3142 18.3828L21.2142 15.0974C21.3329 14.8797 21.2834 14.6323 21.0954 14.4938L19.1064 12.9302ZM12.0407 15.5625C10.0814 15.5625 8.47823 13.9594 8.47823 12C8.47823 10.0406 10.0814 8.4375 12.0407 8.4375C14.0001 8.4375 15.6032 10.0406 15.6032 12C15.6032 13.9594 14.0001 15.5625 12.0407 15.5625Z",fill:"currentColor"})}),Qw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z",fill:"currentColor"})}),Jw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),Uv=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M1 21H23L12 2L1 21ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z",fill:"currentColor"})}),Yw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M15 3H6C5.17 3 4.46 3.5 4.16 4.22L1.14 11.27C1.05 11.5 1 11.74 1 12V14C1 15.1 1.9 16 3 16H9.31L8.36 20.57L8.33 20.89C8.33 21.3 8.5 21.68 8.77 21.95L9.83 23L16.42 16.41C16.78 16.05 17 15.55 17 15V5C17 3.9 16.1 3 15 3ZM19 3V15H23V3H19Z",fill:"currentColor"})}),Xw=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M1 21H5V9H1V21ZM23 10C23 8.9 22.1 8 21 8H14.69L15.64 3.43L15.67 3.11C15.67 2.7 15.5 2.32 15.23 2.05L14.17 1L7.59 7.59C7.22 7.95 7 8.45 7 9V19C7 20.1 7.9 21 9 21H18C18.83 21 19.54 20.5 19.84 19.78L22.86 12.73C22.95 12.5 23 12.26 23 12V10Z",fill:"currentColor"})}),eC=t=>C.jsxs("svg",{viewBox:"0 0 24 24",...q(t),children:[C.jsx("path",{d:"M11 7H12.5V12.25L17 14.92L16.25 16.15L11 13V7Z",fill:"currentColor"}),C.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47997 6.47 1.99997 11.99 1.99997C17.52 1.99997 22 6.47997 22 12C22 17.52 17.52 22 11.99 22C6.47 22 2 17.52 2 12ZM4 12C4 16.42 7.58 20 12 20C16.42 20 20 16.42 20 12C20 7.57997 16.42 3.99997 12 3.99997C7.58 3.99997 4 7.57997 4 12Z",fill:"currentColor"})]}),Fv=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M13 3C8.03 3 4 7.03 4 12H1L4.89 15.89L4.96 16.03L9 12H6C6 8.13 9.13 5 13 5C16.87 5 20 8.13 20 12C20 15.87 16.87 19 13 19V21C17.97 21 22 16.97 22 12C22 7.03 17.97 3 13 3Z",fill:"currentColor"})}),tC=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M12 4V1L8 5L12 9V6C15.31 6 18 8.69 18 12C18 13.01 17.75 13.97 17.3 14.8L18.76 16.26C19.54 15.03 20 13.57 20 12C20 7.58 16.42 4 12 4ZM12 18C8.69 18 6 15.31 6 12C6 10.99 6.25 10.03 6.7 9.2L5.24 7.74C4.46 8.97 4 10.43 4 12C4 16.42 7.58 20 12 20V23L16 19L12 15V18Z",fill:"currentColor"})}),nC=t=>C.jsx("svg",{viewBox:"0 0 24 24",...q(t),children:C.jsx("path",{d:"M11 18H13V16H11V18ZM12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 12 11 11.75 11 15H13C13 12.75 16 12.5 16 10C16 7.79 14.21 6 12 6Z",fill:"currentColor"})}),rC=Object.freeze(Object.defineProperty({__proto__:null,Action:Mw,Add:Lw,ArrowDown:Dw,ArrowForward:Gs,ArrowLeft:Aw,ArrowRight:jw,ArrowUp:Uw,Assistant:Dd,AssistantOld:Nw,Attachment:ql,Camera:Fw,Check:Iv,Close:_v,Copy:Bw,Date:Ov,Delete:Mv,Error:Wl,Escalate:Nv,FullScreen:zw,Help:nC,Location:Vw,Mic:Lv,MicOff:Dv,OpenInNew:$w,Play:Gw,Preview:Kw,Refresh:tC,Reorder:Zw,Restart:Av,Search:Qw,Settings:jv,Share:Jw,ThumbDown:Yw,ThumbUp:Xw,Time:eC,Translate:Ww,Undo:Fv,Volume:Hw,VolumeOff:qw,Warning:Uv},Symbol.toStringTag,{value:"Module"})),iC=t=>C.jsxs("button",{className:ae("p-3 w-fit bg-background text-primary-80 rounded-outer","after:content-[''] after:rounded-outer after:absolute after:inset-0 after:pointer-events-none","hover:after:bg-primary-10",t.className),disabled:t.onClick==null,onClick:t.onClick,children:[C.jsx("span",{className:"block flex-none w-8 h-8",children:t.iconUrl==null?C.jsx(Dd,{}):C.jsx("img",{src:t.iconUrl,className:"w-8 h-8"})}),t.showLabel??!1?C.jsx("span",{children:t.label}):null]}),aC="bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40",oC="bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20",sC="bg-accent text-secondary-80 enabled:hover:before:bg-primary-40 focus:before:bg-primary-40 enabled:active:before:bg-secondary-10 disabled:bg-accent-20",cC="bg-secondary-60 backdrop-blur text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",lC="bg-background backdrop-blur text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",uC="bg-error-primary text-secondary-80",dn=({onClick:t,type:e,label:n,className:r,Icon:i})=>{const a=t==null;return C.jsx("button",{onClick:a?void 0:t,disabled:a,"aria-label":n,className:ae("p-3 w-10 h-10 transition-colors rounded-inner relative z-10 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent focus:outline-0",e==="main"?aC:null,e==="ghost"?oC:null,e==="activated"?sC:null,e==="coverup"?cC:null,e==="overlay"?lC:null,e==="error"?uC:null,r),children:C.jsx(i,{})})},dC=typeof globalThis<"u"&&typeof navigator<"u"&&typeof document<"u",vi=new Map,Bv=t=>{const e=matchMedia(t),n=new Set,r=()=>{for(const i of n)i(e.matches)};return e.addEventListener("change",r,{passive:!0}),{mql:e,dispatchers:n,listener:r}},hC=(t,e)=>{let n=vi.get(t);n||(n=Bv(t),vi.set(t,n)),n.dispatchers.add(e),e(n.mql.matches)},pC=(t,e)=>{const n=vi.get(t);if(n){const{mql:r,dispatchers:i,listener:a}=n;i.delete(e),i.size===0&&(vi.delete(t),r.removeEventListener?r.removeEventListener("change",a):r.removeListener(a))}};function fC(t,e={}){let{initializeWithValue:n=!0}=e;dC||(n=!1);const[r,i]=B.useState(()=>{if(n){let a=vi.get(t);return a||(a=Bv(t),vi.set(t,a)),a.mql.matches}});return B.useEffect(()=>(hC(t,i),()=>{pC(t,i)}),[t]),r}const zv=t=>fC("(min-width: 768px)"),mC=({windowSize:t,renderCollapse:e,collapse:n,toggleSettings:r,isSettingsOpen:i,brandIcon:a,reset:o,enabled:s})=>{const c=t==="half",l=zv(),u=c&&l?"overlay":"ghost";return C.jsxs("div",{className:ae("flex","p-2 md:p-3 items-center justify-between gap-2",{"md:absolute md:w-fit md:flex-col md:left-0 md:-translate-x-full":t==="half","md:absolute md:left-0 md:right-0 md:top-0":t==="full"}),children:[a!=null?C.jsx("img",{className:"w-10 h-10 block",src:a,role:"presentation"}):null,C.jsx(dn,{label:"Reset",type:u,className:a==null?"":"ml-auto",onClick:s?()=>{o()}:void 0,Icon:Fv}),r!=null?C.jsx(dn,{className:a!=null?"":"ml-auto",Icon:jv,label:"Settings",type:i?"activated":u,onClick:s?r:void 0}):null,e?C.jsx(dn,{label:"Collapse",type:u,className:ae(r==null?"ml-auto":"",c?"md:-order-1":""),onClick:s?()=>{n(new Event("collapse"))}:void 0,Icon:_v}):null]})},ms=({onClick:t,label:e,type:n="ghost",Icon:r,className:i})=>C.jsxs("button",{onClick:t,disabled:t==null,className:ae("relative z-10 w-full px-5 py-4 transition-colors rounded-outer flex justify-between items-center focus:outline-0 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",{"bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40":n==="main","bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-5 focus:before:bg-primary-5 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20":n==="ghost"},i),children:[e,C.jsx(r,{size:16})]}),gC=({onClose:t,handler:e,className:n})=>C.jsxs("div",{className:ae("p-2 md:p-3 flex flex-col flex-grow justify-center gap-2",n),children:[C.jsx(ms,{label:"Restart conversation",Icon:Av,type:"ghost",onClick:()=>{e.reset({clearResponses:!0}),e.sendWelcomeIntent(),t()}}),C.jsx(ms,{label:"Talk to an agent",Icon:Nv,type:"ghost",onClick:()=>{e.sendIntent("NLX.Escalation"),t()}})]});function Ad(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Pr=Ad();function Vv(t){Pr=t}const oa={exec:()=>null};function oe(t,e=""){let n=typeof t=="string"?t:t.source;const r={replace:(i,a)=>{let o=typeof a=="string"?a:a.source;return o=o.replace(Ze.caret,"$1"),n=n.replace(i,o),r},getRegex:()=>new RegExp(n,e)};return r}const Ze={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},vC=/^(?:[ \t]*(?:\n|$))+/,bC=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,yC=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Va=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,kC=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Hv=/(?:[*+-]|\d{1,9}[.)])/,qv=oe(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Hv).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),jd=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,wC=/^[^\n]+/,Ud=/(?!\s*\])(?:\\.|[^\[\]\\])+/,CC=oe(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Ud).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),SC=oe(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Hv).getRegex(),Ks="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Fd=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,TC=oe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Fd).replace("tag",Ks).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Wv=oe(jd).replace("hr",Va).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ks).getRegex(),xC=oe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Wv).getRegex(),Bd={blockquote:xC,code:bC,def:CC,fences:yC,heading:kC,hr:Va,html:TC,lheading:qv,list:SC,newline:vC,paragraph:Wv,table:oa,text:wC},jp=oe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Va).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ks).getRegex(),EC={...Bd,table:jp,paragraph:oe(jd).replace("hr",Va).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",jp).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ks).getRegex()},PC={...Bd,html:oe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Fd).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:oa,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:oe(jd).replace("hr",Va).replace("heading",` *#{1,6} *[^
]`).replace("lheading",qv).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},RC=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,IC=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,$v=/^( {2,}|\\)\n(?!\s*$)/,_C=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Zs=/[\p{P}\p{S}]/u,zd=/[\s\p{P}\p{S}]/u,Gv=/[^\s\p{P}\p{S}]/u,OC=oe(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,zd).getRegex(),MC=/(?!~)[\p{P}\p{S}]/u,NC=/(?!~)[\s\p{P}\p{S}]/u,LC=/(?:[^\s\p{P}\p{S}]|~)/u,DC=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,AC=oe(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,Zs).getRegex(),Kv="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",jC=oe(Kv,"gu").replace(/notPunctSpace/g,Gv).replace(/punctSpace/g,zd).replace(/punct/g,Zs).getRegex(),UC=oe(Kv,"gu").replace(/notPunctSpace/g,LC).replace(/punctSpace/g,NC).replace(/punct/g,MC).getRegex(),FC=oe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Gv).replace(/punctSpace/g,zd).replace(/punct/g,Zs).getRegex(),BC=oe(/\\(punct)/,"gu").replace(/punct/g,Zs).getRegex(),zC=oe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),VC=oe(Fd).replace("(?:-->|$)","-->").getRegex(),HC=oe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",VC).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),gs=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,qC=oe(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",gs).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Zv=oe(/^!?\[(label)\]\[(ref)\]/).replace("label",gs).replace("ref",Ud).getRegex(),Qv=oe(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ud).getRegex(),WC=oe("reflink|nolink(?!\\()","g").replace("reflink",Zv).replace("nolink",Qv).getRegex(),Vd={_backpedal:oa,anyPunctuation:BC,autolink:zC,blockSkip:DC,br:$v,code:IC,del:oa,emStrongLDelim:AC,emStrongRDelimAst:jC,emStrongRDelimUnd:FC,escape:RC,link:qC,nolink:Qv,punctuation:OC,reflink:Zv,reflinkSearch:WC,tag:HC,text:_C,url:oa},$C={...Vd,link:oe(/^!?\[(label)\]\((.*?)\)/).replace("label",gs).getRegex(),reflink:oe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",gs).getRegex()},$l={...Vd,emStrongRDelimAst:UC,url:oe(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},GC={...$l,br:oe($v).replace("{2,}","*").getRegex(),text:oe($l.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},so={normal:Bd,gfm:EC,pedantic:PC},Ai={normal:Vd,gfm:$l,breaks:GC,pedantic:$C},KC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Up=t=>KC[t];function Wt(t,e){if(e){if(Ze.escapeTest.test(t))return t.replace(Ze.escapeReplace,Up)}else if(Ze.escapeTestNoEncode.test(t))return t.replace(Ze.escapeReplaceNoEncode,Up);return t}function Fp(t){try{t=encodeURI(t).replace(Ze.percentDecode,"%")}catch{return null}return t}function Bp(t,e){var n;const r=t.replace(Ze.findPipe,(o,s,c)=>{let l=!1,u=s;for(;--u>=0&&c[u]==="\\";)l=!l;return l?"|":" |"}),i=r.split(Ze.splitPipe);let a=0;if(i[0].trim()||i.shift(),i.length>0&&!((n=i.at(-1))!=null&&n.trim())&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;a<i.length;a++)i[a]=i[a].trim().replace(Ze.slashPipe,"|");return i}function ji(t,e,n){const r=t.length;if(r===0)return"";let i=0;for(;i<r&&t.charAt(r-i-1)===e&&!n;)i++;return t.slice(0,r-i)}function ZC(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return-1}function zp(t,e,n,r,i){const a=e.href,o=e.title||null,s=t[1].replace(i.other.outputLinkReplace,"$1");if(t[0].charAt(0)!=="!"){r.state.inLink=!0;const c={type:"link",raw:n,href:a,title:o,text:s,tokens:r.inlineTokens(s)};return r.state.inLink=!1,c}return{type:"image",raw:n,href:a,title:o,text:s}}function QC(t,e,n){const r=t.match(n.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(a=>{const o=a.match(n.other.beginningSpace);if(o===null)return a;const[s]=o;return s.length>=i.length?a.slice(i.length):a}).join(`
`)}class vs{constructor(e){X(this,"options"),X(this,"rules"),X(this,"lexer"),this.options=e||Pr}space(e){const n=this.rules.block.newline.exec(e);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(e){const n=this.rules.block.code.exec(e);if(n){const r=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:ji(r,`
`)}}}fences(e){const n=this.rules.block.fences.exec(e);if(n){const r=n[0],i=QC(r,n[3]||"",this.rules);return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:i}}}heading(e){const n=this.rules.block.heading.exec(e);if(n){let r=n[2].trim();if(this.rules.other.endingHash.test(r)){const i=ji(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const n=this.rules.block.hr.exec(e);if(n)return{type:"hr",raw:ji(n[0],`
`)}}blockquote(e){const n=this.rules.block.blockquote.exec(e);if(n){let r=ji(n[0],`
`).split(`
`),i="",a="";const o=[];for(;r.length>0;){let s=!1;const c=[];let l;for(l=0;l<r.length;l++)if(this.rules.other.blockquoteStart.test(r[l]))c.push(r[l]),s=!0;else if(!s)c.push(r[l]);else break;r=r.slice(l);const u=c.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,a=a?`${a}
${d}`:d;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=h,r.length===0)break;const p=o.at(-1);if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const f=p,b=f.raw+`
`+r.join(`
`),x=this.blockquote(b);o[o.length-1]=x,i=i.substring(0,i.length-f.raw.length)+x.raw,a=a.substring(0,a.length-f.text.length)+x.text;break}else if((p==null?void 0:p.type)==="list"){const f=p,b=f.raw+`
`+r.join(`
`),x=this.list(b);o[o.length-1]=x,i=i.substring(0,i.length-p.raw.length)+x.raw,a=a.substring(0,a.length-f.raw.length)+x.raw,r=b.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:o,text:a}}}list(e){let n=this.rules.block.list.exec(e);if(n){let r=n[1].trim();const i=r.length>1,a={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=this.rules.other.listItemRegex(r);let s=!1;for(;e;){let l=!1,u="",d="";if(!(n=o.exec(e))||this.rules.block.hr.test(e))break;u=n[0],e=e.substring(u.length);let h=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,v=>" ".repeat(3*v.length)),p=e.split(`
`,1)[0],f=!h.trim(),b=0;if(this.options.pedantic?(b=2,d=h.trimStart()):f?b=n[1].length+1:(b=n[2].search(this.rules.other.nonSpaceChar),b=b>4?1:b,d=h.slice(b),b+=n[1].length),f&&this.rules.other.blankLine.test(p)&&(u+=p+`
`,e=e.substring(p.length+1),l=!0),!l){const v=this.rules.other.nextBulletRegex(b),y=this.rules.other.hrRegex(b),g=this.rules.other.fencesBeginRegex(b),S=this.rules.other.headingBeginRegex(b),w=this.rules.other.htmlBeginRegex(b);for(;e;){const T=e.split(`
`,1)[0];let E;if(p=T,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),E=p):E=p.replace(this.rules.other.tabCharGlobal,"    "),g.test(p)||S.test(p)||w.test(p)||v.test(p)||y.test(p))break;if(E.search(this.rules.other.nonSpaceChar)>=b||!p.trim())d+=`
`+E.slice(b);else{if(f||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||g.test(h)||S.test(h)||y.test(h))break;d+=`
`+p}!f&&!p.trim()&&(f=!0),u+=T+`
`,e=e.substring(T.length+1),h=E.slice(b)}}a.loose||(s?a.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(s=!0));let x=null,m;this.options.gfm&&(x=this.rules.other.listIsTask.exec(d),x&&(m=x[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),a.items.push({type:"list_item",raw:u,task:!!x,checked:m,loose:!1,text:d,tokens:[]}),a.raw+=u}const c=a.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let l=0;l<a.items.length;l++)if(this.lexer.state.top=!1,a.items[l].tokens=this.lexer.blockTokens(a.items[l].text,[]),!a.loose){const u=a.items[l].tokens.filter(h=>h.type==="space"),d=u.length>0&&u.some(h=>this.rules.other.anyLine.test(h.raw));a.loose=d}if(a.loose)for(let l=0;l<a.items.length;l++)a.items[l].loose=!0;return a}}html(e){const n=this.rules.block.html.exec(e);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(e){const n=this.rules.block.def.exec(e);if(n){const r=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:i,title:a}}}table(e){var n;const r=this.rules.block.table.exec(e);if(!r||!this.rules.other.tableDelimiter.test(r[2]))return;const i=Bp(r[1]),a=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=(n=r[3])!=null&&n.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:r[0],header:[],align:[],rows:[]};if(i.length===a.length){for(const c of a)this.rules.other.tableAlignRight.test(c)?s.align.push("right"):this.rules.other.tableAlignCenter.test(c)?s.align.push("center"):this.rules.other.tableAlignLeft.test(c)?s.align.push("left"):s.align.push(null);for(let c=0;c<i.length;c++)s.header.push({text:i[c],tokens:this.lexer.inline(i[c]),header:!0,align:s.align[c]});for(const c of o)s.rows.push(Bp(c,s.header.length).map((l,u)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:s.align[u]})));return s}}lheading(e){const n=this.rules.block.lheading.exec(e);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(e){const n=this.rules.block.paragraph.exec(e);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const n=this.rules.block.text.exec(e);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(e){const n=this.rules.inline.escape.exec(e);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(e){const n=this.rules.inline.tag.exec(e);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(e){const n=this.rules.inline.link.exec(e);if(n){const r=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const o=ji(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{const o=ZC(n[2],"()");if(o>-1){const s=(n[0].indexOf("!")===0?5:4)+n[1].length+o;n[2]=n[2].substring(0,o),n[0]=n[0].substring(0,s).trim(),n[3]=""}}let i=n[2],a="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(i);o&&(i=o[1],a=o[3])}else a=n[3]?n[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i=i.slice(1):i=i.slice(1,-1)),zp(n,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(e,n){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),a=n[i.toLowerCase()];if(!a){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return zp(r,a,r[0],this.lexer,this.rules)}}emStrong(e,n,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!r||this.rules.inline.punctuation.exec(r))){const a=[...i[0]].length-1;let o,s,c=a,l=0;const u=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,n=n.slice(-1*e.length+a);(i=u.exec(n))!=null;){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(s=[...o].length,i[3]||i[4]){c+=s;continue}else if((i[5]||i[6])&&a%3&&!((a+s)%3)){l+=s;continue}if(c-=s,c>0)continue;s=Math.min(s,s+c+l);const d=[...i[0]][0].length,h=e.slice(0,a+i.index+d+s);if(Math.min(a,s)%2){const f=h.slice(1,-1);return{type:"em",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}const p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const n=this.rules.inline.code.exec(e);if(n){let r=n[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(r),a=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&a&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:n[0],text:r}}}br(e){const n=this.rules.inline.br.exec(e);if(n)return{type:"br",raw:n[0]}}del(e){const n=this.rules.inline.del.exec(e);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(e){const n=this.rules.inline.autolink.exec(e);if(n){let r,i;return n[2]==="@"?(r=n[1],i="mailto:"+r):(r=n[1],i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var n;let r;if(r=this.rules.inline.url.exec(e)){let i,a;if(r[2]==="@")i=r[0],a="mailto:"+i;else{let o;do o=r[0],r[0]=((n=this.rules.inline._backpedal.exec(r[0]))==null?void 0:n[0])??"";while(o!==r[0]);i=r[0],r[1]==="www."?a="http://"+r[0]:a=r[0]}return{type:"link",raw:r[0],text:i,href:a,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const n=this.rules.inline.text.exec(e);if(n){const r=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:r}}}}class kt{constructor(e){X(this,"tokens"),X(this,"options"),X(this,"state"),X(this,"tokenizer"),X(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Pr,this.options.tokenizer=this.options.tokenizer||new vs,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:Ze,block:so.normal,inline:Ai.normal};this.options.pedantic?(n.block=so.pedantic,n.inline=Ai.pedantic):this.options.gfm&&(n.block=so.gfm,this.options.breaks?n.inline=Ai.breaks:n.inline=Ai.gfm),this.tokenizer.rules=n}static get rules(){return{block:so,inline:Ai}}static lex(e,n){return new kt(n).lex(e)}static lexInline(e,n){return new kt(n).inlineTokens(e)}lex(e){e=e.replace(Ze.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var i,a,o;for(this.options.pedantic&&(e=e.replace(Ze.tabCharGlobal,"    ").replace(Ze.spaceLine,""));e;){let s;if((a=(i=this.options.extensions)==null?void 0:i.block)!=null&&a.some(l=>(s=l.call({lexer:this},e,n))?(e=e.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);const l=n.at(-1);s.raw.length===1&&l!==void 0?l.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);const l=n.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+s.raw,l.text+=`
`+s.text,this.inlineQueue.at(-1).src=l.text):n.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);const l=n.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+s.raw,l.text+=`
`+s.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),n.push(s);continue}let c=e;if((o=this.options.extensions)!=null&&o.startBlock){let l=1/0;const u=e.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(l=Math.min(l,d))}),l<1/0&&l>=0&&(c=e.substring(0,l+1))}if(this.state.top&&(s=this.tokenizer.paragraph(c))){const l=n.at(-1);r&&(l==null?void 0:l.type)==="paragraph"?(l.raw+=`
`+s.raw,l.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(s),r=c.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);const l=n.at(-1);(l==null?void 0:l.type)==="text"?(l.raw+=`
`+s.raw,l.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(s);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var r,i,a;let o=e,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,s.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let c=!1,l="";for(;e;){c||(l=""),c=!1;let u;if((i=(r=this.options.extensions)==null?void 0:r.inline)!=null&&i.some(h=>(u=h.call({lexer:this},e,n))?(e=e.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(e,o,l)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),n.push(u);continue}let d=e;if((a=this.options.extensions)!=null&&a.startInline){let h=1/0;const p=e.slice(1);let f;this.options.extensions.startInline.forEach(b=>{f=b.call({lexer:this},p),typeof f=="number"&&f>=0&&(h=Math.min(h,f))}),h<1/0&&h>=0&&(d=e.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(l=u.raw.slice(-1)),c=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}}class bs{constructor(e){X(this,"options"),X(this,"parser"),this.options=e||Pr}space(e){return""}code({text:e,lang:n,escaped:r}){var i;const a=(i=(n||"").match(Ze.notSpaceStart))==null?void 0:i[0],o=e.replace(Ze.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Wt(a)+'">'+(r?o:Wt(o,!0))+`</code></pre>
`:"<pre><code>"+(r?o:Wt(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:n}){return`<h${n}>${this.parser.parseInline(e)}</h${n}>
`}hr(e){return`<hr>
`}list(e){const n=e.ordered,r=e.start;let i="";for(let s=0;s<e.items.length;s++){const c=e.items[s];i+=this.listitem(c)}const a=n?"ol":"ul",o=n&&r!==1?' start="'+r+'"':"";return"<"+a+o+`>
`+i+"</"+a+`>
`}listitem(e){var n;let r="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+Wt(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):r+=i+" "}return r+=this.parser.parse(e.tokens,!!e.loose),`<li>${r}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let n="",r="";for(let a=0;a<e.header.length;a++)r+=this.tablecell(e.header[a]);n+=this.tablerow({text:r});let i="";for(let a=0;a<e.rows.length;a++){const o=e.rows[a];r="";for(let s=0;s<o.length;s++)r+=this.tablecell(o[s]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const n=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+n+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Wt(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:n,tokens:r}){const i=this.parser.parseInline(r),a=Fp(e);if(a===null)return i;e=a;let o='<a href="'+e+'"';return n&&(o+=' title="'+Wt(n)+'"'),o+=">"+i+"</a>",o}image({href:e,title:n,text:r}){const i=Fp(e);if(i===null)return Wt(r);e=i;let a=`<img src="${e}" alt="${r}"`;return n&&(a+=` title="${Wt(n)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Wt(e.text)}}class Hd{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class wt{constructor(e){X(this,"options"),X(this,"renderer"),X(this,"textRenderer"),this.options=e||Pr,this.options.renderer=this.options.renderer||new bs,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Hd}static parse(e,n){return new wt(n).parse(e)}static parseInline(e,n){return new wt(n).parseInline(e)}parse(e,n=!0){var r,i;let a="";for(let o=0;o<e.length;o++){const s=e[o];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[s.type]){const l=s,u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){a+=u||"";continue}}const c=s;switch(c.type){case"space":{a+=this.renderer.space(c);continue}case"hr":{a+=this.renderer.hr(c);continue}case"heading":{a+=this.renderer.heading(c);continue}case"code":{a+=this.renderer.code(c);continue}case"table":{a+=this.renderer.table(c);continue}case"blockquote":{a+=this.renderer.blockquote(c);continue}case"list":{a+=this.renderer.list(c);continue}case"html":{a+=this.renderer.html(c);continue}case"paragraph":{a+=this.renderer.paragraph(c);continue}case"text":{let l=c,u=this.renderer.text(l);for(;o+1<e.length&&e[o+1].type==="text";)l=e[++o],u+=`
`+this.renderer.text(l);n?a+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):a+=u;continue}default:{const l='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return a}parseInline(e,n=this.renderer){var r,i;let a="";for(let o=0;o<e.length;o++){const s=e[o];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[s.type]){const l=this.options.extensions.renderers[s.type].call({parser:this},s);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){a+=l||"";continue}}const c=s;switch(c.type){case"escape":{a+=n.text(c);break}case"html":{a+=n.html(c);break}case"link":{a+=n.link(c);break}case"image":{a+=n.image(c);break}case"strong":{a+=n.strong(c);break}case"em":{a+=n.em(c);break}case"codespan":{a+=n.codespan(c);break}case"br":{a+=n.br(c);break}case"del":{a+=n.del(c);break}case"text":{a+=n.text(c);break}default:{const l='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return a}}class sa{constructor(e){X(this,"options"),X(this,"block"),this.options=e||Pr}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?kt.lex:kt.lexInline}provideParser(){return this.block?wt.parse:wt.parseInline}}X(sa,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class JC{constructor(...e){X(this,"defaults",Ad()),X(this,"options",this.setOptions),X(this,"parse",this.parseMarkdown(!0)),X(this,"parseInline",this.parseMarkdown(!1)),X(this,"Parser",wt),X(this,"Renderer",bs),X(this,"TextRenderer",Hd),X(this,"Lexer",kt),X(this,"Tokenizer",vs),X(this,"Hooks",sa),this.use(...e)}walkTokens(e,n){var r,i;let a=[];for(const o of e)switch(a=a.concat(n.call(this,o)),o.type){case"table":{const s=o;for(const c of s.header)a=a.concat(this.walkTokens(c.tokens,n));for(const c of s.rows)for(const l of c)a=a.concat(this.walkTokens(l.tokens,n));break}case"list":{const s=o;a=a.concat(this.walkTokens(s.items,n));break}default:{const s=o;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[s.type]?this.defaults.extensions.childTokens[s.type].forEach(c=>{const l=s[c].flat(1/0);a=a.concat(this.walkTokens(l,n))}):s.tokens&&(a=a.concat(this.walkTokens(s.tokens,n)))}}return a}use(...e){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const o=n.renderers[a.name];o?n.renderers[a.name]=function(...s){let c=a.renderer.apply(this,s);return c===!1&&(c=o.apply(this,s)),c}:n.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=n[a.level];o?o.unshift(a.tokenizer):n[a.level]=[a.tokenizer],a.start&&(a.level==="block"?n.startBlock?n.startBlock.push(a.start):n.startBlock=[a.start]:a.level==="inline"&&(n.startInline?n.startInline.push(a.start):n.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(n.childTokens[a.name]=a.childTokens)}),i.extensions=n),r.renderer){const a=this.defaults.renderer||new bs(this.defaults);for(const o in r.renderer){if(!(o in a))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const s=o,c=r.renderer[s],l=a[s];a[s]=(...u)=>{let d=c.apply(a,u);return d===!1&&(d=l.apply(a,u)),d||""}}i.renderer=a}if(r.tokenizer){const a=this.defaults.tokenizer||new vs(this.defaults);for(const o in r.tokenizer){if(!(o in a))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const s=o,c=r.tokenizer[s],l=a[s];a[s]=(...u)=>{let d=c.apply(a,u);return d===!1&&(d=l.apply(a,u)),d}}i.tokenizer=a}if(r.hooks){const a=this.defaults.hooks||new sa;for(const o in r.hooks){if(!(o in a))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const s=o,c=r.hooks[s],l=a[s];sa.passThroughHooks.has(o)?a[s]=u=>{if(this.defaults.async)return Promise.resolve(c.call(a,u)).then(h=>l.call(a,h));const d=c.call(a,u);return l.call(a,d)}:a[s]=(...u)=>{let d=c.apply(a,u);return d===!1&&(d=l.apply(a,u)),d}}i.hooks=a}if(r.walkTokens){const a=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(s){let c=[];return c.push(o.call(this,s)),a&&(c=c.concat(a.call(this,s))),c}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,n){return kt.lex(e,n??this.defaults)}parser(e,n){return wt.parse(e,n??this.defaults)}parseMarkdown(e){return(n,r)=>{const i={...r},a={...this.defaults,...i},o=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&i.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));a.hooks&&(a.hooks.options=a,a.hooks.block=e);const s=a.hooks?a.hooks.provideLexer():e?kt.lex:kt.lexInline,c=a.hooks?a.hooks.provideParser():e?wt.parse:wt.parseInline;if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(l=>s(l,a)).then(l=>a.hooks?a.hooks.processAllTokens(l):l).then(l=>a.walkTokens?Promise.all(this.walkTokens(l,a.walkTokens)).then(()=>l):l).then(l=>c(l,a)).then(l=>a.hooks?a.hooks.postprocess(l):l).catch(o);try{a.hooks&&(n=a.hooks.preprocess(n));let l=s(n,a);a.hooks&&(l=a.hooks.processAllTokens(l)),a.walkTokens&&this.walkTokens(l,a.walkTokens);let u=c(l,a);return a.hooks&&(u=a.hooks.postprocess(u)),u}catch(l){return o(l)}}}onError(e,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Wt(r.message+"",!0)+"</pre>";return n?Promise.resolve(i):i}if(n)return Promise.reject(r);throw r}}}const Cr=new JC;function ne(t,e){return Cr.parse(t,e)}ne.options=ne.setOptions=function(t){return Cr.setOptions(t),ne.defaults=Cr.defaults,Vv(ne.defaults),ne};ne.getDefaults=Ad;ne.defaults=Pr;ne.use=function(...t){return Cr.use(...t),ne.defaults=Cr.defaults,Vv(ne.defaults),ne};ne.walkTokens=function(t,e){return Cr.walkTokens(t,e)};ne.parseInline=Cr.parseInline;ne.Parser=wt;ne.parser=wt.parse;ne.Renderer=bs;ne.TextRenderer=Hd;ne.Lexer=kt;ne.lexer=kt.lex;ne.Tokenizer=vs;ne.Hooks=sa;ne.parse=ne;ne.options;ne.setOptions;ne.use;ne.walkTokens;ne.parseInline;wt.parse;kt.lex;const YC=30,Ui=17,XC=t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,Gl=990,eS=300,co=Gl+eS,tS=({d:t})=>{const e=Math.PI/2,n=t/Ui/2.8,r=e*Math.min(n,1),i=n<1?(t-Math.sin(r))/Math.cos(r)*.5:0,a=-t,o=t,s=t-Ui*Math.sin(r),c=Ui*Math.cos(r),l=s-i*Math.cos(r),u=c-i*Math.sin(r);return C.jsxs(C.Fragment,{children:[C.jsx("circle",{cx:a,cy:"0",r:Ui}),C.jsx("circle",{cx:o,cy:"0",r:Ui}),n<.45?C.jsx("path",{d:`
            M${-s},${c} 
            C${-l},${u} ${l},${u} ${s},${c} L${s},${-c}
            C${l},${-u} ${-l},${-u} ${-s},${-c} Z
          `}):null]})},nS=t=>t<1/3?t*3:t<2/3?1:3-t*3,Vp=t=>t<1/3?0:t<2/3?(t-1/3)*3:1,rS=({label:t,className:e})=>{const[n,r]=B.useState(null),i=B.useRef(!1);if(B.useEffect(()=>{const p=f=>{r(b=>b==null?{start:f,current:f}:{...b,current:f}),i.current||requestAnimationFrame(p)};i.current||requestAnimationFrame(p)},[i,r]),n==null)return null;let a,o;const s=n.current-n.start,c=s%co,l=Math.floor(s/co);if(c<Gl){const p=s/co,f=Math.floor(p),b=XC((p-f)*(co/Gl));a=nS(b),o=l%2?Vp(b):1+Vp(b)}else a=0,o=0;const u=a>.2?0:5*(.2-a)/.2,d=.3,h=a>d?1-.25*(a-d)/(1-d):1;return C.jsx("div",{className:ae("h-full w-full flex items-center justify-center",e),children:C.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[C.jsx("div",{className:ae("w-8 h-8 block text-accent"),children:C.jsx("svg",{viewBox:"0 0 100 100",stroke:"none",fill:"currentColor",style:{filter:`drop-shadow(0 0 ${u}px var(--accent))`},children:C.jsx("g",{transform:`translate(50 50) rotate(${o*90})`,opacity:h,children:C.jsx(tS,{d:YC*a})})})}),C.jsx("p",{className:"text-primary-60",children:t})]})})},iS=({handler:t,message:e,responseIndex:n,messageIndex:r,className:i})=>e.choices.length>0?C.jsx("div",{className:i,children:C.jsx("ul",{className:"space-y-2",children:e.choices.map((a,o)=>e.selectedChoiceId==null||a.choiceId===e.selectedChoiceId?C.jsx("li",{className:"w-full",children:C.jsx(ms,{type:"ghost",Icon:Gs,onClick:e.selectedChoiceId==null?()=>{t.sendChoice(a.choiceId,{},{responseIndex:n,messageIndex:r})}:void 0,label:a.choiceText})},o):null)})}):null,Lc=({text:t,files:e})=>C.jsxs("div",{className:"space-y-2",children:[C.jsx("div",{className:"flex justify-end pl-10 text-base",children:C.jsx("div",{className:"text-primary-60 p-3 rounded-inner bg-primary-5 whitespace-pre-wrap",children:t})}),e!=null?C.jsx("div",{className:"flex flex-wrap justify-end gap-2",children:e.map((n,r)=>C.jsx("img",{className:"rounded-inner h-20",src:URL.createObjectURL(n)},r))}):null]}),aS=({message:t})=>C.jsxs("div",{className:"bg-error-secondary text-error-primary text-base p-3 rounded-inner flex items-center gap-2",children:[C.jsx(Uv,{className:"w-4 h-4 flex-none"}),C.jsx("p",{className:"text-primary-80",children:t})]}),oS=({responses:t,colorMode:e,uploadedFiles:n,lastBotResponseIndex:r,isWaiting:i,customModalities:a,handler:o,className:s,enabled:c})=>{const l=B.useRef(null),u=B.useRef(null);return B.useEffect(()=>{i||setTimeout(()=>{var d;(d=u.current)==null||d.scrollIntoView({behavior:"smooth"})})},[i]),C.jsxs("div",{className:ae("relative",s),children:[C.jsx("div",{"data-theme":e==="dark"?"light":"dark",className:ae("absolute inset-x-0 h-[1px] top-0 bg-background opacity-[0.01] backdrop-blur-md")}),i?C.jsx(rS,{label:"Thinking",className:"absolute inset-0"}):null,C.jsx("div",{className:ae("absolute inset-0 p-2 md:p-3 overflow-y-auto no-scrollbar space-y-8",i?"opacity-0":"opacity-100"),ref:l,children:t.map((d,h)=>{if(d.type==="user")return d.payload.type==="text"?C.jsx(Lc,{text:d.payload.text},h):d.payload.type==="structured"&&d.payload.utterance!=null&&d.payload.uploadIds!=null?C.jsx(Lc,{text:d.payload.utterance,files:d.payload.uploadIds.map(f=>n[f]).filter(f=>f!=null)},h):null;if(d.type==="failure")return C.jsx(aS,{message:d.payload.text},h);const p=r!=null&&h===r;return C.jsxs(B.Fragment,{children:[C.jsxs("div",{className:ae("space-y-2",p?"min-h-full":""),ref:p?u:void 0,children:[d.payload.messages.map((f,b)=>C.jsx("div",{className:"text-base",children:C.jsx("div",{className:"pr-10",dangerouslySetInnerHTML:{__html:ne(f.text)}})},b)),Object.entries(d.payload.modalities??{}).map(([f,b])=>{const x=a[f];return x==null?(console.warn(`Custom component implementation missing for the ${f} modality.`),null):C.jsx(x,{data:b,conversationHandler:o,enabled:c},f)})]}),d.payload.messages.map((f,b)=>{if(f.selectedChoiceId!=null){const x=f.choices.find(m=>m.choiceId===f.selectedChoiceId);return x==null?null:C.jsx(Lc,{text:x.choiceText},b)}return null})]},h)})},"messages")]})},sS=()=>C.jsxs("div",{className:ae("flex-grow flex flex-col items-center justify-center gap-6 text-primary-80","fullscreen-error"),children:[C.jsx(Dd,{className:"w-20 h-20 text-primary-20"}),C.jsxs("div",{className:"text-center",children:[C.jsx("h3",{className:"text-xl mb-2",children:"Oops!"}),C.jsx("p",{children:"Something went wrong."}),C.jsx("p",{children:"Try again later."})]})]});function Kl(){return Kl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kl.apply(null,arguments)}function cS(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}var lS=B.useLayoutEffect,uS=function(t){var e=mr.useRef(t);return lS(function(){e.current=t}),e},Hp=function(t,e){if(typeof t=="function"){t(e);return}t.current=e},dS=function(t,e){var n=mr.useRef();return mr.useCallback(function(r){t.current=r,n.current&&Hp(n.current,null),n.current=e,e&&Hp(e,r)},[e])},qp={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},hS=function(t){Object.keys(qp).forEach(function(e){t.style.setProperty(e,qp[e],"important")})},Wp=hS,$e=null,$p=function(t,e){var n=t.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?n+e.borderSize:n-e.paddingSize};function pS(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),$e||($e=document.createElement("textarea"),$e.setAttribute("tabindex","-1"),$e.setAttribute("aria-hidden","true"),Wp($e)),$e.parentNode===null&&document.body.appendChild($e);var i=t.paddingSize,a=t.borderSize,o=t.sizingStyle,s=o.boxSizing;Object.keys(o).forEach(function(h){var p=h;$e.style[p]=o[p]}),Wp($e),$e.value=e;var c=$p($e,t);$e.value=e,c=$p($e,t),$e.value="x";var l=$e.scrollHeight-i,u=l*n;s==="border-box"&&(u=u+i+a),c=Math.max(u,c);var d=l*r;return s==="border-box"&&(d=d+i+a),c=Math.min(d,c),[c,l]}var Gp=function(){},fS=function(t,e){return t.reduce(function(n,r){return n[r]=e[r],n},{})},mS=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],gS=!!document.documentElement.currentStyle,vS=function(t){var e=window.getComputedStyle(t);if(e===null)return null;var n=fS(mS,e),r=n.boxSizing;if(r==="")return null;gS&&r==="border-box"&&(n.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)+parseFloat(n.borderLeftWidth)+parseFloat(n.paddingRight)+parseFloat(n.paddingLeft)+"px");var i=parseFloat(n.paddingBottom)+parseFloat(n.paddingTop),a=parseFloat(n.borderBottomWidth)+parseFloat(n.borderTopWidth);return{sizingStyle:n,paddingSize:i,borderSize:a}},bS=vS;function Jv(t,e,n){var r=uS(n);B.useLayoutEffect(function(){var i=function(a){return r.current(a)};if(t)return t.addEventListener(e,i),function(){return t.removeEventListener(e,i)}},[])}var yS=function(t){Jv(window,"resize",t)},kS=function(t){Jv(document.fonts,"loadingdone",t)},wS=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],CS=function(t,e){var n=t.cacheMeasurements,r=t.maxRows,i=t.minRows,a=t.onChange,o=a===void 0?Gp:a,s=t.onHeightChange,c=s===void 0?Gp:s,l=cS(t,wS),u=l.value!==void 0,d=B.useRef(null),h=dS(d,e),p=B.useRef(0),f=B.useRef(),b=function(){var m=d.current,v=n&&f.current?f.current:bS(m);if(v){f.current=v;var y=pS(v,m.value||m.placeholder||"x",i,r),g=y[0],S=y[1];p.current!==g&&(p.current=g,m.style.setProperty("height",g+"px","important"),c(g,{rowHeight:S}))}},x=function(m){u||b(),o(m)};return B.useLayoutEffect(b),yS(b),kS(b),B.createElement("textarea",Kl({},l,{onChange:x,ref:h}))},SS=B.forwardRef(CS);function TS(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var xS=Object.defineProperty,ES=(t,e,n)=>e in t?xS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Kp=(t,e,n)=>ES(t,typeof e!="symbol"?e+"":e,n);class dt{constructor(){Kp(this,"_locking"),Kp(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function we(t,e){if(!t)throw new Error(e)}const PS=34028234663852886e22,RS=-34028234663852886e22,IS=4294967295,_S=2147483647,OS=-2147483648;function Ro(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>_S||t<OS)throw new Error("invalid int 32: "+t)}function Zl(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>IS||t<0)throw new Error("invalid uint 32: "+t)}function Yv(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>PS||t<RS))throw new Error("invalid float 32: "+t)}const Xv=Symbol("@bufbuild/protobuf/enum-type");function MS(t){const e=t[Xv];return we(e,"missing enum type on enum object"),e}function e0(t,e,n,r){t[Xv]=t0(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function t0(t,e,n){const r=Object.create(null),i=Object.create(null),a=[];for(const o of e){const s=n0(o);a.push(s),r[o.name]=s,i[o.no]=s}return{typeName:t,values:a,findName(o){return r[o]},findNumber(o){return i[o]}}}function NS(t,e,n){const r={};for(const i of e){const a=n0(i);r[a.localName]=a.no,r[a.no]=a.localName}return e0(r,t,e),r}function n0(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class qd{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,a=i.makeReadOptions(n);return i.readMessage(this,a.readerFactory(e),e.byteLength,a),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,a=i.makeReadOptions(n);return i.readMessage(r,e,a,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),a=i.writerFactory();return r.writeMessage(this,a,i),a.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function LS(t,e,n,r){var i;const a=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),o={[a]:function(s){t.util.initFields(this),t.util.initPartial(s,this)}}[a];return Object.setPrototypeOf(o.prototype,new qd),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(s,c){return new o().fromBinary(s,c)},fromJson(s,c){return new o().fromJson(s,c)},fromJsonString(s,c){return new o().fromJsonString(s,c)},equals(s,c){return t.util.equals(o,s,c)}}),o}function DS(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Dc(t,e,n){for(let a=0;a<28;a=a+7){const o=t>>>a,s=!(!(o>>>7)&&e==0),c=(s?o|128:o)&255;if(n.push(c),!s)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let a=3;a<31;a=a+7){const o=e>>>a,s=!!(o>>>7),c=(s?o|128:o)&255;if(n.push(c),!s)return}n.push(e>>>31&1)}}const Io=4294967296;function Zp(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function a(o,s){const c=Number(t.slice(o,s));i*=n,r=r*n+c,r>=Io&&(i=i+(r/Io|0),r=r%Io)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),e?i0(r,i):Wd(r,i)}function AS(t,e){let n=Wd(t,e);const r=n.hi&2147483648;r&&(n=i0(n.lo,n.hi));const i=r0(n.lo,n.hi);return r?"-"+i:i}function r0(t,e){if({lo:t,hi:e}=jS(t,e),e<=2097151)return String(Io*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let a=n+r*6777216+i*6710656,o=r+i*8147497,s=i*2;const c=1e7;return a>=c&&(o+=Math.floor(a/c),a%=c),o>=c&&(s+=Math.floor(o/c),o%=c),s.toString()+Qp(o)+Qp(a)}function jS(t,e){return{lo:t>>>0,hi:e>>>0}}function Wd(t,e){return{lo:t|0,hi:e|0}}function i0(t,e){return e=~e,t?t=~t+1:e+=1,Wd(t,e)}const Qp=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Jp(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function US(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function FS(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),a=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(s){const c=typeof s=="bigint"?s:BigInt(s);if(c>i||c<r)throw new Error("int64 invalid: ".concat(s));return c},uParse(s){const c=typeof s=="bigint"?s:BigInt(s);if(c>o||c<a)throw new Error("uint64 invalid: ".concat(s));return c},enc(s){return t.setBigInt64(0,this.parse(s),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(s){return t.setBigInt64(0,this.uParse(s),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(s,c){return t.setInt32(0,s,!0),t.setInt32(4,c,!0),t.getBigInt64(0,!0)},uDec(s,c){return t.setInt32(0,s,!0),t.setInt32(4,c,!0),t.getBigUint64(0,!0)}}}const e=r=>we(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),n=r=>we(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),e(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),e(r),Zp(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),n(r),Zp(r)},dec(r,i){return AS(r,i)},uDec(r,i){return r0(r,i)}}}const pe=FS();var R;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(R||(R={}));var Wn;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Wn||(Wn={}));function wn(t,e,n){if(e===n)return!0;if(t==R.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case R.UINT64:case R.FIXED64:case R.INT64:case R.SFIXED64:case R.SINT64:return e==n}return!1}function bi(t,e){switch(t){case R.BOOL:return!1;case R.UINT64:case R.FIXED64:case R.INT64:case R.SFIXED64:case R.SINT64:return e==0?pe.zero:"0";case R.DOUBLE:case R.FLOAT:return 0;case R.BYTES:return new Uint8Array(0);case R.STRING:return"";default:return 0}}function a0(t,e){switch(t){case R.BOOL:return e===!1;case R.STRING:return e==="";case R.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Te;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Te||(Te={}));class BS{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Zl(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ro(e),Jp(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){Yv(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Zl(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Ro(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Ro(e),e=(e<<1^e>>31)>>>0,Jp(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=pe.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=pe.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=pe.enc(e);return Dc(n.lo,n.hi,this.buf),this}sint64(e){let n=pe.enc(e),r=n.hi>>31,i=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Dc(i,a,this.buf),this}uint64(e){let n=pe.uEnc(e);return Dc(n.lo,n.hi,this.buf),this}}class zS{constructor(e,n){this.varint64=DS,this.uint32=US,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case Te.Varint:for(;this.buf[this.pos++]&128;);break;case Te.Bit64:this.pos+=4;case Te.Bit32:this.pos+=4;break;case Te.LengthDelimited:let i=this.uint32();this.pos+=i;break;case Te.StartGroup:for(;;){const[a,o]=this.tag();if(o===Te.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(o,a)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return pe.dec(...this.varint64())}uint64(){return pe.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,pe.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return pe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return pe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function VS(t,e,n,r){let i;return{typeName:e,extendee:n,get field(){if(!i){const a=typeof r=="function"?r():r;a.name=e.split(".").pop(),a.jsonName="[".concat(e,"]"),i=t.util.newFieldList([a]).list()[0]}return i},runtime:t}}function o0(t){const e=t.field.localName,n=Object.create(null);return n[e]=HS(t),[n,()=>n[e]]}function HS(t){const e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return bi(e.T,e.L);case"message":const n=e.T,r=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function qS(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}let sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Qs=[];for(let t=0;t<sn.length;t++)Qs[sn[t].charCodeAt(0)]=t;Qs[45]=sn.indexOf("+");Qs[95]=sn.indexOf("/");const s0={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,a,o=0;for(let s=0;s<t.length;s++){if(a=Qs[t.charCodeAt(s)],a===void 0)switch(t[s]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=a,i=1;break;case 1:n[r++]=o<<2|(a&48)>>4,o=a,i=2;break;case 2:n[r++]=(o&15)<<4|(a&60)>>2,o=a,i=3;break;case 3:n[r++]=(o&3)<<6|a,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let a=0;a<t.length;a++)switch(r=t[a],n){case 0:e+=sn[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=sn[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=sn[i|r>>6],e+=sn[r&63],n=0;break}return n&&(e+=sn[i],e+="=",n==1&&(e+="=")),e}};function WS(t,e,n){l0(e,t);const r=e.runtime.bin.makeReadOptions(n),i=qS(t.getType().runtime.bin.listUnknownFields(t),e.field),[a,o]=o0(e);for(const s of i)e.runtime.bin.readField(a,r.readerFactory(s.data),e.field,s.wireType,r);return o()}function $S(t,e,n,r){l0(e,t);const i=e.runtime.bin.makeReadOptions(r),a=e.runtime.bin.makeWriteOptions(r);if(c0(t,e)){const l=t.getType().runtime.bin.listUnknownFields(t).filter(u=>u.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(const u of l)t.getType().runtime.bin.onUnknownField(t,u.no,u.wireType,u.data)}const o=a.writerFactory();let s=e.field;!s.opt&&!s.repeated&&(s.kind=="enum"||s.kind=="scalar")&&(s=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(s,n,o,a);const c=i.readerFactory(o.finish());for(;c.pos<c.len;){const[l,u]=c.tag(),d=c.skip(u,l);t.getType().runtime.bin.onUnknownField(t,l,u,d)}}function c0(t,e){const n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(r=>r.no==e.field.no)}function l0(t,e){we(t.extendee.typeName==e.getType().typeName,"extension ".concat(t.typeName," can only be applied to message ").concat(t.extendee.typeName))}function u0(t,e){const n=t.localName;if(t.repeated)return e[n].length>0;if(t.oneof)return e[t.oneof.localName].case===n;switch(t.kind){case"enum":case"scalar":return t.opt||t.req?e[n]!==void 0:t.kind=="enum"?e[n]!==t.T.values[0].no:!a0(t.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function Yp(t,e){const n=t.localName,r=!t.opt&&!t.req;if(t.repeated)e[n]=[];else if(t.oneof)e[t.oneof.localName]={case:void 0};else switch(t.kind){case"map":e[n]={};break;case"enum":e[n]=r?t.T.values[0].no:void 0;break;case"scalar":e[n]=r?bi(t.T,t.L):void 0;break;case"message":e[n]=void 0;break}}function pr(t,e){if(t===null||typeof t!="object"||!Object.getOwnPropertyNames(qd.prototype).every(r=>r in t&&typeof t[r]=="function"))return!1;const n=t.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function d0(t,e){return pr(e)||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}R.DOUBLE,R.FLOAT,R.INT64,R.UINT64,R.INT32,R.UINT32,R.BOOL,R.STRING,R.BYTES;const Xp={ignoreUnknownFields:!1},ef={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function GS(t){return t?Object.assign(Object.assign({},Xp),t):Xp}function KS(t){return t?Object.assign(Object.assign({},ef),t):ef}const ys=Symbol(),_o=Symbol();function ZS(){return{makeReadOptions:GS,makeWriteOptions:KS,readMessage(t,e,n,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(Kt(e)));r=r??new t;const i=new Map,a=n.typeRegistry;for(const[o,s]of Object.entries(e)){const c=t.fields.findJsonName(o);if(c){if(c.oneof){if(s===null&&c.kind=="scalar")continue;const l=i.get(c.oneof);if(l!==void 0)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(l,'", "').concat(o,'"'));i.set(c.oneof,o)}tf(r,s,c,n,t)}else{let l=!1;if(a!=null&&a.findExtension&&o.startsWith("[")&&o.endsWith("]")){const u=a.findExtension(o.substring(1,o.length-1));if(u&&u.extendee.typeName==t.typeName){l=!0;const[d,h]=o0(u);tf(d,s,u.field,n,u),$S(r,u,h(),n)}}if(!l&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(o,'" is unknown'))}}return r},writeMessage(t,e){const n=t.getType(),r={};let i;try{for(i of n.fields.byNumber()){if(!u0(i,t)){if(i.req)throw"required field not set";if(!e.emitDefaultValues||!JS(i))continue}const o=i.oneof?t[i.oneof.localName].value:t[i.localName],s=nf(i,o,e);s!==void 0&&(r[e.useProtoFieldName?i.name:i.jsonName]=s)}const a=e.typeRegistry;if(a!=null&&a.findExtensionFor)for(const o of n.runtime.bin.listUnknownFields(t)){const s=a.findExtensionFor(n.typeName,o.no);if(s&&c0(t,s)){const c=WS(t,s,e),l=nf(s.field,c,e);l!==void 0&&(r[s.field.jsonName]=l)}}}catch(a){const o=i?"cannot encode field ".concat(n.typeName,".").concat(i.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),s=a instanceof Error?a.message:String(a);throw new Error(o+(s.length>0?": ".concat(s):""))}return r},readScalar(t,e,n){return ca(t,e,n??Wn.BIGINT,!0)},writeScalar(t,e,n){if(e!==void 0&&(n||a0(t,e)))return Oo(t,e)},debug:Kt}}function Kt(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function tf(t,e,n,r,i){let a=n.localName;if(n.repeated){if(we(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Kt(e)));const o=t[a];for(const s of e){if(s===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Kt(s)));switch(n.kind){case"message":o.push(n.T.fromJson(s,r));break;case"enum":const c=Ac(n.T,s,r.ignoreUnknownFields,!0);c!==_o&&o.push(c);break;case"scalar":try{o.push(ca(n.T,s,n.L,!0))}catch(l){let u="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Kt(s));throw l instanceof Error&&l.message.length>0&&(u+=": ".concat(l.message)),new Error(u)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Kt(e)));const o=t[a];for(const[s,c]of Object.entries(e)){if(c===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: map value null"));let l;try{l=QS(n.K,s)}catch(u){let d="cannot decode map key for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Kt(e));throw u instanceof Error&&u.message.length>0&&(d+=": ".concat(u.message)),new Error(d)}switch(n.V.kind){case"message":o[l]=n.V.T.fromJson(c,r);break;case"enum":const u=Ac(n.V.T,c,r.ignoreUnknownFields,!0);u!==_o&&(o[l]=u);break;case"scalar":try{o[l]=ca(n.V.T,c,Wn.BIGINT,!0)}catch(d){let h="cannot decode map value for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Kt(e));throw d instanceof Error&&d.message.length>0&&(h+=": ".concat(d.message)),new Error(h)}break}}}else switch(n.oneof&&(t=t[n.oneof.localName]={case:a},a="value"),n.kind){case"message":const o=n.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let s=t[a];pr(s)?s.fromJson(e,r):(t[a]=s=o.fromJson(e,r),o.fieldWrapper&&!n.oneof&&(t[a]=o.fieldWrapper.unwrapField(s)));break;case"enum":const c=Ac(n.T,e,r.ignoreUnknownFields,!1);switch(c){case ys:Yp(n,t);break;case _o:break;default:t[a]=c;break}break;case"scalar":try{const l=ca(n.T,e,n.L,!1);switch(l){case ys:Yp(n,t);break;default:t[a]=l;break}}catch(l){let u="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Kt(e));throw l instanceof Error&&l.message.length>0&&(u+=": ".concat(l.message)),new Error(u)}break}}function QS(t,e){if(t===R.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return ca(t,e,Wn.BIGINT,!0).toString()}function ca(t,e,n,r){if(e===null)return r?bi(t,n):ys;switch(t){case R.DOUBLE:case R.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const i=Number(e);if(Number.isNaN(i)||!Number.isFinite(i))break;return t==R.FLOAT&&Yv(i),i;case R.INT32:case R.FIXED32:case R.SFIXED32:case R.SINT32:case R.UINT32:let a;if(typeof e=="number"?a=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(a=Number(e)),a===void 0)break;return t==R.UINT32||t==R.FIXED32?Zl(a):Ro(a),a;case R.INT64:case R.SFIXED64:case R.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=pe.parse(e);return n?o.toString():o;case R.FIXED64:case R.UINT64:if(typeof e!="number"&&typeof e!="string")break;const s=pe.uParse(e);return n?s.toString():s;case R.BOOL:if(typeof e!="boolean")break;return e;case R.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case R.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return s0.dec(e)}throw new Error}function Ac(t,e,n,r){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:r?t.values[0].no:ys;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const i=t.findName(e);if(i!==void 0)return i.no;if(n)return _o;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(Kt(e)))}function JS(t){return t.repeated||t.kind=="map"?!0:!(t.oneof||t.kind=="message"||t.opt||t.req)}function nf(t,e,n){if(t.kind=="map"){we(typeof e=="object"&&e!=null);const r={},i=Object.entries(e);switch(t.V.kind){case"scalar":for(const[o,s]of i)r[o.toString()]=Oo(t.V.T,s);break;case"message":for(const[o,s]of i)r[o.toString()]=s.toJson(n);break;case"enum":const a=t.V.T;for(const[o,s]of i)r[o.toString()]=jc(a,s,n.enumAsInteger);break}return n.emitDefaultValues||i.length>0?r:void 0}if(t.repeated){we(Array.isArray(e));const r=[];switch(t.kind){case"scalar":for(let i=0;i<e.length;i++)r.push(Oo(t.T,e[i]));break;case"enum":for(let i=0;i<e.length;i++)r.push(jc(t.T,e[i],n.enumAsInteger));break;case"message":for(let i=0;i<e.length;i++)r.push(e[i].toJson(n));break}return n.emitDefaultValues||r.length>0?r:void 0}switch(t.kind){case"scalar":return Oo(t.T,e);case"enum":return jc(t.T,e,n.enumAsInteger);case"message":return d0(t.T,e).toJson(n)}}function jc(t,e,n){var r;if(we(typeof e=="number"),t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const i=t.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function Oo(t,e){switch(t){case R.INT32:case R.SFIXED32:case R.SINT32:case R.FIXED32:case R.UINT32:return we(typeof e=="number"),e;case R.FLOAT:case R.DOUBLE:return we(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case R.STRING:return we(typeof e=="string"),e;case R.BOOL:return we(typeof e=="boolean"),e;case R.UINT64:case R.FIXED64:case R.INT64:case R.SFIXED64:case R.SINT64:return we(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case R.BYTES:return we(e instanceof Uint8Array),s0.enc(e)}}const Mr=Symbol("@bufbuild/protobuf/unknown-fields"),rf={readUnknownFields:!0,readerFactory:t=>new zS(t)},af={writeUnknownFields:!0,writerFactory:()=>new BS};function YS(t){return t?Object.assign(Object.assign({},rf),t):rf}function XS(t){return t?Object.assign(Object.assign({},af),t):af}function eT(){return{makeReadOptions:YS,makeWriteOptions:XS,listUnknownFields(t){var e;return(e=t[Mr])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Mr]},writeUnknownFields(t,e){const n=t[Mr];if(n)for(const r of n)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[Mr])||(i[Mr]=[]),i[Mr].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r,i){const a=t.getType(),o=i?e.len:e.pos+n;let s,c;for(;e.pos<o&&([s,c]=e.tag(),!(i===!0&&c==Te.EndGroup));){const l=a.fields.find(s);if(!l){const u=e.skip(c,s);r.readUnknownFields&&this.onUnknownField(t,s,c,u);continue}of(t,e,l,c,r)}if(i&&(c!=Te.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:of,writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){if(!u0(i,t)){if(i.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(i.name," to binary: required field not set"));continue}const a=i.oneof?t[i.oneof.localName].value:t[i.localName];sf(i,a,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e},writeField(t,e,n,r){e!==void 0&&sf(t,e,n,r)}}}function of(t,e,n,r,i){let{repeated:a,localName:o}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=o&&delete t.value,t.case=o,o="value"),n.kind){case"scalar":case"enum":const s=n.kind=="enum"?R.INT32:n.T;let c=ks;if(n.kind=="scalar"&&n.L>0&&(c=nT),a){let h=t[o];if(r==Te.LengthDelimited&&s!=R.STRING&&s!=R.BYTES){let p=e.uint32()+e.pos;for(;e.pos<p;)h.push(c(e,s))}else h.push(c(e,s))}else t[o]=c(e,s);break;case"message":const l=n.T;a?t[o].push(Mo(e,new l,i,n)):pr(t[o])?Mo(e,t[o],i,n):(t[o]=Mo(e,new l,i,n),l.fieldWrapper&&!n.oneof&&!n.repeated&&(t[o]=l.fieldWrapper.unwrapField(t[o])));break;case"map":let[u,d]=tT(n,e,i);t[o][u]=d;break}}function Mo(t,e,n,r){const i=e.getType().runtime.bin,a=r==null?void 0:r.delimited;return i.readMessage(e,t,a?r.no:t.uint32(),n,a),e}function tT(t,e,n){const r=e.uint32(),i=e.pos+r;let a,o;for(;e.pos<i;){const[s]=e.tag();switch(s){case 1:a=ks(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=ks(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=Mo(e,new t.V.T,n,void 0);break}break}}if(a===void 0&&(a=bi(t.K,Wn.BIGINT)),typeof a!="string"&&typeof a!="number"&&(a=a.toString()),o===void 0)switch(t.V.kind){case"scalar":o=bi(t.V.T,Wn.BIGINT);break;case"enum":o=t.V.T.values[0].no;break;case"message":o=new t.V.T;break}return[a,o]}function nT(t,e){const n=ks(t,e);return typeof n=="bigint"?n.toString():n}function ks(t,e){switch(e){case R.STRING:return t.string();case R.BOOL:return t.bool();case R.DOUBLE:return t.double();case R.FLOAT:return t.float();case R.INT32:return t.int32();case R.INT64:return t.int64();case R.UINT64:return t.uint64();case R.FIXED64:return t.fixed64();case R.BYTES:return t.bytes();case R.FIXED32:return t.fixed32();case R.SFIXED32:return t.sfixed32();case R.SFIXED64:return t.sfixed64();case R.SINT64:return t.sint64();case R.UINT32:return t.uint32();case R.SINT32:return t.sint32()}}function sf(t,e,n,r){we(e!==void 0);const i=t.repeated;switch(t.kind){case"scalar":case"enum":let a=t.kind=="enum"?R.INT32:t.T;if(i)if(we(Array.isArray(e)),t.packed)iT(n,a,t.no,e);else for(const o of e)la(n,a,t.no,o);else la(n,a,t.no,e);break;case"message":if(i){we(Array.isArray(e));for(const o of e)cf(n,r,t,o)}else cf(n,r,t,e);break;case"map":we(typeof e=="object"&&e!=null);for(const[o,s]of Object.entries(e))rT(n,r,t,o,s);break}}function rT(t,e,n,r,i){t.tag(n.no,Te.LengthDelimited),t.fork();let a=r;switch(n.K){case R.INT32:case R.FIXED32:case R.UINT32:case R.SFIXED32:case R.SINT32:a=Number.parseInt(r);break;case R.BOOL:we(r=="true"||r=="false"),a=r=="true";break}switch(la(t,n.K,1,a),n.V.kind){case"scalar":la(t,n.V.T,2,i);break;case"enum":la(t,R.INT32,2,i);break;case"message":we(i!==void 0),t.tag(2,Te.LengthDelimited).bytes(i.toBinary(e));break}t.join()}function cf(t,e,n,r){const i=d0(n.T,r);n.delimited?t.tag(n.no,Te.StartGroup).raw(i.toBinary(e)).tag(n.no,Te.EndGroup):t.tag(n.no,Te.LengthDelimited).bytes(i.toBinary(e))}function la(t,e,n,r){we(r!==void 0);let[i,a]=h0(e);t.tag(n,i)[a](r)}function iT(t,e,n,r){if(!r.length)return;t.tag(n,Te.LengthDelimited).fork();let[,i]=h0(e);for(let a=0;a<r.length;a++)t[i](r[a]);t.join()}function h0(t){let e=Te.Varint;switch(t){case R.BYTES:case R.STRING:e=Te.LengthDelimited;break;case R.DOUBLE:case R.FIXED64:case R.SFIXED64:e=Te.Bit64;break;case R.FIXED32:case R.SFIXED32:case R.FLOAT:e=Te.Bit32;break}const n=R[t].toLowerCase();return[e,n]}function aT(){return{setEnumType:e0,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,a=e,o=t;if(o[i]!=null)switch(r.kind){case"oneof":const s=o[i].case;if(s===void 0)continue;const c=r.findField(s);let l=o[i].value;c&&c.kind=="message"&&!pr(l,c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===R.BYTES&&(l=Fi(l)),a[i]={case:s,value:l};break;case"scalar":case"enum":let u=o[i];r.T===R.BYTES&&(u=r.repeated?u.map(Fi):Fi(u)),a[i]=u;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===R.BYTES)for(const[p,f]of Object.entries(o[i]))a[i][p]=Fi(f);else Object.assign(a[i],o[i]);break;case"message":const h=r.V.T;for(const p of Object.keys(o[i])){let f=o[i][p];h.fieldWrapper||(f=new h(f)),a[i][p]=f}break}break;case"message":const d=r.T;if(r.repeated)a[i]=o[i].map(h=>pr(h,d)?h:new d(h));else{const h=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?a[i]=Fi(h):a[i]=h:a[i]=pr(h,d)?h:new d(h)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],a=n[r.localName];if(r.repeated){if(i.length!==a.length)return!1;switch(r.kind){case"message":return i.every((o,s)=>r.T.equals(o,a[s]));case"scalar":return i.every((o,s)=>wn(r.T,o,a[s]));case"enum":return i.every((o,s)=>wn(R.INT32,o,a[s]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,a);case"enum":return wn(R.INT32,i,a);case"scalar":return wn(r.T,i,a);case"oneof":if(i.case!==a.case)return!1;const o=r.findField(i.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(i.value,a.value);case"enum":return wn(R.INT32,i.value,a.value);case"scalar":return wn(o.T,i.value,a.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const s=Object.keys(i).concat(Object.keys(a));switch(r.V.kind){case"message":const c=r.V.T;return s.every(u=>c.equals(i[u],a[u]));case"enum":return s.every(u=>wn(R.INT32,i[u],a[u]));case"scalar":const l=r.V.T;return s.every(u=>wn(l,i[u],a[u]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const a=t[i.localName];let o;if(i.repeated)o=a.map(lo);else if(i.kind=="map"){o=r[i.localName];for(const[s,c]of Object.entries(a))o[s]=lo(c)}else i.kind=="oneof"?o=i.findField(a.case)?{case:a.case,value:lo(a.value)}:{case:void 0}:o=lo(a);r[i.localName]=o}for(const i of e.runtime.bin.listUnknownFields(t))e.runtime.bin.onUnknownField(r,i.no,i.wireType,i.data);return n}}}function lo(t){if(t===void 0)return t;if(pr(t))return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Fi(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function oT(t,e,n){return{syntax:t,json:ZS(),bin:eT(),util:Object.assign(Object.assign({},aT()),{newFieldList:e,initFields:n}),makeMessageType(r,i,a){return LS(this,r,i,a)},makeEnum:NS,makeEnumType:t0,getEnumType:MS,makeExtension(r,i,a){return VS(this,r,i,a)}}}class sT{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function p0(t,e){const n=f0(t);return e?n:pT(hT(n))}function cT(t){return p0(t,!1)}const lT=f0;function f0(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const uT=new Set(["constructor","toString","toJSON","valueOf"]),dT=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),m0=t=>"".concat(t,"$"),hT=t=>dT.has(t)?m0(t):t,pT=t=>uT.has(t)?m0(t):t;class fT{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=cT(e)}addField(e){we(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function mT(t,e){var n,r,i,a,o,s;const c=[];let l;for(const u of typeof t=="function"?t():t){const d=u;if(d.localName=p0(u.name,u.oneof!==void 0),d.jsonName=(n=u.jsonName)!==null&&n!==void 0?n:lT(u.name),d.repeated=(r=u.repeated)!==null&&r!==void 0?r:!1,u.kind=="scalar"&&(d.L=(i=u.L)!==null&&i!==void 0?i:Wn.BIGINT),d.delimited=(a=u.delimited)!==null&&a!==void 0?a:!1,d.req=(o=u.req)!==null&&o!==void 0?o:!1,d.opt=(s=u.opt)!==null&&s!==void 0?s:!1,u.packed===void 0&&(d.packed=u.kind=="enum"||u.kind=="scalar"&&u.T!=R.BYTES&&u.T!=R.STRING),u.oneof!==void 0){const h=typeof u.oneof=="string"?u.oneof:u.oneof.name;(!l||l.name!=h)&&(l=new fT(h)),d.oneof=l,l.addField(d)}c.push(d)}return c}const P=oT("proto3",t=>new sT(t,e=>mT(e)),t=>{for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=bi(e.T,e.L);break}}});class tt extends qd{constructor(e){super(),this.seconds=pe.zero,this.nanos=0,P.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(P.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=pe.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return tt.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new tt({seconds:pe.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new tt().fromBinary(e,n)}static fromJson(e,n){return new tt().fromJson(e,n)}static fromJsonString(e,n){return new tt().fromJsonString(e,n)}static equals(e,n){return P.util.equals(tt,e,n)}}tt.runtime=P;tt.typeName="google.protobuf.Timestamp";tt.fields=P.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const gT=P.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:tt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:vT,repeated:!0},{no:5,name:"events",kind:"message",T:yT,repeated:!0}]),vT=P.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:bT,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),bT=P.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:tt},{no:3,name:"value",kind:"scalar",T:2}]),yT=P.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:tt},{no:7,name:"normalized_end_timestamp",kind:"message",T:tt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),g0=P.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),Dt=P.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),xe=P.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),ii=P.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Ki=P.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Ma=P.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),jt=P.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),Nr=P.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),kT=P.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Zt=P.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),$d=P.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:ws,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:R0}]),ws=P.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),wT=P.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:P.getEnumType(xe),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Na=P.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(Ql)},{no:4,name:"tracks",kind:"message",T:Zr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:wT},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:P.getEnumType(Cs)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:P.getEnumType(jt)},{no:18,name:"kind_details",kind:"enum",T:P.getEnumType(CT),repeated:!0}]),Ql=P.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Cs=P.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),CT=P.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),lt=P.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),ST=P.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:fr,repeated:!0}]),Zr=P.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:P.getEnumType(Dt)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:P.getEnumType(xe)},{no:10,name:"layers",kind:"message",T:fr,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:ST,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:P.getEnumType(lt)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:R0},{no:19,name:"audio_features",kind:"enum",T:P.getEnumType(Zt),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:P.getEnumType(g0)}]),fr=P.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(ii)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),Xe=P.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:P.getEnumType(Z)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:b0,oneof:"value"},{no:3,name:"speaker",kind:"message",T:TT,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:y0,oneof:"value"},{no:7,name:"transcription",kind:"message",T:xT,oneof:"value"},{no:8,name:"metrics",kind:"message",T:gT,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Jl,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:k0,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:w0,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:C0,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:Xl,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:eu,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:tu,oneof:"value"}]),Z=P.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),TT=P.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:v0,repeated:!0}]),v0=P.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),b0=P.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),y0=P.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),xT=P.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:ET,repeated:!0}]),ET=P.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Jl=P.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),k0=P.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),w0=P.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),C0=P.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:S0,oneof:"value"}]),S0=P.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),T0=P.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),PT=P.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:P.getEnumType(x0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),x0=P.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),RT=P.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:P.getEnumType(E0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),E0=P.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),P0=P.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:lf},{no:2,name:"screen",kind:"message",T:lf},{no:3,name:"resume_connection",kind:"enum",T:P.getEnumType(Ma)},{no:4,name:"disabled_codecs",kind:"message",T:IT},{no:5,name:"force_relay",kind:"enum",T:P.getEnumType(Ma)}]),lf=P.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:P.getEnumType(Ma)}]),IT=P.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:ws,repeated:!0},{no:2,name:"publish",kind:"message",T:ws,repeated:!0}]),R0=P.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),Yl=P.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),I0=P.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:P.getEnumType(Yl)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),_0=P.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),Xl=P.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:P.getEnumType(lt)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:I0,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:_0,oneof:"content_header"}],{localName:"DataStream_Header"}),eu=P.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),tu=P.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),At=P.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),nu=P.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),_T=P.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),OT=P.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Sr,oneof:"message"},{no:2,name:"answer",kind:"message",T:Sr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Gd,oneof:"message"},{no:4,name:"add_track",kind:"message",T:iu,oneof:"message"},{no:5,name:"mute",kind:"message",T:Kd,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Js,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:O0,oneof:"message"},{no:8,name:"leave",kind:"message",T:Ys,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:N0,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:j0,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:U0,oneof:"message"},{no:13,name:"simulate",kind:"message",T:$t,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:L0,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:B0,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:M0,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:AT,oneof:"message"}]),uf=P.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:MT,oneof:"message"},{no:2,name:"answer",kind:"message",T:Sr,oneof:"message"},{no:3,name:"offer",kind:"message",T:Sr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Gd,oneof:"message"},{no:5,name:"update",kind:"message",T:DT,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Zd,oneof:"message"},{no:8,name:"leave",kind:"message",T:Ys,oneof:"message"},{no:9,name:"mute",kind:"message",T:Kd,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:jT,oneof:"message"},{no:11,name:"room_update",kind:"message",T:UT,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:BT,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:VT,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:qT,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:WT,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:LT,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:NT,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:$T,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:ZT,oneof:"message"},{no:22,name:"request_response",kind:"message",T:QT,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:JT,oneof:"message"}]),ru=P.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),iu=P.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:P.getEnumType(Dt)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:P.getEnumType(xe)},{no:9,name:"layers",kind:"message",T:fr,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:ru,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:P.getEnumType(lt)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:P.getEnumType(g0)}]),Gd=P.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:P.getEnumType(At)},{no:3,name:"final",kind:"scalar",T:8}]),Kd=P.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),MT=P.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:$d},{no:2,name:"participant",kind:"message",T:Na},{no:3,name:"other_participants",kind:"message",T:Na,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:D0,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:P0},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:PT},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:ws,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),NT=P.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:D0,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:P0}]),Zd=P.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Zr}]),LT=P.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Sr=P.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),DT=P.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Na,repeated:!0}]),Js=P.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:T0,repeated:!0}]),O0=P.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:P.getEnumType(ii)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),M0=P.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:P.getEnumType(Zt),repeated:!0}]),AT=P.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Ys=P.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:P.getEnumType(jt)},{no:3,name:"action",kind:"enum",T:P.getEnumType(ai)},{no:4,name:"regions",kind:"message",T:GT}]),ai=P.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),N0=P.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:fr,repeated:!0}]),L0=P.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),D0=P.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),jT=P.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:v0,repeated:!0}]),UT=P.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:$d}]),FT=P.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:P.getEnumType(Ki)},{no:3,name:"score",kind:"scalar",T:2}]),BT=P.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:FT,repeated:!0}]),zT=P.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:P.getEnumType(nu)}]),VT=P.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:zT,repeated:!0}]),Qd=P.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:P.getEnumType(ii)},{no:2,name:"enabled",kind:"scalar",T:8}]),HT=P.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Qd,repeated:!0}]),qT=P.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Qd,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:HT,repeated:!0}]),A0=P.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),j0=P.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:A0,repeated:!0}]),WT=P.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),U0=P.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Sr},{no:2,name:"subscription",kind:"message",T:Js},{no:3,name:"publish_tracks",kind:"message",T:Zd,repeated:!0},{no:4,name:"data_channels",kind:"message",T:F0,repeated:!0},{no:5,name:"offer",kind:"message",T:Sr},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),F0=P.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:P.getEnumType(At)}]),$t=P.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:P.getEnumType(_T),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),B0=P.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),$T=P.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),GT=P.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:KT,repeated:!0}]),KT=P.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),ZT=P.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:P.getEnumType(kT)}]),QT=P.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:P.getEnumType(Jd)},{no:3,name:"message",kind:"scalar",T:9}]),Jd=P.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),JT=P.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function YT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var au={exports:{}},XT=au.exports,df;function e2(){return df||(df=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(XT,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],a={},o=null;function s(b,x){var m=b[x];if(typeof m.bind=="function")return m.bind(b);try{return Function.prototype.bind.call(m,b)}catch{return function(){return Function.prototype.apply.apply(m,[b,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(b){return b==="debug"&&(b="log"),typeof console===n?!1:b==="trace"&&r?c:console[b]!==void 0?s(console,b):console.log!==void 0?s(console,"log"):e}function u(){for(var b=this.getLevel(),x=0;x<i.length;x++){var m=i[x];this[m]=x<b?e:this.methodFactory(m,b,this.name)}if(this.log=this.debug,typeof console===n&&b<this.levels.SILENT)return"No console available for logging"}function d(b){return function(){typeof console!==n&&(u.call(this),this[b].apply(this,arguments))}}function h(b,x,m){return l(b)||d.apply(this,arguments)}function p(b,x){var m=this,v,y,g,S="loglevel";typeof b=="string"?S+=":"+b:typeof b=="symbol"&&(S=void 0);function w(F){var H=(i[F]||"silent").toUpperCase();if(!(typeof window===n||!S)){try{window.localStorage[S]=H;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+H+";"}catch{}}}function T(){var F;if(!(typeof window===n||!S)){try{F=window.localStorage[S]}catch{}if(typeof F===n)try{var H=window.document.cookie,ee=encodeURIComponent(S),G=H.indexOf(ee+"=");G!==-1&&(F=/^([^;]+)/.exec(H.slice(G+ee.length+1))[1])}catch{}return m.levels[F]===void 0&&(F=void 0),F}}function E(){if(!(typeof window===n||!S)){try{window.localStorage.removeItem(S)}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function _(F){var H=F;if(typeof H=="string"&&m.levels[H.toUpperCase()]!==void 0&&(H=m.levels[H.toUpperCase()]),typeof H=="number"&&H>=0&&H<=m.levels.SILENT)return H;throw new TypeError("log.setLevel() called with invalid level: "+F)}m.name=b,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=x||h,m.getLevel=function(){return g??y??v},m.setLevel=function(F,H){return g=_(F),H!==!1&&w(g),u.call(m)},m.setDefaultLevel=function(F){y=_(F),T()||m.setLevel(F,!1)},m.resetLevel=function(){g=null,E(),u.call(m)},m.enableAll=function(F){m.setLevel(m.levels.TRACE,F)},m.disableAll=function(F){m.setLevel(m.levels.SILENT,F)},m.rebuild=function(){if(o!==m&&(v=_(o.getLevel())),u.call(m),o===m)for(var F in a)a[F].rebuild()},v=_(o?o.getLevel():"WARN");var M=T();M!=null&&(g=_(M)),u.call(m)}o=new p,o.getLogger=function(b){if(typeof b!="symbol"&&typeof b!="string"||b==="")throw new TypeError("You must supply a name when creating a logger.");var x=a[b];return x||(x=a[b]=new p(b,o.methodFactory)),x};var f=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=f),o},o.getLoggers=function(){return a},o.default=o,o})}(au)),au.exports}var Xs=e2(),ou;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(ou||(ou={}));var zt;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(zt||(zt={}));let $=Xs.getLogger("livekit");Object.values(zt).map(t=>Xs.getLogger(t));$.setDefaultLevel(ou.info);function vn(t){const e=Xs.getLogger(t);return e.setDefaultLevel($.getLevel()),e}const t2=Xs.getLogger("lk-e2ee"),Bi=7e3,n2=[0,300,2*2*300,3*3*300,4*4*300,Bi,Bi,Bi,Bi,Bi];class r2{constructor(e){this._retryDelays=e!==void 0?[...e]:n2}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function i2(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function k(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?a(u.value):i(u.value).then(s,c)}l((r=r.apply(t,e||[])).next())})}function hf(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof hf=="function"?hf(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=t[a]&&function(o){return new Promise(function(s,c){o=t[a](o),i(s,c,o.done,o.value)})}}function i(a,o,s,c){Promise.resolve(c).then(function(l){a({value:l,done:s})},o)}}var uo={exports:{}},pf;function a2(){if(pf)return uo.exports;pf=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(g,S,w){return Function.prototype.apply.call(g,S,w)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(g){return Object.getOwnPropertyNames(g).concat(Object.getOwnPropertySymbols(g))}:n=function(g){return Object.getOwnPropertyNames(g)};function r(g){console&&console.warn&&console.warn(g)}var i=Number.isNaN||function(g){return g!==g};function a(){a.init.call(this)}uo.exports=a,uo.exports.once=m,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(g){if(typeof g!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof g)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(g){if(typeof g!="number"||g<0||i(g))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+g+".");o=g}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||i(g))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+g+".");return this._maxListeners=g,this};function c(g){return g._maxListeners===void 0?a.defaultMaxListeners:g._maxListeners}a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(g){for(var S=[],w=1;w<arguments.length;w++)S.push(arguments[w]);var T=g==="error",E=this._events;if(E!==void 0)T=T&&E.error===void 0;else if(!T)return!1;if(T){var _;if(S.length>0&&(_=S[0]),_ instanceof Error)throw _;var M=new Error("Unhandled error."+(_?" ("+_.message+")":""));throw M.context=_,M}var F=E[g];if(F===void 0)return!1;if(typeof F=="function")e(F,this,S);else for(var H=F.length,ee=f(F,H),w=0;w<H;++w)e(ee[w],this,S);return!0};function l(g,S,w,T){var E,_,M;if(s(w),_=g._events,_===void 0?(_=g._events=Object.create(null),g._eventsCount=0):(_.newListener!==void 0&&(g.emit("newListener",S,w.listener?w.listener:w),_=g._events),M=_[S]),M===void 0)M=_[S]=w,++g._eventsCount;else if(typeof M=="function"?M=_[S]=T?[w,M]:[M,w]:T?M.unshift(w):M.push(w),E=c(g),E>0&&M.length>E&&!M.warned){M.warned=!0;var F=new Error("Possible EventEmitter memory leak detected. "+M.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");F.name="MaxListenersExceededWarning",F.emitter=g,F.type=S,F.count=M.length,r(F)}return g}a.prototype.addListener=function(g,S){return l(this,g,S,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(g,S){return l(this,g,S,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(g,S,w){var T={fired:!1,wrapFn:void 0,target:g,type:S,listener:w},E=u.bind(T);return E.listener=w,T.wrapFn=E,E}a.prototype.once=function(g,S){return s(S),this.on(g,d(this,g,S)),this},a.prototype.prependOnceListener=function(g,S){return s(S),this.prependListener(g,d(this,g,S)),this},a.prototype.removeListener=function(g,S){var w,T,E,_,M;if(s(S),T=this._events,T===void 0)return this;if(w=T[g],w===void 0)return this;if(w===S||w.listener===S)--this._eventsCount===0?this._events=Object.create(null):(delete T[g],T.removeListener&&this.emit("removeListener",g,w.listener||S));else if(typeof w!="function"){for(E=-1,_=w.length-1;_>=0;_--)if(w[_]===S||w[_].listener===S){M=w[_].listener,E=_;break}if(E<0)return this;E===0?w.shift():b(w,E),w.length===1&&(T[g]=w[0]),T.removeListener!==void 0&&this.emit("removeListener",g,M||S)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(g){var S,w,T;if(w=this._events,w===void 0)return this;if(w.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):w[g]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete w[g]),this;if(arguments.length===0){var E=Object.keys(w),_;for(T=0;T<E.length;++T)_=E[T],_!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(S=w[g],typeof S=="function")this.removeListener(g,S);else if(S!==void 0)for(T=S.length-1;T>=0;T--)this.removeListener(g,S[T]);return this};function h(g,S,w){var T=g._events;if(T===void 0)return[];var E=T[S];return E===void 0?[]:typeof E=="function"?w?[E.listener||E]:[E]:w?x(E):f(E,E.length)}a.prototype.listeners=function(g){return h(this,g,!0)},a.prototype.rawListeners=function(g){return h(this,g,!1)},a.listenerCount=function(g,S){return typeof g.listenerCount=="function"?g.listenerCount(S):p.call(g,S)},a.prototype.listenerCount=p;function p(g){var S=this._events;if(S!==void 0){var w=S[g];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function f(g,S){for(var w=new Array(S),T=0;T<S;++T)w[T]=g[T];return w}function b(g,S){for(;S+1<g.length;S++)g[S]=g[S+1];g.pop()}function x(g){for(var S=new Array(g.length),w=0;w<S.length;++w)S[w]=g[w].listener||g[w];return S}function m(g,S){return new Promise(function(w,T){function E(M){g.removeListener(S,_),T(M)}function _(){typeof g.removeListener=="function"&&g.removeListener("error",E),w([].slice.call(arguments))}y(g,S,_,{once:!0}),S!=="error"&&v(g,E,{once:!0})})}function v(g,S,w){typeof g.on=="function"&&y(g,"error",S,w)}function y(g,S,w,T){if(typeof g.on=="function")T.once?g.once(S,w):g.on(S,w);else if(typeof g.addEventListener=="function")g.addEventListener(S,function E(_){T.once&&g.removeEventListener(S,E),w(_)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof g)}return uo.exports}var tn=a2();let z0=!0,V0=!0;function No(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function Rr(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,s){if(o!==e)return i.apply(this,arguments);const c=l=>{const u=n(l);u&&(s.handleEvent?s.handleEvent(u):s(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,c),i.apply(this,[o,c])};const a=r.removeEventListener;r.removeEventListener=function(o,s){if(o!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(s))return a.apply(this,arguments);const c=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[o,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function o2(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(z0=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function s2(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(V0=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function H0(){if(typeof window=="object"){if(z0)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Yd(t,e){V0&&console.warn(t+" is deprecated, please use "+e+" instead.")}function c2(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=No(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=No(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=No(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function ff(t){return Object.prototype.toString.call(t)==="[object Object]"}function q0(t){return ff(t)?Object.keys(t).reduce(function(e,n){const r=ff(t[n]),i=r?q0(t[n]):t[n],a=r&&!Object.keys(i).length;return i===void 0||a?e:Object.assign(e,{[n]:i})},{}):t}function su(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?su(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{su(t,t.get(i),n)})}))}function mf(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const a=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&a.push(o)}),a.forEach(o=>{t.forEach(s=>{s.type===r&&s.trackId===o.id&&su(t,s,i)})}),i}const gf=H0;function W0(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const c={};return Object.keys(s).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof s[l]=="object"?s[l]:{ideal:s[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const d=function(h,p){return h?h+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(u.ideal!==void 0){c.optional=c.optional||[];let h={};typeof u.ideal=="number"?(h[d("min",l)]=u.ideal,c.optional.push(h),h={},h[d("max",l)]=u.ideal,c.optional.push(h)):(h[d("",l)]=u.ideal,c.optional.push(h))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",l)]=u.exact):["min","max"].forEach(h=>{u[h]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(h,l)]=u[h])})}),s.advanced&&(c.optional=(c.optional||[]).concat(s.advanced)),c},i=function(s,c){if(e.version>=61)return c(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const l=function(u,d,h){d in u&&!(h in u)&&(u[h]=u[d],delete u[d])};s=JSON.parse(JSON.stringify(s)),l(s.audio,"autoGainControl","googAutoGainControl"),l(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=r(s.audio)}if(s&&typeof s.video=="object"){let l=s.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete s.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(h=>{h=h.filter(f=>f.kind==="videoinput");let p=h.find(f=>d.some(b=>f.label.toLowerCase().includes(b)));return!p&&h.length&&d.includes("back")&&(p=h[h.length-1]),p&&(s.video.deviceId=l.exact?{exact:p.deviceId}:{ideal:p.deviceId}),s.video=r(s.video),gf("chrome: "+JSON.stringify(s)),c(s)})}s.video=r(s.video)}return gf("chrome: "+JSON.stringify(s)),c(s)},a=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(s,c,l){i(s,u=>{n.webkitGetUserMedia(u,c,d=>{l&&l(a(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,l=>s(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(a(u))))}}}function $0(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function G0(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",r=>{let i;t.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(o=>o.track&&o.track.id===r.track.id):i={track:r.track};const a=new Event("track");a.track=r.track,a.receiver=i,a.transceiver={receiver:i},a.streams=[n.stream],this.dispatchEvent(a)}),n.stream.getTracks().forEach(r=>{let i;t.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(o=>o.track&&o.track.id===r.id):i={track:r};const a=new Event("track");a.track=r,a.receiver=i,a.transceiver={receiver:i},a.streams=[n.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Rr(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function K0(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=i.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,s){let c=i.apply(this,arguments);return c||(c=e(this,o),this._senders.push(c)),c};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){a.apply(this,arguments);const s=this._senders.indexOf(o);s!==-1&&this._senders.splice(s,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(i){this._senders=this._senders||[],n.apply(this,[i]),i.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(i){this._senders=this._senders||[],r.apply(this,[i]),i.getTracks().forEach(a=>{const o=this._senders.find(s=>s.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(r=>r._pc=this),n},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Z0(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=n.apply(this,[]);return i.forEach(a=>a._pc=this),i});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){const i=this;return this._pc.getStats().then(a=>mf(a,i.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Rr(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(i=>mf(i,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const n=arguments[0];let r,i,a;return this.getSenders().forEach(o=>{o.track===n&&(r?a=!0:r=o)}),this.getReceivers().forEach(o=>(o.track===n&&(i?a=!0:i=o),o.track===n)),a||r&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Q0(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const s=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(s)===-1&&this._shimmedLocalStreams[o.id].push(s):this._shimmedLocalStreams[o.id]=[o,s],s};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(c=>{if(this.getSenders().find(l=>l.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();n.apply(this,arguments);const s=this.getSenders().filter(c=>o.indexOf(c)===-1);this._shimmedLocalStreams[a.id]=[a].concat(s)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const s=this._shimmedLocalStreams[o].indexOf(a);s!==-1&&this._shimmedLocalStreams[o].splice(s,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),i.apply(this,arguments)}}function J0(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Q0(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const l=n.apply(this);return this._reverseStreams=this._reverseStreams||{},l.map(u=>this._reverseStreams[u.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.getTracks().forEach(u=>{if(this.getSenders().find(d=>d.track===u))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[l.id]){const u=new t.MediaStream(l.getTracks());this._streams[l.id]=u,this._reverseStreams[u.id]=l,l=u}r.apply(this,[l])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[l.id]||l]),delete this._reverseStreams[this._streams[l.id]?this._streams[l.id].id:l.id],delete this._streams[l.id]},t.RTCPeerConnection.prototype.addTrack=function(l,u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(p=>p===l))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(p=>p.track===l))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[u.id];if(h)h.addTrack(l),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const p=new t.MediaStream([l]);this._streams[u.id]=p,this._reverseStreams[p.id]=u,this.addStream(p)}return this.getSenders().find(p=>p.track===l)};function a(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const p=l._reverseStreams[h],f=l._streams[p.id];d=d.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:d})}function o(l,u){let d=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const p=l._reverseStreams[h],f=l._streams[p.id];d=d.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:u.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],d={[l](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const f=a(this,p);h[0].apply(null,[f])},p=>{h[1]&&h[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>a(this,p))}};t.RTCPeerConnection.prototype[l]=d[l]});const s=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=o(this,arguments[0]),s.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:a(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(l){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!l._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(l._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let u;Object.keys(this._streams).forEach(d=>{this._streams[d].getTracks().find(h=>l.track===h)&&(u=this._streams[d])}),u&&(u.getTracks().length===1?this.removeStream(this._reverseStreams[u.id]):u.removeTrack(l.track),this.dispatchEvent(new Event("negotiationneeded")))}}function cu(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Y0(t,e){Rr(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var vf=Object.freeze({__proto__:null,fixNegotiationNeeded:Y0,shimAddTrackRemoveTrack:J0,shimAddTrackRemoveTrackWithNative:Q0,shimGetSendersWithDtmf:K0,shimGetUserMedia:W0,shimMediaStream:$0,shimOnTrack:G0,shimPeerConnection:cu,shimSenderReceiverGetStats:Z0});function X0(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,a,o){Yd("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(a,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,s,c){s in o&&!(c in o)&&(o[c]=o[s],delete o[s])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),a(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const s=o.apply(this,arguments);return i(s,"mozAutoGainControl","autoGainControl"),i(s,"mozNoiseSuppression","noiseSuppression"),s}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s,"autoGainControl","mozAutoGainControl"),i(s,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[s])}}}}function l2(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(n)})}function eb(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function lu(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=t.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,a,o]=arguments;return r.apply(this,[i||null]).then(s=>{if(e.version<53&&!a)try{s.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;s.forEach((l,u)=>{s.set(u,Object.assign({},l,{type:n[l.type]||l.type}))})}return s}).then(a,o)}}function tb(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function nb(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(r=>r._pc=this),n}),Rr(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function rb(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(e){Yd("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&e.getTracks().includes(n.track)&&this.removeTrack(n)})})}function ib(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function ab(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const r=n.length>0;r&&n.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=e.apply(this,arguments);if(r){const{sender:a}=i,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=n,a.sendEncodings=n,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return i})}function ob(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function sb(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function cb(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var bf=Object.freeze({__proto__:null,shimAddTransceiver:ab,shimCreateAnswer:cb,shimCreateOffer:sb,shimGetDisplayMedia:l2,shimGetParameters:ob,shimGetUserMedia:X0,shimOnTrack:eb,shimPeerConnection:lu,shimRTCDataChannel:ib,shimReceiverGetStats:nb,shimRemoveStream:rb,shimSenderGetStats:tb});function lb(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(r=>e.call(this,r,n)),n.getVideoTracks().forEach(r=>e.call(this,r,n))},t.RTCPeerConnection.prototype.addTrack=function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i&&i.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(e);if(n===-1)return;this._localStreams.splice(n,1);const r=e.getTracks();this.getSenders().forEach(i=>{r.includes(i.track)&&this.removeTrack(i)})})}}function ub(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,this.dispatchEvent(a)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(i=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(i)>=0)return;n._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,n.dispatchEvent(a)})}),e.apply(n,arguments)}}}function db(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,a=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(c,l){const u=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[u]);return l?(d.then(c,l),Promise.resolve()):d},e.createAnswer=function(c,l){const u=arguments.length>=2?arguments[2]:arguments[0],d=r.apply(this,[u]);return l?(d.then(c,l),Promise.resolve()):d};let s=function(c,l,u){const d=i.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d};e.setLocalDescription=s,s=function(c,l,u){const d=a.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.setRemoteDescription=s,s=function(c,l,u){const d=o.apply(this,[c]);return u?(d.then(l,u),Promise.resolve()):d},e.addIceCandidate=s}function hb(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(pb(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,r,i){e.mediaDevices.getUserMedia(n).then(r,i)}).bind(e))}function pb(t){return t&&t.video!==void 0?Object.assign({},t,{video:q0(t.video)}):t}function fb(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(n,r){if(n&&n.iceServers){const i=[];for(let a=0;a<n.iceServers.length;a++){let o=n.iceServers[a];o.urls===void 0&&o.url?(Yd("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,i.push(o)):i.push(n.iceServers[a])}n.iceServers=i}return new e(n,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function mb(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function gb(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const r=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):n.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveVideo===!0&&!i&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function vb(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var yf=Object.freeze({__proto__:null,shimAudioContext:vb,shimCallbacksAPI:db,shimConstraints:pb,shimCreateOfferLegacy:gb,shimGetUserMedia:hb,shimLocalStreamsAPI:lb,shimRTCIceServerUrls:fb,shimRemoteStreamsAPI:ub,shimTrackEventTransceiver:mb}),kf={exports:{}},wf;function u2(){return wf||(wf=1,function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,i)=>(i>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let a=8;a<r.length;a+=2)switch(r[a]){case"raddr":i.relatedAddress=r[a+1];break;case"rport":i.relatedPort=parseInt(r[a+1],10);break;case"tcptype":i.tcpType=r[a+1];break;case"ufrag":i.ufrag=r[a+1],i.usernameFragment=r[a+1];break;default:i[r[a]]===void 0&&(i[r[a]]=r[a+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const a=n.type;return r.push("typ"),r.push(a),a!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const a=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<a.length;o++)i=a[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const a=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?a.push(o+"="+n.parameters[o]):a.push(o)}),r+="a=fmtp:"+i+" "+a.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(a=>{r+="a=rtcp-fb:"+i+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},a=n.indexOf(":",r);return a>-1?(i.attribute=n.substring(r+1,a),i.value=n.substring(a+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(a=>{i+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],a=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&a?{usernameFragment:i.substring(12),password:a.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=e.splitLines(n)[0].split(" ");r.profile=i[2];for(let o=3;o<i.length;o++){const s=i[o],c=e.matchPrefix(n,"a=rtpmap:"+s+" ")[0];if(c){const l=e.parseRtpMap(c),u=e.matchPrefix(n,"a=fmtp:"+s+" ");switch(l.parameters=u.length?e.parseFmtp(u[0]):{},l.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+s+" ").map(e.parseRtcpFb),r.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(l.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(o=>{r.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(o=>{a.forEach(s=>{o.rtcpFeedback.find(c=>c.type===s.type&&c.parameter===s.parameter)||o.rtcpFeedback.push(s)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let a=0;return r.codecs.forEach(o=>{o.maxptime>a&&(a=o.maxptime)}),a>0&&(i+="a=maxptime:"+a+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),a=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(n,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),c=s.length>0&&s[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),i.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let p={ssrc:c,codecPayloadType:parseInt(h.parameters.apt,10)};c&&l&&(p.rtx={ssrc:l}),r.push(p),a&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(p))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(h=>{h.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const a=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=a.length>0,r.compound=a.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const a=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(a.length>0)return r=a[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let a;i.length>0&&(a=parseInt(i[0].substring(19),10)),isNaN(a)&&(a=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:a};const s=e.matchPrefix(n,"a=sctpmap:");if(s.length>0){const c=s[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:a}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let a;const o=r!==void 0?r:2;return n?a=n:a=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+a+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let a=0;a<i.length;a++)switch(i[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[a].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e}(kf)),kf.exports}var bb=u2(),oi=YT(bb),d2=TS({__proto__:null,default:oi},[bb]);function Lo(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){const r=new e(n),i=oi.parseCandidate(n.candidate);for(const a in i)a in r||Object.defineProperty(r,a,{value:i[a]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(n)},t.RTCIceCandidate.prototype=e.prototype,Rr(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function uu(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Rr(t,"icecandidate",e=>{if(e.candidate){const n=oi.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Do(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(s){if(!s||!s.sdp)return!1;const c=oi.splitSections(s.sdp);return c.shift(),c.some(l=>{const u=oi.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(s){const c=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(s){let c=65536;return e.browser==="firefox"&&(e.version<57?s===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},a=function(s,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=oi.matchPrefix(s.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:s}=this.getConfiguration();s==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const s=r(arguments[0]),c=i(s),l=a(arguments[0],s);let u;c===0&&l===0?u=Number.POSITIVE_INFINITY:c===0||l===0?u=Math.max(c,l):u=Math.min(c,l);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return u}}),this._sctp=d}return o.apply(this,arguments)}}function Ao(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const a=r.send;r.send=function(){const o=arguments[0],s=o.length||o.size||o.byteLength;if(r.readyState==="open"&&i.sctp&&s>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return a.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},Rr(t,"datachannel",r=>(e(r.channel,r.target),r))}function du(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const a=i.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const o=new Event("connectionstatechange",i);a.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function hu(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const i=r.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:i}):r.sdp=i}return n.apply(this,arguments)}}function jo(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Uo(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(i=>n.apply(this,[i]))})}var h2=Object.freeze({__proto__:null,removeExtmapAllowMixed:hu,shimAddIceCandidateNullOrEmpty:jo,shimConnectionState:du,shimMaxMessageSize:Do,shimParameterlessSetLocalDescription:Uo,shimRTCIceCandidate:Lo,shimRTCIceCandidateRelayProtocol:uu,shimSendThrowTypeError:Ao});function p2(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=H0,r=c2(t),i={browserDetails:r,commonShim:h2,extractVersion:No,disableLog:o2,disableWarnings:s2,sdp:d2};switch(r.browser){case"chrome":if(!vf||!cu||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=vf,jo(t,r),Uo(t),W0(t,r),$0(t),cu(t,r),G0(t),J0(t,r),K0(t),Z0(t),Y0(t,r),Lo(t),uu(t),du(t),Do(t,r),Ao(t),hu(t,r);break;case"firefox":if(!bf||!lu||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=bf,jo(t,r),Uo(t),X0(t,r),lu(t,r),eb(t),rb(t),tb(t),nb(t),ib(t),ab(t),ob(t),sb(t),cb(t),Lo(t),du(t),Do(t,r),Ao(t);break;case"safari":if(!yf||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=yf,jo(t,r),Uo(t),fb(t),gb(t),db(t),lb(t),ub(t),mb(t),hb(t),vb(t),Lo(t),uu(t),Do(t,r),Ao(t),hu(t,r);break;default:n("Unsupported browser!");break}return i}p2({window:typeof window>"u"?void 0:window});const f2=10,ho="lk_e2ee",m2="LKFrameEncryptionKey",g2={sharedKey:!1,ratchetSalt:m2,ratchetWindowSize:8,failureTolerance:f2,keyringSize:16};var zn;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(zn||(zn={}));var Cf;(function(t){t.KeyRatcheted="keyRatcheted"})(Cf||(Cf={}));var Mn;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Mn||(Mn={}));var Sf;(function(t){t.Error="cryptorError"})(Sf||(Sf={}));function v2(){return b2()||pu()}function pu(){return typeof window.RTCRtpScriptTransform<"u"}function b2(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class HE extends tn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{$.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},g2),e),this.on(zn.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(zn.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(zn.RatchetRequest,e,n)}}class Qn extends Error{constructor(e,n){super(n||"an error has occured"),this.name="LiveKitError",this.code=e}}var K;(function(t){t[t.NotAllowed=0]="NotAllowed",t[t.ServerUnreachable=1]="ServerUnreachable",t[t.InternalError=2]="InternalError",t[t.Cancelled=3]="Cancelled",t[t.LeaveRequest=4]="LeaveRequest"})(K||(K={}));class se extends Qn{constructor(e,n,r,i){super(1,e),this.name="ConnectionError",this.status=r,this.reason=n,this.context=i,this.reasonName=K[n]}}class Xd extends Qn{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class cn extends Qn{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class y2 extends Qn{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class Pe extends Qn{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class fu extends Qn{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class k2 extends Qn{constructor(e,n){super(15,e),this.name="PublishTrackError",this.status=n}}class Tf extends Qn{constructor(e,n){super(15,e),this.reason=n,this.reasonName=typeof n=="string"?n:Jd[n]}}var Ss;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(Ss||(Ss={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(Ss||(Ss={}));var xf;(function(t){t[t.InvalidKey=0]="InvalidKey",t[t.MissingKey=1]="MissingKey",t[t.InternalError=2]="InternalError"})(xf||(xf={}));var N;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.ParticipantAttributesChanged="participantAttributesChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged",t.ChatMessage="chatMessage",t.LocalTrackSubscribed="localTrackSubscribed",t.MetricsReceived="metricsReceived"})(N||(N={}));var A;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded",t.AttributesChanged="attributesChanged",t.LocalTrackSubscribed="localTrackSubscribed",t.ChatMessage="chatMessage"})(A||(A={}));var D;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackSubscribed="localTrackSubscribed",t.Offline="offline",t.SignalRequestResponse="signalRequestResponse"})(D||(D={}));var L;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed",t.TrackProcessorUpdate="trackProcessorUpdate",t.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",t.TranscriptionReceived="transcriptionReceived",t.TimeSyncUpdate="timeSyncUpdate"})(L||(L={}));function w2(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const C2=/version\/(\d+(\.?_?\d+)+)/i;let Uc;function Vt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Uc===void 0||e){const r=S2.find(i=>{let{test:a}=i;return a.test(n)});Uc=r==null?void 0:r.describe(n)}return Uc}const S2=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Fo(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:Fc(t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Fo(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0,osVersion:Fc(t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Fo(C2,t),os:t.includes("mobile/")?"iOS":"macOS",osVersion:Fc(t)}}}];function Fo(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}function Fc(t){return t.includes("mac os")?Fo(/\(.+?(\d+_\d+(:?_\d+)?)/,t,1).replace(/_/g,"."):void 0}var T2="2.10.0";const x2=T2,E2=15;class Ue{}Ue.setTimeout=function(){return setTimeout(...arguments)};Ue.setInterval=function(){return setInterval(...arguments)};Ue.clearTimeout=function(){return clearTimeout(...arguments)};Ue.clearInterval=function(){return clearInterval(...arguments)};const P2=5e3,zi=[];var Ct;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH"})(Ct||(Ct={}));class I extends tn.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=I.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=$,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),P2):this.handleAppVisibilityChanged()},this.log=vn((i=r.loggerName)!==null&&i!==void 0?i:zt.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=I.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),te(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===I.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===I.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(zi.forEach(a=>{a.parentElement===null&&!e&&(e=a)}),e&&zi.splice(zi.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Qr(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(a=>a.kind==="audio");return e.play().then(()=>{this.emit(i?L.AudioPlaybackStarted:L.VideoPlaybackStarted)}).catch(a=>{a.name==="NotAllowedError"?this.emit(i?L.AudioPlaybackFailed:L.VideoPlaybackFailed,a):a.name==="AbortError"?$.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):$.warn("could not playback ".concat(i?"audio":"video"),a),i&&e&&r.some(o=>o.kind==="video")&&a.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(L.ElementAttached,e),e}detach(e){try{if(e){si(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(L.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{si(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(L.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=vn(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),zi.forEach(r=>{r.parentElement||(n=!1)}),n&&zi.push(e)}}handleAppVisibilityChanged(){return k(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===I.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){rt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){rt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Qr(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!$n()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,($n()||yi())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function si(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(l){switch(l){case e.Audio:return Dt.AUDIO;case e.Video:return Dt.VIDEO;default:return Dt.DATA}}t.kindToProto=i;function a(l){switch(l){case Dt.AUDIO:return e.Audio;case Dt.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=a;function o(l){switch(l){case n.Camera:return xe.CAMERA;case n.Microphone:return xe.MICROPHONE;case n.ScreenShare:return xe.SCREEN_SHARE;case n.ScreenShareAudio:return xe.SCREEN_SHARE_AUDIO;default:return xe.UNKNOWN}}t.sourceToProto=o;function s(l){switch(l){case xe.CAMERA:return n.Camera;case xe.MICROPHONE:return n.Microphone;case xe.SCREEN_SHARE:return n.ScreenShare;case xe.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=s;function c(l){switch(l){case nu.ACTIVE:return r.Active;case nu.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(I||(I={}));class ie{constructor(e,n,r,i,a){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&r!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:r,maxFramerate:i,priority:a};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const R2=["vp8","h264"],I2=["vp8","h264","vp9","av1"];function _2(t){return!!R2.find(e=>e===t)}var Ef;(function(t){t[t.PREFER_REGRESSION=0]="PREFER_REGRESSION",t[t.SIMULCAST=1]="SIMULCAST",t[t.REGRESSION=2]="REGRESSION"})(Ef||(Ef={}));var mu;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:24e3},t.music={maxBitrate:48e3},t.musicStereo={maxBitrate:64e3},t.musicHighQuality={maxBitrate:96e3},t.musicHighQualityStereo={maxBitrate:128e3}})(mu||(mu={}));const La={h90:new ie(160,90,9e4,20),h180:new ie(320,180,16e4,20),h216:new ie(384,216,18e4,20),h360:new ie(640,360,45e4,20),h540:new ie(960,540,8e5,25),h720:new ie(1280,720,17e5,30),h1080:new ie(1920,1080,3e6,30),h1440:new ie(2560,1440,5e6,30),h2160:new ie(3840,2160,8e6,30)},gu={h120:new ie(160,120,7e4,20),h180:new ie(240,180,125e3,20),h240:new ie(320,240,14e4,20),h360:new ie(480,360,33e4,20),h480:new ie(640,480,5e5,20),h540:new ie(720,540,6e5,25),h720:new ie(960,720,13e5,30),h1080:new ie(1440,1080,23e5,30),h1440:new ie(1920,1440,38e5,30)},eh={h360fps3:new ie(640,360,2e5,3,"medium"),h360fps15:new ie(640,360,4e5,15,"medium"),h720fps5:new ie(1280,720,8e5,5,"medium"),h720fps15:new ie(1280,720,15e5,15,"medium"),h720fps30:new ie(1280,720,2e6,30,"medium"),h1080fps15:new ie(1920,1080,25e5,15,"medium"),h1080fps30:new ie(1920,1080,5e6,30,"medium"),original:new ie(0,0,7e6,30,"medium")},O2="|",Pf="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function M2(t){const e=t.split(O2);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function st(t){return k(this,void 0,void 0,function*(){return new Promise(e=>Ue.setTimeout(e,t))})}function vu(){return"addTransceiver"in RTCPeerConnection.prototype}function bu(){return"addTrack"in RTCPeerConnection.prototype}function N2(){if(!("getCapabilities"in RTCRtpSender)||$n())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function L2(){if(!("getCapabilities"in RTCRtpSender)||yi())return!1;if($n()){const n=Vt();if(n!=null&&n.version&&Tr(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function ua(t){return t==="av1"||t==="vp9"}function yu(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}function D2(){return typeof RTCPeerConnection>"u"?!1:vu()||bu()}function yi(){var t;return((t=Vt())===null||t===void 0?void 0:t.name)==="Firefox"}function $n(){var t;return((t=Vt())===null||t===void 0?void 0:t.name)==="Safari"}function A2(){const t=Vt();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function yb(){var t,e;return rt()?(e=(t=navigator.userAgentData)===null||t===void 0?void 0:t.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function j2(){const t=Vt(),e="17.2";if(t)return t.name!=="Safari"&&t.os!=="iOS"||t.os==="iOS"&&t.osVersion&&Tr(e,t.osVersion)>=0?!0:t.name==="Safari"&&Tr(e,t.version)>=0}function rt(){return typeof document<"u"}function en(){return navigator.product=="ReactNative"}function ku(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function kb(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function wb(){if(!en())return;let t=kb();if(t)return t.platform}function Rf(){if(rt())return window.devicePixelRatio;if(en()){let t=kb();if(t)return t.devicePixelRatio}return 1}function Tr(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let a=0;a<i;++a){const o=parseInt(n[a],10),s=parseInt(r[a],10);if(o>s)return 1;if(o<s)return-1;if(a===i-1&&o===s)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function U2(t){for(const e of t)e.target.handleResize(e)}function F2(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Bc=null;const If=()=>(Bc||(Bc=new ResizeObserver(U2)),Bc);let zc=null;const _f=()=>(zc||(zc=new IntersectionObserver(F2,{root:null,rootMargin:"0px"})),zc);function B2(){var t;const e=new RT({sdk:E0.JS,protocol:E2,version:x2});return en()&&(e.os=(t=wb())!==null&&t!==void 0?t:""),e}function Of(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const a=i.getContext("2d");a==null||a.fillRect(0,0,i.width,i.height),r&&a&&(a.beginPath(),a.arc(t/2,e/2,50,0,Math.PI*2,!0),a.closePath(),a.fillStyle="grey",a.fill());const o=i.captureStream(),[s]=o.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}let Vi;function Vc(){if(!Vi){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[Vi]=r.stream.getAudioTracks(),!Vi)throw Error("Could not get empty media stream audio track");Vi.enabled=!1}return Vi.clone()}class Cb{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>k(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function z2(t){return I2.includes(t)}function Vn(t){if(typeof t=="string"||typeof t=="number")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function wu(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}function V2(t,e){return t.segments.map(n=>{let{id:r,text:i,language:a,startTime:o,endTime:s,final:c}=n;var l;const u=(l=e.get(r))!==null&&l!==void 0?l:Date.now(),d=Date.now();return c?e.delete(r):e.set(r,u),{id:r,text:i,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(s.toString()),final:c,language:a,firstReceivedTime:u,lastReceivedTime:d}})}function H2(t){const{id:e,timestamp:n,message:r,editTimestamp:i}=t;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:i?Number.parseInt(i.toString()):void 0,message:r}}function Mf(t){switch(t.reason){case K.LeaveRequest:return t.context;case K.Cancelled:return jt.CLIENT_INITIATED;case K.NotAllowed:return jt.USER_REJECTED;case K.ServerUnreachable:return jt.JOIN_FAILURE;default:return jt.UNKNOWN_REASON}}function Bo(t){return t!==void 0?Number(t):void 0}function rr(t){return t!==void 0?BigInt(t):void 0}function ci(t){return!!t&&!(t instanceof MediaStreamTrack)&&t.isLocal}function bn(t){return!!t&&t.kind==I.Kind.Audio}function xi(t){return!!t&&t.kind==I.Kind.Video}function Cn(t){return ci(t)&&xi(t)}function ir(t){return ci(t)&&bn(t)}function Cu(t){return!!t&&!t.isLocal}function q2(t){return!!t&&!t.isLocal}function Hc(t){return Cu(t)&&xi(t)}function W2(t){return t.isLocal}function $2(t,e){const n=[];let r=new TextEncoder().encode(t);for(;r.length>e;){let i=e;for(;i>0;){const a=r[i];if(a!==void 0&&(a&192)!==128)break;i--}n.push(r.slice(0,i)),r=r.slice(i)}return r.length>0&&n.push(r),n}function Sb(t,e,n){var r,i,a,o,s;const{optionsWithoutProcessor:c,audioProcessor:l,videoProcessor:u}=th(t??{}),d=e==null?void 0:e.processor,h=n==null?void 0:n.processor,p=(r=w2(c))!==null&&r!==void 0?r:{};return p.audio===!0&&(p.audio={}),p.video===!0&&(p.video={}),p.audio&&(Su(p.audio,e),(i=(o=p.audio).deviceId)!==null&&i!==void 0||(o.deviceId="default"),(l||d)&&(p.audio.processor=l??d)),p.video&&(Su(p.video,n),(a=(s=p.video).deviceId)!==null&&a!==void 0||(s.deviceId="default"),(u||h)&&(p.video.processor=u??h)),p}function Su(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function ec(t){var e,n,r,i;const a={};if(t.video)if(typeof t.video=="object"){const o={},s=o,c=t.video;Object.keys(c).forEach(l=>{switch(l){case"resolution":Su(s,c.resolution);break;default:s[l]=c[l]}}),a.video=o,(e=(r=a.video).deviceId)!==null&&e!==void 0||(r.deviceId="default")}else a.video=t.video?{deviceId:"default"}:!1;else a.video=!1;return t.audio?typeof t.audio=="object"?(a.audio=t.audio,(n=(i=a.audio).deviceId)!==null&&n!==void 0||(i.deviceId="default")):a.audio={deviceId:"default"}:a.audio=!1,a}function Tb(t){return k(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=xb();if(r){const i=r.createAnalyser();i.fftSize=2048;const a=i.frequencyBinCount,o=new Uint8Array(a);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield st(n),i.getByteTimeDomainData(o);const s=o.some(c=>c!==128&&c!==0);return r.close(),!s}return!1}()})}function xb(){var t;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const n=new e({latencyHint:"interactive"});if(n.state==="suspended"&&typeof window<"u"&&!((t=window.document)===null||t===void 0)&&t.body){const r=()=>k(this,void 0,void 0,function*(){var i;try{n.state==="suspended"&&(yield n.resume())}catch(a){console.warn("Error trying to auto-resume audio context",a)}(i=window.document.body)===null||i===void 0||i.removeEventListener("click",r)});window.document.body.addEventListener("click",r)}return n}}function Nf(t){return t===I.Source.Microphone?"audioinput":t===I.Source.Camera?"videoinput":void 0}function G2(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,$n()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio,preferCurrentTab:t.preferCurrentTab}}function zo(t){return t.split("/")[1].toLowerCase()}function K2(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new Zd({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function te(t){return"mediaStreamTrack"in t?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?te(t.track):{})}}function Z2(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function Q2(t,e){var n;t===void 0&&(t={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(t)],i={};for(const a of r)t[a]!==e[a]&&(i[a]=(n=e[a])!==null&&n!==void 0?n:"");return i}function th(t){const e=Object.assign({},t);let n,r;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:r,optionsWithoutProcessor:e}}function J2(t){switch(t){case xe.CAMERA:return I.Source.Camera;case xe.MICROPHONE:return I.Source.Microphone;case xe.SCREEN_SHARE:return I.Source.ScreenShare;case xe.SCREEN_SHARE_AUDIO:return I.Source.ScreenShareAudio;default:return I.Source.Unknown}}class Y2 extends tn.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:a,data:o}=n.data;switch(a){case"error":$.error(o.error.message),this.emit(Mn.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(s=>{this.postKey(s)});break;case"enable":if(o.enabled&&this.keyProvider.getKeys().forEach(s=>{this.postKey(s)}),this.encryptionEnabled!==o.enabled&&o.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Mn.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const s=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(o.participantIdentity);if(!s)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(Mn.ParticipantEncryptionStatusChanged,o.enabled,s)}break;case"ratchetKey":this.keyProvider.emit(zn.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{$.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Mn.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!v2())throw new Xd("tried to setup end-to-end encryption on an unsupported browser");if($.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:t2.getLevel()}};this.worker&&($.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){$.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?$.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(D.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(N.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==lt.NONE,i.identity)),e.on(N.ConnectionStateChanged,r=>{r===Y.Connected&&e.remoteParticipants.forEach(i=>{i.trackPublications.forEach(a=>{this.setParticipantCryptorEnabled(a.trackInfo.encryption!==lt.NONE,i.identity)})})}).on(N.TrackUnsubscribed,(r,i,a)=>{var o;const s={kind:"removeTransform",data:{participantIdentity:a.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(s)}).on(N.TrackSubscribed,(r,i,a)=>{this.setupE2EEReceiver(r,a.identity,i.trackInfo)}).on(N.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(A.LocalTrackPublished,r=>k(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(zn.SetKey,r=>this.postKey(r)).on(zn.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var a;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((a=this.room)===null||a===void 0?void 0:a.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?zo(r.mimeType):void 0)}}setupE2EESender(e,n){if(!ci(e)||!n){n||$.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return k(this,void 0,void 0,function*(){if(this.worker){if(pu()){const a={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{if(ho in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let a=e.writableStream,o=e.readableStream;if(!a||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,a=c.writable,e.readableStream=c.readable,o=c.readable}const s={kind:"decode",data:{readableStream:o,writableStream:a,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(s,[o,a])}e[ho]=!0}})}handleSender(e,n,r){var i;if(!(ho in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(pu()){$.info("initialize script transform");const a={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{$.info("initialize encoded streams");const a=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:a.readable,writableStream:a.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[a.readable,a.writable])}e[ho]=!0}}}const qc="default";class Me{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new Me),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return k(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;if(((a=Me.userMediaPromiseMap)===null||a===void 0?void 0:a.size)>0){$.debug("awaiting getUserMedia promise");try{n?yield Me.userMediaPromiseMap.get(n):yield Promise.all(Me.userMediaPromiseMap.values())}catch{$.warn("error waiting for media permissons")}}let o=yield navigator.mediaDevices.enumerateDevices();if(i&&!($n()&&r.hasDeviceInUse(n))&&(o.filter(s=>s.kind===n).length===0||o.some(s=>{const c=s.label==="",l=n?s.kind===n:!0;return c&&l}))){const s={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:"default"}},c=yield navigator.mediaDevices.getUserMedia(s);o=yield navigator.mediaDevices.enumerateDevices(),c.getTracks().forEach(l=>{l.stop()})}return r._previousDevices=o,n&&(o=o.filter(s=>s.kind===n)),o}()})}normalizeDeviceId(e,n,r){return k(this,void 0,void 0,function*(){if(n!==qc)return n;const i=yield this.getDevices(e),a=i.find(s=>s.deviceId===qc);if(!a){$.warn("could not reliably determine default device");return}const o=i.find(s=>s.deviceId!==qc&&s.groupId===(r??a.groupId));if(!o){$.warn("could not reliably determine default device");return}return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?Me.userMediaPromiseMap.has(e):Me.userMediaPromiseMap.size>0}}Me.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Me.userMediaPromiseMap=new Map;var da;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(da||(da={}));class X2{constructor(){this.pendingTasks=new Map,this.taskMutex=new dt,this.nextTaskIndex=0}run(e){return k(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:da.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=da.RUNNING,yield e()}finally{n.status=da.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return k(this,void 0,void 0,function*(){return this.run(()=>k(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function ex(t,e){const n=new URL(t);return e.forEach((r,i)=>{n.searchParams.set(i,r)}),Eb(n,"rtc")}function tx(t){const e=new URL(wu(t));return Eb(e,"validate")}function nx(t){return t.endsWith("/")?t:"".concat(t,"/")}function Eb(t,e){const n="".concat(t.protocol,"//").concat(t.host).concat(nx(t.pathname)).concat(e);return t.searchParams.size>0?"".concat(n,"?").concat(t.searchParams.toString()):n}const rx=["syncState","trickle","offer","answer","simulate","leave"];function ix(t){const e=rx.indexOf(t.case)>=0;return $.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var de;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(de||(de={}));class nh{get currentState(){return this.state}get isDisconnected(){return this.state===de.DISCONNECTING||this.state===de.DISCONNECTED}get isEstablishingConnection(){return this.state===de.CONNECTING||this.state===de.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=de.DISCONNECTED,this.log=$,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=vn((r=n.loggerName)!==null&&r!==void 0?r:zt.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new X2,this.queuedRequests=[],this.closingLock=new dt,this.connectionLock=new dt,this.state=de.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return k(this,void 0,void 0,function*(){return this.state=de.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return k(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=de.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r;const a=B2(),o=ax(n,a,r),s=ex(e,o),c=tx(s);return new Promise((l,u)=>k(this,void 0,void 0,function*(){const d=yield this.connectionLock.lock();try{const h=()=>k(this,void 0,void 0,function*(){this.close(),clearTimeout(p),u(new se("room connection has been cancelled (signal)",K.Cancelled))}),p=setTimeout(()=>{this.close(),u(new se("room connection has timed out (signal)",K.ServerUnreachable))},r.websocketTimeout);i!=null&&i.aborted&&h(),i==null||i.addEventListener("abort",h);const f=new URL(s);f.searchParams.has("access_token")&&f.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(f),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(p)},this.ws.onerror=b=>k(this,void 0,void 0,function*(){if(this.state!==de.CONNECTED){this.state=de.DISCONNECTED,clearTimeout(p);try{const x=yield fetch(c);if(x.status.toFixed(0).startsWith("4")){const m=yield x.text();u(new se(m,K.NotAllowed,x.status))}else u(new se("Encountered unknown websocket error during connection: ".concat(b.toString()),K.InternalError,x.status))}catch(x){u(new se(x instanceof Error?x.message:"server was not reachable",K.ServerUnreachable))}return}this.handleWSError(b)}),this.ws.onmessage=b=>k(this,void 0,void 0,function*(){var x,m,v;let y;if(typeof b.data=="string"){const g=JSON.parse(b.data);y=uf.fromJson(g,{ignoreUnknownFields:!0})}else if(b.data instanceof ArrayBuffer)y=uf.fromBinary(new Uint8Array(b.data));else{this.log.error("could not decode websocket message: ".concat(typeof b.data),this.logContext);return}if(this.state!==de.CONNECTED){let g=!1;if(((x=y.message)===null||x===void 0?void 0:x.case)==="join"?(this.state=de.CONNECTED,i==null||i.removeEventListener("abort",h),this.pingTimeoutDuration=y.message.value.pingTimeout,this.pingIntervalDuration=y.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),l(y.message.value)):this.state===de.RECONNECTING&&y.message.case!=="leave"?(this.state=de.CONNECTED,i==null||i.removeEventListener("abort",h),this.startPingInterval(),((m=y.message)===null||m===void 0?void 0:m.case)==="reconnect"?l(y.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),l(void 0),g=!0)):this.isEstablishingConnection&&y.message.case==="leave"?u(new se("Received leave request while trying to (re)connect",K.LeaveRequest,void 0,y.message.value.reason)):r.reconnect||u(new se("did not receive join response, got ".concat((v=y.message)===null||v===void 0?void 0:v.case," instead"),K.InternalError)),!g)return}this.signalLatency&&(yield st(this.signalLatency)),this.handleSignalResponse(y)}),this.ws.onclose=b=>{this.isEstablishingConnection&&u(new se("Websocket got closed during a (re)connection attempt",K.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:b.reason,code:b.code,wasClean:b.wasClean,state:this.state})),this.handleOnClose(b.reason)}}finally{d()}}))}close(){return k(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=de.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const i=new Promise(a=>{e.ws?e.ws.onclose=()=>{a()}:a()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([i,st(250)])),e.ws=void 0}}finally{n&&(e.state=de.DISCONNECTED),r()}}()})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Ts(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Ts(e)})}sendIceCandidate(e,n){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Gd({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new Kd({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return k(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const s=a.getNextRequestId();return yield a.sendRequest({case:"updateMetadata",value:new L0({requestId:s,metadata:r,name:i,attributes:o})}),s}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new N0({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new j0({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:pe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new B0({timestamp:pe.parse(Date.now()),rtt:pe.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new M0({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new Ys({reason:jt.CLIENT_INITIATED,action:ai.DISCONNECT})})}sendRequest(e){return k(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!i&&!ix(n)&&r.state===de.RECONNECTING){r.queuedRequests.push(()=>k(r,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(i||(yield r.requestQueue.flush()),r.signalLatency&&(yield st(r.signalLatency)),!r.ws||r.ws.readyState!==r.ws.OPEN){r.log.error("cannot send signal request before connected, type: ".concat(n==null?void 0:n.case),r.logContext);return}const a=new OT({message:n});try{r.useJSON?r.ws.send(a.toJsonString()):r.ws.send(a.toBinary())}catch(o){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:o}))}}()})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let a=!1;if(i.case==="answer"){const o=Lf(i.value);this.onAnswer&&this.onAnswer(o)}else if(i.case==="offer"){const o=Lf(i.value);this.onOffer&&this.onOffer(o)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),a=!0):i.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(i.value):i.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));a||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return k(this,void 0,void 0,function*(){if(this.state===de.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Ue.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Ue.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Ue.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Ue.clearInterval(this.pingInterval)}}function Lf(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Ts(t){return new Sr({sdp:t.sdp,type:t.type})}function ax(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",en()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),i}var Rt={},Df={},Wc={exports:{}},Af;function rh(){if(Af)return Wc.exports;Af=1;var t=Wc.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(t).forEach(function(e){var n=t[e];n.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),Wc.exports}var jf;function ox(){return jf||(jf=1,function(t){var e=function(s){return String(Number(s))===s?Number(s):s},n=function(s,c,l,u){if(u&&!l)c[u]=e(s[1]);else for(var d=0;d<l.length;d+=1)s[d+1]!=null&&(c[l[d]]=e(s[d+1]))},r=function(s,c,l){var u=s.name&&s.names;s.push&&!c[s.push]?c[s.push]=[]:u&&!c[s.name]&&(c[s.name]={});var d=s.push?{}:u?c[s.name]:c;n(l.match(s.reg),d,s.names,s.name),s.push&&c[s.push].push(d)},i=rh(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(s){var c={},l=[],u=c;return s.split(/(\r\n|\r|\n)/).filter(a).forEach(function(d){var h=d[0],p=d.slice(2);h==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var f=0;f<(i[h]||[]).length;f+=1){var b=i[h][f];if(b.reg.test(p))return r(b,u,p)}}),c.media=l,c};var o=function(s,c){var l=c.split(/=(.+)/,2);return l.length===2?s[l[0]]=e(l[1]):l.length===1&&c.length>1&&(s[l[0]]=void 0),s};t.parseParams=function(s){return s.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(s){return s.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(s){for(var c=[],l=s.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(s){return s.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(s){return s.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}}(Df)),Df}var $c,Uf;function sx(){if(Uf)return $c;Uf=1;var t=rh(),e=/%[sdv%]/g,n=function(o){var s=1,c=arguments,l=c.length;return o.replace(e,function(u){if(s>=l)return u;var d=c[s];switch(s+=1,u){case"%%":return"%";case"%s":return String(d);case"%d":return Number(d);case"%v":return""}})},r=function(o,s,c){var l=s.format instanceof Function?s.format(s.push?c:c[s.name]):s.format,u=[o+"="+l];if(s.names)for(var d=0;d<s.names.length;d+=1){var h=s.names[d];s.name?u.push(c[s.name][h]):u.push(c[s.names[d]])}else u.push(c[s.name]);return n.apply(null,u)},i=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];return $c=function(o,s){s=s||{},o.version==null&&(o.version=0),o.name==null&&(o.name=" "),o.media.forEach(function(d){d.payloads==null&&(d.payloads="")});var c=s.outerOrder||i,l=s.innerOrder||a,u=[];return c.forEach(function(d){t[d].forEach(function(h){h.name in o&&o[h.name]!=null?u.push(r(d,h,o)):h.push in o&&o[h.push]!=null&&o[h.push].forEach(function(p){u.push(r(d,h,p))})})}),o.media.forEach(function(d){u.push(r("m",t.m[0],d)),l.forEach(function(h){t[h].forEach(function(p){p.name in d&&d[p.name]!=null?u.push(r(h,p,d)):p.push in d&&d[p.push]!=null&&d[p.push].forEach(function(f){u.push(r(h,p,f))})})})}),u.join(`\r
`)+`\r
`},$c}var Ff;function cx(){if(Ff)return Rt;Ff=1;var t=ox(),e=sx(),n=rh();return Rt.grammar=n,Rt.write=e,Rt.parse=t.parse,Rt.parseParams=t.parseParams,Rt.parseFmtpConfig=t.parseFmtpConfig,Rt.parsePayloads=t.parsePayloads,Rt.parseRemoteCandidates=t.parseRemoteCandidates,Rt.parseImageAttributes=t.parseImageAttributes,Rt.parseSimulcastStreamList=t.parseSimulcastStreamList,Rt}var Sn=cx();function ih(t,e,n){var r,i,a;e===void 0&&(e=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,s=(i=n.callback)!=null&&i,c=n.maxWait,l=Date.now(),u=[];function d(){if(c!==void 0){var p=Date.now()-l;if(p+e>=c)return c-p}return e}var h=function(){var p=[].slice.call(arguments),f=this;return new Promise(function(b,x){var m=o&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,l=Date.now(),!o){var y=t.apply(f,p);s&&s(y),u.forEach(function(g){return(0,g.resolve)(y)}),u=[]}},d()),m){var v=t.apply(f,p);return s&&s(v),b(v)}u.push({resolve:b,reject:x})})};return h.cancel=function(p){a!==void 0&&clearTimeout(a),u.forEach(function(f){return(0,f.reject)(p)}),u=[]},h}const lx=.7,ux=20,li={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class Bf extends tn.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=$,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=ih(i=>k(this,void 0,void 0,function*(){this.emit(li.NegotiationStarted);try{yield this.createAndSendOffer()}catch(a){if(i)i(a);else throw a}}),ux),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=vn((r=n.loggerName)!==null&&r!==void 0?r:zt.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC()}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return k(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return k(this,void 0,void 0,function*(){var n;let r;if(e.type==="offer"){let{stereoMids:i,nackMids:a}=dx(e);this.remoteStereoMids=i,this.remoteNackMids=a}else if(e.type==="answer"){const i=Sn.parse((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(a=>{a.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||a.mid!=o.transceiver.mid)return!1;let s=0;if(a.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(s=l.payload,!0):!1),s===0)return!0;let c=!1;for(const l of a.fmtp)if(l.payload===s){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),c=!0;break}return c||o.maxbr>0&&a.fmtp.push({payload:s,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),r=Sn.write(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(li.NegotiationComplete),e.sdp&&Sn.parse(e.sdp).media.forEach(i=>{i.type==="video"&&this.emit(li.RTPVideoPayloadTypes,i.rtp)}))})}createAndSendOffer(e){return k(this,void 0,void 0,function*(){var n;if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const a=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&a)yield this._pc.setRemoteDescription(a);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:r.sdp},this.logContext));const i=Sn.parse((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(a=>{Vf(a),a.type==="audio"?zf(a,[],[]):a.type==="video"&&this.trackBitrates.some(o=>{if(!a.msid||!o.cid||!a.msid.includes(o.cid))return!1;let s=0;if(a.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(s=l.payload,!0):!1),s===0||(ua(o.codec)&&this.ensureVideoDDExtensionForSVC(a,i),o.codec!=="av1"))return!0;const c=Math.round(o.maxbr*lx);for(const l of a.fmtp)if(l.payload===s){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(c));break}return!0})}),yield this.setMungedSDP(r,Sn.write(i)),this.onOffer(r)})}createAndSetAnswer(){return k(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),r=Sn.parse((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{Vf(i),i.type==="audio"&&zf(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Sn.write(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Pe("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Pe("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return k(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(o=>{switch(o.type){case"transport":n=o.selectedCandidatePairId;break;case"candidate-pair":n===""&&o.selected&&(n=o.id),r.set(o.id,o);break;case"remote-candidate":i.set(o.id,"".concat(o.address,":").concat(o.port));break}}),n==="")return;const a=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(a!==void 0)return i.get(a)})}setMungedSDP(e,n,r){return k(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(a){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:a,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let a="unknown error";i instanceof Error?a=i.message:typeof i=="string"&&(a=i);const o={error:a,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new fu(a)}})}ensureVideoDDExtensionForSVC(e,n){var r,i;if(!(!((r=e.ext)===null||r===void 0)&&r.some(a=>a.uri===Pf))){if(this.ddExtID===0){let a=0;n.media.forEach(o=>{var s;o.type==="video"&&((s=o.ext)===null||s===void 0||s.forEach(c=>{c.value>a&&(a=c.value)}))}),this.ddExtID=a+1}(i=e.ext)===null||i===void 0||i.push({value:this.ddExtID,uri:Pf})}}}function zf(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function dx(t){var e;const n=[],r=[],i=Sn.parse((e=t.sdp)!==null&&e!==void 0?e:"");let a=0;return i.media.forEach(o=>{var s;o.type==="audio"&&(o.rtp.some(c=>c.codec==="opus"?(a=c.payload,!0):!1),!((s=o.rtcpFb)===null||s===void 0)&&s.some(c=>c.payload===a&&c.type==="nack")&&r.push(o.mid),o.fmtp.some(c=>c.payload===a?(c.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:r}}function Vf(t){if(t.connection){const e=t.connection.ip.indexOf(":")>=0;(t.connection.version===4&&e||t.connection.version===6&&!e)&&(t.connection.ip="0.0.0.0",t.connection.version=4)}}const Tu="vp8",hx={audioPreset:mu.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:eh.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Tu,backupCodec:!0},Pb={deviceId:"default",autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},Rb={deviceId:"default",resolution:La.h720.resolution},px={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new r2,disconnectOnPageLeave:!0,webAudioMix:!1},ah={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var ye;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(ye||(ye={}));class fx{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=ah.peerConnectionTimeout,this.log=$,this.updateState=()=>{var a;const o=this.state,s=this.requiredTransports.map(c=>c.getConnectionState());s.every(c=>c==="connected")?this.state=ye.CONNECTED:s.some(c=>c==="failed")?this.state=ye.FAILED:s.some(c=>c==="connecting")?this.state=ye.CONNECTING:s.every(c=>c==="closed")?this.state=ye.CLOSED:s.some(c=>c==="closed")?this.state=ye.CLOSING:s.every(c=>c==="new")&&(this.state=ye.NEW),o!==this.state&&(this.log.debug("pc state change: from ".concat(ye[o]," to ").concat(ye[this.state]),this.logContext),(a=this.onStateChange)===null||a===void 0||a.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=vn((i=r.loggerName)!==null&&i!==void 0?i:zt.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n,this.publisher=new Bf(e,r),this.subscriber=new Bf(e,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,At.PUBLISHER)},this.subscriber.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,At.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var o;(o=this.onDataChannel)===null||o===void 0||o.call(this,a)},this.subscriber.onTrack=a=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,a)},this.publisher.onOffer=a=>{var o;(o=this.onPublisherOffer)===null||o===void 0||o.call(this,a)},this.state=ye.NEW,this.connectionLock=new dt,this.remoteOfferLock=new dt}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return k(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return k(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return k(this,void 0,void 0,function*(){n===At.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return k(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const n=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()}finally{n()}})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return k(this,void 0,void 0,function*(){var r;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(a=>this.ensureTransportConnected(a,e,n)))}finally{i()}})}negotiate(e){return k(this,void 0,void 0,function*(){return new Promise((n,r)=>k(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),a=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",a),this.publisher.once(li.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(li.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===At.PUBLISHER?this.publisher.getConnectedAddress():e===At.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return k(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((s,c)=>k(a,void 0,void 0,function*(){const l=()=>{this.log.warn("abort transport connection",this.logContext),Ue.clearTimeout(u),c(new se("room connection has been cancelled",K.Cancelled))};i!=null&&i.signal.aborted&&l(),i==null||i.signal.addEventListener("abort",l);const u=Ue.setTimeout(()=>{i==null||i.signal.removeEventListener("abort",l),c(new se("could not establish pc connection",K.InternalError))},o);for(;this.state!==ye.CONNECTED;)if(yield st(50),i!=null&&i.signal.aborted){c(new se("room connection has been cancelled",K.Cancelled));return}Ue.clearTimeout(u),i==null||i.signal.removeEventListener("abort",l),s()}))}()})}}class Ce extends Error{constructor(e,n,r){super(n),this.code=e,this.message=Hf(n,Ce.MAX_MESSAGE_BYTES),this.data=r?Hf(r,Ce.MAX_DATA_BYTES):void 0}static fromProto(e){return new Ce(e.code,e.message,e.data)}toProto(){return new S0({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new Ce(Ce.ErrorCode[e],Ce.ErrorMessage[e],n)}}Ce.MAX_MESSAGE_BYTES=256;Ce.MAX_DATA_BYTES=15360;Ce.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Ce.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const Ib=15360;function oh(t){return new TextEncoder().encode(t).length}function Hf(t,e){if(oh(t)<=e)return t;let n=0,r=t.length;const i=new TextEncoder;for(;n<r;){const a=Math.floor((n+r+1)/2);i.encode(t.slice(0,a)).length<=e?n=a:r=a-1}return t.slice(0,n)}const sh=2e3;function tc(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}const mx=1e3;class _b extends I{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=arguments.length>4?arguments[4]:void 0;super(e,n,a),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=ih(()=>k(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>k(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(L.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new dt,this.pauseUpstreamLock=new dt,this.processorLock=new dt,this.restartLock=new dt,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==I.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return k(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(a=>{si(this._mediaStreamTrack,a)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let i;if(this.processor&&e){const a=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Qr(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}finally{a()}}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(i??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(a=>{Qr(i??e,a)}))})}waitForDimensions(){return k(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mx;return function*(){var r;if(e.kind===I.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=Vt())===null||r===void 0?void 0:r.os)==="iOS"&&(yield st(10));const i=Date.now();for(;Date.now()-i<n;){const a=e.dimensions;if(a)return a;yield st(50)}throw new cn("unable to get track dimensions after timeout")}()})}setDeviceId(e){return k(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Vn(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Vn(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return k(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===I.Source.ScreenShare)return;const{deviceId:r,groupId:i}=e._mediaStreamTrack.getSettings(),a=e.kind===I.Kind.Audio?"audioinput":"videoinput";return n?Me.getInstance().normalizeDeviceId(a,r,i):r}()})}mute(){return k(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return k(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return k(this,void 0,void 0,function*(){if(!this.sender)throw new cn("unable to replace an unpublished track");let r,i;return typeof n=="boolean"?r=n:n!==void 0&&(r=n.userProvidedTrack,i=n.stopProcessor),this.providedByUser=r??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return k(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:i}=e,a=i2(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const o={audio:!1,video:!1};this.kind===I.Kind.Video?o.video=r||i?{deviceId:r,facingMode:i}:!0:o.audio=r?{deviceId:r}:!0,this.attachedElements.forEach(c=>{si(this.mediaStreamTrack,c)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const s=(yield navigator.mediaDevices.getUserMedia(o)).getTracks()[0];return yield s.applyConstraints(a),s.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(s),this._constraints=e,this.emit(L.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?L.Muted:L.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return k(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),yb()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return k(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(L.UpstreamPaused,this);const r=Vt();if((r==null?void 0:r.name)==="Safari"&&Tr(r.version,"12.0")<0)throw new Xd("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{n()}})}resumeUpstream(){return k(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(L.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{n()}})}getRTCStatsReport(){return k(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return k(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;const o=yield r.processorLock.lock();try{r.log.debug("setting up processor",r.logContext);const s=document.createElement(r.kind),c={kind:r.kind,track:r._mediaStreamTrack,element:s,audioContext:r.audioContext};if(yield n.init(c),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.stopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Qr(r._mediaStreamTrack,s),s.muted=!0,s.play().catch(l=>r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:l}))),r.processor=n,r.processorElement=s,r.processor.processedTrack){for(const l of r.attachedElements)l!==r.processorElement&&i&&(si(r._mediaStreamTrack,l),Qr(r.processor.processedTrack,l));yield(a=r.sender)===null||a===void 0?void 0:a.replaceTrack(r.processor.processedTrack)}r.emit(L.TrackProcessorUpdate,r.processor)}finally{o()}}()})}getProcessor(){return this.processor}stopProcessor(){return k(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,i;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,n||((i=e.processorElement)===null||i===void 0||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(L.TrackProcessorUpdate))}()})}}class xs extends _b{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;super(e,I.Kind.Audio,n,r,a),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>k(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(s){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:s}));return}o&&this.prevStats&&(this._currentBitrate=tc(o,this.prevStats)),this.prevStats=o}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(L.AudioTrackFeatureUpdate,this,Zt.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(L.AudioTrackFeatureUpdate,this,Zt.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return k(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===I.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return k(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Vn(this._constraints.deviceId);return this.source===I.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return k(this,void 0,void 0,function*(){let n;if(e){const r=ec({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return k(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){rt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},sh)))}setProcessor(e){return k(this,void 0,void 0,function*(){var n;const r=yield this.processorLock.lock();try{if(!en()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(L.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return k(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return k(this,void 0,void 0,function*(){const e=yield Tb(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(L.AudioSilenceDetected)),e})}}function Ob(t,e,n){switch(t.kind){case"audio":return new xs(t,e,!1,void 0,n);case"video":return new Ps(t,e,!1,n);default:throw new cn("unsupported track type: ".concat(t.kind))}}const gx=Object.values(La),vx=Object.values(gu),bx=Object.values(eh),yx=[La.h180,La.h360],kx=[gu.h180,gu.h360],wx=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(e=>{var n,r;return new ie(Math.floor(t.width/e.scaleResolutionDownBy),Math.floor(t.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*(((n=t.encoding.maxFramerate)!==null&&n!==void 0?n:30)/((r=e.fps)!==null&&r!==void 0?r:30))))),e.fps,t.encoding.priority)}),xu=["q","h","f"];function Eu(t,e,n,r){var i,a;let o=r==null?void 0:r.videoEncoding;t&&(o=r==null?void 0:r.screenShareEncoding);const s=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,l=r==null?void 0:r.videoCodec;if(!o&&!s&&!c||!e||!n)return[{}];o||(o=Sx(t,e,n,l),$.debug("using video encoding",o));const u=o.maxFramerate,d=new ie(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&ua(l)){const f=new Es(c),b=[];if(f.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const x=Vt();if($n()||en()||(x==null?void 0:x.name)==="Chrome"&&Tr(x==null?void 0:x.version,"113")<0){const m=f.suffix=="h"?2:3;for(let v=0;v<f.spatial;v+=1)b.push({rid:xu[2-v],maxBitrate:o.maxBitrate/Math.pow(m,v),maxFramerate:d.encoding.maxFramerate});b[0].scalabilityMode=c}else b.push({maxBitrate:o.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:c});return d.encoding.priority&&(b[0].priority=d.encoding.priority,b[0].networkPriority=d.encoding.priority),$.debug("using svc encoding",{encodings:b}),b}if(!s)return[o];let h=[];t?h=(i=Wf(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:qf(t,d):h=(a=Wf(r==null?void 0:r.videoSimulcastLayers))!==null&&a!==void 0?a:qf(t,d);let p;if(h.length>0){const f=h[0];h.length>1&&([,p]=h);const b=Math.max(e,n);if(b>=960&&p)return Gc(e,n,[f,p,d],u);if(b>=480)return Gc(e,n,[f,d],u)}return Gc(e,n,[d])}function Cx(t,e,n){var r,i,a,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&$.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const s=t.mediaStreamTrack.getSettings(),c=(r=s.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,l=(a=s.height)!==null&&a!==void 0?a:(o=t.dimensions)===null||o===void 0?void 0:o.height;return t.source===I.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),Eu(t.source===I.Source.ScreenShare,c,l,n)}function Sx(t,e,n,r){const i=Tx(t,e,n);let{encoding:a}=i[0];const o=Math.max(e,n);for(let s=0;s<i.length;s+=1){const c=i[s];if(a=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.7;break;case"vp9":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.85;break}return a}function Tx(t,e,n){if(t)return bx;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?gx:vx}function qf(t,e){if(t)return wx(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?yx:kx}function Gc(t,e,n,r){const i=[];if(n.forEach((a,o)=>{if(o>=xu.length)return;const s=Math.min(t,e),c={rid:xu[o],scaleResolutionDownBy:Math.max(1,s/Math.min(a.width,a.height)),maxBitrate:a.encoding.maxBitrate},l=r&&a.encoding.maxFramerate?Math.min(r,a.encoding.maxFramerate):a.encoding.maxFramerate;l&&(c.maxFramerate=l);const u=yi()||o===0;a.encoding.priority&&u&&(c.priority=a.encoding.priority,c.networkPriority=a.encoding.priority),i.push(c)}),en()&&wb()==="ios"){let a;i.forEach(s=>{a?s.maxFramerate&&s.maxFramerate>a&&(a=s.maxFramerate):a=s.maxFramerate});let o=!0;i.forEach(s=>{var c;s.maxFramerate!=a&&(o&&(o=!1,$.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),$.info('Setting framerate of encoding "'.concat((c=s.rid)!==null&&c!==void 0?c:"",'" to ').concat(a)),s.maxFramerate=a)})}return i}function Wf(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class Es{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function xx(t){return t.source===I.Source.ScreenShare||t.constraints.height&&Vn(t.constraints.height)>=1080?"maintain-resolution":"balanced"}const Ex=5e3;class Ps extends _b{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,I.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>k(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(s){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:s}));return}const o=new Map(a.map(s=>[s.rid,s]));if(this.prevStats){let s=0;o.forEach((c,l)=>{var u;const d=(u=this.prevStats)===null||u===void 0?void 0:u.get(l);s+=tc(c,d)}),this._currentBitrate=s}this.prevStats=o}),this.senderLock=new dt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!rt())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},sh))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return k(this,void 0,void 0,function*(){var n,r,i,a,o;yield e.pauseUpstream.call(this);try{for(var s=!0,c=Rn(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;s=!0)a=l.value,s=!1,yield(o=a.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(u){r={error:u}}finally{try{!s&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return k(this,void 0,void 0,function*(){var n,r,i,a,o;yield e.resumeUpstream.call(this);try{for(var s=!0,c=Rn(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;s=!0){a=l.value,s=!1;const u=a;yield(o=u.sender)===null||o===void 0?void 0:o.replaceTrack(u.mediaStreamTrack)}}catch(u){r={error:u}}finally{try{!s&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return k(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===I.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return k(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===I.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return k(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var a;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,framesPerSecond:i.framesPerSecond,framesSent:i.framesSent,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationDurations:i.qualityLimitationDurations,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges,rid:(a=i.rid)!==null&&a!==void 0?a:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,targetBitrate:i.targetBitrate,timestamp:i.timestamp},s=r.get(i.remoteId);s&&(o.jitter=s.jitter,o.packetsLost=s.packetsLost,o.roundTripTime=s.roundTripTime),n.push(o)}}),n.sort((i,a)=>{var o,s;return((o=a.frameWidth)!==null&&o!==void 0?o:0)-((s=i.frameWidth)!==null&&s!==void 0?s:0)}),n})}setPublishingQuality(e){const n=[];for(let r=Ct.LOW;r<=Ct.HIGH;r+=1)n.push(new Qd({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}restartTrack(e){return k(this,void 0,void 0,function*(){var n,r,i,a,o;let s;if(e){const d=ec({video:e});typeof d.video!="boolean"&&(s=d.video)}yield this.restart(s);try{for(var c=!0,l=Rn(this.simulcastCodecs.values()),u;u=yield l.next(),n=u.done,!n;c=!0){a=u.value,c=!1;const d=a;d.sender&&((o=d.sender.transport)===null||o===void 0?void 0:o.state)!=="closed"&&(d.mediaStreamTrack=this.mediaStreamTrack.clone(),yield d.sender.replaceTrack(d.mediaStreamTrack))}}catch(d){r={error:d}}finally{try{!c&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return k(this,arguments,void 0,function(r){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o,s,c,l,u,d;if(yield n.setProcessor.call(i,r,a),!((u=i.processor)===null||u===void 0)&&u.processedTrack)try{for(var h=!0,p=Rn(i.simulcastCodecs.values()),f;f=yield p.next(),o=f.done,!o;h=!0)l=f.value,h=!1,yield(d=l.sender)===null||d===void 0?void 0:d.replaceTrack(i.processor.processedTrack)}catch(b){s={error:b}}finally{try{!h&&!o&&(c=p.return)&&(yield c.call(p))}finally{if(s)throw s.error}}}()})}setDegradationPreference(e){return k(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Ex))}setPublishingCodecs(e){return k(this,void 0,void 0,function*(){var n,r,i,a,o,s,c;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,r=Rn(e);i=yield r.next(),a=i.done,!a;n=!0){c=i.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const d=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const h of u.qualities)if(h.enabled){l.push(u.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield $f(d.sender,d.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){o={error:u}}finally{try{!n&&!a&&(s=r.return)&&(yield s.call(r))}finally{if(o)throw o.error}}return l})}setPublishingLayers(e){return k(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield $f(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return k(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),yb()&&this.isInBackground&&this.source===I.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function $f(t,e,n,r,i,a){return k(this,void 0,void 0,function*(){const o=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},a),{sender:t,qualities:n,senderEncodings:e}));try{const s=t.getParameters(),{encodings:c}=s;if(!c)return;if(c.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},a),{encodings:c,senderEncodings:e}));return}let l=!1;const u=Vt();if((u==null?void 0:u.name)==="Chrome"&&Tr(u==null?void 0:u.version,"133")>0&&c[0].scalabilityMode){const d=c[0],h=new Es(d.scalabilityMode);let p=ii.OFF;if(n.forEach(f=>{f.enabled&&(p===ii.OFF||f.quality>p)&&(p=f.quality)}),p===ii.OFF)d.active&&(d.active=!1,l=!0);else if(!d.active||h.spatial!==p+1){l=!0,d.active=!0;const f=new Es(e[0].scalabilityMode);h.spatial=p+1,h.suffix=f.suffix,h.spatial===1&&(h.suffix=void 0),d.scalabilityMode=h.toString(),d.scaleResolutionDownBy=Math.pow(2,2-p),e[0].maxBitrate&&(d.maxBitrate=e[0].maxBitrate/(d.scaleResolutionDownBy*d.scaleResolutionDownBy))}}else c.forEach((d,h)=>{var p;let f=(p=d.rid)!==null&&p!==void 0?p:"";f===""&&(f="q");const b=Mb(f),x=n.find(m=>m.quality===b);x&&d.active!==x.enabled&&(l=!0,d.active=x.enabled,i.debug("setting layer ".concat(x.quality," to ").concat(d.active?"enabled":"disabled"),a),yi()&&(x.enabled?(d.scaleResolutionDownBy=e[h].scaleResolutionDownBy,d.maxBitrate=e[h].maxBitrate,d.maxFrameRate=e[h].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))});l&&(s.encodings=c,i.debug("setting encodings",Object.assign(Object.assign({},a),{encodings:s.encodings})),yield t.setParameters(s))}finally{o()}})}function Mb(t){switch(t){case"f":return Ct.HIGH;case"h":return Ct.MEDIUM;case"q":return Ct.LOW;default:return Ct.HIGH}}function Gf(t,e,n,r){if(!n)return[new fr({quality:Ct.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,a=new Es(i),o=[],s=a.suffix=="h"?1.5:2,c=a.suffix=="h"?2:3;for(let l=0;l<a.spatial;l+=1)o.push(new fr({quality:Math.min(Ct.HIGH,a.spatial-1)-l,width:Math.ceil(t/Math.pow(s,l)),height:Math.ceil(e/Math.pow(s,l)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(c,l)):0,ssrc:0}));return o}return n.map(i=>{var a,o,s;const c=(a=i.scaleResolutionDownBy)!==null&&a!==void 0?a:1;let l=Mb((o=i.rid)!==null&&o!==void 0?o:"");return new fr({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(s=i.maxBitrate)!==null&&s!==void 0?s:0,ssrc:0})})}const Kf="_lossy",Zf="_reliable",Px=2*1e3,Kc="leave-reconnect";var It;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(It||(It={}));class Rx extends tn.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=ah.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=It.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=$,this.handleDataChannel=r=>k(this,[r],void 0,function(i){var a=this;let{channel:o}=i;return function*(){if(o){if(o.label===Zf)a.reliableDCSub=o;else if(o.label===Kf)a.lossyDCSub=o;else return;a.log.debug("on data channel ".concat(o.id,", ").concat(o.label),a.logContext),o.onmessage=a.handleDataMessage}}()}),this.handleDataMessage=r=>k(this,void 0,void 0,function*(){var i,a;const o=yield this.dataProcessLock.lock();try{let s;if(r.data instanceof ArrayBuffer)s=r.data;else if(r.data instanceof Blob)s=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const c=Xe.fromBinary(new Uint8Array(s));((i=c.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(D.ActiveSpeakersUpdate,c.value.value.speakers):(((a=c.value)===null||a===void 0?void 0:a.case)==="user"&&_x(c,c.value.value),this.emit(D.DataPacketReceived,c))}finally{o()}}),this.handleDataError=r=>{const i=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:a}=r.error;this.log.error("DataChannel error on ".concat(i,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:a}))}else this.log.error("Unknown DataChannel error on ".concat(i),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const i=r.currentTarget.maxRetransmits===0?Z.LOSSY:Z.RELIABLE;this.updateAndEmitDCBufferStatus(i)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const a=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(D.Disconnected),this.close()},o=Date.now()-this.reconnectStart;let s=this.getNextRetryDelay({elapsedMs:o,retryCount:this.reconnectAttempts});if(s===null){a(o);return}r===Kc&&(s=0),this.log.debug("reconnecting in ".concat(s,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Ue.setTimeout(()=>this.attemptReconnect(i).finally(()=>this.reconnectTimeout=void 0),s)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===It.Connected&&r();const a=()=>{this.off(D.Disconnected,o),r()},o=()=>{this.off(D.Restarted,a),i()};this.once(D.Restarted,a),this.once(D.Disconnected,o)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(D.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===de.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Nr.RR_SIGNAL_DISCONNECTED))},this.log=vn((n=e.loggerName)!==null&&n!==void 0?n:zt.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new nh(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new dt,this.dataProcessLock=new dt,this.dcBufferStatus=new Map([[Z.LOSSY,!0],[Z.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(D.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(D.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(D.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(D.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(D.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(D.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(D.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(D.SignalRequestResponse,r)}get logContext(){var e,n,r,i,a,o,s,c;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,participant:(o=(a=this.latestJoinResponse)===null||a===void 0?void 0:a.participant)===null||o===void 0?void 0:o.identity,pID:(c=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||c===void 0?void 0:c.sid}}join(e,n,r,i){return k(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const a=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=a,this.subscriberPrimary=a.subscriberPrimary,this.pcManager||(yield this.configure(a)),(!this.subscriberPrimary||a.fastPublish)&&this.negotiate(),this.clientConfiguration=a.clientConfiguration,a}catch(a){if(a instanceof se&&a.reason===K.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw a}})}close(){return k(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(D.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return k(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return k(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new cn("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new se("publication of local track timed out, no response from server",K.InternalError))},1e4);this.pendingTrackResolvers[e.cid]={resolve:a=>{clearTimeout(i),n(a)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return k(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return k(this,void 0,void 0,function*(){var n,r;if(this.pcManager&&this.pcManager.currentState!==ye.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const i=this.makeRTCConfiguration(e);this.pcManager=new fx(i,e.subscriberPrimary,this.loggerOptions),this.emit(D.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(a,o)=>{this.client.sendIceCandidate(a,o)},this.pcManager.onPublisherOffer=a=>{this.client.sendOffer(a)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(a,o,s)=>k(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(a),this.logContext),["closed","disconnected","failed"].includes(o)&&(this.publisherConnectionPromise=void 0),a===ye.CONNECTED){const u=this.pcState===It.New;this.pcState=It.Connected,u&&this.emit(D.Connected,e)}else a===ye.FAILED&&this.pcState===It.Connected&&(this.pcState=It.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?Nr.RR_SUBSCRIBER_FAILED:Nr.RR_PUBLISHER_FAILED));const c=this.client.isDisconnected||this.client.currentState===de.RECONNECTING,l=[ye.FAILED,ye.CLOSING,ye.CLOSED].includes(a);c&&l&&!this._isClosed&&this.emit(D.Offline)}),this.pcManager.onTrack=a=>{this.emit(D.MediaTrackAdded,a.track,a.streams[0],a.receiver)},Ix((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>k(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>k(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(D.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(D.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(D.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(D.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Nr.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case ai.DISCONNECT:this.emit(D.Disconnected,e==null?void 0:e.reason),this.close();break;case ai.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Kc);break;case ai.RESUME:this.handleDisconnect(Kc)}}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(a=>{const o={urls:a.urls};a.username&&(o.username=a.username),a.credential&&(o.credential=a.credential),i.push(o)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Ma.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(Kf,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Zf,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,r){return k(this,void 0,void 0,function*(){if(vu())return yield this.createTransceiverRTCRtpSender(e,n,r);if(bu())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Pe("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return k(this,void 0,void 0,function*(){if(vu())return this.createSimulcastTransceiverSender(e,n,r,i);if(bu())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Pe("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return k(this,void 0,void 0,function*(){if(!this.pcManager)throw new Pe("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),xi(e)&&(e.codec=n.videoCodec);const a={direction:"sendonly",streams:i};return r&&(a.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,a)).sender})}createSimulcastTransceiverSender(e,n,r,i){return k(this,void 0,void 0,function*(){if(!this.pcManager)throw new Pe("publisher is closed");const a={direction:"sendonly"};i&&(a.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,a);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return k(this,void 0,void 0,function*(){if(!this.pcManager)throw new Pe("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return k(this,void 0,void 0,function*(){var n,r,i;if(!this._isClosed){if(this.attemptingReconnect){$.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Ma.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:ye.NEW)===ye.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(a){this.reconnectAttempts+=1;let o=!0;a instanceof Pe?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:a})),o=!1):a instanceof Lr||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",Nr.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(D.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return k(this,void 0,void 0,function*(){var n,r,i;try{if(!this.url||!this.token)throw new Pe("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(D.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let a;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Lr;a=yield this.join(e??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof se&&o.reason===K.NotAllowed?new Pe("could not reconnect, token might be expired"):new Lr}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(D.SignalRestarted,a),yield this.waitForPCReconnected(),this.client.currentState!==de.CONNECTED)throw new Lr("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(D.Restarted)}catch(a){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),a}})}resumeConnection(e){return k(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new Pe("could not reconnect, url or token not saved");if(!this.pcManager)throw new Pe("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(D.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let a="";throw i instanceof Error&&(a=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof se&&i.reason===K.NotAllowed?new Pe("could not reconnect, token might be expired"):i instanceof se&&i.reason===K.LeaveRequest?i:new Lr(a)}if(this.emit(D.SignalResumed),r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==de.CONNECTED)throw new Lr("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(D.Resumed)})}waitForPCInitialConnection(e,n){return k(this,void 0,void 0,function*(){if(!this.pcManager)throw new Pe("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return k(this,void 0,void 0,function*(){this.pcState=It.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield st(Px),!this.pcManager)throw new Pe("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=It.Connected}catch(e){throw this.pcState=It.Disconnected,new se("could not establish PC connection, ".concat(e.message),K.InternalError)}})}publishRpcResponse(e,n,r,i){return k(this,void 0,void 0,function*(){const a=new Xe({destinationIdentities:[e],kind:Z.RELIABLE,value:{case:"rpcResponse",value:new C0({requestId:n,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(a,Z.RELIABLE)})}publishRpcAck(e,n){return k(this,void 0,void 0,function*(){const r=new Xe({destinationIdentities:[e],kind:Z.RELIABLE,value:{case:"rpcAck",value:new w0({requestId:n})}});yield this.sendDataPacket(r,Z.RELIABLE)})}sendDataPacket(e,n){return k(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}waitForBufferStatusLow(e){return new Promise((n,r)=>k(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))n();else{const i=()=>r("Engine closed");for(this.once(D.Closing,i);!this.dcBufferStatus.get(e);)yield st(10);this.off(D.Closing,i),n()}}))}ensureDataTransportConnected(e){return k(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var a;if(!r.pcManager)throw new Pe("PC manager is closed");const o=i?r.pcManager.subscriber:r.pcManager.publisher,s=i?"Subscriber":"Publisher";if(!o)throw new se("".concat(s," connection not set"),K.InternalError);let c=!1;!i&&!r.dataChannelForKind(n,i)&&(r.createDataChannels(),c=!0),!c&&!i&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(c=!0),c&&r.negotiate();const l=r.dataChannelForKind(n,i);if((l==null?void 0:l.readyState)==="open")return;const u=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<u;){if(o.isICEConnected&&((a=r.dataChannelForKind(n,i))===null||a===void 0?void 0:a.readyState)==="open")return;yield st(50)}throw new se("could not establish ".concat(s," connection, state: ").concat(o.getICEConnectionState()),K.InternalError)}()})}ensurePublisherConnected(e){return k(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==ye.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return k(this,void 0,void 0,function*(){return new Promise((e,n)=>k(this,void 0,void 0,function*(){if(!this.pcManager){n(new fu("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(D.Closing,i),this.pcManager.publisher.once(li.RTPVideoPayloadTypes,a=>{const o=new Map;a.forEach(s=>{const c=s.codec.toLowerCase();z2(c)&&o.set(s.payload,c)}),this.emit(D.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),e()}catch(a){a instanceof fu&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Nr.RR_UNKNOWN),n(a)}finally{this.off(D.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===Z.LOSSY)return this.lossyDCSub;if(e===Z.RELIABLE)return this.reliableDCSub}else{if(e===Z.LOSSY)return this.lossyDC;if(e===Z.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const a=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),s=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array,l=new Array;e.forEach(u=>{u.isDesired!==s&&c.push(u.trackSid),u.isEnabled||l.push(u.trackSid)}),this.client.sendSyncState(new U0({answer:a?Ts({sdp:a.sdp,type:a.type}):void 0,offer:o?Ts({sdp:o.sdp,type:o.type}):void 0,subscription:new Js({trackSids:c,subscribe:!s,participantTracks:[]}),publishTracks:K2(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:l}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new F0({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(Z.LOSSY),At.PUBLISHER),n(this.dataChannelForKind(Z.RELIABLE),At.PUBLISHER),n(this.dataChannelForKind(Z.LOSSY,!0),At.SUBSCRIBER),n(this.dataChannelForKind(Z.RELIABLE,!0),At.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Ue.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){rt()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){rt()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Lr extends Error{}function Ix(t){return t!==void 0&&t>13}function _x(t,e){const n=t.participantIdentity?t.participantIdentity:e.participantIdentity;t.participantIdentity=n,e.participantIdentity=n;const r=t.destinationIdentities.length!==0?t.destinationIdentities:e.destinationIdentities;t.destinationIdentities=r,e.destinationIdentities=r}class Pu{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return ku(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return k(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),$.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return k(this,void 0,void 0,function*(){const n=yield fetch("".concat(Ox(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new se("Could not fetch region settings: ".concat(n.statusText),n.status===401?K.NotAllowed:K.InternalError,n.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function Ox(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class Nb{get info(){return this._info}constructor(e,n,r){this.reader=n,this.totalByteSize=r,this._info=e,this.bytesReceived=0}}class Mx extends Nb{handleChunkReceived(e){var n;this.bytesReceived+=e.content.byteLength;const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>k(this,void 0,void 0,function*(){try{const{done:n,value:r}=yield e.read();return n?{done:!0,value:void 0}:(this.handleChunkReceived(r),{done:!1,value:r.content})}catch{return{done:!0,value:void 0}}}),return(){return k(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return k(this,void 0,void 0,function*(){var e,n,r,i;let a=new Set;try{for(var o=!0,s=Rn(this),c;c=yield s.next(),e=c.done,!e;o=!0){i=c.value,o=!1;const l=i;a.add(l)}}catch(l){n={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(n)throw n.error}}return Array.from(a)})}}class Nx extends Nb{constructor(e,n,r){super(e,n,r),this.receivedChunks=new Map}handleChunkReceived(e){var n;const r=Bo(e.chunkIndex),i=this.receivedChunks.get(r);if(i&&i.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength;const a=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,a)}[Symbol.asyncIterator](){const e=this.reader.getReader(),n=new TextDecoder;return{next:()=>k(this,void 0,void 0,function*(){try{const{done:r,value:i}=yield e.read();return r?{done:!0,value:void 0}:(this.handleChunkReceived(i),{done:!1,value:n.decode(i.content)})}catch{return{done:!0,value:void 0}}}),return(){return k(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return k(this,void 0,void 0,function*(){var e,n,r,i;let a="";try{for(var o=!0,s=Rn(this),c;c=yield s.next(),e=c.done,!e;o=!0)i=c.value,o=!1,a+=i}catch(l){n={error:l}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(n)throw n.error}}return a})}}class Lx{constructor(e,n,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=n}write(e){return this.defaultWriter.write(e)}close(){return k(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class Dx extends Lx{}class Lb extends I{constructor(e,n,r,i,a){super(e,r,a),this.sid=n,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?L.Muted:L.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(L.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return k(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),sh)),Z2()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(r){const{timestamp:i,rtpTimestamp:a}=r;a&&this.rtpTimestamp!==a&&(this.emit(L.TimeSyncUpdate,{timestamp:i,rtpTimestamp:a}),this.rtpTimestamp=a)}};e()}}class Ax extends Lb{constructor(e,n,r,i,a,o){super(e,n,I.Kind.Audio,r,o),this.monitorReceiver=()=>k(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=tc(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.webAudioPluginNodes=[],a&&(this.sinkId=a.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;en()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(en())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return k(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(yu(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&yu(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(L.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(L.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return k(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Zc=100;class jx extends Lb{constructor(e,n,r,i,a){super(e,n,I.Kind.Video,r,a),this.elementInfos=[],this.monitorReceiver=()=>k(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=tc(o,this.prevStats)),this.prevStats=o}),this.debouncedHandleResize=ih(()=>{this.updateDimensions()},Zc),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?si(this._mediaStreamTrack,n):Qr(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new Ux(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return k(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(a=>{a.type==="inbound-rtp"?(r=a.codecId,n={type:"video",streamId:a.id,framesDecoded:a.framesDecoded,framesDropped:a.framesDropped,framesReceived:a.framesReceived,packetsReceived:a.packetsReceived,packetsLost:a.packetsLost,frameWidth:a.frameWidth,frameHeight:a.frameHeight,pliCount:a.pliCount,firCount:a.firCount,nackCount:a.nackCount,jitter:a.jitter,timestamp:a.timestamp,bytesReceived:a.bytesReceived,decoderImplementation:a.decoderImplementation}):a.type==="codec"&&i.set(a.id,a)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return k(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((s,c)=>Math.max(s,c.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,a=this.elementInfos.some(s=>s.pictureInPicture),o=this.elementInfos.some(s=>s.visible)&&!i||a;if(this.lastVisible!==o){if(!o&&Date.now()-r<Zc){Ue.setTimeout(()=>{this.updateVisibility()},Zc);return}this.lastVisible=o,this.emit(L.VisibilityChanged,o,this)}}updateDimensions(){var e,n;let r=0,i=0;const a=this.getPixelDensity();for(const o of this.elementInfos){const s=o.width()*a,c=o.height()*a;s+c>r+i&&(r=s,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(L.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?Rf():n||(Rf()>2?2:1)}}class Ux{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:a,isIntersecting:o}=r;a===this.element&&(this.isIntersecting=o,this.isPiP=Hi(this.element),this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r,i,a;(i=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Hi(this.element),(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=Hi(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??Ru(e),this.isPiP=rt()&&Hi(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,r;this.isIntersecting=Ru(this.element),this.isPiP=Hi(this.element),this.element.handleResize=()=>{var i;(i=this.handleResize)===null||i===void 0||i.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,_f().observe(this.element),If().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,r,i,a;(e=_f())===null||e===void 0||e.unobserve(this.element),(n=If())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(a=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||a===void 0||a.removeEventListener("pagehide",this.onLeavePiP)}}function Hi(t){var e,n;return document.pictureInPictureElement===t?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Ru(t,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Ru(t,e){const n=e||window;let r=t.offsetTop,i=t.offsetLeft;const a=t.offsetWidth,o=t.offsetHeight,{hidden:s}=t,{display:c}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,r+=t.offsetTop,i+=t.offsetLeft;return r<n.pageYOffset+n.innerHeight&&i<n.pageXOffset+n.innerWidth&&r+o>n.pageYOffset&&i+a>n.pageXOffset&&!s&&c!=="none"}class on extends tn.EventEmitter{constructor(e,n,r,i){var a;super(),this.metadataMuted=!1,this.encryption=lt.NONE,this.log=$,this.handleMuted=()=>{this.emit(L.Muted)},this.handleUnmuted=()=>{this.emit(L.Unmuted)},this.log=vn((a=i==null?void 0:i.loggerName)!==null&&a!==void 0?a:zt.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=I.Source.Unknown}setTrack(e){this.track&&(this.track.off(L.Muted,this.handleMuted),this.track.off(L.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(L.Muted,this.handleMuted),e.on(L.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),te(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==lt.NONE}get audioTrack(){if(bn(this.track))return this.track}get videoTrack(){if(xi(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=I.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===I.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(on||(on={}));class Iu extends on{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(L.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(L.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(L.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return k(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return k(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return k(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return k(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(bn(this.track)){const n=this.track.getSourceTrackSettings(),r=new Set;return n.autoGainControl&&r.add(Zt.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&r.add(Zt.TF_ECHO_CANCELLATION),n.noiseSuppression&&r.add(Zt.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&r.add(Zt.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(Zt.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(Zt.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}var In;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(In||(In={}));function Fx(t){switch(t){case Ki.EXCELLENT:return In.Excellent;case Ki.GOOD:return In.Good;case Ki.POOR:return In.Poor;case Ki.LOST:return In.Lost;default:return In.Unknown}}class Db extends tn.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Cs.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,r,i,a,o){let s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Cs.STANDARD;var c;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=In.Unknown,this.log=$,this.log=vn((c=o==null?void 0:o.loggerName)!==null&&c!==void 0?c:zt.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=s,this._attributes=a??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(I.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(I.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(I.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(A.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(A.ParticipantNameChanged,e)}_setAttributes(e){const n=Q2(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(A.AttributesChanged,n)}setPermissions(e){var n,r,i,a,o,s;const c=this.permissions,l=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((a=this.permissions)===null||a===void 0?void 0:a.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((u,d)=>{var h;return u!==((h=this.permissions)===null||h===void 0?void 0:h.canPublishSources[d])})||e.canSubscribeMetrics!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribeMetrics);return this.permissions=e,l&&this.emit(A.ParticipantPermissionsChanged,c),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(A.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=Fx(e),n!==this._connectionQuality&&this.emit(A.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>bn(n.track)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(L.Muted,()=>{this.emit(A.TrackMuted,e)}),e.on(L.Unmuted,()=>{this.emit(A.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case I.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case I.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function Bx(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new A0({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}const po=15e3;class zx extends Db{constructor(e,n,r,i,a){super(e,n,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=lt.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Cb)},this.handleReconnected=()=>{var o,s;(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.resolve)===null||s===void 0||s.call(o),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var o,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(c=>this.log.warn(c.message,this.logContext)),(s=(o=this.reconnectFuture)===null||o===void 0?void 0:o.reject)===null||s===void 0||s.call(o,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=o=>{const{requestId:s,reason:c,message:l}=o,u=this.pendingSignalRequests.get(s);u&&(c!==Jd.OK&&u.reject(new Tf(l,c)),this.pendingSignalRequests.delete(s))},this.handleDataPacket=o=>{switch(o.value.case){case"rpcResponse":let s=o.value.value,c=null,l=null;s.value.case==="payload"?c=s.value.value:s.value.case==="error"&&(l=Ce.fromProto(s.value.value)),this.handleIncomingRpcResponse(s.requestId,c,l);break;case"rpcAck":let u=o.value.value;this.handleIncomingRpcAck(u.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(o=>Bx(o)))},this.onTrackUnmuted=o=>{this.onTrackMuted(o,o.isUpstreamPaused)},this.onTrackMuted=(o,s)=>{if(s===void 0&&(s=!0),!o.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),te(o)));return}this.engine.updateMuteStatus(o.sid,s)},this.onTrackUpstreamPaused=o=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),te(o))),this.onTrackMuted(o,!0)},this.onTrackUpstreamResumed=o=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),te(o))),this.onTrackMuted(o,o.isMuted)},this.onTrackFeatureUpdate=o=>{const s=this.audioTrackPublications.get(o.sid);if(!s){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(o.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(s.trackSid,s.getTrackFeatures())},this.handleSubscribedQualityUpdate=o=>k(this,void 0,void 0,function*(){var s,c,l,u,d,h;if(!(!((d=this.roomOptions)===null||d===void 0)&&d.dynacast))return;const p=this.videoTrackPublications.get(o.trackSid);if(!p){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}if(o.subscribedCodecs.length>0){if(!p.videoTrack)return;const m=yield p.videoTrack.setPublishingCodecs(o.subscribedCodecs);try{for(var f=!0,b=Rn(m),x;x=yield b.next(),s=x.done,!s;f=!0){u=x.value,f=!1;const v=u;_2(v)&&(this.log.debug("publish ".concat(v," for ").concat(p.videoTrack.sid),Object.assign(Object.assign({},this.logContext),te(p))),yield this.publishAdditionalCodecForTrack(p.videoTrack,v,p.options))}}catch(v){c={error:v}}finally{try{!f&&!s&&(l=b.return)&&(yield l.call(b))}finally{if(c)throw c.error}}}else o.subscribedQualities.length>0&&(yield(h=p.videoTrack)===null||h===void 0?void 0:h.setPublishingLayers(o.subscribedQualities))}),this.handleLocalTrackUnpublished=o=>{const s=this.trackPublications.get(o.trackSid);if(!s){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:o.trackSid}));return}this.unpublishTrack(s.track)},this.handleTrackEnded=o=>k(this,void 0,void 0,function*(){if(o.source===I.Source.ScreenShare||o.source===I.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),te(o))),this.unpublishTrack(o);else if(o.isUserProvided)yield o.mute();else if(ir(o)||Cn(o))try{if(rt())try{const s=yield navigator==null?void 0:navigator.permissions.query({name:o.source===I.Source.Camera?"camera":"microphone"});if(s&&s.state==="denied")throw this.log.warn("user has revoked access to ".concat(o.source),Object.assign(Object.assign({},this.logContext),te(o))),s.onchange=()=>{s.state!=="denied"&&(o.isMuted||o.restartTrack(),s.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}o.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),te(o))),ir(o)?yield o.restartTrack({deviceId:"default"}):yield o.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),te(o))),yield o.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=a}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==lt.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(D.RemoteMute,(n,r)=>{const i=this.trackPublications.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(D.Connected,this.handleReconnected).on(D.SignalRestarted,this.handleReconnected).on(D.SignalResumed,this.handleReconnected).on(D.Restarting,this.handleReconnecting).on(D.Resuming,this.handleReconnecting).on(D.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(D.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(D.Disconnected,this.handleDisconnected).on(D.SignalRequestResponse,this.handleSignalRequestResponse).on(D.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return k(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return k(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return k(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return k(this,arguments,void 0,function(n){var r=this;let{metadata:i,name:a,attributes:o}=n;return function*(){return new Promise((s,c)=>k(r,void 0,void 0,function*(){var l,u;try{let d=!1;const h=yield this.engine.client.sendUpdateLocalMetadata((l=i??this.metadata)!==null&&l!==void 0?l:"",(u=a??this.name)!==null&&u!==void 0?u:"",o),p=performance.now();for(this.pendingSignalRequests.set(h,{resolve:s,reject:f=>{c(f),d=!0},values:{name:a,metadata:i,attributes:o}});performance.now()-p<5e3&&!d;){if((!a||this.name===a)&&(!i||this.metadata===i)&&(!o||Object.entries(o).every(f=>{let[b,x]=f;return this.attributes[b]===x||x===""&&!this.attributes[b]}))){this.pendingSignalRequests.delete(h),s();return}yield st(50)}c(new Tf("Request to update local metadata timed out","TimeoutError"))}catch(d){d instanceof Error&&c(d)}}))}()})}setCameraEnabled(e,n,r){return this.setTrackEnabled(I.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(I.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(I.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(A.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return k(this,void 0,void 0,function*(){this.encryptionType=e?lt.GCM:lt.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){return k(this,void 0,void 0,function*(){var a,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let s=this.getTrackPublication(e);if(n)if(s)yield s.unmute();else{let c;if(this.pendingPublishing.has(e)){const l=yield this.waitForPendingPublicationOfSource(e);return l||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield l==null?void 0:l.unmute(),l}this.pendingPublishing.add(e);try{switch(e){case I.Source.Camera:c=yield this.createTracks({video:(a=r)!==null&&a!==void 0?a:!0});break;case I.Source.Microphone:c=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case I.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new cn(e)}}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&this.emit(A.MediaDevicesError,l),this.pendingPublishing.delete(e),l}try{const l=[];for(const u of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),te(u))),l.push(this.publishTrack(u,i));[s]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l}finally{this.pendingPublishing.delete(e)}}else if(!(s!=null&&s.track)&&this.pendingPublishing.has(e)&&(s=yield this.waitForPendingPublicationOfSource(e),s||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),s&&s.track)if(e===I.Source.ScreenShare){s=yield this.unpublishTrack(s.track);const c=this.getTrackPublication(I.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield s.mute();return s})}enableCameraAndMicrophone(){return k(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(I.Source.Camera)||this.pendingPublishing.has(I.Source.Microphone))){this.pendingPublishing.add(I.Source.Camera),this.pendingPublishing.add(I.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(I.Source.Camera),this.pendingPublishing.delete(I.Source.Microphone)}}})}createTracks(e){return k(this,void 0,void 0,function*(){var n,r;e??(e={});const i=Sb(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),{audioProcessor:a,videoProcessor:o,optionsWithoutProcessor:s}=th(i),c=ec(s);let l;try{l=yield navigator.mediaDevices.getUserMedia(c)}catch(u){throw u instanceof Error&&(c.audio&&(this.microphoneError=u),c.video&&(this.cameraError=u)),u}return c.audio&&(this.microphoneError=void 0,this.emit(A.AudioStreamAcquired)),c.video&&(this.cameraError=void 0),Promise.all(l.getTracks().map(u=>k(this,void 0,void 0,function*(){const d=u.kind==="audio";let h;const p=d?c.audio:c.video;typeof p!="boolean"&&(h=p);const f=Ob(u,h,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return f.kind===I.Kind.Video?f.source=I.Source.Camera:f.kind===I.Kind.Audio&&(f.source=I.Source.Microphone,f.setAudioContext(this.audioContext)),f.mediaStream=l,bn(f)&&a?yield f.setProcessor(a):xi(f)&&o&&(yield f.setProcessor(o)),f})))})}createScreenTracks(e){return k(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Xd("getDisplayMedia not supported");e.resolution===void 0&&!A2()&&(e.resolution=eh.h1080fps30.resolution);const n=G2(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new cn("no video track found");const a=new Ps(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=I.Source.ScreenShare,e.contentHint&&(a.mediaStreamTrack.contentHint=e.contentHint);const o=[a];if(r.getAudioTracks().length>0){this.emit(A.AudioStreamAcquired);const s=new xs(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=I.Source.ScreenShareAudio,o.push(s)}return o})}publishTrack(e,n){return k(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return k(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var s,c,l,u;ir(r)&&r.setAudioContext(a.audioContext),yield(s=a.reconnectFuture)===null||s===void 0?void 0:s.promise,a.republishPromise&&!o&&(yield a.republishPromise),ci(r)&&a.pendingPublishPromises.has(r)&&(yield a.pendingPublishPromises.get(r));let d;if(r instanceof MediaStreamTrack)d=r.getConstraints();else{d=r.constraints;let m;switch(r.source){case I.Source.Microphone:m="audioinput";break;case I.Source.Camera:m="videoinput"}m&&a.activeDeviceMap.has(m)&&(d=Object.assign(Object.assign({},d),{deviceId:a.activeDeviceMap.get(m)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new xs(r,d,!0,a.audioContext,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;case"video":r=new Ps(r,d,!0,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;default:throw new cn("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});let h;if(a.trackPublications.forEach(m=>{m.track&&m.track===r&&(h=m)}),h)return a.log.warn("track has already been published, skipping",Object.assign(Object.assign({},a.logContext),te(h))),h;const p="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,f=(c=i==null?void 0:i.forceStereo)!==null&&c!==void 0?c:p;f&&(i||(i={}),i.dtx===void 0&&a.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},a.logContext),te(r))),i.red===void 0&&a.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(l=i.dtx)!==null&&l!==void 0||(i.dtx=!1),(u=i.red)!==null&&u!==void 0||(i.red=!1));const b=Object.assign(Object.assign({},a.roomOptions.publishDefaults),i);!j2()&&a.roomOptions.e2ee&&(a.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},a.logContext)),b.simulcast=!1),b.source&&(r.source=b.source);const x=a.publish(r,b,f);a.pendingPublishPromises.set(r,x);try{return yield x}catch(m){throw m}finally{a.pendingPublishPromises.delete(r)}}()})}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),te(e))),!1;const{canPublish:n,canPublishSources:r}=this.permissions;return n&&(r.length===0||r.map(i=>J2(i)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),te(e))),!1)}publish(e,n,r){return k(this,void 0,void 0,function*(){var i,a,o,s,c,l,u,d,h,p;if(!this.hasPermissionsToPublish(e))throw new k2("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(g=>ci(e)&&g.source===e.source)&&e.source!==I.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),te(e))),n.stopMicTrackOnMute&&bn(e)&&(e.stopOnMute=!0),e.source===I.Source.ScreenShare&&yi()&&(n.simulcast=!1),n.videoCodec==="av1"&&!N2()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!L2()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Tu),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(g=>n.videoCodec===zo(g.mime))||(n.videoCodec=zo(this.enabledPublishVideoCodecs[0].mime)));const f=n.videoCodec;e.on(L.Muted,this.onTrackMuted),e.on(L.Unmuted,this.onTrackUnmuted),e.on(L.Ended,this.handleTrackEnded),e.on(L.UpstreamPaused,this.onTrackUpstreamPaused),e.on(L.UpstreamResumed,this.onTrackUpstreamResumed),e.on(L.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const b=new iu({cid:e.mediaStreamTrack.id,name:n.name,type:I.kindToProto(e.kind),muted:e.isMuted,source:I.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((a=n.red)!==null&&a!==void 0)||a),stream:n==null?void 0:n.stream,backupCodecPolicy:n==null?void 0:n.backupCodecPolicy});let x;if(e.kind===I.Kind.Video){let g={width:0,height:0};try{g=yield e.waitForDimensions()}catch{const S=(s=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&s!==void 0?s:La.h720.resolution;g={width:S.width,height:S.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),te(e)),{dims:g}))}b.width=g.width,b.height=g.height,Cn(e)&&(ua(f)&&(e.source===I.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),te(e))))),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),b.simulcastCodecs=[new ru({codec:f,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Tu}),n.backupCodec&&f!==n.backupCodec.codec&&b.encryption===lt.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),b.simulcastCodecs.push(new ru({codec:n.backupCodec.codec,cid:""})))),x=Eu(e.source===I.Source.ScreenShare,b.width,b.height,n),b.layers=Gf(b.width,b.height,x,ua(n.videoCodec))}else e.kind===I.Kind.Audio&&(x=[{maxBitrate:(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate,priority:(d=(u=n.audioPreset)===null||u===void 0?void 0:u.priority)!==null&&d!==void 0?d:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Pe("cannot publish track when not connected");const m=()=>k(this,void 0,void 0,function*(){var g,S,w;if(!this.engine.pcManager)throw new Pe("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,x),Cn(e)&&((g=n.degradationPreference)!==null&&g!==void 0||(n.degradationPreference=xx(e)),e.setDegradationPreference(n.degradationPreference)),x)if(yi()&&e.kind===I.Kind.Audio){let T;for(const E of this.engine.pcManager.publisher.getTransceivers())if(E.sender===e.sender){T=E;break}T&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:T,codec:"opus",maxbr:!((S=x[0])===null||S===void 0)&&S.maxBitrate?x[0].maxBitrate/1e3:0})}else e.codec&&ua(e.codec)&&!((w=x[0])===null||w===void 0)&&w.maxBitrate&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:b.cid,codec:e.codec,maxbr:x[0].maxBitrate/1e3});yield this.engine.negotiate()});let v;if(this.enabledPublishVideoCodecs.length>0)v=(yield Promise.all([this.engine.addTrack(b),m()]))[0];else{v=yield this.engine.addTrack(b);let g;if(v.codecs.forEach(S=>{g===void 0&&(g=S.mimeType)}),g&&e.kind===I.Kind.Video){const S=zo(g);S!==f&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),te(e)),{codec:S})),n.videoCodec=S,x=Eu(e.source===I.Source.ScreenShare,b.width,b.height,n))}yield m()}const y=new Iu(e.kind,v,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return y.options=n,e.sid=v.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:x,trackInfo:v})),Cn(e)?e.startMonitor(this.engine.client):ir(e)&&e.startMonitor(),this.addTrackPublication(y),this.emit(A.LocalTrackPublished,y),y})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){return k(this,void 0,void 0,function*(){var i;if(this.encryptionType!==lt.NONE)return;let a;if(this.trackPublications.forEach(h=>{h.track&&h.track===e&&(a=h)}),!a)throw new cn("track is not published");if(!Cn(e))throw new cn("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),s=Cx(e,n,o);if(!s){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),te(e)));return}const c=e.addSimulcastTrack(n,s);if(!c)return;const l=new iu({cid:c.mediaStreamTrack.id,type:I.kindToProto(e.kind),muted:e.isMuted,source:I.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=Gf(l.width,l.height,s),!this.engine||this.engine.isClosed)throw new Pe("cannot publish track when not connected");const u=()=>k(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,c,o,s),yield this.engine.negotiate()}),d=(yield Promise.all([this.engine.addTrack(l),u()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:s,trackInfo:d}))})}unpublishTrack(e,n){return k(this,void 0,void 0,function*(){var r,i;if(ci(e)){const l=this.pendingPublishPromises.get(e);l&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),te(e))),yield l)}const a=this.getPublicationForTrack(e),o=a?te(a):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!a||!a.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));return}e=a.track,e.off(L.Muted,this.onTrackMuted),e.off(L.Unmuted,this.onTrackUnmuted),e.off(L.Ended,this.handleTrackEnded),e.off(L.UpstreamPaused,this.onTrackUpstreamPaused),e.off(L.UpstreamResumed,this.onTrackUpstreamResumed),e.off(L.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n?e.stop():e.stopMonitor();let s=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<ye.FAILED&&c)try{for(const l of this.engine.pcManager.publisher.getTransceivers())l.sender===c&&(l.direction="inactive",s=!0);if(this.engine.removeTrack(c)&&(s=!0),Cn(e)){for(const[,l]of e.simulcastCodecs)l.sender&&(this.engine.removeTrack(l.sender)&&(s=!0),l.sender=void 0);e.simulcastCodecs.clear()}}catch(l){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:l}))}switch(this.trackPublications.delete(a.trackSid),a.kind){case I.Kind.Audio:this.audioTrackPublications.delete(a.trackSid);break;case I.Kind.Video:this.videoTrackPublications.delete(a.trackSid);break}return this.emit(A.LocalTrackUnpublished,a),a.setTrack(void 0),s&&(yield this.engine.negotiate()),a})}unpublishTracks(e){return k(this,void 0,void 0,function*(){return(yield Promise.all(e.map(n=>this.unpublishTrack(n)))).filter(n=>!!n)})}republishAllTracks(e){return k(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((a,o)=>k(r,void 0,void 0,function*(){try{const s=[];this.trackPublications.forEach(c=>{c.track&&(n&&(c.options=Object.assign(Object.assign({},c.options),n)),s.push(c))}),yield Promise.all(s.map(c=>k(this,void 0,void 0,function*(){const l=c.track;yield this.unpublishTrack(l,!1),i&&!l.isMuted&&l.source!==I.Source.ScreenShare&&l.source!==I.Source.ScreenShareAudio&&(ir(l)||Cn(l))&&!l.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:c.trackSid})),yield l.restartTrack()),yield this.publishOrRepublishTrack(l,c.options,!0)}))),a()}catch(s){o(s)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return k(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const a=i.reliable?Z.RELIABLE:Z.LOSSY,o=i.destinationIdentities,s=i.topic,c=new Xe({kind:a,value:{case:"user",value:new b0({participantIdentity:r.identity,payload:n,destinationIdentities:o,topic:s})}});yield r.engine.sendDataPacket(c,a)}()})}publishDtmf(e,n){return k(this,void 0,void 0,function*(){const r=new Xe({kind:Z.RELIABLE,value:{case:"sipDtmf",value:new y0({code:e,digit:n})}});yield this.engine.sendDataPacket(r,Z.RELIABLE)})}sendChatMessage(e,n){return k(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:n==null?void 0:n.attachments},i=new Xe({value:{case:"chatMessage",value:new Jl(Object.assign(Object.assign({},r),{timestamp:pe.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(i,Z.RELIABLE),this.emit(A.ChatMessage,r),r})}editChatMessage(e,n){return k(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),i=new Xe({value:{case:"chatMessage",value:new Jl(Object.assign(Object.assign({},r),{timestamp:pe.parse(r.timestamp),editTimestamp:pe.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,Z.RELIABLE),this.emit(A.ChatMessage,r),r})}sendText(e,n){return k(this,void 0,void 0,function*(){var r;const i=crypto.randomUUID(),a=new TextEncoder().encode(e).byteLength,o=(r=n==null?void 0:n.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),s=new Array(o?o.length+1:1).fill(0),c=(u,d)=>{var h;s[d]=u;const p=s.reduce((f,b)=>f+b,0);(h=n==null?void 0:n.onProgress)===null||h===void 0||h.call(n,p)},l=yield this.streamText({streamId:i,totalSize:a,destinationIdentities:n==null?void 0:n.destinationIdentities,topic:n==null?void 0:n.topic,attachedStreamIds:o,attributes:n==null?void 0:n.attributes});return yield l.write(e),c(1,0),yield l.close(),n!=null&&n.attachments&&o&&(yield Promise.all(n.attachments.map((u,d)=>k(this,void 0,void 0,function*(){return this._sendFile(o[d],u,{topic:n.topic,mimeType:u.type,onProgress:h=>{c(h,d+1)}})})))),l.info})}streamText(e){return k(this,void 0,void 0,function*(){var n,r;const i=(n=e==null?void 0:e.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),a={id:i,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes},o=new Xl({streamId:i,mimeType:a.mimeType,topic:a.topic,timestamp:rr(a.timestamp),totalLength:rr(e==null?void 0:e.totalSize),attributes:a.attributes,contentHeader:{case:"textHeader",value:new I0({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?Yl.UPDATE:Yl.CREATE})}}),s=e==null?void 0:e.destinationIdentities,c=new Xe({destinationIdentities:s,value:{case:"streamHeader",value:o}});yield this.engine.sendDataPacket(c,Z.RELIABLE);let l=0;const u=this,d=new WritableStream({write(f){return k(this,void 0,void 0,function*(){for(const b of $2(f,po)){yield u.engine.waitForBufferStatusLow(Z.RELIABLE);const x=new eu({content:b,streamId:i,chunkIndex:rr(l)}),m=new Xe({destinationIdentities:s,value:{case:"streamChunk",value:x}});yield u.engine.sendDataPacket(m,Z.RELIABLE),l+=1}})},close(){return k(this,void 0,void 0,function*(){const f=new tu({streamId:i}),b=new Xe({destinationIdentities:s,value:{case:"streamTrailer",value:f}});yield u.engine.sendDataPacket(b,Z.RELIABLE)})},abort(f){console.log("Sink error:",f)}});let h=()=>k(this,void 0,void 0,function*(){yield p.close()});u.engine.once(D.Closing,h);const p=new Dx(d,a,()=>this.engine.off(D.Closing,h));return p})}sendFile(e,n){return k(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,n),{id:r}})}_sendFile(e,n,r){return k(this,void 0,void 0,function*(){var i,a;const o=n.size,s=new Xl({totalLength:rr(o),mimeType:(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:n.type,streamId:e,topic:r==null?void 0:r.topic,encryptionType:r==null?void 0:r.encryptionType,timestamp:rr(Date.now()),contentHeader:{case:"byteHeader",value:new _0({name:n.name})}}),c=r==null?void 0:r.destinationIdentities,l=new Xe({destinationIdentities:c,value:{case:"streamHeader",value:s}});yield this.engine.sendDataPacket(l,Z.RELIABLE);function u(f){return new Promise(b=>{const x=new FileReader;x.onload=()=>{b(new Uint8Array(x.result))},x.readAsArrayBuffer(f)})}const d=Math.ceil(o/po);for(let f=0;f<d;f++){const b=yield u(n.slice(f*po,Math.min((f+1)*po,o)));yield this.engine.waitForBufferStatusLow(Z.RELIABLE);const x=new eu({content:b,streamId:e,chunkIndex:rr(f)}),m=new Xe({destinationIdentities:c,value:{case:"streamChunk",value:x}});yield this.engine.sendDataPacket(m,Z.RELIABLE),(a=r==null?void 0:r.onProgress)===null||a===void 0||a.call(r,(f+1)/d)}const h=new tu({streamId:e}),p=new Xe({destinationIdentities:c,value:{case:"streamTrailer",value:h}});yield this.engine.sendDataPacket(p,Z.RELIABLE)})}performRpc(e){return k(this,arguments,void 0,function(n){var r=this;let{destinationIdentity:i,method:a,payload:o,responseTimeout:s=1e4}=n;return function*(){return new Promise((c,l)=>k(r,void 0,void 0,function*(){var u,d,h,p;if(oh(o)>Ib){l(Ce.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((d=(u=this.engine.latestJoinResponse)===null||u===void 0?void 0:u.serverInfo)===null||d===void 0)&&d.version&&Tr((p=(h=this.engine.latestJoinResponse)===null||h===void 0?void 0:h.serverInfo)===null||p===void 0?void 0:p.version,"1.8.0")<0){l(Ce.builtIn("UNSUPPORTED_SERVER"));return}const f=crypto.randomUUID();yield this.publishRpcRequest(i,f,a,o,s-2e3);const b=setTimeout(()=>{this.pendingAcks.delete(f),l(Ce.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(f),clearTimeout(x)},2e3);this.pendingAcks.set(f,{resolve:()=>{clearTimeout(b)},participantIdentity:i});const x=setTimeout(()=>{this.pendingResponses.delete(f),l(Ce.builtIn("RESPONSE_TIMEOUT"))},s);this.pendingResponses.set(f,{resolve:(m,v)=>{clearTimeout(x),this.pendingAcks.has(f)&&(console.warn("RPC response received before ack",f),this.pendingAcks.delete(f),clearTimeout(b)),v?l(v):c(m??"")},participantIdentity:i})}))}()})}registerRpcMethod(e,n){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,r){const i=this.pendingResponses.get(e);i?(i.resolve(n,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,n,r,i,a){return k(this,void 0,void 0,function*(){const o=new Xe({destinationIdentities:[e],kind:Z.RELIABLE,value:{case:"rpcRequest",value:new k0({id:n,method:r,payload:i,responseTimeoutMs:a,version:1})}});yield this.engine.sendDataPacket(o,Z.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:r,resolve:i}]of this.pendingResponses)r===e&&(i(null,Ce.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const a=this.trackPublications.get(n.sid);if(a){const o=a.isMuted||((i=(r=a.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),te(a)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(ir(i)||Cn(i))&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}waitForPendingPublicationOfSource(e){return k(this,void 0,void 0,function*(){const n=Date.now();for(;Date.now()<n+1e4;){const r=Array.from(this.pendingPublishPromises.entries()).find(i=>{let[a]=i;return a.source===e});if(r)return r[1];yield st(20)}})}}class Vx extends on{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Ct.HIGH,this.handleEnded=a=>{this.setTrack(void 0),this.emit(L.Ended,a)},this.handleVisibilityChange=a=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(a),this.logContext),this.disabled=!a,this.emitTrackUpdate()},this.handleVideoDimensionsChange=a=>{this.log.debug("adaptivestream video dimensions ".concat(a.width,"x").concat(a.height),this.logContext),this.videoDimensions=a,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Js({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new T0({participantSid:"",trackSids:[this.trackSid]})]});this.emit(L.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?on.SubscriptionStatus.Unsubscribed:super.isSubscribed?on.SubscriptionStatus.Subscribed:on.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?on.PermissionStatus.Allowed:on.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(Hc(this.track)&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Hc(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(L.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(L.VisibilityChanged,this.handleVisibilityChange),i.off(L.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(L.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(L.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(L.VisibilityChanged,this.handleVisibilityChange),e.on(L.Ended,this.handleEnded),this.emit(L.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(L.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?L.Muted:L.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(L.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(L.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===I.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Hc(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new O0({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=Ct.HIGH,this.emit(L.UpdateSettings,e)}}class Rs extends Db{static fromParticipantInfo(e,n,r){return new Rs(e,n.sid,n.identity,n.name,n.metadata,n.attributes,r,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,r,i,a,o,s){let c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Cs.STANDARD;super(n,r||"",i,a,o,s,c),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(L.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),te(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(L.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(L.SubscriptionPermissionChanged,n=>{this.emit(A.TrackSubscriptionPermissionChanged,e,n)}),e.on(L.SubscriptionStatusChanged,n=>{this.emit(A.TrackSubscriptionStatusChanged,e,n)}),e.on(L.Subscribed,n=>{this.emit(A.TrackSubscribed,n,e)}),e.on(L.Unsubscribed,n=>{this.emit(A.TrackUnsubscribed,n,e)}),e.on(L.SubscriptionFailed,n=>{this.emit(A.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:I.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrackPublication(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,a,o){let s=this.getTrackPublicationBySid(n);if(s||n.startsWith("TR")||this.trackPublications.forEach(u=>{!s&&e.kind===u.kind.toString()&&(s=u)}),!s){if(o===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(A.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,a,o-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),te(s))),this.emit(A.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new jx(e,n,i,a):l=new Ax(e,n,i,this.audioContext,this.audioOutput),l.source=s.source,l.isMuted=s.isMuted,l.setMediaStream(r),l.start(),s.setTrack(l),this.volumeMap.has(s.source)&&Cu(l)&&bn(l)&&l.setVolume(this.volumeMap.get(s.source)),s}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var a,o;let s=this.getTrackPublicationBySid(i.sid);if(s)s.updateInfo(i);else{const c=I.kindFromProto(i.type);if(!c)return;s=new Vx(c,i,(a=this.signalClient.connectOptions)===null||a===void 0?void 0:a.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(o=this.loggerOptions)===null||o===void 0?void 0:o.loggerName}),s.updateInfo(i),r.set(i.sid,s);const l=Array.from(this.trackPublications.values()).find(u=>u.source===(s==null?void 0:s.source));l&&s.source!==I.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(s.source),Object.assign(Object.assign({},this.logContext),{oldTrack:te(l),newTrack:te(s)})),this.addTrackPublication(s)}n.set(i.sid,s)}),this.trackPublications.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),te(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(A.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.trackPublications.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case I.Kind.Audio:this.audioTrackPublications.delete(e);break;case I.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(A.TrackUnpublished,r)}setAudioOutput(e){return k(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(r=>{var i;bn(r.track)&&Cu(r.track)&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var Y;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting"})(Y||(Y={}));const Hx=4*1e3;class ki extends tn.EventEmitter{constructor(e){var n,r,i,a;if(super(),n=this,this.state=Y.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=$,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(o,s,c)=>k(this,void 0,void 0,function*(){var l;if(!D2())throw en()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const u=yield this.disconnectLock.lock();if(this.state===Y.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),u(),Promise.resolve();if(this.connectFuture)return u(),this.connectFuture.promise;this.setAndEmitConnectionState(Y.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),ku(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Pu(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().then(p=>{var f;(f=this.regionUrlProvider)===null||f===void 0||f.setServerReportedRegions(p)}).catch(p=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:p}))}));const d=(p,f,b)=>k(this,void 0,void 0,function*(){var x,m;this.abortController&&this.abortController.abort();const v=new AbortController;this.abortController=v,u==null||u();try{yield this.attemptConnection(b??o,s,c,v),this.abortController=void 0,p()}catch(y){if(this.regionUrlProvider&&y instanceof se&&y.reason!==K.Cancelled&&y.reason!==K.NotAllowed){let g=null;try{g=yield this.regionUrlProvider.getNextBestRegionUrl((x=this.abortController)===null||x===void 0?void 0:x.signal)}catch(S){if(S instanceof se&&(S.status===401||S.reason===K.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),f(S);return}}g&&!(!((m=this.abortController)===null||m===void 0)&&m.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(y.message,". Retrying with another region: ").concat(g),this.logContext),this.recreateEngine(),yield d(p,f,g)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Mf(y)),f(y))}else{let g=jt.UNKNOWN_REASON;y instanceof se&&(g=Mf(y)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,g),f(y)}}}),h=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Cb((p,f)=>{d(p,f,h)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,c,l,u,d)=>k(this,void 0,void 0,function*(){var h,p,f;const b=yield c.join(o,s,{autoSubscribe:l.autoSubscribe,adaptiveStream:typeof u.adaptiveStream=="object"?!0:u.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},d.signal);let x=b.serverInfo;if(x||(x={version:b.serverVersion,region:b.serverRegion}),this.serverInfo=x,this.log.debug("connected to Livekit Server ".concat(Object.entries(x).map(m=>{let[v,y]=m;return"".concat(v,": ").concat(y)}).join(", ")),{room:(h=b.room)===null||h===void 0?void 0:h.name,roomSid:(p=b.room)===null||p===void 0?void 0:p.sid,identity:(f=b.participant)===null||f===void 0?void 0:f.identity}),!x.version)throw new y2("unknown server version");return x.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),u.dynacast=!1),b}),this.applyJoinResponse=o=>{const s=o.participant;if(this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.localParticipant.setEnabledPublishCodecs(o.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(o.sifTrailer)}catch(c){this.log.error(c instanceof Error?c.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:c}))}this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room)},this.attemptConnection=(o,s,c,l)=>k(this,void 0,void 0,function*(){var u,d;this.state===Y.Reconnecting||this.isResuming||!((u=this.engine)===null||u===void 0)&&u.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((d=this.regionUrlProvider)===null||d===void 0)&&d.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},ah),c),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const h=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(h),this.setupLocalParticipantEvents(),this.emit(N.SignalConnected)}catch(h){yield this.engine.close(),this.recreateEngine();const p=new se("could not establish signal connection",K.ServerUnreachable);throw h instanceof Error&&(p.message="".concat(p.message,": ").concat(h.message)),h instanceof se&&(p.reason=h.reason,p.status=h.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:h})),p}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new se("Connection attempt aborted",K.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(h){throw yield this.engine.close(),this.recreateEngine(),h}rt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),rt()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Y.Connected),this.emit(N.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return k(n,[...s],void 0,function(){var l=this;let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var d,h,p,f;const b=yield l.disconnectLock.lock();try{if(l.state===Y.Disconnected){l.log.debug("already disconnected",l.logContext);return}l.log.info("disconnect from room",Object.assign({},l.logContext)),(l.state===Y.Connecting||l.state===Y.Reconnecting||l.isResuming)&&(l.log.warn("abort connection attempt",l.logContext),(d=l.abortController)===null||d===void 0||d.abort(),(p=(h=l.connectFuture)===null||h===void 0?void 0:h.reject)===null||p===void 0||p.call(h,new se("Client initiated disconnect",K.Cancelled)),l.connectFuture=void 0),!((f=l.engine)===null||f===void 0)&&f.client.isDisconnected||(yield l.engine.client.sendLeave()),l.engine&&(yield l.engine.close()),l.handleDisconnect(u,jt.CLIENT_INITIATED),l.engine=void 0}finally{b()}}()})},this.onPageLeave=()=>k(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>k(this,void 0,void 0,function*(){const o=[],s=Vt();if(s&&s.os==="iOS"){const c="livekit-dummy-audio-el";let l=document.getElementById(c);if(!l){l=document.createElement("audio"),l.id=c,l.autoplay=!0,l.hidden=!0;const u=Vc();u.enabled=!0;const d=new MediaStream([u]);l.srcObject=d,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:d,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(N.Disconnected,()=>{l==null||l.remove(),l=null})}o.push(l)}this.remoteParticipants.forEach(c=>{c.audioTrackPublications.forEach(l=>{l.track&&l.track.attachedElements.forEach(u=>{o.push(u)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(c=>(c.muted=!1,c.play()))]),this.handleAudioPlaybackStarted()}catch(c){throw this.handleAudioPlaybackFailed(c),c}}),this.startVideo=()=>k(this,void 0,void 0,function*(){const o=[];for(const s of this.remoteParticipants.values())s.videoTrackPublications.forEach(c=>{var l;(l=c.track)===null||l===void 0||l.attachedElements.forEach(u=>{o.includes(u)||o.push(u)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const o of this.remoteParticipants.values())this.handleParticipantDisconnected(o.identity,o);this.setAndEmitConnectionState(Y.Reconnecting)&&this.emit(N.Reconnecting)},this.handleSignalRestarted=o=>k(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(Y.Connected),this.emit(N.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{var c;if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}s.identity===""&&(s.identity=(c=this.sidToIdentity.get(s.sid))!==null&&c!==void 0?c:"");let l=this.remoteParticipants.get(s.identity);s.state===Ql.DISCONNECTED?this.handleParticipantDisconnected(s.identity,l):l=this.getOrCreateParticipant(s.identity,s)})},this.handleActiveSpeakersUpdate=o=>{const s=[],c={};o.forEach(l=>{if(c[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const u=this.getRemoteParticipantBySid(l.sid);u&&(u.audioLevel=l.level,u.setIsSpeaking(!0),s.push(u))}}),c[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(l=>{c[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(N.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(l=>{const u=this.remoteParticipants.get(l.identity);u&&u.sid!==l.sid||s.set(l.sid,l)}),o.forEach(l=>{let u=this.getRemoteParticipantBySid(l.sid);l.sid===this.localParticipant.sid&&(u=this.localParticipant),u&&(u.audioLevel=l.level,u.setIsSpeaking(l.active),l.active?s.set(l.sid,u):s.delete(l.sid))});const c=Array.from(s.values());c.sort((l,u)=>u.audioLevel-l.audioLevel),this.activeSpeakers=c,this.emitWhenConnected(N.ActiveSpeakersChanged,c)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const c=this.getRemoteParticipantBySid(s.participantSid);if(!c)return;const l=c.getTrackPublicationBySid(s.trackSid);if(!l||!l.track)return;const u=I.streamStateFromProto(s.state);u!==l.track.streamState&&(l.track.streamState=u,c.emit(A.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(N.TrackStreamStateChanged,l,l.track.streamState,c))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.getRemoteParticipantBySid(o.participantSid);if(!s)return;const c=s.getTrackPublicationBySid(o.trackSid);c&&c.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.remoteParticipants.values()).find(l=>l.trackPublications.has(o.trackSid));if(!s)return;const c=s.getTrackPublicationBySid(o.trackSid);c&&c.setSubscriptionError(o.err)},this.handleDataPacket=o=>{const s=this.remoteParticipants.get(o.participantIdentity);if(o.value.case==="user")this.handleUserPacket(s,o.value.value,o.kind);else if(o.value.case==="transcription")this.handleTranscription(s,o.value.value);else if(o.value.case==="sipDtmf")this.handleSipDtmf(s,o.value.value);else if(o.value.case==="chatMessage")this.handleChatMessage(s,o.value.value);else if(o.value.case==="metrics")this.handleMetrics(o.value.value,s);else if(o.value.case==="streamHeader")this.handleStreamHeader(o.value.value,o.participantIdentity);else if(o.value.case==="streamChunk")this.handleStreamChunk(o.value.value);else if(o.value.case==="streamTrailer")this.handleStreamTrailer(o.value.value);else if(o.value.case==="rpcRequest"){const c=o.value.value;this.handleIncomingRpcRequest(o.participantIdentity,c.id,c.method,c.payload,c.responseTimeoutMs,c.version)}},this.handleUserPacket=(o,s,c)=>{this.emit(N.DataReceived,s.payload,o,c,s.topic),o==null||o.emit(A.DataReceived,s.payload,c)},this.handleSipDtmf=(o,s)=>{this.emit(N.SipDTMFReceived,s,o),o==null||o.emit(A.SipDTMFReceived,s)},this.bufferedSegments=new Map,this.handleTranscription=(o,s)=>{const c=s.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(s.transcribedParticipantIdentity),l=c==null?void 0:c.trackPublications.get(s.trackId),u=V2(s,this.transcriptionReceivedTimes);l==null||l.emit(L.TranscriptionReceived,u),c==null||c.emit(A.TranscriptionReceived,u,l),this.emit(N.TranscriptionReceived,u,c,l)},this.handleChatMessage=(o,s)=>{const c=H2(s);this.emit(N.ChatMessage,c,o)},this.handleMetrics=(o,s)=>{this.emit(N.MetricsReceived,o,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(N.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(N.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(N.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(N.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>k(this,void 0,void 0,function*(){var o,s;const c=Me.getInstance().previousDevices,l=yield Me.getInstance().getDevices(void 0,!1),u=Vt();if((u==null?void 0:u.name)==="Chrome"&&u.os!=="iOS")for(let h of l){const p=c.find(f=>f.deviceId===h.deviceId);p&&p.label!==""&&p.kind===h.kind&&p.label!==h.label&&this.getActiveDevice(h.kind)==="default"&&this.emit(N.ActiveDeviceChanged,h.kind,h.deviceId)}const d=["audiooutput","audioinput","videoinput"];for(let h of d){const p=l.filter(b=>b.kind===h),f=this.getActiveDevice(h);if(f===((o=c.filter(b=>b.kind===h)[0])===null||o===void 0?void 0:o.deviceId)&&p.length>0&&((s=p[0])===null||s===void 0?void 0:s.deviceId)!==f){yield this.switchActiveDevice(h,p[0].deviceId);continue}h==="audioinput"&&!$n()||h==="videoinput"||p.length>0&&!p.find(b=>b.deviceId===this.getActiveDevice(h))&&(yield this.switchActiveDevice(h,p[0].deviceId))}this.emit(N.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(N.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(N.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const c=this.getRemoteParticipantBySid(s.participantSid);c&&c.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(N.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(N.ParticipantNameChanged,o,this.localParticipant)},this.onLocalAttributesChanged=o=>{this.emit(N.ParticipantAttributesChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(N.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(N.TrackUnmuted,o,this.localParticipant)},this.onTrackProcessorUpdate=o=>{var s;(s=o==null?void 0:o.onPublish)===null||s===void 0||s.call(o,this)},this.onLocalTrackPublished=o=>k(this,void 0,void 0,function*(){var s,c,l,u,d,h;(s=o.track)===null||s===void 0||s.on(L.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.on(L.Restarted,this.onLocalTrackRestarted),(d=(u=(l=o.track)===null||l===void 0?void 0:l.getProcessor())===null||u===void 0?void 0:u.onPublish)===null||d===void 0||d.call(u,this),this.emit(N.LocalTrackPublished,o,this.localParticipant),ir(o.track)&&(yield o.track.checkForSilence())&&this.emit(N.LocalAudioSilenceDetected,o);const p=yield(h=o.track)===null||h===void 0?void 0:h.getDeviceId(!1),f=Nf(o.source);f&&p&&p!==this.localParticipant.activeDeviceMap.get(f)&&(this.localParticipant.activeDeviceMap.set(f,p),this.emit(N.ActiveDeviceChanged,f,p))}),this.onLocalTrackUnpublished=o=>{var s,c;(s=o.track)===null||s===void 0||s.off(L.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.off(L.Restarted,this.onLocalTrackRestarted),this.emit(N.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalTrackRestarted=o=>k(this,void 0,void 0,function*(){const s=yield o.getDeviceId(!1),c=Nf(o.source);c&&s&&s!==this.localParticipant.activeDeviceMap.get(c)&&(this.log.debug("local track restarted, setting ".concat(c," ").concat(s," active"),this.logContext),this.localParticipant.activeDeviceMap.set(c,s),this.emit(N.ActiveDeviceChanged,c,s))}),this.onLocalConnectionQualityChanged=o=>{this.emit(N.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(N.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(N.ParticipantPermissionsChanged,o,this.localParticipant)},this.onLocalChatMessageSent=o=>{this.emit(N.ChatMessage,o,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},px),e),this.log=vn((r=this.options.loggerName)!==null&&r!==void 0?r:zt.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Pb),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},Rb),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},hx),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new dt,this.localParticipant=new zx("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Vn(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Vn(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",Vn(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),rt()){const o=new AbortController;(a=navigator.mediaDevices)===null||a===void 0||a.addEventListener("devicechange",this.handleDeviceChange,{signal:o.signal}),ki.cleanupRegistry&&ki.cleanupRegistry.register(this,()=>{o.abort()})}}registerTextStreamHandler(e,n){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,n)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,n){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,n)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,n){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,n,r,i,a,o){return k(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,n),o!==1){yield this.engine.publishRpcResponse(e,n,null,Ce.builtIn("UNSUPPORTED_VERSION"));return}const s=this.rpcHandlers.get(r);if(!s){yield this.engine.publishRpcResponse(e,n,null,Ce.builtIn("UNSUPPORTED_METHOD"));return}let c=null,l=null;try{const u=yield s({requestId:n,callerIdentity:e,payload:i,responseTimeout:a});oh(u)>Ib?(c=Ce.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):l=u}catch(u){u instanceof Ce?c=u:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),u),c=Ce.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,n,l,c)})}setE2EEEnabled(e){return k(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new Y2(this.options.e2ee),this.e2eeManager.on(Mn.ParticipantEncryptionStatusChanged,(n,r)=>{W2(r)&&(this.isE2EEEnabled=n),this.emit(N.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Mn.EncryptionError,n=>this.emit(N.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return k(this,void 0,void 0,function*(){return this.state===Y.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const r=i=>{i.sid!==""&&(this.engine.off(D.RoomUpdate,r),e(i.sid))};this.engine.on(D.RoomUpdate,r),this.once(N.Disconnected,()=>{this.engine.off(D.RoomUpdate,r),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Rx(this.options),this.engine.on(D.ParticipantUpdate,this.handleParticipantUpdates).on(D.RoomUpdate,this.handleRoomUpdate).on(D.SpeakersChanged,this.handleSpeakersChanged).on(D.StreamStateChanged,this.handleStreamStateUpdate).on(D.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(D.SubscriptionError,this.handleSubscriptionError).on(D.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(D.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(D.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(D.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(D.DataPacketReceived,this.handleDataPacket).on(D.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Y.SignalReconnecting)&&this.emit(N.SignalReconnecting)}).on(D.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Y.Connected)&&this.emit(N.Reconnected)}).on(D.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Y.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(D.Restarting,this.handleRestarting).on(D.SignalRestarted,this.handleSignalRestarted).on(D.Offline,()=>{this.setAndEmitConnectionState(Y.Reconnecting)&&this.emit(N.Reconnecting)}).on(D.DCBufferStatusChanged,(e,n)=>{this.emit(N.DCBufferStatusChanged,e,n)}).on(D.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:i}=r;return i===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(A.LocalTrackSubscribed,n),this.emitWhenConnected(N.LocalTrackSubscribed,n,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Me.getInstance().getDevices(e,n)}prepareConnection(e,n){return k(this,void 0,void 0,function*(){if(this.state===Y.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(ku(new URL(e))&&n){this.regionUrlProvider=new Pu(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Y.Disconnected&&(this.regionUrl=r,yield fetch(wu(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(wu(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return k(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new $t({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new $t({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new $t({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new $t({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>k(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new $t({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>k(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new $t({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new $t({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>k(this,void 0,void 0,function*(){const a=this.engine.client.onLeave;a&&a(new Ys({reason:jt.CLIENT_INITIATED,action:ai.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new $t({scenario:{case:"subscriberBandwidth",value:rr(n)}});break;case"leave-full-reconnect":i=new $t({scenario:{case:"leaveRequestFullReconnect",value:!0}})}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return k(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var s,c,l,u,d,h,p,f;let b=!0,x=!1;const m=o?{exact:i}:i;if(r==="audioinput"){x=a.localParticipant.audioTrackPublications.size===0;const v=(s=a.getActiveDevice(r))!==null&&s!==void 0?s:a.options.audioCaptureDefaults.deviceId;a.options.audioCaptureDefaults.deviceId=m;const y=Array.from(a.localParticipant.audioTrackPublications.values()).filter(g=>g.source===I.Source.Microphone);try{b=(yield Promise.all(y.map(g=>{var S;return(S=g.audioTrack)===null||S===void 0?void 0:S.setDeviceId(m)}))).every(g=>g===!0)}catch(g){throw a.options.audioCaptureDefaults.deviceId=v,g}}else if(r==="videoinput"){x=a.localParticipant.videoTrackPublications.size===0;const v=(c=a.getActiveDevice(r))!==null&&c!==void 0?c:a.options.videoCaptureDefaults.deviceId;a.options.videoCaptureDefaults.deviceId=m;const y=Array.from(a.localParticipant.videoTrackPublications.values()).filter(g=>g.source===I.Source.Camera);try{b=(yield Promise.all(y.map(g=>{var S;return(S=g.videoTrack)===null||S===void 0?void 0:S.setDeviceId(m)}))).every(g=>g===!0)}catch(g){throw a.options.videoCaptureDefaults.deviceId=v,g}}else if(r==="audiooutput"){if(!yu()&&!a.options.webAudioMix||a.options.webAudioMix&&a.audioContext&&!("setSinkId"in a.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");a.options.webAudioMix&&(i=(l=yield Me.getInstance().normalizeDeviceId("audiooutput",i))!==null&&l!==void 0?l:""),(u=(f=a.options).audioOutput)!==null&&u!==void 0||(f.audioOutput={});const v=(d=a.getActiveDevice(r))!==null&&d!==void 0?d:a.options.audioOutput.deviceId;a.options.audioOutput.deviceId=i;try{a.options.webAudioMix&&((h=a.audioContext)===null||h===void 0||h.setSinkId(i)),yield Promise.all(Array.from(a.remoteParticipants.values()).map(y=>y.setAudioOutput({deviceId:i})))}catch(y){throw a.options.audioOutput.deviceId=v,y}}return(x||r==="audiooutput")&&(a.localParticipant.activeDeviceMap.set(r,r==="audiooutput"&&((p=a.options.audioOutput)===null||p===void 0?void 0:p.deviceId)||i),a.emit(N.ActiveDeviceChanged,r,i)),b}()})}setupLocalParticipantEvents(){this.localParticipant.on(A.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(A.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(A.AttributesChanged,this.onLocalAttributesChanged).on(A.TrackMuted,this.onLocalTrackMuted).on(A.TrackUnmuted,this.onLocalTrackUnmuted).on(A.LocalTrackPublished,this.onLocalTrackPublished).on(A.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(A.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(A.MediaDevicesError,this.onMediaDevicesError).on(A.AudioStreamAcquired,this.startAudio).on(A.ChatMessage,this.onLocalChatMessageSent).on(A.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===Y.Connecting||this.state===Y.Reconnecting){const u=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(N.Reconnected,u),this.off(N.Connected,u),this.off(N.Disconnected,d)};this.once(N.Reconnected,u),this.once(N.Connected,u),this.once(N.Disconnected,d);return}if(this.state===Y.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const i=M2(n.id),a=i[0];let o=i[1],s=e.id;if(o&&o.startsWith("TR")&&(s=o),a===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=Array.from(this.remoteParticipants.values()).find(u=>u.sid===a);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(a),this.logContext);return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,s,n,r,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==Y.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(i=>{i.trackPublications.forEach(a=>{i.unpublishTrack(a.trackSid)})}),this.localParticipant.trackPublications.forEach(i=>{var a,o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e?((a=i.track)===null||a===void 0||a.detach(),(o=i.track)===null||o===void 0||o.stop()):(s=i.track)===null||s===void 0||s.stopMonitor()}),this.localParticipant.off(A.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(A.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(A.AttributesChanged,this.onLocalAttributesChanged).off(A.TrackMuted,this.onLocalTrackMuted).off(A.TrackUnmuted,this.onLocalTrackUnmuted).off(A.LocalTrackPublished,this.onLocalTrackPublished).off(A.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(A.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(A.MediaDevicesError,this.onMediaDevicesError).off(A.AudioStreamAcquired,this.startAudio).off(A.ChatMessage,this.onLocalChatMessageSent).off(A.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),rt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Y.Disconnected),this.emit(N.Disconnected,n)}}}handleParticipantDisconnected(e,n){var r;this.remoteParticipants.delete(e),n&&(n.trackPublications.forEach(i=>{n.unpublishTrack(i.trackSid,!0)}),this.emit(N.ParticipantDisconnected,n),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(n.identity))}handleStreamHeader(e,n){return k(this,void 0,void 0,function*(){var r;if(e.contentHeader.case==="byteHeader"){const i=this.byteStreamHandlers.get(e.topic);if(!i){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let a;const o={id:e.streamId,name:(r=e.contentHeader.value.name)!==null&&r!==void 0?r:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Bo(e.timestamp),attributes:e.attributes},s=new ReadableStream({start:c=>{a=c,this.byteStreamControllers.set(e.streamId,{info:o,controller:a,startTime:Date.now()})}});i(new Mx(o,s,Bo(e.totalLength)),{identity:n})}else if(e.contentHeader.case==="textHeader"){const i=this.textStreamHandlers.get(e.topic);if(!i){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let a;const o={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},s=new ReadableStream({start:c=>{a=c,this.textStreamControllers.set(e.streamId,{info:o,controller:a,startTime:Date.now()})}});i(new Nx(o,s,Bo(e.totalLength)),{identity:n})}})}handleStreamChunk(e){const n=this.byteStreamControllers.get(e.streamId);n&&e.content.length>0&&n.controller.enqueue(e);const r=this.textStreamControllers.get(e.streamId);r&&e.content.length>0&&r.controller.enqueue(e)}handleStreamTrailer(e){const n=this.textStreamControllers.get(e.streamId);n&&(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.textStreamControllers.delete(e.streamId));const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.byteStreamControllers.delete(e.streamId))}acquireAudioContext(){return k(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=xb())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),st(200)])}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(N.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=Rs.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):i=new Rs(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const i=this.remoteParticipants.get(e);return n&&i.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),i}const r=this.createParticipant(e,n);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(N.ParticipantConnected,r),r.on(A.TrackPublished,i=>{this.emitWhenConnected(N.TrackPublished,i,r)}).on(A.TrackSubscribed,(i,a)=>{i.kind===I.Kind.Audio?(i.on(L.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(L.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===I.Kind.Video&&(i.on(L.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(L.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(N.TrackSubscribed,i,a,r)}).on(A.TrackUnpublished,i=>{this.emit(N.TrackUnpublished,i,r)}).on(A.TrackUnsubscribed,(i,a)=>{this.emit(N.TrackUnsubscribed,i,a,r)}).on(A.TrackMuted,i=>{this.emitWhenConnected(N.TrackMuted,i,r)}).on(A.TrackUnmuted,i=>{this.emitWhenConnected(N.TrackUnmuted,i,r)}).on(A.ParticipantMetadataChanged,i=>{this.emitWhenConnected(N.ParticipantMetadataChanged,i,r)}).on(A.ParticipantNameChanged,i=>{this.emitWhenConnected(N.ParticipantNameChanged,i,r)}).on(A.AttributesChanged,i=>{this.emitWhenConnected(N.ParticipantAttributesChanged,i,r)}).on(A.ConnectionQualityChanged,i=>{this.emitWhenConnected(N.ConnectionQualityChanged,i,r)}).on(A.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(N.ParticipantPermissionsChanged,i,r)}).on(A.TrackSubscriptionStatusChanged,(i,a)=>{this.emitWhenConnected(N.TrackSubscriptionStatusChanged,i,a,r)}).on(A.TrackSubscriptionFailed,(i,a)=>{this.emit(N.TrackSubscriptionFailed,i,r,a)}).on(A.TrackSubscriptionPermissionChanged,(i,a)=>{this.emitWhenConnected(N.TrackSubscriptionPermissionChanged,i,a,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,i)=>(r.push(...i.getTrackPublications()),r),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&q2(n)&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Ue.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,jt.STATE_MISMATCH))):e=0},Hx)}clearConnectionReconcile(){this.connectionReconcileInterval&&Ue.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(N.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(this.state===Y.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===Y.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return k(this,void 0,void 0,function*(){var n,r;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),a=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new $d({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:pe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Na({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(N.SignalConnected),this.emit(N.Connected),this.setAndEmitConnectionState(Y.Connected),i.video){const o=new Iu(I.Kind.Video,new Zr({source:xe.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Dt.AUDIO,name:"video-dummy"}),new Ps(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Of(160*((n=a.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(A.LocalTrackPublished,o)}if(i.audio){const o=new Iu(I.Kind.Audio,new Zr({source:xe.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Dt.AUDIO}),new xs(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Vc(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(A.LocalTrackPublished,o)}for(let o=0;o<a.count-1;o+=1){let s=new Na({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:Ql.ACTIVE,tracks:[],joinedAt:pe.parse(Date.now())});const c=this.getOrCreateParticipant(s.identity,s);if(a.video){const l=Of(160*((r=a.aspectRatios[o%a.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),u=new Zr({source:xe.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Dt.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l]),new RTCRtpReceiver),s.tracks=[...s.tracks,u]}if(a.audio){const l=Vc(),u=new Zr({source:xe.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Dt.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l]),new RTCRtpReceiver),s.tracks=[...s.tracks,u]}c.updateInfo(s)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==N.ActiveSpeakersChanged&&e!==N.TranscriptionReceived){const a=Ab(r).filter(o=>o!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:a}))}return super.emit(e,...r)}}ki.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{t()});function Ab(t){return t.map(e=>{if(e)return Array.isArray(e)?Ab(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var Nt;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(Nt||(Nt={}));class Jn extends tn.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Nt.IDLE,this.logs=[],this.options={},this.url=e,this.token=n,this.name=this.constructor.name,this.room=new ki(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return k(this,void 0,void 0,function*(){if(this.status!==Nt.IDLE)throw Error("check is running already");this.setStatus(Nt.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Nt.SKIPPED&&this.setStatus(this.isSuccess()?Nt.SUCCESS:Nt.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return k(this,void 0,void 0,function*(){return this.room.state===Y.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return k(this,void 0,void 0,function*(){this.room&&this.room.state!==Y.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Nt.SKIPPED)}switchProtocol(e){return k(this,void 0,void 0,function*(){let n=!1,r=!1;if(this.room.on(N.Reconnecting,()=>{n=!0}),this.room.once(N.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(a=>setTimeout(a,1e3)),!n)return;const i=Date.now()+1e4;for(;Date.now()<i;){if(r)return;yield st(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class qx extends Jn{get description(){return"Cloud regions"}perform(){return k(this,void 0,void 0,function*(){const e=new Pu(this.url,this.token);if(!e.isCloud()){this.skip();return}const n=[],r=new Set;for(let a=0;a<3;a++){const o=yield e.getNextBestRegionUrl();if(!o)break;if(r.has(o))continue;r.add(o);const s=yield this.checkCloudRegion(o);this.appendMessage("".concat(s.region," RTT: ").concat(s.rtt,"ms, duration: ").concat(s.duration,"ms")),n.push(s)}n.sort((a,o)=>(a.duration-o.duration)*.5+(a.rtt-o.rtt)*.5);const i=n[0];this.bestStats=i,this.appendMessage("best Cloud region: ".concat(i.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return k(this,void 0,void 0,function*(){var n,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const i=(n=this.room.serverInfo)===null||n===void 0?void 0:n.region;if(!i)throw new Error("Region not found");const a=yield this.room.localParticipant.streamText({topic:"test"}),o=1e3,s=1e6/o,c="A".repeat(o),l=Date.now();for(let p=0;p<s;p++)yield a.write(c);yield a.close();const u=Date.now(),d=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),h={region:i,rtt:1e4,duration:u-l};return d==null||d.forEach(p=>{p.type==="candidate-pair"&&p.nominated&&(h.rtt=p.currentRoundTripTime*1e3)}),yield this.disconnect(),h})}}const Qc=1e4;class Wx extends Jn{get description(){return"Connection via UDP vs TCP"}perform(){return k(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),n=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-n.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-n.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=n):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(Qc/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(Qc/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return k(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const n=document.createElement("canvas");n.width=1280,n.height=720;const r=n.getContext("2d");if(!r)throw new Error("Could not get canvas context");let i=0;const a=()=>{i=(i+1)%360,r.fillStyle="hsl(".concat(i,", 100%, 50%)"),r.fillRect(0,0,n.width,n.height),requestAnimationFrame(a)};a();const o=n.captureStream(30).getVideoTracks()[0],s=(yield this.room.localParticipant.publishTrack(o,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,c={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},l=setInterval(()=>k(this,void 0,void 0,function*(){const u=yield s.getRTCStatsReport();u==null||u.forEach(d=>{d.type==="outbound-rtp"?(c.packetsSent=d.packetsSent,c.qualityLimitationDurations=d.qualityLimitationDurations,c.bitrateTotal+=d.targetBitrate,c.count++):d.type==="remote-inbound-rtp"&&(c.packetsLost=d.packetsLost,c.rttTotal+=d.roundTripTime,c.jitterTotal+=d.jitter)})}),1e3);return yield new Promise(u=>setTimeout(u,Qc)),clearInterval(l),o.stop(),n.remove(),yield this.disconnect(),c})}}function jb(t){return k(this,void 0,void 0,function*(){var e,n;t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio={deviceId:"default"}),(n=t.video)!==null&&n!==void 0||(t.video={deviceId:"default"});const{audioProcessor:r,videoProcessor:i}=th(t),a=Sb(t,Pb,Rb),o=ec(a),s=navigator.mediaDevices.getUserMedia(o);t.audio&&(Me.userMediaPromiseMap.set("audioinput",s),s.catch(()=>Me.userMediaPromiseMap.delete("audioinput"))),t.video&&(Me.userMediaPromiseMap.set("videoinput",s),s.catch(()=>Me.userMediaPromiseMap.delete("videoinput")));const c=yield s;return Promise.all(c.getTracks().map(l=>k(this,void 0,void 0,function*(){const u=l.kind==="audio";u?a.audio:a.video;let d;const h=u?o.audio:o.video;typeof h!="boolean"&&(d=h);const p=l.getSettings().deviceId;d!=null&&d.deviceId&&Vn(d.deviceId)!==p?d.deviceId=p:d||(d={deviceId:p});const f=Ob(l,d);return f.kind===I.Kind.Video?f.source=I.Source.Camera:f.kind===I.Kind.Audio&&(f.source=I.Source.Microphone),f.mediaStream=c,bn(f)&&r?yield f.setProcessor(r):xi(f)&&i&&(yield f.setProcessor(i)),f})))})}function $x(t){return k(this,void 0,void 0,function*(){return(yield jb({audio:!1,video:t}))[0]})}function Gx(t){return k(this,void 0,void 0,function*(){return(yield jb({audio:t,video:!1}))[0]})}class Kx extends Jn{get description(){return"Can publish audio"}perform(){return k(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield Gx();if(yield Tb(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let a=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="audio"||!o.kind&&o.mediaType==="audio")&&(a=o.packetsSent)}),a===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(a," audio packets"))})}}class Zx extends Jn{get description(){return"Can publish video"}perform(){return k(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield $x();yield this.checkForVideo(r.mediaStreamTrack),n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,5e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let a=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="video"||!o.kind&&o.mediaType==="video")&&(a+=o.packetsSent)}),a===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(a," video packets"))})}checkForVideo(e){return k(this,void 0,void 0,function*(){const n=new MediaStream;n.addTrack(e.clone());const r=document.createElement("video");r.srcObject=n,r.muted=!0,yield new Promise(i=>{r.onplay=()=>{setTimeout(()=>{var a,o,s,c;const l=document.createElement("canvas"),u=e.getSettings(),d=(o=(a=u.width)!==null&&a!==void 0?a:r.videoWidth)!==null&&o!==void 0?o:1280,h=(c=(s=u.height)!==null&&s!==void 0?s:r.videoHeight)!==null&&c!==void 0?c:720;l.width=d,l.height=h;const p=l.getContext("2d");p.drawImage(r,0,0);const f=p.getImageData(0,0,l.width,l.height).data;let b=!0;for(let x=0;x<f.length;x+=4)if(f[x]!==0||f[x+1]!==0||f[x+2]!==0){b=!1;break}b?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),i()},1e3)},r.play()}),r.remove()})}}class Qx extends Jn{get description(){return"Resuming connection after interruption"}perform(){return k(this,void 0,void 0,function*(){var e;const n=yield this.connect();let r=!1,i=!1,a;const o=new Promise(l=>{setTimeout(l,5e3),a=l}),s=()=>{r=!0};n.on(N.SignalReconnecting,s).on(N.Reconnecting,s).on(N.Reconnected,()=>{i=!0,a(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const c=n.engine.client.onClose;if(c&&c(""),yield o,r){if(!i||n.state!==Y.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Jx extends Jn{get description(){return"Can connect via TURN"}perform(){return k(this,void 0,void 0,function*(){var e,n;const r=new nh,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let a=!1,o=!1,s=!1;for(let c of i.iceServers)for(let l of c.urls)l.startsWith("turn:")?(o=!0,s=!0):l.startsWith("turns:")&&(o=!0,s=!0,a=!0),l.startsWith("stun:")&&(s=!0);s?o&&!a&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class Yx extends Jn{get description(){return"Establishing WebRTC connection"}perform(){return k(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(N.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,a)=>{if(i.candidate){const o=new RTCIceCandidate(i);let s="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(Xx(o.address)?s+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,s+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(s)}r&&r(i,a)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),$.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Xx(t){const e=t.split(".");if(e.length===4){if(e[0]==="10"||e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class eE extends Jn{get description(){return"Connecting to signal connection via WebSocket"}perform(){return k(this,void 0,void 0,function*(){var e,n,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new nh;const a=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(a.serverVersion,".")),((e=a.serverInfo)===null||e===void 0?void 0:e.edition)===x0.Cloud&&!((n=a.serverInfo)===null||n===void 0)&&n.region&&this.appendMessage("LiveKit Cloud: ".concat((r=a.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class qE extends tn.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Nt.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Nt.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return k(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token,this.options),i=o=>{this.updateCheck(n,o)};r.on("update",i);const a=yield r.run();return r.off("update",i),a})}checkWebsocket(){return k(this,void 0,void 0,function*(){return this.createAndRunCheck(eE)})}checkWebRTC(){return k(this,void 0,void 0,function*(){return this.createAndRunCheck(Yx)})}checkTURN(){return k(this,void 0,void 0,function*(){return this.createAndRunCheck(Jx)})}checkReconnect(){return k(this,void 0,void 0,function*(){return this.createAndRunCheck(Qx)})}checkPublishAudio(){return k(this,void 0,void 0,function*(){return this.createAndRunCheck(Kx)})}checkPublishVideo(){return k(this,void 0,void 0,function*(){return this.createAndRunCheck(Zx)})}checkConnectionProtocol(){return k(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(Wx);if(e.data&&"protocol"in e.data){const n=e.data;this.options.protocol=n.protocol}return e})}checkCloudRegion(){return k(this,void 0,void 0,function*(){return this.createAndRunCheck(qx)})}}const tE=({active:t,handler:e})=>{const n=B.useRef(null),[r,i]=B.useState("inactive"),[a,o]=B.useState(!1),s=B.useCallback(()=>{var c;(c=n.current)==null||c.disconnect().catch(l=>{console.warn(l)}),n.current=null},[]);return B.useEffect(()=>{s();const c=()=>{s()};return window.addEventListener("beforeunload",c),()=>{window.removeEventListener("beforeunload",c)}},[s]),B.useEffect(()=>{if(!t){s();return}(async()=>{try{const c=new ki;i("pending");const l=await e.getLiveKitCredentials(),u=h=>{h.kind===I.Kind.Audio&&h.attach().play().catch(p=>{console.warn(p)})},d=h=>{o(h)};await c.prepareConnection(l.url,l.token),c.on(N.TrackSubscribed,u),c.localParticipant.on(A.IsSpeakingChanged,d),await c.connect(l.url,l.token,{autoSubscribe:!0}),await c.localParticipant.setMicrophoneEnabled(!0),await c.startAudio(),i("active")}catch(c){i("error"),console.warn(c),e.terminateLiveKitCall().catch(l=>{console.warn(l)})}})()},[t,s,i,e]),{roomState:r,isUserSpeaking:a}},Qf=8,nE=({className:t,choiceMessage:e,handler:n,voiceEnabled:r,uploadUrl:i,onFileUpload:a,enabled:o})=>{const[s,c]=B.useState(!1),[l,u]=B.useState(""),[d,h]=B.useState(null),[p,f]=B.useState(null),b=B.useRef(null),x=B.useRef(null),m=zv(),[v,y]=B.useState(!1),{roomState:g,isUserSpeaking:S}=tE({active:v,handler:n});B.useEffect(()=>{var G;m&&((G=x.current)==null||G.focus())},[m]);const w=B.useMemo(()=>l.trim()==="",[l]),[T,E]=B.useState(!1),_=w&&p==null||T||!o,M=()=>{if(_)return;const G=(gt,ze)=>{(ze==null?void 0:ze.type)==="bot"&&(E(!1),n.unsubscribe(G),u(""),f(null),m&&setTimeout(()=>{var Le;(Le=x.current)==null||Le.focus()}))};n.subscribe(G),E(!0),i!=null&&p!=null?n.sendStructured({uploadIds:[i.uploadId],utterance:l}):n.sendText(l)},F=i!=null&&o,H=()=>{h("Something went wrong. Please try again.")},ee=G=>{var gt,ze;if(i==null){H();return}const Le=(ze=(gt=G.target)==null?void 0:gt.files)==null?void 0:ze[0];if(Le==null){H();return}const{name:j,size:z,type:V}=Le;if(f({name:j,size:z,type:V}),z/1024**2>Qf){h(`The file is too big. Max file size: ${Qf}mb`);return}fetch(i.url,{method:"PUT",headers:{"Content-Type":"image/jpeg"},body:Le}).then(()=>{h(null),a({uploadId:i.uploadId,file:Le})}).catch(()=>{H()})};return C.jsxs("div",{className:ae("p-2 md:p-3 relative",t),children:[e!=null?C.jsx(iS,{...e,handler:n,className:ae("absolute inset-x-0 z-10 top-0 transform -translate-y-full px-2 md:px-3",e.message.selectedChoiceId!=null?"md:top-2":"md:top-1")}):null,(e==null?void 0:e.message.selectedChoiceId)!=null?null:C.jsxs("div",{className:ae("bg-primary-5 transition-colors duration-200 p-2 rounded-outer text-base font-normal",s?"":"hover:bg-secondary-20"),children:[d!=null&&C.jsxs("div",{className:"flex items-center py-1 mb-2 w-full bg-error-secondary rounded-inner",children:[C.jsx(Wl,{size:16}),C.jsx("span",{className:"truncate ml-1",children:d})]}),p&&C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[C.jsxs("p",{className:"flex items-center truncate mx-2",children:[d!=null?C.jsx(Wl,{size:16,className:"text-error-primary"}):C.jsx(Iv,{size:16,className:"text-primary-60"}),C.jsx("span",{className:"truncate ml-3",children:p.name})]}),C.jsx(dn,{className:"flex-none",Icon:Mv,label:"Delete",onClick:F?()=>{f(null),h(null),b.current!=null&&(b.current.value="")}:void 0,type:"ghost"})]}),C.jsx("hr",{className:"border-b-px border-background mb-2 -mx-2"})]}),C.jsxs("div",{className:ae("flex items-end gap-1"),children:[r?C.jsx(dn,{className:ae("flex-none",v&&S?"shadow-[0_0_8px_var(--accent-20)]":""),Icon:v?Dv:Lv,label:"Voice",type:v?g==="error"?"error":"activated":"ghost",onClick:g==="pending"?void 0:()=>{y(G=>!G)}}):null,F&&p==null?C.jsxs(C.Fragment,{children:[C.jsx("label",{htmlFor:"file-upload",className:"p-3 w-10 h-10 flex-none block transition-colors rounded-inner bg-primary-80 hover:bg-primary-80 text-secondary-80 cursor-pointer",children:C.jsx(ql,{})}),C.jsx("input",{type:"file",id:"file-upload",className:"sr-only",accept:".jpg, .jpeg, .png, .webp, .mp4, .mpeg4, .avi, .mov, .pdf",onChange:ee,ref:b})]}):C.jsx(dn,{className:"flex-none",Icon:ql,label:"Upload file",type:"ghost"}),C.jsx(SS,{disabled:T||!o,className:ae("h-10 w-full resize-none mr-2 px-2 py-2 outline-none","bg-transparent text-primary-80 placeholder:text-primary-40 caret-accent","disabled:text-primary-40"),placeholder:"Type something",maxRows:10,onFocus:()=>{c(!0)},onBlur:()=>{c(!1)},value:l,onChange:G=>{u(G.target.value)},onKeyDown:G=>{G.key==="Enter"&&!G.shiftKey&&(G.preventDefault(),M())},ref:x}),C.jsx(dn,{className:"flex-none",label:"Send message",onClick:_?void 0:()=>{M()},type:"main",Icon:Gs})]})]})]})},rE=t=>({"--font-family":t.fontFamily,"--inner-border-radius":t.innerBorderRadius,"--outer-border-radius":t.outerBorderRadius,"--primary-80":t.primary80,"--primary-60":t.primary60,"--primary-40":t.primary40,"--primary-20":t.primary20,"--primary-10":t.primary10,"--primary-5":t.primary5,"--primary-1":t.primary1,"--secondary-80":t.secondary80,"--secondary-60":t.secondary60,"--secondary-40":t.secondary40,"--secondary-20":t.secondary20,"--secondary-10":t.secondary10,"--secondary-5":t.secondary5,"--secondary-1":t.secondary1,"--accent":t.accent,"--accent-20":t.accent20,"--background":t.background,"--overlay":t.overlay,"--warning-primary":t.warningPrimary,"--warning-secondary":t.warningSecondary,"--error-primary":t.errorPrimary,"--error-secondary":t.errorSecondary}),iE={fontFamily:'"Neue Haas Grotesk", sans-serif',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"rgba(0, 2, 9, 0.8)",primary60:"rgba(0, 2, 9, 0.6)",primary40:"rgba(0, 2, 9, 0.4)",primary20:"rgba(0, 2, 9, 0.2)",primary10:"rgba(0, 2, 9, 0.1)",primary5:"rgba(0, 2, 9, 0.05)",primary1:"rgba(0, 2, 9, 0.01)",secondary80:"rgba(255, 255, 255, 0.85)",secondary60:"rgba(255, 255, 255, 0.65)",secondary40:"rgba(255, 255, 255, 0.45)",secondary20:"rgba(255, 255, 255, 0.25)",secondary10:"rgba(255, 255, 255, 0.15)",secondary5:"rgba(255, 255, 255, 0.08)",secondary1:"rgba(255, 255, 255, 0.01)",accent:"rgb(28, 99, 218)",accent20:"rgba(28, 99, 218, 0.2)",background:"rgba(220, 220, 220, 0.9)",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"rgb(220, 159, 3)",warningSecondary:"rgb(255, 242, 209)",errorPrimary:"rgb(157, 3, 3)",errorSecondary:"rgb(255, 223, 230)"},aE={fontFamily:'"Neue Haas Grotesk", sans-serif',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"rgba(255, 255, 255, 0.85)",primary60:"rgba(255, 255, 255, 0.65)",primary40:"rgba(255, 255, 255, 0.45)",primary20:"rgba(255, 255, 255, 0.25)",primary10:"rgba(255, 255, 255, 0.15)",primary5:"rgba(255, 255, 255, 0.08)",primary1:"rgba(255, 255, 255, 0.01)",secondary80:"rgba(0, 2, 9, 0.8)",secondary60:"rgba(0, 2, 9, 0.6)",secondary40:"rgba(0, 2, 9, 0.4)",secondary20:"rgba(0, 2, 9, 0.2)",secondary10:"rgba(0, 2, 9, 0.1)",secondary5:"rgba(0, 2, 9, 0.05)",secondary1:"rgba(0, 2, 9, 0.01)",accent:"rgb(174, 202, 255)",accent20:"rgba(174, 202, 255, 0.25)",background:"rgba(0, 2, 9, 0.9)",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"rgb(255, 214, 108)",warningSecondary:"rgb(95, 65, 29)",errorPrimary:"rgb(255, 133, 162)",errorSecondary:"rgb(94, 4, 4)"},_u=({colorMode:t,children:e,theme:n,className:r})=>{const i={...t==="dark"?aE:iE,...n??{}};return C.jsx("div",{className:ae(r),style:{...rE(i),colorScheme:t},children:e})},Ub=B.forwardRef((t,e)=>{var n,r,i;const a=B.useMemo(()=>yw(t.config),[t.config]),[o,s]=B.useState([]),c=((n=o[o.length-1])==null?void 0:n.type)==="user",l=t.colorMode??"dark",[u,d]=B.useState(t.embedded),h=bw(t.config),[p,f]=B.useState(!1),b=B.useRef(t.embedded),x=B.useCallback(E=>{t.onClose!=null&&(t.onClose(E),E.defaultPrevented||d(!1))},[t.onClose,d]);B.useEffect(()=>{b.current=u},[u]),B.useImperativeHandle(e,()=>({setExpanded:d,getExpanded(){return b.current},getConversationHandler(){return a}}),[a,d]),B.useEffect(()=>{const E=_=>{s(_)};return a.subscribe(E),()=>{a.unsubscribe(E)}},[a,s]);const m=B.useRef(!1);B.useEffect(()=>{!u||m.current||(m.current=!0,t.initializeConversation(a))},[t.initializeConversation,a,u]);const v=t.windowSize??(t.embedded?"full":"half"),y=B.useMemo(()=>{const E=Ap(M=>M.type==="bot",o);if(E===-1)return null;const _=o[E];return(_==null?void 0:_.type)!=="bot"?null:{index:E,response:_}},[o]),g=B.useMemo(()=>{if(y==null)return;const E=Ap(M=>M.choices.length>0,y.response.payload.messages);if(E===-1)return;const _=y.response.payload.messages[E];if(_!=null)return{message:_,messageIndex:E,responseIndex:y.index}},[y]),[S,w]=B.useState({}),T=t.customModalities??{};return a==null?null:C.jsx(C.Fragment,{children:u?C.jsxs(_u,{theme:t.theme,colorMode:l,className:"grid grid-cols-2 xl:grid-cols-[1fr_632px] fixed inset-0 z-touchpoint",children:[v==="half"?C.jsx("div",{className:"hidden md:block bg-overlay"}):null,C.jsxs("div",{className:ae("w-full bg-background text-primary-80 flex relative flex-col h-full backdrop-blur-overlay",{"col-span-2 md:col-span-1":v==="half","col-span-2":v==="full"}),children:[C.jsx(mC,{windowSize:t.embedded?"embedded":v,colorMode:l,brandIcon:t.brandIcon,isSettingsOpen:p,enabled:t.enabled,toggleSettings:t.enableSettings?()=>{f(E=>!E)}:void 0,renderCollapse:t.onClose!=null,collapse:x,reset:()=>{a.reset({clearResponses:!0}),a.sendWelcomeIntent()}}),p?C.jsx(gC,{className:ae("flex-none",v==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{f(!1)},handler:a}):C.jsxs(C.Fragment,{children:[h?C.jsx(oS,{enabled:t.enabled,isWaiting:c,lastBotResponseIndex:y==null?void 0:y.index,responses:o,colorMode:l,handler:a,uploadedFiles:S,customModalities:T,className:ae("flex-grow",v==="full"?"w-full md:max-w-content md:mx-auto":"")}):C.jsx(sS,{}),C.jsx(nE,{className:ae("flex-none",v==="full"?"w-full md:max-w-content md:mx-auto":""),enabled:t.enabled,choiceMessage:g,handler:a,voiceEnabled:t.input==="textAndVoice",uploadUrl:(i=(r=y==null?void 0:y.response.payload.metadata)==null?void 0:r.uploadUrls)==null?void 0:i[0],onFileUpload:({uploadId:E,file:_})=>{w(M=>({...M,[E]:_}))}})]})]})]}):t.launchIcon!==!1?C.jsx(_u,{className:"font-sans",theme:t.theme,colorMode:l,children:C.jsx(iC,{className:"fixed z-100 bottom-2 right-2 backdrop-blur z-launchButton",iconUrl:typeof t.launchIcon=="string"?t.launchIcon:void 0,onClick:()=>{d(!0)},label:"Expand chat"})}):null})});Ub.displayName="App";const Fb=`*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:var(--font-family);font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*{font-family:var(--font-family)!important}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.visible{visibility:visible}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.inset-x-0{left:0;right:0}.bottom-2{bottom:.5rem}.left-1\\/2{left:50%}.right-2{right:.5rem}.top-0{top:0}.top-1\\/2{top:50%}.z-10{z-index:10}.z-launchButton{z-index:100}.z-touchpoint{z-index:1000}.col-span-1{grid-column:span 1 / span 1}.col-span-2{grid-column:span 2 / span 2}.-mx-2{margin-left:-.5rem;margin-right:-.5rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-auto{margin-left:auto}.mr-2{margin-right:.5rem}.block{display:block}.inline{display:inline}.flex{display:flex}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-10{height:2.5rem}.h-20{height:5rem}.h-24{height:6rem}.h-4{height:1rem}.h-52{height:13rem}.h-64{height:16rem}.h-72{height:18rem}.h-8{height:2rem}.h-\\[1px\\]{height:1px}.h-\\[360px\\]{height:360px}.h-full{height:100%}.min-h-full{min-height:100%}.w-10{width:2.5rem}.w-20{width:5rem}.w-24{width:6rem}.w-4{width:1rem}.w-72{width:18rem}.w-8{width:2rem}.w-80{width:20rem}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.max-w-content{max-width:608px}.flex-none{flex:none}.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-full{--tw-translate-y: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.resize-none{resize:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-\\[320px\\,1fr\\]{grid-template-columns:320px 1fr}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.space-y-px>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1px * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.rounded-inner{border-radius:var(--inner-border-radius)}.rounded-outer{border-radius:var(--outer-border-radius)}.border{border-width:1px}.border-background{border-color:var(--background)}.bg-accent{background-color:var(--accent)}.bg-background{background-color:var(--background)}.bg-black\\/50{background-color:#00000080}.bg-error-primary{background-color:var(--error-primary)}.bg-error-secondary{background-color:var(--error-secondary)}.bg-overlay{background-color:var(--overlay)}.bg-primary-5{background-color:var(--primary-5)}.bg-primary-80{background-color:var(--primary-80)}.bg-secondary-60{background-color:var(--secondary-60)}.bg-transparent{background-color:transparent}.object-cover{-o-object-fit:cover;object-fit:cover}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\\.5{padding-top:.625rem;padding-bottom:.625rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pb-1{padding-bottom:.25rem}.pl-10{padding-left:2.5rem}.pl-4{padding-left:1rem}.pr-10{padding-right:2.5rem}.pr-2{padding-right:.5rem}.pt-3{padding-top:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-sans{font-family:var(--font-family)}.text-base{font-size:1rem;line-height:1.5rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-normal{font-weight:400}.text-accent{color:var(--accent)}.text-error-primary{color:var(--error-primary)}.text-primary-20{color:var(--primary-20)}.text-primary-40{color:var(--primary-40)}.text-primary-60{color:var(--primary-60)}.text-primary-80{color:var(--primary-80)}.text-secondary-40{color:var(--secondary-40)}.text-secondary-80{color:var(--secondary-80)}.placeholder-primary-20::-moz-placeholder{color:var(--primary-20)}.placeholder-primary-20::placeholder{color:var(--primary-20)}.placeholder-primary-40::-moz-placeholder{color:var(--primary-40)}.placeholder-primary-40::placeholder{color:var(--primary-40)}.caret-accent{caret-color:var(--accent)}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-\\[0\\.01\\]{opacity:.01}.shadow-\\[0_0_8px_var\\(--accent-20\\)\\]{--tw-shadow: 0 0 8px var(--accent-20);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.outline-0{outline-width:0px}.outline-2{outline-width:2px}.outline-accent{outline-color:var(--accent)}.drop-shadow{--tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / .1)) drop-shadow(0 1px 1px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur{--tw-backdrop-blur: blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-overlay{--tw-backdrop-blur: blur(48px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-500{transition-duration:.5s}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}@property --glow-opacity{syntax: "<percentage>"; inherits: false; initial-value: 0%;}.fullscreen-error svg{animation:error-glow 3s ease infinite;--glow-opacity: 0%;filter:drop-shadow(0 0 6px color-mix(in srgb,transparent,var(--accent) var(--glow-opacity)))}@keyframes error-glow{0%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}22%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}35%{color:var(--accent);fill-opacity:80%;--glow-opacity: 60%}45%{color:var(--accent);fill-opacity:70%;--glow-opacity: 30%}55%{color:var(--accent);fill-opacity:60%;--glow-opacity: 60%}60%{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}to{color:var(--primary);fill-opacity:8%;--glow-opacity: 0%}}.placeholder\\:text-primary-40::-moz-placeholder{color:var(--primary-40)}.placeholder\\:text-primary-40::placeholder{color:var(--primary-40)}.before\\:absolute:before{content:var(--tw-content);position:absolute}.before\\:inset-0:before{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.before\\:-z-10:before{content:var(--tw-content);z-index:-10}.before\\:bg-transparent:before{content:var(--tw-content);background-color:transparent}.before\\:transition-colors:before{content:var(--tw-content);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.before\\:content-\\[\\'\\'\\]:before{--tw-content: "";content:var(--tw-content)}.after\\:pointer-events-none:after{content:var(--tw-content);pointer-events:none}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:inset-0:after{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.after\\:rounded-outer:after{content:var(--tw-content);border-radius:var(--outer-border-radius)}.after\\:content-\\[\\'\\'\\]:after{--tw-content: "";content:var(--tw-content)}.hover\\:bg-primary-80:hover{background-color:var(--primary-80)}.hover\\:bg-secondary-20:hover{background-color:var(--secondary-20)}.hover\\:text-primary-80:hover{color:var(--primary-80)}.hover\\:after\\:bg-primary-10:hover:after{content:var(--tw-content);background-color:var(--primary-10)}.focus\\:outline-0:focus{outline-width:0px}.focus\\:before\\:bg-primary-10:focus:before{content:var(--tw-content);background-color:var(--primary-10)}.focus\\:before\\:bg-primary-40:focus:before{content:var(--tw-content);background-color:var(--primary-40)}.focus\\:before\\:bg-primary-5:focus:before{content:var(--tw-content);background-color:var(--primary-5)}.focus\\:before\\:bg-primary-80:focus:before{content:var(--tw-content);background-color:var(--primary-80)}.enabled\\:hover\\:before\\:bg-primary-10:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-10)}.enabled\\:hover\\:before\\:bg-primary-40:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-40)}.enabled\\:hover\\:before\\:bg-primary-5:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-5)}.enabled\\:hover\\:before\\:bg-primary-80:hover:enabled:before{content:var(--tw-content);background-color:var(--primary-80)}.enabled\\:active\\:before\\:bg-secondary-10:active:enabled:before{content:var(--tw-content);background-color:var(--secondary-10)}.disabled\\:bg-accent-20:disabled{background-color:var(--accent-20)}.disabled\\:bg-primary-10:disabled{background-color:var(--primary-10)}.disabled\\:bg-primary-5:disabled{background-color:var(--primary-5)}.disabled\\:bg-secondary-20:disabled{background-color:var(--secondary-20)}.disabled\\:text-primary-20:disabled{color:var(--primary-20)}.disabled\\:text-primary-40:disabled{color:var(--primary-40)}.disabled\\:text-secondary-40:disabled{color:var(--secondary-40)}@media (min-width: 768px){.md\\:absolute{position:absolute}.md\\:left-0{left:0}.md\\:right-0{right:0}.md\\:top-0{top:0}.md\\:top-1{top:.25rem}.md\\:top-2{top:.5rem}.md\\:-order-1{order:-1}.md\\:col-span-1{grid-column:span 1 / span 1}.md\\:mx-auto{margin-left:auto;margin-right:auto}.md\\:block{display:block}.md\\:w-fit{width:-moz-fit-content;width:fit-content}.md\\:max-w-content{max-width:608px}.md\\:-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.md\\:flex-col{flex-direction:column}.md\\:p-3{padding:.75rem}.md\\:px-3{padding-left:.75rem;padding-right:.75rem}}@media (min-width: 1280px){.xl\\:grid-cols-\\[1fr_632px\\]{grid-template-columns:1fr 632px}}`,oE=({children:t,faded:e})=>C.jsx("p",{className:ae("text-base",e?"text-primary-60":"text-primary-80"),children:t}),sE=({children:t})=>C.jsx("p",{className:"text-sm text-primary-60",children:t}),cE=({children:t,selected:e,onClick:n})=>C.jsx("div",{className:ae("block shrink-0 rounded-inner overflow-hidden","w-80 space-y-px",e?"outline outline-2 outline-accent":""),onClick:n,children:t}),lE=({src:t,alt:e})=>C.jsx("img",{src:t,alt:e,className:"w-full h-52 object-cover"}),uE=({left:t,right:e,icon:n})=>C.jsxs("div",{className:"flex items-center relative justify-between gap-2 bg-primary-5 px-3 py-4",children:[C.jsx("div",{className:"space-y-1 text-left",children:t}),C.jsx("div",{className:"space-y-1 text-right",children:e}),n!=null?C.jsx(n,{className:"text-primary-60 w-4 h-4 absolute top-1/2 left-1/2 transform -translate-y-1/2 -translate-x-1/2"}):null]});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Bb=function(t,e){return(Bb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(t,e)},dE,fo,hE=(function(t){/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var a=arguments[i];if(a){var o=typeof a;if(o==="string"||o==="number")r.push(a);else if(Array.isArray(a)&&a.length){var s=n.apply(null,a);s&&r.push(s)}else if(o==="object")for(var c in a)e.call(a,c)&&a[c]&&r.push(c)}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()}(fo={path:dE,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e==null&&fo.path)}},fo.exports),fo.exports);function Ou(t,e,n){var r,i,a,o,s;function c(){var u=Date.now()-o;u<e&&u>=0?r=setTimeout(c,e-u):(r=null,n||(s=t.apply(a,i),a=i=null))}e==null&&(e=100);var l=function(){a=this,i=arguments,o=Date.now();var u=n&&!r;return r||(r=setTimeout(c,e)),u&&(s=t.apply(a,i),a=i=null),s};return l.clear=function(){r&&(clearTimeout(r),r=null)},l.flush=function(){r&&(s=t.apply(a,i),a=i=null,clearTimeout(r),r=null)},l}Ou.debounce=Ou;var pE=Ou;(function(t,e){e===void 0&&(e={});var n=e.insertAt;if(typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",n==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var Jc,fE=(Jc="indiana-scroll-container",function(t,e){if(!t)return Jc;var n;typeof t=="string"?n=t:e=t;var r=Jc;return n&&(r+="__"+n),r+(e?Object.keys(e).reduce(function(i,a){var o=e[a];return o&&(i+=" "+(typeof o=="boolean"?r+"--"+a:r+"--"+a+"_"+o)),i},""):"")}),mE=function(t){function e(n){var r=t.call(this,n)||this;return r.onEndScroll=function(){r.scrolling=!1,!r.pressed&&r.started&&r.processEnd()},r.onScroll=function(i){var a=r.container.current;a.scrollLeft===r.scrollLeft&&a.scrollTop===r.scrollTop||(r.scrolling=!0,r.processScroll(i),r.onEndScroll())},r.onTouchStart=function(i){var a=r.props.nativeMobileScroll;if(r.isDraggable(i.target))if(r.internal=!0,a&&r.scrolling)r.pressed=!0;else{var o=i.touches[0];r.processClick(i,o.clientX,o.clientY),!a&&r.props.stopPropagation&&i.stopPropagation()}},r.onTouchEnd=function(i){var a=r.props.nativeMobileScroll;r.pressed&&(!r.started||r.scrolling&&a?r.pressed=!1:r.processEnd(),r.forceUpdate())},r.onTouchMove=function(i){var a=r.props.nativeMobileScroll;if(r.pressed&&(!a||!r.isMobile)){var o=i.touches[0];o&&r.processMove(i,o.clientX,o.clientY),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation()}},r.onMouseDown=function(i){r.isDraggable(i.target)&&r.isScrollable()&&(r.internal=!0,r.props.buttons.indexOf(i.button)!==-1&&(r.processClick(i,i.clientX,i.clientY),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation()))},r.onMouseMove=function(i){r.pressed&&(r.processMove(i,i.clientX,i.clientY),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation())},r.onMouseUp=function(i){r.pressed&&(r.started?r.processEnd():(r.internal=!1,r.pressed=!1,r.forceUpdate(),r.props.onClick&&r.props.onClick(i)),i.preventDefault(),r.props.stopPropagation&&i.stopPropagation())},r.container=mr.createRef(),r.onEndScroll=pE(r.onEndScroll,300),r.scrolling=!1,r.started=!1,r.pressed=!1,r.internal=!1,r.getRef=r.getRef.bind(r),r}return function(n,r){function i(){this.constructor=n}Bb(n,r),n.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}(e,t),e.prototype.componentDidMount=function(){var n=this.props.nativeMobileScroll,r=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),r.addEventListener("touchstart",this.onTouchStart,{passive:!1}),r.addEventListener("mousedown",this.onMouseDown,{passive:!1}),n&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},e.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},e.prototype.getElement=function(){return this.container.current},e.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},e.prototype.isDraggable=function(n){var r=this.props.ignoreElements;if(r){var i=n.closest(r);return i===null||i.contains(this.getElement())}return!0},e.prototype.isScrollable=function(){var n=this.container.current;return n&&(n.scrollWidth>n.clientWidth||n.scrollHeight>n.clientHeight)},e.prototype.processClick=function(n,r,i){var a=this.container.current;this.scrollLeft=a.scrollLeft,this.scrollTop=a.scrollTop,this.clientX=r,this.clientY=i,this.pressed=!0},e.prototype.processStart=function(n){n===void 0&&(n=!0);var r=this.props.onStartScroll;this.started=!0,n&&document.body.classList.add("indiana-dragging"),r&&r({external:!this.internal}),this.forceUpdate()},e.prototype.processScroll=function(n){if(this.started){var r=this.props.onScroll;r&&r({external:!this.internal})}else this.processStart(!1)},e.prototype.processMove=function(n,r,i){var a=this.props,o=a.horizontal,s=a.vertical,c=a.activationDistance,l=a.onScroll,u=this.container.current;this.started?(o&&(u.scrollLeft-=r-this.clientX),s&&(u.scrollTop-=i-this.clientY),l&&l({external:!this.internal}),this.clientX=r,this.clientY=i,this.scrollLeft=u.scrollLeft,this.scrollTop=u.scrollTop):(o&&Math.abs(r-this.clientX)>c||s&&Math.abs(i-this.clientY)>c)&&(this.clientX=r,this.clientY=i,this.processStart())},e.prototype.processEnd=function(){var n=this.props.onEndScroll;this.container.current&&n&&n({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},e.prototype.getRef=function(n){[this.container,this.props.innerRef].forEach(function(r){r&&(typeof r=="function"?r(n):r.current=n)})},e.prototype.render=function(){var n=this.props,r=n.children,i=n.draggingClassName,a=n.className,o=n.style,s=n.hideScrollbars,c=n.component;return mr.createElement(c,{className:hE(a,this.pressed&&i,fE({dragging:this.pressed,"hide-scrollbars":s,"native-scroll":this.isMobile})),style:o,ref:this.getRef,onScroll:this.onScroll},r)},e.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},e}(B.PureComponent);const gE=({children:t})=>C.jsx(mE,{className:"flex gap-x-2 pt-3 pb-1 overflow-x-auto no-scrollbar px-2 -mx-2",children:t});function Jf(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function vE(t,e,n){return e=_s(e),function(r,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(r)}(t,Hb()?Reflect.construct(e,n||[],_s(t).constructor):e.apply(t,n))}function bE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yE(t,e,n){return Object.defineProperty(t,"prototype",{writable:!1}),t}function zb(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(c,l){if(c){if(typeof c=="string")return Jf(c,l);var u={}.toString.call(c).slice(8,-1);return u==="Object"&&c.constructor&&(u=c.constructor.name),u==="Map"||u==="Set"?Array.from(c):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?Jf(c,l):void 0}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return o=c.done,c},e:function(c){s=!0,a=c},f:function(){try{o||n.return==null||n.return()}finally{if(s)throw a}}}}function Vb(t,e,n){return(e=function(r){var i=function(a,o){if(typeof a!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var c=s.call(a,o||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(a)}(r,"string");return typeof i=="symbol"?i:i+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Is(){return Is=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Is.apply(null,arguments)}function _s(t){return _s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_s(t)}function kE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mu(t,e)}function Hb(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hb=function(){return!!t})()}function Yf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function mo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Yf(Object(n),!0).forEach(function(r){Vb(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yf(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function qb(t,e){if(t==null)return{};var n,r,i=function(o,s){if(o==null)return{};var c={};for(var l in o)if({}.hasOwnProperty.call(o,l)){if(s.includes(l))continue;c[l]=o[l]}return c}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Mu(t,e){return Mu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Mu(t,e)}function ha(t,e){var n,r=e.replacementChars,i=e.replacement,a=e.separate,o=r,s="",c=zb(t);try{for(c.s();!(n=c.n()).done;){var l,u=n.value,d=!Object.prototype.hasOwnProperty.call(i,u)&&((l=i[o[0]])===null||l===void 0?void 0:l.test(u));(a&&u===o[0]||d)&&(o=o.slice(1),s+=u)}}catch(h){c.e(h)}finally{c.f()}return s}function Wb(t,e){var n,r=e.mask,i=e.replacement,a=e.separate,o=e.showMask,s=0,c="",l=zb(r);try{for(l.s();!(n=l.n()).done;){var u=n.value;if(!o&&t[s]===void 0)break;Object.prototype.hasOwnProperty.call(i,u)&&t[s]!==void 0?c+=t[s++]:c+=u}}catch(h){l.e(h)}finally{l.f()}if(a&&!o){for(var d=r.length-1;d>=0&&c[d]===r[d];d--);c=c.slice(0,d+1)}return c}function $b(t,e){for(var n=e.mask,r=e.replacement,i=[],a=0;a<n.length;a++){var o,s=(o=t[a])!==null&&o!==void 0?o:n[a],c=Object.prototype.hasOwnProperty.call(r,s)?"replacement":t[a]!==void 0&&t[a]!==n[a]?"input":"mask";i.push({type:c,value:s,index:a})}return i}function Ei(t){return t.length>0?Vb({},t,/./):{}}function Nu(t,e){for(var n=e.start,r=n===void 0?0:n,i=e.end,a=e.mask,o=e.replacement,s=e.separate,c=t.slice(r,i),l=a.slice(r,i),u="",d=0;d<l.length;d++){var h=Object.prototype.hasOwnProperty.call(o,l[d]);h&&c[d]!==void 0&&c[d]!==l[d]?u+=c[d]:h&&s&&(u+=l[d])}return u}function Gb(t,e){var n=e.mask,r=e.replacement,i=typeof r=="string"?Ei(r):r,a=RegExp("[^".concat(Object.keys(i).join(""),"]"),"g");return Wb(ha(t,{replacementChars:n.replace(a,""),replacement:i,separate:!1}),{mask:n,replacement:i,separate:!1,showMask:!1})}function wE(t,e){var n=e.mask,r=e.replacement,i=typeof r=="string"?Ei(r):r,a=Nu(t,{mask:n,replacement:i,separate:!1}),o=RegExp("[^".concat(Object.keys(i).join(""),"]"),"g");return ha(a,{replacementChars:n.replace(o,""),replacement:i,separate:!1})}function CE(t,e){var n=e.mask,r=e.replacement,i=typeof r=="string"?Ei(r):r;return $b(Gb(t,{mask:n,replacement:i}),{mask:n,replacement:i})}var SE=["[","]","\\","/","^","$",".","|","?","*","+","(",")","{","}"];function Xf(t){return SE.includes(t)?"\\".concat(t):t}function TE(t,e){for(var n=e.mask,r=e.replacement,i=typeof r=="string"?Ei(r):r,a=t==="partial"||t==="partial-inexact",o=t==="full"||t==="partial",s="",c=0;c<n.length;c++){var l=n[c];c===0&&(s="^"),a&&(s+="("),s+=Object.prototype.hasOwnProperty.call(i,l)?"".concat(o?"(?!".concat(Xf(l),")"):"","(").concat(i[l].source,")"):Xf(l),c===n.length-1&&(a&&(s+=")?".repeat(n.length)),s+="$")}return s}function xE(t,e){return new Proxy(t,{set:function(n,r,i){return r==="current"&&(i!==t.current&&(t.current!==null&&e.unregister(t.current),i!==null&&e.register(i)),n[r]=i,!0)}})}function EE(t,e,n){return e=Da(e),function(r,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(r)}(t,ch()?Reflect.construct(e,n||[],Da(t).constructor):e.apply(t,n))}function Kb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zb(t,e,n){return Object.defineProperty(t,"prototype",{writable:!1}),t}function PE(t,e,n){return(e=function(r){var i=function(a,o){if(typeof a!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var c=s.call(a,o||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(a)}(r,"string");return typeof i=="symbol"?i:i+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Da(t){return Da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Da(t)}function RE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Aa(t,e)}function ch(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ch=function(){return!!t})()}function em(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function tm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?em(Object(n),!0).forEach(function(r){PE(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):em(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function IE(t,e){if(t==null)return{};var n,r,i=function(o,s){if(o==null)return{};var c={};for(var l in o)if({}.hasOwnProperty.call(o,l)){if(s.includes(l))continue;c[l]=o[l]}return c}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Aa(t,e){return Aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Aa(t,e)}function Lu(t){return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lu(t)}function Du(t){var e=typeof Map=="function"?new Map:void 0;return Du=function(n){if(n===null||!function(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return function(i,a,o){if(ch())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,a);var c=new(i.bind.apply(i,s));return o&&Aa(c,o.prototype),c}(n,arguments,Da(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Aa(r,n)},Du(t)}var pa=function(t){function e(n){var r;return Kb(this,e),(r=EE(this,e,[n])).name="SyntheticChangeError",r}return RE(e,t),Zb(e)}(Du(Error)),nm,_E=["options"],OE=["text","email","tel","search","url"],Qb=Zb(function t(e){var n=e.init,r=e.tracking;Kb(this,t);var i=new WeakMap;this.register=function(a){var o;if(OE.includes(a.type)){var s=(o=a._wrapperState)!==null&&o!==void 0?o:{},c=s.initialValue,l=c===void 0?"":c,u=s.controlled,d=u!==void 0&&u,h=n({initialValue:a.value||l,controlled:d}),p=h.value,f=h.options,b={value:p,options:f,fallbackOptions:f},x={id:-1,cachedId:-1},m={value:"",selectionStart:0,selectionEnd:0},v=Object.getOwnPropertyDescriptor("_valueTracker"in a?a:HTMLInputElement.prototype,"value");Object.defineProperty(a,"value",tm(tm({},v),{},{set:function(w){var T;m.value=w,v==null||(T=v.set)===null||T===void 0||T.call(a,w)}})),a.value=p;var y=function(){var w=function(){var T,E;m.selectionStart=(T=a.selectionStart)!==null&&T!==void 0?T:0,m.selectionEnd=(E=a.selectionEnd)!==null&&E!==void 0?E:0,x.id=window.setTimeout(w)};x.id=window.setTimeout(w)},g=function(){window.clearTimeout(x.id),x.id=-1,x.cachedId=-1},S=function(w){try{var T,E;if(x.cachedId===x.id)throw new pa("The input selection has not been updated.");x.cachedId=x.id;var _=a.value,M=a.selectionStart,F=a.selectionEnd;if(M===null||F===null)throw new pa("The selection attributes have not been initialized.");var H,ee=m.value;if(w.inputType===void 0&&(m.selectionStart=0,m.selectionEnd=ee.length),M>m.selectionStart?H="insert":M<=m.selectionStart&&M<m.selectionEnd?H="deleteBackward":M===m.selectionEnd&&_.length<ee.length&&(H="deleteForward"),H===void 0||(H==="deleteBackward"||H==="deleteForward")&&_.length>ee.length)throw new pa("Input type detection error.");var G="",gt=m.selectionStart,ze=m.selectionEnd;if(H==="insert")G=_.slice(m.selectionStart,M);else{var Le=ee.length-_.length;gt=M,ze=M+Le}b.value!==ee?b.options=b.fallbackOptions:b.fallbackOptions=b.options;var j=b.options,z=r({inputType:H,previousValue:ee,previousOptions:j,value:_,addedValue:G,changeStart:gt,changeEnd:ze,selectionStart:M,selectionEnd:F}),V=z.options,J=IE(z,_E);a.value=J.value,a.setSelectionRange(J.selectionStart,J.selectionEnd),b.value=J.value,b.options=V,m.selectionStart=J.selectionStart,m.selectionEnd=J.selectionEnd,(T=a._valueTracker)===null||T===void 0||(E=T.setValue)===null||E===void 0||E.call(T,ee)}catch(fe){if(a.value=m.value,a.setSelectionRange(m.selectionStart,m.selectionEnd),w.preventDefault(),w.stopPropagation(),fe.name!=="SyntheticChangeError")throw fe}};document.activeElement===a&&y(),a.addEventListener("focus",y),a.addEventListener("blur",g),a.addEventListener("input",S),i.set(a,{onFocus:y,onBlur:g,onInput:S})}},this.unregister=function(a){var o=i.get(a);o!==void 0&&(a.removeEventListener("focus",o.onFocus),a.removeEventListener("blur",o.onBlur),a.removeEventListener("input",o.onInput),i.delete(a))}});nm=Qb,Object.defineProperty(nm.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Input"});function ME(t,e){return B.useCallback(function(n){t.current=n,typeof e=="function"?e(n):Lu(e)==="object"&&e!==null&&(e.current=n)},[t,e])}var rm,NE=["track","modify"];function Dr(t){var e,n,r,i;return{mask:(e=t.mask)!==null&&e!==void 0?e:"",replacement:typeof t.replacement=="string"?Ei(t.replacement):(n=t.replacement)!==null&&n!==void 0?n:{},showMask:(r=t.showMask)!==null&&r!==void 0&&r,separate:(i=t.separate)!==null&&i!==void 0&&i,track:t.track,modify:t.modify}}var Jb=function(t){function e(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return bE(this,e),(n=vE(this,e,[{init:function(i){var a=i.initialValue,o=i.controlled,s=Dr(r),c=s.mask,l=s.replacement,u=s.separate,d=s.showMask;return a=o||a?a:d?c:"",{value:a,options:{mask:c,replacement:l,separate:u}}},tracking:function(i){var a=i.inputType,o=i.previousValue,s=i.previousOptions,c=i.addedValue,l=i.changeStart,u=i.changeEnd,d=Dr(r),h=d.track,p=d.modify,f=qb(d,NE),b=f.mask,x=f.replacement,m=f.showMask,v=f.separate,y=mo(mo({},a==="insert"?{inputType:a,data:c}:{inputType:a,data:null}),{},{value:o,selectionStart:l,selectionEnd:u}),g=h==null?void 0:h(y);if(g===!1)throw new pa("Custom tracking stop.");g===null?c="":g!==!0&&g!==void 0&&(c=g);var S=p==null?void 0:p(y);(S==null?void 0:S.mask)!==void 0&&(b=S.mask),(S==null?void 0:S.replacement)!==void 0&&(x=typeof(S==null?void 0:S.replacement)=="string"?Ei(S==null?void 0:S.replacement):S.replacement),(S==null?void 0:S.showMask)!==void 0&&(m=S.showMask),(S==null?void 0:S.separate)!==void 0&&(v=S.separate);var w=Nu(o,mo({end:l},s)),T=Nu(o,mo({start:u},s)),E=RegExp("[^".concat(Object.keys(x).join(""),"]"),"g"),_=b.replace(E,"");if(w&&(w=ha(w,{replacementChars:_,replacement:x,separate:v}),_=_.slice(w.length)),c&&(c=ha(c,{replacementChars:_,replacement:x,separate:!1}),_=_.slice(c.length)),a==="insert"&&c==="")throw new pa("The character does not match the key value of the `replacement` object.");if(v){var M=b.slice(l,u).replace(E,""),F=M.length-c.length;F<0?T=T.slice(-F):F>0&&(T=M.slice(-F)+T)}T&&(T=ha(T,{replacementChars:_,replacement:x,separate:v}));var H=Wb(w+c+T,{mask:b,replacement:x,separate:v,showMask:m}),ee=function(G){var gt,ze,Le,j=G.inputType,z=G.value,V=G.addedValue,J=G.beforeChangeValue,fe=G.mask,Yn=G.replacement,nn=G.separate,Xn=$b(z,{mask:fe,replacement:Yn}).filter(function(nc){var uh=nc.type;return uh==="input"||nn&&uh==="replacement"}),Ht=(gt=Xn[J.length+V.length-1])===null||gt===void 0?void 0:gt.index,Et=(ze=Xn[J.length-1])===null||ze===void 0?void 0:ze.index,Ir=(Le=Xn[J.length+V.length])===null||Le===void 0?void 0:Le.index;if(j==="insert"){if(Ht!==void 0)return Ht+1;if(Ir!==void 0)return Ir;if(Et!==void 0)return Et+1}if(j==="deleteForward"){if(Ir!==void 0)return Ir;if(Et!==void 0)return Et+1}if(j==="deleteBackward"){if(Et!==void 0)return Et+1;if(Ir!==void 0)return Ir}var lh=z.split("").findIndex(function(nc){return Object.prototype.hasOwnProperty.call(Yn,nc)});return lh!==-1?lh:z.length}({inputType:a,value:H,addedValue:c,beforeChangeValue:w,mask:b,replacement:x,separate:v});return{value:H,selectionStart:ee,selectionEnd:ee,options:{mask:b,replacement:x,separate:v}}}}])).format=function(i){return Gb(i,Dr(r))},n.formatToParts=function(i){return CE(i,Dr(r))},n.unformat=function(i){return wE(i,Dr(r))},n.generatePattern=function(i){return TE(i,Dr(r))},n}return kE(e,Qb),yE(e)}();rm=Jb,Object.defineProperty(rm.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Mask"});function LE(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mask,n=t.replacement,r=t.showMask,i=t.separate,a=t.track,o=t.modify,s=B.useRef(null),c=B.useRef({mask:e,replacement:n,showMask:r,separate:i,track:a,modify:o});return c.current.mask=e,c.current.replacement=n,c.current.showMask=r,c.current.separate=i,c.current.track=a,c.current.modify=o,B.useMemo(function(){return xE(s,new Jb(c.current))},[])}var DE=["component","mask","replacement","showMask","separate","track","modify"];function AE(t,e){var n=t.component,r=t.mask,i=t.replacement,a=t.showMask,o=t.separate,s=t.track,c=t.modify,l=qb(t,DE),u=LE({mask:r,replacement:i,showMask:a,separate:o,track:s,modify:c}),d=ME(u,e);return n?mr.createElement(n,Is({ref:d},l)):mr.createElement("input",Is({ref:d},l))}var jE=B.forwardRef(AE);const UE={mask:"MM / DD / YYYY",replacement:{D:/\d/,M:/\d/,Y:/\d/},showMask:!0},FE=({onSubmit:t})=>{const e=t==null,[n,r]=B.useState(null);return C.jsxs("div",{className:ae("relative bg-primary-5 flex items-center justify-between pl-4 py-2 pr-2 rounded-outer transition-colors duration-500 before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",e?"":"hover:bg-secondary-20"),children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx(Ov,{className:"w-4 h-4 text-primary-60"}),C.jsx(jE,{...UE,className:ae("bg-transparent text-primary-80 outline-0 ml-2 py-2.5",e?"placeholder-primary-20 pointer-events-none":"placeholder-primary-40"),placeholder:"MM / DD / YYYY",onChange:i=>{const a=i.target.value,[o,s,c]=a.split(" / ");o!=null&&o.length===2&&s!=null&&s.length===2&&c!=null&&c.length===4?r(`${c}-${o}-${s}`):r(null)}})]}),C.jsx(dn,{className:"flex-none",label:"Send message",onClick:n==null||t==null?void 0:()=>{t(n)},type:"main",Icon:Gs})]})},WE=({children:t,mode:e,theme:n})=>C.jsxs(C.Fragment,{children:[C.jsx("style",{children:Fb}),C.jsx(_u,{className:"bg-background p-4 rounded-outer space-y-4",theme:n,colorMode:e,children:t})]}),BE=t=>Ek.bind((e,...n)=>B.createElement(t[e]??e,...n)),$E=BE({TextButton:ms,IconButton:dn,BaseText:oE,SmallText:sE,DateInput:FE,Carousel:gE,CustomCard:cE,CustomCardRow:uE,CustomCardImageRow:lE,...rC});var Jr,Zi,ur,fa,Vo,Au;class zE extends HTMLElement{constructor(){super(...arguments),Pi(this,Vo),Pi(this,Jr,null),Pi(this,Zi,null),Pi(this,ur,null),X(this,"onRef",null),X(this,"embedded",!0),X(this,"onClose",null),X(this,"enableSettings",!1),Pi(this,fa,!0)}set enabled(e){_t(this,fa)!==e&&(Ho(this,fa,e),dh(this,Vo,Au).call(this))}set touchpointConfiguration(e){Iw(_t(this,ur),e)||(Ho(this,ur,e),dh(this,Vo,Au).call(this))}disconnectedCallback(){var e;(e=_t(this,Jr))==null||e.unmount()}}Jr=new WeakMap,Zi=new WeakMap,ur=new WeakMap,fa=new WeakMap,Vo=new WeakSet,Au=function(){_t(this,Zi)??Ho(this,Zi,this.attachShadow({mode:"closed"})),_t(this,Jr)??Ho(this,Jr,yv(_t(this,Zi))),_t(this,ur)!=null&&_t(this,Jr).render(C.jsxs(C.Fragment,{children:[C.jsx("style",{children:Fb}),C.jsx(Ub,{..._t(this,ur),embedded:this.embedded,initializeConversation:_t(this,ur).initializeConversation??(t=>{t.sendWelcomeIntent()}),onClose:this.onClose,enableSettings:this.enableSettings,enabled:_t(this,fa),ref:t=>{var e;t!=null&&((e=this.onRef)==null||e.call(this,t))}})]}))};const VE=(t,e)=>{customElements.get(t)==null&&customElements.define(t,e)};VE("nlx-touchpoint",zE);const GE=t=>new Promise(e=>{const n=document.createElement("nlx-touchpoint");n.embedded=!1,n.onRef=r=>{e({set expanded(i){r.setExpanded(i)},get expanded(){return r.getExpanded()},get conversationHandler(){return r.getConversationHandler()},teardown:()=>{document.body.removeChild(n)}})},n.onClose=()=>{},n.enableSettings=!0,n.touchpointConfiguration=t,document.body.appendChild(n)});export{oE as BaseText,gE as Carousel,cE as CustomCard,lE as CustomCardImageRow,uE as CustomCardRow,FE as DateInput,dn as IconButton,rC as Icons,WE as PreviewContainer,mr as React,sE as SmallText,ms as TextButton,GE as create,$E as html};
