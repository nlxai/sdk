var tv={},xk=Object.defineProperty,Ty=n=>{throw TypeError(n)},Ek=(n,e,t)=>e in n?xk(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ct=(n,e,t)=>Ek(n,typeof e!="symbol"?e+"":e,t),kf=(n,e,t)=>e.has(n)||Ty("Cannot "+t),Br=(n,e,t)=>(kf(n,e,"read from private field"),e.get(n)),jl=(n,e,t)=>e.has(n)?Ty("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),od=(n,e,t,r)=>(kf(n,e,"write to private field"),e.set(n,t),t),nv=(n,e,t)=>(kf(n,e,"access private method"),t);function xy(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var rv={exports:{}},Dl={},iv={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function Pk(){if(av)return ut;av=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),C=Symbol.iterator;function x(M){return M===null||typeof M!="object"?null:(M=C&&M[C]||M["@@iterator"],typeof M=="function"?M:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,L={};function $(M,ae,Ve){this.props=M,this.context=ae,this.refs=L,this.updater=Ve||T}$.prototype.isReactComponent={},$.prototype.setState=function(M,ae){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,ae,"setState")},$.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function V(){}V.prototype=$.prototype;function K(M,ae,Ve){this.props=M,this.context=ae,this.refs=L,this.updater=Ve||T}var F=K.prototype=new V;F.constructor=K,N(F,$.prototype),F.isPureReactComponent=!0;var A=Array.isArray,U=Object.prototype.hasOwnProperty,Z={current:null},oe={key:!0,ref:!0,__self:!0,__source:!0};function X(M,ae,Ve){var ke,Me={},Oe=null,Ye=null;if(ae!=null)for(ke in ae.ref!==void 0&&(Ye=ae.ref),ae.key!==void 0&&(Oe=""+ae.key),ae)U.call(ae,ke)&&!oe.hasOwnProperty(ke)&&(Me[ke]=ae[ke]);var $e=arguments.length-2;if($e===1)Me.children=Ve;else if(1<$e){for(var dt=Array($e),At=0;At<$e;At++)dt[At]=arguments[At+2];Me.children=dt}if(M&&M.defaultProps)for(ke in $e=M.defaultProps,$e)Me[ke]===void 0&&(Me[ke]=$e[ke]);return{$$typeof:n,type:M,key:Oe,ref:Ye,props:Me,_owner:Z.current}}function H(M,ae){return{$$typeof:n,type:M.type,key:ae,ref:M.ref,props:M.props,_owner:M._owner}}function J(M){return typeof M=="object"&&M!==null&&M.$$typeof===n}function Y(M){var ae={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(Ve){return ae[Ve]})}var he=/\/+/g;function Ae(M,ae){return typeof M=="object"&&M!==null&&M.key!=null?Y(""+M.key):ae.toString(36)}function qe(M,ae,Ve,ke,Me){var Oe=typeof M;(Oe==="undefined"||Oe==="boolean")&&(M=null);var Ye=!1;if(M===null)Ye=!0;else switch(Oe){case"string":case"number":Ye=!0;break;case"object":switch(M.$$typeof){case n:case e:Ye=!0}}if(Ye)return Ye=M,Me=Me(Ye),M=ke===""?"."+Ae(Ye,0):ke,A(Me)?(Ve="",M!=null&&(Ve=M.replace(he,"$&/")+"/"),qe(Me,ae,Ve,"",function(At){return At})):Me!=null&&(J(Me)&&(Me=H(Me,Ve+(!Me.key||Ye&&Ye.key===Me.key?"":(""+Me.key).replace(he,"$&/")+"/")+M)),ae.push(Me)),1;if(Ye=0,ke=ke===""?".":ke+":",A(M))for(var $e=0;$e<M.length;$e++){Oe=M[$e];var dt=ke+Ae(Oe,$e);Ye+=qe(Oe,ae,Ve,dt,Me)}else if(dt=x(M),typeof dt=="function")for(M=dt.call(M),$e=0;!(Oe=M.next()).done;)Oe=Oe.value,dt=ke+Ae(Oe,$e++),Ye+=qe(Oe,ae,Ve,dt,Me);else if(Oe==="object")throw ae=String(M),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.");return Ye}function Ue(M,ae,Ve){if(M==null)return M;var ke=[],Me=0;return qe(M,ke,"","",function(Oe){return ae.call(Ve,Oe,Me++)}),ke}function ot(M){if(M._status===-1){var ae=M._result;ae=ae(),ae.then(function(Ve){(M._status===0||M._status===-1)&&(M._status=1,M._result=Ve)},function(Ve){(M._status===0||M._status===-1)&&(M._status=2,M._result=Ve)}),M._status===-1&&(M._status=0,M._result=ae)}if(M._status===1)return M._result.default;throw M._result}var Fe={current:null},z={transition:null},ce={ReactCurrentDispatcher:Fe,ReactCurrentBatchConfig:z,ReactCurrentOwner:Z};function ue(){throw Error("act(...) is not supported in production builds of React.")}return ut.Children={map:Ue,forEach:function(M,ae,Ve){Ue(M,function(){ae.apply(this,arguments)},Ve)},count:function(M){var ae=0;return Ue(M,function(){ae++}),ae},toArray:function(M){return Ue(M,function(ae){return ae})||[]},only:function(M){if(!J(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},ut.Component=$,ut.Fragment=t,ut.Profiler=a,ut.PureComponent=K,ut.StrictMode=r,ut.Suspense=h,ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ce,ut.act=ue,ut.cloneElement=function(M,ae,Ve){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var ke=N({},M.props),Me=M.key,Oe=M.ref,Ye=M._owner;if(ae!=null){if(ae.ref!==void 0&&(Oe=ae.ref,Ye=Z.current),ae.key!==void 0&&(Me=""+ae.key),M.type&&M.type.defaultProps)var $e=M.type.defaultProps;for(dt in ae)U.call(ae,dt)&&!oe.hasOwnProperty(dt)&&(ke[dt]=ae[dt]===void 0&&$e!==void 0?$e[dt]:ae[dt])}var dt=arguments.length-2;if(dt===1)ke.children=Ve;else if(1<dt){$e=Array(dt);for(var At=0;At<dt;At++)$e[At]=arguments[At+2];ke.children=$e}return{$$typeof:n,type:M.type,key:Me,ref:Oe,props:ke,_owner:Ye}},ut.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:s,_context:M},M.Consumer=M},ut.createElement=X,ut.createFactory=function(M){var ae=X.bind(null,M);return ae.type=M,ae},ut.createRef=function(){return{current:null}},ut.forwardRef=function(M){return{$$typeof:u,render:M}},ut.isValidElement=J,ut.lazy=function(M){return{$$typeof:v,_payload:{_status:-1,_result:M},_init:ot}},ut.memo=function(M,ae){return{$$typeof:f,type:M,compare:ae===void 0?null:ae}},ut.startTransition=function(M){var ae=z.transition;z.transition={};try{M()}finally{z.transition=ae}},ut.unstable_act=ue,ut.useCallback=function(M,ae){return Fe.current.useCallback(M,ae)},ut.useContext=function(M){return Fe.current.useContext(M)},ut.useDebugValue=function(){},ut.useDeferredValue=function(M){return Fe.current.useDeferredValue(M)},ut.useEffect=function(M,ae){return Fe.current.useEffect(M,ae)},ut.useId=function(){return Fe.current.useId()},ut.useImperativeHandle=function(M,ae,Ve){return Fe.current.useImperativeHandle(M,ae,Ve)},ut.useInsertionEffect=function(M,ae){return Fe.current.useInsertionEffect(M,ae)},ut.useLayoutEffect=function(M,ae){return Fe.current.useLayoutEffect(M,ae)},ut.useMemo=function(M,ae){return Fe.current.useMemo(M,ae)},ut.useReducer=function(M,ae,Ve){return Fe.current.useReducer(M,ae,Ve)},ut.useRef=function(M){return Fe.current.useRef(M)},ut.useState=function(M){return Fe.current.useState(M)},ut.useSyncExternalStore=function(M,ae,Ve){return Fe.current.useSyncExternalStore(M,ae,Ve)},ut.useTransition=function(){return Fe.current.useTransition()},ut.version="18.3.1",ut}var ov;function Cf(){return ov||(ov=1,iv.exports=Pk()),iv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv;function _k(){if(sv)return Dl;sv=1;var n=Cf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(u,h,f){var v,C={},x=null,T=null;f!==void 0&&(x=""+f),h.key!==void 0&&(x=""+h.key),h.ref!==void 0&&(T=h.ref);for(v in h)r.call(h,v)&&!s.hasOwnProperty(v)&&(C[v]=h[v]);if(u&&u.defaultProps)for(v in h=u.defaultProps,h)C[v]===void 0&&(C[v]=h[v]);return{$$typeof:e,type:u,key:x,ref:T,props:C,_owner:a.current}}return Dl.Fragment=t,Dl.jsx=l,Dl.jsxs=l,Dl}var lv;function Rk(){return lv||(lv=1,rv.exports=_k()),rv.exports}var R=Rk(),ve=Cf();const Ao=xy(ve);var Nu={},ip={exports:{}},cr={},cv={exports:{}},uv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv;function Ik(){return dv||(dv=1,function(n){function e(z,ce){var ue=z.length;z.push(ce);e:for(;0<ue;){var M=ue-1>>>1,ae=z[M];if(0<a(ae,ce))z[M]=ce,z[ue]=ae,ue=M;else break e}}function t(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var ce=z[0],ue=z.pop();if(ue!==ce){z[0]=ue;e:for(var M=0,ae=z.length,Ve=ae>>>1;M<Ve;){var ke=2*(M+1)-1,Me=z[ke],Oe=ke+1,Ye=z[Oe];if(0>a(Me,ue))Oe<ae&&0>a(Ye,Me)?(z[M]=Ye,z[Oe]=ue,M=Oe):(z[M]=Me,z[ke]=ue,M=ke);else if(Oe<ae&&0>a(Ye,ue))z[M]=Ye,z[Oe]=ue,M=Oe;else break e}}return ce}function a(z,ce){var ue=z.sortIndex-ce.sortIndex;return ue!==0?ue:z.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var h=[],f=[],v=1,C=null,x=3,T=!1,N=!1,L=!1,$=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(z){for(var ce=t(f);ce!==null;){if(ce.callback===null)r(f);else if(ce.startTime<=z)r(f),ce.sortIndex=ce.expirationTime,e(h,ce);else break;ce=t(f)}}function A(z){if(L=!1,F(z),!N)if(t(h)!==null)N=!0,ot(U);else{var ce=t(f);ce!==null&&Fe(A,ce.startTime-z)}}function U(z,ce){N=!1,L&&(L=!1,V(X),X=-1),T=!0;var ue=x;try{for(F(ce),C=t(h);C!==null&&(!(C.expirationTime>ce)||z&&!Y());){var M=C.callback;if(typeof M=="function"){C.callback=null,x=C.priorityLevel;var ae=M(C.expirationTime<=ce);ce=n.unstable_now(),typeof ae=="function"?C.callback=ae:C===t(h)&&r(h),F(ce)}else r(h);C=t(h)}if(C!==null)var Ve=!0;else{var ke=t(f);ke!==null&&Fe(A,ke.startTime-ce),Ve=!1}return Ve}finally{C=null,x=ue,T=!1}}var Z=!1,oe=null,X=-1,H=5,J=-1;function Y(){return!(n.unstable_now()-J<H)}function he(){if(oe!==null){var z=n.unstable_now();J=z;var ce=!0;try{ce=oe(!0,z)}finally{ce?Ae():(Z=!1,oe=null)}}else Z=!1}var Ae;if(typeof K=="function")Ae=function(){K(he)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,Ue=qe.port2;qe.port1.onmessage=he,Ae=function(){Ue.postMessage(null)}}else Ae=function(){$(he,0)};function ot(z){oe=z,Z||(Z=!0,Ae())}function Fe(z,ce){X=$(function(){z(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_continueExecution=function(){N||T||(N=!0,ot(U))},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(z){switch(x){case 1:case 2:case 3:var ce=3;break;default:ce=x}var ue=x;x=ce;try{return z()}finally{x=ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(z,ce){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ue=x;x=z;try{return ce()}finally{x=ue}},n.unstable_scheduleCallback=function(z,ce,ue){var M=n.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?M+ue:M):ue=M,z){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=ue+ae,z={id:v++,callback:ce,priorityLevel:z,startTime:ue,expirationTime:ae,sortIndex:-1},ue>M?(z.sortIndex=ue,e(f,z),t(h)===null&&z===t(f)&&(L?(V(X),X=-1):L=!0,Fe(A,ue-M))):(z.sortIndex=ae,e(h,z),N||T||(N=!0,ot(U))),z},n.unstable_shouldYield=Y,n.unstable_wrapCallback=function(z){var ce=x;return function(){var ue=x;x=ce;try{return z.apply(this,arguments)}finally{x=ue}}}}(uv)),uv}var hv;function Ok(){return hv||(hv=1,cv.exports=Ik()),cv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pv;function Ak(){if(pv)return cr;pv=1;var n=Cf(),e=Ok();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function s(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(a[i]=o,i=0;i<o.length;i++)r.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},C={};function x(i){return h.call(C,i)?!0:h.call(v,i)?!1:f.test(i)?C[i]=!0:(v[i]=!0,!1)}function T(i,o,c,m){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return m?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function N(i,o,c,m){if(o===null||typeof o>"u"||T(i,o,c,m))return!0;if(m)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function L(i,o,c,m,b,w,P){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=m,this.attributeNamespace=b,this.mustUseProperty=c,this.propertyName=i,this.type=o,this.sanitizeURL=w,this.removeEmptyString=P}var $={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){$[i]=new L(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];$[o]=new L(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){$[i]=new L(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){$[i]=new L(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){$[i]=new L(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){$[i]=new L(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){$[i]=new L(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){$[i]=new L(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){$[i]=new L(i,5,!1,i.toLowerCase(),null,!1,!1)});var V=/[\-:]([a-z])/g;function K(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(V,K);$[o]=new L(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(V,K);$[o]=new L(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(V,K);$[o]=new L(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){$[i]=new L(i,1,!1,i.toLowerCase(),null,!1,!1)}),$.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){$[i]=new L(i,1,!1,i.toLowerCase(),null,!0,!0)});function F(i,o,c,m){var b=$.hasOwnProperty(o)?$[o]:null;(b!==null?b.type!==0:m||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(N(o,c,b,m)&&(c=null),m||b===null?x(o)&&(c===null?i.removeAttribute(o):i.setAttribute(o,""+c)):b.mustUseProperty?i[b.propertyName]=c===null?b.type===3?!1:"":c:(o=b.attributeName,m=b.attributeNamespace,c===null?i.removeAttribute(o):(b=b.type,c=b===3||b===4&&c===!0?"":""+c,m?i.setAttributeNS(m,o,c):i.setAttribute(o,c))))}var A=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,U=Symbol.for("react.element"),Z=Symbol.for("react.portal"),oe=Symbol.for("react.fragment"),X=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),J=Symbol.for("react.provider"),Y=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),Ae=Symbol.for("react.suspense"),qe=Symbol.for("react.suspense_list"),Ue=Symbol.for("react.memo"),ot=Symbol.for("react.lazy"),Fe=Symbol.for("react.offscreen"),z=Symbol.iterator;function ce(i){return i===null||typeof i!="object"?null:(i=z&&i[z]||i["@@iterator"],typeof i=="function"?i:null)}var ue=Object.assign,M;function ae(i){if(M===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);M=o&&o[1]||""}return`
`+M+i}var Ve=!1;function ke(i,o){if(!i||Ve)return"";Ve=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(le){var m=le}Reflect.construct(i,[],o)}else{try{o.call()}catch(le){m=le}i.call(o.prototype)}else{try{throw Error()}catch(le){m=le}i()}}catch(le){if(le&&m&&typeof le.stack=="string"){for(var b=le.stack.split(`
`),w=m.stack.split(`
`),P=b.length-1,j=w.length-1;1<=P&&0<=j&&b[P]!==w[j];)j--;for(;1<=P&&0<=j;P--,j--)if(b[P]!==w[j]){if(P!==1||j!==1)do if(P--,j--,0>j||b[P]!==w[j]){var W=`
`+b[P].replace(" at new "," at ");return i.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",i.displayName)),W}while(1<=P&&0<=j);break}}}finally{Ve=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?ae(i):""}function Me(i){switch(i.tag){case 5:return ae(i.type);case 16:return ae("Lazy");case 13:return ae("Suspense");case 19:return ae("SuspenseList");case 0:case 2:case 15:return i=ke(i.type,!1),i;case 11:return i=ke(i.type.render,!1),i;case 1:return i=ke(i.type,!0),i;default:return""}}function Oe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case oe:return"Fragment";case Z:return"Portal";case H:return"Profiler";case X:return"StrictMode";case Ae:return"Suspense";case qe:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Y:return(i.displayName||"Context")+".Consumer";case J:return(i._context.displayName||"Context")+".Provider";case he:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ue:return o=i.displayName||null,o!==null?o:Oe(i.type)||"Memo";case ot:o=i._payload,i=i._init;try{return Oe(i(o))}catch{}}return null}function Ye(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oe(o);case 8:return o===X?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function $e(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function dt(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function At(i){var o=dt(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),m=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var b=c.get,w=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return b.call(this)},set:function(P){m=""+P,w.call(this,P)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return m},setValue:function(P){m=""+P},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function qt(i){i._valueTracker||(i._valueTracker=At(i))}function er(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),m="";return i&&(m=dt(i)?i.checked?"true":"false":i.value),i=m,i!==c?(o.setValue(i),!0):!1}function bn(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Sr(i,o){var c=o.checked;return ue({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function Tr(i,o){var c=o.defaultValue==null?"":o.defaultValue,m=o.checked!=null?o.checked:o.defaultChecked;c=$e(o.value!=null?o.value:c),i._wrapperState={initialChecked:m,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function sa(i,o){o=o.checked,o!=null&&F(i,"checked",o,!1)}function Li(i,o){sa(i,o);var c=$e(o.value),m=o.type;if(c!=null)m==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(m==="submit"||m==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?yn(i,o.type,c):o.hasOwnProperty("defaultValue")&&yn(i,o.type,$e(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Bo(i,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var m=o.type;if(!(m!=="submit"&&m!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,c||o===i.value||(i.value=o),i.defaultValue=o}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function yn(i,o,c){(o!=="number"||bn(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var Ni=Array.isArray;function Fn(i,o,c,m){if(i=i.options,o){o={};for(var b=0;b<c.length;b++)o["$"+c[b]]=!0;for(c=0;c<i.length;c++)b=o.hasOwnProperty("$"+i[c].value),i[c].selected!==b&&(i[c].selected=b),b&&m&&(i[c].defaultSelected=!0)}else{for(c=""+$e(c),o=null,b=0;b<i.length;b++){if(i[b].value===c){i[b].selected=!0,m&&(i[b].defaultSelected=!0);return}o!==null||i[b].disabled||(o=i[b])}o!==null&&(o.selected=!0)}}function ji(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return ue({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Vo(i,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(t(92));if(Ni(c)){if(1<c.length)throw Error(t(93));c=c[0]}o=c}o==null&&(o=""),c=o}i._wrapperState={initialValue:$e(c)}}function _(i,o){var c=$e(o.value),m=$e(o.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),o.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),m!=null&&(i.defaultValue=""+m)}function y(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function S(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function O(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?S(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Q,de=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,m,b){MSApp.execUnsafeLocalFunction(function(){return i(o,c,m,b)})}:i}(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(Q=Q||document.createElement("div"),Q.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Q.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function be(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var Ke={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},it=["Webkit","ms","Moz","O"];Object.keys(Ke).forEach(function(i){it.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Ke[o]=Ke[i]})});function Le(i,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||Ke.hasOwnProperty(i)&&Ke[i]?(""+o).trim():o+"px"}function st(i,o){i=i.style;for(var c in o)if(o.hasOwnProperty(c)){var m=c.indexOf("--")===0,b=Le(c,o[c],m);c==="float"&&(c="cssFloat"),m?i.setProperty(c,b):i[c]=b}}var Tt=ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $t(i,o){if(o){if(Tt[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function xt(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bn=null;function _n(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var wn=null,en=null,rn=null;function xr(i){if(i=kl(i)){if(typeof wn!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Zc(o),wn(i.stateNode,i.type,o))}}function Xe(i){en?rn?rn.push(i):rn=[i]:en=i}function Er(){if(en){var i=en,o=rn;if(rn=en=null,xr(i),o)for(i=0;i<o.length;i++)xr(o[i])}}function Vn(i,o){return i(o)}function ht(){}var Wn=!1;function Tc(i,o,c){if(Wn)return i(o,c);Wn=!0;try{return Vn(i,o,c)}finally{Wn=!1,(en!==null||rn!==null)&&(ht(),Er())}}function qr(i,o){var c=i.stateNode;if(c===null)return null;var m=Zc(c);if(m===null)return null;c=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(t(231,o,typeof c));return c}var Wo=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Wo=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch{Wo=!1}function Ks(i,o,c,m,b,w,P,j,W){var le=Array.prototype.slice.call(arguments,3);try{o.apply(c,le)}catch(we){this.onError(we)}}var pr=!1,qa=null,$a=!1,la=null,xc={onError:function(i){pr=!0,qa=i}};function Ec(i,o,c,m,b,w,P,j,W){pr=!1,qa=null,Ks.apply(xc,arguments)}function zo(i,o,c,m,b,w,P,j,W){if(Ec.apply(this,arguments),pr){if(pr){var le=qa;pr=!1,qa=null}else throw Error(t(198));$a||($a=!0,la=le)}}function hi(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function Pc(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function $r(i){if(hi(i)!==i)throw Error(t(188))}function _c(i){var o=i.alternate;if(!o){if(o=hi(i),o===null)throw Error(t(188));return o!==i?null:i}for(var c=i,m=o;;){var b=c.return;if(b===null)break;var w=b.alternate;if(w===null){if(m=b.return,m!==null){c=m;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===c)return $r(b),i;if(w===m)return $r(b),o;w=w.sibling}throw Error(t(188))}if(c.return!==m.return)c=b,m=w;else{for(var P=!1,j=b.child;j;){if(j===c){P=!0,c=b,m=w;break}if(j===m){P=!0,m=b,c=w;break}j=j.sibling}if(!P){for(j=w.child;j;){if(j===c){P=!0,c=w,m=b;break}if(j===m){P=!0,m=w,c=b;break}j=j.sibling}if(!P)throw Error(t(189))}}if(c.alternate!==m)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?i:o}function Rc(i){return i=_c(i),i!==null?qo(i):null}function qo(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=qo(i);if(o!==null)return o;i=i.sibling}return null}var Js=e.unstable_scheduleCallback,tr=e.unstable_cancelCallback,$o=e.unstable_shouldYield,Zs=e.unstable_requestPaint,Ft=e.unstable_now,Ho=e.unstable_getCurrentPriorityLevel,Go=e.unstable_ImmediatePriority,Qs=e.unstable_UserBlockingPriority,Ha=e.unstable_NormalPriority,Ga=e.unstable_LowPriority,Ko=e.unstable_IdlePriority,Pr=null,Rn=null;function Jo(i){if(Rn&&typeof Rn.onCommitFiberRoot=="function")try{Rn.onCommitFiberRoot(Pr,i,void 0,(i.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:Zo,Hr=Math.log,Ic=Math.LN2;function Zo(i){return i>>>=0,i===0?32:31-(Hr(i)/Ic|0)|0}var Ka=64,Cn=4194304;function _r(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function nt(i,o){var c=i.pendingLanes;if(c===0)return 0;var m=0,b=i.suspendedLanes,w=i.pingedLanes,P=c&268435455;if(P!==0){var j=P&~b;j!==0?m=_r(j):(w&=P,w!==0&&(m=_r(w)))}else P=c&~b,P!==0?m=_r(P):w!==0&&(m=_r(w));if(m===0)return 0;if(o!==0&&o!==m&&(o&b)===0&&(b=m&-m,w=o&-o,b>=w||b===16&&(w&4194240)!==0))return o;if((m&4)!==0&&(m|=c&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=m;0<o;)c=31-kn(o),b=1<<c,m|=i[c],o&=~b;return m}function fr(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rr(i,o){for(var c=i.suspendedLanes,m=i.pingedLanes,b=i.expirationTimes,w=i.pendingLanes;0<w;){var P=31-kn(w),j=1<<P,W=b[P];W===-1?((j&c)===0||(j&m)!==0)&&(b[P]=fr(j,o)):W<=o&&(i.expiredLanes|=j),w&=~j}}function Qo(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ys(){var i=Ka;return Ka<<=1,(Ka&4194240)===0&&(Ka=64),i}function Yo(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function Et(i,o,c){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-kn(o),i[o]=c}function Ja(i,o){var c=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var m=i.eventTimes;for(i=i.expirationTimes;0<c;){var b=31-kn(c),w=1<<b;o[b]=0,m[b]=-1,i[b]=-1,c&=~w}}function Za(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var m=31-kn(c),b=1<<m;b&o|i[m]&o&&(i[m]|=o),c&=~b}}var gt=0;function Ir(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Xo,Gr,Xs,ca,Qa,Ya=!1,Xa=[],Kr=null,Jr=null,pi=null,ua=new Map,fi=new Map,mr=[],da="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eo(i,o){switch(i){case"focusin":case"focusout":Kr=null;break;case"dragenter":case"dragleave":Jr=null;break;case"mouseover":case"mouseout":pi=null;break;case"pointerover":case"pointerout":ua.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":fi.delete(o.pointerId)}}function Zr(i,o,c,m,b,w){return i===null||i.nativeEvent!==w?(i={blockedOn:o,domEventName:c,eventSystemFlags:m,nativeEvent:w,targetContainers:[b]},o!==null&&(o=kl(o),o!==null&&Gr(o)),i):(i.eventSystemFlags|=m,o=i.targetContainers,b!==null&&o.indexOf(b)===-1&&o.push(b),i)}function to(i,o,c,m,b){switch(o){case"focusin":return Kr=Zr(Kr,i,o,c,m,b),!0;case"dragenter":return Jr=Zr(Jr,i,o,c,m,b),!0;case"mouseover":return pi=Zr(pi,i,o,c,m,b),!0;case"pointerover":var w=b.pointerId;return ua.set(w,Zr(ua.get(w)||null,i,o,c,m,b)),!0;case"gotpointercapture":return w=b.pointerId,fi.set(w,Zr(fi.get(w)||null,i,o,c,m,b)),!0}return!1}function Di(i){var o=fo(i.target);if(o!==null){var c=hi(o);if(c!==null){if(o=c.tag,o===13){if(o=Pc(c),o!==null){i.blockedOn=o,Qa(i.priority,function(){Xs(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ui(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=rl(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var m=new c.constructor(c.type,c);Bn=m,c.target.dispatchEvent(m),Bn=null}else return o=kl(c),o!==null&&Gr(o),i.blockedOn=c,!1;o.shift()}return!0}function In(i,o,c){Ui(i)&&c.delete(o)}function es(){Ya=!1,Kr!==null&&Ui(Kr)&&(Kr=null),Jr!==null&&Ui(Jr)&&(Jr=null),pi!==null&&Ui(pi)&&(pi=null),ua.forEach(In),fi.forEach(In)}function no(i,o){i.blockedOn===o&&(i.blockedOn=null,Ya||(Ya=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,es)))}function On(i){function o(b){return no(b,i)}if(0<Xa.length){no(Xa[0],i);for(var c=1;c<Xa.length;c++){var m=Xa[c];m.blockedOn===i&&(m.blockedOn=null)}}for(Kr!==null&&no(Kr,i),Jr!==null&&no(Jr,i),pi!==null&&no(pi,i),ua.forEach(o),fi.forEach(o),c=0;c<mr.length;c++)m=mr[c],m.blockedOn===i&&(m.blockedOn=null);for(;0<mr.length&&(c=mr[0],c.blockedOn===null);)Di(c),c.blockedOn===null&&mr.shift()}var mi=A.ReactCurrentBatchConfig,gr=!0;function el(i,o,c,m){var b=gt,w=mi.transition;mi.transition=null;try{gt=1,nl(i,o,c,m)}finally{gt=b,mi.transition=w}}function tl(i,o,c,m){var b=gt,w=mi.transition;mi.transition=null;try{gt=4,nl(i,o,c,m)}finally{gt=b,mi.transition=w}}function nl(i,o,c,m){if(gr){var b=rl(i,o,c,m);if(b===null)Jd(i,o,m,Fi,c),eo(i,m);else if(to(b,i,o,c,m))m.stopPropagation();else if(eo(i,m),o&4&&-1<da.indexOf(i)){for(;b!==null;){var w=kl(b);if(w!==null&&Xo(w),w=rl(i,o,c,m),w===null&&Jd(i,o,m,Fi,c),w===b)break;b=w}b!==null&&m.stopPropagation()}else Jd(i,o,m,null,c)}}var Fi=null;function rl(i,o,c,m){if(Fi=null,i=_n(m),i=fo(i),i!==null)if(o=hi(i),o===null)i=null;else if(c=o.tag,c===13){if(i=Pc(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Fi=i,null}function Oc(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ho()){case Go:return 1;case Qs:return 4;case Ha:case Ga:return 16;case Ko:return 536870912;default:return 16}default:return 16}}var gi=null,vr=null,ro=null;function io(){if(ro)return ro;var i,o=vr,c=o.length,m,b="value"in gi?gi.value:gi.textContent,w=b.length;for(i=0;i<c&&o[i]===b[i];i++);var P=c-i;for(m=1;m<=P&&o[c-m]===b[w-m];m++);return ro=b.slice(i,1<m?1-m:void 0)}function ao(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function ts(){return!0}function an(){return!1}function An(i){function o(c,m,b,w,P){this._reactName=c,this._targetInst=b,this.type=m,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var j in i)i.hasOwnProperty(j)&&(c=i[j],this[j]=c?c(w):w[j]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?ts:an,this.isPropagationStopped=an,this}return ue(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ts)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ts)},persist:function(){},isPersistent:ts}),o}var Mn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ha=An(Mn),vi=ue({},Mn,{view:0,detail:0}),Ac=An(vi),oo,il,Bi,ns=ue({},vi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rs,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Bi&&(Bi&&i.type==="mousemove"?(oo=i.screenX-Bi.screenX,il=i.screenY-Bi.screenY):il=oo=0,Bi=i),oo)},movementY:function(i){return"movementY"in i?i.movementY:il}}),Mc=An(ns),Lc=ue({},ns,{dataTransfer:0}),Fd=An(Lc),Bd=ue({},vi,{relatedTarget:0}),al=An(Bd),Vd=ue({},Mn,{animationName:0,elapsedTime:0,pseudoElement:0}),Wd=An(Vd),zd=ue({},Mn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),qd=An(zd),ol=ue({},Mn,{data:0}),so=An(ol),$d={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sl(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Nc[i])?!!o[i]:!1}function rs(){return sl}var jc=ue({},vi,{key:function(i){if(i.key){var o=$d[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=ao(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Hd[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rs,charCode:function(i){return i.type==="keypress"?ao(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ao(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Dc=An(jc),lo=ue({},ns,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nr=An(lo),is=ue({},vi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rs}),co=An(is),pa=ue({},Mn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Or=An(pa),as=ue({},ns,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zt=An(as),Uc=[9,13,27,32],Qt=u&&"CompositionEvent"in window,bi=null;u&&"documentMode"in document&&(bi=document.documentMode);var Gd=u&&"TextEvent"in window&&!bi,os=u&&(!Qt||bi&&8<bi&&11>=bi),Fc=" ",uo=!1;function br(i,o){switch(i){case"keyup":return Uc.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ll(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var yi=!1;function Bc(i,o){switch(i){case"compositionend":return ll(o);case"keypress":return o.which!==32?null:(uo=!0,Fc);case"textInput":return i=o.data,i===Fc&&uo?null:i;default:return null}}function cl(i,o){if(yi)return i==="compositionend"||!Qt&&br(i,o)?(i=io(),ro=vr=gi=null,yi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return os&&o.locale!=="ko"?null:o.data;default:return null}}var ul={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fa(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!ul[i.type]:o==="textarea"}function Vc(i,o,c,m){Xe(m),o=Gc(o,"onChange"),0<o.length&&(c=new ha("onChange","change",null,c,m),i.push({event:c,listeners:o}))}var wi=null,ma=null;function Wc(i){gm(i,0)}function Vi(i){var o=ds(i);if(er(o))return i}function zc(i,o){if(i==="change")return o}var dl=!1;if(u){var hl;if(u){var ss="oninput"in document;if(!ss){var pl=document.createElement("div");pl.setAttribute("oninput","return;"),ss=typeof pl.oninput=="function"}hl=ss}else hl=!1;dl=hl&&(!document.documentMode||9<document.documentMode)}function ho(){wi&&(wi.detachEvent("onpropertychange",pe),ma=wi=null)}function pe(i){if(i.propertyName==="value"&&Vi(ma)){var o=[];Vc(o,ma,i,_n(i)),Tc(Wc,o)}}function fl(i,o,c){i==="focusin"?(ho(),wi=o,ma=c,wi.attachEvent("onpropertychange",pe)):i==="focusout"&&ho()}function qc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Vi(ma)}function Qr(i,o){if(i==="click")return Vi(o)}function ls(i,o){if(i==="input"||i==="change")return Vi(o)}function $c(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var rr=typeof Object.is=="function"?Object.is:$c;function ga(i,o){if(rr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),m=Object.keys(o);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var b=c[m];if(!h.call(o,b)||!rr(i[b],o[b]))return!1}return!0}function ml(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function gl(i,o){var c=ml(i);i=0;for(var m;c;){if(c.nodeType===3){if(m=i+c.textContent.length,i<=o&&m>=o)return{node:c,offset:o-i};i=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=ml(c)}}function po(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?po(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function vl(){for(var i=window,o=bn();o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=bn(i.document)}return o}function d(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function p(i){var o=vl(),c=i.focusedElem,m=i.selectionRange;if(o!==c&&c&&c.ownerDocument&&po(c.ownerDocument.documentElement,c)){if(m!==null&&d(c)){if(o=m.start,i=m.end,i===void 0&&(i=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(i,c.value.length);else if(i=(o=c.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var b=c.textContent.length,w=Math.min(m.start,b);m=m.end===void 0?w:Math.min(m.end,b),!i.extend&&w>m&&(b=m,m=w,w=b),b=gl(c,w);var P=gl(c,m);b&&P&&(i.rangeCount!==1||i.anchorNode!==b.node||i.anchorOffset!==b.offset||i.focusNode!==P.node||i.focusOffset!==P.offset)&&(o=o.createRange(),o.setStart(b.node,b.offset),i.removeAllRanges(),w>m?(i.addRange(o),i.extend(P.node,P.offset)):(o.setEnd(P.node,P.offset),i.addRange(o)))}}for(o=[],i=c;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)i=o[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var g=u&&"documentMode"in document&&11>=document.documentMode,k=null,E=null,I=null,B=!1;function G(i,o,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;B||k==null||k!==bn(m)||(m=k,"selectionStart"in m&&d(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),I&&ga(I,m)||(I=m,m=Gc(E,"onSelect"),0<m.length&&(o=new ha("onSelect","select",null,o,c),i.push({event:o,listeners:m}),o.target=k)))}function se(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var ee={animationend:se("Animation","AnimationEnd"),animationiteration:se("Animation","AnimationIteration"),animationstart:se("Animation","AnimationStart"),transitionend:se("Transition","TransitionEnd")},Te={},_e={};u&&(_e=document.createElement("div").style,"AnimationEvent"in window||(delete ee.animationend.animation,delete ee.animationiteration.animation,delete ee.animationstart.animation),"TransitionEvent"in window||delete ee.transitionend.transition);function De(i){if(Te[i])return Te[i];if(!ee[i])return i;var o=ee[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in _e)return Te[i]=o[c];return i}var ne=De("animationend"),fe=De("animationiteration"),Pe=De("animationstart"),He=De("transitionend"),Je=new Map,et="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vt(i,o){Je.set(i,o),s(o,[i])}for(var It=0;It<et.length;It++){var Mt=et[It],Pt=Mt.toLowerCase(),Yr=Mt[0].toUpperCase()+Mt.slice(1);vt(Pt,"on"+Yr)}vt(ne,"onAnimationEnd"),vt(fe,"onAnimationIteration"),vt(Pe,"onAnimationStart"),vt("dblclick","onDoubleClick"),vt("focusin","onFocus"),vt("focusout","onBlur"),vt(He,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wi));function mm(i,o,c){var m=i.type||"unknown-event";i.currentTarget=c,zo(m,o,void 0,i),i.currentTarget=null}function gm(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var m=i[c],b=m.event;m=m.listeners;e:{var w=void 0;if(o)for(var P=m.length-1;0<=P;P--){var j=m[P],W=j.instance,le=j.currentTarget;if(j=j.listener,W!==w&&b.isPropagationStopped())break e;mm(b,j,le),w=W}else for(P=0;P<m.length;P++){if(j=m[P],W=j.instance,le=j.currentTarget,j=j.listener,W!==w&&b.isPropagationStopped())break e;mm(b,j,le),w=W}}}if($a)throw i=la,$a=!1,la=null,i}function Lt(i,o){var c=o[th];c===void 0&&(c=o[th]=new Set);var m=i+"__bubble";c.has(m)||(vm(o,i,2,!1),c.add(m))}function Kd(i,o,c){var m=0;o&&(m|=4),vm(c,i,m,o)}var Hc="_reactListening"+Math.random().toString(36).slice(2);function bl(i){if(!i[Hc]){i[Hc]=!0,r.forEach(function(c){c!=="selectionchange"&&(jw.has(c)||Kd(c,!1,i),Kd(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Hc]||(o[Hc]=!0,Kd("selectionchange",!1,o))}}function vm(i,o,c,m){switch(Oc(o)){case 1:var b=el;break;case 4:b=tl;break;default:b=nl}c=b.bind(null,o,c,i),b=void 0,!Wo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(b=!0),m?b!==void 0?i.addEventListener(o,c,{capture:!0,passive:b}):i.addEventListener(o,c,!0):b!==void 0?i.addEventListener(o,c,{passive:b}):i.addEventListener(o,c,!1)}function Jd(i,o,c,m,b){var w=m;if((o&1)===0&&(o&2)===0&&m!==null)e:for(;;){if(m===null)return;var P=m.tag;if(P===3||P===4){var j=m.stateNode.containerInfo;if(j===b||j.nodeType===8&&j.parentNode===b)break;if(P===4)for(P=m.return;P!==null;){var W=P.tag;if((W===3||W===4)&&(W=P.stateNode.containerInfo,W===b||W.nodeType===8&&W.parentNode===b))return;P=P.return}for(;j!==null;){if(P=fo(j),P===null)return;if(W=P.tag,W===5||W===6){m=w=P;continue e}j=j.parentNode}}m=m.return}Tc(function(){var le=w,we=_n(c),Ce=[];e:{var ye=Je.get(i);if(ye!==void 0){var je=ha,We=i;switch(i){case"keypress":if(ao(c)===0)break e;case"keydown":case"keyup":je=Dc;break;case"focusin":We="focus",je=al;break;case"focusout":We="blur",je=al;break;case"beforeblur":case"afterblur":je=al;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":je=Mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":je=Fd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":je=co;break;case ne:case fe:case Pe:je=Wd;break;case He:je=Or;break;case"scroll":je=Ac;break;case"wheel":je=Zt;break;case"copy":case"cut":case"paste":je=qd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":je=nr}var ze=(o&4)!==0,Yt=!ze&&i==="scroll",te=ze?ye!==null?ye+"Capture":null:ye;ze=[];for(var q=le,ie;q!==null;){ie=q;var Ee=ie.stateNode;if(ie.tag===5&&Ee!==null&&(ie=Ee,te!==null&&(Ee=qr(q,te),Ee!=null&&ze.push(yl(q,Ee,ie)))),Yt)break;q=q.return}0<ze.length&&(ye=new je(ye,We,null,c,we),Ce.push({event:ye,listeners:ze}))}}if((o&7)===0){e:{if(ye=i==="mouseover"||i==="pointerover",je=i==="mouseout"||i==="pointerout",ye&&c!==Bn&&(We=c.relatedTarget||c.fromElement)&&(fo(We)||We[zi]))break e;if((je||ye)&&(ye=we.window===we?we:(ye=we.ownerDocument)?ye.defaultView||ye.parentWindow:window,je?(We=c.relatedTarget||c.toElement,je=le,We=We?fo(We):null,We!==null&&(Yt=hi(We),We!==Yt||We.tag!==5&&We.tag!==6)&&(We=null)):(je=null,We=le),je!==We)){if(ze=Mc,Ee="onMouseLeave",te="onMouseEnter",q="mouse",(i==="pointerout"||i==="pointerover")&&(ze=nr,Ee="onPointerLeave",te="onPointerEnter",q="pointer"),Yt=je==null?ye:ds(je),ie=We==null?ye:ds(We),ye=new ze(Ee,q+"leave",je,c,we),ye.target=Yt,ye.relatedTarget=ie,Ee=null,fo(we)===le&&(ze=new ze(te,q+"enter",We,c,we),ze.target=ie,ze.relatedTarget=Yt,Ee=ze),Yt=Ee,je&&We)t:{for(ze=je,te=We,q=0,ie=ze;ie;ie=cs(ie))q++;for(ie=0,Ee=te;Ee;Ee=cs(Ee))ie++;for(;0<q-ie;)ze=cs(ze),q--;for(;0<ie-q;)te=cs(te),ie--;for(;q--;){if(ze===te||te!==null&&ze===te.alternate)break t;ze=cs(ze),te=cs(te)}ze=null}else ze=null;je!==null&&bm(Ce,ye,je,ze,!1),We!==null&&Yt!==null&&bm(Ce,Yt,We,ze,!0)}}e:{if(ye=le?ds(le):window,je=ye.nodeName&&ye.nodeName.toLowerCase(),je==="select"||je==="input"&&ye.type==="file")var Ge=zc;else if(fa(ye))if(dl)Ge=ls;else{Ge=qc;var Ze=fl}else(je=ye.nodeName)&&je.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&(Ge=Qr);if(Ge&&(Ge=Ge(i,le))){Vc(Ce,Ge,c,we);break e}Ze&&Ze(i,ye,le),i==="focusout"&&(Ze=ye._wrapperState)&&Ze.controlled&&ye.type==="number"&&yn(ye,"number",ye.value)}switch(Ze=le?ds(le):window,i){case"focusin":(fa(Ze)||Ze.contentEditable==="true")&&(k=Ze,E=le,I=null);break;case"focusout":I=E=k=null;break;case"mousedown":B=!0;break;case"contextmenu":case"mouseup":case"dragend":B=!1,G(Ce,c,we);break;case"selectionchange":if(g)break;case"keydown":case"keyup":G(Ce,c,we)}var Qe;if(Qt)e:{switch(i){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else yi?br(i,c)&&(tt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(tt="onCompositionStart");tt&&(os&&c.locale!=="ko"&&(yi||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&yi&&(Qe=io()):(gi=we,vr="value"in gi?gi.value:gi.textContent,yi=!0)),Ze=Gc(le,tt),0<Ze.length&&(tt=new so(tt,i,null,c,we),Ce.push({event:tt,listeners:Ze}),Qe?tt.data=Qe:(Qe=ll(c),Qe!==null&&(tt.data=Qe)))),(Qe=Gd?Bc(i,c):cl(i,c))&&(le=Gc(le,"onBeforeInput"),0<le.length&&(we=new so("onBeforeInput","beforeinput",null,c,we),Ce.push({event:we,listeners:le}),we.data=Qe))}gm(Ce,o)})}function yl(i,o,c){return{instance:i,listener:o,currentTarget:c}}function Gc(i,o){for(var c=o+"Capture",m=[];i!==null;){var b=i,w=b.stateNode;b.tag===5&&w!==null&&(b=w,w=qr(i,c),w!=null&&m.unshift(yl(i,w,b)),w=qr(i,o),w!=null&&m.push(yl(i,w,b))),i=i.return}return m}function cs(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function bm(i,o,c,m,b){for(var w=o._reactName,P=[];c!==null&&c!==m;){var j=c,W=j.alternate,le=j.stateNode;if(W!==null&&W===m)break;j.tag===5&&le!==null&&(j=le,b?(W=qr(c,w),W!=null&&P.unshift(yl(c,W,j))):b||(W=qr(c,w),W!=null&&P.push(yl(c,W,j)))),c=c.return}P.length!==0&&i.push({event:o,listeners:P})}var Dw=/\r\n?/g,Uw=/\u0000|\uFFFD/g;function ym(i){return(typeof i=="string"?i:""+i).replace(Dw,`
`).replace(Uw,"")}function Kc(i,o,c){if(o=ym(o),ym(i)!==o&&c)throw Error(t(425))}function Jc(){}var Zd=null,Qd=null;function Yd(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Xd=typeof setTimeout=="function"?setTimeout:void 0,Fw=typeof clearTimeout=="function"?clearTimeout:void 0,wm=typeof Promise=="function"?Promise:void 0,Bw=typeof queueMicrotask=="function"?queueMicrotask:typeof wm<"u"?function(i){return wm.resolve(null).then(i).catch(Vw)}:Xd;function Vw(i){setTimeout(function(){throw i})}function eh(i,o){var c=o,m=0;do{var b=c.nextSibling;if(i.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(m===0){i.removeChild(b),On(o);return}m--}else c!=="$"&&c!=="$?"&&c!=="$!"||m++;c=b}while(c);On(o)}function va(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function km(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}var us=Math.random().toString(36).slice(2),ki="__reactFiber$"+us,wl="__reactProps$"+us,zi="__reactContainer$"+us,th="__reactEvents$"+us,Ww="__reactListeners$"+us,zw="__reactHandles$"+us;function fo(i){var o=i[ki];if(o)return o;for(var c=i.parentNode;c;){if(o=c[zi]||c[ki]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=km(i);i!==null;){if(c=i[ki])return c;i=km(i)}return o}i=c,c=i.parentNode}return null}function kl(i){return i=i[ki]||i[zi],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ds(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Zc(i){return i[wl]||null}var nh=[],hs=-1;function ba(i){return{current:i}}function Nt(i){0>hs||(i.current=nh[hs],nh[hs]=null,hs--)}function Ot(i,o){hs++,nh[hs]=i.current,i.current=o}var ya={},Ln=ba(ya),ir=ba(!1),mo=ya;function ps(i,o){var c=i.type.contextTypes;if(!c)return ya;var m=i.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===o)return m.__reactInternalMemoizedMaskedChildContext;var b={},w;for(w in c)b[w]=o[w];return m&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=b),b}function ar(i){return i=i.childContextTypes,i!=null}function Qc(){Nt(ir),Nt(Ln)}function Cm(i,o,c){if(Ln.current!==ya)throw Error(t(168));Ot(Ln,o),Ot(ir,c)}function Sm(i,o,c){var m=i.stateNode;if(o=o.childContextTypes,typeof m.getChildContext!="function")return c;m=m.getChildContext();for(var b in m)if(!(b in o))throw Error(t(108,Ye(i)||"Unknown",b));return ue({},c,m)}function Yc(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ya,mo=Ln.current,Ot(Ln,i),Ot(ir,ir.current),!0}function Tm(i,o,c){var m=i.stateNode;if(!m)throw Error(t(169));c?(i=Sm(i,o,mo),m.__reactInternalMemoizedMergedChildContext=i,Nt(ir),Nt(Ln),Ot(Ln,i)):Nt(ir),Ot(ir,c)}var qi=null,Xc=!1,rh=!1;function xm(i){qi===null?qi=[i]:qi.push(i)}function qw(i){Xc=!0,xm(i)}function wa(){if(!rh&&qi!==null){rh=!0;var i=0,o=gt;try{var c=qi;for(gt=1;i<c.length;i++){var m=c[i];do m=m(!0);while(m!==null)}qi=null,Xc=!1}catch(b){throw qi!==null&&(qi=qi.slice(i+1)),Js(Go,wa),b}finally{gt=o,rh=!1}}return null}var fs=[],ms=0,eu=null,tu=0,Ar=[],Mr=0,go=null,$i=1,Hi="";function vo(i,o){fs[ms++]=tu,fs[ms++]=eu,eu=i,tu=o}function Em(i,o,c){Ar[Mr++]=$i,Ar[Mr++]=Hi,Ar[Mr++]=go,go=i;var m=$i;i=Hi;var b=32-kn(m)-1;m&=~(1<<b),c+=1;var w=32-kn(o)+b;if(30<w){var P=b-b%5;w=(m&(1<<P)-1).toString(32),m>>=P,b-=P,$i=1<<32-kn(o)+b|c<<b|m,Hi=w+i}else $i=1<<w|c<<b|m,Hi=i}function ih(i){i.return!==null&&(vo(i,1),Em(i,1,0))}function ah(i){for(;i===eu;)eu=fs[--ms],fs[ms]=null,tu=fs[--ms],fs[ms]=null;for(;i===go;)go=Ar[--Mr],Ar[Mr]=null,Hi=Ar[--Mr],Ar[Mr]=null,$i=Ar[--Mr],Ar[Mr]=null}var yr=null,wr=null,jt=!1,Xr=null;function Pm(i,o){var c=Dr(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=i,o=i.deletions,o===null?(i.deletions=[c],i.flags|=16):o.push(c)}function _m(i,o){switch(i.tag){case 5:var c=i.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,yr=i,wr=va(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,yr=i,wr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=go!==null?{id:$i,overflow:Hi}:null,i.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=Dr(18,null,null,0),c.stateNode=o,c.return=i,i.child=c,yr=i,wr=null,!0):!1;default:return!1}}function oh(i){return(i.mode&1)!==0&&(i.flags&128)===0}function sh(i){if(jt){var o=wr;if(o){var c=o;if(!_m(i,o)){if(oh(i))throw Error(t(418));o=va(c.nextSibling);var m=yr;o&&_m(i,o)?Pm(m,c):(i.flags=i.flags&-4097|2,jt=!1,yr=i)}}else{if(oh(i))throw Error(t(418));i.flags=i.flags&-4097|2,jt=!1,yr=i}}}function Rm(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;yr=i}function nu(i){if(i!==yr)return!1;if(!jt)return Rm(i),jt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Yd(i.type,i.memoizedProps)),o&&(o=wr)){if(oh(i))throw Im(),Error(t(418));for(;o;)Pm(i,o),o=va(o.nextSibling)}if(Rm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(o===0){wr=va(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}i=i.nextSibling}wr=null}}else wr=yr?va(i.stateNode.nextSibling):null;return!0}function Im(){for(var i=wr;i;)i=va(i.nextSibling)}function gs(){wr=yr=null,jt=!1}function lh(i){Xr===null?Xr=[i]:Xr.push(i)}var $w=A.ReactCurrentBatchConfig;function Cl(i,o,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var m=c.stateNode}if(!m)throw Error(t(147,i));var b=m,w=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===w?o.ref:(o=function(P){var j=b.refs;P===null?delete j[w]:j[w]=P},o._stringRef=w,o)}if(typeof i!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,i))}return i}function ru(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Om(i){var o=i._init;return o(i._payload)}function Am(i){function o(te,q){if(i){var ie=te.deletions;ie===null?(te.deletions=[q],te.flags|=16):ie.push(q)}}function c(te,q){if(!i)return null;for(;q!==null;)o(te,q),q=q.sibling;return null}function m(te,q){for(te=new Map;q!==null;)q.key!==null?te.set(q.key,q):te.set(q.index,q),q=q.sibling;return te}function b(te,q){return te=_a(te,q),te.index=0,te.sibling=null,te}function w(te,q,ie){return te.index=ie,i?(ie=te.alternate,ie!==null?(ie=ie.index,ie<q?(te.flags|=2,q):ie):(te.flags|=2,q)):(te.flags|=1048576,q)}function P(te){return i&&te.alternate===null&&(te.flags|=2),te}function j(te,q,ie,Ee){return q===null||q.tag!==6?(q=Yh(ie,te.mode,Ee),q.return=te,q):(q=b(q,ie),q.return=te,q)}function W(te,q,ie,Ee){var Ge=ie.type;return Ge===oe?we(te,q,ie.props.children,Ee,ie.key):q!==null&&(q.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===ot&&Om(Ge)===q.type)?(Ee=b(q,ie.props),Ee.ref=Cl(te,q,ie),Ee.return=te,Ee):(Ee=Pu(ie.type,ie.key,ie.props,null,te.mode,Ee),Ee.ref=Cl(te,q,ie),Ee.return=te,Ee)}function le(te,q,ie,Ee){return q===null||q.tag!==4||q.stateNode.containerInfo!==ie.containerInfo||q.stateNode.implementation!==ie.implementation?(q=Xh(ie,te.mode,Ee),q.return=te,q):(q=b(q,ie.children||[]),q.return=te,q)}function we(te,q,ie,Ee,Ge){return q===null||q.tag!==7?(q=xo(ie,te.mode,Ee,Ge),q.return=te,q):(q=b(q,ie),q.return=te,q)}function Ce(te,q,ie){if(typeof q=="string"&&q!==""||typeof q=="number")return q=Yh(""+q,te.mode,ie),q.return=te,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case U:return ie=Pu(q.type,q.key,q.props,null,te.mode,ie),ie.ref=Cl(te,null,q),ie.return=te,ie;case Z:return q=Xh(q,te.mode,ie),q.return=te,q;case ot:var Ee=q._init;return Ce(te,Ee(q._payload),ie)}if(Ni(q)||ce(q))return q=xo(q,te.mode,ie,null),q.return=te,q;ru(te,q)}return null}function ye(te,q,ie,Ee){var Ge=q!==null?q.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return Ge!==null?null:j(te,q,""+ie,Ee);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case U:return ie.key===Ge?W(te,q,ie,Ee):null;case Z:return ie.key===Ge?le(te,q,ie,Ee):null;case ot:return Ge=ie._init,ye(te,q,Ge(ie._payload),Ee)}if(Ni(ie)||ce(ie))return Ge!==null?null:we(te,q,ie,Ee,null);ru(te,ie)}return null}function je(te,q,ie,Ee,Ge){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return te=te.get(ie)||null,j(q,te,""+Ee,Ge);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case U:return te=te.get(Ee.key===null?ie:Ee.key)||null,W(q,te,Ee,Ge);case Z:return te=te.get(Ee.key===null?ie:Ee.key)||null,le(q,te,Ee,Ge);case ot:var Ze=Ee._init;return je(te,q,ie,Ze(Ee._payload),Ge)}if(Ni(Ee)||ce(Ee))return te=te.get(ie)||null,we(q,te,Ee,Ge,null);ru(q,Ee)}return null}function We(te,q,ie,Ee){for(var Ge=null,Ze=null,Qe=q,tt=q=0,mn=null;Qe!==null&&tt<ie.length;tt++){Qe.index>tt?(mn=Qe,Qe=null):mn=Qe.sibling;var yt=ye(te,Qe,ie[tt],Ee);if(yt===null){Qe===null&&(Qe=mn);break}i&&Qe&&yt.alternate===null&&o(te,Qe),q=w(yt,q,tt),Ze===null?Ge=yt:Ze.sibling=yt,Ze=yt,Qe=mn}if(tt===ie.length)return c(te,Qe),jt&&vo(te,tt),Ge;if(Qe===null){for(;tt<ie.length;tt++)Qe=Ce(te,ie[tt],Ee),Qe!==null&&(q=w(Qe,q,tt),Ze===null?Ge=Qe:Ze.sibling=Qe,Ze=Qe);return jt&&vo(te,tt),Ge}for(Qe=m(te,Qe);tt<ie.length;tt++)mn=je(Qe,te,tt,ie[tt],Ee),mn!==null&&(i&&mn.alternate!==null&&Qe.delete(mn.key===null?tt:mn.key),q=w(mn,q,tt),Ze===null?Ge=mn:Ze.sibling=mn,Ze=mn);return i&&Qe.forEach(function(Ra){return o(te,Ra)}),jt&&vo(te,tt),Ge}function ze(te,q,ie,Ee){var Ge=ce(ie);if(typeof Ge!="function")throw Error(t(150));if(ie=Ge.call(ie),ie==null)throw Error(t(151));for(var Ze=Ge=null,Qe=q,tt=q=0,mn=null,yt=ie.next();Qe!==null&&!yt.done;tt++,yt=ie.next()){Qe.index>tt?(mn=Qe,Qe=null):mn=Qe.sibling;var Ra=ye(te,Qe,yt.value,Ee);if(Ra===null){Qe===null&&(Qe=mn);break}i&&Qe&&Ra.alternate===null&&o(te,Qe),q=w(Ra,q,tt),Ze===null?Ge=Ra:Ze.sibling=Ra,Ze=Ra,Qe=mn}if(yt.done)return c(te,Qe),jt&&vo(te,tt),Ge;if(Qe===null){for(;!yt.done;tt++,yt=ie.next())yt=Ce(te,yt.value,Ee),yt!==null&&(q=w(yt,q,tt),Ze===null?Ge=yt:Ze.sibling=yt,Ze=yt);return jt&&vo(te,tt),Ge}for(Qe=m(te,Qe);!yt.done;tt++,yt=ie.next())yt=je(Qe,te,tt,yt.value,Ee),yt!==null&&(i&&yt.alternate!==null&&Qe.delete(yt.key===null?tt:yt.key),q=w(yt,q,tt),Ze===null?Ge=yt:Ze.sibling=yt,Ze=yt);return i&&Qe.forEach(function(Tk){return o(te,Tk)}),jt&&vo(te,tt),Ge}function Yt(te,q,ie,Ee){if(typeof ie=="object"&&ie!==null&&ie.type===oe&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case U:e:{for(var Ge=ie.key,Ze=q;Ze!==null;){if(Ze.key===Ge){if(Ge=ie.type,Ge===oe){if(Ze.tag===7){c(te,Ze.sibling),q=b(Ze,ie.props.children),q.return=te,te=q;break e}}else if(Ze.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===ot&&Om(Ge)===Ze.type){c(te,Ze.sibling),q=b(Ze,ie.props),q.ref=Cl(te,Ze,ie),q.return=te,te=q;break e}c(te,Ze);break}else o(te,Ze);Ze=Ze.sibling}ie.type===oe?(q=xo(ie.props.children,te.mode,Ee,ie.key),q.return=te,te=q):(Ee=Pu(ie.type,ie.key,ie.props,null,te.mode,Ee),Ee.ref=Cl(te,q,ie),Ee.return=te,te=Ee)}return P(te);case Z:e:{for(Ze=ie.key;q!==null;){if(q.key===Ze)if(q.tag===4&&q.stateNode.containerInfo===ie.containerInfo&&q.stateNode.implementation===ie.implementation){c(te,q.sibling),q=b(q,ie.children||[]),q.return=te,te=q;break e}else{c(te,q);break}else o(te,q);q=q.sibling}q=Xh(ie,te.mode,Ee),q.return=te,te=q}return P(te);case ot:return Ze=ie._init,Yt(te,q,Ze(ie._payload),Ee)}if(Ni(ie))return We(te,q,ie,Ee);if(ce(ie))return ze(te,q,ie,Ee);ru(te,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,q!==null&&q.tag===6?(c(te,q.sibling),q=b(q,ie),q.return=te,te=q):(c(te,q),q=Yh(ie,te.mode,Ee),q.return=te,te=q),P(te)):c(te,q)}return Yt}var vs=Am(!0),Mm=Am(!1),iu=ba(null),au=null,bs=null,ch=null;function uh(){ch=bs=au=null}function dh(i){var o=iu.current;Nt(iu),i._currentValue=o}function hh(i,o,c){for(;i!==null;){var m=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),i===c)break;i=i.return}}function ys(i,o){au=i,ch=bs=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(or=!0),i.firstContext=null)}function Lr(i){var o=i._currentValue;if(ch!==i)if(i={context:i,memoizedValue:o,next:null},bs===null){if(au===null)throw Error(t(308));bs=i,au.dependencies={lanes:0,firstContext:i}}else bs=bs.next=i;return o}var bo=null;function ph(i){bo===null?bo=[i]:bo.push(i)}function Lm(i,o,c,m){var b=o.interleaved;return b===null?(c.next=c,ph(o)):(c.next=b.next,b.next=c),o.interleaved=c,Gi(i,m)}function Gi(i,o){i.lanes|=o;var c=i.alternate;for(c!==null&&(c.lanes|=o),c=i,i=i.return;i!==null;)i.childLanes|=o,c=i.alternate,c!==null&&(c.childLanes|=o),c=i,i=i.return;return c.tag===3?c.stateNode:null}var ka=!1;function fh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nm(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ki(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Ca(i,o,c){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,(bt&2)!==0){var b=m.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),m.pending=o,Gi(i,c)}return b=m.interleaved,b===null?(o.next=o,ph(m)):(o.next=b.next,b.next=o),m.interleaved=o,Gi(i,c)}function ou(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var m=o.lanes;m&=i.pendingLanes,c|=m,o.lanes=c,Za(i,c)}}function jm(i,o){var c=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var b=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var P={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};w===null?b=w=P:w=w.next=P,c=c.next}while(c!==null);w===null?b=w=o:w=w.next=o}else b=w=o;c={baseState:m.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:m.shared,effects:m.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}function su(i,o,c,m){var b=i.updateQueue;ka=!1;var w=b.firstBaseUpdate,P=b.lastBaseUpdate,j=b.shared.pending;if(j!==null){b.shared.pending=null;var W=j,le=W.next;W.next=null,P===null?w=le:P.next=le,P=W;var we=i.alternate;we!==null&&(we=we.updateQueue,j=we.lastBaseUpdate,j!==P&&(j===null?we.firstBaseUpdate=le:j.next=le,we.lastBaseUpdate=W))}if(w!==null){var Ce=b.baseState;P=0,we=le=W=null,j=w;do{var ye=j.lane,je=j.eventTime;if((m&ye)===ye){we!==null&&(we=we.next={eventTime:je,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var We=i,ze=j;switch(ye=o,je=c,ze.tag){case 1:if(We=ze.payload,typeof We=="function"){Ce=We.call(je,Ce,ye);break e}Ce=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=ze.payload,ye=typeof We=="function"?We.call(je,Ce,ye):We,ye==null)break e;Ce=ue({},Ce,ye);break e;case 2:ka=!0}}j.callback!==null&&j.lane!==0&&(i.flags|=64,ye=b.effects,ye===null?b.effects=[j]:ye.push(j))}else je={eventTime:je,lane:ye,tag:j.tag,payload:j.payload,callback:j.callback,next:null},we===null?(le=we=je,W=Ce):we=we.next=je,P|=ye;if(j=j.next,j===null){if(j=b.shared.pending,j===null)break;ye=j,j=ye.next,ye.next=null,b.lastBaseUpdate=ye,b.shared.pending=null}}while(!0);if(we===null&&(W=Ce),b.baseState=W,b.firstBaseUpdate=le,b.lastBaseUpdate=we,o=b.shared.interleaved,o!==null){b=o;do P|=b.lane,b=b.next;while(b!==o)}else w===null&&(b.shared.lanes=0);ko|=P,i.lanes=P,i.memoizedState=Ce}}function Dm(i,o,c){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var m=i[o],b=m.callback;if(b!==null){if(m.callback=null,m=c,typeof b!="function")throw Error(t(191,b));b.call(m)}}}var Sl={},Ci=ba(Sl),Tl=ba(Sl),xl=ba(Sl);function yo(i){if(i===Sl)throw Error(t(174));return i}function mh(i,o){switch(Ot(xl,o),Ot(Tl,i),Ot(Ci,Sl),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:O(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=O(o,i)}Nt(Ci),Ot(Ci,o)}function ws(){Nt(Ci),Nt(Tl),Nt(xl)}function Um(i){yo(xl.current);var o=yo(Ci.current),c=O(o,i.type);o!==c&&(Ot(Tl,i),Ot(Ci,c))}function gh(i){Tl.current===i&&(Nt(Ci),Nt(Tl))}var Bt=ba(0);function lu(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var vh=[];function bh(){for(var i=0;i<vh.length;i++)vh[i]._workInProgressVersionPrimary=null;vh.length=0}var cu=A.ReactCurrentDispatcher,yh=A.ReactCurrentBatchConfig,wo=0,Vt=null,on=null,pn=null,uu=!1,El=!1,Pl=0,Hw=0;function Nn(){throw Error(t(321))}function wh(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!rr(i[c],o[c]))return!1;return!0}function kh(i,o,c,m,b,w){if(wo=w,Vt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,cu.current=i===null||i.memoizedState===null?Zw:Qw,i=c(m,b),El){w=0;do{if(El=!1,Pl=0,25<=w)throw Error(t(301));w+=1,pn=on=null,o.updateQueue=null,cu.current=Yw,i=c(m,b)}while(El)}if(cu.current=pu,o=on!==null&&on.next!==null,wo=0,pn=on=Vt=null,uu=!1,o)throw Error(t(300));return i}function Ch(){var i=Pl!==0;return Pl=0,i}function Si(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Vt.memoizedState=pn=i:pn=pn.next=i,pn}function Nr(){if(on===null){var i=Vt.alternate;i=i!==null?i.memoizedState:null}else i=on.next;var o=pn===null?Vt.memoizedState:pn.next;if(o!==null)pn=o,on=i;else{if(i===null)throw Error(t(310));on=i,i={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},pn===null?Vt.memoizedState=pn=i:pn=pn.next=i}return pn}function _l(i,o){return typeof o=="function"?o(i):o}function Sh(i){var o=Nr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var m=on,b=m.baseQueue,w=c.pending;if(w!==null){if(b!==null){var P=b.next;b.next=w.next,w.next=P}m.baseQueue=b=w,c.pending=null}if(b!==null){w=b.next,m=m.baseState;var j=P=null,W=null,le=w;do{var we=le.lane;if((wo&we)===we)W!==null&&(W=W.next={lane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),m=le.hasEagerState?le.eagerState:i(m,le.action);else{var Ce={lane:we,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null};W===null?(j=W=Ce,P=m):W=W.next=Ce,Vt.lanes|=we,ko|=we}le=le.next}while(le!==null&&le!==w);W===null?P=m:W.next=j,rr(m,o.memoizedState)||(or=!0),o.memoizedState=m,o.baseState=P,o.baseQueue=W,c.lastRenderedState=m}if(i=c.interleaved,i!==null){b=i;do w=b.lane,Vt.lanes|=w,ko|=w,b=b.next;while(b!==i)}else b===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function Th(i){var o=Nr(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var m=c.dispatch,b=c.pending,w=o.memoizedState;if(b!==null){c.pending=null;var P=b=b.next;do w=i(w,P.action),P=P.next;while(P!==b);rr(w,o.memoizedState)||(or=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),c.lastRenderedState=w}return[w,m]}function Fm(){}function Bm(i,o){var c=Vt,m=Nr(),b=o(),w=!rr(m.memoizedState,b);if(w&&(m.memoizedState=b,or=!0),m=m.queue,xh(zm.bind(null,c,m,i),[i]),m.getSnapshot!==o||w||pn!==null&&pn.memoizedState.tag&1){if(c.flags|=2048,Rl(9,Wm.bind(null,c,m,b,o),void 0,null),fn===null)throw Error(t(349));(wo&30)!==0||Vm(c,o,b)}return b}function Vm(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=Vt.updateQueue,o===null?(o={lastEffect:null,stores:null},Vt.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function Wm(i,o,c,m){o.value=c,o.getSnapshot=m,qm(o)&&$m(i)}function zm(i,o,c){return c(function(){qm(o)&&$m(i)})}function qm(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!rr(i,c)}catch{return!0}}function $m(i){var o=Gi(i,1);o!==null&&ri(o,i,1,-1)}function Hm(i){var o=Si();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:i},o.queue=i,i=i.dispatch=Jw.bind(null,Vt,i),[o.memoizedState,i]}function Rl(i,o,c,m){return i={tag:i,create:o,destroy:c,deps:m,next:null},o=Vt.updateQueue,o===null?(o={lastEffect:null,stores:null},Vt.updateQueue=o,o.lastEffect=i.next=i):(c=o.lastEffect,c===null?o.lastEffect=i.next=i:(m=c.next,c.next=i,i.next=m,o.lastEffect=i)),i}function Gm(){return Nr().memoizedState}function du(i,o,c,m){var b=Si();Vt.flags|=i,b.memoizedState=Rl(1|o,c,void 0,m===void 0?null:m)}function hu(i,o,c,m){var b=Nr();m=m===void 0?null:m;var w=void 0;if(on!==null){var P=on.memoizedState;if(w=P.destroy,m!==null&&wh(m,P.deps)){b.memoizedState=Rl(o,c,w,m);return}}Vt.flags|=i,b.memoizedState=Rl(1|o,c,w,m)}function Km(i,o){return du(8390656,8,i,o)}function xh(i,o){return hu(2048,8,i,o)}function Jm(i,o){return hu(4,2,i,o)}function Zm(i,o){return hu(4,4,i,o)}function Qm(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Ym(i,o,c){return c=c!=null?c.concat([i]):null,hu(4,4,Qm.bind(null,o,i),c)}function Eh(){}function Xm(i,o){var c=Nr();o=o===void 0?null:o;var m=c.memoizedState;return m!==null&&o!==null&&wh(o,m[1])?m[0]:(c.memoizedState=[i,o],i)}function eg(i,o){var c=Nr();o=o===void 0?null:o;var m=c.memoizedState;return m!==null&&o!==null&&wh(o,m[1])?m[0]:(i=i(),c.memoizedState=[i,o],i)}function tg(i,o,c){return(wo&21)===0?(i.baseState&&(i.baseState=!1,or=!0),i.memoizedState=c):(rr(c,o)||(c=Ys(),Vt.lanes|=c,ko|=c,i.baseState=!0),o)}function Gw(i,o){var c=gt;gt=c!==0&&4>c?c:4,i(!0);var m=yh.transition;yh.transition={};try{i(!1),o()}finally{gt=c,yh.transition=m}}function ng(){return Nr().memoizedState}function Kw(i,o,c){var m=Ea(i);if(c={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null},rg(i))ig(o,c);else if(c=Lm(i,o,c,m),c!==null){var b=qn();ri(c,i,m,b),ag(c,o,m)}}function Jw(i,o,c){var m=Ea(i),b={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null};if(rg(i))ig(o,b);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var P=o.lastRenderedState,j=w(P,c);if(b.hasEagerState=!0,b.eagerState=j,rr(j,P)){var W=o.interleaved;W===null?(b.next=b,ph(o)):(b.next=W.next,W.next=b),o.interleaved=b;return}}catch{}finally{}c=Lm(i,o,b,m),c!==null&&(b=qn(),ri(c,i,m,b),ag(c,o,m))}}function rg(i){var o=i.alternate;return i===Vt||o!==null&&o===Vt}function ig(i,o){El=uu=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function ag(i,o,c){if((c&4194240)!==0){var m=o.lanes;m&=i.pendingLanes,c|=m,o.lanes=c,Za(i,c)}}var pu={readContext:Lr,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},Zw={readContext:Lr,useCallback:function(i,o){return Si().memoizedState=[i,o===void 0?null:o],i},useContext:Lr,useEffect:Km,useImperativeHandle:function(i,o,c){return c=c!=null?c.concat([i]):null,du(4194308,4,Qm.bind(null,o,i),c)},useLayoutEffect:function(i,o){return du(4194308,4,i,o)},useInsertionEffect:function(i,o){return du(4,2,i,o)},useMemo:function(i,o){var c=Si();return o=o===void 0?null:o,i=i(),c.memoizedState=[i,o],i},useReducer:function(i,o,c){var m=Si();return o=c!==void 0?c(o):o,m.memoizedState=m.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},m.queue=i,i=i.dispatch=Kw.bind(null,Vt,i),[m.memoizedState,i]},useRef:function(i){var o=Si();return i={current:i},o.memoizedState=i},useState:Hm,useDebugValue:Eh,useDeferredValue:function(i){return Si().memoizedState=i},useTransition:function(){var i=Hm(!1),o=i[0];return i=Gw.bind(null,i[1]),Si().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,c){var m=Vt,b=Si();if(jt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=o(),fn===null)throw Error(t(349));(wo&30)!==0||Vm(m,o,c)}b.memoizedState=c;var w={value:c,getSnapshot:o};return b.queue=w,Km(zm.bind(null,m,w,i),[i]),m.flags|=2048,Rl(9,Wm.bind(null,m,w,c,o),void 0,null),c},useId:function(){var i=Si(),o=fn.identifierPrefix;if(jt){var c=Hi,m=$i;c=(m&~(1<<32-kn(m)-1)).toString(32)+c,o=":"+o+"R"+c,c=Pl++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=Hw++,o=":"+o+"r"+c.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},Qw={readContext:Lr,useCallback:Xm,useContext:Lr,useEffect:xh,useImperativeHandle:Ym,useInsertionEffect:Jm,useLayoutEffect:Zm,useMemo:eg,useReducer:Sh,useRef:Gm,useState:function(){return Sh(_l)},useDebugValue:Eh,useDeferredValue:function(i){var o=Nr();return tg(o,on.memoizedState,i)},useTransition:function(){var i=Sh(_l)[0],o=Nr().memoizedState;return[i,o]},useMutableSource:Fm,useSyncExternalStore:Bm,useId:ng,unstable_isNewReconciler:!1},Yw={readContext:Lr,useCallback:Xm,useContext:Lr,useEffect:xh,useImperativeHandle:Ym,useInsertionEffect:Jm,useLayoutEffect:Zm,useMemo:eg,useReducer:Th,useRef:Gm,useState:function(){return Th(_l)},useDebugValue:Eh,useDeferredValue:function(i){var o=Nr();return on===null?o.memoizedState=i:tg(o,on.memoizedState,i)},useTransition:function(){var i=Th(_l)[0],o=Nr().memoizedState;return[i,o]},useMutableSource:Fm,useSyncExternalStore:Bm,useId:ng,unstable_isNewReconciler:!1};function ei(i,o){if(i&&i.defaultProps){o=ue({},o),i=i.defaultProps;for(var c in i)o[c]===void 0&&(o[c]=i[c]);return o}return o}function Ph(i,o,c,m){o=i.memoizedState,c=c(m,o),c=c==null?o:ue({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var fu={isMounted:function(i){return(i=i._reactInternals)?hi(i)===i:!1},enqueueSetState:function(i,o,c){i=i._reactInternals;var m=qn(),b=Ea(i),w=Ki(m,b);w.payload=o,c!=null&&(w.callback=c),o=Ca(i,w,b),o!==null&&(ri(o,i,b,m),ou(o,i,b))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var m=qn(),b=Ea(i),w=Ki(m,b);w.tag=1,w.payload=o,c!=null&&(w.callback=c),o=Ca(i,w,b),o!==null&&(ri(o,i,b,m),ou(o,i,b))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=qn(),m=Ea(i),b=Ki(c,m);b.tag=2,o!=null&&(b.callback=o),o=Ca(i,b,m),o!==null&&(ri(o,i,m,c),ou(o,i,m))}};function og(i,o,c,m,b,w,P){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,w,P):o.prototype&&o.prototype.isPureReactComponent?!ga(c,m)||!ga(b,w):!0}function sg(i,o,c){var m=!1,b=ya,w=o.contextType;return typeof w=="object"&&w!==null?w=Lr(w):(b=ar(o)?mo:Ln.current,m=o.contextTypes,w=(m=m!=null)?ps(i,b):ya),o=new o(c,w),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=fu,i.stateNode=o,o._reactInternals=i,m&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=b,i.__reactInternalMemoizedMaskedChildContext=w),o}function lg(i,o,c,m){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,m),o.state!==i&&fu.enqueueReplaceState(o,o.state,null)}function _h(i,o,c,m){var b=i.stateNode;b.props=c,b.state=i.memoizedState,b.refs={},fh(i);var w=o.contextType;typeof w=="object"&&w!==null?b.context=Lr(w):(w=ar(o)?mo:Ln.current,b.context=ps(i,w)),b.state=i.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Ph(i,o,w,c),b.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(o=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),o!==b.state&&fu.enqueueReplaceState(b,b.state,null),su(i,c,b,m),b.state=i.memoizedState),typeof b.componentDidMount=="function"&&(i.flags|=4194308)}function ks(i,o){try{var c="",m=o;do c+=Me(m),m=m.return;while(m);var b=c}catch(w){b=`
Error generating stack: `+w.message+`
`+w.stack}return{value:i,source:o,stack:b,digest:null}}function Rh(i,o,c){return{value:i,source:null,stack:c??null,digest:o??null}}function Ih(i,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var Xw=typeof WeakMap=="function"?WeakMap:Map;function cg(i,o,c){c=Ki(-1,c),c.tag=3,c.payload={element:null};var m=o.value;return c.callback=function(){ku||(ku=!0,qh=m),Ih(i,o)},c}function ug(i,o,c){c=Ki(-1,c),c.tag=3;var m=i.type.getDerivedStateFromError;if(typeof m=="function"){var b=o.value;c.payload=function(){return m(b)},c.callback=function(){Ih(i,o)}}var w=i.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(c.callback=function(){Ih(i,o),typeof m!="function"&&(Ta===null?Ta=new Set([this]):Ta.add(this));var P=o.stack;this.componentDidCatch(o.value,{componentStack:P!==null?P:""})}),c}function dg(i,o,c){var m=i.pingCache;if(m===null){m=i.pingCache=new Xw;var b=new Set;m.set(o,b)}else b=m.get(o),b===void 0&&(b=new Set,m.set(o,b));b.has(c)||(b.add(c),i=pk.bind(null,i,o,c),o.then(i,i))}function hg(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function pg(i,o,c,m,b){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=Ki(-1,1),o.tag=2,Ca(c,o,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=b,i)}var ek=A.ReactCurrentOwner,or=!1;function zn(i,o,c,m){o.child=i===null?Mm(o,null,c,m):vs(o,i.child,c,m)}function fg(i,o,c,m,b){c=c.render;var w=o.ref;return ys(o,b),m=kh(i,o,c,m,w,b),c=Ch(),i!==null&&!or?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~b,Ji(i,o,b)):(jt&&c&&ih(o),o.flags|=1,zn(i,o,m,b),o.child)}function mg(i,o,c,m,b){if(i===null){var w=c.type;return typeof w=="function"&&!Qh(w)&&w.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=w,gg(i,o,w,m,b)):(i=Pu(c.type,null,m,o,o.mode,b),i.ref=o.ref,i.return=o,o.child=i)}if(w=i.child,(i.lanes&b)===0){var P=w.memoizedProps;if(c=c.compare,c=c!==null?c:ga,c(P,m)&&i.ref===o.ref)return Ji(i,o,b)}return o.flags|=1,i=_a(w,m),i.ref=o.ref,i.return=o,o.child=i}function gg(i,o,c,m,b){if(i!==null){var w=i.memoizedProps;if(ga(w,m)&&i.ref===o.ref)if(or=!1,o.pendingProps=m=w,(i.lanes&b)!==0)(i.flags&131072)!==0&&(or=!0);else return o.lanes=i.lanes,Ji(i,o,b)}return Oh(i,o,c,m,b)}function vg(i,o,c){var m=o.pendingProps,b=m.children,w=i!==null?i.memoizedState:null;if(m.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(Ss,kr),kr|=c;else{if((c&1073741824)===0)return i=w!==null?w.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Ot(Ss,kr),kr|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:c,Ot(Ss,kr),kr|=m}else w!==null?(m=w.baseLanes|c,o.memoizedState=null):m=c,Ot(Ss,kr),kr|=m;return zn(i,o,b,c),o.child}function bg(i,o){var c=o.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function Oh(i,o,c,m,b){var w=ar(c)?mo:Ln.current;return w=ps(o,w),ys(o,b),c=kh(i,o,c,m,w,b),m=Ch(),i!==null&&!or?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~b,Ji(i,o,b)):(jt&&m&&ih(o),o.flags|=1,zn(i,o,c,b),o.child)}function yg(i,o,c,m,b){if(ar(c)){var w=!0;Yc(o)}else w=!1;if(ys(o,b),o.stateNode===null)gu(i,o),sg(o,c,m),_h(o,c,m,b),m=!0;else if(i===null){var P=o.stateNode,j=o.memoizedProps;P.props=j;var W=P.context,le=c.contextType;typeof le=="object"&&le!==null?le=Lr(le):(le=ar(c)?mo:Ln.current,le=ps(o,le));var we=c.getDerivedStateFromProps,Ce=typeof we=="function"||typeof P.getSnapshotBeforeUpdate=="function";Ce||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(j!==m||W!==le)&&lg(o,P,m,le),ka=!1;var ye=o.memoizedState;P.state=ye,su(o,m,P,b),W=o.memoizedState,j!==m||ye!==W||ir.current||ka?(typeof we=="function"&&(Ph(o,c,we,m),W=o.memoizedState),(j=ka||og(o,c,j,m,ye,W,le))?(Ce||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(o.flags|=4194308)):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=W),P.props=m,P.state=W,P.context=le,m=j):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{P=o.stateNode,Nm(i,o),j=o.memoizedProps,le=o.type===o.elementType?j:ei(o.type,j),P.props=le,Ce=o.pendingProps,ye=P.context,W=c.contextType,typeof W=="object"&&W!==null?W=Lr(W):(W=ar(c)?mo:Ln.current,W=ps(o,W));var je=c.getDerivedStateFromProps;(we=typeof je=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(j!==Ce||ye!==W)&&lg(o,P,m,W),ka=!1,ye=o.memoizedState,P.state=ye,su(o,m,P,b);var We=o.memoizedState;j!==Ce||ye!==We||ir.current||ka?(typeof je=="function"&&(Ph(o,c,je,m),We=o.memoizedState),(le=ka||og(o,c,le,m,ye,We,W)||!1)?(we||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(m,We,W),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(m,We,W)),typeof P.componentDidUpdate=="function"&&(o.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof P.componentDidUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=We),P.props=m,P.state=We,P.context=W,m=le):(typeof P.componentDidUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||j===i.memoizedProps&&ye===i.memoizedState||(o.flags|=1024),m=!1)}return Ah(i,o,c,m,w,b)}function Ah(i,o,c,m,b,w){bg(i,o);var P=(o.flags&128)!==0;if(!m&&!P)return b&&Tm(o,c,!1),Ji(i,o,w);m=o.stateNode,ek.current=o;var j=P&&typeof c.getDerivedStateFromError!="function"?null:m.render();return o.flags|=1,i!==null&&P?(o.child=vs(o,i.child,null,w),o.child=vs(o,null,j,w)):zn(i,o,j,w),o.memoizedState=m.state,b&&Tm(o,c,!0),o.child}function wg(i){var o=i.stateNode;o.pendingContext?Cm(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Cm(i,o.context,!1),mh(i,o.containerInfo)}function kg(i,o,c,m,b){return gs(),lh(b),o.flags|=256,zn(i,o,c,m),o.child}var Mh={dehydrated:null,treeContext:null,retryLane:0};function Lh(i){return{baseLanes:i,cachePool:null,transitions:null}}function Cg(i,o,c){var m=o.pendingProps,b=Bt.current,w=!1,P=(o.flags&128)!==0,j;if((j=P)||(j=i!==null&&i.memoizedState===null?!1:(b&2)!==0),j?(w=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(b|=1),Ot(Bt,b&1),i===null)return sh(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(P=m.children,i=m.fallback,w?(m=o.mode,w=o.child,P={mode:"hidden",children:P},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=_u(P,m,0,null),i=xo(i,m,c,null),w.return=o,i.return=o,w.sibling=i,o.child=w,o.child.memoizedState=Lh(c),o.memoizedState=Mh,i):Nh(o,P));if(b=i.memoizedState,b!==null&&(j=b.dehydrated,j!==null))return tk(i,o,P,m,j,b,c);if(w){w=m.fallback,P=o.mode,b=i.child,j=b.sibling;var W={mode:"hidden",children:m.children};return(P&1)===0&&o.child!==b?(m=o.child,m.childLanes=0,m.pendingProps=W,o.deletions=null):(m=_a(b,W),m.subtreeFlags=b.subtreeFlags&14680064),j!==null?w=_a(j,w):(w=xo(w,P,c,null),w.flags|=2),w.return=o,m.return=o,m.sibling=w,o.child=m,m=w,w=o.child,P=i.child.memoizedState,P=P===null?Lh(c):{baseLanes:P.baseLanes|c,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=i.childLanes&~c,o.memoizedState=Mh,m}return w=i.child,i=w.sibling,m=_a(w,{mode:"visible",children:m.children}),(o.mode&1)===0&&(m.lanes=c),m.return=o,m.sibling=null,i!==null&&(c=o.deletions,c===null?(o.deletions=[i],o.flags|=16):c.push(i)),o.child=m,o.memoizedState=null,m}function Nh(i,o){return o=_u({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function mu(i,o,c,m){return m!==null&&lh(m),vs(o,i.child,null,c),i=Nh(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function tk(i,o,c,m,b,w,P){if(c)return o.flags&256?(o.flags&=-257,m=Rh(Error(t(422))),mu(i,o,P,m)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(w=m.fallback,b=o.mode,m=_u({mode:"visible",children:m.children},b,0,null),w=xo(w,b,P,null),w.flags|=2,m.return=o,w.return=o,m.sibling=w,o.child=m,(o.mode&1)!==0&&vs(o,i.child,null,P),o.child.memoizedState=Lh(P),o.memoizedState=Mh,w);if((o.mode&1)===0)return mu(i,o,P,null);if(b.data==="$!"){if(m=b.nextSibling&&b.nextSibling.dataset,m)var j=m.dgst;return m=j,w=Error(t(419)),m=Rh(w,m,void 0),mu(i,o,P,m)}if(j=(P&i.childLanes)!==0,or||j){if(m=fn,m!==null){switch(P&-P){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(m.suspendedLanes|P))!==0?0:b,b!==0&&b!==w.retryLane&&(w.retryLane=b,Gi(i,b),ri(m,i,b,-1))}return Zh(),m=Rh(Error(t(421))),mu(i,o,P,m)}return b.data==="$?"?(o.flags|=128,o.child=i.child,o=fk.bind(null,i),b._reactRetry=o,null):(i=w.treeContext,wr=va(b.nextSibling),yr=o,jt=!0,Xr=null,i!==null&&(Ar[Mr++]=$i,Ar[Mr++]=Hi,Ar[Mr++]=go,$i=i.id,Hi=i.overflow,go=o),o=Nh(o,m.children),o.flags|=4096,o)}function Sg(i,o,c){i.lanes|=o;var m=i.alternate;m!==null&&(m.lanes|=o),hh(i.return,o,c)}function jh(i,o,c,m,b){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:b}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=c,w.tailMode=b)}function Tg(i,o,c){var m=o.pendingProps,b=m.revealOrder,w=m.tail;if(zn(i,o,m.children,c),m=Bt.current,(m&2)!==0)m=m&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Sg(i,c,o);else if(i.tag===19)Sg(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}m&=1}if(Ot(Bt,m),(o.mode&1)===0)o.memoizedState=null;else switch(b){case"forwards":for(c=o.child,b=null;c!==null;)i=c.alternate,i!==null&&lu(i)===null&&(b=c),c=c.sibling;c=b,c===null?(b=o.child,o.child=null):(b=c.sibling,c.sibling=null),jh(o,!1,b,c,w);break;case"backwards":for(c=null,b=o.child,o.child=null;b!==null;){if(i=b.alternate,i!==null&&lu(i)===null){o.child=b;break}i=b.sibling,b.sibling=c,c=b,b=i}jh(o,!0,c,null,w);break;case"together":jh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function gu(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Ji(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),ko|=o.lanes,(c&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,c=_a(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=_a(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function nk(i,o,c){switch(o.tag){case 3:wg(o),gs();break;case 5:Um(o);break;case 1:ar(o.type)&&Yc(o);break;case 4:mh(o,o.stateNode.containerInfo);break;case 10:var m=o.type._context,b=o.memoizedProps.value;Ot(iu,m._currentValue),m._currentValue=b;break;case 13:if(m=o.memoizedState,m!==null)return m.dehydrated!==null?(Ot(Bt,Bt.current&1),o.flags|=128,null):(c&o.child.childLanes)!==0?Cg(i,o,c):(Ot(Bt,Bt.current&1),i=Ji(i,o,c),i!==null?i.sibling:null);Ot(Bt,Bt.current&1);break;case 19:if(m=(c&o.childLanes)!==0,(i.flags&128)!==0){if(m)return Tg(i,o,c);o.flags|=128}if(b=o.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Ot(Bt,Bt.current),m)break;return null;case 22:case 23:return o.lanes=0,vg(i,o,c)}return Ji(i,o,c)}var xg,Dh,Eg,Pg;xg=function(i,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Dh=function(){},Eg=function(i,o,c,m){var b=i.memoizedProps;if(b!==m){i=o.stateNode,yo(Ci.current);var w=null;switch(c){case"input":b=Sr(i,b),m=Sr(i,m),w=[];break;case"select":b=ue({},b,{value:void 0}),m=ue({},m,{value:void 0}),w=[];break;case"textarea":b=ji(i,b),m=ji(i,m),w=[];break;default:typeof b.onClick!="function"&&typeof m.onClick=="function"&&(i.onclick=Jc)}$t(c,m);var P;c=null;for(le in b)if(!m.hasOwnProperty(le)&&b.hasOwnProperty(le)&&b[le]!=null)if(le==="style"){var j=b[le];for(P in j)j.hasOwnProperty(P)&&(c||(c={}),c[P]="")}else le!=="dangerouslySetInnerHTML"&&le!=="children"&&le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&le!=="autoFocus"&&(a.hasOwnProperty(le)?w||(w=[]):(w=w||[]).push(le,null));for(le in m){var W=m[le];if(j=b!=null?b[le]:void 0,m.hasOwnProperty(le)&&W!==j&&(W!=null||j!=null))if(le==="style")if(j){for(P in j)!j.hasOwnProperty(P)||W&&W.hasOwnProperty(P)||(c||(c={}),c[P]="");for(P in W)W.hasOwnProperty(P)&&j[P]!==W[P]&&(c||(c={}),c[P]=W[P])}else c||(w||(w=[]),w.push(le,c)),c=W;else le==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,j=j?j.__html:void 0,W!=null&&j!==W&&(w=w||[]).push(le,W)):le==="children"?typeof W!="string"&&typeof W!="number"||(w=w||[]).push(le,""+W):le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&(a.hasOwnProperty(le)?(W!=null&&le==="onScroll"&&Lt("scroll",i),w||j===W||(w=[])):(w=w||[]).push(le,W))}c&&(w=w||[]).push("style",c);var le=w;(o.updateQueue=le)&&(o.flags|=4)}},Pg=function(i,o,c,m){c!==m&&(o.flags|=4)};function Il(i,o){if(!jt)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function jn(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,m=0;if(o)for(var b=i.child;b!==null;)c|=b.lanes|b.childLanes,m|=b.subtreeFlags&14680064,m|=b.flags&14680064,b.return=i,b=b.sibling;else for(b=i.child;b!==null;)c|=b.lanes|b.childLanes,m|=b.subtreeFlags,m|=b.flags,b.return=i,b=b.sibling;return i.subtreeFlags|=m,i.childLanes=c,o}function rk(i,o,c){var m=o.pendingProps;switch(ah(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(o),null;case 1:return ar(o.type)&&Qc(),jn(o),null;case 3:return m=o.stateNode,ws(),Nt(ir),Nt(Ln),bh(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(i===null||i.child===null)&&(nu(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Xr!==null&&(Gh(Xr),Xr=null))),Dh(i,o),jn(o),null;case 5:gh(o);var b=yo(xl.current);if(c=o.type,i!==null&&o.stateNode!=null)Eg(i,o,c,m,b),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!m){if(o.stateNode===null)throw Error(t(166));return jn(o),null}if(i=yo(Ci.current),nu(o)){m=o.stateNode,c=o.type;var w=o.memoizedProps;switch(m[ki]=o,m[wl]=w,i=(o.mode&1)!==0,c){case"dialog":Lt("cancel",m),Lt("close",m);break;case"iframe":case"object":case"embed":Lt("load",m);break;case"video":case"audio":for(b=0;b<Wi.length;b++)Lt(Wi[b],m);break;case"source":Lt("error",m);break;case"img":case"image":case"link":Lt("error",m),Lt("load",m);break;case"details":Lt("toggle",m);break;case"input":Tr(m,w),Lt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},Lt("invalid",m);break;case"textarea":Vo(m,w),Lt("invalid",m)}$t(c,w),b=null;for(var P in w)if(w.hasOwnProperty(P)){var j=w[P];P==="children"?typeof j=="string"?m.textContent!==j&&(w.suppressHydrationWarning!==!0&&Kc(m.textContent,j,i),b=["children",j]):typeof j=="number"&&m.textContent!==""+j&&(w.suppressHydrationWarning!==!0&&Kc(m.textContent,j,i),b=["children",""+j]):a.hasOwnProperty(P)&&j!=null&&P==="onScroll"&&Lt("scroll",m)}switch(c){case"input":qt(m),Bo(m,w,!0);break;case"textarea":qt(m),y(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=Jc)}m=b,o.updateQueue=m,m!==null&&(o.flags|=4)}else{P=b.nodeType===9?b:b.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=S(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=P.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof m.is=="string"?i=P.createElement(c,{is:m.is}):(i=P.createElement(c),c==="select"&&(P=i,m.multiple?P.multiple=!0:m.size&&(P.size=m.size))):i=P.createElementNS(i,c),i[ki]=o,i[wl]=m,xg(i,o,!1,!1),o.stateNode=i;e:{switch(P=xt(c,m),c){case"dialog":Lt("cancel",i),Lt("close",i),b=m;break;case"iframe":case"object":case"embed":Lt("load",i),b=m;break;case"video":case"audio":for(b=0;b<Wi.length;b++)Lt(Wi[b],i);b=m;break;case"source":Lt("error",i),b=m;break;case"img":case"image":case"link":Lt("error",i),Lt("load",i),b=m;break;case"details":Lt("toggle",i),b=m;break;case"input":Tr(i,m),b=Sr(i,m),Lt("invalid",i);break;case"option":b=m;break;case"select":i._wrapperState={wasMultiple:!!m.multiple},b=ue({},m,{value:void 0}),Lt("invalid",i);break;case"textarea":Vo(i,m),b=ji(i,m),Lt("invalid",i);break;default:b=m}$t(c,b),j=b;for(w in j)if(j.hasOwnProperty(w)){var W=j[w];w==="style"?st(i,W):w==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,W!=null&&de(i,W)):w==="children"?typeof W=="string"?(c!=="textarea"||W!=="")&&be(i,W):typeof W=="number"&&be(i,""+W):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(a.hasOwnProperty(w)?W!=null&&w==="onScroll"&&Lt("scroll",i):W!=null&&F(i,w,W,P))}switch(c){case"input":qt(i),Bo(i,m,!1);break;case"textarea":qt(i),y(i);break;case"option":m.value!=null&&i.setAttribute("value",""+$e(m.value));break;case"select":i.multiple=!!m.multiple,w=m.value,w!=null?Fn(i,!!m.multiple,w,!1):m.defaultValue!=null&&Fn(i,!!m.multiple,m.defaultValue,!0);break;default:typeof b.onClick=="function"&&(i.onclick=Jc)}switch(c){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return jn(o),null;case 6:if(i&&o.stateNode!=null)Pg(i,o,i.memoizedProps,m);else{if(typeof m!="string"&&o.stateNode===null)throw Error(t(166));if(c=yo(xl.current),yo(Ci.current),nu(o)){if(m=o.stateNode,c=o.memoizedProps,m[ki]=o,(w=m.nodeValue!==c)&&(i=yr,i!==null))switch(i.tag){case 3:Kc(m.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Kc(m.nodeValue,c,(i.mode&1)!==0)}w&&(o.flags|=4)}else m=(c.nodeType===9?c:c.ownerDocument).createTextNode(m),m[ki]=o,o.stateNode=m}return jn(o),null;case 13:if(Nt(Bt),m=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(jt&&wr!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Im(),gs(),o.flags|=98560,w=!1;else if(w=nu(o),m!==null&&m.dehydrated!==null){if(i===null){if(!w)throw Error(t(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[ki]=o}else gs(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;jn(o),w=!1}else Xr!==null&&(Gh(Xr),Xr=null),w=!0;if(!w)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=c,o):(m=m!==null,m!==(i!==null&&i.memoizedState!==null)&&m&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(Bt.current&1)!==0?sn===0&&(sn=3):Zh())),o.updateQueue!==null&&(o.flags|=4),jn(o),null);case 4:return ws(),Dh(i,o),i===null&&bl(o.stateNode.containerInfo),jn(o),null;case 10:return dh(o.type._context),jn(o),null;case 17:return ar(o.type)&&Qc(),jn(o),null;case 19:if(Nt(Bt),w=o.memoizedState,w===null)return jn(o),null;if(m=(o.flags&128)!==0,P=w.rendering,P===null)if(m)Il(w,!1);else{if(sn!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(P=lu(i),P!==null){for(o.flags|=128,Il(w,!1),m=P.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),o.subtreeFlags=0,m=c,c=o.child;c!==null;)w=c,i=m,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=i,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,i=P.dependencies,w.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return Ot(Bt,Bt.current&1|2),o.child}i=i.sibling}w.tail!==null&&Ft()>Ts&&(o.flags|=128,m=!0,Il(w,!1),o.lanes=4194304)}else{if(!m)if(i=lu(P),i!==null){if(o.flags|=128,m=!0,c=i.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),Il(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!jt)return jn(o),null}else 2*Ft()-w.renderingStartTime>Ts&&c!==1073741824&&(o.flags|=128,m=!0,Il(w,!1),o.lanes=4194304);w.isBackwards?(P.sibling=o.child,o.child=P):(c=w.last,c!==null?c.sibling=P:o.child=P,w.last=P)}return w.tail!==null?(o=w.tail,w.rendering=o,w.tail=o.sibling,w.renderingStartTime=Ft(),o.sibling=null,c=Bt.current,Ot(Bt,m?c&1|2:c&1),o):(jn(o),null);case 22:case 23:return Jh(),m=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==m&&(o.flags|=8192),m&&(o.mode&1)!==0?(kr&1073741824)!==0&&(jn(o),o.subtreeFlags&6&&(o.flags|=8192)):jn(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function ik(i,o){switch(ah(o),o.tag){case 1:return ar(o.type)&&Qc(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return ws(),Nt(ir),Nt(Ln),bh(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return gh(o),null;case 13:if(Nt(Bt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));gs()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Nt(Bt),null;case 4:return ws(),null;case 10:return dh(o.type._context),null;case 22:case 23:return Jh(),null;case 24:return null;default:return null}}var vu=!1,Dn=!1,ak=typeof WeakSet=="function"?WeakSet:Set,Be=null;function Cs(i,o){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(m){Ht(i,o,m)}else c.current=null}function _g(i,o,c){try{c()}catch(m){Ht(i,o,m)}}var Rg=!1;function ok(i,o){if(Zd=gr,i=vl(),d(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var b=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var P=0,j=-1,W=-1,le=0,we=0,Ce=i,ye=null;t:for(;;){for(var je;Ce!==c||b!==0&&Ce.nodeType!==3||(j=P+b),Ce!==w||m!==0&&Ce.nodeType!==3||(W=P+m),Ce.nodeType===3&&(P+=Ce.nodeValue.length),(je=Ce.firstChild)!==null;)ye=Ce,Ce=je;for(;;){if(Ce===i)break t;if(ye===c&&++le===b&&(j=P),ye===w&&++we===m&&(W=P),(je=Ce.nextSibling)!==null)break;Ce=ye,ye=Ce.parentNode}Ce=je}c=j===-1||W===-1?null:{start:j,end:W}}else c=null}c=c||{start:0,end:0}}else c=null;for(Qd={focusedElem:i,selectionRange:c},gr=!1,Be=o;Be!==null;)if(o=Be,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Be=i;else for(;Be!==null;){o=Be;try{var We=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(We!==null){var ze=We.memoizedProps,Yt=We.memoizedState,te=o.stateNode,q=te.getSnapshotBeforeUpdate(o.elementType===o.type?ze:ei(o.type,ze),Yt);te.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var ie=o.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ee){Ht(o,o.return,Ee)}if(i=o.sibling,i!==null){i.return=o.return,Be=i;break}Be=o.return}return We=Rg,Rg=!1,We}function Ol(i,o,c){var m=o.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var b=m=m.next;do{if((b.tag&i)===i){var w=b.destroy;b.destroy=void 0,w!==void 0&&_g(o,c,w)}b=b.next}while(b!==m)}}function bu(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&i)===i){var m=c.create;c.destroy=m()}c=c.next}while(c!==o)}}function Uh(i){var o=i.ref;if(o!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof o=="function"?o(i):o.current=i}}function Ig(i){var o=i.alternate;o!==null&&(i.alternate=null,Ig(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[ki],delete o[wl],delete o[th],delete o[Ww],delete o[zw])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Og(i){return i.tag===5||i.tag===3||i.tag===4}function Ag(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Og(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Fh(i,o,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(i,o):c.insertBefore(i,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(i,c)):(o=c,o.appendChild(i)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Jc));else if(m!==4&&(i=i.child,i!==null))for(Fh(i,o,c),i=i.sibling;i!==null;)Fh(i,o,c),i=i.sibling}function Bh(i,o,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(m!==4&&(i=i.child,i!==null))for(Bh(i,o,c),i=i.sibling;i!==null;)Bh(i,o,c),i=i.sibling}var Sn=null,ti=!1;function Sa(i,o,c){for(c=c.child;c!==null;)Mg(i,o,c),c=c.sibling}function Mg(i,o,c){if(Rn&&typeof Rn.onCommitFiberUnmount=="function")try{Rn.onCommitFiberUnmount(Pr,c)}catch{}switch(c.tag){case 5:Dn||Cs(c,o);case 6:var m=Sn,b=ti;Sn=null,Sa(i,o,c),Sn=m,ti=b,Sn!==null&&(ti?(i=Sn,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):Sn.removeChild(c.stateNode));break;case 18:Sn!==null&&(ti?(i=Sn,c=c.stateNode,i.nodeType===8?eh(i.parentNode,c):i.nodeType===1&&eh(i,c),On(i)):eh(Sn,c.stateNode));break;case 4:m=Sn,b=ti,Sn=c.stateNode.containerInfo,ti=!0,Sa(i,o,c),Sn=m,ti=b;break;case 0:case 11:case 14:case 15:if(!Dn&&(m=c.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){b=m=m.next;do{var w=b,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&_g(c,o,P),b=b.next}while(b!==m)}Sa(i,o,c);break;case 1:if(!Dn&&(Cs(c,o),m=c.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=c.memoizedProps,m.state=c.memoizedState,m.componentWillUnmount()}catch(j){Ht(c,o,j)}Sa(i,o,c);break;case 21:Sa(i,o,c);break;case 22:c.mode&1?(Dn=(m=Dn)||c.memoizedState!==null,Sa(i,o,c),Dn=m):Sa(i,o,c);break;default:Sa(i,o,c)}}function Lg(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new ak),o.forEach(function(m){var b=mk.bind(null,i,m);c.has(m)||(c.add(m),m.then(b,b))})}}function ni(i,o){var c=o.deletions;if(c!==null)for(var m=0;m<c.length;m++){var b=c[m];try{var w=i,P=o,j=P;e:for(;j!==null;){switch(j.tag){case 5:Sn=j.stateNode,ti=!1;break e;case 3:Sn=j.stateNode.containerInfo,ti=!0;break e;case 4:Sn=j.stateNode.containerInfo,ti=!0;break e}j=j.return}if(Sn===null)throw Error(t(160));Mg(w,P,b),Sn=null,ti=!1;var W=b.alternate;W!==null&&(W.return=null),b.return=null}catch(le){Ht(b,o,le)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Ng(o,i),o=o.sibling}function Ng(i,o){var c=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ni(o,i),Ti(i),m&4){try{Ol(3,i,i.return),bu(3,i)}catch(ze){Ht(i,i.return,ze)}try{Ol(5,i,i.return)}catch(ze){Ht(i,i.return,ze)}}break;case 1:ni(o,i),Ti(i),m&512&&c!==null&&Cs(c,c.return);break;case 5:if(ni(o,i),Ti(i),m&512&&c!==null&&Cs(c,c.return),i.flags&32){var b=i.stateNode;try{be(b,"")}catch(ze){Ht(i,i.return,ze)}}if(m&4&&(b=i.stateNode,b!=null)){var w=i.memoizedProps,P=c!==null?c.memoizedProps:w,j=i.type,W=i.updateQueue;if(i.updateQueue=null,W!==null)try{j==="input"&&w.type==="radio"&&w.name!=null&&sa(b,w),xt(j,P);var le=xt(j,w);for(P=0;P<W.length;P+=2){var we=W[P],Ce=W[P+1];we==="style"?st(b,Ce):we==="dangerouslySetInnerHTML"?de(b,Ce):we==="children"?be(b,Ce):F(b,we,Ce,le)}switch(j){case"input":Li(b,w);break;case"textarea":_(b,w);break;case"select":var ye=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!w.multiple;var je=w.value;je!=null?Fn(b,!!w.multiple,je,!1):ye!==!!w.multiple&&(w.defaultValue!=null?Fn(b,!!w.multiple,w.defaultValue,!0):Fn(b,!!w.multiple,w.multiple?[]:"",!1))}b[wl]=w}catch(ze){Ht(i,i.return,ze)}}break;case 6:if(ni(o,i),Ti(i),m&4){if(i.stateNode===null)throw Error(t(162));b=i.stateNode,w=i.memoizedProps;try{b.nodeValue=w}catch(ze){Ht(i,i.return,ze)}}break;case 3:if(ni(o,i),Ti(i),m&4&&c!==null&&c.memoizedState.isDehydrated)try{On(o.containerInfo)}catch(ze){Ht(i,i.return,ze)}break;case 4:ni(o,i),Ti(i);break;case 13:ni(o,i),Ti(i),b=i.child,b.flags&8192&&(w=b.memoizedState!==null,b.stateNode.isHidden=w,!w||b.alternate!==null&&b.alternate.memoizedState!==null||(zh=Ft())),m&4&&Lg(i);break;case 22:if(we=c!==null&&c.memoizedState!==null,i.mode&1?(Dn=(le=Dn)||we,ni(o,i),Dn=le):ni(o,i),Ti(i),m&8192){if(le=i.memoizedState!==null,(i.stateNode.isHidden=le)&&!we&&(i.mode&1)!==0)for(Be=i,we=i.child;we!==null;){for(Ce=Be=we;Be!==null;){switch(ye=Be,je=ye.child,ye.tag){case 0:case 11:case 14:case 15:Ol(4,ye,ye.return);break;case 1:Cs(ye,ye.return);var We=ye.stateNode;if(typeof We.componentWillUnmount=="function"){m=ye,c=ye.return;try{o=m,We.props=o.memoizedProps,We.state=o.memoizedState,We.componentWillUnmount()}catch(ze){Ht(m,c,ze)}}break;case 5:Cs(ye,ye.return);break;case 22:if(ye.memoizedState!==null){Ug(Ce);continue}}je!==null?(je.return=ye,Be=je):Ug(Ce)}we=we.sibling}e:for(we=null,Ce=i;;){if(Ce.tag===5){if(we===null){we=Ce;try{b=Ce.stateNode,le?(w=b.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(j=Ce.stateNode,W=Ce.memoizedProps.style,P=W!=null&&W.hasOwnProperty("display")?W.display:null,j.style.display=Le("display",P))}catch(ze){Ht(i,i.return,ze)}}}else if(Ce.tag===6){if(we===null)try{Ce.stateNode.nodeValue=le?"":Ce.memoizedProps}catch(ze){Ht(i,i.return,ze)}}else if((Ce.tag!==22&&Ce.tag!==23||Ce.memoizedState===null||Ce===i)&&Ce.child!==null){Ce.child.return=Ce,Ce=Ce.child;continue}if(Ce===i)break e;for(;Ce.sibling===null;){if(Ce.return===null||Ce.return===i)break e;we===Ce&&(we=null),Ce=Ce.return}we===Ce&&(we=null),Ce.sibling.return=Ce.return,Ce=Ce.sibling}}break;case 19:ni(o,i),Ti(i),m&4&&Lg(i);break;case 21:break;default:ni(o,i),Ti(i)}}function Ti(i){var o=i.flags;if(o&2){try{e:{for(var c=i.return;c!==null;){if(Og(c)){var m=c;break e}c=c.return}throw Error(t(160))}switch(m.tag){case 5:var b=m.stateNode;m.flags&32&&(be(b,""),m.flags&=-33);var w=Ag(i);Bh(i,w,b);break;case 3:case 4:var P=m.stateNode.containerInfo,j=Ag(i);Fh(i,j,P);break;default:throw Error(t(161))}}catch(W){Ht(i,i.return,W)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function sk(i,o,c){Be=i,jg(i)}function jg(i,o,c){for(var m=(i.mode&1)!==0;Be!==null;){var b=Be,w=b.child;if(b.tag===22&&m){var P=b.memoizedState!==null||vu;if(!P){var j=b.alternate,W=j!==null&&j.memoizedState!==null||Dn;j=vu;var le=Dn;if(vu=P,(Dn=W)&&!le)for(Be=b;Be!==null;)P=Be,W=P.child,P.tag===22&&P.memoizedState!==null?Fg(b):W!==null?(W.return=P,Be=W):Fg(b);for(;w!==null;)Be=w,jg(w),w=w.sibling;Be=b,vu=j,Dn=le}Dg(i)}else(b.subtreeFlags&8772)!==0&&w!==null?(w.return=b,Be=w):Dg(i)}}function Dg(i){for(;Be!==null;){var o=Be;if((o.flags&8772)!==0){var c=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Dn||bu(5,o);break;case 1:var m=o.stateNode;if(o.flags&4&&!Dn)if(c===null)m.componentDidMount();else{var b=o.elementType===o.type?c.memoizedProps:ei(o.type,c.memoizedProps);m.componentDidUpdate(b,c.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=o.updateQueue;w!==null&&Dm(o,w,m);break;case 3:var P=o.updateQueue;if(P!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}Dm(o,P,c)}break;case 5:var j=o.stateNode;if(c===null&&o.flags&4){c=j;var W=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":W.autoFocus&&c.focus();break;case"img":W.src&&(c.src=W.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var le=o.alternate;if(le!==null){var we=le.memoizedState;if(we!==null){var Ce=we.dehydrated;Ce!==null&&On(Ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Dn||o.flags&512&&Uh(o)}catch(ye){Ht(o,o.return,ye)}}if(o===i){Be=null;break}if(c=o.sibling,c!==null){c.return=o.return,Be=c;break}Be=o.return}}function Ug(i){for(;Be!==null;){var o=Be;if(o===i){Be=null;break}var c=o.sibling;if(c!==null){c.return=o.return,Be=c;break}Be=o.return}}function Fg(i){for(;Be!==null;){var o=Be;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{bu(4,o)}catch(W){Ht(o,c,W)}break;case 1:var m=o.stateNode;if(typeof m.componentDidMount=="function"){var b=o.return;try{m.componentDidMount()}catch(W){Ht(o,b,W)}}var w=o.return;try{Uh(o)}catch(W){Ht(o,w,W)}break;case 5:var P=o.return;try{Uh(o)}catch(W){Ht(o,P,W)}}}catch(W){Ht(o,o.return,W)}if(o===i){Be=null;break}var j=o.sibling;if(j!==null){j.return=o.return,Be=j;break}Be=o.return}}var lk=Math.ceil,yu=A.ReactCurrentDispatcher,Vh=A.ReactCurrentOwner,jr=A.ReactCurrentBatchConfig,bt=0,fn=null,tn=null,Tn=0,kr=0,Ss=ba(0),sn=0,Al=null,ko=0,wu=0,Wh=0,Ml=null,sr=null,zh=0,Ts=1/0,Zi=null,ku=!1,qh=null,Ta=null,Cu=!1,xa=null,Su=0,Ll=0,$h=null,Tu=-1,xu=0;function qn(){return(bt&6)!==0?Ft():Tu!==-1?Tu:Tu=Ft()}function Ea(i){return(i.mode&1)===0?1:(bt&2)!==0&&Tn!==0?Tn&-Tn:$w.transition!==null?(xu===0&&(xu=Ys()),xu):(i=gt,i!==0||(i=window.event,i=i===void 0?16:Oc(i.type)),i)}function ri(i,o,c,m){if(50<Ll)throw Ll=0,$h=null,Error(t(185));Et(i,c,m),((bt&2)===0||i!==fn)&&(i===fn&&((bt&2)===0&&(wu|=c),sn===4&&Pa(i,Tn)),lr(i,m),c===1&&bt===0&&(o.mode&1)===0&&(Ts=Ft()+500,Xc&&wa()))}function lr(i,o){var c=i.callbackNode;Rr(i,o);var m=nt(i,i===fn?Tn:0);if(m===0)c!==null&&tr(c),i.callbackNode=null,i.callbackPriority=0;else if(o=m&-m,i.callbackPriority!==o){if(c!=null&&tr(c),o===1)i.tag===0?qw(Vg.bind(null,i)):xm(Vg.bind(null,i)),Bw(function(){(bt&6)===0&&wa()}),c=null;else{switch(Ir(m)){case 1:c=Go;break;case 4:c=Qs;break;case 16:c=Ha;break;case 536870912:c=Ko;break;default:c=Ha}c=Jg(c,Bg.bind(null,i))}i.callbackPriority=o,i.callbackNode=c}}function Bg(i,o){if(Tu=-1,xu=0,(bt&6)!==0)throw Error(t(327));var c=i.callbackNode;if(xs()&&i.callbackNode!==c)return null;var m=nt(i,i===fn?Tn:0);if(m===0)return null;if((m&30)!==0||(m&i.expiredLanes)!==0||o)o=Eu(i,m);else{o=m;var b=bt;bt|=2;var w=zg();(fn!==i||Tn!==o)&&(Zi=null,Ts=Ft()+500,So(i,o));do try{dk();break}catch(j){Wg(i,j)}while(!0);uh(),yu.current=w,bt=b,tn!==null?o=0:(fn=null,Tn=0,o=sn)}if(o!==0){if(o===2&&(b=Qo(i),b!==0&&(m=b,o=Hh(i,b))),o===1)throw c=Al,So(i,0),Pa(i,m),lr(i,Ft()),c;if(o===6)Pa(i,m);else{if(b=i.current.alternate,(m&30)===0&&!ck(b)&&(o=Eu(i,m),o===2&&(w=Qo(i),w!==0&&(m=w,o=Hh(i,w))),o===1))throw c=Al,So(i,0),Pa(i,m),lr(i,Ft()),c;switch(i.finishedWork=b,i.finishedLanes=m,o){case 0:case 1:throw Error(t(345));case 2:To(i,sr,Zi);break;case 3:if(Pa(i,m),(m&130023424)===m&&(o=zh+500-Ft(),10<o)){if(nt(i,0)!==0)break;if(b=i.suspendedLanes,(b&m)!==m){qn(),i.pingedLanes|=i.suspendedLanes&b;break}i.timeoutHandle=Xd(To.bind(null,i,sr,Zi),o);break}To(i,sr,Zi);break;case 4:if(Pa(i,m),(m&4194240)===m)break;for(o=i.eventTimes,b=-1;0<m;){var P=31-kn(m);w=1<<P,P=o[P],P>b&&(b=P),m&=~w}if(m=b,m=Ft()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*lk(m/1960))-m,10<m){i.timeoutHandle=Xd(To.bind(null,i,sr,Zi),m);break}To(i,sr,Zi);break;case 5:To(i,sr,Zi);break;default:throw Error(t(329))}}}return lr(i,Ft()),i.callbackNode===c?Bg.bind(null,i):null}function Hh(i,o){var c=Ml;return i.current.memoizedState.isDehydrated&&(So(i,o).flags|=256),i=Eu(i,o),i!==2&&(o=sr,sr=c,o!==null&&Gh(o)),i}function Gh(i){sr===null?sr=i:sr.push.apply(sr,i)}function ck(i){for(var o=i;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var m=0;m<c.length;m++){var b=c[m],w=b.getSnapshot;b=b.value;try{if(!rr(w(),b))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Pa(i,o){for(o&=~Wh,o&=~wu,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var c=31-kn(o),m=1<<c;i[c]=-1,o&=~m}}function Vg(i){if((bt&6)!==0)throw Error(t(327));xs();var o=nt(i,0);if((o&1)===0)return lr(i,Ft()),null;var c=Eu(i,o);if(i.tag!==0&&c===2){var m=Qo(i);m!==0&&(o=m,c=Hh(i,m))}if(c===1)throw c=Al,So(i,0),Pa(i,o),lr(i,Ft()),c;if(c===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,To(i,sr,Zi),lr(i,Ft()),null}function Kh(i,o){var c=bt;bt|=1;try{return i(o)}finally{bt=c,bt===0&&(Ts=Ft()+500,Xc&&wa())}}function Co(i){xa!==null&&xa.tag===0&&(bt&6)===0&&xs();var o=bt;bt|=1;var c=jr.transition,m=gt;try{if(jr.transition=null,gt=1,i)return i()}finally{gt=m,jr.transition=c,bt=o,(bt&6)===0&&wa()}}function Jh(){kr=Ss.current,Nt(Ss)}function So(i,o){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,Fw(c)),tn!==null)for(c=tn.return;c!==null;){var m=c;switch(ah(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Qc();break;case 3:ws(),Nt(ir),Nt(Ln),bh();break;case 5:gh(m);break;case 4:ws();break;case 13:Nt(Bt);break;case 19:Nt(Bt);break;case 10:dh(m.type._context);break;case 22:case 23:Jh()}c=c.return}if(fn=i,tn=i=_a(i.current,null),Tn=kr=o,sn=0,Al=null,Wh=wu=ko=0,sr=Ml=null,bo!==null){for(o=0;o<bo.length;o++)if(c=bo[o],m=c.interleaved,m!==null){c.interleaved=null;var b=m.next,w=c.pending;if(w!==null){var P=w.next;w.next=b,m.next=P}c.pending=m}bo=null}return i}function Wg(i,o){do{var c=tn;try{if(uh(),cu.current=pu,uu){for(var m=Vt.memoizedState;m!==null;){var b=m.queue;b!==null&&(b.pending=null),m=m.next}uu=!1}if(wo=0,pn=on=Vt=null,El=!1,Pl=0,Vh.current=null,c===null||c.return===null){sn=1,Al=o,tn=null;break}e:{var w=i,P=c.return,j=c,W=o;if(o=Tn,j.flags|=32768,W!==null&&typeof W=="object"&&typeof W.then=="function"){var le=W,we=j,Ce=we.tag;if((we.mode&1)===0&&(Ce===0||Ce===11||Ce===15)){var ye=we.alternate;ye?(we.updateQueue=ye.updateQueue,we.memoizedState=ye.memoizedState,we.lanes=ye.lanes):(we.updateQueue=null,we.memoizedState=null)}var je=hg(P);if(je!==null){je.flags&=-257,pg(je,P,j,w,o),je.mode&1&&dg(w,le,o),o=je,W=le;var We=o.updateQueue;if(We===null){var ze=new Set;ze.add(W),o.updateQueue=ze}else We.add(W);break e}else{if((o&1)===0){dg(w,le,o),Zh();break e}W=Error(t(426))}}else if(jt&&j.mode&1){var Yt=hg(P);if(Yt!==null){(Yt.flags&65536)===0&&(Yt.flags|=256),pg(Yt,P,j,w,o),lh(ks(W,j));break e}}w=W=ks(W,j),sn!==4&&(sn=2),Ml===null?Ml=[w]:Ml.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,o&=-o,w.lanes|=o;var te=cg(w,W,o);jm(w,te);break e;case 1:j=W;var q=w.type,ie=w.stateNode;if((w.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Ta===null||!Ta.has(ie)))){w.flags|=65536,o&=-o,w.lanes|=o;var Ee=ug(w,j,o);jm(w,Ee);break e}}w=w.return}while(w!==null)}$g(c)}catch(Ge){o=Ge,tn===c&&c!==null&&(tn=c=c.return);continue}break}while(!0)}function zg(){var i=yu.current;return yu.current=pu,i===null?pu:i}function Zh(){(sn===0||sn===3||sn===2)&&(sn=4),fn===null||(ko&268435455)===0&&(wu&268435455)===0||Pa(fn,Tn)}function Eu(i,o){var c=bt;bt|=2;var m=zg();(fn!==i||Tn!==o)&&(Zi=null,So(i,o));do try{uk();break}catch(b){Wg(i,b)}while(!0);if(uh(),bt=c,yu.current=m,tn!==null)throw Error(t(261));return fn=null,Tn=0,sn}function uk(){for(;tn!==null;)qg(tn)}function dk(){for(;tn!==null&&!$o();)qg(tn)}function qg(i){var o=Kg(i.alternate,i,kr);i.memoizedProps=i.pendingProps,o===null?$g(i):tn=o,Vh.current=null}function $g(i){var o=i;do{var c=o.alternate;if(i=o.return,(o.flags&32768)===0){if(c=rk(c,o,kr),c!==null){tn=c;return}}else{if(c=ik(c,o),c!==null){c.flags&=32767,tn=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{sn=6,tn=null;return}}if(o=o.sibling,o!==null){tn=o;return}tn=o=i}while(o!==null);sn===0&&(sn=5)}function To(i,o,c){var m=gt,b=jr.transition;try{jr.transition=null,gt=1,hk(i,o,c,m)}finally{jr.transition=b,gt=m}return null}function hk(i,o,c,m){do xs();while(xa!==null);if((bt&6)!==0)throw Error(t(327));c=i.finishedWork;var b=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var w=c.lanes|c.childLanes;if(Ja(i,w),i===fn&&(tn=fn=null,Tn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||Cu||(Cu=!0,Jg(Ha,function(){return xs(),null})),w=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||w){w=jr.transition,jr.transition=null;var P=gt;gt=1;var j=bt;bt|=4,Vh.current=null,ok(i,c),Ng(c,i),p(Qd),gr=!!Zd,Qd=Zd=null,i.current=c,sk(c),Zs(),bt=j,gt=P,jr.transition=w}else i.current=c;if(Cu&&(Cu=!1,xa=i,Su=b),w=i.pendingLanes,w===0&&(Ta=null),Jo(c.stateNode),lr(i,Ft()),o!==null)for(m=i.onRecoverableError,c=0;c<o.length;c++)b=o[c],m(b.value,{componentStack:b.stack,digest:b.digest});if(ku)throw ku=!1,i=qh,qh=null,i;return(Su&1)!==0&&i.tag!==0&&xs(),w=i.pendingLanes,(w&1)!==0?i===$h?Ll++:(Ll=0,$h=i):Ll=0,wa(),null}function xs(){if(xa!==null){var i=Ir(Su),o=jr.transition,c=gt;try{if(jr.transition=null,gt=16>i?16:i,xa===null)var m=!1;else{if(i=xa,xa=null,Su=0,(bt&6)!==0)throw Error(t(331));var b=bt;for(bt|=4,Be=i.current;Be!==null;){var w=Be,P=w.child;if((Be.flags&16)!==0){var j=w.deletions;if(j!==null){for(var W=0;W<j.length;W++){var le=j[W];for(Be=le;Be!==null;){var we=Be;switch(we.tag){case 0:case 11:case 15:Ol(8,we,w)}var Ce=we.child;if(Ce!==null)Ce.return=we,Be=Ce;else for(;Be!==null;){we=Be;var ye=we.sibling,je=we.return;if(Ig(we),we===le){Be=null;break}if(ye!==null){ye.return=je,Be=ye;break}Be=je}}}var We=w.alternate;if(We!==null){var ze=We.child;if(ze!==null){We.child=null;do{var Yt=ze.sibling;ze.sibling=null,ze=Yt}while(ze!==null)}}Be=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,Be=P;else e:for(;Be!==null;){if(w=Be,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Ol(9,w,w.return)}var te=w.sibling;if(te!==null){te.return=w.return,Be=te;break e}Be=w.return}}var q=i.current;for(Be=q;Be!==null;){P=Be;var ie=P.child;if((P.subtreeFlags&2064)!==0&&ie!==null)ie.return=P,Be=ie;else e:for(P=q;Be!==null;){if(j=Be,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:bu(9,j)}}catch(Ge){Ht(j,j.return,Ge)}if(j===P){Be=null;break e}var Ee=j.sibling;if(Ee!==null){Ee.return=j.return,Be=Ee;break e}Be=j.return}}if(bt=b,wa(),Rn&&typeof Rn.onPostCommitFiberRoot=="function")try{Rn.onPostCommitFiberRoot(Pr,i)}catch{}m=!0}return m}finally{gt=c,jr.transition=o}}return!1}function Hg(i,o,c){o=ks(c,o),o=cg(i,o,1),i=Ca(i,o,1),o=qn(),i!==null&&(Et(i,1,o),lr(i,o))}function Ht(i,o,c){if(i.tag===3)Hg(i,i,c);else for(;o!==null;){if(o.tag===3){Hg(o,i,c);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Ta===null||!Ta.has(m))){i=ks(c,i),i=ug(o,i,1),o=Ca(o,i,1),i=qn(),o!==null&&(Et(o,1,i),lr(o,i));break}}o=o.return}}function pk(i,o,c){var m=i.pingCache;m!==null&&m.delete(o),o=qn(),i.pingedLanes|=i.suspendedLanes&c,fn===i&&(Tn&c)===c&&(sn===4||sn===3&&(Tn&130023424)===Tn&&500>Ft()-zh?So(i,0):Wh|=c),lr(i,o)}function Gg(i,o){o===0&&((i.mode&1)===0?o=1:(o=Cn,Cn<<=1,(Cn&130023424)===0&&(Cn=4194304)));var c=qn();i=Gi(i,o),i!==null&&(Et(i,o,c),lr(i,c))}function fk(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),Gg(i,c)}function mk(i,o){var c=0;switch(i.tag){case 13:var m=i.stateNode,b=i.memoizedState;b!==null&&(c=b.retryLane);break;case 19:m=i.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(o),Gg(i,c)}var Kg;Kg=function(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps||ir.current)or=!0;else{if((i.lanes&c)===0&&(o.flags&128)===0)return or=!1,nk(i,o,c);or=(i.flags&131072)!==0}else or=!1,jt&&(o.flags&1048576)!==0&&Em(o,tu,o.index);switch(o.lanes=0,o.tag){case 2:var m=o.type;gu(i,o),i=o.pendingProps;var b=ps(o,Ln.current);ys(o,c),b=kh(null,o,m,i,b,c);var w=Ch();return o.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ar(m)?(w=!0,Yc(o)):w=!1,o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,fh(o),b.updater=fu,o.stateNode=b,b._reactInternals=o,_h(o,m,i,c),o=Ah(null,o,m,!0,w,c)):(o.tag=0,jt&&w&&ih(o),zn(null,o,b,c),o=o.child),o;case 16:m=o.elementType;e:{switch(gu(i,o),i=o.pendingProps,b=m._init,m=b(m._payload),o.type=m,b=o.tag=vk(m),i=ei(m,i),b){case 0:o=Oh(null,o,m,i,c);break e;case 1:o=yg(null,o,m,i,c);break e;case 11:o=fg(null,o,m,i,c);break e;case 14:o=mg(null,o,m,ei(m.type,i),c);break e}throw Error(t(306,m,""))}return o;case 0:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),Oh(i,o,m,b,c);case 1:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),yg(i,o,m,b,c);case 3:e:{if(wg(o),i===null)throw Error(t(387));m=o.pendingProps,w=o.memoizedState,b=w.element,Nm(i,o),su(o,m,null,c);var P=o.memoizedState;if(m=P.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){b=ks(Error(t(423)),o),o=kg(i,o,m,c,b);break e}else if(m!==b){b=ks(Error(t(424)),o),o=kg(i,o,m,c,b);break e}else for(wr=va(o.stateNode.containerInfo.firstChild),yr=o,jt=!0,Xr=null,c=Mm(o,null,m,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(gs(),m===b){o=Ji(i,o,c);break e}zn(i,o,m,c)}o=o.child}return o;case 5:return Um(o),i===null&&sh(o),m=o.type,b=o.pendingProps,w=i!==null?i.memoizedProps:null,P=b.children,Yd(m,b)?P=null:w!==null&&Yd(m,w)&&(o.flags|=32),bg(i,o),zn(i,o,P,c),o.child;case 6:return i===null&&sh(o),null;case 13:return Cg(i,o,c);case 4:return mh(o,o.stateNode.containerInfo),m=o.pendingProps,i===null?o.child=vs(o,null,m,c):zn(i,o,m,c),o.child;case 11:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),fg(i,o,m,b,c);case 7:return zn(i,o,o.pendingProps,c),o.child;case 8:return zn(i,o,o.pendingProps.children,c),o.child;case 12:return zn(i,o,o.pendingProps.children,c),o.child;case 10:e:{if(m=o.type._context,b=o.pendingProps,w=o.memoizedProps,P=b.value,Ot(iu,m._currentValue),m._currentValue=P,w!==null)if(rr(w.value,P)){if(w.children===b.children&&!ir.current){o=Ji(i,o,c);break e}}else for(w=o.child,w!==null&&(w.return=o);w!==null;){var j=w.dependencies;if(j!==null){P=w.child;for(var W=j.firstContext;W!==null;){if(W.context===m){if(w.tag===1){W=Ki(-1,c&-c),W.tag=2;var le=w.updateQueue;if(le!==null){le=le.shared;var we=le.pending;we===null?W.next=W:(W.next=we.next,we.next=W),le.pending=W}}w.lanes|=c,W=w.alternate,W!==null&&(W.lanes|=c),hh(w.return,c,o),j.lanes|=c;break}W=W.next}}else if(w.tag===10)P=w.type===o.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(t(341));P.lanes|=c,j=P.alternate,j!==null&&(j.lanes|=c),hh(P,c,o),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===o){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}zn(i,o,b.children,c),o=o.child}return o;case 9:return b=o.type,m=o.pendingProps.children,ys(o,c),b=Lr(b),m=m(b),o.flags|=1,zn(i,o,m,c),o.child;case 14:return m=o.type,b=ei(m,o.pendingProps),b=ei(m.type,b),mg(i,o,m,b,c);case 15:return gg(i,o,o.type,o.pendingProps,c);case 17:return m=o.type,b=o.pendingProps,b=o.elementType===m?b:ei(m,b),gu(i,o),o.tag=1,ar(m)?(i=!0,Yc(o)):i=!1,ys(o,c),sg(o,m,b),_h(o,m,b,c),Ah(null,o,m,!0,i,c);case 19:return Tg(i,o,c);case 22:return vg(i,o,c)}throw Error(t(156,o.tag))};function Jg(i,o){return Js(i,o)}function gk(i,o,c,m){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(i,o,c,m){return new gk(i,o,c,m)}function Qh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function vk(i){if(typeof i=="function")return Qh(i)?1:0;if(i!=null){if(i=i.$$typeof,i===he)return 11;if(i===Ue)return 14}return 2}function _a(i,o){var c=i.alternate;return c===null?(c=Dr(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function Pu(i,o,c,m,b,w){var P=2;if(m=i,typeof i=="function")Qh(i)&&(P=1);else if(typeof i=="string")P=5;else e:switch(i){case oe:return xo(c.children,b,w,o);case X:P=8,b|=8;break;case H:return i=Dr(12,c,o,b|2),i.elementType=H,i.lanes=w,i;case Ae:return i=Dr(13,c,o,b),i.elementType=Ae,i.lanes=w,i;case qe:return i=Dr(19,c,o,b),i.elementType=qe,i.lanes=w,i;case Fe:return _u(c,b,w,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case J:P=10;break e;case Y:P=9;break e;case he:P=11;break e;case Ue:P=14;break e;case ot:P=16,m=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=Dr(P,c,o,b),o.elementType=i,o.type=m,o.lanes=w,o}function xo(i,o,c,m){return i=Dr(7,i,m,o),i.lanes=c,i}function _u(i,o,c,m){return i=Dr(22,i,m,o),i.elementType=Fe,i.lanes=c,i.stateNode={isHidden:!1},i}function Yh(i,o,c){return i=Dr(6,i,null,o),i.lanes=c,i}function Xh(i,o,c){return o=Dr(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function bk(i,o,c,m,b){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yo(0),this.expirationTimes=Yo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yo(0),this.identifierPrefix=m,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function ep(i,o,c,m,b,w,P,j,W){return i=new bk(i,o,c,j,W),o===1?(o=1,w===!0&&(o|=8)):o=0,w=Dr(3,null,null,o),i.current=w,w.stateNode=i,w.memoizedState={element:m,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},fh(w),i}function yk(i,o,c){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Z,key:m==null?null:""+m,children:i,containerInfo:o,implementation:c}}function Zg(i){if(!i)return ya;i=i._reactInternals;e:{if(hi(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ar(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var c=i.type;if(ar(c))return Sm(i,c,o)}return o}function Qg(i,o,c,m,b,w,P,j,W){return i=ep(c,m,!0,i,b,w,P,j,W),i.context=Zg(null),c=i.current,m=qn(),b=Ea(c),w=Ki(m,b),w.callback=o??null,Ca(c,w,b),i.current.lanes=b,Et(i,b,m),lr(i,m),i}function Ru(i,o,c,m){var b=o.current,w=qn(),P=Ea(b);return c=Zg(c),o.context===null?o.context=c:o.pendingContext=c,o=Ki(w,P),o.payload={element:i},m=m===void 0?null:m,m!==null&&(o.callback=m),i=Ca(b,o,P),i!==null&&(ri(i,b,P,w),ou(i,b,P)),P}function Iu(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Yg(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function tp(i,o){Yg(i,o),(i=i.alternate)&&Yg(i,o)}function wk(){return null}var Xg=typeof reportError=="function"?reportError:function(i){console.error(i)};function np(i){this._internalRoot=i}Ou.prototype.render=np.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));Ru(i,o,null,null)},Ou.prototype.unmount=np.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Co(function(){Ru(null,i,null,null)}),o[zi]=null}};function Ou(i){this._internalRoot=i}Ou.prototype.unstable_scheduleHydration=function(i){if(i){var o=ca();i={blockedOn:null,target:i,priority:o};for(var c=0;c<mr.length&&o!==0&&o<mr[c].priority;c++);mr.splice(c,0,i),c===0&&Di(i)}};function rp(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Au(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function ev(){}function kk(i,o,c,m,b){if(b){if(typeof m=="function"){var w=m;m=function(){var le=Iu(P);w.call(le)}}var P=Qg(o,m,i,0,null,!1,!1,"",ev);return i._reactRootContainer=P,i[zi]=P.current,bl(i.nodeType===8?i.parentNode:i),Co(),P}for(;b=i.lastChild;)i.removeChild(b);if(typeof m=="function"){var j=m;m=function(){var le=Iu(W);j.call(le)}}var W=ep(i,0,!1,null,null,!1,!1,"",ev);return i._reactRootContainer=W,i[zi]=W.current,bl(i.nodeType===8?i.parentNode:i),Co(function(){Ru(o,W,c,m)}),W}function Mu(i,o,c,m,b){var w=c._reactRootContainer;if(w){var P=w;if(typeof b=="function"){var j=b;b=function(){var W=Iu(P);j.call(W)}}Ru(o,P,i,b)}else P=kk(c,o,i,b,m);return Iu(P)}Xo=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var c=_r(o.pendingLanes);c!==0&&(Za(o,c|1),lr(o,Ft()),(bt&6)===0&&(Ts=Ft()+500,wa()))}break;case 13:Co(function(){var m=Gi(i,1);if(m!==null){var b=qn();ri(m,i,1,b)}}),tp(i,1)}},Gr=function(i){if(i.tag===13){var o=Gi(i,134217728);if(o!==null){var c=qn();ri(o,i,134217728,c)}tp(i,134217728)}},Xs=function(i){if(i.tag===13){var o=Ea(i),c=Gi(i,o);if(c!==null){var m=qn();ri(c,i,o,m)}tp(i,o)}},ca=function(){return gt},Qa=function(i,o){var c=gt;try{return gt=i,o()}finally{gt=c}},wn=function(i,o,c){switch(o){case"input":if(Li(i,c),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var m=c[o];if(m!==i&&m.form===i.form){var b=Zc(m);if(!b)throw Error(t(90));er(m),Li(m,b)}}}break;case"textarea":_(i,c);break;case"select":o=c.value,o!=null&&Fn(i,!!c.multiple,o,!1)}},Vn=Kh,ht=Co;var Ck={usingClientEntryPoint:!1,Events:[kl,ds,Zc,Xe,Er,Kh]},Nl={findFiberByHostInstance:fo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sk={bundleType:Nl.bundleType,version:Nl.version,rendererPackageName:Nl.rendererPackageName,rendererConfig:Nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Rc(i),i===null?null:i.stateNode},findFiberByHostInstance:Nl.findFiberByHostInstance||wk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lu.isDisabled&&Lu.supportsFiber)try{Pr=Lu.inject(Sk),Rn=Lu}catch{}}return cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ck,cr.createPortal=function(i,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rp(o))throw Error(t(200));return yk(i,o,null,c)},cr.createRoot=function(i,o){if(!rp(i))throw Error(t(299));var c=!1,m="",b=Xg;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=ep(i,1,!1,null,null,c,!1,m,b),i[zi]=o.current,bl(i.nodeType===8?i.parentNode:i),new np(o)},cr.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Rc(o),i=i===null?null:i.stateNode,i},cr.flushSync=function(i){return Co(i)},cr.hydrate=function(i,o,c){if(!Au(o))throw Error(t(200));return Mu(null,i,o,!0,c)},cr.hydrateRoot=function(i,o,c){if(!rp(i))throw Error(t(405));var m=c!=null&&c.hydratedSources||null,b=!1,w="",P=Xg;if(c!=null&&(c.unstable_strictMode===!0&&(b=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onRecoverableError!==void 0&&(P=c.onRecoverableError)),o=Qg(o,null,i,1,c??null,b,!1,w,P),i[zi]=o.current,bl(i),m)for(i=0;i<m.length;i++)c=m[i],b=c._getVersion,b=b(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,b]:o.mutableSourceEagerHydrationData.push(c,b);return new Ou(o)},cr.render=function(i,o,c){if(!Au(o))throw Error(t(200));return Mu(null,i,o,!1,c)},cr.unmountComponentAtNode=function(i){if(!Au(i))throw Error(t(40));return i._reactRootContainer?(Co(function(){Mu(null,null,i,!1,function(){i._reactRootContainer=null,i[zi]=null})}),!0):!1},cr.unstable_batchedUpdates=Kh,cr.unstable_renderSubtreeIntoContainer=function(i,o,c,m){if(!Au(c))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return Mu(i,o,c,!1,m)},cr.version="18.3.1-next-f1338f8080-20240426",cr}var fv;function Mk(){if(fv)return ip.exports;fv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ip.exports=Ak(),ip.exports}var mv;function Lk(){if(mv)return Nu;mv=1;var n=Mk();return Nu.createRoot=n.createRoot,Nu.hydrateRoot=n.hydrateRoot,Nu}var Nk=Lk(),Ey=function(n,e,t,r){var a;e[0]=0;for(var s=1;s<e.length;s++){var l=e[s++],u=e[s]?(e[0]|=l?1:2,t[e[s++]]):e[++s];l===3?r[0]=u:l===4?r[1]=Object.assign(r[1]||{},u):l===5?(r[1]=r[1]||{})[e[++s]]=u:l===6?r[1][e[++s]]+=u+"":l?(a=n.apply(u,Ey(n,u,t,["",null])),r.push(a),u[0]?e[0]|=2:(e[s-2]=0,e[s]=a)):r.push(u)}return r},gv=new Map;function jk(n){var e=gv.get(this);return e||(e=new Map,gv.set(this,e)),(e=Ey(this,e.get(n)||(e.set(n,e=function(t){for(var r,a,s=1,l="",u="",h=[0],f=function(x){s===1&&(x||(l=l.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?h.push(0,x,l):s===3&&(x||l)?(h.push(3,x,l),s=2):s===2&&l==="..."&&x?h.push(4,x,0):s===2&&l&&!x?h.push(5,0,!0,l):s>=5&&((l||!x&&s===5)&&(h.push(s,0,l,a),s=6),x&&(h.push(s,x,0,a),s=6)),l=""},v=0;v<t.length;v++){v&&(s===1&&f(),f(v));for(var C=0;C<t[v].length;C++)r=t[v][C],s===1?r==="<"?(f(),h=[h],s=3):l+=r:s===4?l==="--"&&r===">"?(s=1,l=""):l=r+l[0]:u?r===u?u="":l+=r:r==='"'||r==="'"?u=r:r===">"?(f(),s=1):s&&(r==="="?(s=5,a=l,l=""):r==="/"&&(s<5||t[v][C+1]===">")?(f(),s===3&&(h=h[0]),s=h,(h=h[0]).push(2,0,s),s=0):r===" "||r==="	"||r===`
`||r==="\r"?(f(),s=2):l+=r),s===3&&l==="!--"&&(s=4,h=h[0])}return f(),h}(n)),e),arguments,[])).length>1?e:e[0]}function Is(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function Ns(n){return function e(t){return arguments.length===0||Is(t)?e:n.apply(this,arguments)}}function Sf(n){return function e(t,r){switch(arguments.length){case 0:return e;case 1:return Is(t)?e:Ns(function(a){return n(t,a)});default:return Is(t)&&Is(r)?e:Is(t)?Ns(function(a){return n(a,r)}):Is(r)?Ns(function(a){return n(t,a)}):n(t,r)}}}const Dk=Array.isArray||function(n){return n!=null&&n.length>=0&&Object.prototype.toString.call(n)==="[object Array]"};function Uk(n){return n!=null&&typeof n["@@transducer/step"]=="function"}function Py(n,e,t){return function(){if(arguments.length===0)return t();var r=arguments[arguments.length-1];if(!Dk(r)){for(var a=0;a<n.length;){if(typeof r[n[a]]=="function")return r[n[a]].apply(r,Array.prototype.slice.call(arguments,0,-1));a+=1}if(Uk(r)){var s=e.apply(null,Array.prototype.slice.call(arguments,0,-1));return s(r)}}return t.apply(this,arguments)}}const _p={init:function(){return this.xf["@@transducer/init"]()},result:function(n){return this.xf["@@transducer/result"](n)}};function vv(n){for(var e=[],t;!(t=n.next()).done;)e.push(t.value);return e}function bv(n,e,t){for(var r=0,a=t.length;r<a;){if(n(e,t[r]))return!0;r+=1}return!1}function Fk(n){var e=String(n).match(/^function (\w*)/);return e==null?"":e[1]}function sd(n,e){return Object.prototype.hasOwnProperty.call(e,n)}function Bk(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}const ap=typeof Object.is=="function"?Object.is:Bk;var yv=Object.prototype.toString,Vk=function(){return yv.call(arguments)==="[object Arguments]"?function(n){return yv.call(n)==="[object Arguments]"}:function(n){return sd("callee",n)}}(),Wk=!{toString:null}.propertyIsEnumerable("toString"),wv=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],kv=function(){return arguments.propertyIsEnumerable("length")}(),zk=function(n,e){for(var t=0;t<n.length;){if(n[t]===e)return!0;t+=1}return!1},Cv=Ns(typeof Object.keys=="function"&&!kv?function(n){return Object(n)!==n?[]:Object.keys(n)}:function(n){if(Object(n)!==n)return[];var e,t,r=[],a=kv&&Vk(n);for(e in n)sd(e,n)&&(!a||e!=="length")&&(r[r.length]=e);if(Wk)for(t=wv.length-1;t>=0;)e=wv[t],sd(e,n)&&!zk(r,e)&&(r[r.length]=e),t-=1;return r}),Sv=Ns(function(n){return n===null?"Null":n===void 0?"Undefined":Object.prototype.toString.call(n).slice(8,-1)});function Tv(n,e,t,r){var a=vv(n),s=vv(e);function l(u,h){return Tf(u,h,t.slice(),r.slice())}return!bv(function(u,h){return!bv(l,h,u)},s,a)}function Tf(n,e,t,r){if(ap(n,e))return!0;var a=Sv(n);if(a!==Sv(e))return!1;if(typeof n["fantasy-land/equals"]=="function"||typeof e["fantasy-land/equals"]=="function")return typeof n["fantasy-land/equals"]=="function"&&n["fantasy-land/equals"](e)&&typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](n);if(typeof n.equals=="function"||typeof e.equals=="function")return typeof n.equals=="function"&&n.equals(e)&&typeof e.equals=="function"&&e.equals(n);switch(a){case"Arguments":case"Array":case"Object":if(typeof n.constructor=="function"&&Fk(n.constructor)==="Promise")return n===e;break;case"Boolean":case"Number":case"String":if(!(typeof n==typeof e&&ap(n.valueOf(),e.valueOf())))return!1;break;case"Date":if(!ap(n.valueOf(),e.valueOf()))return!1;break;case"Error":return n.name===e.name&&n.message===e.message;case"RegExp":if(!(n.source===e.source&&n.global===e.global&&n.ignoreCase===e.ignoreCase&&n.multiline===e.multiline&&n.sticky===e.sticky&&n.unicode===e.unicode))return!1;break}for(var s=t.length-1;s>=0;){if(t[s]===n)return r[s]===e;s-=1}switch(a){case"Map":return n.size!==e.size?!1:Tv(n.entries(),e.entries(),t.concat([n]),r.concat([e]));case"Set":return n.size!==e.size?!1:Tv(n.values(),e.values(),t.concat([n]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var l=Cv(n);if(l.length!==Cv(e).length)return!1;var u=t.concat([n]),h=r.concat([e]);for(s=l.length-1;s>=0;){var f=l[s];if(!(sd(f,e)&&Tf(e[f],n[f],u,h)))return!1;s-=1}return!0}var xf=Sf(function(n,e){return Tf(n,e,[],[])});function qk(n,e,t){var r,a;if(typeof n.indexOf=="function")switch(typeof e){case"number":if(e===0){for(r=1/e;t<n.length;){if(a=n[t],a===0&&1/a===r)return t;t+=1}return-1}else if(e!==e){for(;t<n.length;){if(a=n[t],typeof a=="number"&&a!==a)return t;t+=1}return-1}return n.indexOf(e,t);case"string":case"boolean":case"function":case"undefined":return n.indexOf(e,t);case"object":if(e===null)return n.indexOf(e,t)}for(;t<n.length;){if(xf(n[t],e))return t;t+=1}return-1}function xv(n,e){return qk(e,n,0)>=0}function $k(n){return n}var Hk=Ns($k),_y=function(){function n(){this._nativeSet=typeof Set=="function"?new Set:null,this._items={}}return n.prototype.add=function(e){return!Ev(e,!0,this)},n.prototype.has=function(e){return Ev(e,!1,this)},n}();function Ev(n,e,t){var r=typeof n,a,s;switch(r){case"string":case"number":return n===0&&1/n===-1/0?t._items["-0"]?!0:(e&&(t._items["-0"]=!0),!1):t._nativeSet!==null?e?(a=t._nativeSet.size,t._nativeSet.add(n),s=t._nativeSet.size,s===a):t._nativeSet.has(n):r in t._items?n in t._items[r]?!0:(e&&(t._items[r][n]=!0),!1):(e&&(t._items[r]={},t._items[r][n]=!0),!1);case"boolean":if(r in t._items){var l=n?1:0;return t._items[r][l]?!0:(e&&(t._items[r][l]=!0),!1)}else return e&&(t._items[r]=n?[!1,!0]:[!0,!1]),!1;case"function":return t._nativeSet!==null?e?(a=t._nativeSet.size,t._nativeSet.add(n),s=t._nativeSet.size,s===a):t._nativeSet.has(n):r in t._items?xv(n,t._items[r])?!0:(e&&t._items[r].push(n),!1):(e&&(t._items[r]=[n]),!1);case"undefined":return t._items[r]?!0:(e&&(t._items[r]=!0),!1);case"object":if(n===null)return t._items.null?!0:(e&&(t._items.null=!0),!1);default:return r=Object.prototype.toString.call(n),r in t._items?xv(n,t._items[r])?!0:(e&&t._items[r].push(n),!1):(e&&(t._items[r]=[n]),!1)}}var Gk=function(){function n(e,t){this.xf=t,this.f=e,this.idx=-1,this.lastIdx=-1}return n.prototype["@@transducer/init"]=_p.init,n.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](e,this.lastIdx))},n.prototype["@@transducer/step"]=function(e,t){return this.idx+=1,this.f(t)&&(this.lastIdx=this.idx),e},n}();function Kk(n){return function(e){return new Gk(n,e)}}var Pv=Sf(Py([],Kk,function(n,e){for(var t=e.length-1;t>=0;){if(n(e[t]))return t;t-=1}return-1})),Jk=function(){function n(e,t){this.xf=t,this.f=e,this.set=new _y}return n.prototype["@@transducer/init"]=_p.init,n.prototype["@@transducer/result"]=_p.result,n.prototype["@@transducer/step"]=function(e,t){return this.set.add(this.f(t))?this.xf["@@transducer/step"](e,t):e},n}();function Zk(n){return function(e){return new Jk(n,e)}}var Qk=Sf(Py([],Zk,function(n,e){for(var t=new _y,r=[],a=0,s,l;a<e.length;)l=e[a],s=n(l),t.add(s)&&r.push(l),a+=1;return r})),Yk=Qk(Hk);const Xk="1.2.4-alpha.8",eC={version:Xk};var En=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},Hn={searchParams:"URLSearchParams"in En,iterable:"Symbol"in En&&"iterator"in Symbol,blob:"FileReader"in En&&"Blob"in En&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in En,arrayBuffer:"ArrayBuffer"in En};function tC(n){return n&&DataView.prototype.isPrototypeOf(n)}if(Hn.arrayBuffer)var nC=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],rC=ArrayBuffer.isView||function(n){return n&&nC.indexOf(Object.prototype.toString.call(n))>-1};function $s(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(n)||n==="")throw new TypeError('Invalid character in header field name: "'+n+'"');return n.toLowerCase()}function Ef(n){return typeof n!="string"&&(n=String(n)),n}function Pf(n){var e={next:function(){var t=n.shift();return{done:t===void 0,value:t}}};return Hn.iterable&&(e[Symbol.iterator]=function(){return e}),e}function hn(n){this.map={},n instanceof hn?n.forEach(function(e,t){this.append(t,e)},this):Array.isArray(n)?n.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(e){this.append(e,n[e])},this)}hn.prototype.append=function(n,e){n=$s(n),e=Ef(e);var t=this.map[n];this.map[n]=t?t+", "+e:e};hn.prototype.delete=function(n){delete this.map[$s(n)]};hn.prototype.get=function(n){return n=$s(n),this.has(n)?this.map[n]:null};hn.prototype.has=function(n){return this.map.hasOwnProperty($s(n))};hn.prototype.set=function(n,e){this.map[$s(n)]=Ef(e)};hn.prototype.forEach=function(n,e){for(var t in this.map)this.map.hasOwnProperty(t)&&n.call(e,this.map[t],t,this)};hn.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),Pf(n)};hn.prototype.values=function(){var n=[];return this.forEach(function(e){n.push(e)}),Pf(n)};hn.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),Pf(n)};Hn.iterable&&(hn.prototype[Symbol.iterator]=hn.prototype.entries);function op(n){if(!n._noBody){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}}function Ry(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function iC(n){var e=new FileReader,t=Ry(e);return e.readAsArrayBuffer(n),t}function aC(n){var e=new FileReader,t=Ry(e),r=/charset=([A-Za-z0-9_-]+)/.exec(n.type),a=r?r[1]:"utf-8";return e.readAsText(n,a),t}function oC(n){for(var e=new Uint8Array(n),t=new Array(e.length),r=0;r<e.length;r++)t[r]=String.fromCharCode(e[r]);return t.join("")}function _v(n){if(n.slice)return n.slice(0);var e=new Uint8Array(n.byteLength);return e.set(new Uint8Array(n)),e.buffer}function Iy(){return this.bodyUsed=!1,this._initBody=function(n){this.bodyUsed=this.bodyUsed,this._bodyInit=n,n?typeof n=="string"?this._bodyText=n:Hn.blob&&Blob.prototype.isPrototypeOf(n)?this._bodyBlob=n:Hn.formData&&FormData.prototype.isPrototypeOf(n)?this._bodyFormData=n:Hn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)?this._bodyText=n.toString():Hn.arrayBuffer&&Hn.blob&&tC(n)?(this._bodyArrayBuffer=_v(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Hn.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||rC(n))?this._bodyArrayBuffer=_v(n):this._bodyText=n=Object.prototype.toString.call(n):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Hn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Hn.blob&&(this.blob=function(){var n=op(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var n=op(this);return n||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(Hn.blob)return this.blob().then(iC);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var n=op(this);if(n)return n;if(this._bodyBlob)return aC(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(oC(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Hn.formData&&(this.formData=function(){return this.text().then(cC)}),this.json=function(){return this.text().then(JSON.parse)},this}var sC=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function lC(n){var e=n.toUpperCase();return sC.indexOf(e)>-1?e:n}function Mo(n,e){if(!(this instanceof Mo))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var t=e.body;if(n instanceof Mo){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url,this.credentials=n.credentials,e.headers||(this.headers=new hn(n.headers)),this.method=n.method,this.mode=n.mode,this.signal=n.signal,!t&&n._bodyInit!=null&&(t=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new hn(e.headers)),this.method=lC(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in En){var s=new AbortController;return s.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&t)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(t),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var a=/\?/;this.url+=(a.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}Mo.prototype.clone=function(){return new Mo(this,{body:this._bodyInit})};function cC(n){var e=new FormData;return n.trim().split("&").forEach(function(t){if(t){var r=t.split("="),a=r.shift().replace(/\+/g," "),s=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(a),decodeURIComponent(s))}}),e}function uC(n){var e=new hn,t=n.replace(/\r?\n[\t ]+/g," ");return t.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var a=r.split(":"),s=a.shift().trim();if(s){var l=a.join(":").trim();try{e.append(s,l)}catch(u){console.warn("Response "+u.message)}}}),e}Iy.call(Mo.prototype);function Ii(n,e){if(!(this instanceof Ii))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new hn(e.headers),this.url=e.url||"",this._initBody(n)}Iy.call(Ii.prototype);Ii.prototype.clone=function(){return new Ii(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new hn(this.headers),url:this.url})};Ii.error=function(){var n=new Ii(null,{status:200,statusText:""});return n.ok=!1,n.status=0,n.type="error",n};var dC=[301,302,303,307,308];Ii.redirect=function(n,e){if(dC.indexOf(e)===-1)throw new RangeError("Invalid status code");return new Ii(null,{status:e,headers:{location:n}})};var Io=En.DOMException;try{new Io}catch{Io=function(n,e){this.message=n,this.name=e;var t=Error(n);this.stack=t.stack},Io.prototype=Object.create(Error.prototype),Io.prototype.constructor=Io}function Oy(n,e){return new Promise(function(t,r){var a=new Mo(n,e);if(a.signal&&a.signal.aborted)return r(new Io("Aborted","AbortError"));var s=new XMLHttpRequest;function l(){s.abort()}s.onload=function(){var f={statusText:s.statusText,headers:uC(s.getAllResponseHeaders()||"")};a.url.indexOf("file://")===0&&(s.status<200||s.status>599)?f.status=200:f.status=s.status,f.url="responseURL"in s?s.responseURL:f.headers.get("X-Request-URL");var v="response"in s?s.response:s.responseText;setTimeout(function(){t(new Ii(v,f))},0)},s.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},s.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},s.onabort=function(){setTimeout(function(){r(new Io("Aborted","AbortError"))},0)};function u(f){try{return f===""&&En.location.href?En.location.href:f}catch{return f}}if(s.open(a.method,u(a.url),!0),a.credentials==="include"?s.withCredentials=!0:a.credentials==="omit"&&(s.withCredentials=!1),"responseType"in s&&(Hn.blob?s.responseType="blob":Hn.arrayBuffer&&(s.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof hn||En.Headers&&e.headers instanceof En.Headers)){var h=[];Object.getOwnPropertyNames(e.headers).forEach(function(f){h.push($s(f)),s.setRequestHeader(f,Ef(e.headers[f]))}),a.headers.forEach(function(f,v){h.indexOf(v)===-1&&s.setRequestHeader(v,f)})}else a.headers.forEach(function(f,v){s.setRequestHeader(v,f)});a.signal&&(a.signal.addEventListener("abort",l),s.onreadystatechange=function(){s.readyState===4&&a.signal.removeEventListener("abort",l)}),s.send(typeof a._bodyInit>"u"?null:a._bodyInit)})}Oy.polyfill=!0;En.fetch||(En.fetch=Oy,En.Headers=hn,En.Request=Mo,En.Response=Ii);var Rv,Iv;function hC(){return Iv||(Iv=1,Rv=self.fetch.bind(self)),Rv}var pC=hC();const Ql=xy(pC);function Wt(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function Oo(n){return function e(t){return arguments.length===0||Wt(t)?e:n.apply(this,arguments)}}function Es(n){return function e(t,r){switch(arguments.length){case 0:return e;case 1:return Wt(t)?e:Oo(function(a){return n(t,a)});default:return Wt(t)&&Wt(r)?e:Wt(t)?Oo(function(a){return n(a,r)}):Wt(r)?Oo(function(a){return n(t,a)}):n(t,r)}}}function fC(n,e){n=n||[],e=e||[];var t,r=n.length,a=e.length,s=[];for(t=0;t<r;)s[s.length]=n[t],t+=1;for(t=0;t<a;)s[s.length]=e[t],t+=1;return s}function mC(n){return function e(t,r,a){switch(arguments.length){case 0:return e;case 1:return Wt(t)?e:Es(function(s,l){return n(t,s,l)});case 2:return Wt(t)&&Wt(r)?e:Wt(t)?Es(function(s,l){return n(s,r,l)}):Wt(r)?Es(function(s,l){return n(t,s,l)}):Oo(function(s){return n(t,r,s)});default:return Wt(t)&&Wt(r)&&Wt(a)?e:Wt(t)&&Wt(r)?Es(function(s,l){return n(s,l,a)}):Wt(t)&&Wt(a)?Es(function(s,l){return n(s,r,l)}):Wt(r)&&Wt(a)?Es(function(s,l){return n(t,s,l)}):Wt(t)?Oo(function(s){return n(s,r,a)}):Wt(r)?Oo(function(s){return n(t,s,a)}):Wt(a)?Oo(function(s){return n(t,r,s)}):n(t,r,a)}}}var Ov=mC(function(n,e,t){var r=t.length;if(n>=r||n<-r)return t;var a=(r+n)%r,s=fC(t);return s[a]=e(t[a]),s});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Rp=function(n,e){return Rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])},Rp(n,e)};function Ay(n,e){Rp(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function gC(n){var e=typeof Symbol=="function"&&n[Symbol.iterator],t=0;return e?e.call(n):{next:function(){return n&&t>=n.length&&(n=void 0),{value:n&&n[t++],done:!n}}}}function vC(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),a,s=[],l;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)s.push(a.value)}catch(u){l={error:u}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(l)throw l.error}}return s}function bC(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(vC(arguments[e]));return n}var My=function(){function n(e,t){this.target=t,this.type=e}return n}(),yC=function(n){Ay(e,n);function e(t,r){var a=n.call(this,"error",r)||this;return a.message=t.message,a.error=t,a}return e}(My),wC=function(n){Ay(e,n);function e(t,r,a){t===void 0&&(t=1e3),r===void 0&&(r="");var s=n.call(this,"close",a)||this;return s.wasClean=!0,s.code=t,s.reason=r,s}return e}(My);/*!
 * Reconnecting WebSocket
 * by Pedro Ladaria <pedro.ladaria@gmail.com>
 * https://github.com/pladaria/reconnecting-websocket
 * License MIT
 */var kC=function(){if(typeof WebSocket<"u")return WebSocket},CC=function(n){return typeof n<"u"&&!!n&&n.CLOSING===2},Eo={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+Math.random()*4e3,minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},Av=function(){function n(e,t,r){var a=this;r===void 0&&(r={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(s){a._debug("open event");var l=a._options.minUptime,u=l===void 0?Eo.minUptime:l;clearTimeout(a._connectTimeout),a._uptimeTimeout=setTimeout(function(){return a._acceptOpen()},u),a._ws.binaryType=a._binaryType,a._messageQueue.forEach(function(h){return a._ws.send(h)}),a._messageQueue=[],a.onopen&&a.onopen(s),a._listeners.open.forEach(function(h){return a._callEventListener(s,h)})},this._handleMessage=function(s){a._debug("message event"),a.onmessage&&a.onmessage(s),a._listeners.message.forEach(function(l){return a._callEventListener(s,l)})},this._handleError=function(s){a._debug("error event",s.message),a._disconnect(void 0,s.message==="TIMEOUT"?"timeout":void 0),a.onerror&&a.onerror(s),a._debug("exec error listeners"),a._listeners.error.forEach(function(l){return a._callEventListener(s,l)}),a._connect()},this._handleClose=function(s){a._debug("close event"),a._clearTimeouts(),a._shouldReconnect&&a._connect(),a.onclose&&a.onclose(s),a._listeners.close.forEach(function(l){return a._callEventListener(s,l)})},this._url=e,this._protocols=t,this._options=r,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(n,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CONNECTING",{get:function(){return n.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OPEN",{get:function(){return n.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CLOSING",{get:function(){return n.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CLOSED",{get:function(){return n.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bufferedAmount",{get:function(){var e=this._messageQueue.reduce(function(t,r){return typeof r=="string"?t+=r.length:r instanceof Blob?t+=r.size:t+=r.byteLength,t},0);return e+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?n.CLOSED:n.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),n.prototype.close=function(e,t){if(e===void 0&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(e,t)},n.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,!this._ws||this._ws.readyState===this.CLOSED?this._connect():(this._disconnect(e,t),this._connect())},n.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,r=t===void 0?Eo.maxEnqueuedMessages:t;this._messageQueue.length<r&&(this._debug("enqueue",e),this._messageQueue.push(e))}},n.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},n.prototype.dispatchEvent=function(e){var t,r,a=this._listeners[e.type];if(a)try{for(var s=gC(a),l=s.next();!l.done;l=s.next()){var u=l.value;this._callEventListener(e,u)}}catch(h){t={error:h}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return!0},n.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(r){return r!==t}))},n.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,bC(["RWS>"],e))},n.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,r=t===void 0?Eo.reconnectionDelayGrowFactor:t,a=e.minReconnectionDelay,s=a===void 0?Eo.minReconnectionDelay:a,l=e.maxReconnectionDelay,u=l===void 0?Eo.maxReconnectionDelay:l,h=0;return this._retryCount>0&&(h=s*Math.pow(r,this._retryCount-1),h>u&&(h=u)),this._debug("next delay",h),h},n.prototype._wait=function(){var e=this;return new Promise(function(t){setTimeout(t,e._getNextDelay())})},n.prototype._getNextUrl=function(e){if(typeof e=="string")return Promise.resolve(e);if(typeof e=="function"){var t=e();if(typeof t=="string")return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},n.prototype._connect=function(){var e=this;if(!(this._connectLock||!this._shouldReconnect)){this._connectLock=!0;var t=this._options,r=t.maxRetries,a=r===void 0?Eo.maxRetries:r,s=t.connectionTimeout,l=s===void 0?Eo.connectionTimeout:s,u=t.WebSocket,h=u===void 0?kC():u;if(this._retryCount>=a){this._debug("max retries reached",this._retryCount,">=",a);return}if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!CC(h))throw Error("No valid WebSocket class provided");this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(f){e._closeCalled||(e._debug("connect",{url:f,protocols:e._protocols}),e._ws=e._protocols?new h(f,e._protocols):new h(f),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},l))})}},n.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new yC(Error("TIMEOUT"),this))},n.prototype._disconnect=function(e,t){if(e===void 0&&(e=1e3),this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new wC(e,t,this))}catch{}}},n.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},n.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},n.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},n.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},n.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},n}();let ju;const SC=new Uint8Array(16);function TC(){if(!ju&&(ju=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ju))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ju(SC)}const xn=[];for(let n=0;n<256;++n)xn.push((n+256).toString(16).slice(1));function xC(n,e=0){return xn[n[e+0]]+xn[n[e+1]]+xn[n[e+2]]+xn[n[e+3]]+"-"+xn[n[e+4]]+xn[n[e+5]]+"-"+xn[n[e+6]]+xn[n[e+7]]+"-"+xn[n[e+8]]+xn[n[e+9]]+"-"+xn[n[e+10]]+xn[n[e+11]]+xn[n[e+12]]+xn[n[e+13]]+xn[n[e+14]]+xn[n[e+15]]}const EC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Mv={randomUUID:EC};function Lv(n,e,t){if(Mv.randomUUID&&!n)return Mv.randomUUID();n=n||{};const r=n.random||(n.rng||TC)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,xC(r)}var PC="1.2.4-alpha.8",Na={version:PC};const Po=console;var ai;(function(n){n.Https="https",n.HttpsWithStreaming="httpsWithStreaming",n.Websocket="websocket"})(ai||(ai={}));var Kn;(function(n){n.Application="bot",n.User="user",n.Failure="failure"})(Kn||(Kn={}));const Nv="NLX.Welcome",_C="We encountered an issue. Please try again soon.",Ly=n=>Array.isArray(n)?n:Object.entries(n).map(([e,t])=>({slotId:e,value:t})),jv=n=>({...n,intentId:n.flowId??n.intentId,slots:n.slots!=null?Ly(n.slots):n.slots}),Dv=n=>n.responses,Uv=n=>{try{return JSON.parse(n)}catch{return null}},Ny=n=>{var e;return((e=n.match(/(bots\.dev\.studio\.nlx\.ai|bots\.studio\.nlx\.ai|apps\.nlx\.ai|dev\.apps\.nlx\.ai)/g))==null?void 0:e[0])??"apps.nlx.ai"},RC=n=>{if(_f(n))return n;const e=Ny(n),t=new URL(n).pathname.split("/"),r=t[2],a=t[3];return`wss://us-east-1-ws.${e}?deploymentKey=${r}&channelKey=${a}`},IC=n=>{if(!_f(n))return n;const e=Ny(n),t=new URL(n),r=new URLSearchParams(t.search),a=r.get("channelKey"),s=r.get("deploymentKey");return`https://${e}/c/${s}/${a}`},_f=n=>n.indexOf("wss://")===0,OC=async({fullApplicationUrl:n,headers:e,body:t,stream:r,eventListeners:a})=>{const s=async l=>{const u=await Ql(n,{method:"POST",headers:{...e,"Content-Type":"application/json","nlx-sdk-version":Na.version,"nlx-core-version":Na.version},body:JSON.stringify({...l,stream:!0})});if(!u.ok||u.body==null)throw new Error(`HTTP Error: ${u.status}`);const h=u.body.getReader(),f=new TextDecoder;let v="";const C=[];let x={};for(;;){const{done:T,value:N}=await h.read();if(T)break;for(v+=f.decode(N,{stream:!0});;){const L=v.indexOf("{");if(L===-1)break;let $=!1;for(let V=0;V<v.length;V++)if(v[V]==="}"){const K=v.substring(L,V+1);try{const F=JSON.parse(K);if(F.type==="interim"){const A=F.text;typeof A=="string"&&a.interimMessage.forEach(U=>{U(A)})}else F.type==="message"?C.push({text:F.text,choices:F.choices??[],messageId:F.messageId,metadata:F.metadata}):F.type==="final_response"&&(x=F.data);v=v.substring(V+1),$=!0;break}catch{}}if(!$)break}}return a.interimMessage.forEach(T=>{T(void 0)}),{...x,messages:[...C,...(x.messages??[]).map(T=>({text:T.text,choices:T.choices??[],messageId:T.messageId,metadata:T.metadata}))]}};if(r)return await s(t);{const l=await Ql(n,{method:"POST",headers:{...e??{},Accept:"application/json","Content-Type":"application/json","nlx-sdk-version":Na.version,"nlx-core-version":Na.version},body:JSON.stringify(t)});if(!l.ok||l.body==null)throw new Error(`HTTP Error: ${l.status}`);return await l.json()}};function AC(n){var e;let t,r=[],a=null,s,l=[],u=null;const h=n.protocol??(_f(n.applicationUrl??"")?ai.Websocket:((e=n.experimental)==null?void 0:e.streamHttp)===!1?ai.Https:ai.HttpsWithStreaming),f=n.host!=null&&n.deploymentKey!=null&&n.channelKey!=null?`https://${n.host}/c/${n.deploymentKey}/${n.channelKey}`:n.applicationUrl??"",v=RC(f),C=IC(f);/[-|_][a-z]{2,}[-|_][A-Z]{2,}$/.test(C)&&Po.warn("Since v1.0.0, the language code is no longer added at the end of the application URL. Please remove the modifier (e.g. '-en-US') from the URL, and specify it in the `languageCode` parameter instead.");const x={voicePlusCommand:[],interimMessage:[]},T=n.conversationId??Lv();let N={responses:n.responses??[],languageCode:n.languageCode,userId:n.userId,conversationId:T};const L=()=>{var z;return`${C}${((z=n.experimental)==null?void 0:z.completeApplicationUrl)===!0?"":`-${N.languageCode}`}`},$=(z,ce)=>{N={...N,...z},Z.forEach(ue=>{ue(Dv(N),ce)})},V=()=>{const z={type:Kn.Failure,receivedAt:new Date().getTime(),payload:{text:n.failureMessage??_C}};$({responses:[...N.responses,z]},z)},K=z=>{if((z==null?void 0:z.messages.length)>0){const ce={type:Kn.Application,receivedAt:new Date().getTime(),payload:{...z,messages:z.messages.map(ue=>({nodeId:ue.nodeId,messageId:ue.messageId,text:ue.text,choices:ue.choices??[]}))}};$({responses:[...N.responses,ce]},ce),z.metadata.hasPendingDataRequest&&(Ae({poll:!0}),setTimeout(()=>{U({request:{structured:{poll:!0}}})},1500))}else Po.warn("Invalid message structure, expected object with field 'messages'."),V()};let F;const A=z=>{(s==null?void 0:s.readyState)===1?s.send(JSON.stringify(z)):l=[...l,z]},U=async z=>{var ce;if(F!=null){F(z,M=>{Po.warn("Using the second argument in `setRequestOverride` is deprecated. Use `conversationHandler.appendMessageToTranscript` instead.");const ae={type:Kn.Application,receivedAt:new Date().getTime(),payload:M};$({responses:[...N.responses,ae]},ae)});return}const ue={userId:N.userId,conversationId:N.conversationId,...z,languageCode:N.languageCode,channelType:(ce=n.experimental)==null?void 0:ce.channelType,environment:n.environment};if(h===ai.Websocket)(t==null?void 0:t.readyState)===1?t.send(JSON.stringify(ue)):r=[...r,ue];else try{const M=await OC({fullApplicationUrl:L(),headers:n.headers??{},stream:h===ai.HttpsWithStreaming,eventListeners:x,body:ue});K(M)}catch(M){Po.warn(M),V()}};let Z=[];const oe=async()=>{(t==null?void 0:t.readyState)===1&&r[0]!=null&&(await U(r[0]),r=r.slice(1))},X=()=>{(s==null?void 0:s.readyState)===1&&l[0]!=null&&(A(l[0]),l=l.slice(1))},H=()=>{var z;Y();const ce=new URL(v);((z=n.experimental)==null?void 0:z.completeApplicationUrl)!==!0&&(ce.searchParams.set("languageCode",N.languageCode),ce.searchParams.set("channelKey",`${ce.searchParams.get("channelKey")??""}-${N.languageCode}`)),ce.searchParams.set("conversationId",N.conversationId);const ue=n.headers["nlx-api-key"];ue!=null&&ce.searchParams.set("apiKey",ue),t=new Av(ce.href),a=setInterval(()=>{oe()},500),t.onmessage=function(M){typeof(M==null?void 0:M.data)=="string"&&K(Uv(M.data))}},J=()=>{var z;if(he(),n.bidirectional!==!0)return;const ce=new URL(v);((z=n.experimental)==null?void 0:z.completeApplicationUrl)!==!0&&(ce.searchParams.set("languageCode",N.languageCode),ce.searchParams.set("channelKey",`${ce.searchParams.get("channelKey")??""}-${N.languageCode}`)),ce.searchParams.set("conversationId",N.conversationId),ce.searchParams.set("type","voice-plus");const ue=n.headers["nlx-api-key"];ue!=null&&ce.searchParams.set("apiKey",ue),s=new Av(ce.href),u=setInterval(()=>{X()},500),s.onmessage=M=>{if(typeof(M==null?void 0:M.data)=="string"){const ae=Uv(M.data);ae!=null&&x.voicePlusCommand.forEach(Ve=>{Ve(ae)})}}},Y=()=>{a!=null&&clearInterval(a),t!=null&&(t.onmessage=null,t.close(),t=void 0)},he=()=>{u!=null&&clearInterval(u),s!=null&&(s.onmessage=null,s.close(),s=void 0)};h===ai.Websocket&&H(),J();const Ae=(z,ce)=>{const ue={type:Kn.User,receivedAt:new Date().getTime(),payload:{type:"structured",...jv(z),context:ce}};$({responses:[...N.responses,ue]},ue)},qe=(z,ce)=>{Ae({intentId:z},ce),U({context:ce,request:{structured:{intentId:z}}})},Ue=(z,ce)=>{const ue={type:Kn.User,receivedAt:new Date().getTime(),payload:{type:"text",text:z,context:ce}};$({responses:[...N.responses,ue]},ue),U({context:ce,request:{unstructured:{text:z}}})},ot=(z,ce,ue)=>{let M=[...N.responses];const ae={type:Kn.User,receivedAt:new Date().getTime(),payload:{type:"choice",choiceId:z}},Ve=(ue==null?void 0:ue.responseIndex)??-1,ke=(ue==null?void 0:ue.messageIndex)??-1;Ve>-1&&ke>-1&&(M=Ov(Ve,Me=>Me.type===Kn.Application?{...Me,payload:{...Me.payload,messages:Ov(ke,Oe=>({...Oe,selectedChoiceId:z}),Me.payload.messages)}}:Me,M)),M=[...M,ae],$({responses:M},ae),U({context:ce,request:{structured:{nodeId:ue==null?void 0:ue.nodeId,intentId:ue==null?void 0:ue.intentId,choiceId:z}}})},Fe=z=>{Z=Z.filter(ce=>ce!==z)};return{sendText:Ue,sendContext:async z=>{const ce=await Ql(`${L()}/context`,{method:"POST",headers:{...n.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":N.conversationId,"nlx-sdk-version":Na.version,"nlx-core-version":Na.version},body:JSON.stringify({languageCode:N.languageCode,conversationId:N.conversationId,userId:N.userId,context:z})});if(ce.status>=400)throw new Error(`Responded with ${ce.status}`)},appendMessageToTranscript:z=>{const ce={...z,receivedAt:z.receivedAt??new Date().getTime()};$({responses:[...N.responses,ce]},ce)},sendStructured:(z,ce)=>{Ae(z,ce),U({context:ce,request:{structured:jv(z)}})},sendSlots:(z,ce)=>{Ae({slots:z},ce),U({context:ce,request:{structured:{slots:Ly(z)}}})},sendFlow:qe,sendIntent:(z,ce)=>{Po.warn("Calling `sendIntent` is deprecated and will be removed in a future version of the SDK. Use `sendFlow` instead."),qe(z,ce)},sendWelcomeFlow:z=>{qe(Nv,z)},sendWelcomeIntent:z=>{Po.warn("Calling `sendWelcomeIntent` is deprecated and will be removed in a future version of the SDK. Use `sendWelcomeFlow` instead."),qe(Nv,z)},sendChoice:ot,submitFeedback:async(z,ce)=>{const ue=await Ql(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({languageCode:N.languageCode,conversationId:N.conversationId,userId:N.userId,...ce})});if(ue.status>=400)throw new Error(`Responded with ${ue.status}`)},currentConversationId:()=>N.conversationId,setLanguageCode:z=>{if(z===N.languageCode){Po.warn("Attempted to set language code to the one already active.");return}h===ai.Websocket&&H(),J(),$({languageCode:z})},currentLanguageCode:()=>N.languageCode,getVoiceCredentials:async(z,ce)=>{const ue=await Ql(`${C}-${N.languageCode}/requestToken`,{method:"POST",headers:{...n.headers??{},Accept:"application/json","Content-Type":"application/json","nlx-conversation-id":N.conversationId,"nlx-sdk-version":Na.version,"nlx-core-version":Na.version},body:JSON.stringify({languageCode:N.languageCode,conversationId:N.conversationId,userId:N.userId,requestToken:!0,context:z,autoTriggerWelcomeFlow:(ce==null?void 0:ce.autoTriggerWelcomeFlow)??!0})});if(ue.status>=400)throw new Error(`Responded with ${ue.status}`);const M=await ue.json();if((M==null?void 0:M.url)==null)throw new Error("Invalid response");return M},subscribe:z=>(Z=[...Z,z],z(Dv(N)),()=>{Fe(z)}),unsubscribe:Fe,unsubscribeAll:()=>{Z=[]},reset:z=>{$({conversationId:Lv(),responses:(z==null?void 0:z.clearResponses)===!0?[]:N.responses}),h===ai.Websocket&&H(),J()},destroy:()=>{Z=[],h===ai.Websocket&&Y(),he()},setRequestOverride:z=>{F=z},addEventListener:(z,ce)=>{x[z]=[...x[z],ce]},removeEventListener:(z,ce)=>{x[z]=x[z].filter(ue=>ue!==ce)},sendVoicePlusContext:z=>{A({context:z})}}}const MC=n=>n.host!=null&&n.deploymentKey!=null&&n.channelKey!=null?!0:(n.applicationUrl??"").length>0;function jy(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var a=n.length;for(e=0;e<a;e++)n[e]&&(t=jy(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function rt(){for(var n,e,t=0,r="",a=arguments.length;t<a;t++)(n=arguments[t])&&(e=jy(n))&&(r&&(r+=" "),r+=e);return r}const at=n=>({width:n.size!=null?`${n.size}px`:"100%",height:n.size!=null?`${n.size}px`:"100%",className:n.className}),LC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M11 21H10L11 14H7.5C6.92 14 6.93 13.68 7.12 13.34C7.31 13 7.17 13.26 7.19 13.22C8.48 10.94 10.42 7.54 13 3H14L13 10H16.5C16.99 10 17.06 10.33 16.97 10.51L16.9 10.66C12.96 17.55 11 21 11 21Z",fill:"currentColor"})}),sc=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...at(n),children:[R.jsx("path",{d:"M13.5562 5.34835C12.2796 6.62498 12.4866 8.90179 14.0186 10.4337C14.3377 10.7529 14.5571 11.134 14.6767 11.5383C14.8007 11.9572 14.8177 12.4011 14.7277 12.8268C14.6656 13.1203 14.5526 13.4051 14.3887 13.6672C14.3259 13.7677 14.2557 13.865 14.1778 13.9581C14.1279 14.018 14.0747 14.0761 14.0186 14.1322C13.3341 14.8166 12.3641 15.0421 11.4917 14.8092L11.4728 14.8042C9.38654 14.2543 7.32235 15.2129 6.85652 16.9516C6.5761 17.9979 5.50065 18.6188 4.45431 18.3385C3.40798 18.0581 2.787 16.9826 3.06729 15.9363C3.34209 14.9111 4.38012 14.2942 5.40615 14.5335L5.40666 14.5317C5.42748 14.5378 5.44842 14.5437 5.46962 14.5493C7.21342 15.0166 9.08173 13.699 9.64244 11.6062C9.64857 11.5835 9.65521 11.5608 9.66185 11.5383C9.7815 11.134 10.0009 10.7529 10.32 10.4337L10.332 10.4214C10.339 10.4142 10.346 10.407 10.3533 10.4C11.8549 8.86865 12.0496 6.61566 10.7824 5.34835C10.0163 4.58237 10.0163 3.34047 10.7824 2.57449C11.5483 1.8085 12.7903 1.8085 13.5562 2.57449C14.3066 3.32501 14.3218 4.53237 13.6016 5.30135L13.6029 5.30263C13.5872 5.3177 13.5716 5.33289 13.5562 5.34835Z",fill:"currentColor"}),R.jsx("path",{d:"M19.327 6.83185C20.0311 6.83185 20.6019 7.40264 20.6019 8.10675C20.6019 8.81087 20.0311 9.38166 19.327 9.38166C18.6229 9.38166 18.0521 8.81087 18.0521 8.10675C18.0521 7.40264 18.6229 6.83185 19.327 6.83185Z",fill:"currentColor"}),R.jsx("path",{d:"M21.3237 16.4754C21.3237 15.3741 20.4309 14.4813 19.3297 14.4813C18.2284 14.4813 17.3356 15.3741 17.3356 16.4754C17.3356 17.5767 18.2284 18.4695 19.3297 18.4695C20.4309 18.4695 21.3237 17.5767 21.3237 16.4754Z",fill:"currentColor"}),R.jsx("path",{d:"M12.1025 19.3194C12.8246 19.3194 13.4101 19.9195 13.4101 20.6597C13.4101 21.4 12.8246 22 12.1025 22C11.3804 22 10.7949 21.4 10.7949 20.6597C10.7949 19.9195 11.3804 19.3194 12.1025 19.3194Z",fill:"currentColor"}),R.jsx("path",{d:"M6.28367 8.13944C6.28367 7.41726 5.68363 6.83185 4.94339 6.83185C4.20314 6.83185 3.6031 7.41726 3.6031 8.13944C3.6031 8.86163 4.20314 9.44704 4.94339 9.44704C5.68363 9.44704 6.28367 8.86163 6.28367 8.13944Z",fill:"currentColor"})]}),NC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M6 13C5.45 13 5 13.45 5 14C5 14.55 5.45 15 6 15C6.55 15 7 14.55 7 14C7 13.45 6.55 13 6 13ZM6 17C5.45 17 5 17.45 5 18C5 18.55 5.45 19 6 19C6.55 19 7 18.55 7 18C7 17.45 6.55 17 6 17ZM6 9C5.45 9 5 9.45 5 10C5 10.55 5.45 11 6 11C6.55 11 7 10.55 7 10C7 9.45 6.55 9 6 9ZM3 9.5C2.72 9.5 2.5 9.72 2.5 10C2.5 10.28 2.72 10.5 3 10.5C3.28 10.5 3.5 10.28 3.5 10C3.5 9.72 3.28 9.5 3 9.5ZM6 5C5.45 5 5 5.45 5 6C5 6.55 5.45 7 6 7C6.55 7 7 6.55 7 6C7 5.45 6.55 5 6 5ZM21 10.5C21.28 10.5 21.5 10.28 21.5 10C21.5 9.72 21.28 9.5 21 9.5C20.72 9.5 20.5 9.72 20.5 10C20.5 10.28 20.72 10.5 21 10.5ZM14 7C14.55 7 15 6.55 15 6C15 5.45 14.55 5 14 5C13.45 5 13 5.45 13 6C13 6.55 13.45 7 14 7ZM14 3.5C14.28 3.5 14.5 3.28 14.5 3C14.5 2.72 14.28 2.5 14 2.5C13.72 2.5 13.5 2.72 13.5 3C13.5 3.28 13.72 3.5 14 3.5ZM3 13.5C2.72 13.5 2.5 13.72 2.5 14C2.5 14.28 2.72 14.5 3 14.5C3.28 14.5 3.5 14.28 3.5 14C3.5 13.72 3.28 13.5 3 13.5ZM10 20.5C9.72 20.5 9.5 20.72 9.5 21C9.5 21.28 9.72 21.5 10 21.5C10.28 21.5 10.5 21.28 10.5 21C10.5 20.72 10.28 20.5 10 20.5ZM10 3.5C10.28 3.5 10.5 3.28 10.5 3C10.5 2.72 10.28 2.5 10 2.5C9.72 2.5 9.5 2.72 9.5 3C9.5 3.28 9.72 3.5 10 3.5ZM10 7C10.55 7 11 6.55 11 6C11 5.45 10.55 5 10 5C9.45 5 9 5.45 9 6C9 6.55 9.45 7 10 7ZM10 12.5C9.17 12.5 8.5 13.17 8.5 14C8.5 14.83 9.17 15.5 10 15.5C10.83 15.5 11.5 14.83 11.5 14C11.5 13.17 10.83 12.5 10 12.5ZM18 13C17.45 13 17 13.45 17 14C17 14.55 17.45 15 18 15C18.55 15 19 14.55 19 14C19 13.45 18.55 13 18 13ZM18 17C17.45 17 17 17.45 17 18C17 18.55 17.45 19 18 19C18.55 19 19 18.55 19 18C19 17.45 18.55 17 18 17ZM18 9C17.45 9 17 9.45 17 10C17 10.55 17.45 11 18 11C18.55 11 19 10.55 19 10C19 9.45 18.55 9 18 9ZM18 5C17.45 5 17 5.45 17 6C17 6.55 17.45 7 18 7C18.55 7 19 6.55 19 6C19 5.45 18.55 5 18 5ZM21 13.5C20.72 13.5 20.5 13.72 20.5 14C20.5 14.28 20.72 14.5 21 14.5C21.28 14.5 21.5 14.28 21.5 14C21.5 13.72 21.28 13.5 21 13.5ZM14 17C13.45 17 13 17.45 13 18C13 18.55 13.45 19 14 19C14.55 19 15 18.55 15 18C15 17.45 14.55 17 14 17ZM14 20.5C13.72 20.5 13.5 20.72 13.5 21C13.5 21.28 13.72 21.5 14 21.5C14.28 21.5 14.5 21.28 14.5 21C14.5 20.72 14.28 20.5 14 20.5ZM10 8.5C9.17 8.5 8.5 9.17 8.5 10C8.5 10.83 9.17 11.5 10 11.5C10.83 11.5 11.5 10.83 11.5 10C11.5 9.17 10.83 8.5 10 8.5ZM10 17C9.45 17 9 17.45 9 18C9 18.55 9.45 19 10 19C10.55 19 11 18.55 11 18C11 17.45 10.55 17 10 17ZM14 12.5C13.17 12.5 12.5 13.17 12.5 14C12.5 14.83 13.17 15.5 14 15.5C14.83 15.5 15.5 14.83 15.5 14C15.5 13.17 14.83 12.5 14 12.5ZM14 8.5C13.17 8.5 12.5 9.17 12.5 10C12.5 10.83 13.17 11.5 14 11.5C14.83 11.5 15.5 10.83 15.5 10C15.5 9.17 14.83 8.5 14 8.5Z",fill:"currentColor"})}),jC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z",fill:"currentColor"})}),Dy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12 15.41L6 9.40997L7.41 7.99997L12 12.58L16.59 7.99997L18 9.40997L12 15.41Z",fill:"currentColor"})}),Ip=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M7.59001 12L13.59 18L15 16.59L10.42 12L15 7.41002L13.59 6.00002L7.59001 12Z",fill:"currentColor"})}),Uy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M15 12L9.00005 18L7.59005 16.59L12.17 12L7.59005 7.41002L9.00005 6.00002L15 12Z",fill:"currentColor"})}),DC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12 8L6 14L7.41 15.41L12 10.83L16.59 15.41L18 14L12 8Z",fill:"currentColor"})}),Pd=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z",fill:"currentColor"})}),Op=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M18.5 16H7C4.79 16 3 14.21 3 12C3 9.79 4.79 8 7 8H19.5C20.88 8 22 9.12 22 10.5C22 11.88 20.88 13 19.5 13H9C8.45 13 8 12.55 8 12C8 11.45 8.45 11 9 11H18.5V9.5H9C7.62 9.5 6.5 10.62 6.5 12C6.5 13.38 7.62 14.5 9 14.5H19.5C21.71 14.5 23.5 12.71 23.5 10.5C23.5 8.29 21.71 6.5 19.5 6.5H7C3.96 6.5 1.5 8.96 1.5 12C1.5 15.04 3.96 17.5 7 17.5H18.5V16Z",fill:"currentColor"})}),Fy=n=>R.jsx("svg",{viewBox:"0 0 12 12",...at(n),children:R.jsx("path",{d:"M10 1H2C1.45 1 1.005 1.45 1.005 2L1 11L3 9H10C10.55 9 11 8.55 11 8V2C11 1.45 10.55 1 10 1ZM6 7H3V6H6V7ZM9 5.5H3V4.5H9V5.5ZM9 4H3V3H9V4Z",fill:"currentColor"})}),UC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...at(n),children:[R.jsx("path",{d:"M12 15.2C13.7673 15.2 15.2 13.7673 15.2 12C15.2 10.2327 13.7673 8.8 12 8.8C10.2327 8.8 8.8 10.2327 8.8 12C8.8 13.7673 10.2327 15.2 12 15.2Z",fill:"currentColor"}),R.jsx("path",{d:"M9 2L7.17 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4H16.83L15 2H9ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z",fill:"currentColor"})]}),Rf=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M8.99991 16.17L4.82991 12L3.40991 13.41L8.99991 19L20.9999 7L19.5899 5.59L8.99991 16.17Z",fill:"currentColor"})}),lc=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z",fill:"currentColor"})}),FC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z",fill:"currentColor"})}),By=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3.01 4.9 3.01 6L3 20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM19 20H5V9H19V20Z",fill:"currentColor"})}),Vy=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...at(n),children:[R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 21C6.9 21 6 20.1 6 19V7H18V19C18 20.1 17.1 21 16 21H8ZM9.33337 9H8V19H9.33337V9ZM11.3334 9V19H12.6666V9H11.3334ZM16 19H14.6666V9H16V19Z",fill:"currentColor"}),R.jsx("path",{d:"M15.5 4H19V6H5V4H8.5L9.5 3H14.5L15.5 4Z",fill:"currentColor"})]}),Wy=n=>R.jsx("svg",{viewBox:"0 0 16 16",...at(n),children:R.jsx("path",{d:"M2 11.5002V14.0002H4.5L11.8733 6.62687L9.37333 4.12687L2 11.5002ZM13.8067 4.69354C14.0667 4.43354 14.0667 4.01354 13.8067 3.75354L12.2467 2.19354C11.9867 1.93354 11.5667 1.93354 11.3067 2.19354L10.0867 3.41354L12.5867 5.91354L13.8067 4.69354V4.69354Z",fill:"currentColor"})}),zy=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...at(n),children:[R.jsx("path",{d:"M21 12.22C21 6.73 16.74 3 12 3C7.31 3 3 6.65 3 12.28C2.4 12.62 2 13.26 2 14V16C2 17.1 2.9 18 4 18H5V11.9C5 8.03 8.13 4.9 12 4.9C15.87 4.9 19 8.03 19 11.9V19H11V21H19C20.1 21 21 20.1 21 19V17.78C21.59 17.47 22 16.86 22 16.14V13.84C22 13.14 21.59 12.53 21 12.22Z",fill:"currentColor"}),R.jsx("path",{d:"M9 14C9.55228 14 10 13.5523 10 13C10 12.4477 9.55228 12 9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14Z",fill:"currentColor"}),R.jsx("path",{d:"M15 14C15.5523 14 16 13.5523 16 13C16 12.4477 15.5523 12 15 12C14.4477 12 14 12.4477 14 13C14 13.5523 14.4477 14 15 14Z",fill:"currentColor"}),R.jsx("path",{d:"M18 11.03C17.52 8.18 15.04 6 12.05 6C9.02 6 5.76 8.51 6.02 12.45C8.49 11.44 10.35 9.24 10.88 6.56C12.19 9.19 14.88 11 18 11.03Z",fill:"currentColor"})]}),Ap=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z",fill:"currentColor"})}),BC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M7 14H5V19H10V17H7V14ZM5 10H7V7H10V5H5V10ZM17 17H14V19H19V14H17V17ZM14 5V7H17V10H19V5H14Z",fill:"currentColor"})}),ld=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12 15C13.66 15 14.99 13.66 14.99 12L15 6C15 4.34 13.66 3 12 3C10.34 3 9 4.34 9 6V12C9 13.66 10.34 15 12 15ZM17.3 12C17.3 15 14.76 17.1 12 17.1C9.24 17.1 6.7 15 6.7 12H5C5 15.42 7.72 18.23 11 18.72V22H13V18.72C16.28 18.24 19 15.42 19 12H17.3Z",fill:"currentColor"})}),If=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z",fill:"currentColor"})}),VC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z",fill:"currentColor"})}),cd=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M3 9.99999V14C3 14.55 3.45 15 4 15H7L10.29 18.29C10.92 18.92 12 18.47 12 17.58V6.40999C12 5.51999 10.92 5.06999 10.29 5.69999L7 8.99999H4C3.45 8.99999 3 9.44999 3 9.99999ZM16.5 12C16.5 10.23 15.48 8.70999 14 7.96999V16.02C15.48 15.29 16.5 13.77 16.5 12ZM14 4.44999V4.64999C14 5.02999 14.25 5.35999 14.6 5.49999C17.18 6.52999 19 9.05999 19 12C19 14.94 17.18 17.47 14.6 18.5C14.24 18.64 14 18.97 14 19.35V19.55C14 20.18 14.63 20.62 15.21 20.4C18.6 19.11 21 15.84 21 12C21 8.15999 18.6 4.88999 15.21 3.59999C14.63 3.36999 14 3.81999 14 4.44999Z",fill:"currentColor"})}),Of=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M16.5 12C16.5 10.23 15.48 8.71 14 7.97V10.18L16.45 12.63C16.48 12.43 16.5 12.22 16.5 12ZM19 12C19 12.94 18.8 13.82 18.46 14.64L19.97 16.15C20.63 14.91 21 13.5 21 12C21 7.72 18.01 4.14 14 3.23V5.29C16.89 6.15 19 8.83 19 12ZM4.27 3L3 4.27L7.73 9H3V15H7L12 20V13.27L16.25 17.52C15.58 18.04 14.83 18.45 14 18.7V20.76C15.38 20.45 16.63 19.81 17.69 18.95L19.73 21L21 19.73L12 10.73L4.27 3ZM12 4L9.91 6.09L12 8.18V4Z",fill:"currentColor"})}),WC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12.87 15.07L10.33 12.56L10.36 12.53C12.1 10.59 13.34 8.36 14.07 6H17V4H10V2H8V4H1V5.99H12.17C11.5 7.92 10.44 9.75 9 11.35C8.07 10.32 7.3 9.19 6.69 8H4.69C5.42 9.63 6.42 11.17 7.67 12.56L2.58 17.58L4 19L9 14L12.11 17.11L12.87 15.07ZM18.5 10H16.5L12 22H14L15.12 19H19.87L21 22H23L18.5 10ZM15.88 17L17.5 12.67L19.12 17H15.88Z",fill:"currentColor"})}),zC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M19 19H5V5H12V3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V12H19V19ZM14 3V5H17.59L7.76 14.83L9.17 16.24L19 6.41V10H21V3H14Z",fill:"currentColor"})}),qC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M8 5V19L19 12L8 5Z",fill:"currentColor"})}),$C=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...at(n),children:[R.jsx("path",{d:"M13 14.5C13 15.3284 12.3284 16 11.5 16C10.6716 16 10 15.3284 10 14.5C10 13.6716 10.6716 13 11.5 13C12.3284 13 13 13.6716 13 14.5Z",fill:"currentColor"}),R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 2H14L20 8V20C20 21.1 19.1 22 18 22H5.99C4.89 22 4 21.1 4 20V4C4 2.9 4.9 2 6 2ZM13.16 17.57L15.04 19.45L16.45 18.04L14.57 16.16C15.29 14.83 15.1 13.15 13.98 12.03C12.61 10.66 10.4 10.66 9.03 12.03C7.66 13.4 7.66 15.61 9.03 16.98C10.15 18.1 11.83 18.28 13.16 17.57ZM13 3.5V9H18.5L13 3.5Z",fill:"currentColor"})]}),HC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M3 15H21V13H3V15ZM3 19H21V17H3V19ZM3 11H21V9H3V11ZM3 5V7H21V5H3Z",fill:"currentColor"})}),cc=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M10 3C14.97 3 19 7.03 19 12H22L18.11 15.89L18.04 16.03L14 12H17C17 8.13 13.87 5 10 5C6.13 5 3 8.13 3 12C3 15.87 6.13 19 10 19V21C5.03 21 1 16.97 1 12C1 7.03 5.03 3 10 3Z",fill:"currentColor"})}),qy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M19.1064 12.9302C19.1459 12.6333 19.1657 12.3266 19.1657 12C19.1657 11.6833 19.1459 11.3667 19.0965 11.0698L21.1053 9.50625C21.2834 9.36771 21.3329 9.10052 21.2241 8.9026L19.3241 5.61719C19.2053 5.39948 18.9579 5.33021 18.7402 5.39948L16.3751 6.34948C15.8803 5.97344 15.3558 5.65677 14.772 5.41927L14.4157 2.90573C14.3761 2.66823 14.1782 2.5 13.9407 2.5H10.1407C9.90323 2.5 9.71521 2.66823 9.67563 2.90573L9.31938 5.41927C8.73552 5.65677 8.20115 5.98333 7.71625 6.34948L5.35115 5.39948C5.13344 5.32031 4.88604 5.39948 4.7673 5.61719L2.87719 8.9026C2.75844 9.11042 2.79802 9.36771 2.99594 9.50625L5.00479 11.0698C4.95532 11.3667 4.91573 11.6932 4.91573 12C4.91573 12.3068 4.93552 12.6333 4.985 12.9302L2.97615 14.4938C2.79802 14.6323 2.74855 14.8995 2.8574 15.0974L4.7574 18.3828C4.87615 18.6005 5.12354 18.6698 5.34125 18.6005L7.70636 17.6505C8.20115 18.0266 8.72563 18.3432 9.30948 18.5807L9.66573 21.0943C9.71521 21.3318 9.90323 21.5 10.1407 21.5H13.9407C14.1782 21.5 14.3761 21.3318 14.4058 21.0943L14.7621 18.5807C15.3459 18.3432 15.8803 18.0266 16.3652 17.6505L18.7303 18.6005C18.948 18.6797 19.1954 18.6005 19.3142 18.3828L21.2142 15.0974C21.3329 14.8797 21.2834 14.6323 21.0954 14.4938L19.1064 12.9302ZM12.0407 15.5625C10.0814 15.5625 8.47823 13.9594 8.47823 12C8.47823 10.0406 10.0814 8.4375 12.0407 8.4375C14.0001 8.4375 15.6032 10.0406 15.6032 12C15.6032 13.9594 14.0001 15.5625 12.0407 15.5625Z",fill:"currentColor"})}),GC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z",fill:"currentColor"})}),KC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),$y=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M1 21H23L12 2L1 21ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z",fill:"currentColor"})}),Hy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M15 3H6C5.17 3 4.46 3.5 4.16 4.22L1.14 11.27C1.05 11.5 1 11.74 1 12V14C1 15.1 1.9 16 3 16H9.31L8.36 20.57L8.33 20.89C8.33 21.3 8.5 21.68 8.77 21.95L9.83 23L16.42 16.41C16.78 16.05 17 15.55 17 15V5C17 3.9 16.1 3 15 3ZM19 3V15H23V3H19Z",fill:"currentColor"})}),Gy=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M1 21H5V9H1V21ZM23 10C23 8.9 22.1 8 21 8H14.69L15.64 3.43L15.67 3.11C15.67 2.7 15.5 2.32 15.23 2.05L14.17 1L7.59 7.59C7.22 7.95 7 8.45 7 9V19C7 20.1 7.9 21 9 21H18C18.83 21 19.54 20.5 19.84 19.78L22.86 12.73C22.95 12.5 23 12.26 23 12V10Z",fill:"currentColor"})}),JC=n=>R.jsxs("svg",{viewBox:"0 0 24 24",...at(n),children:[R.jsx("path",{d:"M11 7H12.5V12.25L17 14.92L16.25 16.15L11 13V7Z",fill:"currentColor"}),R.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47997 6.47 1.99997 11.99 1.99997C17.52 1.99997 22 6.47997 22 12C22 17.52 17.52 22 11.99 22C6.47 22 2 17.52 2 12ZM4 12C4 16.42 7.58 20 12 20C16.42 20 20 16.42 20 12C20 7.57997 16.42 3.99997 12 3.99997C7.58 3.99997 4 7.57997 4 12Z",fill:"currentColor"})]}),Ky=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M13 3C8.03 3 4 7.03 4 12H1L4.89 15.89L4.96 16.03L9 12H6C6 8.13 9.13 5 13 5C16.87 5 20 8.13 20 12C20 15.87 16.87 19 13 19V21C17.97 21 22 16.97 22 12C22 7.03 17.97 3 13 3Z",fill:"currentColor"})}),ZC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M12 4V1L8 5L12 9V6C15.31 6 18 8.69 18 12C18 13.01 17.75 13.97 17.3 14.8L18.76 16.26C19.54 15.03 20 13.57 20 12C20 7.58 16.42 4 12 4ZM12 18C8.69 18 6 15.31 6 12C6 10.99 6.25 10.03 6.7 9.2L5.24 7.74C4.46 8.97 4 10.43 4 12C4 16.42 7.58 20 12 20V23L16 19L12 15V18Z",fill:"currentColor"})}),QC=n=>R.jsx("svg",{viewBox:"0 0 24 24",...at(n),children:R.jsx("path",{d:"M11 18H13V16H11V18ZM12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 12 11 11.75 11 15H13C13 12.75 16 12.5 16 10C16 7.79 14.21 6 12 6Z",fill:"currentColor"})}),Jy=n=>R.jsxs("svg",{viewBox:"0 0 16 16",...at(n),fill:"currentColor",children:[R.jsx("path",{d:"M12.6667 7.33326V12.6666H3.33333V3.33326H8.66667V1.99992H3.33333C2.6 1.99992 2 2.59992 2 3.33326V12.6666C2 13.3999 2.6 13.9999 3.33333 13.9999H12.6667C13.4 13.9999 14 13.3999 14 12.6666V7.33326H12.6667Z"}),R.jsx("path",{d:"M14.0183 1.97412L10.0699 1.97412L11.5506 3.45477L7.66668 7.33327L8.65378 8.32037L12.5377 4.44188L14.0183 5.92253V1.97412Z"})]}),YC=Object.freeze(Object.defineProperty({__proto__:null,Action:LC,Add:jC,ArrowDown:Dy,ArrowForward:Pd,ArrowLeft:Ip,ArrowRight:Uy,ArrowUp:DC,AssistantOld:NC,Attachment:Op,BotMessage:Fy,Camera:UC,Check:Rf,Close:lc,Copy:FC,Date:By,Delete:Vy,Edit:Wy,Error:Ap,Escalate:zy,FullScreen:BC,Help:QC,Location:VC,Mic:ld,MicOff:If,OpenInNew:zC,OpenLink:Jy,Play:qC,Preview:$C,Refresh:ZC,Reorder:HC,Restart:cc,Search:GC,Settings:qy,Share:KC,ThumbDown:Hy,ThumbUp:Gy,Time:JC,Touchpoint:sc,Translate:WC,Undo:Ky,Volume:cd,VolumeOff:Of,Warning:$y},Symbol.toStringTag,{value:"Module"})),XC=n=>{const{Custom:e}=n;return e!=null?R.jsx(e,{className:n.className,onClick:n.onClick}):R.jsxs("button",{className:rt("p-3 w-fit bg-background text-primary-80 rounded-outer","after:content-[''] after:rounded-outer after:absolute after:inset-0 after:pointer-events-none","hover:after:bg-primary-10",n.className),disabled:n.onClick==null,onClick:n.onClick,children:[R.jsx("span",{className:"block flex-none w-8 h-8",children:n.iconUrl==null?R.jsx(sc,{}):R.jsx("img",{src:n.iconUrl,className:"w-8 h-8"})}),n.showLabel??!1?R.jsx("span",{children:n.label}):null]})},Zy="p-3 w-10 h-10 transition-colors rounded-inner relative z-10 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent focus:outline-0",Qy="bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40",Yy="bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20",Xy="bg-accent text-secondary-80 enabled:hover:before:bg-primary-40 focus:before:bg-primary-40 enabled:active:before:bg-secondary-10 disabled:bg-accent-20",e0="bg-secondary-60 backdrop-blur-sm text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",t0="bg-background backdrop-blur-sm text-primary-80 enabled:hover:before:bg-primary-10 focus:before:bg-primary-10 enabled:active:before:bg-secondary-10 disabled:bg-secondary-20 disabled:text-primary-20",n0="bg-error-primary text-secondary-80 enabled:hover:before:bg-primary-10",eS=({type:n,Icon:e})=>R.jsx("span",{className:rt(Zy,"block",n==="main"?Qy:null,n==="ghost"?Yy:null,n==="activated"?Xy:null,n==="coverup"?e0:null,n==="overlay"?t0:null,n==="error"?n0:null),children:R.jsx(e,{})}),un=({onClick:n,type:e,label:t,className:r,Icon:a})=>{const s=n==null;return R.jsx("button",{onClick:s?void 0:n,disabled:s,"aria-label":t,className:rt(Zy,e==="main"?Qy:null,e==="ghost"?Yy:null,e==="activated"?Xy:null,e==="coverup"?e0:null,e==="overlay"?t0:null,e==="error"?n0:null,r),children:R.jsx(a,{})})};function tS(n){const e=ve.useRef(n);return e.current=n,ve.useMemo(()=>Object.freeze({get current(){return e.current}}),[])}function nS(n){const e=tS(n);ve.useEffect(()=>()=>{e.current()},[])}function rS(n,e,t,r=0){const a=ve.useRef(),s=ve.useRef(),l=ve.useRef(n),u=ve.useRef(),h=()=>{a.current&&(clearTimeout(a.current),a.current=void 0),s.current&&(clearTimeout(s.current),s.current=void 0)};return nS(h),ve.useEffect(()=>{l.current=n},e),ve.useMemo(()=>{const f=()=>{if(h(),!u.current)return;const C=u.current;u.current=void 0,l.current.apply(C.this,C.args)},v=function(...C){a.current&&clearTimeout(a.current),u.current={args:C,this:this},a.current=setTimeout(f,t),r>0&&!s.current&&(s.current=setTimeout(f,r))};return Object.defineProperties(v,{length:{value:n.length},name:{value:`${n.name||"anonymous"}__debounced__${t}`}}),v},[t,r,...e])}const iS=typeof globalThis<"u"&&typeof navigator<"u"&&typeof document<"u";function Fv(n,e,t=0){const[r,a]=ve.useState(n);return[r,rS(a,[],e,t)]}const Ws=new Map,r0=n=>{const e=matchMedia(n),t=new Set,r=()=>{for(const a of t)a(e.matches)};return e.addEventListener("change",r,{passive:!0}),{mql:e,dispatchers:t,listener:r}},aS=(n,e)=>{let t=Ws.get(n);t||(t=r0(n),Ws.set(n,t)),t.dispatchers.add(e),e(t.mql.matches)},oS=(n,e)=>{const t=Ws.get(n);if(t){const{mql:r,dispatchers:a,listener:s}=t;a.delete(e),a.size===0&&(Ws.delete(n),r.removeEventListener?r.removeEventListener("change",s):r.removeListener(s))}};function sS(n,e={}){let{initializeWithValue:t=!0}=e;iS||(t=!1);const[r,a]=ve.useState(()=>{if(t){let s=Ws.get(n);return s||(s=r0(n),Ws.set(n,s)),s.mql.matches}});return ve.useEffect(()=>(aS(n,a),()=>{oS(n,a)}),[n]),r}const i0=n=>{let e;switch(n){case"sm":e="(min-width: 640px)";break;case"md":e="(min-width: 768px)";break;case"lg":e="(min-width: 1024px)";break}return sS(e)},lS=({windowSize:n,renderCollapse:e,errorThemedCloseButton:t,speakerControls:r,collapse:a,toggleSettings:s,isSettingsOpen:l,brandIcon:u,reset:h,enabled:f})=>{const v=n==="half",C=i0("md"),x=v&&C?"overlay":"ghost";return R.jsxs("div",{className:rt("flex p-2 md:p-3 items-center justify-between gap-2",{"md:absolute md:w-fit md:flex-col md:left-0 md:transform md:-translate-x-full md:translate-y-0":n==="half","@3xl/main:absolute @3xl/main:left-0 @3xl/main:right-0 @3xl/main:top-0":n==="full"||n==="embedded"}),children:[u!=null?R.jsx("img",{className:"w-10 h-10 block flex-none",src:u,role:"presentation"}):null,R.jsx(un,{label:"Reset",type:x,className:u==null?"":"ml-auto",onClick:f?()=>{h()}:void 0,Icon:Ky}),s!=null?R.jsx(un,{className:u!=null?"":"ml-auto",Icon:qy,label:"Settings",type:l?"activated":x,onClick:f?s:void 0}):null,r!=null?R.jsx(un,{Icon:r.enabled?cd:Of,label:"Speakers",type:r.enabled?"activated":x,onClick:()=>{r.setEnabled(T=>!T)}}):null,e?R.jsx(un,{label:"Collapse",type:t??!1?"error":x,className:rt(s==null?"ml-auto":"",v?"md:-order-1":""),onClick:f?()=>{a(new Event("collapse"))}:void 0,Icon:lc}):null]})},a0=()=>R.jsxs("div",{className:rt("grow flex flex-col items-center justify-center gap-6 text-primary-80","fullscreen-error"),children:[R.jsx(sc,{className:"w-20 h-20 text-primary-20"}),R.jsxs("div",{className:"text-center",children:[R.jsx("h3",{className:"text-xl mb-2",children:"Oops!"}),R.jsx("p",{children:"Something went wrong."}),R.jsx("p",{children:"Try again later."})]})]}),Du=({k:n,className:e,style:t})=>{const r=a=>`${a}s`;return R.jsx("div",{className:rt("bg-current animate-ping absolute inset-0",e),style:{animationDelay:r(-1.5*n),animationDuration:r(1.5),...t??{}}})},uc=({className:n,style:e})=>{const t=rt("text-accent-20",n);return R.jsxs(R.Fragment,{children:[R.jsx(Du,{k:.12,className:t,style:e}),R.jsx(Du,{k:.24,className:t,style:e}),R.jsx(Du,{k:.36,className:t,style:e}),R.jsx(Du,{k:.48,className:t,style:e})]})},cS=30,Ul=17,uS=n=>n<.5?2*n*n:1-Math.pow(-2*n+2,2)/2,Mp=990,dS=300,Uu=Mp+dS,hS=({d:n})=>{const e=Math.PI/2,t=n/Ul/2.8,r=e*Math.min(t,1),a=t<1?(n-Math.sin(r))/Math.cos(r)*.5:0,s=-n,l=n,u=n-Ul*Math.sin(r),h=Ul*Math.cos(r),f=u-a*Math.cos(r),v=h-a*Math.sin(r);return R.jsxs(R.Fragment,{children:[R.jsx("circle",{cx:s,cy:"0",r:Ul}),R.jsx("circle",{cx:l,cy:"0",r:Ul}),t<.45?R.jsx("path",{d:`
            M${-u},${h} 
            C${-f},${v} ${f},${v} ${u},${h} L${u},${-h}
            C${f},${-v} ${-f},${-v} ${-u},${-h} Z
          `}):null]})},pS=n=>n<1/3?n*3:n<2/3?1:3-n*3,Bv=n=>n<1/3?0:n<2/3?(n-1/3)*3:1,o0=()=>{const[n,e]=ve.useState(null),t=ve.useRef(!1);if(ve.useEffect(()=>{const C=x=>{e(T=>T==null?{start:x,current:x}:{...T,current:x}),t.current||requestAnimationFrame(C)};t.current||requestAnimationFrame(C)},[t,e]),n==null)return null;let r,a;const s=n.current-n.start,l=s%Uu,u=Math.floor(s/Uu);if(l<Mp){const C=s/Uu,x=Math.floor(C),T=uS((C-x)*(Uu/Mp));r=pS(T),a=u%2?Bv(T):1+Bv(T)}else r=0,a=0;const h=r>.2?0:5*(.2-r)/.2,f=.3,v=r>f?1-.25*(r-f)/(1-f):1;return R.jsx("svg",{viewBox:"0 0 100 100",stroke:"none",fill:"currentColor",style:{filter:`drop-shadow(0 0 ${h}px var(--accent))`},children:R.jsx("g",{transform:`translate(50 50) rotate(${a*90})`,opacity:v,children:R.jsx(hS,{d:cS*r})})})},s0=({label:n,className:e})=>R.jsx("div",{className:rt("h-full w-full flex items-center justify-center",e),children:R.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[R.jsx("div",{className:rt("w-8 h-8 block text-accent"),children:R.jsx(o0,{})}),n!=null?R.jsx("p",{className:"text-primary-60 max-w-sm text-center",children:n}):null]})}),ia=({onClick:n,label:e,type:t="ghost",Icon:r,className:a})=>R.jsxs("button",{onClick:n,disabled:n==null,className:rt("relative z-10 w-full px-5 py-4 transition-colors rounded-outer flex justify-between items-center focus:outline-0 overflow-hidden before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",{"bg-primary-80 text-secondary-80 enabled:hover:before:bg-primary-80 focus:before:bg-primary-80 enabled:active:before:bg-secondary-10 disabled:bg-primary-10 disabled:text-secondary-40":t==="main","bg-primary-5 text-primary-80 enabled:hover:before:bg-primary-5 focus:before:bg-primary-5 enabled:active:before:bg-secondary-10 disabled:bg-primary-5 disabled:text-primary-20":t==="ghost"},a),children:[e,R.jsx(r,{size:16})]});function fS(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if(r!=="default"&&!(r in n)){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(n)}var mS=Object.defineProperty,gS=(n,e,t)=>e in n?mS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Vv=(n,e,t)=>gS(n,typeof e!="symbol"?e+"":e,t);class Qn{constructor(){Vv(this,"_locking"),Vv(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(a=>e=()=>{this._locks-=1,a()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),r}}function Kt(n,e){if(!n)throw new Error(e)}const vS=34028234663852886e22,bS=-34028234663852886e22,yS=4294967295,wS=2147483647,kS=-2147483648;function $u(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>wS||n<kS)throw new Error("invalid int 32: "+n)}function Lp(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>yS||n<0)throw new Error("invalid uint 32: "+n)}function l0(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>vS||n<bS))throw new Error("invalid float 32: "+n)}const c0=Symbol("@bufbuild/protobuf/enum-type");function CS(n){const e=n[c0];return Kt(e,"missing enum type on enum object"),e}function u0(n,e,t,r){n[c0]=d0(e,t.map(a=>({no:a.no,name:a.name,localName:n[a.no]})))}function d0(n,e,t){const r=Object.create(null),a=Object.create(null),s=[];for(const l of e){const u=h0(l);s.push(u),r[l.name]=u,a[l.no]=u}return{typeName:n,values:s,findName(l){return r[l]},findNumber(l){return a[l]}}}function SS(n,e,t){const r={};for(const a of e){const s=h0(a);r[s.localName]=s.no,r[s.no]=s.localName}return u0(r,n,e),r}function h0(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class Af{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const r=this.getType(),a=r.runtime.bin,s=a.makeReadOptions(t);return a.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,t){const r=this.getType(),a=r.runtime.json,s=a.makeReadOptions(t);return a.readMessage(r,e,s,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(a){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(a instanceof Error?a.message:String(a)))}return this.fromJson(r,t)}toBinary(e){const t=this.getType(),r=t.runtime.bin,a=r.makeWriteOptions(e),s=a.writerFactory();return r.writeMessage(this,s,a),s.finish()}toJson(e){const t=this.getType(),r=t.runtime.json,a=r.makeWriteOptions(e);return r.writeMessage(this,a)}toJsonString(e){var t;const r=this.toJson(e);return JSON.stringify(r,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function TS(n,e,t,r){var a;const s=(a=r==null?void 0:r.localName)!==null&&a!==void 0?a:e.substring(e.lastIndexOf(".")+1),l={[s]:function(u){n.util.initFields(this),n.util.initPartial(u,this)}}[s];return Object.setPrototypeOf(l.prototype,new Af),Object.assign(l,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(u,h){return new l().fromBinary(u,h)},fromJson(u,h){return new l().fromJson(u,h)},fromJsonString(u,h){return new l().fromJsonString(u,h)},equals(u,h){return n.util.equals(l,u,h)}}),l}function xS(){let n=0,e=0;for(let r=0;r<28;r+=7){let a=this.buf[this.pos++];if(n|=(a&127)<<r,(a&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let a=this.buf[this.pos++];if(e|=(a&127)<<r,(a&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function sp(n,e,t){for(let s=0;s<28;s=s+7){const l=n>>>s,u=!(!(l>>>7)&&e==0),h=(u?l|128:l)&255;if(t.push(h),!u)return}const r=n>>>28&15|(e&7)<<4,a=e>>3!=0;if(t.push((a?r|128:r)&255),!!a){for(let s=3;s<31;s=s+7){const l=e>>>s,u=!!(l>>>7),h=(u?l|128:l)&255;if(t.push(h),!u)return}t.push(e>>>31&1)}}const Hu=4294967296;function Wv(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let r=0,a=0;function s(l,u){const h=Number(n.slice(l,u));a*=t,r=r*t+h,r>=Hu&&(a=a+(r/Hu|0),r=r%Hu)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?f0(r,a):Mf(r,a)}function ES(n,e){let t=Mf(n,e);const r=t.hi&2147483648;r&&(t=f0(t.lo,t.hi));const a=p0(t.lo,t.hi);return r?"-"+a:a}function p0(n,e){if({lo:n,hi:e}=PS(n,e),e<=2097151)return String(Hu*e+n);const t=n&16777215,r=(n>>>24|e<<8)&16777215,a=e>>16&65535;let s=t+r*6777216+a*6710656,l=r+a*8147497,u=a*2;const h=1e7;return s>=h&&(l+=Math.floor(s/h),s%=h),l>=h&&(u+=Math.floor(l/h),l%=h),u.toString()+zv(l)+zv(s)}function PS(n,e){return{lo:n>>>0,hi:e>>>0}}function Mf(n,e){return{lo:n|0,hi:e|0}}function f0(n,e){return e=~e,n?n=~n+1:e+=1,Mf(n,e)}const zv=n=>{const e=String(n);return"0000000".slice(e.length)+e};function qv(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function _S(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function RS(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof tv!="object"||tv.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),a=BigInt("9223372036854775807"),s=BigInt("0"),l=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(u){const h=typeof u=="bigint"?u:BigInt(u);if(h>a||h<r)throw new Error("int64 invalid: ".concat(u));return h},uParse(u){const h=typeof u=="bigint"?u:BigInt(u);if(h>l||h<s)throw new Error("uint64 invalid: ".concat(u));return h},enc(u){return n.setBigInt64(0,this.parse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(u){return n.setBigInt64(0,this.uParse(u),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(u,h){return n.setInt32(0,u,!0),n.setInt32(4,h,!0),n.getBigInt64(0,!0)},uDec(u,h){return n.setInt32(0,u,!0),n.setInt32(4,h,!0),n.getBigUint64(0,!0)}}}const e=r=>Kt(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),t=r=>Kt(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),e(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),t(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),e(r),Wv(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),t(r),Wv(r)},dec(r,a){return ES(r,a)},uDec(r,a){return p0(r,a)}}}const Ut=RS();var ge;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(ge||(ge={}));var Ba;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(Ba||(Ba={}));function Ia(n,e,t){if(e===t)return!0;if(n==ge.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}switch(n){case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return e==t}return!1}function zs(n,e){switch(n){case ge.BOOL:return!1;case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return e==0?Ut.zero:"0";case ge.DOUBLE:case ge.FLOAT:return 0;case ge.BYTES:return new Uint8Array(0);case ge.STRING:return"";default:return 0}}function m0(n,e){switch(n){case ge.BOOL:return e===!1;case ge.STRING:return e==="";case ge.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Xt;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Xt||(Xt={}));class IS{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let a=0;a<this.chunks.length;a++)e+=this.chunks[a].length;let t=new Uint8Array(e),r=0;for(let a=0;a<this.chunks.length;a++)t.set(this.chunks[a],r),r+=this.chunks[a].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Lp(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return $u(e),qv(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){l0(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Lp(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){$u(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return $u(e),e=(e<<1^e>>31)>>>0,qv(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),a=Ut.enc(e);return r.setInt32(0,a.lo,!0),r.setInt32(4,a.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),a=Ut.uEnc(e);return r.setInt32(0,a.lo,!0),r.setInt32(4,a.hi,!0),this.raw(t)}int64(e){let t=Ut.enc(e);return sp(t.lo,t.hi,this.buf),this}sint64(e){let t=Ut.enc(e),r=t.hi>>31,a=t.lo<<1^r,s=(t.hi<<1|t.lo>>>31)^r;return sp(a,s,this.buf),this}uint64(e){let t=Ut.uEnc(e);return sp(t.lo,t.hi,this.buf),this}}class OS{constructor(e,t){this.varint64=xS,this.uint32=_S,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case Xt.Varint:for(;this.buf[this.pos++]&128;);break;case Xt.Bit64:this.pos+=4;case Xt.Bit32:this.pos+=4;break;case Xt.LengthDelimited:let a=this.uint32();this.pos+=a;break;case Xt.StartGroup:for(;;){const[s,l]=this.tag();if(l===Xt.EndGroup){if(t!==void 0&&s!==t)throw new Error("invalid end group tag");break}this.skip(l,s)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ut.dec(...this.varint64())}uint64(){return Ut.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,Ut.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ut.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ut.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function AS(n,e,t,r){let a;return{typeName:e,extendee:t,get field(){if(!a){const s=typeof r=="function"?r():r;s.name=e.split(".").pop(),s.jsonName="[".concat(e,"]"),a=n.util.newFieldList([s]).list()[0]}return a},runtime:n}}function g0(n){const e=n.field.localName,t=Object.create(null);return t[e]=MS(n),[t,()=>t[e]]}function MS(n){const e=n.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return zs(e.T,e.L);case"message":const t=e.T,r=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function LS(n,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=n.length-1;t>=0;--t)if(n[t].no==e.no)return[n[t]];return[]}return n.filter(t=>t.no===e.no)}let Xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),_d=[];for(let n=0;n<Xi.length;n++)_d[Xi[n].charCodeAt(0)]=n;_d[45]=Xi.indexOf("+");_d[95]=Xi.indexOf("/");const v0={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,a=0,s,l=0;for(let u=0;u<n.length;u++){if(s=_d[n.charCodeAt(u)],s===void 0)switch(n[u]){case"=":a=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:l=s,a=1;break;case 1:t[r++]=l<<2|(s&48)>>4,l=s,a=2;break;case 2:t[r++]=(l&15)<<4|(s&60)>>2,l=s,a=3;break;case 3:t[r++]=(l&3)<<6|s,a=0;break}}if(a==1)throw Error("invalid base64 string.");return t.subarray(0,r)},enc(n){let e="",t=0,r,a=0;for(let s=0;s<n.length;s++)switch(r=n[s],t){case 0:e+=Xi[r>>2],a=(r&3)<<4,t=1;break;case 1:e+=Xi[a|r>>4],a=(r&15)<<2,t=2;break;case 2:e+=Xi[a|r>>6],e+=Xi[r&63],t=0;break}return t&&(e+=Xi[a],e+="=",t==1&&(e+="=")),e}};function NS(n,e,t){y0(e,n);const r=e.runtime.bin.makeReadOptions(t),a=LS(n.getType().runtime.bin.listUnknownFields(n),e.field),[s,l]=g0(e);for(const u of a)e.runtime.bin.readField(s,r.readerFactory(u.data),e.field,u.wireType,r);return l()}function jS(n,e,t,r){y0(e,n);const a=e.runtime.bin.makeReadOptions(r),s=e.runtime.bin.makeWriteOptions(r);if(b0(n,e)){const f=n.getType().runtime.bin.listUnknownFields(n).filter(v=>v.no!=e.field.no);n.getType().runtime.bin.discardUnknownFields(n);for(const v of f)n.getType().runtime.bin.onUnknownField(n,v.no,v.wireType,v.data)}const l=s.writerFactory();let u=e.field;!u.opt&&!u.repeated&&(u.kind=="enum"||u.kind=="scalar")&&(u=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(u,t,l,s);const h=a.readerFactory(l.finish());for(;h.pos<h.len;){const[f,v]=h.tag(),C=h.skip(v,f);n.getType().runtime.bin.onUnknownField(n,f,v,C)}}function b0(n,e){const t=n.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(n).find(r=>r.no==e.field.no)}function y0(n,e){Kt(n.extendee.typeName==e.getType().typeName,"extension ".concat(n.typeName," can only be applied to message ").concat(n.extendee.typeName))}function w0(n,e){const t=n.localName;if(n.repeated)return e[t].length>0;if(n.oneof)return e[n.oneof.localName].case===t;switch(n.kind){case"enum":case"scalar":return n.opt||n.req?e[t]!==void 0:n.kind=="enum"?e[t]!==n.T.values[0].no:!m0(n.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function $v(n,e){const t=n.localName,r=!n.opt&&!n.req;if(n.repeated)e[t]=[];else if(n.oneof)e[n.oneof.localName]={case:void 0};else switch(n.kind){case"map":e[t]={};break;case"enum":e[t]=r?n.T.values[0].no:void 0;break;case"scalar":e[t]=r?zs(n.T,n.L):void 0;break;case"message":e[t]=void 0;break}}function ea(n,e){if(n===null||typeof n!="object"||!Object.getOwnPropertyNames(Af.prototype).every(r=>r in n&&typeof n[r]=="function"))return!1;const t=n.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function k0(n,e){return ea(e)||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}ge.DOUBLE,ge.FLOAT,ge.INT64,ge.UINT64,ge.INT32,ge.UINT32,ge.BOOL,ge.STRING,ge.BYTES;const Hv={ignoreUnknownFields:!1},Gv={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function DS(n){return n?Object.assign(Object.assign({},Hv),n):Hv}function US(n){return n?Object.assign(Object.assign({},Gv),n):Gv}const ud=Symbol(),Gu=Symbol();function FS(){return{makeReadOptions:DS,makeWriteOptions:US,readMessage(n,e,t,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(Pi(e)));r=r??new n;const a=new Map,s=t.typeRegistry;for(const[l,u]of Object.entries(e)){const h=n.fields.findJsonName(l);if(h){if(h.oneof){if(u===null&&h.kind=="scalar")continue;const f=a.get(h.oneof);if(f!==void 0)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(h.oneof.name,'" present: "').concat(f,'", "').concat(l,'"'));a.set(h.oneof,l)}Kv(r,u,h,t,n)}else{let f=!1;if(s!=null&&s.findExtension&&l.startsWith("[")&&l.endsWith("]")){const v=s.findExtension(l.substring(1,l.length-1));if(v&&v.extendee.typeName==n.typeName){f=!0;const[C,x]=g0(v);Kv(C,u,v.field,t,v),jS(r,v,x(),t)}}if(!f&&!t.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(l,'" is unknown'))}}return r},writeMessage(n,e){const t=n.getType(),r={};let a;try{for(a of t.fields.byNumber()){if(!w0(a,n)){if(a.req)throw"required field not set";if(!e.emitDefaultValues||!VS(a))continue}const l=a.oneof?n[a.oneof.localName].value:n[a.localName],u=Jv(a,l,e);u!==void 0&&(r[e.useProtoFieldName?a.name:a.jsonName]=u)}const s=e.typeRegistry;if(s!=null&&s.findExtensionFor)for(const l of t.runtime.bin.listUnknownFields(n)){const u=s.findExtensionFor(t.typeName,l.no);if(u&&b0(n,u)){const h=NS(n,u,e),f=Jv(u.field,h,e);f!==void 0&&(r[u.field.jsonName]=f)}}}catch(s){const l=a?"cannot encode field ".concat(t.typeName,".").concat(a.name," to JSON"):"cannot encode message ".concat(t.typeName," to JSON"),u=s instanceof Error?s.message:String(s);throw new Error(l+(u.length>0?": ".concat(u):""))}return r},readScalar(n,e,t){return Yl(n,e,t??Ba.BIGINT,!0)},writeScalar(n,e,t){if(e!==void 0&&(t||m0(n,e)))return Ku(n,e)},debug:Pi}}function Pi(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function Kv(n,e,t,r,a){let s=t.localName;if(t.repeated){if(Kt(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Pi(e)));const l=n[s];for(const u of e){if(u===null)throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Pi(u)));switch(t.kind){case"message":l.push(t.T.fromJson(u,r));break;case"enum":const h=lp(t.T,u,r.ignoreUnknownFields,!0);h!==Gu&&l.push(h);break;case"scalar":try{l.push(Yl(t.T,u,t.L,!0))}catch(f){let v="cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Pi(u));throw f instanceof Error&&f.message.length>0&&(v+=": ".concat(f.message)),new Error(v)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Pi(e)));const l=n[s];for(const[u,h]of Object.entries(e)){if(h===null)throw new Error("cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: map value null"));let f;try{f=BS(t.K,u)}catch(v){let C="cannot decode map key for field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Pi(e));throw v instanceof Error&&v.message.length>0&&(C+=": ".concat(v.message)),new Error(C)}switch(t.V.kind){case"message":l[f]=t.V.T.fromJson(h,r);break;case"enum":const v=lp(t.V.T,h,r.ignoreUnknownFields,!0);v!==Gu&&(l[f]=v);break;case"scalar":try{l[f]=Yl(t.V.T,h,Ba.BIGINT,!0)}catch(C){let x="cannot decode map value for field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Pi(e));throw C instanceof Error&&C.message.length>0&&(x+=": ".concat(C.message)),new Error(x)}break}}}else switch(t.oneof&&(n=n[t.oneof.localName]={case:s},s="value"),t.kind){case"message":const l=t.T;if(e===null&&l.typeName!="google.protobuf.Value")return;let u=n[s];ea(u)?u.fromJson(e,r):(n[s]=u=l.fromJson(e,r),l.fieldWrapper&&!t.oneof&&(n[s]=l.fieldWrapper.unwrapField(u)));break;case"enum":const h=lp(t.T,e,r.ignoreUnknownFields,!1);switch(h){case ud:$v(t,n);break;case Gu:break;default:n[s]=h;break}break;case"scalar":try{const f=Yl(t.T,e,t.L,!1);switch(f){case ud:$v(t,n);break;default:n[s]=f;break}}catch(f){let v="cannot decode field ".concat(a.typeName,".").concat(t.name," from JSON: ").concat(Pi(e));throw f instanceof Error&&f.message.length>0&&(v+=": ".concat(f.message)),new Error(v)}break}}function BS(n,e){if(n===ge.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Yl(n,e,Ba.BIGINT,!0).toString()}function Yl(n,e,t,r){if(e===null)return r?zs(n,t):ud;switch(n){case ge.DOUBLE:case ge.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const a=Number(e);if(Number.isNaN(a)||!Number.isFinite(a))break;return n==ge.FLOAT&&l0(a),a;case ge.INT32:case ge.FIXED32:case ge.SFIXED32:case ge.SINT32:case ge.UINT32:let s;if(typeof e=="number"?s=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(s=Number(e)),s===void 0)break;return n==ge.UINT32||n==ge.FIXED32?Lp(s):$u(s),s;case ge.INT64:case ge.SFIXED64:case ge.SINT64:if(typeof e!="number"&&typeof e!="string")break;const l=Ut.parse(e);return t?l.toString():l;case ge.FIXED64:case ge.UINT64:if(typeof e!="number"&&typeof e!="string")break;const u=Ut.uParse(e);return t?u.toString():u;case ge.BOOL:if(typeof e!="boolean")break;return e;case ge.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case ge.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return v0.dec(e)}throw new Error}function lp(n,e,t,r){if(e===null)return n.typeName=="google.protobuf.NullValue"?0:r?n.values[0].no:ud;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const a=n.findName(e);if(a!==void 0)return a.no;if(t)return Gu;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(Pi(e)))}function VS(n){return n.repeated||n.kind=="map"?!0:!(n.oneof||n.kind=="message"||n.opt||n.req)}function Jv(n,e,t){if(n.kind=="map"){Kt(typeof e=="object"&&e!=null);const r={},a=Object.entries(e);switch(n.V.kind){case"scalar":for(const[l,u]of a)r[l.toString()]=Ku(n.V.T,u);break;case"message":for(const[l,u]of a)r[l.toString()]=u.toJson(t);break;case"enum":const s=n.V.T;for(const[l,u]of a)r[l.toString()]=cp(s,u,t.enumAsInteger);break}return t.emitDefaultValues||a.length>0?r:void 0}if(n.repeated){Kt(Array.isArray(e));const r=[];switch(n.kind){case"scalar":for(let a=0;a<e.length;a++)r.push(Ku(n.T,e[a]));break;case"enum":for(let a=0;a<e.length;a++)r.push(cp(n.T,e[a],t.enumAsInteger));break;case"message":for(let a=0;a<e.length;a++)r.push(e[a].toJson(t));break}return t.emitDefaultValues||r.length>0?r:void 0}switch(n.kind){case"scalar":return Ku(n.T,e);case"enum":return cp(n.T,e,t.enumAsInteger);case"message":return k0(n.T,e).toJson(t)}}function cp(n,e,t){var r;if(Kt(typeof e=="number"),n.typeName=="google.protobuf.NullValue")return null;if(t)return e;const a=n.findNumber(e);return(r=a==null?void 0:a.name)!==null&&r!==void 0?r:e}function Ku(n,e){switch(n){case ge.INT32:case ge.SFIXED32:case ge.SINT32:case ge.FIXED32:case ge.UINT32:return Kt(typeof e=="number"),e;case ge.FLOAT:case ge.DOUBLE:return Kt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case ge.STRING:return Kt(typeof e=="string"),e;case ge.BOOL:return Kt(typeof e=="boolean"),e;case ge.UINT64:case ge.FIXED64:case ge.INT64:case ge.SFIXED64:case ge.SINT64:return Kt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case ge.BYTES:return Kt(e instanceof Uint8Array),v0.enc(e)}}const Ps=Symbol("@bufbuild/protobuf/unknown-fields"),Zv={readUnknownFields:!0,readerFactory:n=>new OS(n)},Qv={writeUnknownFields:!0,writerFactory:()=>new IS};function WS(n){return n?Object.assign(Object.assign({},Zv),n):Zv}function zS(n){return n?Object.assign(Object.assign({},Qv),n):Qv}function qS(){return{makeReadOptions:WS,makeWriteOptions:zS,listUnknownFields(n){var e;return(e=n[Ps])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[Ps]},writeUnknownFields(n,e){const t=n[Ps];if(t)for(const r of t)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(n,e,t,r){const a=n;Array.isArray(a[Ps])||(a[Ps]=[]),a[Ps].push({no:e,wireType:t,data:r})},readMessage(n,e,t,r,a){const s=n.getType(),l=a?e.len:e.pos+t;let u,h;for(;e.pos<l&&([u,h]=e.tag(),!(a===!0&&h==Xt.EndGroup));){const f=s.fields.find(u);if(!f){const v=e.skip(h,u);r.readUnknownFields&&this.onUnknownField(n,u,h,v);continue}Yv(n,e,f,h,r)}if(a&&(h!=Xt.EndGroup||u!==t))throw new Error("invalid end group tag")},readField:Yv,writeMessage(n,e,t){const r=n.getType();for(const a of r.fields.byNumber()){if(!w0(a,n)){if(a.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(a.name," to binary: required field not set"));continue}const s=a.oneof?n[a.oneof.localName].value:n[a.localName];Xv(a,s,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e},writeField(n,e,t,r){e!==void 0&&Xv(n,e,t,r)}}}function Yv(n,e,t,r,a){let{repeated:s,localName:l}=t;switch(t.oneof&&(n=n[t.oneof.localName],n.case!=l&&delete n.value,n.case=l,l="value"),t.kind){case"scalar":case"enum":const u=t.kind=="enum"?ge.INT32:t.T;let h=dd;if(t.kind=="scalar"&&t.L>0&&(h=HS),s){let x=n[l];if(r==Xt.LengthDelimited&&u!=ge.STRING&&u!=ge.BYTES){let T=e.uint32()+e.pos;for(;e.pos<T;)x.push(h(e,u))}else x.push(h(e,u))}else n[l]=h(e,u);break;case"message":const f=t.T;s?n[l].push(Ju(e,new f,a,t)):ea(n[l])?Ju(e,n[l],a,t):(n[l]=Ju(e,new f,a,t),f.fieldWrapper&&!t.oneof&&!t.repeated&&(n[l]=f.fieldWrapper.unwrapField(n[l])));break;case"map":let[v,C]=$S(t,e,a);n[l][v]=C;break}}function Ju(n,e,t,r){const a=e.getType().runtime.bin,s=r==null?void 0:r.delimited;return a.readMessage(e,n,s?r.no:n.uint32(),t,s),e}function $S(n,e,t){const r=e.uint32(),a=e.pos+r;let s,l;for(;e.pos<a;){const[u]=e.tag();switch(u){case 1:s=dd(e,n.K);break;case 2:switch(n.V.kind){case"scalar":l=dd(e,n.V.T);break;case"enum":l=e.int32();break;case"message":l=Ju(e,new n.V.T,t,void 0);break}break}}if(s===void 0&&(s=zs(n.K,Ba.BIGINT)),typeof s!="string"&&typeof s!="number"&&(s=s.toString()),l===void 0)switch(n.V.kind){case"scalar":l=zs(n.V.T,Ba.BIGINT);break;case"enum":l=n.V.T.values[0].no;break;case"message":l=new n.V.T;break}return[s,l]}function HS(n,e){const t=dd(n,e);return typeof t=="bigint"?t.toString():t}function dd(n,e){switch(e){case ge.STRING:return n.string();case ge.BOOL:return n.bool();case ge.DOUBLE:return n.double();case ge.FLOAT:return n.float();case ge.INT32:return n.int32();case ge.INT64:return n.int64();case ge.UINT64:return n.uint64();case ge.FIXED64:return n.fixed64();case ge.BYTES:return n.bytes();case ge.FIXED32:return n.fixed32();case ge.SFIXED32:return n.sfixed32();case ge.SFIXED64:return n.sfixed64();case ge.SINT64:return n.sint64();case ge.UINT32:return n.uint32();case ge.SINT32:return n.sint32()}}function Xv(n,e,t,r){Kt(e!==void 0);const a=n.repeated;switch(n.kind){case"scalar":case"enum":let s=n.kind=="enum"?ge.INT32:n.T;if(a)if(Kt(Array.isArray(e)),n.packed)KS(t,s,n.no,e);else for(const l of e)Xl(t,s,n.no,l);else Xl(t,s,n.no,e);break;case"message":if(a){Kt(Array.isArray(e));for(const l of e)eb(t,r,n,l)}else eb(t,r,n,e);break;case"map":Kt(typeof e=="object"&&e!=null);for(const[l,u]of Object.entries(e))GS(t,r,n,l,u);break}}function GS(n,e,t,r,a){n.tag(t.no,Xt.LengthDelimited),n.fork();let s=r;switch(t.K){case ge.INT32:case ge.FIXED32:case ge.UINT32:case ge.SFIXED32:case ge.SINT32:s=Number.parseInt(r);break;case ge.BOOL:Kt(r=="true"||r=="false"),s=r=="true";break}switch(Xl(n,t.K,1,s),t.V.kind){case"scalar":Xl(n,t.V.T,2,a);break;case"enum":Xl(n,ge.INT32,2,a);break;case"message":Kt(a!==void 0),n.tag(2,Xt.LengthDelimited).bytes(a.toBinary(e));break}n.join()}function eb(n,e,t,r){const a=k0(t.T,r);t.delimited?n.tag(t.no,Xt.StartGroup).raw(a.toBinary(e)).tag(t.no,Xt.EndGroup):n.tag(t.no,Xt.LengthDelimited).bytes(a.toBinary(e))}function Xl(n,e,t,r){Kt(r!==void 0);let[a,s]=C0(e);n.tag(t,a)[s](r)}function KS(n,e,t,r){if(!r.length)return;n.tag(t,Xt.LengthDelimited).fork();let[,a]=C0(e);for(let s=0;s<r.length;s++)n[a](r[s]);n.join()}function C0(n){let e=Xt.Varint;switch(n){case ge.BYTES:case ge.STRING:e=Xt.LengthDelimited;break;case ge.DOUBLE:case ge.FIXED64:case ge.SFIXED64:e=Xt.Bit64;break;case ge.FIXED32:case ge.SFIXED32:case ge.FLOAT:e=Xt.Bit32;break}const t=ge[n].toLowerCase();return[e,t]}function JS(){return{setEnumType:u0,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const r of t.fields.byMember()){const a=r.localName,s=e,l=n;if(l[a]!=null)switch(r.kind){case"oneof":const u=l[a].case;if(u===void 0)continue;const h=r.findField(u);let f=l[a].value;h&&h.kind=="message"&&!ea(f,h.T)?f=new h.T(f):h&&h.kind==="scalar"&&h.T===ge.BYTES&&(f=Fl(f)),s[a]={case:u,value:f};break;case"scalar":case"enum":let v=l[a];r.T===ge.BYTES&&(v=r.repeated?v.map(Fl):Fl(v)),s[a]=v;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===ge.BYTES)for(const[T,N]of Object.entries(l[a]))s[a][T]=Fl(N);else Object.assign(s[a],l[a]);break;case"message":const x=r.V.T;for(const T of Object.keys(l[a])){let N=l[a][T];x.fieldWrapper||(N=new x(N)),s[a][T]=N}break}break;case"message":const C=r.T;if(r.repeated)s[a]=l[a].map(x=>ea(x,C)?x:new C(x));else{const x=l[a];C.fieldWrapper?C.typeName==="google.protobuf.BytesValue"?s[a]=Fl(x):s[a]=x:s[a]=ea(x,C)?x:new C(x)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(r=>{const a=e[r.localName],s=t[r.localName];if(r.repeated){if(a.length!==s.length)return!1;switch(r.kind){case"message":return a.every((l,u)=>r.T.equals(l,s[u]));case"scalar":return a.every((l,u)=>Ia(r.T,l,s[u]));case"enum":return a.every((l,u)=>Ia(ge.INT32,l,s[u]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":let l=a,u=s;return r.T.fieldWrapper&&(l!==void 0&&!ea(l)&&(l=r.T.fieldWrapper.wrapField(l)),u!==void 0&&!ea(u)&&(u=r.T.fieldWrapper.wrapField(u))),r.T.equals(l,u);case"enum":return Ia(ge.INT32,a,s);case"scalar":return Ia(r.T,a,s);case"oneof":if(a.case!==s.case)return!1;const h=r.findField(a.case);if(h===void 0)return!0;switch(h.kind){case"message":return h.T.equals(a.value,s.value);case"enum":return Ia(ge.INT32,a.value,s.value);case"scalar":return Ia(h.T,a.value,s.value)}throw new Error("oneof cannot contain ".concat(h.kind));case"map":const f=Object.keys(a).concat(Object.keys(s));switch(r.V.kind){case"message":const v=r.V.T;return f.every(x=>v.equals(a[x],s[x]));case"enum":return f.every(x=>Ia(ge.INT32,a[x],s[x]));case"scalar":const C=r.V.T;return f.every(x=>Ia(C,a[x],s[x]))}break}})},clone(n){const e=n.getType(),t=new e,r=t;for(const a of e.fields.byMember()){const s=n[a.localName];let l;if(a.repeated)l=s.map(Fu);else if(a.kind=="map"){l=r[a.localName];for(const[u,h]of Object.entries(s))l[u]=Fu(h)}else a.kind=="oneof"?l=a.findField(s.case)?{case:s.case,value:Fu(s.value)}:{case:void 0}:l=Fu(s);r[a.localName]=l}for(const a of e.runtime.bin.listUnknownFields(n))e.runtime.bin.onUnknownField(r,a.no,a.wireType,a.data);return t}}}function Fu(n){if(n===void 0)return n;if(ea(n))return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function Fl(n){return n instanceof Uint8Array?n:new Uint8Array(n)}function ZS(n,e,t){return{syntax:n,json:FS(),bin:qS(),util:Object.assign(Object.assign({},JS()),{newFieldList:e,initFields:t}),makeMessageType(r,a,s){return TS(this,r,a,s)},makeEnum:SS,makeEnumType:d0,getEnumType:CS,makeExtension(r,a,s){return AS(this,r,a,s)}}}class QS{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const r of this.list())t[r.jsonName]=t[r.name]=r;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const r of this.list())t[r.no]=r;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}}function S0(n,e){const t=T0(n);return e?t:rT(nT(t))}function YS(n){return S0(n,!1)}const XS=T0;function T0(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let a=n.charAt(r);switch(a){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(a),e=!1;break;default:e&&(e=!1,a=a.toUpperCase()),t.push(a);break}}return t.join("")}const eT=new Set(["constructor","toString","toJSON","valueOf"]),tT=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),x0=n=>"".concat(n,"$"),nT=n=>tT.has(n)?x0(n):n,rT=n=>eT.has(n)?x0(n):n;class iT{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=YS(e)}addField(e){Kt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function aT(n,e){var t,r,a,s,l,u;const h=[];let f;for(const v of typeof n=="function"?n():n){const C=v;if(C.localName=S0(v.name,v.oneof!==void 0),C.jsonName=(t=v.jsonName)!==null&&t!==void 0?t:XS(v.name),C.repeated=(r=v.repeated)!==null&&r!==void 0?r:!1,v.kind=="scalar"&&(C.L=(a=v.L)!==null&&a!==void 0?a:Ba.BIGINT),C.delimited=(s=v.delimited)!==null&&s!==void 0?s:!1,C.req=(l=v.req)!==null&&l!==void 0?l:!1,C.opt=(u=v.opt)!==null&&u!==void 0?u:!1,v.packed===void 0&&(C.packed=v.kind=="enum"||v.kind=="scalar"&&v.T!=ge.BYTES&&v.T!=ge.STRING),v.oneof!==void 0){const x=typeof v.oneof=="string"?v.oneof:v.oneof.name;(!f||f.name!=x)&&(f=new iT(x)),C.oneof=f,f.addField(C)}h.push(C)}return h}const re=ZS("proto3",n=>new QS(n,e=>aT(e)),n=>{for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,r=n;if(e.repeated){r[t]=[];continue}switch(e.kind){case"oneof":r[t]={case:void 0};break;case"enum":r[t]=0;break;case"map":r[t]={};break;case"scalar":r[t]=zs(e.T,e.L);break}}});class ur extends Af{constructor(e){super(),this.seconds=Ut.zero,this.nanos=0,re.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(re.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const a=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(a))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(a<Date.parse("0001-01-01T00:00:00Z")||a>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ut.parse(a/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const a=(this.nanos+1e9).toString().substring(1);a.substring(3)==="000000"?r="."+a.substring(0,3)+"Z":a.substring(6)==="000"?r="."+a.substring(0,6)+"Z":r="."+a+"Z"}return new Date(t).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return ur.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new ur({seconds:Ut.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new ur().fromBinary(e,t)}static fromJson(e,t){return new ur().fromJson(e,t)}static fromJsonString(e,t){return new ur().fromJsonString(e,t)}static equals(e,t){return re.util.equals(ur,e,t)}}ur.runtime=re;ur.typeName="google.protobuf.Timestamp";ur.fields=re.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const oT=re.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ur},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:sT,repeated:!0},{no:5,name:"events",kind:"message",T:cT,repeated:!0}]),sT=re.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:lT,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),lT=re.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ur},{no:3,name:"value",kind:"scalar",T:2}]),cT=re.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:ur},{no:7,name:"normalized_end_timestamp",kind:"message",T:ur,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),E0=re.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),li=re.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),nn=re.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),Lf=re.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Gl=re.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),dc=re.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),ui=re.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),_o=re.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),uT=re.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),gn=re.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),Rd=re.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:hd,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:F0}]),hd=re.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),dT=re.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:re.getEnumType(nn),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Lo=re.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:re.getEnumType(js)},{no:4,name:"tracks",kind:"message",T:Os,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:dT},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:re.getEnumType(hc)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:re.getEnumType(ui)},{no:18,name:"kind_details",kind:"enum",T:re.getEnumType(hT),repeated:!0}]),js=re.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),hc=re.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),hT=re.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),dn=re.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),pT=re.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Da,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:re.getEnumType(P0)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Os=re.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:re.getEnumType(li)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:re.getEnumType(nn)},{no:10,name:"layers",kind:"message",T:Da,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:pT,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:re.getEnumType(dn)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:F0},{no:19,name:"audio_features",kind:"enum",T:re.getEnumType(gn),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:re.getEnumType(E0)}]),Da=re.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:re.getEnumType(Lf)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),P0=re.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Jn=re.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:re.getEnumType(lt)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:Nf,oneof:"value"},{no:3,name:"speaker",kind:"message",T:fT,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:O0,oneof:"value"},{no:7,name:"transcription",kind:"message",T:mT,oneof:"value"},{no:8,name:"metrics",kind:"message",T:oT,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:pd,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:jf,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:Df,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:Uf,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:fd,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:md,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:gd,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:_0,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),lt=re.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),_0=re.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:re.getEnumType(dn)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),R0=re.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:Nf,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:pd,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:jf,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:Df,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:Uf,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:fd,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:md,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:gd,oneof:"value"}]),fT=re.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:I0,repeated:!0}]),I0=re.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),Nf=re.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),O0=re.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),mT=re.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:gT,repeated:!0}]),gT=re.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),pd=re.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),jf=re.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),Df=re.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),Uf=re.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:A0,oneof:"value"}]),A0=re.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),M0=re.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),L0=re.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:re.getEnumType(N0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),N0=re.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),j0=re.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:re.getEnumType(D0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),D0=re.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),U0=re.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:tb},{no:2,name:"screen",kind:"message",T:tb},{no:3,name:"resume_connection",kind:"enum",T:re.getEnumType(dc)},{no:4,name:"disabled_codecs",kind:"message",T:vT},{no:5,name:"force_relay",kind:"enum",T:re.getEnumType(dc)}]),tb=re.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:re.getEnumType(dc)}]),vT=re.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:hd,repeated:!0},{no:2,name:"publish",kind:"message",T:hd,repeated:!0}]),F0=re.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),Np=re.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),B0=re.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:re.getEnumType(Np)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),V0=re.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),fd=re.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:re.getEnumType(dn)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:B0,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:V0,oneof:"content_header"}],{localName:"DataStream_Header"}),md=re.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),gd=re.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),bT=re.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),ci=re.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),jp=re.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),yT=re.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),wT=re.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Va,oneof:"message"},{no:2,name:"answer",kind:"message",T:Va,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Id,oneof:"message"},{no:4,name:"add_track",kind:"message",T:pc,oneof:"message"},{no:5,name:"mute",kind:"message",T:Od,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Ad,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:W0,oneof:"message"},{no:8,name:"leave",kind:"message",T:Md,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:q0,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:G0,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:zf,oneof:"message"},{no:13,name:"simulate",kind:"message",T:xi,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Vf,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Z0,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:Bf,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:z0,oneof:"message"}]),nb=re.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:kT,oneof:"message"},{no:2,name:"answer",kind:"message",T:Va,oneof:"message"},{no:3,name:"offer",kind:"message",T:Va,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Id,oneof:"message"},{no:5,name:"update",kind:"message",T:TT,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Ff,oneof:"message"},{no:8,name:"leave",kind:"message",T:Md,oneof:"message"},{no:9,name:"mute",kind:"message",T:Od,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:xT,oneof:"message"},{no:11,name:"room_update",kind:"message",T:ET,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:_T,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:IT,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:AT,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:LT,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:ST,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:CT,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:jT,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:FT,oneof:"message"},{no:22,name:"request_response",kind:"message",T:BT,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:VT,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:NT,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:$T,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:MT,oneof:"message"}]),Dp=re.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Da,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:re.getEnumType(P0)}]),pc=re.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:re.getEnumType(li)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:re.getEnumType(nn)},{no:9,name:"layers",kind:"message",T:Da,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Dp,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:re.getEnumType(dn)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:re.getEnumType(E0)},{no:17,name:"audio_features",kind:"enum",T:re.getEnumType(gn),repeated:!0}]),Id=re.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:re.getEnumType(ci)},{no:3,name:"final",kind:"scalar",T:8}]),Od=re.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),kT=re.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Rd},{no:2,name:"participant",kind:"message",T:Lo},{no:3,name:"other_participants",kind:"message",T:Lo,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:$0,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:U0},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:L0},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:hd,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),CT=re.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:$0,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:U0},{no:3,name:"server_info",kind:"message",T:L0},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),Ff=re.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Os}]),ST=re.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Va=re.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),TT=re.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Lo,repeated:!0}]),Ad=re.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:M0,repeated:!0}]),W0=re.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:re.getEnumType(Lf)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),Bf=re.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:re.getEnumType(gn),repeated:!0}]),z0=re.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Md=re.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:re.getEnumType(ui)},{no:3,name:"action",kind:"enum",T:re.getEnumType(Ds)},{no:4,name:"regions",kind:"message",T:DT}]),Ds=re.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),q0=re.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Da,repeated:!0}]),Vf=re.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),$0=re.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),xT=re.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:I0,repeated:!0}]),ET=re.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Rd}]),PT=re.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:re.getEnumType(Gl)},{no:3,name:"score",kind:"scalar",T:2}]),_T=re.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:PT,repeated:!0}]),RT=re.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:re.getEnumType(jp)}]),IT=re.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:RT,repeated:!0}]),Wf=re.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:re.getEnumType(Lf)},{no:2,name:"enabled",kind:"scalar",T:8}]),OT=re.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Wf,repeated:!0}]),AT=re.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Wf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:OT,repeated:!0}]),MT=re.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:bT,repeated:!0}]),H0=re.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),G0=re.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:H0,repeated:!0}]),LT=re.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),NT=re.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:Rd},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Lo},{no:4,name:"other_participants",kind:"message",T:Lo,repeated:!0}]),zf=re.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Va},{no:2,name:"subscription",kind:"message",T:Ad},{no:3,name:"publish_tracks",kind:"message",T:Ff,repeated:!0},{no:4,name:"data_channels",kind:"message",T:J0,repeated:!0},{no:5,name:"offer",kind:"message",T:Va},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:K0,repeated:!0}]),K0=re.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),J0=re.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:re.getEnumType(ci)}]),xi=re.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:re.getEnumType(yT),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Z0=re.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),jT=re.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),DT=re.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:UT,repeated:!0}]),UT=re.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),FT=re.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:re.getEnumType(uT)}]),BT=re.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:re.getEnumType(qf)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:Id,oneof:"request"},{no:5,name:"add_track",kind:"message",T:pc,oneof:"request"},{no:6,name:"mute",kind:"message",T:Od,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:Vf,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:Bf,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:z0,oneof:"request"}]),qf=re.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),VT=re.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Q0=re.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),WT=re.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:j0},{no:2,name:"connection_settings",kind:"message",T:Q0},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:pc,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:Va},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:re.getEnumType(_o)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:zf}]),zT=re.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:re.getEnumType(qT)},{no:2,name:"join_request",kind:"scalar",T:12}]),qT=re.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),$T=re.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function HT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Up={exports:{}},GT=Up.exports,rb;function KT(){return rb||(rb=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(GT,function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"],s={},l=null;function u(L,$){var V=L[$];if(typeof V.bind=="function")return V.bind(L);try{return Function.prototype.bind.call(V,L)}catch{return function(){return Function.prototype.apply.apply(V,[L,arguments])}}}function h(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function f(L){return L==="debug"&&(L="log"),typeof console===t?!1:L==="trace"&&r?h:console[L]!==void 0?u(console,L):console.log!==void 0?u(console,"log"):e}function v(){for(var L=this.getLevel(),$=0;$<a.length;$++){var V=a[$];this[V]=$<L?e:this.methodFactory(V,L,this.name)}if(this.log=this.debug,typeof console===t&&L<this.levels.SILENT)return"No console available for logging"}function C(L){return function(){typeof console!==t&&(v.call(this),this[L].apply(this,arguments))}}function x(L,$,V){return f(L)||C.apply(this,arguments)}function T(L,$){var V=this,K,F,A,U="loglevel";typeof L=="string"?U+=":"+L:typeof L=="symbol"&&(U=void 0);function Z(Y){var he=(a[Y]||"silent").toUpperCase();if(!(typeof window===t||!U)){try{window.localStorage[U]=he;return}catch{}try{window.document.cookie=encodeURIComponent(U)+"="+he+";"}catch{}}}function oe(){var Y;if(!(typeof window===t||!U)){try{Y=window.localStorage[U]}catch{}if(typeof Y===t)try{var he=window.document.cookie,Ae=encodeURIComponent(U),qe=he.indexOf(Ae+"=");qe!==-1&&(Y=/^([^;]+)/.exec(he.slice(qe+Ae.length+1))[1])}catch{}return V.levels[Y]===void 0&&(Y=void 0),Y}}function X(){if(!(typeof window===t||!U)){try{window.localStorage.removeItem(U)}catch{}try{window.document.cookie=encodeURIComponent(U)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function H(Y){var he=Y;if(typeof he=="string"&&V.levels[he.toUpperCase()]!==void 0&&(he=V.levels[he.toUpperCase()]),typeof he=="number"&&he>=0&&he<=V.levels.SILENT)return he;throw new TypeError("log.setLevel() called with invalid level: "+Y)}V.name=L,V.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},V.methodFactory=$||x,V.getLevel=function(){return A??F??K},V.setLevel=function(Y,he){return A=H(Y),he!==!1&&Z(A),v.call(V)},V.setDefaultLevel=function(Y){F=H(Y),oe()||V.setLevel(Y,!1)},V.resetLevel=function(){A=null,X(),v.call(V)},V.enableAll=function(Y){V.setLevel(V.levels.TRACE,Y)},V.disableAll=function(Y){V.setLevel(V.levels.SILENT,Y)},V.rebuild=function(){if(l!==V&&(K=H(l.getLevel())),v.call(V),l===V)for(var Y in s)s[Y].rebuild()},K=H(l?l.getLevel():"WARN");var J=oe();J!=null&&(A=H(J)),v.call(V)}l=new T,l.getLogger=function(L){if(typeof L!="symbol"&&typeof L!="string"||L==="")throw new TypeError("You must supply a name when creating a logger.");var $=s[L];return $||($=s[L]=new T(L,l.methodFactory)),$};var N=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=N),l},l.getLoggers=function(){return s},l.default=l,l})}(Up)),Up.exports}var Ld=KT(),Fp;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(Fp||(Fp={}));var di;(function(n){n.Default="livekit",n.Room="livekit-room",n.TokenSource="livekit-token-source",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(di||(di={}));let ct=Ld.getLogger("livekit");const JT=Object.values(di).map(n=>Ld.getLogger(n));ct.setDefaultLevel(Fp.info);function aa(n){const e=Ld.getLogger(n);return e.setDefaultLevel(ct.getLevel()),e}function ZT(n,e){for(const t of JT)t.setLevel(n)}const QT=Ld.getLogger("lk-e2ee"),Bl=7e3,YT=[0,300,2*2*300,3*3*300,4*4*300,Bl,Bl,Bl,Bl,Bl];class XT{constructor(e){this._retryDelays=e!==void 0?[...e]:YT}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function e2(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}function D(n,e,t,r){function a(s){return s instanceof t?s:new t(function(l){l(s)})}return new(t||(t=Promise))(function(s,l){function u(v){try{f(r.next(v))}catch(C){l(C)}}function h(v){try{f(r.throw(v))}catch(C){l(C)}}function f(v){v.done?s(v.value):a(v.value).then(u,h)}f((r=r.apply(n,e||[])).next())})}function ib(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ta(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ib=="function"?ib(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(l){return new Promise(function(u,h){l=n[s](l),a(u,h,l.done,l.value)})}}function a(s,l,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},l)}}var Bu={exports:{}},ab;function t2(){if(ab)return Bu.exports;ab=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(A,U,Z){return Function.prototype.apply.call(A,U,Z)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:t=function(A){return Object.getOwnPropertyNames(A)};function r(A){console&&console.warn&&console.warn(A)}var a=Number.isNaN||function(A){return A!==A};function s(){s.init.call(this)}Bu.exports=s,Bu.exports.once=V,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(A){if(typeof A!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(A){if(typeof A!="number"||A<0||a(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");l=A}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||a(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function h(A){return A._maxListeners===void 0?s.defaultMaxListeners:A._maxListeners}s.prototype.getMaxListeners=function(){return h(this)},s.prototype.emit=function(A){for(var U=[],Z=1;Z<arguments.length;Z++)U.push(arguments[Z]);var oe=A==="error",X=this._events;if(X!==void 0)oe=oe&&X.error===void 0;else if(!oe)return!1;if(oe){var H;if(U.length>0&&(H=U[0]),H instanceof Error)throw H;var J=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw J.context=H,J}var Y=X[A];if(Y===void 0)return!1;if(typeof Y=="function")e(Y,this,U);else for(var he=Y.length,Ae=N(Y,he),Z=0;Z<he;++Z)e(Ae[Z],this,U);return!0};function f(A,U,Z,oe){var X,H,J;if(u(Z),H=A._events,H===void 0?(H=A._events=Object.create(null),A._eventsCount=0):(H.newListener!==void 0&&(A.emit("newListener",U,Z.listener?Z.listener:Z),H=A._events),J=H[U]),J===void 0)J=H[U]=Z,++A._eventsCount;else if(typeof J=="function"?J=H[U]=oe?[Z,J]:[J,Z]:oe?J.unshift(Z):J.push(Z),X=h(A),X>0&&J.length>X&&!J.warned){J.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+String(U)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=A,Y.type=U,Y.count=J.length,r(Y)}return A}s.prototype.addListener=function(A,U){return f(this,A,U,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(A,U){return f(this,A,U,!0)};function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(A,U,Z){var oe={fired:!1,wrapFn:void 0,target:A,type:U,listener:Z},X=v.bind(oe);return X.listener=Z,oe.wrapFn=X,X}s.prototype.once=function(A,U){return u(U),this.on(A,C(this,A,U)),this},s.prototype.prependOnceListener=function(A,U){return u(U),this.prependListener(A,C(this,A,U)),this},s.prototype.removeListener=function(A,U){var Z,oe,X,H,J;if(u(U),oe=this._events,oe===void 0)return this;if(Z=oe[A],Z===void 0)return this;if(Z===U||Z.listener===U)--this._eventsCount===0?this._events=Object.create(null):(delete oe[A],oe.removeListener&&this.emit("removeListener",A,Z.listener||U));else if(typeof Z!="function"){for(X=-1,H=Z.length-1;H>=0;H--)if(Z[H]===U||Z[H].listener===U){J=Z[H].listener,X=H;break}if(X<0)return this;X===0?Z.shift():L(Z,X),Z.length===1&&(oe[A]=Z[0]),oe.removeListener!==void 0&&this.emit("removeListener",A,J||U)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(A){var U,Z,oe;if(Z=this._events,Z===void 0)return this;if(Z.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Z[A]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Z[A]),this;if(arguments.length===0){var X=Object.keys(Z),H;for(oe=0;oe<X.length;++oe)H=X[oe],H!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(U=Z[A],typeof U=="function")this.removeListener(A,U);else if(U!==void 0)for(oe=U.length-1;oe>=0;oe--)this.removeListener(A,U[oe]);return this};function x(A,U,Z){var oe=A._events;if(oe===void 0)return[];var X=oe[U];return X===void 0?[]:typeof X=="function"?Z?[X.listener||X]:[X]:Z?$(X):N(X,X.length)}s.prototype.listeners=function(A){return x(this,A,!0)},s.prototype.rawListeners=function(A){return x(this,A,!1)},s.listenerCount=function(A,U){return typeof A.listenerCount=="function"?A.listenerCount(U):T.call(A,U)},s.prototype.listenerCount=T;function T(A){var U=this._events;if(U!==void 0){var Z=U[A];if(typeof Z=="function")return 1;if(Z!==void 0)return Z.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function N(A,U){for(var Z=new Array(U),oe=0;oe<U;++oe)Z[oe]=A[oe];return Z}function L(A,U){for(;U+1<A.length;U++)A[U]=A[U+1];A.pop()}function $(A){for(var U=new Array(A.length),Z=0;Z<U.length;++Z)U[Z]=A[Z].listener||A[Z];return U}function V(A,U){return new Promise(function(Z,oe){function X(J){A.removeListener(U,H),oe(J)}function H(){typeof A.removeListener=="function"&&A.removeListener("error",X),Z([].slice.call(arguments))}F(A,U,H,{once:!0}),U!=="error"&&K(A,X,{once:!0})})}function K(A,U,Z){typeof A.on=="function"&&F(A,"error",U,Z)}function F(A,U,Z,oe){if(typeof A.on=="function")oe.once?A.once(U,Z):A.on(U,Z);else if(typeof A.addEventListener=="function")A.addEventListener(U,function X(H){oe.once&&A.removeEventListener(U,X),Z(H)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A)}return Bu.exports}var Mi=t2();let Y0=!0,X0=!0;function Kl(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function Uo(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,a=r.addEventListener;r.addEventListener=function(l,u){if(l!==e)return a.apply(this,arguments);const h=f=>{const v=t(f);v&&(u.handleEvent?u.handleEvent(v):u(v))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,h),a.apply(this,[l,h])};const s=r.removeEventListener;r.removeEventListener=function(l,u){if(l!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(u))return s.apply(this,arguments);const h=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[l,h])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(l){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),l&&this.addEventListener(e,this["_on"+e]=l)},enumerable:!0,configurable:!0})}function n2(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(Y0=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function r2(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(X0=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function e1(){if(typeof window=="object"){if(Y0)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function $f(n,e){X0&&console.warn(n+" is deprecated, please use "+e+" instead.")}function i2(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(a=>a.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Kl(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Kl(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Kl(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=Kl(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function ob(n){return Object.prototype.toString.call(n)==="[object Object]"}function t1(n){return ob(n)?Object.keys(n).reduce(function(e,t){const r=ob(n[t]),a=r?t1(n[t]):n[t],s=r&&!Object.keys(a).length;return a===void 0||s?e:Object.assign(e,{[t]:a})},{}):n}function Bp(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Bp(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(a=>{Bp(n,n.get(a),t)})}))}function sb(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",a=new Map;if(e===null)return a;const s=[];return n.forEach(l=>{l.type==="track"&&l.trackIdentifier===e.id&&s.push(l)}),s.forEach(l=>{n.forEach(u=>{u.type===r&&u.trackId===l.id&&Bp(n,u,a)})}),a}const lb=e1;function n1(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const h={};return Object.keys(u).forEach(f=>{if(f==="require"||f==="advanced"||f==="mediaSource")return;const v=typeof u[f]=="object"?u[f]:{ideal:u[f]};v.exact!==void 0&&typeof v.exact=="number"&&(v.min=v.max=v.exact);const C=function(x,T){return x?x+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(v.ideal!==void 0){h.optional=h.optional||[];let x={};typeof v.ideal=="number"?(x[C("min",f)]=v.ideal,h.optional.push(x),x={},x[C("max",f)]=v.ideal,h.optional.push(x)):(x[C("",f)]=v.ideal,h.optional.push(x))}v.exact!==void 0&&typeof v.exact!="number"?(h.mandatory=h.mandatory||{},h.mandatory[C("",f)]=v.exact):["min","max"].forEach(x=>{v[x]!==void 0&&(h.mandatory=h.mandatory||{},h.mandatory[C(x,f)]=v[x])})}),u.advanced&&(h.optional=(h.optional||[]).concat(u.advanced)),h},a=function(u,h){if(e.version>=61)return h(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const f=function(v,C,x){C in v&&!(x in v)&&(v[x]=v[C],delete v[C])};u=JSON.parse(JSON.stringify(u)),f(u.audio,"autoGainControl","googAutoGainControl"),f(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=r(u.audio)}if(u&&typeof u.video=="object"){let f=u.video.facingMode;f=f&&(typeof f=="object"?f:{ideal:f});const v=e.version<66;if(f&&(f.exact==="user"||f.exact==="environment"||f.ideal==="user"||f.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!v)){delete u.video.facingMode;let C;if(f.exact==="environment"||f.ideal==="environment"?C=["back","rear"]:(f.exact==="user"||f.ideal==="user")&&(C=["front"]),C)return t.mediaDevices.enumerateDevices().then(x=>{x=x.filter(N=>N.kind==="videoinput");let T=x.find(N=>C.some(L=>N.label.toLowerCase().includes(L)));return!T&&x.length&&C.includes("back")&&(T=x[x.length-1]),T&&(u.video.deviceId=f.exact?{exact:T.deviceId}:{ideal:T.deviceId}),u.video=r(u.video),lb("chrome: "+JSON.stringify(u)),h(u)})}u.video=r(u.video)}return lb("chrome: "+JSON.stringify(u)),h(u)},s=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},l=function(u,h,f){a(u,v=>{t.webkitGetUserMedia(v,h,C=>{f&&f(s(C))})})};if(t.getUserMedia=l.bind(t),t.mediaDevices.getUserMedia){const u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(h){return a(h,f=>u(f).then(v=>{if(f.audio&&!v.getAudioTracks().length||f.video&&!v.getVideoTracks().length)throw v.getTracks().forEach(C=>{C.stop()}),new DOMException("","NotFoundError");return v},v=>Promise.reject(s(v))))}}}function r1(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function i1(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",r=>{let a;n.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(l=>l.track&&l.track.id===r.track.id):a={track:r.track};const s=new Event("track");s.track=r.track,s.receiver=a,s.transceiver={receiver:a},s.streams=[t.stream],this.dispatchEvent(s)}),t.stream.getTracks().forEach(r=>{let a;n.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(l=>l.track&&l.track.id===r.id):a={track:r};const s=new Event("track");s.track=r,s.receiver=a,s.transceiver={receiver:a},s.streams=[t.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Uo(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function a1(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(a,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=a.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:a}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(l,u){let h=a.apply(this,arguments);return h||(h=e(this,l),this._senders.push(h)),h};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(l){s.apply(this,arguments);const u=this._senders.indexOf(l);u!==-1&&this._senders.splice(u,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],t.apply(this,[a]),a.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(s=>{const l=this._senders.find(u=>u.track===s);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const t=e.apply(this,[]);return t.forEach(r=>r._pc=this),t},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function o1(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(s=>s._pc=this),a});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),n.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(s=>sb(s,a.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(a=>a._pc=this),r}),Uo(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(a=>sb(a,r.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const t=arguments[0];let r,a,s;return this.getSenders().forEach(l=>{l.track===t&&(r?s=!0:r=l)}),this.getReceivers().forEach(l=>(l.track===t&&(a?s=!0:a=l),l.track===t)),s||r&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function s1(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(s,l){if(!l)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=e.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(u)===-1&&this._shimmedLocalStreams[l.id].push(u):this._shimmedLocalStreams[l.id]=[l,u],u};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(h=>{if(this.getSenders().find(f=>f.track===h))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();t.apply(this,arguments);const u=this.getSenders().filter(h=>l.indexOf(h)===-1);this._shimmedLocalStreams[s.id]=[s].concat(u)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const a=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const u=this._shimmedLocalStreams[l].indexOf(s);u!==-1&&this._shimmedLocalStreams[l].splice(u,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),a.apply(this,arguments)}}function l1(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return s1(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const f=t.apply(this);return this._reverseStreams=this._reverseStreams||{},f.map(v=>this._reverseStreams[v.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(f){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},f.getTracks().forEach(v=>{if(this.getSenders().find(C=>C.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[f.id]){const v=new n.MediaStream(f.getTracks());this._streams[f.id]=v,this._reverseStreams[v.id]=f,f=v}r.apply(this,[f])};const a=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(f){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[f.id]||f]),delete this._reverseStreams[this._streams[f.id]?this._streams[f.id].id:f.id],delete this._streams[f.id]},n.RTCPeerConnection.prototype.addTrack=function(f,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const C=[].slice.call(arguments,1);if(C.length!==1||!C[0].getTracks().find(T=>T===f))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(T=>T.track===f))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const x=this._streams[v.id];if(x)x.addTrack(f),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const T=new n.MediaStream([f]);this._streams[v.id]=T,this._reverseStreams[T.id]=v,this.addStream(T)}return this.getSenders().find(T=>T.track===f)};function s(f,v){let C=v.sdp;return Object.keys(f._reverseStreams||[]).forEach(x=>{const T=f._reverseStreams[x],N=f._streams[T.id];C=C.replace(new RegExp(N.id,"g"),T.id)}),new RTCSessionDescription({type:v.type,sdp:C})}function l(f,v){let C=v.sdp;return Object.keys(f._reverseStreams||[]).forEach(x=>{const T=f._reverseStreams[x],N=f._streams[T.id];C=C.replace(new RegExp(T.id,"g"),N.id)}),new RTCSessionDescription({type:v.type,sdp:C})}["createOffer","createAnswer"].forEach(function(f){const v=n.RTCPeerConnection.prototype[f],C={[f](){const x=arguments;return arguments.length&&typeof arguments[0]=="function"?v.apply(this,[T=>{const N=s(this,T);x[0].apply(null,[N])},T=>{x[1]&&x[1].apply(null,T)},arguments[2]]):v.apply(this,arguments).then(T=>s(this,T))}};n.RTCPeerConnection.prototype[f]=C[f]});const u=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=l(this,arguments[0]),u.apply(this,arguments))};const h=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const f=h.get.apply(this);return f.type===""?f:s(this,f)}}),n.RTCPeerConnection.prototype.removeTrack=function(f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!f._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(f._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let v;Object.keys(this._streams).forEach(C=>{this._streams[C].getTracks().find(x=>f.track===x)&&(v=this._streams[C])}),v&&(v.getTracks().length===1?this.removeStream(this._reverseStreams[v.id]):v.removeTrack(f.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Vp(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],a={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=a[t]})}function c1(n,e){Uo(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}var cb=Object.freeze({__proto__:null,fixNegotiationNeeded:c1,shimAddTrackRemoveTrack:l1,shimAddTrackRemoveTrackWithNative:s1,shimGetSendersWithDtmf:a1,shimGetUserMedia:n1,shimMediaStream:r1,shimOnTrack:i1,shimPeerConnection:Vp,shimSenderReceiverGetStats:o1});function u1(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(a,s,l){$f("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(a).then(s,l)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const a=function(l,u,h){u in l&&!(h in l)&&(l[h]=l[u],delete l[u])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(l){return typeof l=="object"&&typeof l.audio=="object"&&(l=JSON.parse(JSON.stringify(l)),a(l.audio,"autoGainControl","mozAutoGainControl"),a(l.audio,"noiseSuppression","mozNoiseSuppression")),s(l)},r&&r.prototype.getSettings){const l=r.prototype.getSettings;r.prototype.getSettings=function(){const u=l.apply(this,arguments);return a(u,"mozAutoGainControl","autoGainControl"),a(u,"mozNoiseSuppression","noiseSuppression"),u}}if(r&&r.prototype.applyConstraints){const l=r.prototype.applyConstraints;r.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),a(u,"autoGainControl","mozAutoGainControl"),a(u,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[u])}}}}function a2(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(t){if(!(t&&t.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return t.video===!0?t.video={mediaSource:e}:t.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(t)})}function d1(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Wp(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const s=n.RTCPeerConnection.prototype[a],l={[a](){return arguments[0]=new(a==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[a]=l[a]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[a,s,l]=arguments;return r.apply(this,[a||null]).then(u=>{if(e.version<53&&!s)try{u.forEach(h=>{h.type=t[h.type]||h.type})}catch(h){if(h.name!=="TypeError")throw h;u.forEach((f,v)=>{u.set(v,Object.assign({},f,{type:t[f.type]||f.type}))})}return u}).then(s,l)}}function h1(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(a=>a._pc=this),r});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const r=t.apply(this,arguments);return r._pc=this,r}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function p1(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const t=e.apply(this,[]);return t.forEach(r=>r._pc=this),t}),Uo(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function f1(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(e){$f("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function m1(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function g1(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let t=arguments[1]&&arguments[1].sendEncodings;t===void 0&&(t=[]),t=[...t];const r=t.length>0;r&&t.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(r){const{sender:s}=a,l=s.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=t,s.sendEncodings=t,this.setParametersPromises.push(s.setParameters(l).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return a})}function v1(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const t=e.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}function b1(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function y1(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var ub=Object.freeze({__proto__:null,shimAddTransceiver:g1,shimCreateAnswer:y1,shimCreateOffer:b1,shimGetDisplayMedia:a2,shimGetParameters:v1,shimGetUserMedia:u1,shimOnTrack:d1,shimPeerConnection:Wp,shimRTCDataChannel:m1,shimReceiverGetStats:p1,shimRemoveStream:f1,shimSenderGetStats:h1});function w1(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(r=>e.call(this,r,t)),t.getVideoTracks().forEach(r=>e.call(this,r,t))},n.RTCPeerConnection.prototype.addTrack=function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return a&&a.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(t===-1)return;this._localStreams.splice(t,1);const r=e.getTracks();this.getSenders().forEach(a=>{r.includes(a.track)&&this.removeTrack(a)})})}}function k1(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const s=new Event("addstream");s.stream=a,this.dispatchEvent(s)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(a=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(a)>=0)return;t._remoteStreams.push(a);const s=new Event("addstream");s.stream=a,t.dispatchEvent(s)})}),e.apply(t,arguments)}}}function C1(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,a=e.setLocalDescription,s=e.setRemoteDescription,l=e.addIceCandidate;e.createOffer=function(h,f){const v=arguments.length>=2?arguments[2]:arguments[0],C=t.apply(this,[v]);return f?(C.then(h,f),Promise.resolve()):C},e.createAnswer=function(h,f){const v=arguments.length>=2?arguments[2]:arguments[0],C=r.apply(this,[v]);return f?(C.then(h,f),Promise.resolve()):C};let u=function(h,f,v){const C=a.apply(this,[h]);return v?(C.then(f,v),Promise.resolve()):C};e.setLocalDescription=u,u=function(h,f,v){const C=s.apply(this,[h]);return v?(C.then(f,v),Promise.resolve()):C},e.setRemoteDescription=u,u=function(h,f,v){const C=l.apply(this,[h]);return v?(C.then(f,v),Promise.resolve()):C},e.addIceCandidate=u}function S1(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=a=>r(T1(a))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(t,r,a){e.mediaDevices.getUserMedia(t).then(r,a)}).bind(e))}function T1(n){return n&&n.video!==void 0?Object.assign({},n,{video:t1(n.video)}):n}function x1(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(t,r){if(t&&t.iceServers){const a=[];for(let s=0;s<t.iceServers.length;s++){let l=t.iceServers[s];l.urls===void 0&&l.url?($f("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,a.push(l)):a.push(t.iceServers[s])}t.iceServers=a}return new e(t,r)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function E1(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function P1(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(t){if(t){typeof t.offerToReceiveAudio<"u"&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const r=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");t.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):t.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof t.offerToReceiveVideo<"u"&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const a=this.getTransceivers().find(s=>s.receiver.track.kind==="video");t.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):t.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function _1(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var db=Object.freeze({__proto__:null,shimAudioContext:_1,shimCallbacksAPI:C1,shimConstraints:T1,shimCreateOfferLegacy:P1,shimGetUserMedia:S1,shimLocalStreamsAPI:w1,shimRTCIceServerUrls:x1,shimRemoteStreamsAPI:k1,shimTrackEventTransceiver:E1}),hb={exports:{}},pb;function o2(){return pb||(pb=1,function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((r,a)=>(a>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(a=>a.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const a={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":a.relatedAddress=r[s+1];break;case"rport":a.relatedPort=parseInt(r[s+1],10);break;case"tcptype":a.tcpType=r[s+1];break;case"ufrag":a.ufrag=r[s+1],a.usernameFragment=r[s+1];break;default:a[r[s]]===void 0&&(a[r[s]]=r[s+1]);break}return a},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const a=t.component;a==="rtp"?r.push(1):a==="rtcp"?r.push(2):r.push(a),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const s=t.type;return r.push("typ"),r.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const a={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),a.name=r[0],a.clockRate=parseInt(r[1],10),a.channels=r.length===3?parseInt(r[2],10):1,a.numChannels=a.channels,a},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const a=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(a!==1?"/"+a:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let a;const s=t.substring(t.indexOf(" ")+1).split(";");for(let l=0;l<s.length;l++)a=s[l].trim().split("="),r[a[0].trim()]=a[1];return r},e.writeFmtp=function(t){let r="",a=t.payloadType;if(t.preferredPayloadType!==void 0&&(a=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(l=>{t.parameters[l]!==void 0?s.push(l+"="+t.parameters[l]):s.push(l)}),r+="a=fmtp:"+a+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",a=t.payloadType;return t.preferredPayloadType!==void 0&&(a=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+a+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),a={ssrc:parseInt(t.substring(7,r),10)},s=t.indexOf(":",r);return s>-1?(a.attribute=t.substring(r+1,s),a.value=t.substring(s+1)):a.attribute=t.substring(r+1),a},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(a=>parseInt(a,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let a="a=setup:"+r+`\r
`;return t.fingerprints.forEach(s=>{a+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),a},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const a=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return a&&s?{usernameFragment:a.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(t)[0].split(" ");r.profile=a[2];for(let l=3;l<a.length;l++){const u=a[l],h=e.matchPrefix(t,"a=rtpmap:"+u+" ")[0];if(h){const f=e.parseRtpMap(h),v=e.matchPrefix(t,"a=fmtp:"+u+" ");switch(f.parameters=v.length?e.parseFmtp(v[0]):{},f.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+u+" ").map(e.parseRtcpFb),r.codecs.push(f),f.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(f.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(l=>{r.headerExtensions.push(e.parseExtmap(l))});const s=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(l=>{s.forEach(u=>{l.rtcpFeedback.find(h=>h.type===u.type&&h.parameter===u.parameter)||l.rtcpFeedback.push(u)})}),r},e.writeRtpDescription=function(t,r){let a="";a+="m="+t+" ",a+=r.codecs.length>0?"9":"0",a+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",a+=r.codecs.map(l=>l.preferredPayloadType!==void 0?l.preferredPayloadType:l.payloadType).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(l=>{a+=e.writeRtpMap(l),a+=e.writeFmtp(l),a+=e.writeRtcpFb(l)});let s=0;return r.codecs.forEach(l=>{l.maxptime>s&&(s=l.maxptime)}),s>0&&(a+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(l=>{a+=e.writeExtmap(l)}),a},e.parseRtpEncodingParameters=function(t){const r=[],a=e.parseRtpParameters(t),s=a.fecMechanisms.indexOf("RED")!==-1,l=a.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(t,"a=ssrc:").map(x=>e.parseSsrcMedia(x)).filter(x=>x.attribute==="cname"),h=u.length>0&&u[0].ssrc;let f;const v=e.matchPrefix(t,"a=ssrc-group:FID").map(x=>x.substring(17).split(" ").map(T=>parseInt(T,10)));v.length>0&&v[0].length>1&&v[0][0]===h&&(f=v[0][1]),a.codecs.forEach(x=>{if(x.name.toUpperCase()==="RTX"&&x.parameters.apt){let T={ssrc:h,codecPayloadType:parseInt(x.parameters.apt,10)};h&&f&&(T.rtx={ssrc:f}),r.push(T),s&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:h,mechanism:l?"red+ulpfec":"red"},r.push(T))}}),r.length===0&&h&&r.push({ssrc:h});let C=e.matchPrefix(t,"b=");return C.length&&(C[0].indexOf("b=TIAS:")===0?C=parseInt(C[0].substring(7),10):C[0].indexOf("b=AS:")===0?C=parseInt(C[0].substring(5),10)*1e3*.95-50*40*8:C=void 0,r.forEach(x=>{x.maxBitrate=C})),r},e.parseRtcpParameters=function(t){const r={},a=e.matchPrefix(t,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];a&&(r.cname=a.value,r.ssrc=a.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const l=e.matchPrefix(t,"a=rtcp-mux");return r.mux=l.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const a=e.matchPrefix(t,"a=msid:");if(a.length===1)return r=a[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(t,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),a=e.matchPrefix(t,"a=max-message-size:");let s;a.length>0&&(s=parseInt(a[0].substring(19),10)),isNaN(s)&&(s=65536);const l=e.matchPrefix(t,"a=sctp-port:");if(l.length>0)return{port:parseInt(l[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const u=e.matchPrefix(t,"a=sctpmap:");if(u.length>0){const h=u[0].substring(10).split(" ");return{port:parseInt(h[0],10),protocol:h[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){let a=[];return t.protocol!=="DTLS/SCTP"?a=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:a=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&a.push("a=max-message-size:"+r.maxMessageSize+`\r
`),a.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,a){let s;const l=r!==void 0?r:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(a||"thisisadapterortc")+" "+s+" "+l+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const a=e.splitLines(t);for(let s=0;s<a.length;s++)switch(a[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const r=e.splitLines(t)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(t){const r=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let a=0;a<r.length;a++)if(r[a].length<2||r[a].charAt(1)!=="=")return!1;return!0},n.exports=e}(hb)),hb.exports}var R1=o2(),Us=HT(R1),s2=fS({__proto__:null,default:Us},[R1]);function Zu(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(t){if(typeof t=="object"&&t.candidate&&t.candidate.indexOf("a=")===0&&(t=JSON.parse(JSON.stringify(t)),t.candidate=t.candidate.substring(2)),t.candidate&&t.candidate.length){const r=new e(t),a=Us.parseCandidate(t.candidate);for(const s in a)s in r||Object.defineProperty(r,s,{value:a[s]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(t)},n.RTCIceCandidate.prototype=e.prototype,Uo(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function zp(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||Uo(n,"icecandidate",e=>{if(e.candidate){const t=Us.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Qu(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(u){if(!u||!u.sdp)return!1;const h=Us.splitSections(u.sdp);return h.shift(),h.some(f=>{const v=Us.parseMLine(f);return v&&v.kind==="application"&&v.protocol.indexOf("SCTP")!==-1})},r=function(u){const h=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(h===null||h.length<2)return-1;const f=parseInt(h[1],10);return f!==f?-1:f},a=function(u){let h=65536;return e.browser==="firefox"&&(e.version<57?u===-1?h=16384:h=2147483637:e.version<60?h=e.version===57?65535:65536:h=2147483637),h},s=function(u,h){let f=65536;e.browser==="firefox"&&e.version===57&&(f=65535);const v=Us.matchPrefix(u.sdp,"a=max-message-size:");return v.length>0?f=parseInt(v[0].substring(19),10):e.browser==="firefox"&&h!==-1&&(f=2147483637),f},l=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const u=r(arguments[0]),h=a(u),f=s(arguments[0],u);let v;h===0&&f===0?v=Number.POSITIVE_INFINITY:h===0||f===0?v=Math.max(h,f):v=Math.min(h,f);const C={};Object.defineProperty(C,"maxMessageSize",{get(){return v}}),this._sctp=C}return l.apply(this,arguments)}}function Yu(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,a){const s=r.send;r.send=function(){const l=arguments[0],u=l.length||l.size||l.byteLength;if(r.readyState==="open"&&a.sctp&&u>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const r=t.apply(this,arguments);return e(r,this),r},Uo(n,"datachannel",r=>(e(r.channel,r.target),r))}function qp(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const s=a.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const l=new Event("connectionstatechange",a);s.dispatchEvent(l)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function $p(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=r.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&r instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:r.type,sdp:a}):r.sdp=a}return t.apply(this,arguments)}}function Xu(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ed(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return t.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?t.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}var l2=Object.freeze({__proto__:null,removeExtmapAllowMixed:$p,shimAddIceCandidateNullOrEmpty:Xu,shimConnectionState:qp,shimMaxMessageSize:Qu,shimParameterlessSetLocalDescription:ed,shimRTCIceCandidate:Zu,shimRTCIceCandidateRelayProtocol:zp,shimSendThrowTypeError:Yu});function c2(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=e1,r=i2(n),a={browserDetails:r,commonShim:l2,extractVersion:Kl,disableLog:n2,disableWarnings:r2,sdp:s2};switch(r.browser){case"chrome":if(!cb||!Vp||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),a;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),a;t("adapter.js shimming chrome."),a.browserShim=cb,Xu(n,r),ed(n),n1(n,r),r1(n),Vp(n,r),i1(n),l1(n,r),a1(n),o1(n),c1(n,r),Zu(n),zp(n),qp(n),Qu(n,r),Yu(n),$p(n,r);break;case"firefox":if(!ub||!Wp||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),a;t("adapter.js shimming firefox."),a.browserShim=ub,Xu(n,r),ed(n),u1(n,r),Wp(n,r),d1(n),f1(n),h1(n),p1(n),m1(n),g1(n),v1(n),b1(n),y1(n),Zu(n),qp(n),Qu(n,r),Yu(n);break;case"safari":if(!db||!e.shimSafari)return t("Safari shim is not included in this adapter release."),a;t("adapter.js shimming safari."),a.browserShim=db,Xu(n,r),ed(n),x1(n),P1(n),C1(n),w1(n),k1(n),E1(n),S1(n),_1(n),Zu(n),zp(n),Qu(n,r),Yu(n),$p(n,r);break;default:t("Unsupported browser!");break}return a}c2({window:typeof window>"u"?void 0:window});const u2=10,Vl="lk_e2ee",d2="LKFrameEncryptionKey",h2={sharedKey:!1,ratchetSalt:d2,ratchetWindowSize:8,failureTolerance:u2,keyringSize:16};var Ua;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(Ua||(Ua={}));var fb;(function(n){n.KeyRatcheted="keyRatcheted"})(fb||(fb={}));var ja;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(ja||(ja={}));var mb;(function(n){n.Error="cryptorError"})(mb||(mb={}));function p2(){return f2()||Hp()}function Hp(){return typeof window.RTCRtpScriptTransform<"u"}function f2(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function m2(n){var e,t,r,a,s;if(((e=n.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((t=n.value)===null||t===void 0?void 0:t.case)!=="metrics"&&((r=n.value)===null||r===void 0?void 0:r.case)!=="speaker"&&((a=n.value)===null||a===void 0?void 0:a.case)!=="transcription"&&((s=n.value)===null||s===void 0?void 0:s.case)!=="encryptedPacket")return new R0({value:n.value})}class qR extends Mi.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,r,a)=>{ct.debug("key ratcheted event received",{ratchetResult:t,participantId:r,keyIndex:a})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},h2),e),this.on(Ua.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,r){const a={key:e,participantIdentity:t,keyIndex:r};if(!this.options.sharedKey&&!t)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(t??"shared","-").concat(r??0),a),this.emit(Ua.SetKey,a)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(Ua.RatchetRequest,e,t)}}class oa extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var mt;(function(n){n[n.NotAllowed=0]="NotAllowed",n[n.ServerUnreachable=1]="ServerUnreachable",n[n.InternalError=2]="InternalError",n[n.Cancelled=3]="Cancelled",n[n.LeaveRequest=4]="LeaveRequest",n[n.Timeout=5]="Timeout"})(mt||(mt={}));class kt extends oa{constructor(e,t,r,a){super(1,e),this.name="ConnectionError",this.status=r,this.reason=t,this.context=a,this.reasonName=mt[t]}}class Hf extends oa{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class na extends oa{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class g2 extends oa{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class ln extends oa{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Gp extends oa{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class gb extends oa{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class vb extends oa{constructor(e,t){super(15,e),this.reason=t,this.reasonName=typeof t=="string"?t:qf[t]}}var Gn;(function(n){n[n.AlreadyOpened=0]="AlreadyOpened",n[n.AbnormalEnd=1]="AbnormalEnd",n[n.DecodeFailed=2]="DecodeFailed",n[n.LengthExceeded=3]="LengthExceeded",n[n.Incomplete=4]="Incomplete",n[n.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",n[n.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(Gn||(Gn={}));class Fr extends oa{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=Gn[t]}}var vd;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(vd||(vd={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(vd||(vd={}));var bb;(function(n){n[n.InvalidKey=0]="InvalidKey",n[n.MissingKey=1]="MissingKey",n[n.InternalError=2]="InternalError"})(bb||(bb={}));var Se;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.Moved="moved",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.ParticipantAttributesChanged="participantAttributesChanged",n.ParticipantActive="participantActive",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged",n.ChatMessage="chatMessage",n.LocalTrackSubscribed="localTrackSubscribed",n.MetricsReceived="metricsReceived"})(Se||(Se={}));var Ie;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackCpuConstrained="localTrackCpuConstrained",n.LocalSenderCreated="localSenderCreated",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.TrackCpuConstrained="trackCpuConstrained",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded",n.AttributesChanged="attributesChanged",n.LocalTrackSubscribed="localTrackSubscribed",n.ChatMessage="chatMessage",n.Active="active"})(Ie||(Ie={}));var Re;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackSubscribed="localTrackSubscribed",n.Offline="offline",n.SignalRequestResponse="signalRequestResponse",n.SignalConnected="signalConnected",n.RoomMoved="roomMoved"})(Re||(Re={}));var xe;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.CpuConstrained="cpuConstrained",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed",n.TrackProcessorUpdate="trackProcessorUpdate",n.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",n.TranscriptionReceived="transcriptionReceived",n.TimeSyncUpdate="timeSyncUpdate",n.PreConnectBufferFlushed="preConnectBufferFlushed"})(xe||(xe={}));function v2(n){return typeof n>"u"?n:typeof structuredClone=="function"?typeof n=="object"&&n!==null?structuredClone(Object.assign({},n)):structuredClone(n):JSON.parse(JSON.stringify(n))}const b2=/version\/(\d+(\.?_?\d+)+)/i;let up;function hr(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(up===void 0||e){const r=y2.find(a=>{let{test:s}=a;return s.test(t)});up=r==null?void 0:r.describe(t)}return up}const y2=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:td(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:dp(n)}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:td(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0,osVersion:dp(n)}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:td(b2,n),os:n.includes("mobile/")?"iOS":"macOS",osVersion:dp(n)}}}];function td(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(n);return r&&r.length>=t&&r[t]||""}function dp(n){return n.includes("mac os")?td(/\(.+?(\d+_\d+(:?_\d+)?)/,n,1).replace(/_/g,"."):void 0}var w2="2.15.14";const k2=w2,C2=16;class Pn{}Pn.setTimeout=function(){return setTimeout(...arguments)};Pn.setInterval=function(){return setInterval(...arguments)};Pn.clearTimeout=function(){return clearTimeout(...arguments)};Pn.clearInterval=function(){return clearInterval(...arguments)};const S2=5e3,Wl=[];var Cr;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH"})(Cr||(Cr={}));class me extends Mi.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var a;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=me.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=ct,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),S2):this.handleAppVisibilityChanged()},this.log=aa((a=r.loggerName)!==null&&a!==void 0?a:di.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=me.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),pt(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===me.Kind.Video&&(t="video"),this.attachedElements.length===0&&this.kind===me.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(Wl.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&Wl.splice(Wl.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),As(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),a=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(a?xe.AudioPlaybackStarted:xe.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(a?xe.AudioPlaybackFailed:xe.VideoPlaybackFailed,s):s.name==="AbortError"?ct.debug("".concat(a?"audio":"video"," playback aborted, likely due to new play request")):ct.warn("could not playback ".concat(a?"audio":"video"),s),a&&e&&r.some(l=>l.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(xe.ElementAttached,e),e}detach(e){try{if(e){Fs(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(xe.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(r=>{Fs(this.mediaStreamTrack,r),t.push(r),this.recycleElement(r),this.emit(xe.ElementDetached,r)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=aa(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),Wl.forEach(r=>{r.parentElement||(t=!1)}),t&&Wl.push(e)}}handleAppVisibilityChanged(){return D(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===me.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){dr()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){dr()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function As(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let r;n.kind==="audio"?r=t.getAudioTracks():r=t.getVideoTracks(),r.includes(n)||(r.forEach(a=>{t.removeTrack(a)}),t.addTrack(n)),(!jo()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(jo()||No())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function Fs(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(f){f.Audio="audio",f.Video="video",f.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(f){f.Camera="camera",f.Microphone="microphone",f.ScreenShare="screen_share",f.ScreenShareAudio="screen_share_audio",f.Unknown="unknown"})(t=n.Source||(n.Source={}));let r;(function(f){f.Active="active",f.Paused="paused",f.Unknown="unknown"})(r=n.StreamState||(n.StreamState={}));function a(f){switch(f){case e.Audio:return li.AUDIO;case e.Video:return li.VIDEO;default:return li.DATA}}n.kindToProto=a;function s(f){switch(f){case li.AUDIO:return e.Audio;case li.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=s;function l(f){switch(f){case t.Camera:return nn.CAMERA;case t.Microphone:return nn.MICROPHONE;case t.ScreenShare:return nn.SCREEN_SHARE;case t.ScreenShareAudio:return nn.SCREEN_SHARE_AUDIO;default:return nn.UNKNOWN}}n.sourceToProto=l;function u(f){switch(f){case nn.CAMERA:return t.Camera;case nn.MICROPHONE:return t.Microphone;case nn.SCREEN_SHARE:return t.ScreenShare;case nn.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=u;function h(f){switch(f){case jp.ACTIVE:return r.Active;case jp.PAUSED:return r.Paused;default:return r.Unknown}}n.streamStateFromProto=h})(me||(me={}));class _t{constructor(e,t,r,a,s){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(t!==void 0&&r!==void 0)this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:r,maxFramerate:a,priority:s};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const T2=["vp8","h264"],x2=["vp8","h264","vp9","av1","h265"];function E2(n){return!!T2.find(e=>e===n)}const P2=E2;var yb;(function(n){n[n.PREFER_REGRESSION=0]="PREFER_REGRESSION",n[n.SIMULCAST=1]="SIMULCAST",n[n.REGRESSION=2]="REGRESSION"})(yb||(yb={}));var Kp;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:24e3},n.music={maxBitrate:48e3},n.musicStereo={maxBitrate:64e3},n.musicHighQuality={maxBitrate:96e3},n.musicHighQualityStereo={maxBitrate:128e3}})(Kp||(Kp={}));const fc={h90:new _t(160,90,9e4,20),h180:new _t(320,180,16e4,20),h216:new _t(384,216,18e4,20),h360:new _t(640,360,45e4,20),h540:new _t(960,540,8e5,25),h720:new _t(1280,720,17e5,30),h1080:new _t(1920,1080,3e6,30),h1440:new _t(2560,1440,5e6,30),h2160:new _t(3840,2160,8e6,30)},Jp={h120:new _t(160,120,7e4,20),h180:new _t(240,180,125e3,20),h240:new _t(320,240,14e4,20),h360:new _t(480,360,33e4,20),h480:new _t(640,480,5e5,20),h540:new _t(720,540,6e5,25),h720:new _t(960,720,13e5,30),h1080:new _t(1440,1080,23e5,30),h1440:new _t(1920,1440,38e5,30)},Gf={h360fps3:new _t(640,360,2e5,3,"medium"),h360fps15:new _t(640,360,4e5,15,"medium"),h720fps5:new _t(1280,720,8e5,5,"medium"),h720fps15:new _t(1280,720,15e5,15,"medium"),h720fps30:new _t(1280,720,2e6,30,"medium"),h1080fps15:new _t(1920,1080,25e5,15,"medium"),h1080fps30:new _t(1920,1080,5e6,30,"medium"),original:new _t(0,0,7e6,30,"medium")},_2="|",wb="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function R2(n){const e=n.split(_2);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function Yn(n){return D(this,void 0,void 0,function*(){return new Promise(e=>Pn.setTimeout(e,n))})}function Zp(){return"addTransceiver"in RTCPeerConnection.prototype}function Qp(){return"addTrack"in RTCPeerConnection.prototype}function I2(){if(!("getCapabilities"in RTCRtpSender)||jo()||No())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function O2(){if(!("getCapabilities"in RTCRtpSender)||No())return!1;if(jo()){const t=hr();if(t!=null&&t.version&&Ai(t.version,"16")<0||(t==null?void 0:t.os)==="iOS"&&t!=null&&t.osVersion&&Ai(t.osVersion,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function _i(n){return n==="av1"||n==="vp9"}function Yp(n){return!document||mc()?!1:(n||(n=document.createElement("audio")),"setSinkId"in n)}function A2(){return typeof RTCPeerConnection>"u"?!1:Zp()||Qp()}function No(){var n;return((n=hr())===null||n===void 0?void 0:n.name)==="Firefox"}function kb(){const n=hr();return!!n&&n.name==="Chrome"&&n.os!=="iOS"}function jo(){var n;return((n=hr())===null||n===void 0?void 0:n.name)==="Safari"}function mc(){const n=hr();return(n==null?void 0:n.name)==="Safari"||(n==null?void 0:n.os)==="iOS"}function M2(){const n=hr();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&Ai(n.osVersion,"17")>=0}function L2(n){return n||(n=hr()),(n==null?void 0:n.name)==="Safari"&&Ai(n.version,"18.3")>0||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&Ai(n.osVersion,"18.3")>0}function I1(){var n,e;return dr()?(e=(n=navigator.userAgentData)===null||n===void 0?void 0:n.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function N2(){const n=hr(),e="17.2";if(n)return n.name!=="Safari"&&n.os!=="iOS"||n.os==="iOS"&&n.osVersion&&Ai(n.osVersion,e)>=0?!0:n.name==="Safari"&&Ai(n.version,e)>=0}function dr(){return typeof document<"u"}function Oi(){return navigator.product=="ReactNative"}function Xp(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function O1(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function A1(){if(!Oi())return;let n=O1();if(n)return n.platform}function Cb(){if(dr())return window.devicePixelRatio;if(Oi()){let n=O1();if(n)return n.devicePixelRatio}return 1}function Ai(n,e){const t=n.split("."),r=e.split("."),a=Math.min(t.length,r.length);for(let s=0;s<a;++s){const l=parseInt(t[s],10),u=parseInt(r[s],10);if(l>u)return 1;if(l<u)return-1;if(s===a-1&&l===u)return 0}return n===""&&e!==""?-1:e===""?1:t.length==r.length?0:t.length<r.length?-1:1}function j2(n){for(const e of n)e.target.handleResize(e)}function D2(n){for(const e of n)e.target.handleVisibilityChanged(e)}let hp=null;const Sb=()=>(hp||(hp=new ResizeObserver(j2)),hp);let pp=null;const Tb=()=>(pp||(pp=new IntersectionObserver(D2,{root:null,rootMargin:"0px"})),pp);function U2(){var n;const e=new j0({sdk:D0.JS,protocol:C2,version:k2});return Oi()&&(e.os=(n=A1())!==null&&n!==void 0?n:""),e}function xb(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const a=document.createElement("canvas");a.width=n,a.height=e;const s=a.getContext("2d");s==null||s.fillRect(0,0,a.width,a.height),r&&s&&(s.beginPath(),s.arc(n/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const l=a.captureStream(),[u]=l.getTracks();if(!u)throw Error("Could not get empty media stream video track");return u.enabled=t,u}let zl;function fp(){if(!zl){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const r=n.createMediaStreamDestination();if(e.connect(t),t.connect(r),e.start(),[zl]=r.stream.getAudioTracks(),!zl)throw Error("Could not get empty media stream audio track");zl.enabled=!1}return zl.clone()}class Vr{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((r,a)=>D(this,void 0,void 0,function*(){this.resolve=r,this.reject=a,e&&(yield e(r,a))})).finally(()=>{var r;this._isResolved=!0,(r=this.onFinally)===null||r===void 0||r.call(this)})}}function F2(n){return x2.includes(n)}function Fa(n){if(typeof n=="string"||typeof n=="number")return n;if(Array.isArray(n))return n[0];if(n.exact!==void 0)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal!==void 0)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function B2(n){return n.startsWith("http")?n.replace(/^(http)/,"ws"):n}function ef(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}function V2(n,e){return n.segments.map(t=>{let{id:r,text:a,language:s,startTime:l,endTime:u,final:h}=t;var f;const v=(f=e.get(r))!==null&&f!==void 0?f:Date.now(),C=Date.now();return h?e.delete(r):e.set(r,v),{id:r,text:a,startTime:Number.parseInt(l.toString()),endTime:Number.parseInt(u.toString()),final:h,language:s,firstReceivedTime:v,lastReceivedTime:C}})}function W2(n){const{id:e,timestamp:t,message:r,editTimestamp:a}=n;return{id:e,timestamp:Number.parseInt(t.toString()),editTimestamp:a?Number.parseInt(a.toString()):void 0,message:r}}function Eb(n){switch(n.reason){case mt.LeaveRequest:return n.context;case mt.Cancelled:return ui.CLIENT_INITIATED;case mt.NotAllowed:return ui.USER_REJECTED;case mt.ServerUnreachable:return ui.JOIN_FAILURE;default:return ui.UNKNOWN_REASON}}function nd(n){return n!==void 0?Number(n):void 0}function Ro(n){return n!==void 0?BigInt(n):void 0}function Bs(n){return!!n&&!(n instanceof MediaStreamTrack)&&n.isLocal}function Ri(n){return!!n&&n.kind==me.Kind.Audio}function Wa(n){return!!n&&n.kind==me.Kind.Video}function Oa(n){return Bs(n)&&Wa(n)}function Qi(n){return Bs(n)&&Ri(n)}function tf(n){return!!n&&!n.isLocal}function z2(n){return!!n&&!n.isLocal}function mp(n){return tf(n)&&Wa(n)}function q2(n){return n.isLocal}function $2(n,e){const t=[];let r=new TextEncoder().encode(n);for(;r.length>e;){let a=e;for(;a>0;){const s=r[a];if(s!==void 0&&(s&192)!==128)break;a--}t.push(r.slice(0,a)),r=r.slice(a)}return r.length>0&&t.push(r),t}function H2(n){var e;const t=n.get("Cache-Control");if(t){const r=(e=t.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(r)return parseInt(r,10)}}function M1(n,e,t){var r,a,s,l;const{optionsWithoutProcessor:u,audioProcessor:h,videoProcessor:f}=j1(n??{}),v=e==null?void 0:e.processor,C=t==null?void 0:t.processor,x=u??{};return x.audio===!0&&(x.audio={}),x.video===!0&&(x.video={}),x.audio&&(nf(x.audio,e),(r=(s=x.audio).deviceId)!==null&&r!==void 0||(s.deviceId={ideal:"default"}),(h||v)&&(x.audio.processor=h??v)),x.video&&(nf(x.video,t),(a=(l=x.video).deviceId)!==null&&a!==void 0||(l.deviceId={ideal:"default"}),(f||C)&&(x.video.processor=f??C)),x}function nf(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function Kf(n){var e,t,r,a;const s={};if(n.video)if(typeof n.video=="object"){const l={},u=l,h=n.video;Object.keys(h).forEach(f=>{switch(f){case"resolution":nf(u,h.resolution);break;default:u[f]=h[f]}}),s.video=l,(e=(r=s.video).deviceId)!==null&&e!==void 0||(r.deviceId={ideal:"default"})}else s.video=n.video?{deviceId:{ideal:"default"}}:!1;else s.video=!1;return n.audio?typeof n.audio=="object"?(s.audio=n.audio,(t=(a=s.audio).deviceId)!==null&&t!==void 0||(a.deviceId={ideal:"default"})):s.audio={deviceId:{ideal:"default"}}:s.audio=!1,s}function L1(n){return D(this,arguments,void 0,function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=N1();if(r){const a=r.createAnalyser();a.fftSize=2048;const s=a.frequencyBinCount,l=new Uint8Array(s);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(a),yield Yn(t),a.getByteTimeDomainData(l);const u=l.some(h=>h!==128&&h!==0);return r.close(),!u}return!1}()})}function N1(){var n;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const t=new e({latencyHint:"interactive"});if(t.state==="suspended"&&typeof window<"u"&&!((n=window.document)===null||n===void 0)&&n.body){const r=()=>D(this,void 0,void 0,function*(){var a;try{t.state==="suspended"&&(yield t.resume())}catch(s){console.warn("Error trying to auto-resume audio context",s)}finally{(a=window.document.body)===null||a===void 0||a.removeEventListener("click",r)}});t.addEventListener("statechange",()=>{var a;t.state==="closed"&&((a=window.document.body)===null||a===void 0||a.removeEventListener("click",r))}),window.document.body.addEventListener("click",r)}return t}}function G2(n){return n==="audioinput"?me.Source.Microphone:n==="videoinput"?me.Source.Camera:me.Source.Unknown}function rf(n){return n===me.Source.Microphone?"audioinput":n===me.Source.Camera?"videoinput":void 0}function K2(n){var e,t;let r=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(r=typeof r=="boolean"?{}:r,jo()?r=Object.assign(Object.assign({},r),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:r,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio,preferCurrentTab:n.preferCurrentTab}}function ec(n){return n.split("/")[1].toLowerCase()}function J2(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new Ff({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function pt(n){return"mediaStreamTrack"in n?{trackID:n.sid,source:n.source,muted:n.isMuted,enabled:n.mediaStreamTrack.enabled,kind:n.kind,streamID:n.mediaStreamID,streamTrackID:n.mediaStreamTrack.id}:{trackID:n.trackSid,enabled:n.isEnabled,muted:n.isMuted,trackInfo:Object.assign({mimeType:n.mimeType,name:n.trackName,encrypted:n.isEncrypted,kind:n.kind,source:n.source},n.track?pt(n.track):{})}}function Z2(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function Q2(n,e){var t;n===void 0&&(n={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(n)],a={};for(const s of r)n[s]!==e[s]&&(a[s]=(t=e[s])!==null&&t!==void 0?t:"");return a}function j1(n){const e=Object.assign({},n);let t,r;return typeof e.audio=="object"&&e.audio.processor&&(t=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:t,videoProcessor:r,optionsWithoutProcessor:v2(e)}}function Y2(n){switch(n){case nn.CAMERA:return me.Source.Camera;case nn.MICROPHONE:return me.Source.Microphone;case nn.SCREEN_SHARE:return me.Source.ScreenShare;case nn.SCREEN_SHARE_AUDIO:return me.Source.ScreenShareAudio;default:return me.Source.Unknown}}function Pb(n,e){return n.width*n.height<e.width*e.height}function X2(n,e){var t;return(t=n.layers)===null||t===void 0?void 0:t.find(r=>r.quality===e)}class ex extends Mi.EventEmitter{constructor(e,t){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=r=>{var a,s;const{kind:l,data:u}=r.data;switch(l){case"error":ct.error(u.error.message),this.emit(ja.EncryptionError,u.error);break;case"initAck":u.enabled&&this.keyProvider.getKeys().forEach(v=>{this.postKey(v)});break;case"enable":if(u.enabled&&this.keyProvider.getKeys().forEach(v=>{this.postKey(v)}),this.encryptionEnabled!==u.enabled&&u.participantIdentity===((a=this.room)===null||a===void 0?void 0:a.localParticipant.identity))this.emit(ja.ParticipantEncryptionStatusChanged,u.enabled,this.room.localParticipant),this.encryptionEnabled=u.enabled;else if(u.participantIdentity){const v=(s=this.room)===null||s===void 0?void 0:s.getParticipantByIdentity(u.participantIdentity);if(!v)throw TypeError("couldn't set encryption status, participant not found".concat(u.participantIdentity));this.emit(ja.ParticipantEncryptionStatusChanged,u.enabled,v)}break;case"ratchetKey":this.keyProvider.emit(Ua.KeyRatcheted,u.ratchetResult,u.participantIdentity,u.keyIndex);break;case"decryptDataResponse":const h=this.decryptDataRequests.get(u.uuid);h!=null&&h.resolve&&h.resolve(u);break;case"encryptDataResponse":const f=this.encryptDataRequests.get(u.uuid);f!=null&&f.resolve&&f.resolve(u);break}},this.onWorkerError=r=>{ct.error("e2ee worker encountered an error:",{error:r.error}),this.emit(ja.EncryptionError,r.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=t}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!p2())throw new Hf("tried to setup end-to-end encryption on an unsupported browser");if(ct.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:QT.getLevel()}};this.worker&&(ct.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){ct.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?ct.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Re.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(Se.TrackPublished,(r,a)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==dn.NONE,a.identity)),e.on(Se.ConnectionStateChanged,r=>{r===wt.Connected&&e.remoteParticipants.forEach(a=>{a.trackPublications.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==dn.NONE,a.identity)})})}).on(Se.TrackUnsubscribed,(r,a,s)=>{var l;const u={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(l=this.worker)===null||l===void 0||l.postMessage(u)}).on(Se.TrackSubscribed,(r,a,s)=>{this.setupE2EEReceiver(r,s.identity,a.trackInfo)}).on(Se.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Ie.LocalSenderCreated,(r,a)=>D(this,void 0,void 0,function*(){this.setupE2EESender(a,r)})),e.localParticipant.on(Ie.LocalTrackPublished,r=>{if(!Wa(r.track)||!mc())return;const a={kind:"updateCodec",data:{trackId:r.track.mediaStreamID,codec:ec(r.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(a)}),t.on(Ua.SetKey,r=>this.postKey(r)).on(Ua.RatchetRequest,(r,a)=>this.postRatchetRequest(r,a))}encryptData(e){return D(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const t=crypto.randomUUID(),r={kind:"encryptDataRequest",data:{uuid:t,payload:e,participantIdentity:this.room.localParticipant.identity}},a=new Vr;return a.onFinally=()=>{this.encryptDataRequests.delete(t)},this.encryptDataRequests.set(t,a),this.worker.postMessage(r),a.promise})}handleEncryptedData(e,t,r,a){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const s=crypto.randomUUID(),l={kind:"decryptDataRequest",data:{uuid:s,payload:e,iv:t,participantIdentity:r,keyIndex:a}},u=new Vr;return u.onFinally=()=>{this.decryptDataRequests.delete(s)},this.decryptDataRequests.set(s,u),this.worker.postMessage(l),u.promise}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(r)}postKey(e){let{key:t,participantIdentity:r,keyIndex:a}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const l={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:t,keyIndex:a}};this.worker.postMessage(l)}postEnable(e,t){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?ec(r.mimeType):void 0)}}setupE2EESender(e,t){if(!Bs(e)||!t){t||ct.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,r,a){return D(this,void 0,void 0,function*(){if(this.worker){if(Hp()&&!kb()){const s={kind:"decode",participantIdentity:r,trackId:t,codec:a};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(Vl in e&&a){const h={kind:"updateCodec",data:{trackId:t,codec:a,participantIdentity:r}};this.worker.postMessage(h);return}let s=e.writableStream,l=e.readableStream;if(!s||!l){const h=e.createEncodedStreams();e.writableStream=h.writable,s=h.writable,e.readableStream=h.readable,l=h.readable}const u={kind:"decode",data:{readableStream:l,writableStream:s,trackId:t,codec:a,participantIdentity:r,isReuse:Vl in e}};this.worker.postMessage(u,[l,s])}e[Vl]=!0}})}handleSender(e,t,r){var a;if(!(Vl in e||!this.worker)){if(!(!((a=this.room)===null||a===void 0)&&a.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Hp()&&!kb()){ct.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{ct.info("initialize encoded streams");const s=e.createEncodedStreams(),l={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(l,[s.readable,s.writable])}e[Vl]=!0}}}const gp="default";class vn{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new vn),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return D(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;if(((s=vn.userMediaPromiseMap)===null||s===void 0?void 0:s.size)>0){ct.debug("awaiting getUserMedia promise");try{t?yield vn.userMediaPromiseMap.get(t):yield Promise.all(vn.userMediaPromiseMap.values())}catch{ct.warn("error waiting for media permissons")}}let l=yield navigator.mediaDevices.enumerateDevices();if(a&&!(jo()&&r.hasDeviceInUse(t))&&(l.filter(u=>u.kind===t).length===0||l.some(u=>{const h=u.label==="",f=t?u.kind===t:!0;return h&&f}))){const u={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"&&{deviceId:{ideal:"default"}}},h=yield navigator.mediaDevices.getUserMedia(u);l=yield navigator.mediaDevices.enumerateDevices(),h.getTracks().forEach(f=>{f.stop()})}return r._previousDevices=l,t&&(l=l.filter(u=>u.kind===t)),l}()})}normalizeDeviceId(e,t,r){return D(this,void 0,void 0,function*(){if(t!==gp)return t;const a=yield this.getDevices(e),s=a.find(u=>u.deviceId===gp);if(!s){ct.warn("could not reliably determine default device");return}const l=a.find(u=>u.deviceId!==gp&&u.groupId===(r??s.groupId));if(!l){ct.warn("could not reliably determine default device");return}return l==null?void 0:l.deviceId})}hasDeviceInUse(e){return e?vn.userMediaPromiseMap.has(e):vn.userMediaPromiseMap.size>0}}vn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];vn.userMediaPromiseMap=new Map;var tc;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(tc||(tc={}));class tx{constructor(){this.pendingTasks=new Map,this.taskMutex=new Qn,this.nextTaskIndex=0}run(e){return D(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:tc.WAITING};this.pendingTasks.set(t.id,t);const r=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=tc.RUNNING,yield e()}finally{t.status=tc.COMPLETED,this.pendingTasks.delete(t.id),r()}})}flush(){return D(this,void 0,void 0,function*(){return this.run(()=>D(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class nx{get readyState(){return this.ws.readyState}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r,a;if(!((r=t.signal)===null||r===void 0)&&r.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const s=new WebSocket(e,(a=t.protocols)!==null&&a!==void 0?a:[]);s.binaryType="arraybuffer",this.ws=s;const l=function(){let{closeCode:u,reason:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s.close(u,h)};this.opened=new Promise((u,h)=>{s.onopen=()=>{u({readable:new ReadableStream({start(f){s.onmessage=v=>{let{data:C}=v;return f.enqueue(C)},s.onerror=v=>f.error(v)},cancel:l}),writable:new WritableStream({write(f){s.send(f)},abort(){s.close()},close:l}),protocol:s.protocol,extensions:s.extensions}),s.removeEventListener("error",h)},s.addEventListener("error",h)}),this.closed=new Promise((u,h)=>{const f=()=>D(this,void 0,void 0,function*(){const v=new Promise(x=>{s.readyState!==WebSocket.CLOSED&&s.addEventListener("close",T=>{x(T)},{once:!0})}),C=yield Promise.race([Yn(250),v]);C?u(C):h(new Error("Encountered unspecified websocket error without a timely close event"))});s.onclose=v=>{let{code:C,reason:x}=v;u({closeCode:C,reason:x}),s.removeEventListener("error",f)},s.addEventListener("error",f)}),t.signal&&(t.signal.onabort=()=>s.close()),this.close=l}}function rx(n,e){const t=new URL(B2(n));return e.forEach((r,a)=>{t.searchParams.set(a,r)}),D1(t,"rtc")}function ix(n){const e=new URL(ef(n));return D1(e,"validate")}function ax(n){return n.endsWith("/")?n:"".concat(n,"/")}function D1(n,e){return n.pathname="".concat(ax(n.pathname)).concat(e),n.toString()}function _b(n){if(typeof n=="string")return nb.fromJson(JSON.parse(n),{ignoreUnknownFields:!0});if(n instanceof ArrayBuffer)return nb.fromBinary(new Uint8Array(n));throw new Error("could not decode websocket message: ".concat(typeof n))}function ox(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(n instanceof AbortSignal))return e;const t=n.reason;switch(typeof t){case"string":return t;case"object":return t instanceof Error?t.message:e;default:return"toString"in t?t.toString():e}}const sx=["syncState","trickle","offer","answer","simulate","leave"];function lx(n){const e=sx.indexOf(n.case)>=0;return ct.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var zt;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})(zt||(zt={}));const cx=250;class Jf{get currentState(){return this.state}get isDisconnected(){return this.state===zt.DISCONNECTING||this.state===zt.DISCONNECTED}get isEstablishingConnection(){return this.state===zt.CONNECTING||this.state===zt.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=zt.DISCONNECTED,this.log=ct,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=aa((r=t.loggerName)!==null&&r!==void 0?r:di.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new tx,this.queuedRequests=[],this.closingLock=new Qn,this.connectionLock=new Qn,this.state=zt.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,r,a){return D(this,void 0,void 0,function*(){return this.state=zt.CONNECTING,this.options=r,yield this.connect(e,t,r,a)})}reconnect(e,t,r,a){return D(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=zt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:a}))})}connect(e,t,r,a){return D(this,void 0,void 0,function*(){const s=yield this.connectionLock.lock();this.connectOptions=r;const l=U2(),u=r.singlePeerConnection?dx(t,l,r):ux(t,l,r),h=rx(e,u),f=ix(h);return new Promise((v,C)=>D(this,void 0,void 0,function*(){var x,T;try{let N=!1;const L=A=>D(this,void 0,void 0,function*(){if(N)return;N=!0;const U=A instanceof Event?A.currentTarget:A,Z=ox(U,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(Z)).catch(oe=>{this.log.error(oe),this.close()}):this.close(),$(),C(U instanceof AbortSignal?U.reason:U)});a==null||a.addEventListener("abort",L);const $=()=>{clearTimeout(V),a==null||a.removeEventListener("abort",L)},V=setTimeout(()=>{L(new kt("room connection has timed out (signal)",mt.ServerUnreachable))},r.websocketTimeout),K=(A,U)=>{this.handleSignalConnected(A,V,U)},F=new URL(h);F.searchParams.has("access_token")&&F.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(F),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new nx(h);try{this.ws.closed.then(J=>{this.isEstablishingConnection&&C(new kt("Websocket got closed during a (re)connection attempt: ".concat(J.reason),mt.InternalError)),J.closeCode!==1e3&&this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:J.reason,code:J.closeCode,wasClean:J.closeCode===1e3,state:this.state}))}).catch(J=>{this.isEstablishingConnection&&C(new kt("Websocket error during a (re)connection attempt: ".concat(J),mt.InternalError))});const A=yield this.ws.opened.catch(J=>D(this,void 0,void 0,function*(){if(this.state!==zt.CONNECTED){this.state=zt.DISCONNECTED,clearTimeout(V);const Y=yield this.handleConnectionError(J,f);C(Y);return}this.handleWSError(J),C(J)}));if(clearTimeout(V),!A)return;const U=A.readable.getReader();this.streamWriter=A.writable.getWriter();const Z=yield U.read();if(U.releaseLock(),!Z.value)throw new kt("no message received as first message",mt.InternalError);const oe=_b(Z.value),X=this.validateFirstMessage(oe,(x=r.reconnect)!==null&&x!==void 0?x:!1);if(!X.isValid){C(X.error);return}((T=oe.message)===null||T===void 0?void 0:T.case)==="join"&&(this.pingTimeoutDuration=oe.message.value.pingTimeout,this.pingIntervalDuration=oe.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const H=X.shouldProcessFirstMessage?oe:void 0;K(A,H),v(X.response)}catch(A){C(A)}finally{$()}}finally{s()}}))})}startReadingLoop(e,t){return D(this,void 0,void 0,function*(){for(t&&this.handleSignalResponse(t);;){this.signalLatency&&(yield Yn(this.signalLatency));const{done:r,value:a}=yield e.read();if(r)break;const s=_b(a);this.handleSignalResponse(s)}})}close(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return function*(){const a=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=zt.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:r});const s=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([s,Yn(cx)])}}catch(s){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:s}))}finally{t&&(e.state=zt.DISCONNECTED),a()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Ms(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Ms(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Id({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Od({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return D(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const u=s.getNextRequestId();return yield s.sendRequest({case:"updateMetadata",value:new Vf({requestId:u,metadata:r,name:a,attributes:l})}),u}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new q0({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new G0({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ut.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Z0({timestamp:Ut.parse(Date.now()),rtt:Ut.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new Bf({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new Md({reason:ui.CLIENT_INITIATED,action:Ds.DISCONNECT})})}sendRequest(e){return D(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!a&&!lx(t)&&r.state===zt.RECONNECTING){r.queuedRequests.push(()=>D(r,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(a||(yield r.requestQueue.flush()),r.signalLatency&&(yield Yn(r.signalLatency)),r.isDisconnected){r.log.debug("skipping signal request (type: ".concat(t.case,") - SignalClient disconnected"));return}if(!r.streamWriter){r.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),r.logContext);return}const s=new wT({message:t});try{r.useJSON?yield r.streamWriter.write(s.toJsonString()):yield r.streamWriter.write(s.toBinary())}catch(l){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:l}))}}()})}handleSignalResponse(e){var t,r;const a=e.message;if(a==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(a.case==="answer"){const l=Rb(a.value);this.onAnswer&&this.onAnswer(l,a.value.id,a.value.midToTrackId)}else if(a.case==="offer"){const l=Rb(a.value);this.onOffer&&this.onOffer(l,a.value.id,a.value.midToTrackId)}else if(a.case==="trickle"){const l=JSON.parse(a.value.candidateInit);this.onTrickle&&this.onTrickle(l,a.value.target)}else a.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=a.value.participants)!==null&&t!==void 0?t:[]):a.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(a.value):a.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=a.value.speakers)!==null&&r!==void 0?r:[]):a.case==="leave"?this.onLeave&&this.onLeave(a.value):a.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(a.value.sid,a.value.muted):a.case==="roomUpdate"?this.onRoomUpdate&&a.value.room&&this.onRoomUpdate(a.value.room):a.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(a.value):a.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(a.value):a.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(a.value):a.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(a.value):a.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(a.value):a.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(a.value):a.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(a.value):a.case==="pong"||(a.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(a.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):a.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(a.value):a.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(a.value.trackSid):a.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(a.value.token),this.onRoomMoved&&this.onRoomMoved(a.value)):a.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(a.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:a.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return D(this,void 0,void 0,function*(){if(this.state===zt.DISCONNECTED)return;const t=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Pn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Pn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Pn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Pn.clearInterval(this.pingInterval)}handleSignalConnected(e,t,r){this.state=zt.CONNECTED,clearTimeout(t),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),r)}validateFirstMessage(e,t){var r,a,s,l,u;return((r=e.message)===null||r===void 0?void 0:r.case)==="join"?{isValid:!0,response:e.message.value}:this.state===zt.RECONNECTING&&((a=e.message)===null||a===void 0?void 0:a.case)!=="leave"?((s=e.message)===null||s===void 0?void 0:s.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((l=e.message)===null||l===void 0?void 0:l.case)==="leave"?{isValid:!1,error:new kt("Received leave request while trying to (re)connect",mt.LeaveRequest,void 0,e.message.value.reason)}:t?{isValid:!1,error:new kt("Unexpected first message",mt.InternalError)}:{isValid:!1,error:new kt("did not receive join response, got ".concat((u=e.message)===null||u===void 0?void 0:u.case," instead"),mt.InternalError)}}handleConnectionError(e,t){return D(this,void 0,void 0,function*(){try{const r=yield fetch(t);if(r.status.toFixed(0).startsWith("4")){const a=yield r.text();return new kt(a,mt.NotAllowed,r.status)}else return e instanceof kt?e:new kt("Encountered unknown websocket error during connection: ".concat(e),mt.InternalError,r.status)}catch(r){return r instanceof kt?r:new kt(r instanceof Error?r.message:"server was not reachable",mt.ServerUnreachable)}})}}function Rb(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function Ms(n,e){return new Va({sdp:n.sdp,type:n.type,id:e})}function ux(n,e,t){var r;const a=new URLSearchParams;return a.set("access_token",n),t.reconnect&&(a.set("reconnect","1"),t.sid&&a.set("sid",t.sid)),a.set("auto_subscribe",t.autoSubscribe?"1":"0"),a.set("sdk",Oi()?"reactnative":"js"),a.set("version",e.version),a.set("protocol",e.protocol.toString()),e.deviceModel&&a.set("device_model",e.deviceModel),e.os&&a.set("os",e.os),e.osVersion&&a.set("os_version",e.osVersion),e.browser&&a.set("browser",e.browser),e.browserVersion&&a.set("browser_version",e.browserVersion),t.adaptiveStream&&a.set("adaptive_stream","1"),t.reconnectReason&&a.set("reconnect_reason",t.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&a.set("network",navigator.connection.type),a}function dx(n,e,t){const r=new URLSearchParams;r.set("access_token",n);const a=new WT({clientInfo:e,connectionSettings:new Q0({autoSubscribe:!!t.autoSubscribe,adaptiveStream:!!t.adaptiveStream}),reconnect:!!t.reconnect,participantSid:t.sid?t.sid:void 0});t.reconnectReason&&(a.reconnectReason=t.reconnectReason);const s=new zT({joinRequest:a.toBinary()});return r.set("join_request",btoa(new TextDecoder("utf-8").decode(s.toBinary()))),r}class Ib{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class hx{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const r=Date.now();r-this._lastCleanup>this.ttl/2&&this.cleanup();const a=r+this.ttl;return this._map.set(e,{value:t,expiresAt:a}),this}get(e){const t=this._map.get(e);if(t){if(t.expiresAt<Date.now()){this._map.delete(e);return}return t.value}}has(e){const t=this._map.get(e);return t?t.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,r]of this._map.entries())r.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e(r.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],r=this.asValueMap();for(const[a,s]of r.entries())t.push(e(s,a,r));return t}asValueMap(){const e=new Map;for(const[t,r]of this._map.entries())r.expiresAt>=Date.now()&&e.set(t,r.value);return e}}var ii={},Ob={},vp={exports:{}},Ab;function Zf(){if(Ab)return vp.exports;Ab=1;var n=vp.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),vp.exports}var Mb;function px(){return Mb||(Mb=1,function(n){var e=function(u){return String(Number(u))===u?Number(u):u},t=function(u,h,f,v){if(v&&!f)h[v]=e(u[1]);else for(var C=0;C<f.length;C+=1)u[C+1]!=null&&(h[f[C]]=e(u[C+1]))},r=function(u,h,f){var v=u.name&&u.names;u.push&&!h[u.push]?h[u.push]=[]:v&&!h[u.name]&&(h[u.name]={});var C=u.push?{}:v?h[u.name]:h;t(f.match(u.reg),C,u.names,u.name),u.push&&h[u.push].push(C)},a=Zf(),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(u){var h={},f=[],v=h;return u.split(/(\r\n|\r|\n)/).filter(s).forEach(function(C){var x=C[0],T=C.slice(2);x==="m"&&(f.push({rtp:[],fmtp:[]}),v=f[f.length-1]);for(var N=0;N<(a[x]||[]).length;N+=1){var L=a[x][N];if(L.reg.test(T))return r(L,v,T)}}),h.media=f,h};var l=function(u,h){var f=h.split(/=(.+)/,2);return f.length===2?u[f[0]]=e(f[1]):f.length===1&&h.length>1&&(u[f[0]]=void 0),u};n.parseParams=function(u){return u.split(/;\s?/).reduce(l,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(u){return u.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(u){for(var h=[],f=u.split(" ").map(e),v=0;v<f.length;v+=3)h.push({component:f[v],ip:f[v+1],port:f[v+2]});return h},n.parseImageAttributes=function(u){return u.split(" ").map(function(h){return h.substring(1,h.length-1).split(",").reduce(l,{})})},n.parseSimulcastStreamList=function(u){return u.split(";").map(function(h){return h.split(",").map(function(f){var v,C=!1;return f[0]!=="~"?v=e(f):(v=e(f.substring(1,f.length)),C=!0),{scid:v,paused:C}})})}}(Ob)),Ob}var bp,Lb;function fx(){if(Lb)return bp;Lb=1;var n=Zf(),e=/%[sdv%]/g,t=function(l){var u=1,h=arguments,f=h.length;return l.replace(e,function(v){if(u>=f)return v;var C=h[u];switch(u+=1,v){case"%%":return"%";case"%s":return String(C);case"%d":return Number(C);case"%v":return""}})},r=function(l,u,h){var f=u.format instanceof Function?u.format(u.push?h:h[u.name]):u.format,v=[l+"="+f];if(u.names)for(var C=0;C<u.names.length;C+=1){var x=u.names[C];u.name?v.push(h[u.name][x]):v.push(h[u.names[C]])}else v.push(h[u.name]);return t.apply(null,v)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];return bp=function(l,u){u=u||{},l.version==null&&(l.version=0),l.name==null&&(l.name=" "),l.media.forEach(function(C){C.payloads==null&&(C.payloads="")});var h=u.outerOrder||a,f=u.innerOrder||s,v=[];return h.forEach(function(C){n[C].forEach(function(x){x.name in l&&l[x.name]!=null?v.push(r(C,x,l)):x.push in l&&l[x.push]!=null&&l[x.push].forEach(function(T){v.push(r(C,x,T))})})}),l.media.forEach(function(C){v.push(r("m",n.m[0],C)),f.forEach(function(x){n[x].forEach(function(T){T.name in C&&C[T.name]!=null?v.push(r(x,T,C)):T.push in C&&C[T.push]!=null&&C[T.push].forEach(function(N){v.push(r(x,T,N))})})})}),v.join(`\r
`)+`\r
`},bp}var Nb;function mx(){if(Nb)return ii;Nb=1;var n=px(),e=fx(),t=Zf();return ii.grammar=t,ii.write=e,ii.parse=n.parse,ii.parseParams=n.parseParams,ii.parseFmtpConfig=n.parseFmtpConfig,ii.parsePayloads=n.parsePayloads,ii.parseRemoteCandidates=n.parseRemoteCandidates,ii.parseImageAttributes=n.parseImageAttributes,ii.parseSimulcastStreamList=n.parseSimulcastStreamList,ii}var Aa=mx();function Qf(n,e,t){var r,a,s;e===void 0&&(e=50),t===void 0&&(t={});var l=(r=t.isImmediate)!=null&&r,u=(a=t.callback)!=null&&a,h=t.maxWait,f=Date.now(),v=[];function C(){if(h!==void 0){var T=Date.now()-f;if(T+e>=h)return h-T}return e}var x=function(){var T=[].slice.call(arguments),N=this;return new Promise(function(L,$){var V=l&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,f=Date.now(),!l){var F=n.apply(N,T);u&&u(F),v.forEach(function(A){return(0,A.resolve)(F)}),v=[]}},C()),V){var K=n.apply(N,T);return u&&u(K),L(K)}v.push({resolve:L,reject:$})})};return x.cancel=function(T){s!==void 0&&clearTimeout(s),v.forEach(function(N){return(0,N.reject)(T)}),v=[]},x}const gx=.7,vx=20,Vs={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class jb extends Mi.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=ct,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Qf(a=>D(this,void 0,void 0,function*(){this.emit(Vs.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(a)a(s);else throw s}}),vx),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=aa((r=t.loggerName)!==null&&r!==void 0?r:di.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new Qn}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var r;t.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,t.candidate))},e.onicecandidateerror=t=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,t)},e.ontrack=t=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return D(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return D(this,void 0,void 0,function*(){var r;if(e.type==="answer"&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let a;if(e.type==="offer"){let{stereoMids:s,nackMids:l}=bx(e);this.remoteStereoMids=s,this.remoteNackMids=l}else if(e.type==="answer"){const s=Aa.parse((r=e.sdp)!==null&&r!==void 0?r:"");s.media.forEach(l=>{const u=Yf(l.mid);l.type==="audio"&&this.trackBitrates.some(h=>{if(!h.transceiver||u!=h.transceiver.mid)return!1;let f=0;if(l.rtp.some(C=>C.codec.toUpperCase()===h.codec.toUpperCase()?(f=C.payload,!0):!1),f===0)return!0;let v=!1;for(const C of l.fmtp)if(C.payload===f){C.config=C.config.split(";").filter(x=>!x.includes("maxaveragebitrate")).join(";"),h.maxbr>0&&(C.config+=";maxaveragebitrate=".concat(h.maxbr*1e3)),v=!0;break}return v||h.maxbr>0&&l.fmtp.push({payload:f,config:"maxaveragebitrate=".concat(h.maxbr*1e3)}),!0})}),a=Aa.write(s)}return yield this.setMungedSDP(e,a,!0),this.pendingCandidates.forEach(s=>{this.pc.addIceCandidate(s)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Vs.NegotiationComplete),e.sdp&&Aa.parse(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(Vs.RTPVideoPayloadTypes,s.rtp)})),!0})}createAndSendOffer(e){return D(this,void 0,void 0,function*(){var t;const r=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const u=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&u)yield this._pc.setRemoteDescription(u);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const a=this.latestOfferId+1;this.latestOfferId=a;const s=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:s.sdp},this.logContext));const l=Aa.parse((t=s.sdp)!==null&&t!==void 0?t:"");if(l.media.forEach(u=>{Ub(u),u.type==="audio"?Db(u,["all"],[]):u.type==="video"&&this.trackBitrates.some(h=>{if(!u.msid||!h.cid||!u.msid.includes(h.cid))return!1;let f=0;if(u.rtp.some(C=>C.codec.toUpperCase()===h.codec.toUpperCase()?(f=C.payload,!0):!1),f===0||(_i(h.codec)&&!jo()&&this.ensureVideoDDExtensionForSVC(u,l),h.codec!=="av1"))return!0;const v=Math.round(h.maxbr*gx);for(const C of u.fmtp)if(C.payload===f){C.config.includes("x-google-start-bitrate")||(C.config+=";x-google-start-bitrate=".concat(v));break}return!0})}),this.latestOfferId>a){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:a}));return}yield this.setMungedSDP(s,Aa.write(l)),this.onOffer(s,this.latestOfferId)}finally{r()}})}createAndSetAnswer(){return D(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),r=Aa.parse((e=t.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(a=>{Ub(a),a.type==="audio"&&Db(a,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Aa.write(r)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTransceiverOfKind(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new ln("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new ln("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return D(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const r=new Map,a=new Map;if((yield this._pc.getStats()).forEach(l=>{switch(l.type){case"transport":t=l.selectedCandidatePairId;break;case"candidate-pair":t===""&&l.selected&&(t=l.id),r.set(l.id,l);break;case"remote-candidate":a.set(l.id,"".concat(l.address,":").concat(l.port));break}}),t==="")return;const s=(e=r.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(s!==void 0)return a.get(s)})}setMungedSDP(e,t,r){return D(this,void 0,void 0,function*(){if(t){const a=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:t})),e.sdp=a}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(a){let s="unknown error";a instanceof Error?s=a.message:typeof a=="string"&&(s=a);const l={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(l.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:l})),new Gp(s)}})}ensureVideoDDExtensionForSVC(e,t){var r,a;if(!(!((r=e.ext)===null||r===void 0)&&r.some(s=>s.uri===wb))){if(this.ddExtID===0){let s=0;t.media.forEach(l=>{var u;l.type==="video"&&((u=l.ext)===null||u===void 0||u.forEach(h=>{h.value>s&&(s=h.value)}))}),this.ddExtID=s+1}(a=e.ext)===null||a===void 0||a.push({value:this.ddExtID,uri:wb})}}}function Db(n,e,t){const r=Yf(n.mid);let a=0;n.rtp.some(s=>s.codec==="opus"?(a=s.payload,!0):!1),a>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(r)&&!n.rtcpFb.some(s=>s.payload===a&&s.type==="nack")&&n.rtcpFb.push({payload:a,type:"nack"}),(e.includes(r)||e.length===1&&e[0]==="all")&&n.fmtp.some(s=>s.payload===a?(s.config.includes("stereo=1")||(s.config+=";stereo=1"),!0):!1))}function bx(n){var e;const t=[],r=[],a=Aa.parse((e=n.sdp)!==null&&e!==void 0?e:"");let s=0;return a.media.forEach(l=>{var u;const h=Yf(l.mid);l.type==="audio"&&(l.rtp.some(f=>f.codec==="opus"?(s=f.payload,!0):!1),!((u=l.rtcpFb)===null||u===void 0)&&u.some(f=>f.payload===s&&f.type==="nack")&&r.push(h),l.fmtp.some(f=>f.payload===s?(f.config.includes("sprop-stereo=1")&&t.push(h),!0):!1))}),{stereoMids:t,nackMids:r}}function Ub(n){if(n.connection){const e=n.connection.ip.indexOf(":")>=0;(n.connection.version===4&&e||n.connection.version===6&&!e)&&(n.connection.ip="0.0.0.0",n.connection.version=4)}}function Yf(n){return typeof n=="number"?n.toFixed(0):n}const af="vp8",yx={audioPreset:Kp.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Gf.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:af,backupCodec:!0,preConnectBuffer:!1},U1={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},F1={deviceId:{ideal:"default"},resolution:fc.h720.resolution},wx={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new XT,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!1},Xf={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Gt;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})(Gt||(Gt={}));class kx{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,r){var a;this.peerConnectionTimeout=Xf.peerConnectionTimeout,this.log=ct,this.updateState=()=>{var s,l;const u=this.state,h=this.requiredTransports.map(f=>f.getConnectionState());h.every(f=>f==="connected")?this.state=Gt.CONNECTED:h.some(f=>f==="failed")?this.state=Gt.FAILED:h.some(f=>f==="connecting")?this.state=Gt.CONNECTING:h.every(f=>f==="closed")?this.state=Gt.CLOSED:h.some(f=>f==="closed")?this.state=Gt.CLOSING:h.every(f=>f==="new")&&(this.state=Gt.NEW),u!==this.state&&(this.log.debug("pc state change: from ".concat(Gt[u]," to ").concat(Gt[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),(l=this.subscriber)===null||l===void 0?void 0:l.getConnectionState()))},this.log=aa((a=r.loggerName)!==null&&a!==void 0?a:di.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=t!=="subscriber-primary",this.isSubscriberConnectionRequired=t==="subscriber-primary",this.publisher=new jb(e,r),t!=="publisher-only"&&(this.subscriber=new jb(e,r),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=s=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,s,ci.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var l;(l=this.onDataChannel)===null||l===void 0||l.call(this,s)},this.subscriber.onTrack=s=>{var l;(l=this.onTrack)===null||l===void 0||l.call(this,s)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,s,ci.PUBLISHER)},this.publisher.onTrack=s=>{var l;(l=this.onTrack)===null||l===void 0||l.call(this,s)},this.publisher.onOffer=(s,l)=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,s,l)},this.state=Gt.NEW,this.connectionLock=new Qn,this.remoteOfferLock=new Qn}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return D(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const t=this.publisher;for(const r of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(r)}catch(a){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:a}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return D(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return D(this,void 0,void 0,function*(){var r;t===ci.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(r=this.subscriber)===null||r===void 0?void 0:r.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return D(this,void 0,void 0,function*(){var r,a,s;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(r=this.subscriber)===null||r===void 0?void 0:r.getSignallingState().toString()}));const l=yield this.remoteOfferLock.lock();try{return(yield(a=this.subscriber)===null||a===void 0?void 0:a.setRemoteDescription(e,t))?yield(s=this.subscriber)===null||s===void 0?void 0:s.createAndSetAnswer():void 0}finally{l()}})}updateConfiguration(e,t){var r;this.publisher.setConfiguration(e),(r=this.subscriber)===null||r===void 0||r.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return D(this,void 0,void 0,function*(){var r;const a=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,t)))}finally{a()}})}negotiate(e){return D(this,void 0,void 0,function*(){return new Promise((t,r)=>D(this,void 0,void 0,function*(){const a=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(a),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(Vs.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Vs.NegotiationComplete,()=>{clearTimeout(a),t()})}),yield this.publisher.negotiate(l=>{clearTimeout(a),r(l)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTransceiverOfKind(e,t){return this.publisher.addTransceiverOfKind(e,t)}getMidForReceiver(e){const t=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(r=>r.receiver===e);return t==null?void 0:t.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===ci.PUBLISHER?this.publisher.getConnectedAddress():e===ci.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return D(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((u,h)=>D(s,void 0,void 0,function*(){const f=()=>{this.log.warn("abort transport connection",this.logContext),Pn.clearTimeout(v),h(new kt("room connection has been cancelled",mt.Cancelled))};a!=null&&a.signal.aborted&&f(),a==null||a.signal.addEventListener("abort",f);const v=Pn.setTimeout(()=>{a==null||a.signal.removeEventListener("abort",f),h(new kt("could not establish pc connection",mt.InternalError))},l);for(;this.state!==Gt.CONNECTED;)if(yield Yn(50),a!=null&&a.signal.aborted){h(new kt("room connection has been cancelled",mt.Cancelled));return}Pn.clearTimeout(v),a==null||a.signal.removeEventListener("abort",f),u()}))}()})}}const B1=5e3;class cn{static fetchRegionSettings(e,t,r){return D(this,void 0,void 0,function*(){const a=yield cn.fetchLock.lock();try{const s=yield fetch("".concat(Cx(e),"/regions"),{headers:{authorization:"Bearer ".concat(t)},signal:r});if(s.ok){const l=H2(s.headers),u=l?l*1e3:B1;return{regionSettings:yield s.json(),updatedAtInMs:Date.now(),maxAgeInMs:u}}else throw new kt("Could not fetch region settings: ".concat(s.statusText),s.status===401?mt.NotAllowed:mt.InternalError,s.status)}finally{a()}})}static scheduleRefetch(e,t,r){return D(this,void 0,void 0,function*(){const a=cn.settingsTimeouts.get(e.hostname);clearTimeout(a),cn.settingsTimeouts.set(e.hostname,setTimeout(()=>D(this,void 0,void 0,function*(){try{const s=yield cn.fetchRegionSettings(e,t);cn.updateCachedRegionSettings(e,t,s)}catch(s){ct.debug("auto refetching of region settings failed",{error:s}),cn.scheduleRefetch(e,t,r)}}),r))})}static updateCachedRegionSettings(e,t,r){cn.cache.set(e.hostname,r),cn.scheduleRefetch(e,t,r.maxAgeInMs)}constructor(e,t){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Xp(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return D(this,void 0,void 0,function*(){return cn.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return D(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let t=cn.cache.get(this.serverUrl.hostname);(!t||Date.now()-t.updatedAtInMs>t.maxAgeInMs)&&(t=yield this.fetchRegionSettings(e),cn.updateCachedRegionSettings(this.serverUrl,this.token,t));const r=t.regionSettings.regions.filter(a=>!this.attemptedRegions.find(s=>s.url===a.url));if(r.length>0){const a=r[0];return this.attemptedRegions.push(a),ct.debug("next region: ".concat(a.region)),a.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){cn.updateCachedRegionSettings(this.serverUrl,this.token,e)}}cn.cache=new Map;cn.settingsTimeouts=new Map;cn.fetchLock=new Qn;function Cx(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}class Jt extends Error{constructor(e,t,r){super(t),this.code=e,this.message=Fb(t,Jt.MAX_MESSAGE_BYTES),this.data=r?Fb(r,Jt.MAX_DATA_BYTES):void 0}static fromProto(e){return new Jt(e.code,e.message,e.data)}toProto(){return new A0({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Jt(Jt.ErrorCode[e],Jt.ErrorMessage[e],t)}}Jt.MAX_MESSAGE_BYTES=256;Jt.MAX_DATA_BYTES=15360;Jt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Jt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const V1=15360;function em(n){return new TextEncoder().encode(n).length}function Fb(n,e){if(em(n)<=e)return n;let t=0,r=n.length;const a=new TextEncoder;for(;t<r;){const s=Math.floor((t+r+1)/2);a.encode(n.slice(0,s)).length<=e?t=s:r=s-1}return n.slice(0,t)}const tm=2e3;function Nd(n,e){if(!e)return 0;let t,r;return"bytesReceived"in n?(t=n.bytesReceived,r=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,r=e.bytesSent),t===void 0||r===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-r)*8*1e3/(n.timestamp-e.timestamp)}const nm=typeof MediaRecorder<"u";class Sx{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const Tx=nm?MediaRecorder:Sx;class xx extends Tx{constructor(e,t){if(!nm)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),t);let r,a;const s=()=>a===void 0,l=()=>{this.removeEventListener("dataavailable",r),this.removeEventListener("stop",l),this.removeEventListener("error",u),a==null||a.close(),a=void 0},u=h=>{a==null||a.error(h),this.removeEventListener("dataavailable",r),this.removeEventListener("stop",l),this.removeEventListener("error",u),a=void 0};this.byteStream=new ReadableStream({start:h=>{a=h,r=f=>D(this,void 0,void 0,function*(){let v;if(f.data.arrayBuffer){const C=yield f.data.arrayBuffer();v=new Uint8Array(C)}else if(f.data.byteArray)v=f.data.byteArray;else throw new Error("no data available!");s()||h.enqueue(v)}),this.addEventListener("dataavailable",r)},cancel:()=>{l()}}),this.addEventListener("stop",l),this.addEventListener("error",u)}}function Ex(){return nm}const Px=1e3,_x=1e4;class W1 extends me{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(e,t,s),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Qf(()=>D(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>D(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(xe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=a,this.muteLock=new Qn,this.pauseUpstreamLock=new Qn,this.trackChangeLock=new Qn,this.trackChangeLock.lock().then(l=>D(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{l()}})),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==me.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return D(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(s=>{Fs(this._mediaStreamTrack,s)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let a;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(As(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),a=this.processor.processedTrack}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(a??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(s=>{As(a??e,s)}))})}waitForDimensions(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Px;return function*(){var r;if(e.kind===me.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=hr())===null||r===void 0?void 0:r.os)==="iOS"&&(yield Yn(10));const a=Date.now();for(;Date.now()-a<t;){const s=e.dimensions;if(s)return s;yield Yn(50)}throw new na("unable to get track dimensions after timeout")}()})}setDeviceId(e){return D(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Fa(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Fa(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===me.Source.ScreenShare)return;const{deviceId:r,groupId:a}=e._mediaStreamTrack.getSettings(),s=e.kind===me.Kind.Audio?"audioinput":"videoinput";return t?vn.getInstance().normalizeDeviceId(s,r,a):r}()})}mute(){return D(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return D(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return D(this,void 0,void 0,function*(){const r=yield this.trackChangeLock.lock();try{if(!this.sender)throw new na("unable to replace an unpublished track");let a,s;return typeof t=="boolean"?a=t:t!==void 0&&(a=t.userProvidedTrack,s=t.stopProcessor),this.providedByUser=a??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),s&&this.processor&&(yield this.internalStopProcessor()),this}finally{r()}})}restart(e){return D(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:a}=e,s=e2(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const l={audio:!1,video:!1};this.kind===me.Kind.Video?l.video=r||a?{deviceId:r,facingMode:a}:!0:l.audio=r?Object.assign({deviceId:r},s):!0,this.attachedElements.forEach(h=>{Fs(this.mediaStreamTrack,h)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const u=(yield navigator.mediaDevices.getUserMedia(l)).getTracks()[0];return this.kind===me.Kind.Video&&(yield u.applyConstraints(s)),u.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(u),this._constraints=e,this.emit(xe.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xe.Muted:xe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return D(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),I1()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return D(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(xe.UpstreamPaused,this);const r=hr();if((r==null?void 0:r.name)==="Safari"&&Ai(r.version,"12.0")<0)throw new Hf("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return D(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(xe.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return D(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return D(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;const l=yield r.trackChangeLock.lock();try{r.log.debug("setting up processor",r.logContext);const u=document.createElement(r.kind),h={kind:r.kind,track:r._mediaStreamTrack,element:u,audioContext:r.audioContext};if(yield t.init(h),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.internalStopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(As(r._mediaStreamTrack,u),u.muted=!0,u.play().catch(f=>{f instanceof DOMException&&f.name==="AbortError"?(r.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},r.logContext),{error:f})),setTimeout(()=>{u.play().catch(v=>{r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{err:v}))})},100)):r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:f}))}),r.processor=t,r.processorElement=u,r.processor.processedTrack){for(const f of r.attachedElements)f!==r.processorElement&&a&&(Fs(r._mediaStreamTrack,f),As(r.processor.processedTrack,f));yield(s=r.sender)===null||s===void 0?void 0:s.replaceTrack(r.processor.processedTrack)}r.emit(xe.TrackProcessorUpdate,r.processor)}finally{l()}}()})}getProcessor(){return this.processor}stopProcessor(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{r()}}()})}internalStopProcessor(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,a;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,t||((a=e.processorElement)===null||a===void 0||a.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(xe.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!Ex()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let t="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(t)||(t="video/mp4"),this.localTrackRecorder=new xx(this,{mimeType:t})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},_x)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class bd extends W1{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,me.Kind.Audio,t,r,s),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>D(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(u){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:u}));return}l&&this.prevStats&&(this._currentBitrate=Nd(l,this.prevStats)),this.prevStats=l}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(xe.AudioTrackFeatureUpdate,this,gn.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(xe.AudioTrackFeatureUpdate,this,gn.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=a,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===me.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Fa(this._constraints.deviceId);return this.source===me.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return D(this,void 0,void 0,function*(){let t;if(e){const r=Kf({audio:e});typeof r.audio!="boolean"&&(t=r.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return D(this,void 0,void 0,function*(){const r=yield t.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){dr()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},tm)))}setProcessor(e){return D(this,void 0,void 0,function*(){var t;const r=yield this.trackChangeLock.lock();try{if(!Oi()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const a={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(a),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(xe.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return D(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let r;return t.forEach(a=>{a.type==="outbound-rtp"&&(r={type:"audio",streamId:a.id,packetsSent:a.packetsSent,packetsLost:a.packetsLost,bytesSent:a.bytesSent,timestamp:a.timestamp,roundTripTime:a.roundTripTime,jitter:a.jitter})}),r})}checkForSilence(){return D(this,void 0,void 0,function*(){const e=yield L1(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(xe.AudioSilenceDetected)),e})}}function Rx(n,e,t){switch(n.kind){case"audio":return new bd(n,e,!1,void 0,t);case"video":return new yd(n,e,!1,t);default:throw new na("unsupported track type: ".concat(n.kind))}}const Ix=Object.values(fc),Ox=Object.values(Jp),Ax=Object.values(Gf),Mx=[fc.h180,fc.h360],Lx=[Jp.h180,Jp.h360],Nx=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(e=>{var t,r;return new _t(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*(((t=n.encoding.maxFramerate)!==null&&t!==void 0?t:30)/((r=e.fps)!==null&&r!==void 0?r:30))))),e.fps,n.encoding.priority)}),of=["q","h","f"];function sf(n,e,t,r){var a,s;let l=r==null?void 0:r.videoEncoding;n&&(l=r==null?void 0:r.screenShareEncoding);const u=r==null?void 0:r.simulcast,h=r==null?void 0:r.scalabilityMode,f=r==null?void 0:r.videoCodec;if(!l&&!u&&!h||!e||!t)return[{}];l||(l=Dx(n,e,t,f),ct.debug("using video encoding",l));const v=l.maxFramerate,C=new _t(e,t,l.maxBitrate,l.maxFramerate,l.priority);if(h&&_i(f)){const N=new z1(h),L=[];if(N.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(h));const $=hr();if(mc()||Oi()||($==null?void 0:$.name)==="Chrome"&&Ai($==null?void 0:$.version,"113")<0){const V=N.suffix=="h"?2:3,K=L2($);for(let F=0;F<N.spatial;F+=1)L.push({rid:of[2-F],maxBitrate:l.maxBitrate/Math.pow(V,F),maxFramerate:C.encoding.maxFramerate,scaleResolutionDownBy:K?Math.pow(2,F):void 0});L[0].scalabilityMode=h}else L.push({maxBitrate:l.maxBitrate,maxFramerate:C.encoding.maxFramerate,scalabilityMode:h});return C.encoding.priority&&(L[0].priority=C.encoding.priority,L[0].networkPriority=C.encoding.priority),ct.debug("using svc encoding",{encodings:L}),L}if(!u)return[l];let x=[];n?x=(a=Vb(r==null?void 0:r.screenShareSimulcastLayers))!==null&&a!==void 0?a:Bb(n,C):x=(s=Vb(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:Bb(n,C);let T;if(x.length>0){const N=x[0];x.length>1&&([,T]=x);const L=Math.max(e,t);if(L>=960&&T)return yp(e,t,[N,T,C],v);if(L>=480)return yp(e,t,[N,C],v)}return yp(e,t,[C])}function jx(n,e,t){var r,a,s,l;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&ct.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const u=n.mediaStreamTrack.getSettings(),h=(r=u.width)!==null&&r!==void 0?r:(a=n.dimensions)===null||a===void 0?void 0:a.width,f=(s=u.height)!==null&&s!==void 0?s:(l=n.dimensions)===null||l===void 0?void 0:l.height;return n.source===me.Source.ScreenShare&&t.simulcast&&(t.simulcast=!1),sf(n.source===me.Source.ScreenShare,h,f,t)}function Dx(n,e,t,r){const a=Ux(n,e,t);let{encoding:s}=a[0];const l=Math.max(e,t);for(let u=0;u<a.length;u+=1){const h=a[u];if(s=h.encoding,h.width>=l)break}if(r)switch(r){case"av1":case"h265":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function Ux(n,e,t){if(n)return Ax;const r=e>t?e/t:t/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?Ix:Ox}function Bb(n,e){if(n)return Nx(e);const{width:t,height:r}=e,a=t>r?t/r:r/t;return Math.abs(a-16/9)<Math.abs(a-4/3)?Mx:Lx}function yp(n,e,t,r){const a=[];if(t.forEach((s,l)=>{if(l>=of.length)return;const u=Math.min(n,e),h={rid:of[l],scaleResolutionDownBy:Math.max(1,u/Math.min(s.width,s.height)),maxBitrate:s.encoding.maxBitrate},f=r&&s.encoding.maxFramerate?Math.min(r,s.encoding.maxFramerate):s.encoding.maxFramerate;f&&(h.maxFramerate=f);const v=No()||l===0;s.encoding.priority&&v&&(h.priority=s.encoding.priority,h.networkPriority=s.encoding.priority),a.push(h)}),Oi()&&A1()==="ios"){let s;a.forEach(u=>{s?u.maxFramerate&&u.maxFramerate>s&&(s=u.maxFramerate):s=u.maxFramerate});let l=!0;a.forEach(u=>{var h;u.maxFramerate!=s&&(l&&(l=!1,ct.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),ct.info('Setting framerate of encoding "'.concat((h=u.rid)!==null&&h!==void 0?h:"",'" to ').concat(s)),u.maxFramerate=s)})}return a}function Vb(n){if(n)return n.sort((e,t)=>{const{encoding:r}=e,{encoding:a}=t;return r.maxBitrate>a.maxBitrate?1:r.maxBitrate<a.maxBitrate?-1:r.maxBitrate===a.maxBitrate&&r.maxFramerate&&a.maxFramerate?r.maxFramerate>a.maxFramerate?1:-1:0})}class z1{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function Fx(n){return n.source===me.Source.ScreenShare||n.constraints.height&&Fa(n.constraints.height)>=1080?"maintain-resolution":"balanced"}const Bx=5e3;class yd extends W1{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3?arguments[3]:void 0;super(e,me.Kind.Video,t,r,a),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>D(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(h){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:h}));return}const l=new Map(s.map(h=>[h.rid,h])),u=s.some(h=>h.qualityLimitationReason==="cpu");if(u!==this.isCpuConstrained&&(this.isCpuConstrained=u,this.isCpuConstrained&&this.emit(xe.CpuConstrained)),this.prevStats){let h=0;l.forEach((f,v)=>{var C;const x=(C=this.prevStats)===null||C===void 0?void 0:C.get(v);h+=Nd(f,x)}),this._currentBitrate=h}this.prevStats=l}),this.senderLock=new Qn}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!dr())return;const r=(t=this.sender)===null||t===void 0?void 0:t.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},tm))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return D(this,void 0,void 0,function*(){var t,r,a,s,l;yield e.pauseUpstream.call(this);try{for(var u=!0,h=ta(this.simulcastCodecs.values()),f;f=yield h.next(),t=f.done,!t;u=!0)s=f.value,u=!1,yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(null)}catch(v){r={error:v}}finally{try{!u&&!t&&(a=h.return)&&(yield a.call(h))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return D(this,void 0,void 0,function*(){var t,r,a,s,l;yield e.resumeUpstream.call(this);try{for(var u=!0,h=ta(this.simulcastCodecs.values()),f;f=yield h.next(),t=f.done,!t;u=!0){s=f.value,u=!1;const v=s;yield(l=v.sender)===null||l===void 0?void 0:l.replaceTrack(v.mediaStreamTrack)}}catch(v){r={error:v}}finally{try{!u&&!t&&(a=h.return)&&(yield a.call(h))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===me.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source===me.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return D(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],r=yield this.sender.getStats();return r.forEach(a=>{var s;if(a.type==="outbound-rtp"){const l={type:"video",streamId:a.id,frameHeight:a.frameHeight,frameWidth:a.frameWidth,framesPerSecond:a.framesPerSecond,framesSent:a.framesSent,firCount:a.firCount,pliCount:a.pliCount,nackCount:a.nackCount,packetsSent:a.packetsSent,bytesSent:a.bytesSent,qualityLimitationReason:a.qualityLimitationReason,qualityLimitationDurations:a.qualityLimitationDurations,qualityLimitationResolutionChanges:a.qualityLimitationResolutionChanges,rid:(s=a.rid)!==null&&s!==void 0?s:a.id,retransmittedPacketsSent:a.retransmittedPacketsSent,targetBitrate:a.targetBitrate,timestamp:a.timestamp},u=r.get(a.remoteId);u&&(l.jitter=u.jitter,l.packetsLost=u.packetsLost,l.roundTripTime=u.roundTripTime),t.push(l)}}),t.sort((a,s)=>{var l,u;return((l=s.frameWidth)!==null&&l!==void 0?l:0)-((u=a.frameWidth)!==null&&u!==void 0?u:0)}),t})}setPublishingQuality(e){const t=[];for(let r=Cr.LOW;r<=Cr.HIGH;r+=1)t.push(new Wf({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(_i(this.codec),t)}restartTrack(e){return D(this,void 0,void 0,function*(){var t,r,a,s,l;let u;if(e){const C=Kf({video:e});typeof C.video!="boolean"&&(u=C.video)}yield this.restart(u),this.isCpuConstrained=!1;try{for(var h=!0,f=ta(this.simulcastCodecs.values()),v;v=yield f.next(),t=v.done,!t;h=!0){s=v.value,h=!1;const C=s;C.sender&&((l=C.sender.transport)===null||l===void 0?void 0:l.state)!=="closed"&&(C.mediaStreamTrack=this.mediaStreamTrack.clone(),yield C.sender.replaceTrack(C.mediaStreamTrack))}}catch(C){r={error:C}}finally{try{!h&&!t&&(a=f.return)&&(yield a.call(f))}finally{if(r)throw r.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return D(this,arguments,void 0,function(r){var a=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l,u,h,f,v,C;if(yield t.setProcessor.call(a,r,s),!((v=a.processor)===null||v===void 0)&&v.processedTrack)try{for(var x=!0,T=ta(a.simulcastCodecs.values()),N;N=yield T.next(),l=N.done,!l;x=!0)f=N.value,x=!1,yield(C=f.sender)===null||C===void 0?void 0:C.replaceTrack(a.processor.processedTrack)}catch(L){u={error:L}}finally{try{!x&&!l&&(h=T.return)&&(yield h.call(T))}finally{if(u)throw u.error}}}()})}setDegradationPreference(e){return D(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(t){this.log.warn("failed to set degradationPreference",Object.assign({error:t},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,t){const r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Bx))}setPublishingCodecs(e){return D(this,void 0,void 0,function*(){var t,r,a,s,l,u,h;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(_i(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const f=[];try{for(t=!0,r=ta(e);a=yield r.next(),s=a.done,!s;t=!0){h=a.value,t=!1;const v=h;if(!this.codec||this.codec===v.codec)yield this.setPublishingLayers(_i(v.codec),v.qualities);else{const C=this.simulcastCodecs.get(v.codec);if(this.log.debug("try setPublishingCodec for ".concat(v.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:C})),!C||!C.sender){for(const x of v.qualities)if(x.enabled){f.push(v.codec);break}}else C.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(v.codec),this.logContext),yield Wb(C.sender,C.encodings,v.qualities,this.senderLock,_i(v.codec),this.log,this.logContext))}}}catch(v){l={error:v}}finally{try{!t&&!s&&(u=r.return)&&(yield u.call(r))}finally{if(l)throw l.error}}return f})}setPublishingLayers(e,t){return D(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),!(!this.sender||!this.encodings)&&(yield Wb(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return D(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const t=this.sender.getParameters();t.encodings=t.encodings.map((r,a)=>{var s;return Object.assign(Object.assign({},r),{active:a===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((s=this.mediaStreamTrack.getSettings().height)!==null&&s!==void 0?s:360)/360)),scalabilityMode:a===0&&_i(this.codec)?"L1T3":void 0,maxFramerate:a===0?15:0,maxBitrate:a===0?r.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:t.encodings})),this.encodings=t.encodings,yield this.sender.setParameters(t)}catch(t){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:t})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return D(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),I1()&&this.isInBackground&&this.source===me.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function Wb(n,e,t,r,a,s,l){return D(this,void 0,void 0,function*(){const u=yield r.lock();s.debug("setPublishingLayersForSender",Object.assign(Object.assign({},l),{sender:n,qualities:t,senderEncodings:e}));try{const h=n.getParameters(),{encodings:f}=h;if(!f)return;if(f.length!==e.length){s.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},l),{encodings:f,senderEncodings:e}));return}let v=!1;a&&t.some(C=>C.enabled)&&t.forEach(C=>C.enabled=!0),f.forEach((C,x)=>{var T;let N=(T=C.rid)!==null&&T!==void 0?T:"";N===""&&(N="q");const L=q1(N),$=t.find(V=>V.quality===L);$&&C.active!==$.enabled&&(v=!0,C.active=$.enabled,s.debug("setting layer ".concat($.quality," to ").concat(C.active?"enabled":"disabled"),l),No()&&($.enabled?(C.scaleResolutionDownBy=e[x].scaleResolutionDownBy,C.maxBitrate=e[x].maxBitrate,C.maxFrameRate=e[x].maxFrameRate):(C.scaleResolutionDownBy=4,C.maxBitrate=10,C.maxFrameRate=2)))}),v&&(h.encodings=f,s.debug("setting encodings",Object.assign(Object.assign({},l),{encodings:h.encodings})),yield n.setParameters(h))}finally{u()}})}function q1(n){switch(n){case"f":return Cr.HIGH;case"h":return Cr.MEDIUM;case"q":return Cr.LOW;default:return Cr.HIGH}}function zb(n,e,t,r){if(!t)return[new Da({quality:Cr.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(r){const a=t[0].scalabilityMode,s=new z1(a),l=[],u=s.suffix=="h"?1.5:2,h=s.suffix=="h"?2:3;for(let f=0;f<s.spatial;f+=1)l.push(new Da({quality:Math.min(Cr.HIGH,s.spatial-1)-f,width:Math.ceil(n/Math.pow(u,f)),height:Math.ceil(e/Math.pow(u,f)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(h,f)):0,ssrc:0}));return l}return t.map(a=>{var s,l,u;const h=(s=a.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let f=q1((l=a.rid)!==null&&l!==void 0?l:"");return new Da({quality:f,width:Math.ceil(n/h),height:Math.ceil(e/h),bitrate:(u=a.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0})})}const qb="_lossy",$b="_reliable",Vx=2*1e3,wp="leave-reconnect",Wx=3e4;var Ur;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(Ur||(Ur={}));class zx extends Mi.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Xf.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Ur.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=ct,this.reliableDataSequence=1,this.reliableMessageBuffer=new Ib,this.reliableReceivedState=new hx(Wx),this.midToTrackId={},this.handleDataChannel=r=>D(this,[r],void 0,function(a){var s=this;let{channel:l}=a;return function*(){if(l){if(l.label===$b)s.reliableDCSub=l;else if(l.label===qb)s.lossyDCSub=l;else return;s.log.debug("on data channel ".concat(l.id,", ").concat(l.label),s.logContext),l.onmessage=s.handleDataMessage}}()}),this.handleDataMessage=r=>D(this,void 0,void 0,function*(){var a,s,l,u,h;const f=yield this.dataProcessLock.lock();try{let v;if(r.data instanceof ArrayBuffer)v=r.data;else if(r.data instanceof Blob)v=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const C=Jn.fromBinary(new Uint8Array(v));if(C.sequence>0&&C.participantSid!==""){const x=this.reliableReceivedState.get(C.participantSid);if(x&&C.sequence<=x)return;this.reliableReceivedState.set(C.participantSid,C.sequence)}if(((a=C.value)===null||a===void 0?void 0:a.case)==="speaker")this.emit(Re.ActiveSpeakersUpdate,C.value.value.speakers);else if(((s=C.value)===null||s===void 0?void 0:s.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const x=yield(l=this.e2eeManager)===null||l===void 0?void 0:l.handleEncryptedData(C.value.value.encryptedValue,C.value.value.iv,C.participantIdentity,C.value.value.keyIndex),T=R0.fromBinary(x.payload),N=new Jn({value:T.value,participantIdentity:C.participantIdentity,participantSid:C.participantSid});((u=N.value)===null||u===void 0?void 0:u.case)==="user"&&Hb(N,N.value.value),this.emit(Re.DataPacketReceived,N,C.value.value.encryptionType)}else((h=C.value)===null||h===void 0?void 0:h.case)==="user"&&Hb(C,C.value.value),this.emit(Re.DataPacketReceived,C,dn.NONE)}finally{f()}}),this.handleDataError=r=>{const a=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:s}=r.error;this.log.error("DataChannel error on ".concat(a,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:s}))}else this.log.error("Unknown DataChannel error on ".concat(a),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const a=r.currentTarget.maxRetransmits===0?lt.LOSSY:lt.RELIABLE;this.updateAndEmitDCBufferStatus(a)},this.handleDisconnect=(r,a)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=h=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(h,"ms. giving up"),this.logContext),this.emit(Re.Disconnected),this.close()},l=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:l,retryCount:this.reconnectAttempts});if(u===null){s(l);return}r===wp&&(u=0),this.log.debug("reconnecting in ".concat(u,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Pn.setTimeout(()=>this.attemptReconnect(a).finally(()=>this.reconnectTimeout=void 0),u)},this.waitForRestarted=()=>new Promise((r,a)=>{this.pcState===Ur.Connected&&r();const s=()=>{this.off(Re.Disconnected,l),r()},l=()=>{this.off(Re.Restarted,s),a()};this.once(Re.Restarted,s),this.once(Re.Disconnected,l)}),this.updateAndEmitDCBufferStatus=r=>{const a=this.isBufferStatusLow(r);typeof a<"u"&&a!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,a),this.emit(Re.DCBufferStatusChanged,a,r))},this.isBufferStatusLow=r=>{const a=this.dataChannelForKind(r);if(a)return r===lt.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(a.bufferedAmount),a.bufferedAmount<=a.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===zt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(_o.RR_SIGNAL_DISCONNECTED))},this.log=aa((t=e.loggerName)!==null&&t!==void 0?t:di.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Jf(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new Qn,this.dataProcessLock=new Qn,this.dcBufferStatus=new Map([[lt.LOSSY,!0],[lt.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(Re.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(Re.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(Re.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(Re.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(Re.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(Re.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(Re.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(Re.SignalRequestResponse,r)}get logContext(){var e,t,r,a,s,l;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomID:(a=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||a===void 0?void 0:a.sid,participant:(l=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||l===void 0?void 0:l.identity,pID:this.participantSid}}join(e,t,r,a){return D(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,t,r,a);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),(!this.subscriberPrimary||s.fastPublish)&&this.negotiate().catch(l=>{ct.error(l,this.logContext)}),this.registerOnLineListener(),this.clientConfiguration=s.clientConfiguration,this.emit(Re.SignalConnected,s),s}catch(s){if(s instanceof kt&&s.reason===mt.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,r,a);throw s}})}close(){return D(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(Re.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return D(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Ib,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return D(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new na("a track with the same ID has already been published");return new Promise((t,r)=>{const a=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new kt("publication of local track timed out, no response from server",mt.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(a),t(s)},reject:()=>{clearTimeout(a),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return D(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return D(this,void 0,void 0,function*(){var t,r;if(this.pcManager&&this.pcManager.currentState!==Gt.NEW)return;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid;const a=this.makeRTCConfiguration(e);this.pcManager=new kx(a,this.options.singlePeerConnection?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(Re.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(s,l)=>{this.client.sendIceCandidate(s,l)},this.pcManager.onPublisherOffer=(s,l)=>{this.client.sendOffer(s,l)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(s,l,u)=>D(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(s),this.logContext),["closed","disconnected","failed"].includes(l)&&(this.publisherConnectionPromise=void 0),s===Gt.CONNECTED){const v=this.pcState===Ur.New;this.pcState=Ur.Connected,v&&this.emit(Re.Connected,e)}else s===Gt.FAILED&&(this.pcState===Ur.Connected||this.pcState===Ur.Reconnecting)&&(this.pcState=Ur.Disconnected,this.handleDisconnect("peerconnection failed",u==="failed"?_o.RR_SUBSCRIBER_FAILED:_o.RR_PUBLISHER_FAILED));const h=this.client.isDisconnected||this.client.currentState===zt.RECONNECTING,f=[Gt.FAILED,Gt.CLOSING,Gt.CLOSED].includes(s);h&&f&&!this._isClosed&&this.emit(Re.Offline)}),this.pcManager.onTrack=s=>{s.streams.length!==0&&this.emit(Re.MediaTrackAdded,s.track,s.streams[0],s.receiver)},qx((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t,r)=>D(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:r})),this.midToTrackId=r,yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t,r)=>D(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;this.midToTrackId=r;const a=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);a&&this.client.sendAnswer(a,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Re.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Re.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Re.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Re.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(Re.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var t,r;const a={direction:"recvonly"};for(let s=0;s<e.numAudios;s++)(t=this.pcManager)===null||t===void 0||t.addPublisherTransceiverOfKind("audio",a);for(let s=0;s<e.numVideos;s++)(r=this.pcManager)===null||r===void 0||r.addPublisherTransceiverOfKind("video",a);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",_o.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:B1,regionSettings:e.regions})),e.action){case Ds.DISCONNECT:this.emit(Re.Disconnected,e==null?void 0:e.reason),this.close();break;case Ds.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(wp);break;case Ds.RESUME:this.handleDisconnect(wp)}}}makeRTCConfiguration(e){var t;const r=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const a=[];e.iceServers.forEach(s=>{const l={urls:s.urls};s.username&&(l.username=s.username),s.credential&&(l.credential=s.credential),a.push(l)}),r.iceServers=a}return e.clientConfiguration&&e.clientConfiguration.forceRelay===dc.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(qb,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel($b,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,r){return D(this,void 0,void 0,function*(){if(Zp())return yield this.createTransceiverRTCRtpSender(e,t,r);if(Qp())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new ln("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,r,a){return D(this,void 0,void 0,function*(){if(Zp())return this.createSimulcastTransceiverSender(e,t,r,a);if(Qp())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new ln("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,r){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("publisher is closed");const a=[];e.mediaStream&&a.push(e.mediaStream),Wa(e)&&(e.codec=t.videoCodec);const s={direction:"sendonly",streams:a};return r&&(s.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s)).sender})}createSimulcastTransceiverSender(e,t,r,a){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("publisher is closed");const s={direction:"sendonly"};a&&(s.sendEncodings=a);const l=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,s);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,l.sender),l.sender})}createRTCRtpSender(e){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return D(this,void 0,void 0,function*(){var t,r,a;if(!this._isClosed){if(this.attemptingReconnect){ct.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===dc.DISABLED||((a=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&a!==void 0?a:Gt.NEW)===Gt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let l=!0;s instanceof ln?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),l=!1):s instanceof _s||(this.fullReconnectOnNext=!0),l?this.handleDisconnect("reconnect",_o.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Re.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){return D(this,void 0,void 0,function*(){var t,r,a;try{if(!this.url||!this.token)throw new ln("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Re.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new _s;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(l){throw l instanceof kt&&l.reason===mt.NotAllowed?new ln("could not reconnect, token might be expired"):new _s}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Re.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==zt.CONNECTED)throw new _s("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(Re.Restarted)}catch(s){const l=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(l){yield this.restartConnection(l);return}else throw(a=this.regionUrlProvider)===null||a===void 0||a.resetAttempts(),s}})}resumeConnection(e){return D(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new ln("could not reconnect, url or token not saved");if(!this.pcManager)throw new ln("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Re.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(a){let s="";throw a instanceof Error&&(s=a.message,this.log.error(a.message,Object.assign(Object.assign({},this.logContext),{error:a}))),a instanceof kt&&a.reason===mt.NotAllowed?new ln("could not reconnect, token might be expired"):a instanceof kt&&a.reason===mt.LeaveRequest?a:new _s(s)}if(this.emit(Re.SignalResumed),r){const a=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(a),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=r.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==zt.CONNECTED)throw new _s("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),r!=null&&r.lastMessageSeq&&this.resendReliableMessagesForResume(r.lastMessageSeq),this.emit(Re.Resumed)})}waitForPCInitialConnection(e,t){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new ln("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return D(this,void 0,void 0,function*(){this.pcState=Ur.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Yn(Vx),!this.pcManager)throw new ln("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Ur.Connected}catch(e){throw this.pcState=Ur.Disconnected,new kt("could not establish PC connection, ".concat(e.message),mt.InternalError)}})}publishRpcResponse(e,t,r,a){return D(this,void 0,void 0,function*(){const s=new Jn({destinationIdentities:[e],kind:lt.RELIABLE,value:{case:"rpcResponse",value:new Uf({requestId:t,value:a?{case:"error",value:a.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(s,lt.RELIABLE)})}publishRpcAck(e,t){return D(this,void 0,void 0,function*(){const r=new Jn({destinationIdentities:[e],kind:lt.RELIABLE,value:{case:"rpcAck",value:new Df({requestId:t})}});yield this.sendDataPacket(r,lt.RELIABLE)})}sendDataPacket(e,t){return D(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(t),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const s=m2(e);if(s){const l=yield this.e2eeManager.encryptData(s.toBinary());e.value={case:"encryptedPacket",value:new _0({encryptedValue:l.payload,iv:l.iv,keyIndex:l.keyIndex})}}}t===lt.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const r=e.toBinary(),a=this.dataChannelForKind(t);if(a){if(t===lt.RELIABLE&&this.reliableMessageBuffer.push({data:r,sequence:e.sequence}),this.attemptingReconnect)return;a.send(r)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return D(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(lt.RELIABLE);const t=this.dataChannelForKind(lt.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(r=>{t.send(r.data)})),this.updateAndEmitDCBufferStatus(lt.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((t,r)=>D(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const a=()=>r("Engine closed");for(this.once(Re.Closing,a);!this.dcBufferStatus.get(e);)yield Yn(10);this.off(Re.Closing,a),t()}}))}ensureDataTransportConnected(e){return D(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var s;if(!r.pcManager)throw new ln("PC manager is closed");const l=a?r.pcManager.subscriber:r.pcManager.publisher,u=a?"Subscriber":"Publisher";if(!l)throw new kt("".concat(u," connection not set"),mt.InternalError);let h=!1;!a&&!r.dataChannelForKind(t,a)&&(r.createDataChannels(),h=!0),!h&&!a&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(h=!0),h&&r.negotiate().catch(C=>{ct.error(C,r.logContext)});const f=r.dataChannelForKind(t,a);if((f==null?void 0:f.readyState)==="open")return;const v=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<v;){if(l.isICEConnected&&((s=r.dataChannelForKind(t,a))===null||s===void 0?void 0:s.readyState)==="open")return;yield Yn(50)}throw new kt("could not establish ".concat(u," connection, state: ").concat(l.getICEConnectionState()),mt.InternalError)}()})}ensurePublisherConnected(e){return D(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Gt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return D(this,void 0,void 0,function*(){return new Promise((e,t)=>D(this,void 0,void 0,function*(){if(!this.pcManager){t(new Gp("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,a=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Re.Closing,a),this.pcManager.publisher.once(Vs.RTPVideoPayloadTypes,s=>{const l=new Map;s.forEach(u=>{const h=u.codec.toLowerCase();F2(h)&&l.set(u.payload,h)}),this.emit(Re.RTPVideoMapUpdate,l)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof Gp&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",_o.RR_UNKNOWN),t(s)}finally{this.off(Re.Closing,a)}}))})}dataChannelForKind(e,t){if(t){if(e===lt.LOSSY)return this.lossyDCSub;if(e===lt.RELIABLE)return this.reliableDCSub}else{if(e===lt.LOSSY)return this.lossyDC;if(e===lt.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var r,a,s,l;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const u=this.pcManager.publisher.getLocalDescription(),h=this.pcManager.publisher.getRemoteDescription(),f=(r=this.pcManager.subscriber)===null||r===void 0?void 0:r.getRemoteDescription(),v=(a=this.pcManager.subscriber)===null||a===void 0?void 0:a.getLocalDescription(),C=(l=(s=this.signalOpts)===null||s===void 0?void 0:s.autoSubscribe)!==null&&l!==void 0?l:!0,x=new Array,T=new Array;e.forEach(N=>{N.isDesired!==C&&x.push(N.trackSid),N.isEnabled||T.push(N.trackSid)}),this.client.sendSyncState(new zf({answer:this.options.singlePeerConnection?h?Ms({sdp:h.sdp,type:h.type}):void 0:v?Ms({sdp:v.sdp,type:v.type}):void 0,offer:this.options.singlePeerConnection?u?Ms({sdp:u.sdp,type:u.type}):void 0:f?Ms({sdp:f.sdp,type:f.type}):void 0,subscription:new Ad({trackSids:x,subscribe:!C,participantTracks:[]}),publishTracks:J2(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:T,datachannelReceiveStates:this.reliableReceivedState.map((N,L)=>new K0({publisherSid:L,lastSeq:N}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(r,a)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new J0({label:r.label,id:r.id,target:a}))};return t(this.dataChannelForKind(lt.LOSSY),ci.PUBLISHER),t(this.dataChannelForKind(lt.RELIABLE),ci.PUBLISHER),t(this.dataChannelForKind(lt.LOSSY,!0),ci.SUBSCRIBER),t(this.dataChannelForKind(lt.RELIABLE,!0),ci.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Pn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){dr()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){dr()&&window.removeEventListener("online",this.handleBrowserOnLine)}getTrackIdForReceiver(e){var t;const r=(t=this.pcManager)===null||t===void 0?void 0:t.getMidForReceiver(e);if(r){const a=Object.entries(this.midToTrackId).find(s=>{let[l]=s;return l===r});if(a)return a[1]}}}class _s extends Error{}function qx(n){return n!==void 0&&n>13}function Hb(n,e){const t=n.participantIdentity?n.participantIdentity:e.participantIdentity;n.participantIdentity=t,e.participantIdentity=t;const r=n.destinationIdentities.length!==0?n.destinationIdentities:e.destinationIdentities;n.destinationIdentities=r,e.destinationIdentities=r}class $1{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new Fr("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Gn.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new Fr("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Gn.LengthExceeded)}}constructor(e,t,r,a){this.reader=t,this.totalByteSize=r,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=a}}class $x extends $1{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new Vr,r=null,a=null;if(this.signal){const l=this.signal;a=()=>{var u;(u=t.reject)===null||u===void 0||u.call(t,l.reason)},l.addEventListener("abort",a),r=l}const s=()=>{e.releaseLock(),r&&a&&r.removeEventListener("abort",a),this.signal=void 0};return{next:()=>D(this,void 0,void 0,function*(){var l,u;try{const{done:h,value:f}=yield Promise.race([e.read(),t.promise,(u=(l=this.outOfBandFailureRejectingFuture)===null||l===void 0?void 0:l.promise)!==null&&u!==void 0?u:new Promise(()=>{})]);return h?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(f),{done:!1,value:f.content})}catch(h){throw s(),h}}),return(){return D(this,void 0,void 0,function*(){return s(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,a,s,l;let u=new Set;const h=t.signal?e.withAbortSignal(t.signal):e;try{for(var f=!0,v=ta(h),C;C=yield v.next(),r=C.done,!r;f=!0){l=C.value,f=!1;const x=l;u.add(x)}}catch(x){a={error:x}}finally{try{!f&&!r&&(s=v.return)&&(yield s.call(v))}finally{if(a)throw a.error}}return Array.from(u)}()})}}class Hx extends $1{constructor(e,t,r,a){super(e,t,r,a),this.receivedChunks=new Map}handleChunkReceived(e){var t;const r=nd(e.chunkIndex),a=this.receivedChunks.get(r);if(a&&a.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let r=new Vr,a=null,s=null;if(this.signal){const u=this.signal;s=()=>{var h;(h=r.reject)===null||h===void 0||h.call(r,u.reason)},u.addEventListener("abort",s),a=u}const l=()=>{e.releaseLock(),a&&s&&a.removeEventListener("abort",s),this.signal=void 0};return{next:()=>D(this,void 0,void 0,function*(){var u,h;try{const{done:f,value:v}=yield Promise.race([e.read(),r.promise,(h=(u=this.outOfBandFailureRejectingFuture)===null||u===void 0?void 0:u.promise)!==null&&h!==void 0?h:new Promise(()=>{})]);if(f)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(v);let C;try{C=t.decode(v.content)}catch(x){throw new Fr("Cannot decode datastream chunk ".concat(v.chunkIndex," as text: ").concat(x),Gn.DecodeFailed)}return{done:!1,value:C}}}catch(f){throw l(),f}}),return(){return D(this,void 0,void 0,function*(){return l(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,a,s,l;let u="";const h=t.signal?e.withAbortSignal(t.signal):e;try{for(var f=!0,v=ta(h),C;C=yield v.next(),r=C.done,!r;f=!0)l=C.value,f=!1,u+=l}catch(x){a={error:x}}finally{try{!f&&!r&&(s=v.return)&&(yield s.call(v))}finally{if(a)throw a.error}}return u}()})}}class Gx{constructor(){this.log=ct,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new Fr('A text stream handler for topic "'.concat(e,'" has already been set.'),Gn.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new Fr('A byte stream handler for topic "'.concat(e,'" has already been set.'),Gn.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,r,a,s;const l=Array.from(this.textStreamControllers.entries()).filter(h=>h[1].sendingParticipantIdentity===e),u=Array.from(this.byteStreamControllers.entries()).filter(h=>h[1].sendingParticipantIdentity===e);if(l.length>0||u.length>0){const h=new Fr("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Gn.AbnormalEnd);for(const[f,v]of u)(r=(t=v.outOfBandFailureRejectingFuture).reject)===null||r===void 0||r.call(t,h),this.byteStreamControllers.delete(f);for(const[f,v]of l)(s=(a=v.outOfBandFailureRejectingFuture).reject)===null||s===void 0||s.call(a,h),this.textStreamControllers.delete(f)}}handleDataStreamPacket(e,t){return D(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,t);case"streamChunk":return this.handleStreamChunk(e.value.value,t);case"streamTrailer":return this.handleStreamTrailer(e.value.value,t);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t,r){return D(this,void 0,void 0,function*(){var a;if(e.contentHeader.case==="byteHeader"){const s=this.byteStreamHandlers.get(e.topic);if(!s){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let l;const u=new Vr;u.promise.catch(v=>{this.log.error(v)});const h={id:e.streamId,name:(a=e.contentHeader.value.name)!==null&&a!==void 0?a:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:nd(e.timestamp),attributes:e.attributes,encryptionType:r},f=new ReadableStream({start:v=>{if(l=v,this.textStreamControllers.has(e.streamId))throw new Fr("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Gn.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:h,controller:l,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:u})}});s(new $x(h,f,nd(e.totalLength),u),{identity:t})}else if(e.contentHeader.case==="textHeader"){const s=this.textStreamHandlers.get(e.topic);if(!s){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let l;const u=new Vr;u.promise.catch(v=>{this.log.error(v)});const h={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:r},f=new ReadableStream({start:v=>{if(l=v,this.textStreamControllers.has(e.streamId))throw new Fr("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Gn.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:h,controller:l,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:u})}});s(new Hx(h,f,nd(e.totalLength),u),{identity:t})}})}handleStreamChunk(e,t){const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==t?(r.controller.error(new Fr("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(r.info.encryptionType),Gn.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&r.controller.enqueue(e));const a=this.textStreamControllers.get(e.streamId);a&&(a.info.encryptionType!==t?(a.controller.error(new Fr("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(a.info.encryptionType),Gn.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&a.controller.enqueue(e))}handleStreamTrailer(e,t){const r=this.textStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==t?r.controller.error(new Fr("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(r.info.encryptionType),Gn.EncryptionTypeMismatch)):(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.textStreamControllers.delete(e.streamId)));const a=this.byteStreamControllers.get(e.streamId);a&&(a.info.encryptionType!==t?a.controller.error(new Fr("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(a.info.encryptionType),Gn.EncryptionTypeMismatch)):(a.info.attributes=Object.assign(Object.assign({},a.info.attributes),e.attributes),a.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class H1{constructor(e,t,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return D(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class Kx extends H1{}class Jx extends H1{}const Gb=15e3;class Zx{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return D(this,void 0,void 0,function*(){var r;const a=crypto.randomUUID(),s=new TextEncoder().encode(e).byteLength,l=(r=t==null?void 0:t.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),u=new Array(l?l.length+1:1).fill(0),h=(v,C)=>{var x;u[C]=v;const T=u.reduce((N,L)=>N+L,0);(x=t==null?void 0:t.onProgress)===null||x===void 0||x.call(t,T)},f=yield this.streamText({streamId:a,totalSize:s,destinationIdentities:t==null?void 0:t.destinationIdentities,topic:t==null?void 0:t.topic,attachedStreamIds:l,attributes:t==null?void 0:t.attributes});return yield f.write(e),h(1,0),yield f.close(),t!=null&&t.attachments&&l&&(yield Promise.all(t.attachments.map((v,C)=>D(this,void 0,void 0,function*(){return this._sendFile(l[C],v,{topic:t.topic,mimeType:v.type,onProgress:x=>{h(x,C+1)}})})))),f.info})}streamText(e){return D(this,void 0,void 0,function*(){var t,r,a;const s=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),l={id:s,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes,encryptionType:!((a=this.engine.e2eeManager)===null||a===void 0)&&a.isDataChannelEncryptionEnabled?dn.GCM:dn.NONE},u=new fd({streamId:s,mimeType:l.mimeType,topic:l.topic,timestamp:Ro(l.timestamp),totalLength:Ro(e==null?void 0:e.totalSize),attributes:l.attributes,contentHeader:{case:"textHeader",value:new B0({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?Np.UPDATE:Np.CREATE})}}),h=e==null?void 0:e.destinationIdentities,f=new Jn({destinationIdentities:h,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(f,lt.RELIABLE);let v=0;const C=this.engine,x=new WritableStream({write(L){return D(this,void 0,void 0,function*(){for(const $ of $2(L,Gb)){yield C.waitForBufferStatusLow(lt.RELIABLE);const V=new md({content:$,streamId:s,chunkIndex:Ro(v)}),K=new Jn({destinationIdentities:h,value:{case:"streamChunk",value:V}});yield C.sendDataPacket(K,lt.RELIABLE),v+=1}})},close(){return D(this,void 0,void 0,function*(){const L=new gd({streamId:s}),$=new Jn({destinationIdentities:h,value:{case:"streamTrailer",value:L}});yield C.sendDataPacket($,lt.RELIABLE)})},abort(L){console.log("Sink error:",L)}});let T=()=>D(this,void 0,void 0,function*(){yield N.close()});C.once(Re.Closing,T);const N=new Kx(x,l,()=>this.engine.off(Re.Closing,T));return N})}sendFile(e,t){return D(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,t),{id:r}})}_sendFile(e,t,r){return D(this,void 0,void 0,function*(){var a;const s=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:(a=r==null?void 0:r.mimeType)!==null&&a!==void 0?a:t.type,topic:r==null?void 0:r.topic,destinationIdentities:r==null?void 0:r.destinationIdentities}),l=t.stream().getReader();for(;;){const{done:u,value:h}=yield l.read();if(u)break;yield s.write(h)}return yield s.close(),s.info})}streamBytes(e){return D(this,void 0,void 0,function*(){var t,r,a,s,l,u;const h=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),f=e==null?void 0:e.destinationIdentities,v={id:h,mimeType:(r=e==null?void 0:e.mimeType)!==null&&r!==void 0?r:"application/octet-stream",topic:(a=e==null?void 0:e.topic)!==null&&a!==void 0?a:"",timestamp:Date.now(),attributes:e==null?void 0:e.attributes,size:e==null?void 0:e.totalSize,name:(s=e==null?void 0:e.name)!==null&&s!==void 0?s:"unknown",encryptionType:!((l=this.engine.e2eeManager)===null||l===void 0)&&l.isDataChannelEncryptionEnabled?dn.GCM:dn.NONE},C=new fd({totalLength:Ro((u=v.size)!==null&&u!==void 0?u:0),mimeType:v.mimeType,streamId:h,topic:v.topic,timestamp:Ro(Date.now()),attributes:v.attributes,contentHeader:{case:"byteHeader",value:new V0({name:v.name})}}),x=new Jn({destinationIdentities:f,value:{case:"streamHeader",value:C}});yield this.engine.sendDataPacket(x,lt.RELIABLE);let T=0;const N=new Qn,L=this.engine,$=this.log,V=new WritableStream({write(K){return D(this,void 0,void 0,function*(){const F=yield N.lock();let A=0;try{for(;A<K.byteLength;){const U=K.slice(A,A+Gb);yield L.waitForBufferStatusLow(lt.RELIABLE);const Z=new Jn({destinationIdentities:f,value:{case:"streamChunk",value:new md({content:U,streamId:h,chunkIndex:Ro(T)})}});yield L.sendDataPacket(Z,lt.RELIABLE),T+=1,A+=U.byteLength}}finally{F()}})},close(){return D(this,void 0,void 0,function*(){const K=new gd({streamId:h}),F=new Jn({destinationIdentities:f,value:{case:"streamTrailer",value:K}});yield L.sendDataPacket(F,lt.RELIABLE)})},abort(K){$.error("Sink error:",K)}});return new Jx(V,v)})}}class G1 extends me{constructor(e,t,r,a,s){super(e,r,s),this.sid=t,this.receiver=a}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xe.Muted:xe.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(xe.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return D(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),tm)),Z2()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(t=this.receiver)===null||t===void 0?void 0:t.getSynchronizationSources()[0];if(r){const{timestamp:a,rtpTimestamp:s}=r;s&&this.rtpTimestamp!==s&&(this.emit(xe.TimeSyncUpdate,{timestamp:a,rtpTimestamp:s}),this.rtpTimestamp=s)}};e()}}class Qx extends G1{constructor(e,t,r,a,s,l){super(e,t,me.Kind.Audio,r,l),this.monitorReceiver=()=>D(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=Nd(u,this.prevStats)),this.prevStats=u}),this.audioContext=a,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var t;for(const r of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):r.volume=e;Oi()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Oi())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return D(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Yp(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Yp(e)&&e.setSinkId(this.sinkId).catch(r=>{this.log.error("Failed to set sink id on remote audio track",r,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(a=>{r.connect(a),r=a}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(xe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(a=>{this.emit(xe.AudioPlaybackFailed,a)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return D(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(r=>{r.type==="inbound-rtp"&&(t={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),t})}}const kp=100;class Yx extends G1{constructor(e,t,r,a,s){super(e,t,me.Kind.Video,r,s),this.elementInfos=[],this.monitorReceiver=()=>D(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const l=yield this.getReceiverStats();l&&this.prevStats&&this.receiver&&(this._currentBitrate=Nd(l,this.prevStats)),this.prevStats=l}),this.debouncedHandleResize=Qf(()=>{this.updateDimensions()},kp),this.adaptiveStreamSettings=a}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===me.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?Fs(this._mediaStreamTrack,t):As(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new Xx(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(r=>r===e);for(const r of t)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const r of t)this.stopObservingElement(r);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return D(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,r="",a=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,t={type:"video",streamId:s.id,framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&a.set(s.id,s)}),t&&r!==""&&a.get(r)&&(t.mimeType=a.get(r).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(r=>r.element===e);for(const r of t)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return D(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,r;const a=this.elementInfos.reduce((h,f)=>Math.max(h,f.visibilityChangedAt||0),0),s=!((r=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pauseVideoInBackground)!==null&&r!==void 0)||r?this.isInBackground:!1,l=this.elementInfos.some(h=>h.pictureInPicture),u=this.elementInfos.some(h=>h.visible)&&!s||l;if(!(this.lastVisible===u&&!e)){if(!u&&Date.now()-a<kp){Pn.setTimeout(()=>{this.updateVisibility()},kp);return}this.lastVisible=u,this.emit(xe.VisibilityChanged,u,this)}}updateDimensions(){var e,t;let r=0,a=0;const s=this.getPixelDensity();for(const l of this.elementInfos){const u=l.width()*s,h=l.height()*s;u+h>r+a&&(r=u,a=h)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===a||(this.lastDimensions={width:r,height:a},this.emit(xe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?Cb():t||(Cb()>2?2:1)}}class Xx{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=r=>{var a;const{target:s,isIntersecting:l}=r;s===this.element&&(this.isIntersecting=l,this.isPiP=ql(this.element),this.visibilityChangedAt=Date.now(),(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this))},this.onEnterPiP=()=>{var r,a,s;(a=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||a===void 0||a.addEventListener("pagehide",this.onLeavePiP),this.isPiP=ql(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=ql(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=t??lf(e),this.isPiP=dr()&&ql(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,r;this.isIntersecting=lf(this.element),this.isPiP=ql(this.element),this.element.handleResize=()=>{var a;(a=this.handleResize)===null||a===void 0||a.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Tb().observe(this.element),Sb().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,r,a,s;(e=Tb())===null||e===void 0||e.unobserve(this.element),(t=Sb())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(s=(a=window.documentPictureInPicture)===null||a===void 0?void 0:a.window)===null||s===void 0||s.removeEventListener("pagehide",this.onLeavePiP)}}function ql(n){var e,t;return document.pictureInPictureElement===n?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?lf(n,(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window):!1}function lf(n,e){const t=e||window;let r=n.offsetTop,a=n.offsetLeft;const s=n.offsetWidth,l=n.offsetHeight,{hidden:u}=n,{display:h}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,r+=n.offsetTop,a+=n.offsetLeft;return r<t.pageYOffset+t.innerHeight&&a<t.pageXOffset+t.innerWidth&&r+l>t.pageYOffset&&a+s>t.pageXOffset&&!u&&h!=="none"}class Yi extends Mi.EventEmitter{constructor(e,t,r,a){var s;super(),this.metadataMuted=!1,this.encryption=dn.NONE,this.log=ct,this.handleMuted=()=>{this.emit(xe.Muted)},this.handleUnmuted=()=>{this.emit(xe.Unmuted)},this.log=aa((s=a==null?void 0:a.loggerName)!==null&&s!==void 0?s:di.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=r,this.source=me.Source.Unknown}setTrack(e){this.track&&(this.track.off(xe.Muted,this.handleMuted),this.track.off(xe.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(xe.Muted,this.handleMuted),e.on(xe.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),pt(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==dn.NONE}get audioTrack(){if(Ri(this.track))return this.track}get videoTrack(){if(Wa(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=me.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===me.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(Yi||(Yi={}));class cf extends Yi{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,r,a){super(e,t.sid,t.name,a),this.track=void 0,this.handleTrackEnded=()=>{this.emit(xe.Ended)},this.handleCpuConstrained=()=>{this.track&&Wa(this.track)&&this.emit(xe.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(r)}setTrack(e){this.track&&(this.track.off(xe.Ended,this.handleTrackEnded),this.track.off(xe.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(xe.Ended,this.handleTrackEnded),e.on(xe.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return D(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return D(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return D(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return D(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Ri(this.track)){const t=this.track.getSourceTrackSettings(),r=new Set;return t.autoGainControl&&r.add(gn.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&r.add(gn.TF_ECHO_CANCELLATION),t.noiseSuppression&&r.add(gn.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&r.add(gn.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(gn.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(gn.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}function jd(n,e){return D(this,void 0,void 0,function*(){n??(n={});let t=!1;const{audioProcessor:r,videoProcessor:a,optionsWithoutProcessor:s}=j1(n);let l=s.audio,u=s.video;if(r&&typeof s.audio=="object"&&(s.audio.processor=r),a&&typeof s.video=="object"&&(s.video.processor=a),n.audio&&typeof s.audio=="object"&&typeof s.audio.deviceId=="string"){const C=s.audio.deviceId;s.audio.deviceId={exact:C},t=!0,l=Object.assign(Object.assign({},s.audio),{deviceId:{ideal:C}})}if(s.video&&typeof s.video=="object"&&typeof s.video.deviceId=="string"){const C=s.video.deviceId;s.video.deviceId={exact:C},t=!0,u=Object.assign(Object.assign({},s.video),{deviceId:{ideal:C}})}(s.audio===!0||typeof s.audio=="object"&&!s.audio.deviceId)&&(s.audio={deviceId:"default"}),s.video===!0?s.video={deviceId:"default"}:typeof s.video=="object"&&!s.video.deviceId&&(s.video.deviceId="default");const h=M1(s,U1,F1),f=Kf(h),v=navigator.mediaDevices.getUserMedia(f);s.audio&&(vn.userMediaPromiseMap.set("audioinput",v),v.catch(()=>vn.userMediaPromiseMap.delete("audioinput"))),s.video&&(vn.userMediaPromiseMap.set("videoinput",v),v.catch(()=>vn.userMediaPromiseMap.delete("videoinput")));try{const C=yield v;return yield Promise.all(C.getTracks().map(x=>D(this,void 0,void 0,function*(){const T=x.kind==="audio";let N=T?h.audio:h.video;(typeof N=="boolean"||!N)&&(N={});let L;const $=T?f.audio:f.video;typeof $!="boolean"&&(L=$);const V=x.getSettings().deviceId;L!=null&&L.deviceId&&Fa(L.deviceId)!==V?L.deviceId=V:L||(L={deviceId:V});const K=Rx(x,L,e);return K.kind===me.Kind.Video?K.source=me.Source.Camera:K.kind===me.Kind.Audio&&(K.source=me.Source.Microphone),K.mediaStream=C,Ri(K)&&r?yield K.setProcessor(r):Wa(K)&&a&&(yield K.setProcessor(a)),K})))}catch(C){if(!t)throw C;return jd(Object.assign(Object.assign({},n),{audio:l,video:u}),e)}})}function eE(n){return D(this,void 0,void 0,function*(){return(yield jd({audio:!1,video:!0}))[0]})}function tE(n){return D(this,void 0,void 0,function*(){return(yield jd({audio:!0,video:!1}))[0]})}var Ma;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(Ma||(Ma={}));function nE(n){switch(n){case Gl.EXCELLENT:return Ma.Excellent;case Gl.GOOD:return Ma.Good;case Gl.POOR:return Ma.Poor;case Gl.LOST:return Ma.Lost;default:return Ma.Unknown}}class K1 extends Mi.EventEmitter{get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===hc.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===js.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,r,a,s,l){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:hc.STANDARD;var h;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ma.Unknown,this.log=ct,this.log=aa((h=l==null?void 0:l.loggerName)!==null&&h!==void 0?h:di.Participant),this.loggerOptions=l,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=r,this.metadata=a,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=u,this._attributes=s??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Vr,this.once(Ie.Active,()=>{var e,t;(t=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||t===void 0||t.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(me.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(me.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(me.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var t;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===js.ACTIVE&&((t=this.participantInfo)===null||t===void 0?void 0:t.state)!==js.ACTIVE&&this.emit(Ie.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,r=this.metadata;this.metadata=e,t&&this.emit(Ie.ParticipantMetadataChanged,r)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Ie.ParticipantNameChanged,e)}_setAttributes(e){const t=Q2(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Ie.AttributesChanged,t)}setPermissions(e){var t,r,a,s,l,u;const h=this.permissions,f=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((a=this.permissions)===null||a===void 0?void 0:a.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((l=this.permissions)===null||l===void 0?void 0:l.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((v,C)=>{var x;return v!==((x=this.permissions)===null||x===void 0?void 0:x.canPublishSources[C])})||e.canSubscribeMetrics!==((u=this.permissions)===null||u===void 0?void 0:u.canSubscribeMetrics);return this.permissions=e,f&&this.emit(Ie.ParticipantPermissionsChanged,h),f}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Ie.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=nE(e),t!==this._connectionQuality&&this.emit(Ie.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&((t=(e=this.activeFuture).reject)===null||t===void 0||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>Ri(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(xe.Muted,()=>{this.emit(Ie.TrackMuted,e)}),e.on(xe.Unmuted,()=>{this.emit(Ie.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case me.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case me.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function rE(n){var e,t,r;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new H0({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(r=n.allowAll)!==null&&r!==void 0?r:!1,trackSids:n.allowedTrackSids||[]})}class iE extends K1{constructor(e,t,r,a,s,l){super(e,t,void 0,void 0,void 0,{loggerName:a.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=dn.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Vr)},this.handleReconnected=()=>{var u,h;(h=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||h===void 0||h.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var u,h,f,v,C,x;this.reconnectFuture&&(this.reconnectFuture.promise.catch(T=>this.log.warn(T.message,this.logContext)),(h=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||h===void 0||h.call(u,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&((v=(f=this.signalConnectedFuture).reject)===null||v===void 0||v.call(f,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),(x=(C=this.activeAgentFuture)===null||C===void 0?void 0:C.reject)===null||x===void 0||x.call(C,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=u=>{var h,f;u.participant&&this.updateInfo(u.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Vr),(f=(h=this.signalConnectedFuture).resolve)===null||f===void 0||f.call(h)},this.handleSignalRequestResponse=u=>{const{requestId:h,reason:f,message:v}=u,C=this.pendingSignalRequests.get(h);C&&(f!==qf.OK&&C.reject(new vb(v,f)),this.pendingSignalRequests.delete(h))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let h=u.value.value,f=null,v=null;h.value.case==="payload"?f=h.value.value:h.value.case==="error"&&(v=Jt.fromProto(h.value.value)),this.handleIncomingRpcResponse(h.requestId,f,v);break;case"rpcAck":let C=u.value.value;this.handleIncomingRpcAck(C.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>rE(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,h)=>{if(h===void 0&&(h=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),pt(u)));return}this.engine.updateMuteStatus(u.sid,h)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),pt(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),pt(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const h=this.audioTrackPublications.get(u.sid);if(!h){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(h.trackSid,h.getTrackFeatures())},this.onTrackCpuConstrained=(u,h)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),pt(h))),this.emit(Ie.LocalTrackCpuConstrained,u,h)},this.handleSubscribedQualityUpdate=u=>D(this,void 0,void 0,function*(){var h,f,v,C,x;if(!(!((x=this.roomOptions)===null||x===void 0)&&x.dynacast))return;const T=this.videoTrackPublications.get(u.trackSid);if(!T){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(!T.videoTrack)return;const N=yield T.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var L=!0,$=ta(N),V;V=yield $.next(),h=V.done,!h;L=!0){C=V.value,L=!1;const K=C;P2(K)&&(this.log.debug("publish ".concat(K," for ").concat(T.videoTrack.sid),Object.assign(Object.assign({},this.logContext),pt(T))),yield this.publishAdditionalCodecForTrack(T.videoTrack,K,T.options))}}catch(K){f={error:K}}finally{try{!L&&!h&&(v=$.return)&&(yield v.call($))}finally{if(f)throw f.error}}}),this.handleLocalTrackUnpublished=u=>{const h=this.trackPublications.get(u.trackSid);if(!h){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(h.track)},this.handleTrackEnded=u=>D(this,void 0,void 0,function*(){if(u.source===me.Source.ScreenShare||u.source===me.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),pt(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(Qi(u)||Oa(u))try{if(dr())try{const h=yield navigator==null?void 0:navigator.permissions.query({name:u.source===me.Source.Camera?"camera":"microphone"});if(h&&h.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),pt(u))),h.onchange=()=>{h.state!=="denied"&&(u.isMuted||u.restartTrack(),h.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),pt(u))),Qi(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),pt(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=a,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=s,this.roomOutgoingDataStreamManager=l}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==dn.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(Re.RemoteMute,(r,a)=>{const s=this.trackPublications.get(r);!s||!s.track||(a?s.mute():s.unmute())}),!((t=this.signalConnectedFuture)===null||t===void 0)&&t.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(Re.Connected,this.handleReconnected).on(Re.SignalConnected,this.handleSignalConnected).on(Re.SignalRestarted,this.handleReconnected).on(Re.SignalResumed,this.handleReconnected).on(Re.Restarting,this.handleReconnecting).on(Re.Resuming,this.handleReconnecting).on(Re.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Re.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Re.Closing,this.handleClosing).on(Re.SignalRequestResponse,this.handleSignalRequestResponse).on(Re.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return D(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return D(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return D(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return D(this,arguments,void 0,function(t){var r=this;let{metadata:a,name:s,attributes:l}=t;return function*(){return new Promise((u,h)=>D(r,void 0,void 0,function*(){var f,v;try{let C=!1;const x=yield this.engine.client.sendUpdateLocalMetadata((f=a??this.metadata)!==null&&f!==void 0?f:"",(v=s??this.name)!==null&&v!==void 0?v:"",l),T=performance.now();for(this.pendingSignalRequests.set(x,{resolve:u,reject:N=>{h(N),C=!0},values:{name:s,metadata:a,attributes:l}});performance.now()-T<5e3&&!C;){if((!s||this.name===s)&&(!a||this.metadata===a)&&(!l||Object.entries(l).every(N=>{let[L,$]=N;return this.attributes[L]===$||$===""&&!this.attributes[L]}))){this.pendingSignalRequests.delete(x),u();return}yield Yn(50)}h(new vb("Request to update local metadata timed out","TimeoutError"))}catch(C){C instanceof Error&&h(C)}}))}()})}setCameraEnabled(e,t,r){return this.setTrackEnabled(me.Source.Camera,e,t,r)}setMicrophoneEnabled(e,t,r){return this.setTrackEnabled(me.Source.Microphone,e,t,r)}setScreenShareEnabled(e,t,r){return this.setTrackEnabled(me.Source.ScreenShare,e,t,r)}setE2EEEnabled(e){return D(this,void 0,void 0,function*(){this.encryptionType=e?dn.GCM:dn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,r,a){return D(this,void 0,void 0,function*(){var s,l;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let u=this.getTrackPublication(e);if(t)if(u)yield u.unmute();else{let h;if(this.pendingPublishing.has(e)){const f=yield this.waitForPendingPublicationOfSource(e);return f||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield f==null?void 0:f.unmute(),f}this.pendingPublishing.add(e);try{switch(e){case me.Source.Camera:h=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case me.Source.Microphone:h=yield this.createTracks({audio:(l=r)!==null&&l!==void 0?l:!0});break;case me.Source.ScreenShare:h=yield this.createScreenTracks(Object.assign({},r));break;default:throw new na(e)}}catch(f){throw h==null||h.forEach(v=>{v.stop()}),f instanceof Error&&this.emit(Ie.MediaDevicesError,f,rf(e)),this.pendingPublishing.delete(e),f}for(const f of h){const v=Object.assign(Object.assign({},this.roomOptions.publishDefaults),r);e===me.Source.Microphone&&Ri(f)&&v.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),f.startPreConnectBuffer())}try{const f=[];for(const v of h)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),pt(v))),f.push(this.publishTrack(v,a));[u]=yield Promise.all(f)}catch(f){throw h==null||h.forEach(v=>{v.stop()}),f}finally{this.pendingPublishing.delete(e)}}else if(!(u!=null&&u.track)&&this.pendingPublishing.has(e)&&(u=yield this.waitForPendingPublicationOfSource(e),u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),u&&u.track)if(e===me.Source.ScreenShare){u=yield this.unpublishTrack(u.track);const h=this.getTrackPublication(me.Source.ScreenShareAudio);h&&h.track&&this.unpublishTrack(h.track)}else yield u.mute();return u})}enableCameraAndMicrophone(){return D(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(me.Source.Camera)||this.pendingPublishing.has(me.Source.Microphone))){this.pendingPublishing.add(me.Source.Camera),this.pendingPublishing.add(me.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(me.Source.Camera),this.pendingPublishing.delete(me.Source.Microphone)}}})}createTracks(e){return D(this,void 0,void 0,function*(){var t,r;e??(e={});const a=M1(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults);try{return(yield jd(a,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(s=>(Ri(s)&&(this.microphoneError=void 0,s.setAudioContext(this.audioContext),s.source=me.Source.Microphone,this.emit(Ie.AudioStreamAcquired)),Wa(s)&&(this.cameraError=void 0,s.source=me.Source.Camera),s))}catch(s){throw s instanceof Error&&(e.audio&&(this.microphoneError=s),e.video&&(this.cameraError=s)),s}})}createScreenTracks(e){return D(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Hf("getDisplayMedia not supported");e.resolution===void 0&&!M2()&&(e.resolution=Gf.h1080fps30.resolution);const t=K2(e),r=yield navigator.mediaDevices.getDisplayMedia(t),a=r.getVideoTracks();if(a.length===0)throw new na("no video track found");const s=new yd(a[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=me.Source.ScreenShare,e.contentHint&&(s.mediaStreamTrack.contentHint=e.contentHint);const l=[s];if(r.getAudioTracks().length>0){this.emit(Ie.AudioStreamAcquired);const u=new bd(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});u.source=me.Source.ScreenShareAudio,l.push(u)}return l})}publishTrack(e,t){return D(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return D(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var u,h,f,v;Qi(r)&&r.setAudioContext(s.audioContext),yield(u=s.reconnectFuture)===null||u===void 0?void 0:u.promise,s.republishPromise&&!l&&(yield s.republishPromise),Bs(r)&&s.pendingPublishPromises.has(r)&&(yield s.pendingPublishPromises.get(r));let C;if(r instanceof MediaStreamTrack)C=r.getConstraints();else{C=r.constraints;let V;switch(r.source){case me.Source.Microphone:V="audioinput";break;case me.Source.Camera:V="videoinput"}V&&s.activeDeviceMap.has(V)&&(C=Object.assign(Object.assign({},C),{deviceId:s.activeDeviceMap.get(V)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new bd(r,C,!0,s.audioContext,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;case"video":r=new yd(r,C,!0,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;default:throw new na("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});let x;if(s.trackPublications.forEach(V=>{V.track&&V.track===r&&(x=V)}),x)return s.log.warn("track has already been published, skipping",Object.assign(Object.assign({},s.logContext),pt(x))),x;const T=Object.assign(Object.assign({},s.roomOptions.publishDefaults),a),N="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,L=(h=T.forceStereo)!==null&&h!==void 0?h:N;L&&(T.dtx===void 0&&s.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},s.logContext),pt(r))),T.red===void 0&&s.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(f=T.dtx)!==null&&f!==void 0||(T.dtx=!1),(v=T.red)!==null&&v!==void 0||(T.red=!1)),!N2()&&s.roomOptions.e2ee&&(s.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},s.logContext)),T.simulcast=!1),T.source&&(r.source=T.source);const $=new Promise((V,K)=>D(s,void 0,void 0,function*(){try{if(this.engine.client.currentState!==zt.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:pt(r)}));const F=setTimeout(()=>{K(new gb("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(F);const A=yield this.publish(r,T,L);V(A)}else try{const F=yield this.publish(r,T,L);V(F)}catch(F){K(F)}}catch(F){K(F)}}));s.pendingPublishPromises.set(r,$);try{return yield $}catch(V){throw V}finally{s.pendingPublishPromises.delete(r)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Vr),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),pt(e))),!1;const{canPublish:t,canPublishSources:r}=this.permissions;return t&&(r.length===0||r.map(a=>Y2(a)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),pt(e))),!1)}publish(e,t,r){return D(this,void 0,void 0,function*(){var a,s,l,u,h,f,v,C,x,T;if(!this.hasPermissionsToPublish(e))throw new gb("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(X=>Bs(e)&&X.source===e.source)&&e.source!==me.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),pt(e))),t.stopMicTrackOnMute&&Ri(e)&&(e.stopOnMute=!0),e.source===me.Source.ScreenShare&&No()&&(t.simulcast=!1),t.videoCodec==="av1"&&!I2()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!O2()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=af),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(X=>t.videoCodec===ec(X.mime))||(t.videoCodec=ec(this.enabledPublishVideoCodecs[0].mime)));const N=t.videoCodec;e.on(xe.Muted,this.onTrackMuted),e.on(xe.Unmuted,this.onTrackUnmuted),e.on(xe.Ended,this.handleTrackEnded),e.on(xe.UpstreamPaused,this.onTrackUpstreamPaused),e.on(xe.UpstreamResumed,this.onTrackUpstreamResumed),e.on(xe.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const L=[],$=!(!((a=t.dtx)!==null&&a!==void 0)||a),V=e.getSourceTrackSettings();V.autoGainControl&&L.push(gn.TF_AUTO_GAIN_CONTROL),V.echoCancellation&&L.push(gn.TF_ECHO_CANCELLATION),V.noiseSuppression&&L.push(gn.TF_NOISE_SUPPRESSION),V.channelCount&&V.channelCount>1&&L.push(gn.TF_STEREO),$&&L.push(gn.TF_NO_DTX),Qi(e)&&e.hasPreConnectBuffer&&L.push(gn.TF_PRECONNECT_BUFFER);const K=new pc({cid:e.mediaStreamTrack.id,name:t.name,type:me.kindToProto(e.kind),muted:e.isMuted,source:me.sourceToProto(e.source),disableDtx:$,encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=t.red)!==null&&s!==void 0)||s),stream:t==null?void 0:t.stream,backupCodecPolicy:t==null?void 0:t.backupCodecPolicy,audioFeatures:L});let F;if(e.kind===me.Kind.Video){let X={width:0,height:0};try{X=yield e.waitForDimensions()}catch{const H=(u=(l=this.roomOptions.videoCaptureDefaults)===null||l===void 0?void 0:l.resolution)!==null&&u!==void 0?u:fc.h720.resolution;X={width:H.width,height:H.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{dims:X}))}K.width=X.width,K.height=X.height,Oa(e)&&(_i(N)&&(e.source===me.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),pt(e))))),t.scalabilityMode=(h=t.scalabilityMode)!==null&&h!==void 0?h:"L3T3_KEY"),K.simulcastCodecs=[new Dp({codec:N,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:af}),t.backupCodec&&N!==t.backupCodec.codec&&K.encryption===dn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),K.simulcastCodecs.push(new Dp({codec:t.backupCodec.codec,cid:""})))),F=sf(e.source===me.Source.ScreenShare,K.width,K.height,t),K.layers=zb(K.width,K.height,F,_i(t.videoCodec))}else e.kind===me.Kind.Audio&&(F=[{maxBitrate:(f=t.audioPreset)===null||f===void 0?void 0:f.maxBitrate,priority:(C=(v=t.audioPreset)===null||v===void 0?void 0:v.priority)!==null&&C!==void 0?C:"high",networkPriority:(T=(x=t.audioPreset)===null||x===void 0?void 0:x.priority)!==null&&T!==void 0?T:"high"}]);if(!this.engine||this.engine.isClosed)throw new ln("cannot publish track when not connected");const A=()=>D(this,void 0,void 0,function*(){var X,H,J;if(!this.engine.pcManager)throw new ln("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,F),this.emit(Ie.LocalSenderCreated,e.sender,e),Oa(e)&&((X=t.degradationPreference)!==null&&X!==void 0||(t.degradationPreference=Fx(e)),e.setDegradationPreference(t.degradationPreference)),F)if(No()&&e.kind===me.Kind.Audio){let Y;for(const he of this.engine.pcManager.publisher.getTransceivers())if(he.sender===e.sender){Y=he;break}Y&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:Y,codec:"opus",maxbr:!((H=F[0])===null||H===void 0)&&H.maxBitrate?F[0].maxBitrate/1e3:0})}else e.codec&&_i(e.codec)&&!((J=F[0])===null||J===void 0)&&J.maxBitrate&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:K.cid,codec:e.codec,maxbr:F[0].maxBitrate/1e3});yield this.engine.negotiate()});let U;const Z=new Promise((X,H)=>D(this,void 0,void 0,function*(){var J;try{U=yield this.engine.addTrack(K),X(U)}catch(Y){e.sender&&!((J=this.engine.pcManager)===null||J===void 0)&&J.publisher&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(he=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{error:he}))})),H(Y)}}));if(this.enabledPublishVideoCodecs.length>0)U=(yield Promise.all([Z,A()]))[0];else{U=yield Z;let X;if(U.codecs.forEach(H=>{X===void 0&&(X=H.mimeType)}),X&&e.kind===me.Kind.Video){const H=ec(X);H!==N&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{codec:H})),t.videoCodec=H,F=sf(e.source===me.Source.ScreenShare,K.width,K.height,t))}yield A()}const oe=new cf(e.kind,U,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(oe.on(xe.CpuConstrained,X=>this.onTrackCpuConstrained(X,oe)),oe.options=t,e.sid=U.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:F,trackInfo:U})),Oa(e)?e.startMonitor(this.engine.client):Qi(e)&&e.startMonitor(),this.addTrackPublication(oe),this.emit(Ie.LocalTrackPublished,oe),Qi(e)&&U.audioFeatures.includes(gn.TF_PRECONNECT_BUFFER)){const X=e.getPreConnectBuffer(),H=e.getPreConnectBufferMimeType();this.on(Ie.LocalTrackSubscribed,J=>{if(J.trackSid===U.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),pt(e))),e.stopPreConnectBuffer()}}),X&&new Promise((J,Y)=>D(this,void 0,void 0,function*(){var he,Ae,qe,Ue,ot,Fe;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),pt(e)));const M=setTimeout(()=>{Y(new Error("agent not active within 10 seconds"))},1e4),ae=yield this.waitUntilActiveAgentPresent();clearTimeout(M),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),pt(e)));const Ve=yield this.streamBytes({name:"preconnect-buffer",mimeType:H,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[ae.identity],attributes:{trackId:oe.trackSid,sampleRate:String((ot=V.sampleRate)!==null&&ot!==void 0?ot:"48000"),channels:String((Fe=V.channelCount)!==null&&Fe!==void 0?Fe:"1")}});try{for(var z=!0,ce=ta(X),ue;ue=yield ce.next(),he=ue.done,!he;z=!0){Ue=ue.value,z=!1;const ke=Ue;yield Ve.write(ke)}}catch(ke){Ae={error:ke}}finally{try{!z&&!he&&(qe=ce.return)&&(yield qe.call(ce))}finally{if(Ae)throw Ae.error}}yield Ve.close(),J()}catch(M){Y(M)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),pt(e)))}).catch(J=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{error:J}))})}return oe})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,r){return D(this,void 0,void 0,function*(){var a;if(this.encryptionType!==dn.NONE)return;let s;if(this.trackPublications.forEach(x=>{x.track&&x.track===e&&(s=x)}),!s)throw new na("track is not published");if(!Oa(e))throw new na("track is not a video track");const l=Object.assign(Object.assign({},(a=this.roomOptions)===null||a===void 0?void 0:a.publishDefaults),r),u=jx(e,t,l);if(!u){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),pt(e)));return}const h=e.addSimulcastTrack(t,u);if(!h)return;const f=new pc({cid:h.mediaStreamTrack.id,type:me.kindToProto(e.kind),muted:e.isMuted,source:me.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:l.videoCodec,cid:h.mediaStreamTrack.id}]});if(f.layers=zb(f.width,f.height,u),!this.engine||this.engine.isClosed)throw new ln("cannot publish track when not connected");const v=()=>D(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,h,l,u),yield this.engine.negotiate()}),C=(yield Promise.all([this.engine.addTrack(f),v()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:u,trackInfo:C}))})}unpublishTrack(e,t){return D(this,void 0,void 0,function*(){var r,a;if(Bs(e)){const f=this.pendingPublishPromises.get(e);f&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),pt(e))),yield f)}const s=this.getPublicationForTrack(e),l=s?pt(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),l)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),l));return}e=s.track,e.off(xe.Muted,this.onTrackMuted),e.off(xe.Unmuted,this.onTrackUnmuted),e.off(xe.Ended,this.handleTrackEnded),e.off(xe.UpstreamPaused,this.onTrackUpstreamPaused),e.off(xe.UpstreamResumed,this.onTrackUpstreamResumed),e.off(xe.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),t===void 0&&(t=(a=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&a!==void 0?a:!0),t?e.stop():e.stopMonitor();let u=!1;const h=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Gt.FAILED&&h)try{for(const f of this.engine.pcManager.publisher.getTransceivers())f.sender===h&&(f.direction="inactive",u=!0);if(this.engine.removeTrack(h)&&(u=!0),Oa(e)){for(const[,f]of e.simulcastCodecs)f.sender&&(this.engine.removeTrack(f.sender)&&(u=!0),f.sender=void 0);e.simulcastCodecs.clear()}}catch(f){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),l),{error:f}))}switch(this.trackPublications.delete(s.trackSid),s.kind){case me.Kind.Audio:this.audioTrackPublications.delete(s.trackSid);break;case me.Kind.Video:this.videoTrackPublications.delete(s.trackSid);break}return this.emit(Ie.LocalTrackUnpublished,s),s.setTrack(void 0),u&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return D(this,void 0,void 0,function*(){return(yield Promise.all(e.map(t=>this.unpublishTrack(t)))).filter(t=>!!t)})}republishAllTracks(e){return D(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((s,l)=>D(r,void 0,void 0,function*(){try{const u=[];this.trackPublications.forEach(h=>{h.track&&(t&&(h.options=Object.assign(Object.assign({},h.options),t)),u.push(h))}),yield Promise.all(u.map(h=>D(this,void 0,void 0,function*(){const f=h.track;yield this.unpublishTrack(f,!1),a&&!f.isMuted&&f.source!==me.Source.ScreenShare&&f.source!==me.Source.ScreenShareAudio&&(Qi(f)||Oa(f))&&!f.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:h.trackSid})),yield f.restartTrack()),yield this.publishOrRepublishTrack(f,h.options,!0)}))),s()}catch(u){l(u)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return D(this,arguments,void 0,function(t){var r=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const s=a.reliable?lt.RELIABLE:lt.LOSSY,l=a.destinationIdentities,u=a.topic;let h=new Nf({participantIdentity:r.identity,payload:t,destinationIdentities:l,topic:u});const f=new Jn({kind:s,value:{case:"user",value:h}});yield r.engine.sendDataPacket(f,s)}()})}publishDtmf(e,t){return D(this,void 0,void 0,function*(){const r=new Jn({kind:lt.RELIABLE,value:{case:"sipDtmf",value:new O0({code:e,digit:t})}});yield this.engine.sendDataPacket(r,lt.RELIABLE)})}sendChatMessage(e,t){return D(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:t==null?void 0:t.attachments},a=new Jn({value:{case:"chatMessage",value:new pd(Object.assign(Object.assign({},r),{timestamp:Ut.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(a,lt.RELIABLE),this.emit(Ie.ChatMessage,r),r})}editChatMessage(e,t){return D(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),a=new Jn({value:{case:"chatMessage",value:new pd(Object.assign(Object.assign({},r),{timestamp:Ut.parse(r.timestamp),editTimestamp:Ut.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(a,lt.RELIABLE),this.emit(Ie.ChatMessage,r),r})}sendText(e,t){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return D(this,arguments,void 0,function(t){var r=this;let{destinationIdentity:a,method:s,payload:l,responseTimeout:u=15e3}=t;return function*(){return new Promise((h,f)=>D(r,void 0,void 0,function*(){var v,C,x,T;if(em(l)>V1){f(Jt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((C=(v=this.engine.latestJoinResponse)===null||v===void 0?void 0:v.serverInfo)===null||C===void 0)&&C.version&&Ai((T=(x=this.engine.latestJoinResponse)===null||x===void 0?void 0:x.serverInfo)===null||T===void 0?void 0:T.version,"1.8.0")<0){f(Jt.builtIn("UNSUPPORTED_SERVER"));return}const N=Math.max(u,8e3),L=crypto.randomUUID();yield this.publishRpcRequest(a,L,s,l,N);const $=setTimeout(()=>{this.pendingAcks.delete(L),f(Jt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(L),clearTimeout(V)},7e3);this.pendingAcks.set(L,{resolve:()=>{clearTimeout($)},participantIdentity:a});const V=setTimeout(()=>{this.pendingResponses.delete(L),f(Jt.builtIn("RESPONSE_TIMEOUT"))},u);this.pendingResponses.set(L,{resolve:(K,F)=>{clearTimeout(V),this.pendingAcks.has(L)&&(console.warn("RPC response received before ack",L),this.pendingAcks.delete(L),clearTimeout($)),F?f(F):h(K??"")},participantIdentity:a})}))}()})}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,r){const a=this.pendingResponses.get(e);a?(a.resolve(t,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,r,a,s){return D(this,void 0,void 0,function*(){const l=new Jn({destinationIdentities:[e],kind:lt.RELIABLE,value:{case:"rpcRequest",value:new jf({id:t,method:r,payload:a,responseTimeoutMs:s,version:1})}});yield this.engine.sendDataPacket(l,lt.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:r,resolve:a}]of this.pendingResponses)r===e&&(a(null,Jt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(t=>t.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(t=>{var r,a;const s=this.trackPublications.get(t.sid);if(s){const l=s.isMuted||((a=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&a!==void 0?a:!1);l!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),pt(s)),{mutedOnServer:l})),this.engine.client.sendMuteTrack(t.sid,l))}}),!0):!1}setActiveAgent(e){var t,r,a,s;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(r=(t=this.activeAgentFuture)===null||t===void 0?void 0:t.resolve)===null||r===void 0||r.call(t,e):(s=(a=this.activeAgentFuture)===null||a===void 0?void 0:a.reject)===null||s===void 0||s.call(a,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Vr),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(r=>{const a=r.track;a&&(e instanceof MediaStreamTrack?(Qi(a)||Oa(a))&&a.mediaStreamTrack===e&&(t=r):e===a&&(t=r))}),t}waitForPendingPublicationOfSource(e){return D(this,void 0,void 0,function*(){const t=Date.now();for(;Date.now()<t+1e4;){const r=Array.from(this.pendingPublishPromises.entries()).find(a=>{let[s]=a;return s.source===e});if(r)return r[1];yield Yn(20)}})}}class aE extends Yi{constructor(e,t,r,a){super(e,t.sid,t.name,a),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=s=>{this.setTrack(void 0),this.emit(xe.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.visible=s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensionsAdaptiveStream=s,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const a=new Ad({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new M0({participantSid:"",trackSids:[this.trackSid]})]});this.emit(xe.UpdateSubscription,a),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?Yi.SubscriptionStatus.Unsubscribed:super.isSubscribed?Yi.SubscriptionStatus.Subscribed:Yi.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Yi.PermissionStatus.Allowed:Yi.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,r;this.isManualOperationAllowed()&&(((t=this.requestedVideoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((r=this.requestedVideoDimensions)===null||r===void 0?void 0:r.height)===e.height||(mp(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&mp(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:Cr.HIGH}setTrack(e){const t=this.subscriptionStatus,r=this.permissionStatus,a=this.track;a!==e&&(a&&(a.off(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),a.off(xe.VisibilityChanged,this.handleVisibilityChange),a.off(xe.Ended,this.handleEnded),a.detach(),a.stopMonitor(),this.emit(xe.Unsubscribed,a)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(xe.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(xe.VisibilityChanged,this.handleVisibilityChange),e.on(xe.Ended,this.handleEnded),this.emit(xe.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(xe.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?xe.Muted:xe.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(xe.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(xe.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return mp(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new W0({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===me.Kind.Video){let t=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(t)Pb(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const r=X2(this.trackInfo,this.requestedMaxQuality);r&&Pb(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:Cr.HIGH})),e.quality=Cr.HIGH)}this.emit(xe.UpdateSettings,e)}}class wd extends K1{static fromParticipantInfo(e,t,r){return new wd(e,t.sid,t.identity,t.name,t.metadata,t.attributes,r,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,r,a,s,l,u){let h=arguments.length>7&&arguments[7]!==void 0?arguments[7]:hc.STANDARD;super(t,r||"",a,s,l,u,h),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(xe.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),pt(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(xe.UpdateSubscription,t=>{t.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(xe.SubscriptionPermissionChanged,t=>{this.emit(Ie.TrackSubscriptionPermissionChanged,e,t)}),e.on(xe.SubscriptionStatusChanged,t=>{this.emit(Ie.TrackSubscriptionStatusChanged,e,t)}),e.on(xe.Subscribed,t=>{this.emit(Ie.TrackSubscribed,t,e)}),e.on(xe.Unsubscribed,t=>{this.emit(Ie.TrackUnsubscribed,t,e)}),e.on(xe.SubscriptionFailed,t=>{this.emit(Ie.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:me.Source.Microphone;this.volumeMap.set(t,e);const r=this.getTrackPublication(t);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:me.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,r,a,s,l){let u=this.getTrackPublicationBySid(t);if(u||t.startsWith("TR")||this.trackPublications.forEach(v=>{!u&&e.kind===v.kind.toString()&&(u=v)}),!u){if(l===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit(Ie.TrackSubscriptionFailed,t);return}l===void 0&&(l=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,r,a,s,l-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),pt(u))),this.emit(Ie.TrackSubscriptionFailed,t);return}const h=e.kind==="video";let f;return h?f=new Yx(e,t,a,s):f=new Qx(e,t,a,this.audioContext,this.audioOutput),f.source=u.source,f.isMuted=u.isMuted,f.setMediaStream(r),f.start(),u.setTrack(f),this.volumeMap.has(u.source)&&tf(f)&&Ri(f)&&f.setVolume(this.volumeMap.get(u.source)),u}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,r=new Map;return e.tracks.forEach(a=>{var s,l;let u=this.getTrackPublicationBySid(a.sid);if(u)u.updateInfo(a);else{const h=me.kindFromProto(a.type);if(!h)return;u=new aE(h,a,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(l=this.loggerOptions)===null||l===void 0?void 0:l.loggerName}),u.updateInfo(a),r.set(a.sid,u);const f=Array.from(this.trackPublications.values()).find(v=>v.source===(u==null?void 0:u.source));f&&u.source!==me.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),Object.assign(Object.assign({},this.logContext),{oldTrack:pt(f),newTrack:pt(u)})),this.addTrackPublication(u)}t.set(a.sid,u)}),this.trackPublications.forEach(a=>{t.has(a.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),pt(a))),this.unpublishTrack(a.trackSid,!0))}),r.forEach(a=>{this.emit(Ie.TrackPublished,a)}),!0}unpublishTrack(e,t){const r=this.trackPublications.get(e);if(!r)return;const{track:a}=r;switch(a&&(a.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case me.Kind.Audio:this.audioTrackPublications.delete(e);break;case me.Kind.Video:this.videoTrackPublications.delete(e);break}t&&this.emit(Ie.TrackUnpublished,r)}setAudioOutput(e){return D(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(r=>{var a;Ri(r.track)&&tf(r.track)&&t.push(r.track.setSinkId((a=e.deviceId)!==null&&a!==void 0?a:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var wt;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting"})(wt||(wt={}));const oE=4*1e3;class qs extends Mi.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var t,r,a,s;if(super(),t=this,this.state=wt.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=ct,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(l,u,h)=>D(this,void 0,void 0,function*(){var f;if(!A2())throw Oi()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const v=yield this.disconnectLock.lock();if(this.state===wt.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),v(),Promise.resolve();if(this.connectFuture)return v(),this.connectFuture.promise;this.setAndEmitConnectionState(wt.Connecting),((f=this.regionUrlProvider)===null||f===void 0?void 0:f.getServerUrl().toString())!==l&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Xp(new URL(l))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new cn(l,u):this.regionUrlProvider.updateToken(u),this.regionUrlProvider.fetchRegionSettings().then(T=>{var N;(N=this.regionUrlProvider)===null||N===void 0||N.setServerReportedRegions(T)}).catch(T=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:T}))}));const C=(T,N,L)=>D(this,void 0,void 0,function*(){var $,V;this.abortController&&this.abortController.abort();const K=new AbortController;this.abortController=K,v==null||v();try{yield this.attemptConnection(L??l,u,h,K),this.abortController=void 0,T()}catch(F){if(this.regionUrlProvider&&F instanceof kt&&F.reason!==mt.Cancelled&&F.reason!==mt.NotAllowed){let A=null;try{A=yield this.regionUrlProvider.getNextBestRegionUrl(($=this.abortController)===null||$===void 0?void 0:$.signal)}catch(U){if(U instanceof kt&&(U.status===401||U.reason===mt.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),N(U);return}}A&&!(!((V=this.abortController)===null||V===void 0)&&V.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(F.message,". Retrying with another region: ").concat(A),this.logContext),this.recreateEngine(),yield C(T,N,A)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Eb(F)),N(F))}else{let A=ui.UNKNOWN_REASON;F instanceof kt&&(A=Eb(F)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,A),N(F)}}}),x=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Vr((T,N)=>{C(T,N,x)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(l,u,h,f,v,C)=>D(this,void 0,void 0,function*(){var x,T,N;const L=yield h.join(l,u,{autoSubscribe:f.autoSubscribe,adaptiveStream:typeof v.adaptiveStream=="object"?!0:v.adaptiveStream,maxRetries:f.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:f.websocketTimeout,singlePeerConnection:v.singlePeerConnection},C.signal);let $=L.serverInfo;if($||($={version:L.serverVersion,region:L.serverRegion}),this.serverInfo=$,this.log.debug("connected to Livekit Server ".concat(Object.entries($).map(V=>{let[K,F]=V;return"".concat(K,": ").concat(F)}).join(", ")),{room:(x=L.room)===null||x===void 0?void 0:x.name,roomSid:(T=L.room)===null||T===void 0?void 0:T.sid,identity:(N=L.participant)===null||N===void 0?void 0:N.identity}),!$.version)throw new g2("unknown server version");return $.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),v.dynacast=!1),L}),this.applyJoinResponse=l=>{const u=l.participant;if(this.localParticipant.sid=u.sid,this.localParticipant.identity=u.identity,this.localParticipant.setEnabledPublishCodecs(l.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(l.sifTrailer)}catch(h){this.log.error(h instanceof Error?h.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:h}))}this.handleParticipantUpdates([u,...l.otherParticipants]),l.room&&this.handleRoomUpdate(l.room)},this.attemptConnection=(l,u,h,f)=>D(this,void 0,void 0,function*(){var v,C;this.state===wt.Reconnecting||this.isResuming||!((v=this.engine)===null||v===void 0)&&v.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((C=this.regionUrlProvider)===null||C===void 0)&&C.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Xf),h),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const x=yield this.connectSignal(l,u,this.engine,this.connOptions,this.options,f);this.applyJoinResponse(x),this.setupLocalParticipantEvents(),this.emit(Se.SignalConnected)}catch(x){yield this.engine.close(),this.recreateEngine();const T=new kt("could not establish signal connection",mt.ServerUnreachable);throw x instanceof Error&&(T.message="".concat(T.message,": ").concat(x.message)),x instanceof kt&&(T.reason=x.reason,T.status=x.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:x})),T}if(f.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new kt("Connection attempt aborted",mt.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,f)}catch(x){throw yield this.engine.close(),this.recreateEngine(),x}dr()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),dr()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(wt.Connected),this.emit(Se.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return D(t,[...u],void 0,function(){var f=this;let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var C,x,T,N;const L=yield f.disconnectLock.lock();try{if(f.state===wt.Disconnected){f.log.debug("already disconnected",f.logContext);return}if(f.log.info("disconnect from room",Object.assign({},f.logContext)),f.state===wt.Connecting||f.state===wt.Reconnecting||f.isResuming){const $="Abort connection attempt due to user initiated disconnect";f.log.warn($,f.logContext),(C=f.abortController)===null||C===void 0||C.abort($),(T=(x=f.connectFuture)===null||x===void 0?void 0:x.reject)===null||T===void 0||T.call(x,new kt("Client initiated disconnect",mt.Cancelled)),f.connectFuture=void 0}!((N=f.engine)===null||N===void 0)&&N.client.isDisconnected||(yield f.engine.client.sendLeave()),f.engine&&(yield f.engine.close()),f.handleDisconnect(v,ui.CLIENT_INITIATED),f.engine=void 0}finally{L()}}()})},this.onPageLeave=()=>D(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>D(this,void 0,void 0,function*(){const l=[],u=hr();if(u&&u.os==="iOS"){const h="livekit-dummy-audio-el";let f=document.getElementById(h);if(!f){f=document.createElement("audio"),f.id=h,f.autoplay=!0,f.hidden=!0;const v=fp();v.enabled=!0;const C=new MediaStream([v]);f.srcObject=C,document.addEventListener("visibilitychange",()=>{f&&(f.srcObject=document.hidden?null:C,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(f),this.once(Se.Disconnected,()=>{f==null||f.remove(),f=null})}l.push(f)}this.remoteParticipants.forEach(h=>{h.audioTrackPublications.forEach(f=>{f.track&&f.track.attachedElements.forEach(v=>{l.push(v)})})});try{yield Promise.all([this.acquireAudioContext(),...l.map(h=>(h.muted=!1,h.play()))]),this.handleAudioPlaybackStarted()}catch(h){throw this.handleAudioPlaybackFailed(h),h}}),this.startVideo=()=>D(this,void 0,void 0,function*(){const l=[];for(const u of this.remoteParticipants.values())u.videoTrackPublications.forEach(h=>{var f;(f=h.track)===null||f===void 0||f.attachedElements.forEach(v=>{l.includes(v)||l.push(v)})});yield Promise.all(l.map(u=>u.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(u=>{u.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const l of this.remoteParticipants.values())this.handleParticipantDisconnected(l.identity,l);this.setAndEmitConnectionState(wt.Reconnecting)&&this.emit(Se.Reconnecting)},this.handleSignalRestarted=l=>D(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(l.serverRegion),Object.assign(Object.assign({},this.logContext),{region:l.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(l);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(u){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:u}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:l.serverRegion}))}catch{return}this.setAndEmitConnectionState(wt.Connected),this.emit(Se.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=l=>{l.forEach(u=>{var h;if(u.identity===this.localParticipant.identity){this.localParticipant.updateInfo(u);return}u.identity===""&&(u.identity=(h=this.sidToIdentity.get(u.sid))!==null&&h!==void 0?h:"");let f=this.remoteParticipants.get(u.identity);u.state===js.DISCONNECTED?this.handleParticipantDisconnected(u.identity,f):f=this.getOrCreateParticipant(u.identity,u)})},this.handleActiveSpeakersUpdate=l=>{const u=[],h={};l.forEach(f=>{if(h[f.sid]=!0,f.sid===this.localParticipant.sid)this.localParticipant.audioLevel=f.level,this.localParticipant.setIsSpeaking(!0),u.push(this.localParticipant);else{const v=this.getRemoteParticipantBySid(f.sid);v&&(v.audioLevel=f.level,v.setIsSpeaking(!0),u.push(v))}}),h[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(f=>{h[f.sid]||(f.audioLevel=0,f.setIsSpeaking(!1))}),this.activeSpeakers=u,this.emitWhenConnected(Se.ActiveSpeakersChanged,u)},this.handleSpeakersChanged=l=>{const u=new Map;this.activeSpeakers.forEach(f=>{const v=this.remoteParticipants.get(f.identity);v&&v.sid!==f.sid||u.set(f.sid,f)}),l.forEach(f=>{let v=this.getRemoteParticipantBySid(f.sid);f.sid===this.localParticipant.sid&&(v=this.localParticipant),v&&(v.audioLevel=f.level,v.setIsSpeaking(f.active),f.active?u.set(f.sid,v):u.delete(f.sid))});const h=Array.from(u.values());h.sort((f,v)=>v.audioLevel-f.audioLevel),this.activeSpeakers=h,this.emitWhenConnected(Se.ActiveSpeakersChanged,h)},this.handleStreamStateUpdate=l=>{l.streamStates.forEach(u=>{const h=this.getRemoteParticipantBySid(u.participantSid);if(!h)return;const f=h.getTrackPublicationBySid(u.trackSid);if(!f||!f.track)return;const v=me.streamStateFromProto(u.state);f.track.setStreamState(v),v!==f.track.streamState&&(h.emit(Ie.TrackStreamStateChanged,f,f.track.streamState),this.emitWhenConnected(Se.TrackStreamStateChanged,f,f.track.streamState,h))})},this.handleSubscriptionPermissionUpdate=l=>{const u=this.getRemoteParticipantBySid(l.participantSid);if(!u)return;const h=u.getTrackPublicationBySid(l.trackSid);h&&h.setAllowed(l.allowed)},this.handleSubscriptionError=l=>{const u=Array.from(this.remoteParticipants.values()).find(f=>f.trackPublications.has(l.trackSid));if(!u)return;const h=u.getTrackPublicationBySid(l.trackSid);h&&h.setSubscriptionError(l.err)},this.handleDataPacket=(l,u)=>{const h=this.remoteParticipants.get(l.participantIdentity);if(l.value.case==="user")this.handleUserPacket(h,l.value.value,l.kind,u);else if(l.value.case==="transcription")this.handleTranscription(h,l.value.value);else if(l.value.case==="sipDtmf")this.handleSipDtmf(h,l.value.value);else if(l.value.case==="chatMessage")this.handleChatMessage(h,l.value.value);else if(l.value.case==="metrics")this.handleMetrics(l.value.value,h);else if(l.value.case==="streamHeader"||l.value.case==="streamChunk"||l.value.case==="streamTrailer")this.handleDataStream(l,u);else if(l.value.case==="rpcRequest"){const f=l.value.value;this.handleIncomingRpcRequest(l.participantIdentity,f.id,f.method,f.payload,f.responseTimeoutMs,f.version)}},this.handleUserPacket=(l,u,h,f)=>{this.emit(Se.DataReceived,u.payload,l,h,u.topic,f),l==null||l.emit(Ie.DataReceived,u.payload,h,f)},this.handleSipDtmf=(l,u)=>{this.emit(Se.SipDTMFReceived,u,l),l==null||l.emit(Ie.SipDTMFReceived,u)},this.handleTranscription=(l,u)=>{const h=u.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(u.transcribedParticipantIdentity),f=h==null?void 0:h.trackPublications.get(u.trackId),v=V2(u,this.transcriptionReceivedTimes);f==null||f.emit(xe.TranscriptionReceived,v),h==null||h.emit(Ie.TranscriptionReceived,v,f),this.emit(Se.TranscriptionReceived,v,h,f)},this.handleChatMessage=(l,u)=>{const h=W2(u);this.emit(Se.ChatMessage,h,l)},this.handleMetrics=(l,u)=>{this.emit(Se.MetricsReceived,l,u)},this.handleDataStream=(l,u)=>{this.incomingDataStreamManager.handleDataStreamPacket(l,u)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Se.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=l=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:l})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Se.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Se.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Se.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>D(this,void 0,void 0,function*(){var l;((l=hr())===null||l===void 0?void 0:l.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(Se.MediaDevicesChanged)}),this.handleRoomUpdate=l=>{const u=this.roomInfo;this.roomInfo=l,u&&u.metadata!==l.metadata&&this.emitWhenConnected(Se.RoomMetadataChanged,l.metadata),(u==null?void 0:u.activeRecording)!==l.activeRecording&&this.emitWhenConnected(Se.RecordingStatusChanged,l.activeRecording)},this.handleConnectionQualityUpdate=l=>{l.updates.forEach(u=>{if(u.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(u.quality);return}const h=this.getRemoteParticipantBySid(u.participantSid);h&&h.setConnectionQuality(u.quality)})},this.onLocalParticipantMetadataChanged=l=>{this.emit(Se.ParticipantMetadataChanged,l,this.localParticipant)},this.onLocalParticipantNameChanged=l=>{this.emit(Se.ParticipantNameChanged,l,this.localParticipant)},this.onLocalAttributesChanged=l=>{this.emit(Se.ParticipantAttributesChanged,l,this.localParticipant)},this.onLocalTrackMuted=l=>{this.emit(Se.TrackMuted,l,this.localParticipant)},this.onLocalTrackUnmuted=l=>{this.emit(Se.TrackUnmuted,l,this.localParticipant)},this.onTrackProcessorUpdate=l=>{var u;(u=l==null?void 0:l.onPublish)===null||u===void 0||u.call(l,this)},this.onLocalTrackPublished=l=>D(this,void 0,void 0,function*(){var u,h,f,v,C,x;(u=l.track)===null||u===void 0||u.on(xe.TrackProcessorUpdate,this.onTrackProcessorUpdate),(h=l.track)===null||h===void 0||h.on(xe.Restarted,this.onLocalTrackRestarted),(C=(v=(f=l.track)===null||f===void 0?void 0:f.getProcessor())===null||v===void 0?void 0:v.onPublish)===null||C===void 0||C.call(v,this),this.emit(Se.LocalTrackPublished,l,this.localParticipant),Qi(l.track)&&(yield l.track.checkForSilence())&&this.emit(Se.LocalAudioSilenceDetected,l);const T=yield(x=l.track)===null||x===void 0?void 0:x.getDeviceId(!1),N=rf(l.source);N&&T&&T!==this.localParticipant.activeDeviceMap.get(N)&&(this.localParticipant.activeDeviceMap.set(N,T),this.emit(Se.ActiveDeviceChanged,N,T))}),this.onLocalTrackUnpublished=l=>{var u,h;(u=l.track)===null||u===void 0||u.off(xe.TrackProcessorUpdate,this.onTrackProcessorUpdate),(h=l.track)===null||h===void 0||h.off(xe.Restarted,this.onLocalTrackRestarted),this.emit(Se.LocalTrackUnpublished,l,this.localParticipant)},this.onLocalTrackRestarted=l=>D(this,void 0,void 0,function*(){const u=yield l.getDeviceId(!1),h=rf(l.source);h&&u&&u!==this.localParticipant.activeDeviceMap.get(h)&&(this.log.debug("local track restarted, setting ".concat(h," ").concat(u," active"),this.logContext),this.localParticipant.activeDeviceMap.set(h,u),this.emit(Se.ActiveDeviceChanged,h,u))}),this.onLocalConnectionQualityChanged=l=>{this.emit(Se.ConnectionQualityChanged,l,this.localParticipant)},this.onMediaDevicesError=(l,u)=>{this.emit(Se.MediaDevicesError,l,u)},this.onLocalParticipantPermissionsChanged=l=>{this.emit(Se.ParticipantPermissionsChanged,l,this.localParticipant)},this.onLocalChatMessageSent=l=>{this.emit(Se.ChatMessage,l,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},wx),e),this.log=aa((r=this.options.loggerName)!==null&&r!==void 0?r:di.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},U1),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},F1),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},yx),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new Gx,this.outgoingDataStreamManager=new Zx(this.engine,this.log),this.disconnectLock=new Qn,this.localParticipant=new iE("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Fa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Fa(this.options.audioCaptureDefaults.deviceId)),!((a=this.options.audioOutput)===null||a===void 0)&&a.deviceId&&this.switchActiveDevice("audiooutput",Fa(this.options.audioOutput.deviceId)).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),dr()){const l=new AbortController;(s=navigator.mediaDevices)===null||s===void 0||s.addEventListener("devicechange",this.handleDeviceChange,{signal:l.signal}),qs.cleanupRegistry&&qs.cleanupRegistry.register(this,()=>{l.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return D(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const t=!!this.options.encryption,r=this.options.encryption||this.options.e2ee;r&&("e2eeManager"in r?(this.e2eeManager=r.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=t):this.e2eeManager=new ex(r,t),this.e2eeManager.on(ja.ParticipantEncryptionStatusChanged,(a,s)=>{q2(s)&&(this.isE2EEEnabled=a),this.emit(Se.ParticipantEncryptionStatusChanged,a,s)}),this.e2eeManager.on(ja.EncryptionError,a=>this.emit(Se.EncryptionError,a)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}getSid(){return D(this,void 0,void 0,function*(){return this.state===wt.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,t)=>{const r=a=>{a.sid!==""&&(this.engine.off(Re.RoomUpdate,r),e(a.sid))};this.engine.on(Re.RoomUpdate,r),this.once(Se.Disconnected,()=>{this.engine.off(Re.RoomUpdate,r),t("Room disconnected before room server id was available")})})})}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new zx(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(Re.ParticipantUpdate,this.handleParticipantUpdates).on(Re.RoomUpdate,this.handleRoomUpdate).on(Re.SpeakersChanged,this.handleSpeakersChanged).on(Re.StreamStateChanged,this.handleStreamStateUpdate).on(Re.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Re.SubscriptionError,this.handleSubscriptionError).on(Re.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Re.MediaTrackAdded,(e,t,r)=>{this.onTrackAdded(e,t,r)}).on(Re.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Re.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Re.DataPacketReceived,this.handleDataPacket).on(Re.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(wt.SignalReconnecting)&&this.emit(Se.SignalReconnecting)}).on(Re.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(wt.Connected)&&this.emit(Se.Reconnected)}).on(Re.SignalResumed,()=>{this.bufferedEvents=[],(this.state===wt.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(Re.Restarting,this.handleRestarting).on(Re.SignalRestarted,this.handleSignalRestarted).on(Re.Offline,()=>{this.setAndEmitConnectionState(wt.Reconnecting)&&this.emit(Se.Reconnecting)}).on(Re.DCBufferStatusChanged,(e,t)=>{this.emit(Se.DCBufferStatusChanged,e,t)}).on(Re.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:a}=r;return a===e});if(!t){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(Ie.LocalTrackSubscribed,t),this.emitWhenConnected(Se.LocalTrackSubscribed,t,this.localParticipant)}).on(Re.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((t,r)=>{this.handleParticipantDisconnected(r,t)}),this.emit(Se.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return vn.getInstance().getDevices(e,t)}prepareConnection(e,t){return D(this,void 0,void 0,function*(){if(this.state===wt.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Xp(new URL(e))&&t){this.regionUrlProvider=new cn(e,t);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===wt.Disconnected&&(this.regionUrl=r,yield fetch(ef(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(ef(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return D(this,void 0,void 0,function*(){let r=()=>D(this,void 0,void 0,function*(){}),a;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":a=new xi({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":a=new xi({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":a=new xi({scenario:{case:"serverLeave",value:!0}});break;case"migration":a=new xi({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>D(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),a=new xi({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>D(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),a=new xi({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":a=new xi({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>D(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new Md({reason:ui.CLIENT_INITIATED,action:Ds.RECONNECT}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");a=new xi({scenario:{case:"subscriberBandwidth",value:Ro(t)}});break;case"leave-full-reconnect":a=new xi({scenario:{case:"leaveRequestFullReconnect",value:!0}})}a&&(yield this.engine.client.sendSimulateScenario(a),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return D(this,arguments,void 0,function(r,a){var s=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var u,h,f,v,C,x,T;let N=!0,L=!1;const $=l?{exact:a}:a;if(r==="audioinput"){L=s.localParticipant.audioTrackPublications.size===0;const V=(u=s.getActiveDevice(r))!==null&&u!==void 0?u:s.options.audioCaptureDefaults.deviceId;s.options.audioCaptureDefaults.deviceId=$;const K=Array.from(s.localParticipant.audioTrackPublications.values()).filter(A=>A.source===me.Source.Microphone);try{N=(yield Promise.all(K.map(A=>{var U;return(U=A.audioTrack)===null||U===void 0?void 0:U.setDeviceId($)}))).every(A=>A===!0)}catch(A){throw s.options.audioCaptureDefaults.deviceId=V,A}const F=K.some(A=>{var U,Z;return(Z=(U=A.track)===null||U===void 0?void 0:U.isMuted)!==null&&Z!==void 0?Z:!1});N&&F&&(L=!0)}else if(r==="videoinput"){L=s.localParticipant.videoTrackPublications.size===0;const V=(h=s.getActiveDevice(r))!==null&&h!==void 0?h:s.options.videoCaptureDefaults.deviceId;s.options.videoCaptureDefaults.deviceId=$;const K=Array.from(s.localParticipant.videoTrackPublications.values()).filter(A=>A.source===me.Source.Camera);try{N=(yield Promise.all(K.map(A=>{var U;return(U=A.videoTrack)===null||U===void 0?void 0:U.setDeviceId($)}))).every(A=>A===!0)}catch(A){throw s.options.videoCaptureDefaults.deviceId=V,A}const F=K.some(A=>{var U,Z;return(Z=(U=A.track)===null||U===void 0?void 0:U.isMuted)!==null&&Z!==void 0?Z:!1});N&&F&&(L=!0)}else if(r==="audiooutput"){if(L=!0,!Yp()&&!s.options.webAudioMix||s.options.webAudioMix&&s.audioContext&&!("setSinkId"in s.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");s.options.webAudioMix&&(a=(f=yield vn.getInstance().normalizeDeviceId("audiooutput",a))!==null&&f!==void 0?f:""),(v=(T=s.options).audioOutput)!==null&&v!==void 0||(T.audioOutput={});const V=(C=s.getActiveDevice(r))!==null&&C!==void 0?C:s.options.audioOutput.deviceId;s.options.audioOutput.deviceId=a;try{s.options.webAudioMix&&((x=s.audioContext)===null||x===void 0||x.setSinkId(a)),yield Promise.all(Array.from(s.remoteParticipants.values()).map(K=>K.setAudioOutput({deviceId:a})))}catch(K){throw s.options.audioOutput.deviceId=V,K}}return L&&(s.localParticipant.activeDeviceMap.set(r,a),s.emit(Se.ActiveDeviceChanged,r,a)),N}()})}setupLocalParticipantEvents(){this.localParticipant.on(Ie.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Ie.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Ie.AttributesChanged,this.onLocalAttributesChanged).on(Ie.TrackMuted,this.onLocalTrackMuted).on(Ie.TrackUnmuted,this.onLocalTrackUnmuted).on(Ie.LocalTrackPublished,this.onLocalTrackPublished).on(Ie.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Ie.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Ie.MediaDevicesError,this.onMediaDevicesError).on(Ie.AudioStreamAcquired,this.startAudio).on(Ie.ChatMessage,this.onLocalChatMessageSent).on(Ie.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,r){if(this.state===wt.Connecting||this.state===wt.Reconnecting){const C=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:t.id,tracksInStream:t.getTracks().map(T=>T.id)}),this.onTrackAdded(e,t,r),x()},x=()=>{this.off(Se.Reconnected,C),this.off(Se.Connected,C),this.off(Se.Disconnected,x)};this.once(Se.Reconnected,C),this.once(Se.Connected,C),this.once(Se.Disconnected,x);return}if(this.state===wt.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const a=R2(t.id),s=a[0];let l=a[1],u=e.id;if(l&&l.startsWith("TR")&&(u=l),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const h=Array.from(this.remoteParticipants.values()).find(C=>C.sid===s);if(!h){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}if(!u.startsWith("TR")){const C=this.engine.getTrackIdForReceiver(r);if(!C){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(s),this.logContext);return}u=C}u.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(s,", streamId: ").concat(l,", trackId: ").concat(u),Object.assign(Object.assign({},this.logContext),{rpID:s,streamId:l,trackId:u}));let f;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?f=this.options.adaptiveStream:f={});const v=h.addSubscribedMediaTrack(e,u,t,r,f);v!=null&&v.isEncrypted&&!this.e2eeManager&&this.emit(Se.EncryptionError,new Error("Encrypted ".concat(v.source," track received from participant ").concat(h.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==wt.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(a=>{a.trackPublications.forEach(s=>{a.unpublishTrack(s.trackSid)})}),this.localParticipant.trackPublications.forEach(a=>{var s,l,u;a.track&&this.localParticipant.unpublishTrack(a.track,e),e?((s=a.track)===null||s===void 0||s.detach(),(l=a.track)===null||l===void 0||l.stop()):(u=a.track)===null||u===void 0||u.stopMonitor()}),this.localParticipant.off(Ie.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Ie.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Ie.AttributesChanged,this.onLocalAttributesChanged).off(Ie.TrackMuted,this.onLocalTrackMuted).off(Ie.TrackUnmuted,this.onLocalTrackUnmuted).off(Ie.LocalTrackPublished,this.onLocalTrackPublished).off(Ie.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Ie.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Ie.MediaDevicesError,this.onMediaDevicesError).off(Ie.AudioStreamAcquired,this.startAudio).off(Ie.ChatMessage,this.onLocalChatMessageSent).off(Ie.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),dr()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(wt.Disconnected),this.emit(Se.Disconnected,t)}}}handleParticipantDisconnected(e,t){var r;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(a=>{t.unpublishTrack(a.trackSid,!0)}),this.emit(Se.ParticipantDisconnected,t),t.setDisconnected(),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,r,a,s,l){return D(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),l!==1){yield this.engine.publishRpcResponse(e,t,null,Jt.builtIn("UNSUPPORTED_VERSION"));return}const u=this.rpcHandlers.get(r);if(!u){yield this.engine.publishRpcResponse(e,t,null,Jt.builtIn("UNSUPPORTED_METHOD"));return}let h=null,f=null;try{const v=yield u({requestId:t,callerIdentity:e,payload:a,responseTimeout:s});em(v)>V1?(h=Jt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):f=v}catch(v){v instanceof Jt?h=v:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),v),h=Jt.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,f,h)})}selectDefaultDevices(){return D(this,void 0,void 0,function*(){var e,t,r;const a=vn.getInstance().previousDevices,s=yield vn.getInstance().getDevices(void 0,!1),l=hr();if((l==null?void 0:l.name)==="Chrome"&&l.os!=="iOS")for(let h of s){const f=a.find(v=>v.deviceId===h.deviceId);f&&f.label!==""&&f.kind===h.kind&&f.label!==h.label&&this.getActiveDevice(h.kind)==="default"&&this.emit(Se.ActiveDeviceChanged,h.kind,h.deviceId)}const u=["audiooutput","audioinput","videoinput"];for(let h of u){const f=G2(h),v=this.localParticipant.getTrackPublication(f);if(v&&!((e=v.track)===null||e===void 0)&&e.isUserProvided)continue;const C=s.filter(T=>T.kind===h),x=this.getActiveDevice(h);if(x===((t=a.filter(T=>T.kind===h)[0])===null||t===void 0?void 0:t.deviceId)&&C.length>0&&((r=C[0])===null||r===void 0?void 0:r.deviceId)!==x){yield this.switchActiveDevice(h,C[0].deviceId);continue}h==="audioinput"&&!mc()||h==="videoinput"||C.length>0&&!C.find(T=>T.deviceId===this.getActiveDevice(h))&&(h!=="audiooutput"||!mc())&&(yield this.switchActiveDevice(h,C[0].deviceId))}})}acquireAudioContext(){return D(this,void 0,void 0,function*(){var e,t;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=N1())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(a=>a.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Yn(200)])}catch(a){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:a}))}const r=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(Se.AudioPlaybackStatusChanged,r))})}createParticipant(e,t){var r;let a;return t?a=wd.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):a=new wd(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&a.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&a.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),a}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const a=this.remoteParticipants.get(e);return t&&a.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),a}const r=this.createParticipant(e,t);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(Se.ParticipantConnected,r),r.on(Ie.TrackPublished,a=>{this.emitWhenConnected(Se.TrackPublished,a,r)}).on(Ie.TrackSubscribed,(a,s)=>{a.kind===me.Kind.Audio?(a.on(xe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),a.on(xe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):a.kind===me.Kind.Video&&(a.on(xe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),a.on(xe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Se.TrackSubscribed,a,s,r)}).on(Ie.TrackUnpublished,a=>{this.emit(Se.TrackUnpublished,a,r)}).on(Ie.TrackUnsubscribed,(a,s)=>{this.emit(Se.TrackUnsubscribed,a,s,r)}).on(Ie.TrackMuted,a=>{this.emitWhenConnected(Se.TrackMuted,a,r)}).on(Ie.TrackUnmuted,a=>{this.emitWhenConnected(Se.TrackUnmuted,a,r)}).on(Ie.ParticipantMetadataChanged,a=>{this.emitWhenConnected(Se.ParticipantMetadataChanged,a,r)}).on(Ie.ParticipantNameChanged,a=>{this.emitWhenConnected(Se.ParticipantNameChanged,a,r)}).on(Ie.AttributesChanged,a=>{this.emitWhenConnected(Se.ParticipantAttributesChanged,a,r)}).on(Ie.ConnectionQualityChanged,a=>{this.emitWhenConnected(Se.ConnectionQualityChanged,a,r)}).on(Ie.ParticipantPermissionsChanged,a=>{this.emitWhenConnected(Se.ParticipantPermissionsChanged,a,r)}).on(Ie.TrackSubscriptionStatusChanged,(a,s)=>{this.emitWhenConnected(Se.TrackSubscriptionStatusChanged,a,s,r)}).on(Ie.TrackSubscriptionFailed,(a,s)=>{this.emit(Se.TrackSubscriptionFailed,a,r,s)}).on(Ie.TrackSubscriptionPermissionChanged,(a,s)=>{this.emitWhenConnected(Se.TrackSubscriptionPermissionChanged,a,s,r)}).on(Ie.Active,()=>{this.emitWhenConnected(Se.ParticipantActive,r),r.kind===hc.AGENT&&this.localParticipant.setActiveAgent(r)}),t&&r.updateInfo(t),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,a)=>(r.push(...a.getTrackPublications()),r),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&z2(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Pn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ui.STATE_MISMATCH))):e=0},oE)}clearConnectionReconcile(){this.connectionReconcileInterval&&Pn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(Se.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,r]=e;this.emit(t,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(this.state===wt.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===wt.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return D(this,void 0,void 0,function*(){var t,r;const a=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Rd({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ut.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Lo({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Se.SignalConnected),this.emit(Se.Connected),this.setAndEmitConnectionState(wt.Connected),a.video){const l=new cf(me.Kind.Video,new Os({source:nn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:li.AUDIO,name:"video-dummy"}),new yd(a.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:xb(160*((t=s.aspectRatios[0])!==null&&t!==void 0?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Ie.LocalTrackPublished,l)}if(a.audio){const l=new cf(me.Kind.Audio,new Os({source:nn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:li.AUDIO}),new bd(a.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:fp(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(Ie.LocalTrackPublished,l)}for(let l=0;l<s.count-1;l+=1){let u=new Lo({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(l),state:js.ACTIVE,tracks:[],joinedAt:Ut.parse(Date.now())});const h=this.getOrCreateParticipant(u.identity,u);if(s.video){const f=xb(160*((r=s.aspectRatios[l%s.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),v=new Os({source:nn.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:li.AUDIO});h.addSubscribedMediaTrack(f,v.sid,new MediaStream([f]),new RTCRtpReceiver),u.tracks=[...u.tracks,v]}if(s.audio){const f=fp(),v=new Os({source:nn.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:li.AUDIO});h.addSubscribedMediaTrack(f,v.sid,new MediaStream([f]),new RTCRtpReceiver),u.tracks=[...u.tracks,v]}h.updateInfo(u)}})}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(e!==Se.ActiveSpeakersChanged&&e!==Se.TranscriptionReceived){const s=J1(r).filter(l=>l!==void 0);(e===Se.TrackSubscribed||e===Se.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s}))}return super.emit(e,...r)}}qs.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(n=>{n()});function J1(n){return n.map(e=>{if(e)return Array.isArray(e)?J1(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var oi;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(oi||(oi={}));class za extends Mi.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=oi.IDLE,this.logs=[],this.options={},this.url=e,this.token=t,this.name=this.constructor.name,this.room=new qs(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return D(this,void 0,void 0,function*(){if(this.status!==oi.IDLE)throw Error("check is running already");this.setStatus(oi.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==oi.SKIPPED&&this.setStatus(this.isSuccess()?oi.SUCCESS:oi.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return D(this,void 0,void 0,function*(){return this.room.state===wt.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return D(this,void 0,void 0,function*(){this.room&&this.room.state!==wt.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(oi.SKIPPED)}switchProtocol(e){return D(this,void 0,void 0,function*(){let t=!1,r=!1;if(this.room.on(Se.Reconnecting,()=>{t=!0}),this.room.once(Se.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(s=>setTimeout(s,1e3)),!t)return;const a=Date.now()+1e4;for(;Date.now()<a;){if(r)return;yield Yn(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class sE extends za{get description(){return"Cloud regions"}perform(){return D(this,void 0,void 0,function*(){const e=new cn(this.url,this.token);if(!e.isCloud()){this.skip();return}const t=[],r=new Set;for(let s=0;s<3;s++){const l=yield e.getNextBestRegionUrl();if(!l)break;if(r.has(l))continue;r.add(l);const u=yield this.checkCloudRegion(l);this.appendMessage("".concat(u.region," RTT: ").concat(u.rtt,"ms, duration: ").concat(u.duration,"ms")),t.push(u)}t.sort((s,l)=>(s.duration-l.duration)*.5+(s.rtt-l.rtt)*.5);const a=t[0];this.bestStats=a,this.appendMessage("best Cloud region: ".concat(a.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return D(this,void 0,void 0,function*(){var t,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const a=(t=this.room.serverInfo)===null||t===void 0?void 0:t.region;if(!a)throw new Error("Region not found");const s=yield this.room.localParticipant.streamText({topic:"test"}),l=1e3,u=1e6/l,h="A".repeat(l),f=Date.now();for(let T=0;T<u;T++)yield s.write(h);yield s.close();const v=Date.now(),C=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),x={region:a,rtt:1e4,duration:v-f};return C==null||C.forEach(T=>{T.type==="candidate-pair"&&T.nominated&&(x.rtt=T.currentRoundTripTime*1e3)}),yield this.disconnect(),x})}}const Cp=1e4;class lE extends za{get description(){return"Connection via UDP vs TCP"}perform(){return D(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),t=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-t.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-t.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=t):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(Cp/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(Cp/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return D(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const t=document.createElement("canvas");t.width=1280,t.height=720;const r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context");let a=0;const s=()=>{a=(a+1)%360,r.fillStyle="hsl(".concat(a,", 100%, 50%)"),r.fillRect(0,0,t.width,t.height),requestAnimationFrame(s)};s();const l=t.captureStream(30).getVideoTracks()[0],u=(yield this.room.localParticipant.publishTrack(l,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,h={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},f=setInterval(()=>D(this,void 0,void 0,function*(){const v=yield u.getRTCStatsReport();v==null||v.forEach(C=>{C.type==="outbound-rtp"?(h.packetsSent=C.packetsSent,h.qualityLimitationDurations=C.qualityLimitationDurations,h.bitrateTotal+=C.targetBitrate,h.count++):C.type==="remote-inbound-rtp"&&(h.packetsLost=C.packetsLost,h.rttTotal+=C.roundTripTime,h.jitterTotal+=C.jitter)})}),1e3);return yield new Promise(v=>setTimeout(v,Cp)),clearInterval(f),l.stop(),t.remove(),yield this.disconnect(),h})}}class cE extends za{get description(){return"Can publish audio"}perform(){return D(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield tE();if(yield L1(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),t.localParticipant.publishTrack(r),yield new Promise(l=>setTimeout(l,3e3));const a=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!a)throw new Error("Could not get RTCStats");let s=0;if(a.forEach(l=>{l.type==="outbound-rtp"&&(l.kind==="audio"||!l.kind&&l.mediaType==="audio")&&(s=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class uE extends za{get description(){return"Can publish video"}perform(){return D(this,void 0,void 0,function*(){var e;const t=yield this.connect(),r=yield eE();yield this.checkForVideo(r.mediaStreamTrack),t.localParticipant.publishTrack(r),yield new Promise(l=>setTimeout(l,5e3));const a=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!a)throw new Error("Could not get RTCStats");let s=0;if(a.forEach(l=>{l.type==="outbound-rtp"&&(l.kind==="video"||!l.kind&&l.mediaType==="video")&&(s+=l.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}checkForVideo(e){return D(this,void 0,void 0,function*(){const t=new MediaStream;t.addTrack(e.clone());const r=document.createElement("video");r.srcObject=t,r.muted=!0,r.autoplay=!0,r.playsInline=!0,r.setAttribute("playsinline","true"),document.body.appendChild(r),yield new Promise(a=>{r.onplay=()=>{setTimeout(()=>{var s,l,u,h;const f=document.createElement("canvas"),v=e.getSettings(),C=(l=(s=v.width)!==null&&s!==void 0?s:r.videoWidth)!==null&&l!==void 0?l:1280,x=(h=(u=v.height)!==null&&u!==void 0?u:r.videoHeight)!==null&&h!==void 0?h:720;f.width=C,f.height=x;const T=f.getContext("2d");T.drawImage(r,0,0);const N=T.getImageData(0,0,f.width,f.height).data;let L=!0;for(let $=0;$<N.length;$+=4)if(N[$]!==0||N[$+1]!==0||N[$+2]!==0){L=!1;break}L?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),a()},1e3)},r.play()}),t.getTracks().forEach(a=>a.stop()),r.remove()})}}class dE extends za{get description(){return"Resuming connection after interruption"}perform(){return D(this,void 0,void 0,function*(){var e;const t=yield this.connect();let r=!1,a=!1,s;const l=new Promise(f=>{setTimeout(f,5e3),s=f}),u=()=>{r=!0};t.on(Se.SignalReconnecting,u).on(Se.Reconnecting,u).on(Se.Reconnected,()=>{a=!0,s(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const h=t.engine.client.onClose;if(h&&h(""),yield l,r){if(!a||t.state!==wt.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class hE extends za{get description(){return"Can connect via TURN"}perform(){return D(this,void 0,void 0,function*(){var e,t;const r=new Jf,a=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3,singlePeerConnection:!1});let s=!1,l=!1,u=!1;for(let h of a.iceServers)for(let f of h.urls)f.startsWith("turn:")?(l=!0,u=!0):f.startsWith("turns:")&&(l=!0,u=!0,s=!0),f.startsWith("stun:")&&(u=!0);u?l&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((t=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||t===void 0)&&t.iceServers||l?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(h=>setTimeout(h,0)))})}}class pE extends za{get description(){return"Establishing WebRTC connection"}perform(){return D(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(Se.SignalConnected,()=>{var r;const a=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(s,l)=>{if(s.candidate){const u=new RTCIceCandidate(s);let h="".concat(u.protocol," ").concat(u.address,":").concat(u.port," ").concat(u.type);u.address&&(fE(u.address)?h+=" (private)":u.protocol==="tcp"&&u.tcpType==="passive"?(e=!0,h+=" (passive)"):u.protocol==="udp"&&(t=!0)),this.appendMessage(h)}a&&a(s,l)},!((r=this.room.engine.pcManager)===null||r===void 0)&&r.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=s=>{s instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(s.errorCode," ").concat(s.errorText," ").concat(s.url))})});try{yield this.connect(),ct.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function fE(n){const e=n.split(".");if(e.length===4){if(e[0]==="10"||e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class mE extends za{get description(){return"Connecting to signal connection via WebSocket"}perform(){return D(this,void 0,void 0,function*(){var e,t,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let a=new Jf;const s=yield a.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3,singlePeerConnection:!1});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===N0.Cloud&&!((t=s.serverInfo)===null||t===void 0)&&t.region&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield a.close()})}}class $R extends Mi.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=t,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:oi.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==oi.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return D(this,void 0,void 0,function*(){const t=this.getNextCheckId(),r=new e(this.url,this.token,this.options),a=l=>{this.updateCheck(t,l)};r.on("update",a);const s=yield r.run();return r.off("update",a),s})}checkWebsocket(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(mE)})}checkWebRTC(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(pE)})}checkTURN(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(hE)})}checkReconnect(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(dE)})}checkPublishAudio(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(cE)})}checkPublishVideo(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(uE)})}checkConnectionProtocol(){return D(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(lE);if(e.data&&"protocol"in e.data){const t=e.data;this.options.protocol=t.protocol}return e})}checkCloudRegion(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(sE)})}}function ft(n,e,t){return(e=vE(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gE(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vE(n){var e=gE(n,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class Xn extends Error{constructor(e,t){var r;super(e,t),ft(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}}ft(Xn,"code","ERR_JOSE_GENERIC");class bE extends Xn{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:a,payload:t}}),ft(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),ft(this,"claim",void 0),ft(this,"reason",void 0),ft(this,"payload",void 0),this.claim=r,this.reason=a,this.payload=t}}ft(bE,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class yE extends Xn{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:a,payload:t}}),ft(this,"code","ERR_JWT_EXPIRED"),ft(this,"claim",void 0),ft(this,"reason",void 0),ft(this,"payload",void 0),this.claim=r,this.reason=a,this.payload=t}}ft(yE,"code","ERR_JWT_EXPIRED");class wE extends Xn{constructor(){super(...arguments),ft(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}ft(wE,"code","ERR_JOSE_ALG_NOT_ALLOWED");class kE extends Xn{constructor(){super(...arguments),ft(this,"code","ERR_JOSE_NOT_SUPPORTED")}}ft(kE,"code","ERR_JOSE_NOT_SUPPORTED");class CE extends Xn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWE_DECRYPTION_FAILED")}}ft(CE,"code","ERR_JWE_DECRYPTION_FAILED");class SE extends Xn{constructor(){super(...arguments),ft(this,"code","ERR_JWE_INVALID")}}ft(SE,"code","ERR_JWE_INVALID");class TE extends Xn{constructor(){super(...arguments),ft(this,"code","ERR_JWS_INVALID")}}ft(TE,"code","ERR_JWS_INVALID");class xE extends Xn{constructor(){super(...arguments),ft(this,"code","ERR_JWT_INVALID")}}ft(xE,"code","ERR_JWT_INVALID");class EE extends Xn{constructor(){super(...arguments),ft(this,"code","ERR_JWK_INVALID")}}ft(EE,"code","ERR_JWK_INVALID");class PE extends Xn{constructor(){super(...arguments),ft(this,"code","ERR_JWKS_INVALID")}}ft(PE,"code","ERR_JWKS_INVALID");class _E extends Xn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}ft(_E,"code","ERR_JWKS_NO_MATCHING_KEY");class RE extends Xn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,Symbol.asyncIterator,void 0),ft(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}ft(RE,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class IE extends Xn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWKS_TIMEOUT")}}ft(IE,"code","ERR_JWKS_TIMEOUT");class OE extends Xn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),ft(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}ft(OE,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");ZT("error");const AE=n=>{const e=new TextDecoder().decode(n);if(e!==null&&typeof e=="object")return e;try{const t=JSON.parse(e);if(t===null||typeof t!="object")throw new Error("Invalid parsed");return t}catch{return null}},Z1=({handler:n,context:e,speakersEnabled:t,micEnabled:r})=>{const[a,s]=ve.useState("pending"),[l,u]=Fv(!1,100),[h,f]=Fv(!1,100),[v,C]=ve.useState([]),x=ve.useRef(null),T=ve.useRef(null),N=ve.useRef(null),[L,$]=ve.useState(null),V=ve.useCallback(async()=>{const A=x.current;A!=null&&(T.current!=null&&(T.current.stop(),T.current=null),N.current!=null&&(N.current.getTracks().forEach(U=>{U.stop()}),N.current=null),$(null),x.current=null,C([]),n.setRequestOverride(void 0),await A.disconnect())},[C,$,n]);ve.useEffect(()=>{const A=x.current;A!=null&&A.localParticipant.setMicrophoneEnabled(r)},[r]),ve.useEffect(()=>{if(L==null)return;const A=t?1:0;L.volume=A},[L,t]);const K=ve.useCallback(async()=>{s("pending");let A=null;try{A=await n.getVoiceCredentials(e)}catch{s("error");return}if(A==null)return;const U=X=>{const H=X.some(Y=>Y.isAgent),J=X.some(Y=>Y.isLocal);f(H),u(J)},Z=X=>{if(X.kind===me.Kind.Audio){T.current=X;const H=X.attach();$(H),H.play()}},oe=X=>{u(X)};try{const X=new qs;x.current=X,N.current=await navigator.mediaDevices.getUserMedia({audio:!0}),X.on(Se.TrackSubscribed,Z),X.on(Se.ActiveSpeakersChanged,U),X.localParticipant.on(Ie.IsSpeakingChanged,oe),X.on(Se.MediaDevicesError,()=>{console.info("media devices error")}),X.on(Se.Disconnected,()=>{s("terminated"),u(!1),f(!1),V()}),n.setRequestOverride(H=>{const J=new TextEncoder().encode(JSON.stringify(H.request));X.localParticipant.publishData(J).catch(Y=>{console.error("Failed to publish data to LiveKit:",Y)})}),X.on(Se.DataReceived,(H,J)=>{C(Y=>[...Y,{modalities:AE(H)??{},from:J==null?void 0:J.identity,timestamp:Date.now()}])}),await X.connect(A.url,A.token,{autoSubscribe:!0}),await X.localParticipant.setMicrophoneEnabled(!0),X.startAudio(),s("active")}catch(X){X instanceof DOMException&&X.name==="NotAllowedError"?s("noAudioPermissions"):s("error")}},[n,e,s,f,$,C,V,u]),F=async()=>{await V(),K()};return ve.useEffect(()=>(K(),()=>{V()}),[K,V]),{roomState:a,isUserSpeaking:l,isApplicationSpeaking:h,retry:F,modalities:v}},ME=ve.createContext(null),Sp={didCatch:!1,error:null};class Q1 extends ve.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Sp}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,r,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];(t=(r=this.props).onReset)===null||t===void 0||t.call(r,{args:s,reason:"imperative-api"}),this.setState(Sp)}}componentDidCatch(e,t){var r,a;(r=(a=this.props).onError)===null||r===void 0||r.call(a,e,t)}componentDidUpdate(e,t){const{didCatch:r}=this.state,{resetKeys:a}=this.props;if(r&&t.error!==null&&LE(e.resetKeys,a)){var s,l;(s=(l=this.props).onReset)===null||s===void 0||s.call(l,{next:a,prev:e.resetKeys,reason:"keys"}),this.setState(Sp)}}render(){const{children:e,fallbackRender:t,FallbackComponent:r,fallback:a}=this.props,{didCatch:s,error:l}=this.state;let u=e;if(s){const h={error:l,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")u=t(h);else if(r)u=ve.createElement(r,h);else if(a!==void 0)u=a;else throw l}return ve.createElement(ME.Provider,{value:{didCatch:s,error:l,resetErrorBoundary:this.resetErrorBoundary}},u)}}function LE(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==e.length||n.some((t,r)=>!Object.is(t,e[r]))}const gc=({message:n})=>R.jsxs("div",{className:"bg-error-secondary text-error-primary text-base p-3 rounded-inner flex items-center gap-2",children:[R.jsx($y,{className:"w-4 h-4 flex-none"}),R.jsx("p",{className:"text-primary-80",children:n})]}),Vu=({className:n,children:e})=>R.jsx("div",{className:rt("relative flex flex-col items-center justify-center",n),children:e}),Y1=({className:n,modalities:e,renderedAsOverlay:t,modalityComponents:r,handler:a})=>{const s=ve.useRef(null),l=e.map(u=>{const h=Object.entries(u.modalities).map(([f,v])=>{const C=r[f];return C==null?null:{key:f,value:v,Component:C}}).filter(f=>f!=null);return h.length===0?null:R.jsx("div",{className:"space-y-2 last:h-full",children:h.map(({key:f,value:v,Component:C})=>R.jsx(C,{renderedAsOverlay:t,data:v,conversationHandler:a,enabled:!0},f))},u.timestamp)}).filter(Boolean);return ve.useEffect(()=>{const u=s.current;if(u==null)return;const h=u.lastChild;h instanceof HTMLElement&&h.scrollIntoView({behavior:"smooth"})},[l.length]),l.length===0?null:R.jsx("div",{className:n,ref:s,children:R.jsx(Q1,{fallback:R.jsx(gc,{message:"Something went wrong"}),children:l})})},NE=({handler:n,speakersEnabled:e,colorMode:t,brandIcon:r,className:a,context:s,modalityComponents:l})=>{const[u,h]=ve.useState(!0),{roomState:f,isUserSpeaking:v,isApplicationSpeaking:C,retry:x,modalities:T}=Z1({micEnabled:u,speakersEnabled:e,handler:n,context:s});return f==="pending"?R.jsx(Vu,{className:a,children:R.jsx(s0,{})}):f==="error"||f==="noAudioPermissions"?R.jsxs(Vu,{className:a,children:[R.jsx(a0,{}),R.jsx("div",{className:"w-full px-3 h-20 flex items-center",children:R.jsx(ia,{type:"ghost",label:"Retry",Icon:cc,onClick:()=>{x()}})})]}):f==="terminated"?R.jsx(Vu,{className:a,children:R.jsxs("div",{className:rt("grow flex flex-col items-center justify-center gap-6 text-primary-80"),children:[R.jsx(sc,{className:"w-20 h-20 text-primary-20"}),R.jsxs("div",{className:"text-center",children:[R.jsx("h3",{className:"text-xl mb-2",children:"The conversation has ended"}),R.jsx("p",{children:"You can close this panel now or restart."})]})]})}):R.jsxs(Vu,{className:a,children:[R.jsxs("div",{className:"rounded-full w-fit relative",children:[R.jsx("div",{className:rt("w-[128px] h-[128px] p-4 z-10 relative rounded-full overflow-hidden bg-cover bg-center",r!=null?"":t==="dark"?"bg-[rgb(40,41,47)]":"bg-[rgb(175,175,175)]"),style:r!=null?{backgroundImage:`url(${r})`}:{},children:r==null?R.jsx(sc,{className:"w-full h-full text-primary-40"}):null}),C?R.jsx(uc,{className:"rounded-full"}):null]}),R.jsx(Y1,{className:"absolute p-4 top-0 left-0 right-0 bottom-[72px] z-10 space-y-2 max-h-full overflow-auto border-b border-solid border-primary-10",renderedAsOverlay:!0,modalities:T,modalityComponents:l,handler:n}),R.jsxs("div",{className:"w-fit flex-none absolute bottom-4 left-1/2 transform -translate-x-1/2 translate-y-0",children:[v?R.jsx(uc,{className:"rounded-inner"}):null,R.jsx(un,{Icon:u?ld:If,label:"Voice",type:u?"activated":"ghost",onClick:()=>{h(N=>!N)}})]})]})},Kb=({onClose:n,handler:e,reset:t,className:r})=>R.jsxs("div",{className:rt("p-2 md:p-3 flex flex-col grow justify-center gap-2",r),children:[R.jsx(ia,{label:"Restart conversation",Icon:cc,type:"ghost",onClick:t}),R.jsx(ia,{label:"Talk to an agent",Icon:zy,type:"ghost",onClick:()=>{e.sendIntent("NLX.Escalation"),n()}})]});function rm(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Fo=rm();function X1(n){Fo=n}const nc={exec:()=>null};function Rt(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(a,s)=>{let l=typeof s=="string"?s:s.source;return l=l.replace(Zn.caret,"$1"),t=t.replace(a,l),r},getRegex:()=>new RegExp(t,e)};return r}const Zn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},jE=/^(?:[ \t]*(?:\n|$))+/,DE=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,UE=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Cc=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,FE=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ew=/(?:[*+-]|\d{1,9}[.)])/,tw=Rt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,ew).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),im=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,BE=/^[^\n]+/,am=/(?!\s*\])(?:\\.|[^\[\]\\])+/,VE=Rt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",am).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),WE=Rt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ew).getRegex(),Dd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",om=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,zE=Rt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",om).replace("tag",Dd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),nw=Rt(im).replace("hr",Cc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Dd).getRegex(),qE=Rt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",nw).getRegex(),sm={blockquote:qE,code:DE,def:VE,fences:UE,heading:FE,hr:Cc,html:zE,lheading:tw,list:WE,newline:jE,paragraph:nw,table:nc,text:BE},Jb=Rt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Cc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Dd).getRegex(),$E={...sm,table:Jb,paragraph:Rt(im).replace("hr",Cc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Jb).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Dd).getRegex()},HE={...sm,html:Rt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",om).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:nc,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Rt(im).replace("hr",Cc).replace("heading",` *#{1,6} *[^
]`).replace("lheading",tw).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},GE=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,KE=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,rw=/^( {2,}|\\)\n(?!\s*$)/,JE=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ud=/[\p{P}\p{S}]/u,lm=/[\s\p{P}\p{S}]/u,iw=/[^\s\p{P}\p{S}]/u,ZE=Rt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,lm).getRegex(),QE=/(?!~)[\p{P}\p{S}]/u,YE=/(?!~)[\s\p{P}\p{S}]/u,XE=/(?:[^\s\p{P}\p{S}]|~)/u,eP=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,tP=Rt(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,Ud).getRegex(),aw="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",nP=Rt(aw,"gu").replace(/notPunctSpace/g,iw).replace(/punctSpace/g,lm).replace(/punct/g,Ud).getRegex(),rP=Rt(aw,"gu").replace(/notPunctSpace/g,XE).replace(/punctSpace/g,YE).replace(/punct/g,QE).getRegex(),iP=Rt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,iw).replace(/punctSpace/g,lm).replace(/punct/g,Ud).getRegex(),aP=Rt(/\\(punct)/,"gu").replace(/punct/g,Ud).getRegex(),oP=Rt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),sP=Rt(om).replace("(?:-->|$)","-->").getRegex(),lP=Rt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",sP).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),kd=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,cP=Rt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",kd).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ow=Rt(/^!?\[(label)\]\[(ref)\]/).replace("label",kd).replace("ref",am).getRegex(),sw=Rt(/^!?\[(ref)\](?:\[\])?/).replace("ref",am).getRegex(),uP=Rt("reflink|nolink(?!\\()","g").replace("reflink",ow).replace("nolink",sw).getRegex(),cm={_backpedal:nc,anyPunctuation:aP,autolink:oP,blockSkip:eP,br:rw,code:KE,del:nc,emStrongLDelim:tP,emStrongRDelimAst:nP,emStrongRDelimUnd:iP,escape:GE,link:cP,nolink:sw,punctuation:ZE,reflink:ow,reflinkSearch:uP,tag:lP,text:JE,url:nc},dP={...cm,link:Rt(/^!?\[(label)\]\((.*?)\)/).replace("label",kd).getRegex(),reflink:Rt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",kd).getRegex()},uf={...cm,emStrongRDelimAst:rP,url:Rt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},hP={...uf,br:Rt(rw).replace("{2,}","*").getRegex(),text:Rt(uf.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Wu={normal:sm,gfm:$E,pedantic:HE},$l={normal:cm,gfm:uf,breaks:hP,pedantic:dP},pP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zb=n=>pP[n];function Ei(n,e){if(e){if(Zn.escapeTest.test(n))return n.replace(Zn.escapeReplace,Zb)}else if(Zn.escapeTestNoEncode.test(n))return n.replace(Zn.escapeReplaceNoEncode,Zb);return n}function Qb(n){try{n=encodeURI(n).replace(Zn.percentDecode,"%")}catch{return null}return n}function Yb(n,e){var t;const r=n.replace(Zn.findPipe,(l,u,h)=>{let f=!1,v=u;for(;--v>=0&&h[v]==="\\";)f=!f;return f?"|":" |"}),a=r.split(Zn.splitPipe);let s=0;if(a[0].trim()||a.shift(),a.length>0&&!((t=a.at(-1))!=null&&t.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;s<a.length;s++)a[s]=a[s].trim().replace(Zn.slashPipe,"|");return a}function Hl(n,e,t){const r=n.length;if(r===0)return"";let a=0;for(;a<r&&n.charAt(r-a-1)===e;)a++;return n.slice(0,r-a)}function fP(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function Xb(n,e,t,r,a){const s=e.href,l=e.title||null,u=n[1].replace(a.other.outputLinkReplace,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const h={type:"link",raw:t,href:s,title:l,text:u,tokens:r.inlineTokens(u)};return r.state.inLink=!1,h}return{type:"image",raw:t,href:s,title:l,text:u}}function mP(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const a=r[1];return e.split(`
`).map(s=>{const l=s.match(t.other.beginningSpace);if(l===null)return s;const[u]=l;return u.length>=a.length?s.slice(a.length):s}).join(`
`)}class Cd{constructor(e){Ct(this,"options"),Ct(this,"rules"),Ct(this,"lexer"),this.options=e||Fo}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Hl(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],a=mP(r,t[3]||"",this.rules);return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:a}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(this.rules.other.endingHash.test(r)){const a=Hl(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Hl(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=Hl(t[0],`
`).split(`
`),a="",s="";const l=[];for(;r.length>0;){let u=!1;const h=[];let f;for(f=0;f<r.length;f++)if(this.rules.other.blockquoteStart.test(r[f]))h.push(r[f]),u=!0;else if(!u)h.push(r[f]);else break;r=r.slice(f);const v=h.join(`
`),C=v.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${v}`:v,s=s?`${s}
${C}`:C;const x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(C,l,!0),this.lexer.state.top=x,r.length===0)break;const T=l.at(-1);if((T==null?void 0:T.type)==="code")break;if((T==null?void 0:T.type)==="blockquote"){const N=T,L=N.raw+`
`+r.join(`
`),$=this.blockquote(L);l[l.length-1]=$,a=a.substring(0,a.length-N.raw.length)+$.raw,s=s.substring(0,s.length-N.text.length)+$.text;break}else if((T==null?void 0:T.type)==="list"){const N=T,L=N.raw+`
`+r.join(`
`),$=this.list(L);l[l.length-1]=$,a=a.substring(0,a.length-T.raw.length)+$.raw,s=s.substring(0,s.length-N.raw.length)+$.raw,r=L.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:l,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const a=r.length>1,s={type:"list",raw:"",ordered:a,start:a?+r.slice(0,-1):"",loose:!1,items:[]};r=a?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=a?r:"[*+-]");const l=this.rules.other.listItemRegex(r);let u=!1;for(;e;){let f=!1,v="",C="";if(!(t=l.exec(e))||this.rules.block.hr.test(e))break;v=t[0],e=e.substring(v.length);let x=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,K=>" ".repeat(3*K.length)),T=e.split(`
`,1)[0],N=!x.trim(),L=0;if(this.options.pedantic?(L=2,C=x.trimStart()):N?L=t[1].length+1:(L=t[2].search(this.rules.other.nonSpaceChar),L=L>4?1:L,C=x.slice(L),L+=t[1].length),N&&this.rules.other.blankLine.test(T)&&(v+=T+`
`,e=e.substring(T.length+1),f=!0),!f){const K=this.rules.other.nextBulletRegex(L),F=this.rules.other.hrRegex(L),A=this.rules.other.fencesBeginRegex(L),U=this.rules.other.headingBeginRegex(L),Z=this.rules.other.htmlBeginRegex(L);for(;e;){const oe=e.split(`
`,1)[0];let X;if(T=oe,this.options.pedantic?(T=T.replace(this.rules.other.listReplaceNesting,"  "),X=T):X=T.replace(this.rules.other.tabCharGlobal,"    "),A.test(T)||U.test(T)||Z.test(T)||K.test(T)||F.test(T))break;if(X.search(this.rules.other.nonSpaceChar)>=L||!T.trim())C+=`
`+X.slice(L);else{if(N||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||A.test(x)||U.test(x)||F.test(x))break;C+=`
`+T}!N&&!T.trim()&&(N=!0),v+=oe+`
`,e=e.substring(oe.length+1),x=X.slice(L)}}s.loose||(u?s.loose=!0:this.rules.other.doubleBlankLine.test(v)&&(u=!0));let $=null,V;this.options.gfm&&($=this.rules.other.listIsTask.exec(C),$&&(V=$[0]!=="[ ] ",C=C.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:v,task:!!$,checked:V,loose:!1,text:C,tokens:[]}),s.raw+=v}const h=s.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let f=0;f<s.items.length;f++)if(this.lexer.state.top=!1,s.items[f].tokens=this.lexer.blockTokens(s.items[f].text,[]),!s.loose){const v=s.items[f].tokens.filter(x=>x.type==="space"),C=v.length>0&&v.some(x=>this.rules.other.anyLine.test(x.raw));s.loose=C}if(s.loose)for(let f=0;f<s.items.length;f++)s.items[f].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:a,title:s}}}table(e){var t;const r=this.rules.block.table.exec(e);if(!r||!this.rules.other.tableDelimiter.test(r[2]))return;const a=Yb(r[1]),s=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),l=(t=r[3])!=null&&t.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],u={type:"table",raw:r[0],header:[],align:[],rows:[]};if(a.length===s.length){for(const h of s)this.rules.other.tableAlignRight.test(h)?u.align.push("right"):this.rules.other.tableAlignCenter.test(h)?u.align.push("center"):this.rules.other.tableAlignLeft.test(h)?u.align.push("left"):u.align.push(null);for(let h=0;h<a.length;h++)u.header.push({text:a[h],tokens:this.lexer.inline(a[h]),header:!0,align:u.align[h]});for(const h of l)u.rows.push(Yb(h,u.header.length).map((f,v)=>({text:f,tokens:this.lexer.inline(f),header:!1,align:u.align[v]})));return u}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const l=Hl(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{const l=fP(t[2],"()");if(l>-1){const u=(t[0].indexOf("!")===0?5:4)+t[1].length+l;t[2]=t[2].substring(0,l),t[0]=t[0].substring(0,u).trim(),t[3]=""}}let a=t[2],s="";if(this.options.pedantic){const l=this.rules.other.pedanticHrefTitle.exec(a);l&&(a=l[1],s=l[3])}else s=t[3]?t[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),Xb(t,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[a.toLowerCase()];if(!s){const l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return Xb(r,s,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let a=this.rules.inline.emStrongLDelim.exec(e);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){const s=[...a[0]].length-1;let l,u,h=s,f=0;const v=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,t=t.slice(-1*e.length+s);(a=v.exec(t))!=null;){if(l=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!l)continue;if(u=[...l].length,a[3]||a[4]){h+=u;continue}else if((a[5]||a[6])&&s%3&&!((s+u)%3)){f+=u;continue}if(h-=u,h>0)continue;u=Math.min(u,u+h+f);const C=[...a[0]][0].length,x=e.slice(0,s+a.index+C+u);if(Math.min(s,u)%2){const N=x.slice(1,-1);return{type:"em",raw:x,text:N,tokens:this.lexer.inlineTokens(N)}}const T=x.slice(2,-2);return{type:"strong",raw:x,text:T,tokens:this.lexer.inlineTokens(T)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(this.rules.other.newLineCharGlobal," ");const a=this.rules.other.nonSpaceChar.test(r),s=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&s&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,a;return t[2]==="@"?(r=t[1],a="mailto:"+r):(r=t[1],a=r),{type:"link",raw:t[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var t;let r;if(r=this.rules.inline.url.exec(e)){let a,s;if(r[2]==="@")a=r[0],s="mailto:"+a;else{let l;do l=r[0],r[0]=((t=this.rules.inline._backpedal.exec(r[0]))==null?void 0:t[0])??"";while(l!==r[0]);a=r[0],r[1]==="www."?s="http://"+r[0]:s=r[0]}return{type:"link",raw:r[0],text:a,href:s,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const r=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:r}}}}class Wr{constructor(e){Ct(this,"tokens"),Ct(this,"options"),Ct(this,"state"),Ct(this,"tokenizer"),Ct(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Fo,this.options.tokenizer=this.options.tokenizer||new Cd,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Zn,block:Wu.normal,inline:$l.normal};this.options.pedantic?(t.block=Wu.pedantic,t.inline=$l.pedantic):this.options.gfm&&(t.block=Wu.gfm,this.options.breaks?t.inline=$l.breaks:t.inline=$l.gfm),this.tokenizer.rules=t}static get rules(){return{block:Wu,inline:$l}}static lex(e,t){return new Wr(t).lex(e)}static lexInline(e,t){return new Wr(t).inlineTokens(e)}lex(e){e=e.replace(Zn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){var a,s,l;for(this.options.pedantic&&(e=e.replace(Zn.tabCharGlobal,"    ").replace(Zn.spaceLine,""));e;){let u;if((s=(a=this.options.extensions)==null?void 0:a.block)!=null&&s.some(f=>(u=f.call({lexer:this},e,t))?(e=e.substring(u.raw.length),t.push(u),!0):!1))continue;if(u=this.tokenizer.space(e)){e=e.substring(u.raw.length);const f=t.at(-1);u.raw.length===1&&f!==void 0?f.raw+=`
`:t.push(u);continue}if(u=this.tokenizer.code(e)){e=e.substring(u.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+u.raw,f.text+=`
`+u.text,this.inlineQueue.at(-1).src=f.text):t.push(u);continue}if(u=this.tokenizer.fences(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.heading(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.hr(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.blockquote(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.list(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.html(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.def(e)){e=e.substring(u.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="paragraph"||(f==null?void 0:f.type)==="text"?(f.raw+=`
`+u.raw,f.text+=`
`+u.raw,this.inlineQueue.at(-1).src=f.text):this.tokens.links[u.tag]||(this.tokens.links[u.tag]={href:u.href,title:u.title});continue}if(u=this.tokenizer.table(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.lheading(e)){e=e.substring(u.raw.length),t.push(u);continue}let h=e;if((l=this.options.extensions)!=null&&l.startBlock){let f=1/0;const v=e.slice(1);let C;this.options.extensions.startBlock.forEach(x=>{C=x.call({lexer:this},v),typeof C=="number"&&C>=0&&(f=Math.min(f,C))}),f<1/0&&f>=0&&(h=e.substring(0,f+1))}if(this.state.top&&(u=this.tokenizer.paragraph(h))){const f=t.at(-1);r&&(f==null?void 0:f.type)==="paragraph"?(f.raw+=`
`+u.raw,f.text+=`
`+u.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(u),r=h.length!==e.length,e=e.substring(u.raw.length);continue}if(u=this.tokenizer.text(e)){e=e.substring(u.raw.length);const f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=`
`+u.raw,f.text+=`
`+u.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=f.text):t.push(u);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var r,a,s;let l=e,u=null;if(this.tokens.links){const v=Object.keys(this.tokens.links);if(v.length>0)for(;(u=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)v.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(u=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(u=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,u.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let h=!1,f="";for(;e;){h||(f=""),h=!1;let v;if((a=(r=this.options.extensions)==null?void 0:r.inline)!=null&&a.some(x=>(v=x.call({lexer:this},e,t))?(e=e.substring(v.raw.length),t.push(v),!0):!1))continue;if(v=this.tokenizer.escape(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.tag(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.link(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(v.raw.length);const x=t.at(-1);v.type==="text"&&(x==null?void 0:x.type)==="text"?(x.raw+=v.raw,x.text+=v.text):t.push(v);continue}if(v=this.tokenizer.emStrong(e,l,f)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.codespan(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.br(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.del(e)){e=e.substring(v.raw.length),t.push(v);continue}if(v=this.tokenizer.autolink(e)){e=e.substring(v.raw.length),t.push(v);continue}if(!this.state.inLink&&(v=this.tokenizer.url(e))){e=e.substring(v.raw.length),t.push(v);continue}let C=e;if((s=this.options.extensions)!=null&&s.startInline){let x=1/0;const T=e.slice(1);let N;this.options.extensions.startInline.forEach(L=>{N=L.call({lexer:this},T),typeof N=="number"&&N>=0&&(x=Math.min(x,N))}),x<1/0&&x>=0&&(C=e.substring(0,x+1))}if(v=this.tokenizer.inlineText(C)){e=e.substring(v.raw.length),v.raw.slice(-1)!=="_"&&(f=v.raw.slice(-1)),h=!0;const x=t.at(-1);(x==null?void 0:x.type)==="text"?(x.raw+=v.raw,x.text+=v.text):t.push(v);continue}if(e){const x="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(x);break}else throw new Error(x)}}return t}}class Sd{constructor(e){Ct(this,"options"),Ct(this,"parser"),this.options=e||Fo}space(e){return""}code({text:e,lang:t,escaped:r}){var a;const s=(a=(t||"").match(Zn.notSpaceStart))==null?void 0:a[0],l=e.replace(Zn.endingNewline,"")+`
`;return s?'<pre><code class="language-'+Ei(s)+'">'+(r?l:Ei(l,!0))+`</code></pre>
`:"<pre><code>"+(r?l:Ei(l,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,r=e.start;let a="";for(let u=0;u<e.items.length;u++){const h=e.items[u];a+=this.listitem(h)}const s=t?"ol":"ul",l=t&&r!==1?' start="'+r+'"':"";return"<"+s+l+`>
`+a+"</"+s+`>
`}listitem(e){var t;let r="";if(e.task){const a=this.checkbox({checked:!!e.checked});e.loose?((t=e.tokens[0])==null?void 0:t.type)==="paragraph"?(e.tokens[0].text=a+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=a+" "+Ei(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:a+" ",text:a+" ",escaped:!0}):r+=a+" "}return r+=this.parser.parse(e.tokens,!!e.loose),`<li>${r}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let s=0;s<e.header.length;s++)r+=this.tablecell(e.header[s]);t+=this.tablerow({text:r});let a="";for(let s=0;s<e.rows.length;s++){const l=e.rows[s];r="";for(let u=0;u<l.length;u++)r+=this.tablecell(l[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+a+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Ei(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){const a=this.parser.parseInline(r),s=Qb(e);if(s===null)return a;e=s;let l='<a href="'+e+'"';return t&&(l+=' title="'+Ei(t)+'"'),l+=">"+a+"</a>",l}image({href:e,title:t,text:r}){const a=Qb(e);if(a===null)return Ei(r);e=a;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${Ei(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Ei(e.text)}}class um{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class zr{constructor(e){Ct(this,"options"),Ct(this,"renderer"),Ct(this,"textRenderer"),this.options=e||Fo,this.options.renderer=this.options.renderer||new Sd,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new um}static parse(e,t){return new zr(t).parse(e)}static parseInline(e,t){return new zr(t).parseInline(e)}parse(e,t=!0){var r,a;let s="";for(let l=0;l<e.length;l++){const u=e[l];if((a=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&a[u.type]){const f=u,v=this.options.extensions.renderers[f.type].call({parser:this},f);if(v!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type)){s+=v||"";continue}}const h=u;switch(h.type){case"space":{s+=this.renderer.space(h);continue}case"hr":{s+=this.renderer.hr(h);continue}case"heading":{s+=this.renderer.heading(h);continue}case"code":{s+=this.renderer.code(h);continue}case"table":{s+=this.renderer.table(h);continue}case"blockquote":{s+=this.renderer.blockquote(h);continue}case"list":{s+=this.renderer.list(h);continue}case"html":{s+=this.renderer.html(h);continue}case"paragraph":{s+=this.renderer.paragraph(h);continue}case"text":{let f=h,v=this.renderer.text(f);for(;l+1<e.length&&e[l+1].type==="text";)f=e[++l],v+=`
`+this.renderer.text(f);t?s+=this.renderer.paragraph({type:"paragraph",raw:v,text:v,tokens:[{type:"text",raw:v,text:v,escaped:!0}]}):s+=v;continue}default:{const f='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return s}parseInline(e,t=this.renderer){var r,a;let s="";for(let l=0;l<e.length;l++){const u=e[l];if((a=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&a[u.type]){const f=this.options.extensions.renderers[u.type].call({parser:this},u);if(f!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(u.type)){s+=f||"";continue}}const h=u;switch(h.type){case"escape":{s+=t.text(h);break}case"html":{s+=t.html(h);break}case"link":{s+=t.link(h);break}case"image":{s+=t.image(h);break}case"strong":{s+=t.strong(h);break}case"em":{s+=t.em(h);break}case"codespan":{s+=t.codespan(h);break}case"br":{s+=t.br(h);break}case"del":{s+=t.del(h);break}case"text":{s+=t.text(h);break}default:{const f='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(f),"";throw new Error(f)}}}return s}}class rc{constructor(e){Ct(this,"options"),Ct(this,"block"),this.options=e||Fo}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Wr.lex:Wr.lexInline}provideParser(){return this.block?zr.parse:zr.parseInline}}Ct(rc,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class gP{constructor(...e){Ct(this,"defaults",rm()),Ct(this,"options",this.setOptions),Ct(this,"parse",this.parseMarkdown(!0)),Ct(this,"parseInline",this.parseMarkdown(!1)),Ct(this,"Parser",zr),Ct(this,"Renderer",Sd),Ct(this,"TextRenderer",um),Ct(this,"Lexer",Wr),Ct(this,"Tokenizer",Cd),Ct(this,"Hooks",rc),this.use(...e)}walkTokens(e,t){var r,a;let s=[];for(const l of e)switch(s=s.concat(t.call(this,l)),l.type){case"table":{const u=l;for(const h of u.header)s=s.concat(this.walkTokens(h.tokens,t));for(const h of u.rows)for(const f of h)s=s.concat(this.walkTokens(f.tokens,t));break}case"list":{const u=l;s=s.concat(this.walkTokens(u.items,t));break}default:{const u=l;(a=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&a[u.type]?this.defaults.extensions.childTokens[u.type].forEach(h=>{const f=u[h].flat(1/0);s=s.concat(this.walkTokens(f,t))}):u.tokens&&(s=s.concat(this.walkTokens(u.tokens,t)))}}return s}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const l=t.renderers[s.name];l?t.renderers[s.name]=function(...u){let h=s.renderer.apply(this,u);return h===!1&&(h=l.apply(this,u)),h}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const l=t[s.level];l?l.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),a.extensions=t),r.renderer){const s=this.defaults.renderer||new Sd(this.defaults);for(const l in r.renderer){if(!(l in s))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;const u=l,h=r.renderer[u],f=s[u];s[u]=(...v)=>{let C=h.apply(s,v);return C===!1&&(C=f.apply(s,v)),C||""}}a.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new Cd(this.defaults);for(const l in r.tokenizer){if(!(l in s))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;const u=l,h=r.tokenizer[u],f=s[u];s[u]=(...v)=>{let C=h.apply(s,v);return C===!1&&(C=f.apply(s,v)),C}}a.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new rc;for(const l in r.hooks){if(!(l in s))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;const u=l,h=r.hooks[u],f=s[u];rc.passThroughHooks.has(l)?s[u]=v=>{if(this.defaults.async)return Promise.resolve(h.call(s,v)).then(x=>f.call(s,x));const C=h.call(s,v);return f.call(s,C)}:s[u]=(...v)=>{let C=h.apply(s,v);return C===!1&&(C=f.apply(s,v)),C}}a.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,l=r.walkTokens;a.walkTokens=function(u){let h=[];return h.push(l.call(this,u)),s&&(h=h.concat(s.call(this,u))),h}}this.defaults={...this.defaults,...a}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Wr.lex(e,t??this.defaults)}parser(e,t){return zr.parse(e,t??this.defaults)}parseMarkdown(e){return(t,r)=>{const a={...r},s={...this.defaults,...a},l=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&a.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const u=s.hooks?s.hooks.provideLexer():e?Wr.lex:Wr.lexInline,h=s.hooks?s.hooks.provideParser():e?zr.parse:zr.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then(f=>u(f,s)).then(f=>s.hooks?s.hooks.processAllTokens(f):f).then(f=>s.walkTokens?Promise.all(this.walkTokens(f,s.walkTokens)).then(()=>f):f).then(f=>h(f,s)).then(f=>s.hooks?s.hooks.postprocess(f):f).catch(l);try{s.hooks&&(t=s.hooks.preprocess(t));let f=u(t,s);s.hooks&&(f=s.hooks.processAllTokens(f)),s.walkTokens&&this.walkTokens(f,s.walkTokens);let v=h(f,s);return s.hooks&&(v=s.hooks.postprocess(v)),v}catch(f){return l(f)}}}onError(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const a="<p>An error occurred:</p><pre>"+Ei(r.message+"",!0)+"</pre>";return t?Promise.resolve(a):a}if(t)return Promise.reject(r);throw r}}}const Do=new gP;function St(n,e){return Do.parse(n,e)}St.options=St.setOptions=function(n){return Do.setOptions(n),St.defaults=Do.defaults,X1(St.defaults),St};St.getDefaults=rm;St.defaults=Fo;St.use=function(...n){return Do.use(...n),St.defaults=Do.defaults,X1(St.defaults),St};St.walkTokens=function(n,e){return Do.walkTokens(n,e)};St.parseInline=Do.parseInline;St.Parser=zr;St.parser=zr.parse;St.Renderer=Sd;St.TextRenderer=um;St.Lexer=Wr;St.lexer=Wr.lex;St.Tokenizer=Cd;St.Hooks=rc;St.parse=St;St.options;St.setOptions;St.use;St.walkTokens;St.parseInline;zr.parse;Wr.lex;const vP="p-2.5 w-8 h-8 transition-colors rounded-inner relative z-10 overflow-hidden focus:outline-0",bP="text-primary-60 hover:bg-primary-10 focus:bg-primary-10 active:bg-secondary-20 disabled:text-primary-20",yP="bg-accent text-secondary-80 enabled:hover:before:bg-primary-40 focus:before:bg-primary-40 enabled:active:before:bg-secondary-10 disabled:bg-accent-20",Tp=({onClick:n,type:e,label:t,className:r,Icon:a})=>{const s=n==null;return R.jsx("button",{onClick:s?void 0:n,disabled:s,"aria-label":t,className:rt(vP,e==="main"?bP:null,e==="activated"?yP:null,r),children:R.jsx(a,{size:12})})},wP={comment:{state:"idle"},items:{}},Hs=(n,e)=>n.items[e]??{rating:null,commentSubmitted:!1,commentText:""};function kP(n,e,t){return{...n,items:{...n.items,[e]:{...Hs(n,e),...t}}}}function ey(n,e,t,r){return kP(n,e,{rating:r,pending:t})}function Sc(n,e){return e.state==="idle"?{...n,comment:{state:"idle"}}:{...n,comment:{...n.comment,...e}}}function CP(n,e){const t=Hs(n,e);return Sc(n,{state:t.commentSubmitted?"submitted":"editing",activeFeedbackUrl:e,text:t.commentText})}function SP(n,e){return Sc(n,{state:"editing",activeFeedbackUrl:e,text:Hs(n,e).commentText})}function TP(n,e){return Sc(n,{activeFeedbackUrl:e,state:"submitting",text:n.comment.state==="editing"?n.comment.text:""})}function xP(n){return Sc(n,{state:"idle"})}function EP(n){if(n.comment.state!=="submitting")return n;const e=n.comment.activeFeedbackUrl;return{...n,comment:{state:"idle"},items:{...n.items,[e]:{...Hs(n,e),commentSubmitted:!0,commentText:n.comment.text}}}}function PP(n){return{...n,comment:{activeFeedbackUrl:n.comment.state==="submitting"?n.comment.activeFeedbackUrl:"",text:n.comment.state==="submitting"?n.comment.text:"",state:"error"}}}const _P=(n,e,t)=>({clickRating:(r,a)=>{Hs(t,r).rating===a&&(a=void 0),n(s=>ey(s,r,!0,a)),e.submitFeedback(r,{rating:a??0}).then(()=>{n(s=>ey(s,r,!1,a))}).catch(s=>{console.warn("Rating error",s)})},clickCommentButton:r=>{n(a=>CP(a,r))},clickCommentEdit:()=>{n(r=>r.comment.state==="idle"?r:SP(r,r.comment.activeFeedbackUrl))},editCommentText:r=>{n(a=>a.comment.state==="idle"?a:Sc(a,{state:"editing",text:r}))},submitComment:async()=>{if(n(a=>a.comment.state==="idle"?a:TP(a,a.comment.activeFeedbackUrl)),t.comment.state==="idle")return;const r=t.comment.activeFeedbackUrl;e.submitFeedback(r,{comment:t.comment.text}).then(()=>{n(a=>EP(a))}).catch(()=>{n(a=>PP(a))})},cancelComment:()=>{n(r=>xP(r))}});function RP(n){const[e,t]=ve.useState(wP);return[e,_P(t,n,e)]}const IP=({handler:n,message:e,responseIndex:t,messageIndex:r})=>e.choices.length>0?R.jsx("ul",{className:"space-y-2 max-h-[40vh] overflow-auto no-scrollbar",children:e.choices.map((a,s)=>e.selectedChoiceId==null||a.choiceId===e.selectedChoiceId?R.jsx("li",{className:"w-full",children:R.jsx(ia,{type:"ghost",Icon:Pd,onClick:e.selectedChoiceId==null?()=>{n.sendChoice(a.choiceId,{},{responseIndex:t,messageIndex:r})}:void 0,label:a.choiceText})},s):null)}):null,xp=({text:n,bubble:e,files:t})=>R.jsxs("div",{className:"space-y-2",children:[R.jsx("div",{className:"flex justify-end pl-10 text-base",children:R.jsx("div",{className:rt("text-primary-60 rounded-inner whitespace-pre-wrap",e?"bg-primary-5 p-3":""),children:n})}),t!=null?R.jsx("div",{className:"flex flex-wrap justify-end gap-2",children:t.map((r,a)=>R.jsx("img",{className:"rounded-inner h-20",src:URL.createObjectURL(r)},a))}):null]}),ty=({text:n,number:e})=>R.jsxs("span",{className:"flex items-center gap-2",children:[R.jsx("span",{className:"bg-primary-10 text-primary-60 text-xs px-1.5 py-0.5 rounded-inner",children:e}),n]}),OP=n=>{const e=new Map;return n.forEach((t,r)=>{const a={fileName:t.fileName,content:t.content,presignedUrl:t.presignedUrl,metadata:void 0,pageNumber:void 0},s=JSON.stringify(a),l=e.get(s);e.set(s,l==null?{source:a,indices:[r]}:{...l,indices:[...l.indices,r]})}),[...e.values()]},AP=({sources:n})=>{const[e,t]=ve.useState(!1),r=ve.useMemo(()=>OP(n),[n]);return r.length===0?null:R.jsxs("details",{className:"space-y-2",open:e,onToggle:a=>{t(a.currentTarget.open)},children:[R.jsxs("summary",{className:"flex cursor-pointer items-center gap-2 rounded-inner hover:bg-primary-5 text-primary-80",children:[R.jsx(eS,{type:"ghost",Icon:e?Dy:Uy}),"Sources"]}),R.jsx("ol",{className:"space-y-2",children:r.map(({source:a,indices:s},l)=>{const u=a.fileName??a.content??"Source",h="p-3 bg-primary-5 rounded-inner w-full flex items-center justify-between text-primary-80",f=s.map(v=>String(v+1)).join(", ");return R.jsx("li",{children:a.presignedUrl!=null?R.jsxs("a",{href:a.presignedUrl,className:rt(h,"hover:bg-primary-10"),children:[R.jsx(ty,{text:u,number:f}),R.jsx(Jy,{className:"w-4 h-4 text-primary-60"})]}):R.jsx("div",{className:h,children:R.jsx(ty,{text:u,number:f})})},l)})})]})},MP=({feedbackUrl:n,feedbackConfig:e,feedbackState:t,feedbackActions:r})=>{const a=Hs(t,n);if(e.feedbackType.type==="binary"){const{positiveValue:s,negativeValue:l}=e.feedbackType.config;return R.jsx("div",{className:"mt-4",children:R.jsxs("div",{className:"flex items-center gap-0.5",children:[R.jsx("span",{className:"text-sm text-primary-60",children:e.question??"Was this response helpful?"}),a.rating==null||a.rating===s?R.jsx(Tp,{type:a.rating===s?"activated":"main",label:e.labels.positive??"Yes",onClick:a.rating===s&&a.pending?void 0:()=>{r.clickRating(n,s)},Icon:Gy}):null,a.rating==null||a.rating===l?R.jsx(Tp,{type:a.rating===l?"activated":"main",label:e.labels.negative??"No",onClick:a.rating===l&&a.pending?void 0:()=>{r.clickRating(n,l)},Icon:Hy}):null,e.commentsEnabled?R.jsx(Tp,{type:a.commentSubmitted?"activated":"main",label:e.labels.comment??"Add comment",onClick:()=>{r.clickCommentButton(n)},Icon:Fy}):null]})})}else return null},LP=({responses:n,colorMode:e,chatMode:t,uploadedFiles:r,userMessageBubble:a,agentMessageBubble:s,lastApplicationResponseIndex:l,interimMessage:u,isWaiting:h,modalityComponents:f,handler:v,className:C,enabled:x,feedbackState:T,feedbackActions:N})=>{const L=ve.useRef(null),$=ve.useRef(null);return ve.useEffect(()=>{!t&&!h&&setTimeout(()=>{var V;(V=$.current)==null||V.scrollIntoView({behavior:"smooth"})})},[h,t]),ve.useEffect(()=>{var V;if(t){const K=(V=L.current)==null?void 0:V.lastChild;K instanceof HTMLElement&&K.scrollIntoView({behavior:"smooth"})}},[n.length,t]),R.jsxs("div",{className:rt("relative",C),children:[R.jsx("div",{"data-theme":e==="dark"?"light":"dark",className:rt("absolute inset-x-0 h-px top-0 bg-background opacity-[0.01] backdrop-blur-md")}),!t&&h?R.jsx(s0,{label:u??"Thinking",className:"absolute inset-0"}):null,R.jsxs("div",{className:rt("absolute inset-0 p-2 md:p-3 overflow-y-auto no-scrollbar space-y-8",!t&&h?"opacity-0":"opacity-100"),ref:L,children:[n.map((V,K)=>{var F,A,U;if(V.type===Kn.User)return V.payload.type==="text"?R.jsx(xp,{text:V.payload.text,bubble:a},K):V.payload.type==="structured"&&V.payload.utterance!=null&&V.payload.uploadIds!=null?R.jsx(xp,{bubble:a,text:V.payload.utterance,files:V.payload.uploadIds.map(oe=>r[oe]).filter(oe=>oe!=null)},K):null;if(V.type===Kn.Failure)return R.jsx(gc,{message:V.payload.text},K);const Z=l!=null&&K===l;return R.jsxs(ve.Fragment,{children:[R.jsxs("div",{className:rt("space-y-2",!t&&Z?"min-h-full":""),ref:Z?$:void 0,children:[V.payload.messages.map((oe,X)=>R.jsx("div",{className:"text-base",children:R.jsx("div",{className:rt("space-y-6 markdown",s?"p-3 w-fit bg-secondary-40 mr-10 rounded-inner":""),dangerouslySetInnerHTML:{__html:St(oe.text,{async:!1})}})},X)),((F=V.payload.metadata)==null?void 0:F.sources)!=null?R.jsx(AP,{sources:V.payload.metadata.sources}):null,R.jsx(Q1,{fallback:R.jsx(gc,{message:"Something went wrong"}),children:Object.entries(V.payload.modalities??{}).map(([oe,X])=>{const H=f[oe];return H==null?(console.warn(`Custom component implementation missing for the ${oe} modality.`),null):R.jsx(H,{data:X,conversationHandler:v,enabled:x},oe)})}),((A=V.payload.metadata)==null?void 0:A.feedbackConfig)!=null&&((U=V.payload.metadata)==null?void 0:U.feedbackUrl)!=null?R.jsx(MP,{feedbackUrl:V.payload.metadata.feedbackUrl,feedbackConfig:V.payload.metadata.feedbackConfig,feedbackState:T,feedbackActions:N}):null]}),V.payload.messages.map((oe,X)=>{if(oe.selectedChoiceId!=null){const H=oe.choices.find(J=>J.choiceId===oe.selectedChoiceId);return H==null?null:R.jsx(xp,{text:H.choiceText,bubble:a},X)}return null})]},K)}),t&&h?R.jsx("div",{className:"text-primary-40 text-base shimmer w-fit",children:u??"Thinking"}):null]},"messages")]})};function df(){return df=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},df.apply(null,arguments)}function NP(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}var jP=ve.useLayoutEffect,DP=function(n){var e=Ao.useRef(n);return jP(function(){e.current=n}),e},ny=function(n,e){if(typeof n=="function"){n(e);return}n.current=e},UP=function(n,e){var t=Ao.useRef();return Ao.useCallback(function(r){n.current=r,t.current&&ny(t.current,null),t.current=e,e&&ny(e,r)},[e])},ry={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},FP=function(n){Object.keys(ry).forEach(function(e){n.style.setProperty(e,ry[e],"important")})},iy=FP,$n=null,ay=function(n,e){var t=n.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?t+e.borderSize:t-e.paddingSize};function BP(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=1/0),$n||($n=document.createElement("textarea"),$n.setAttribute("tabindex","-1"),$n.setAttribute("aria-hidden","true"),iy($n)),$n.parentNode===null&&document.body.appendChild($n);var a=n.paddingSize,s=n.borderSize,l=n.sizingStyle,u=l.boxSizing;Object.keys(l).forEach(function(x){var T=x;$n.style[T]=l[T]}),iy($n),$n.value=e;var h=ay($n,n);$n.value=e,h=ay($n,n),$n.value="x";var f=$n.scrollHeight-a,v=f*t;u==="border-box"&&(v=v+a+s),h=Math.max(v,h);var C=f*r;return u==="border-box"&&(C=C+a+s),h=Math.min(C,h),[h,f]}var oy=function(){},VP=function(n,e){return n.reduce(function(t,r){return t[r]=e[r],t},{})},WP=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],zP=!!document.documentElement.currentStyle,qP=function(n){var e=window.getComputedStyle(n);if(e===null)return null;var t=VP(WP,e),r=t.boxSizing;if(r==="")return null;zP&&r==="border-box"&&(t.width=parseFloat(t.width)+parseFloat(t.borderRightWidth)+parseFloat(t.borderLeftWidth)+parseFloat(t.paddingRight)+parseFloat(t.paddingLeft)+"px");var a=parseFloat(t.paddingBottom)+parseFloat(t.paddingTop),s=parseFloat(t.borderBottomWidth)+parseFloat(t.borderTopWidth);return{sizingStyle:t,paddingSize:a,borderSize:s}},$P=qP;function lw(n,e,t){var r=DP(t);ve.useLayoutEffect(function(){var a=function(s){return r.current(s)};if(n)return n.addEventListener(e,a),function(){return n.removeEventListener(e,a)}},[])}var HP=function(n){lw(window,"resize",n)},GP=function(n){lw(document.fonts,"loadingdone",n)},KP=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],JP=function(n,e){var t=n.cacheMeasurements,r=n.maxRows,a=n.minRows,s=n.onChange,l=s===void 0?oy:s,u=n.onHeightChange,h=u===void 0?oy:u,f=NP(n,KP),v=f.value!==void 0,C=ve.useRef(null),x=UP(C,e),T=ve.useRef(0),N=ve.useRef(),L=function(){var V=C.current,K=t&&N.current?N.current:$P(V);if(K){N.current=K;var F=BP(K,V.value||V.placeholder||"x",a,r),A=F[0],U=F[1];T.current!==A&&(T.current=A,V.style.setProperty("height",A+"px","important"),h(A,{rowHeight:U}))}},$=function(V){v||L(),l(V)};return ve.useLayoutEffect(L),HP(L),GP(L),ve.createElement("textarea",df({},f,{onChange:$,ref:x}))},ZP=ve.forwardRef(JP);const sy=8,QP=({className:n,handler:e,uploadUrl:t,onFileUpload:r,enabled:a})=>{const[s,l]=ve.useState(!1),[u,h]=ve.useState(""),[f,v]=ve.useState(null),[C,x]=ve.useState(null),T=ve.useRef(null),N=ve.useRef(null),L=i0("md");ve.useEffect(()=>{var X;L&&((X=N.current)==null||X.focus())},[L]);const $=ve.useMemo(()=>u.trim()==="",[u]),[V,K]=ve.useState(!1),F=$&&C==null||V||!a,A=()=>{if(F)return;const X=(H,J)=>{(J==null?void 0:J.type)===Kn.Application&&(K(!1),e.unsubscribe(X),h(""),x(null),L&&setTimeout(()=>{var Y;(Y=N.current)==null||Y.focus()}))};e.subscribe(X),K(!0),t!=null&&C!=null?e.sendStructured({uploadIds:[t.uploadId],utterance:u}):e.sendText(u)},U=t!=null&&a,Z=()=>{v("Something went wrong. Please try again.")},oe=X=>{var H,J;if(t==null){Z();return}const Y=(J=(H=X.target)==null?void 0:H.files)==null?void 0:J[0];if(Y==null){Z();return}const{name:he,size:Ae,type:qe}=Y;if(x({name:he,size:Ae,type:qe}),Ae/1024**2>sy){v(`The file is too big. Max file size: ${sy}mb`);return}fetch(t.url,{method:"PUT",headers:{"Content-Type":"image/jpeg"},body:Y}).then(()=>{v(null),r({uploadId:t.uploadId,file:Y})}).catch(()=>{Z()})};return R.jsx("div",{className:rt("relative",n),children:R.jsxs("div",{className:rt("bg-primary-5 transition-colors duration-200 p-2 rounded-outer text-base font-normal",s?"":"hover:bg-secondary-20"),children:[f!=null&&R.jsxs("div",{className:"flex items-center py-1 mb-2 w-full bg-error-secondary rounded-inner",children:[R.jsx(Ap,{size:16}),R.jsx("span",{className:"truncate ml-1",children:f})]}),C&&R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[R.jsxs("p",{className:"flex items-center truncate mx-2",children:[f!=null?R.jsx(Ap,{size:16,className:"text-error-primary"}):R.jsx(Rf,{size:16,className:"text-primary-60"}),R.jsx("span",{className:"truncate ml-3",children:C.name})]}),R.jsx(un,{className:"flex-none",Icon:Vy,label:"Delete",onClick:U?()=>{x(null),v(null),T.current!=null&&(T.current.value="")}:void 0,type:"ghost"})]}),R.jsx("hr",{className:"border-b-px border-background mb-2 -mx-2"})]}),R.jsxs("div",{className:rt("flex items-end gap-1"),children:[U&&C==null?R.jsxs(R.Fragment,{children:[R.jsx("label",{htmlFor:"file-upload",className:"p-3 w-10 h-10 flex-none block transition-colors rounded-inner bg-primary-80 hover:bg-primary-80 text-secondary-80 cursor-pointer",children:R.jsx(Op,{})}),R.jsx("input",{type:"file",id:"file-upload",className:"sr-only",accept:".jpg, .jpeg, .png, .webp, .mp4, .mpeg4, .avi, .mov, .pdf",onChange:oe,ref:T})]}):R.jsx(un,{className:"flex-none",Icon:Op,label:"Upload file",type:"ghost"}),R.jsx(ZP,{disabled:V||!a,className:rt("h-10 w-full resize-none mr-2 px-2 py-2 outline-hidden","bg-transparent text-primary-80 placeholder:text-primary-40 caret-accent","disabled:text-primary-40"),placeholder:"Type something",maxRows:10,onFocus:()=>{l(!0)},onBlur:()=>{l(!1)},value:u,onChange:X=>{h(X.target.value)},onKeyDown:X=>{X.key==="Enter"&&!X.shiftKey&&(X.preventDefault(),A())},ref:N}),R.jsx(un,{className:"flex-none",label:"Send message",onClick:F?void 0:()=>{A()},type:"main",Icon:Pd})]})]})})},YP=n=>({"--font-family":n.fontFamily,"--radius-inner":n.innerBorderRadius,"--radius-outer":n.outerBorderRadius,"--color-primary-80":n.primary80,"--color-primary-60":n.primary60,"--color-primary-40":n.primary40,"--color-primary-20":n.primary20,"--color-primary-10":n.primary10,"--color-primary-5":n.primary5,"--color-primary-1":n.primary1,"--color-secondary-80":n.secondary80,"--color-secondary-60":n.secondary60,"--color-secondary-40":n.secondary40,"--color-secondary-20":n.secondary20,"--color-secondary-10":n.secondary10,"--color-secondary-5":n.secondary5,"--color-secondary-1":n.secondary1,"--color-accent":n.accent,"--color-accent-20":n.accent20,"--color-background":n.background,"--color-overlay":n.overlay,"--color-warning-primary":n.warningPrimary,"--color-warning-secondary":n.warningSecondary,"--color-error-primary":n.errorPrimary,"--color-error-secondary":n.errorSecondary}),XP={fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',innerBorderRadius:"12px",outerBorderRadius:"20px",primary80:"light-dark(rgba(0, 2, 9, 0.8), rgba(255, 255, 255, 0.85))",primary60:"light-dark(rgba(0, 2, 9, 0.6), rgba(255, 255, 255, 0.65))",primary40:"light-dark(rgba(0, 2, 9, 0.4), rgba(255, 255, 255, 0.45))",primary20:"light-dark(rgba(0, 2, 9, 0.2), rgba(255, 255, 255, 0.25))",primary10:"light-dark(rgba(0, 2, 9, 0.1), rgba(255, 255, 255, 0.15))",primary5:"light-dark(rgba(0, 2, 9, 0.05), rgba(255, 255, 255, 0.08))",primary1:"light-dark(rgba(0, 2, 9, 0.01), rgba(255, 255, 255, 0.01))",secondary80:"light-dark(rgba(255, 255, 255, 0.85), rgba(0, 2, 9, 0.8))",secondary60:"light-dark(rgba(255, 255, 255, 0.65), rgba(0, 2, 9, 0.6))",secondary40:"light-dark(rgba(255, 255, 255, 0.45), rgba(0, 2, 9, 0.4))",secondary20:"light-dark(rgba(255, 255, 255, 0.25), rgba(0, 2, 9, 0.2))",secondary10:"light-dark(rgba(255, 255, 255, 0.15), rgba(0, 2, 9, 0.1))",secondary5:"light-dark(rgba(255, 255, 255, 0.08), rgba(0, 2, 9, 0.05))",secondary1:"light-dark(rgba(255, 255, 255, 0.01), rgba(0, 2, 9, 0.01))",accent:"light-dark(rgb(28, 99, 218), rgb(174, 202, 255))",accent20:"light-dark(rgba(28, 99, 218, 0.2), rgba(174, 202, 255, 0.25))",background:"light-dark(rgba(220, 220, 220, 0.9), rgba(0, 2, 9, 0.9))",overlay:"rgba(0, 2, 9, 0.4)",warningPrimary:"light-dark(rgb(220, 159, 3), rgb(255, 214, 108))",warningSecondary:"light-dark(rgb(255, 242, 209), rgb(95, 65, 29))",errorPrimary:"light-dark(rgb(157, 3, 3), rgb(255, 133, 162))",errorSecondary:"light-dark(rgb(255, 223, 230), rgb(94, 4, 4))"},e_=n=>{const e={};return n.accent!=null&&n.accent20==null&&(e.accent20=`color-mix(in srgb, ${n.accent} 20%, transparent)`),n.primary80!=null&&(n.primary60==null&&(e.primary60=`rgb(from ${n.primary80} r g b / 0.6)`),n.primary40==null&&(e.primary40=`rgb(from ${n.primary80} r g b / 0.4)`),n.primary20==null&&(e.primary20=`rgb(from ${n.primary80} r g b / 0.2)`),n.primary10==null&&(e.primary10=`rgb(from ${n.primary80} r g b / 0.1)`),n.primary5==null&&(e.primary5=`rgb(from ${n.primary80} r g b / 0.05)`),n.primary1==null&&(e.primary1=`rgb(from ${n.primary80} r g b / 0.01)`)),n.secondary80!=null&&(n.secondary60==null&&(e.secondary60=`rgb(from ${n.secondary80} r g b / 0.6)`),n.secondary40==null&&(e.secondary40=`rgb(from ${n.secondary80} r g b / 0.4)`),n.secondary20==null&&(e.secondary20=`rgb(from ${n.secondary80} r g b / 0.2)`),n.secondary10==null&&(e.secondary10=`rgb(from ${n.secondary80} r g b / 0.1)`),n.secondary5==null&&(e.secondary5=`rgb(from ${n.secondary80} r g b / 0.05)`),n.secondary1==null&&(e.secondary1=`rgb(from ${n.secondary80} r g b / 0.01)`)),{...XP,...e,...n}},rd=({colorMode:n,children:e,theme:t,className:r})=>{const a=e_(t??{});return R.jsx("div",{className:rt(r,"font-sans"),style:{...YP(a),colorScheme:n},children:e})},cw="bg-background backdrop-blur-sm text-primary-80 rounded-outer p-2 w-[calc(100vw-16px)] max-w-[360px] space-y-4",ly=({children:n,renderCollapse:e,onClose:t})=>R.jsxs("div",{className:cw,children:[e&&R.jsx("div",{className:"flex items-center justify-end",children:R.jsx(un,{onClick:t,Icon:lc,type:"ghost",label:"Close"})}),n]}),cy=({children:n,className:e})=>R.jsx("div",{className:rt("bg-background rounded-outer p-2 w-fit flex items-center gap-2",e),children:n}),t_=({handler:n,context:e,onClose:t,modalityComponents:r,renderCollapse:a,brandIcon:s})=>{const[l,u]=ve.useState(!0),[h,f]=ve.useState(!0),v=()=>{t(new Event("close"))},{roomState:C,isUserSpeaking:x,isApplicationSpeaking:T,retry:N,modalities:L}=Z1({micEnabled:l,speakersEnabled:h,handler:n,context:e});if(C==="error")return R.jsxs(ly,{renderCollapse:a,onClose:v,children:[R.jsx(gc,{message:"I couldnt connect"}),R.jsx(ia,{type:"ghost",label:"Retry",Icon:cc,onClick:()=>{N()}})]});if(C==="noAudioPermissions")return R.jsxs(ly,{renderCollapse:a,onClose:v,children:[R.jsx(gc,{message:"Connect your microphone and speaker"}),R.jsx(ia,{type:"ghost",label:"Retry",Icon:cc,onClick:()=>{N()}})]});const $=s!=null?R.jsx("img",{className:"w-10 h-10 block flex-none object-contain object-center",src:s,role:"presentation"}):null;return C==="pending"?R.jsxs(cy,{className:"relative",children:[$,R.jsx(un,{Icon:ld,label:"Microphone",type:"ghost",className:"invisible"}),R.jsx(un,{Icon:cd,label:"Speakers",type:"ghost",className:"invisible"}),R.jsx(un,{Icon:lc,label:"Close",type:"ghost",className:"invisible"}),R.jsx("span",{className:"w-6 h-6 block text-accent absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:R.jsx(o0,{})})]}):R.jsxs(cy,{children:[$,R.jsxs("div",{className:"w-fit relative",children:[x?R.jsx(uc,{className:"rounded-inner"}):null,R.jsx(un,{Icon:l?ld:If,label:"Microphone",type:l?"activated":"ghost",onClick:()=>{u(V=>!V)}})]}),R.jsxs("div",{className:"w-fit relative",children:[T?R.jsx(uc,{className:"rounded-inner"}):null,R.jsx(un,{Icon:h?cd:Of,label:"Speakers",type:h?"activated":"ghost",onClick:()=>{f(V=>!V)}})]}),R.jsx(un,{label:"Close",Icon:lc,type:"error",onClick:()=>{v()}}),R.jsx(Y1,{className:rt(cw,"absolute right-0 -top-2 transform translate-x-0 -translate-y-full max-h-[360px] overflow-auto"),renderedAsOverlay:!1,modalities:L,modalityComponents:r,handler:n})]})};var n_=Object.prototype.toString;function r_(n){return typeof n=="function"||n_.call(n)==="[object Function]"}function i_(n){var e=Number(n);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var a_=Math.pow(2,53)-1;function o_(n){var e=i_(n);return Math.min(Math.max(e,0),a_)}function si(n,e){var t=Array,r=Object(n);if(n==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var a=o_(r.length),s=r_(t)?Object(new t(a)):new Array(a),l=0,u;l<a;)u=r[l],s[l]=u,l+=1;return s.length=a,s}function vc(n){"@babel/helpers - typeof";return vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vc(n)}function s_(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function l_(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,uw(r.key),r)}}function c_(n,e,t){return e&&l_(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function u_(n,e,t){return e=uw(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uw(n){var e=d_(n,"string");return vc(e)=="symbol"?e:e+""}function d_(n,e){if(vc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(vc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var h_=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];s_(this,n),u_(this,"items",void 0),this.items=e}return c_(n,[{key:"add",value:function(e){return this.has(e)===!1&&this.items.push(e),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(e){var t=this.items.length;return this.items=this.items.filter(function(r){return r!==e}),t!==this.items.length}},{key:"forEach",value:function(e){var t=this;this.items.forEach(function(r){e(r,r,t)})}},{key:"has",value:function(e){return this.items.indexOf(e)!==-1}},{key:"size",get:function(){return this.items.length}}])}();const p_=typeof Set>"u"?Set:h_;function Un(n){var e;return(e=n.localName)!==null&&e!==void 0?e:n.tagName.toLowerCase()}var f_={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},m_={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),none:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function g_(n,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-description","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(t){var r;return n.hasAttribute(t)&&!((r=m_[e])!==null&&r!==void 0&&r.has(t))})}function dw(n,e){return g_(n,e)}function v_(n){var e=y_(n);if(e===null||hf.indexOf(e)!==-1){var t=b_(n);if(hf.indexOf(e||"")===-1||dw(n,t||""))return t}return e}function b_(n){var e=f_[Un(n)];if(e!==void 0)return e;switch(Un(n)){case"a":case"area":case"link":if(n.hasAttribute("href"))return"link";break;case"img":return n.getAttribute("alt")===""&&!dw(n,"img")?"presentation":"img";case"input":{var t=n,r=t.type;switch(r){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return r;case"range":return"slider";case"email":case"tel":case"text":case"url":return n.hasAttribute("list")?"combobox":"textbox";case"search":return n.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return n.hasAttribute("multiple")||n.size>1?"listbox":"combobox"}return null}function y_(n){var e=n.getAttribute("role");if(e!==null){var t=e.trim().split(" ")[0];if(t.length>0)return t}return null}var hf=["presentation","none"];function Dt(n){return n!==null&&n.nodeType===n.ELEMENT_NODE}function hw(n){return Dt(n)&&Un(n)==="caption"}function id(n){return Dt(n)&&Un(n)==="input"}function w_(n){return Dt(n)&&Un(n)==="optgroup"}function k_(n){return Dt(n)&&Un(n)==="select"}function C_(n){return Dt(n)&&Un(n)==="table"}function S_(n){return Dt(n)&&Un(n)==="textarea"}function T_(n){var e=n.ownerDocument===null?n:n.ownerDocument,t=e.defaultView;if(t===null)throw new TypeError("no window available");return t}function x_(n){return Dt(n)&&Un(n)==="fieldset"}function E_(n){return Dt(n)&&Un(n)==="legend"}function P_(n){return Dt(n)&&Un(n)==="slot"}function __(n){return Dt(n)&&n.ownerSVGElement!==void 0}function R_(n){return Dt(n)&&Un(n)==="svg"}function I_(n){return __(n)&&Un(n)==="title"}function Td(n,e){if(Dt(n)&&n.hasAttribute(e)){var t=n.getAttribute(e).split(" "),r=n.getRootNode?n.getRootNode():n.ownerDocument;return t.map(function(a){return r.getElementById(a)}).filter(function(a){return a!==null})}return[]}function ra(n,e){return Dt(n)?e.indexOf(v_(n))!==-1:!1}function O_(n){return n.trim().replace(/\s\s+/g," ")}function A_(n,e){if(!Dt(n))return!1;if(n.hasAttribute("hidden")||n.getAttribute("aria-hidden")==="true")return!0;var t=e(n);return t.getPropertyValue("display")==="none"||t.getPropertyValue("visibility")==="hidden"}function M_(n){return ra(n,["button","combobox","listbox","textbox"])||pw(n,"range")}function pw(n,e){if(!Dt(n))return!1;switch(e){case"range":return ra(n,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function uy(n,e){var t=si(n.querySelectorAll(e));return Td(n,"aria-owns").forEach(function(r){t.push.apply(t,si(r.querySelectorAll(e)))}),t}function L_(n){return k_(n)?n.selectedOptions||uy(n,"[selected]"):uy(n,'[aria-selected="true"]')}function N_(n){return ra(n,hf)}function j_(n){return hw(n)}function D_(n){return ra(n,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function U_(n){return!1}function F_(n){return id(n)||S_(n)?n.value:n.textContent||""}function dy(n){var e=n.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function fw(n){var e=Un(n);return e==="button"||e==="input"&&n.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function mw(n){if(fw(n))return n;var e=null;return n.childNodes.forEach(function(t){if(e===null&&Dt(t)){var r=mw(t);r!==null&&(e=r)}}),e}function B_(n){if(n.control!==void 0)return n.control;var e=n.getAttribute("for");return e!==null?n.ownerDocument.getElementById(e):mw(n)}function V_(n){var e=n.labels;if(e===null)return e;if(e!==void 0)return si(e);if(!fw(n))return null;var t=n.ownerDocument;return si(t.querySelectorAll("label")).filter(function(r){return B_(r)===n})}function W_(n){var e=n.assignedNodes();return e.length===0?si(n.childNodes):e}function gw(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new p_,r=typeof Map>"u"?void 0:new Map,a=T_(n),s=e.compute,l=s===void 0?"name":s,u=e.computedStyleSupportsPseudoElements,h=u===void 0?e.getComputedStyle!==void 0:u,f=e.getComputedStyle,v=f===void 0?a.getComputedStyle.bind(a):f,C=e.hidden,x=C===void 0?!1:C,T=function(F,A){if(A!==void 0)throw new Error("use uncachedGetComputedStyle directly for pseudo elements");if(r===void 0)return v(F);var U=r.get(F);if(U)return U;var Z=v(F,A);return r.set(F,Z),Z};function N(F,A){var U="";if(Dt(F)&&h){var Z=v(F,"::before"),oe=dy(Z);U="".concat(oe," ").concat(U)}var X=P_(F)?W_(F):si(F.childNodes).concat(Td(F,"aria-owns"));if(X.forEach(function(Y){var he=K(Y,{isEmbeddedInLabel:A.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),Ae=Dt(Y)?T(Y).getPropertyValue("display"):"inline",qe=Ae!=="inline"?" ":"";U+="".concat(qe).concat(he).concat(qe)}),Dt(F)&&h){var H=v(F,"::after"),J=dy(H);U="".concat(U," ").concat(J)}return U.trim()}function L(F,A){var U=F.getAttributeNode(A);return U!==null&&!t.has(U)&&U.value.trim()!==""?(t.add(U),U.value):null}function $(F){return Dt(F)?L(F,"title"):null}function V(F){if(!Dt(F))return null;if(x_(F)){t.add(F);for(var A=si(F.childNodes),U=0;U<A.length;U+=1){var Z=A[U];if(E_(Z))return K(Z,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(C_(F)){t.add(F);for(var oe=si(F.childNodes),X=0;X<oe.length;X+=1){var H=oe[X];if(hw(H))return K(H,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(R_(F)){t.add(F);for(var J=si(F.childNodes),Y=0;Y<J.length;Y+=1){var he=J[Y];if(I_(he))return he.textContent}return null}else if(Un(F)==="img"||Un(F)==="area"){var Ae=L(F,"alt");if(Ae!==null)return Ae}else if(w_(F)){var qe=L(F,"label");if(qe!==null)return qe}if(id(F)&&(F.type==="button"||F.type==="submit"||F.type==="reset")){var Ue=L(F,"value");if(Ue!==null)return Ue;if(F.type==="submit")return"Submit";if(F.type==="reset")return"Reset"}var ot=V_(F);if(ot!==null&&ot.length!==0)return t.add(F),si(ot).map(function(ue){return K(ue,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(ue){return ue.length>0}).join(" ");if(id(F)&&F.type==="image"){var Fe=L(F,"alt");if(Fe!==null)return Fe;var z=L(F,"title");return z!==null?z:"Submit Query"}if(ra(F,["button"])){var ce=N(F,{isEmbeddedInLabel:!1});if(ce!=="")return ce}return null}function K(F,A){if(t.has(F))return"";if(!x&&A_(F,T)&&!A.isReferenced)return t.add(F),"";var U=Dt(F)?F.getAttributeNode("aria-labelledby"):null,Z=U!==null&&!t.has(U)?Td(F,"aria-labelledby"):[];if(l==="name"&&!A.isReferenced&&Z.length>0)return t.add(U),Z.map(function(Ae){return K(Ae,{isEmbeddedInLabel:A.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var oe=A.recursion&&M_(F)&&l==="name";if(!oe){var X=(Dt(F)&&F.getAttribute("aria-label")||"").trim();if(X!==""&&l==="name")return t.add(F),X;if(!N_(F)){var H=V(F);if(H!==null)return t.add(F),H}}if(ra(F,["menu"]))return t.add(F),"";if(oe||A.isEmbeddedInLabel||A.isReferenced){if(ra(F,["combobox","listbox"])){t.add(F);var J=L_(F);return J.length===0?id(F)?F.value:"":si(J).map(function(Ae){return K(Ae,{isEmbeddedInLabel:A.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(pw(F,"range"))return t.add(F),F.hasAttribute("aria-valuetext")?F.getAttribute("aria-valuetext"):F.hasAttribute("aria-valuenow")?F.getAttribute("aria-valuenow"):F.getAttribute("value")||"";if(ra(F,["textbox"]))return t.add(F),F_(F)}if(D_(F)||Dt(F)&&A.isReferenced||j_(F)||U_()){var Y=N(F,{isEmbeddedInLabel:A.isEmbeddedInLabel});if(Y!=="")return t.add(F),Y}if(F.nodeType===F.TEXT_NODE)return t.add(F),F.textContent||"";if(A.recursion)return t.add(F),N(F,{isEmbeddedInLabel:A.isEmbeddedInLabel});var he=$(F);return he!==null?(t.add(F),he):(t.add(F),"")}return O_(K(n,{isEmbeddedInLabel:!1,isReferenced:l==="description",recursion:!1}))}function bc(n){"@babel/helpers - typeof";return bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bc(n)}function hy(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function py(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hy(Object(t),!0).forEach(function(r){z_(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):hy(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function z_(n,e,t){return e=q_(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function q_(n){var e=$_(n,"string");return bc(e)=="symbol"?e:e+""}function $_(n,e){if(bc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(bc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function fy(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=Td(n,"aria-describedby").map(function(s){return gw(s,py(py({},e),{},{compute:"description"}))}).join(" ");if(t===""){var r=n.getAttribute("aria-description");t=r===null?"":r}if(t===""){var a=n.getAttribute("title");t=a===null?"":a}return t}function H_(n){return ra(n,["caption","code","deletion","emphasis","generic","insertion","none","paragraph","presentation","strong","subscript","superscript"])}function pf(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return H_(n)?"":gw(n,e)}const G_=n=>n instanceof HTMLTextAreaElement?{value:n.value}:n.type==="checkbox"?{value:n.checked,options:[{value:!0,selected:n.checked,text:"checked"},{value:!1,selected:!n.checked,text:"unchecked"}]}:{value:n.value},K_=n=>{if(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement){const e=pf(n)??"";return{name:e===""?n.name:e,description:fy(n),type:n.type,placeholder:n.placeholder,...G_(n)}}else if(n instanceof HTMLSelectElement){const e=pf(n)??"";return{name:e===""?n.name:e,description:fy(n),type:n.type,value:n.value,options:Array.from(n.options).map(t=>({value:t.value,text:t.text,selected:t.selected}))}}throw new TypeError("Unsupported element type")},J_=()=>{const n=Array.from(document.querySelectorAll("input, textarea, select")).map((t,r)=>({index:r,id:`${t.tagName.toLowerCase()}-${r}`,element:t})),e={};return n.forEach(({id:t,element:r})=>{e[t]=r}),{context:n.map(({id:t,element:r})=>({id:t,...K_(r)})),formElements:e}},Jl=(n,...e)=>{console.debug(`[NLX V+] ${n}`,...e)},Z_=(n,e=50,t=1/0)=>{let r=null,a=null,s=Promise.resolve();return(...l)=>{a??(a=Date.now());const u=()=>{s=s.then(async()=>{try{await n.apply(null,l)}catch{}}),a=null};r&&clearTimeout(r),Date.now()-a>t?u():r=setTimeout(()=>{u()},e)}},Q_=(n,e,t,r)=>{let a={fields:[],destinations:[],actions:[]};const s=Z_(async()=>{const{context:u,state:h}=t(Y_(e));if(!xf(a,u)){try{Jl("Automatic context sent:",u),await n.sendContext({"nlx:vpContext":u})}catch{}r(h),a=u}},50,300);s();const l=new MutationObserver(s);return l.observe(document.body,{subtree:!0,childList:!0,attributes:!0}),{teardown:()=>{l.disconnect()},onCustomCommandsChange:u=>{e=u,s()}}},Y_=n=>{const{context:e,formElements:t}=J_(),{context:r,links:a}=X_();return{context:{uri:window.location.pathname,fields:e,destinations:r,actions:n.filter(s=>s.description!=null).map(s=>{const{handler:l,...u}=s;return u})},state:{formElements:t,links:a,customCommands:new Map(n.map(s=>[s.action,s.handler]))}}},X_=()=>{const n=Object.fromEntries(Yk(Array.from(document.querySelectorAll("a")).map(e=>[pf(e),e.getAttribute("href")??""])));return{context:Object.keys(n),links:n}},eR=(n,e,t)=>{const r=a=>{switch(Jl("Command received",a),a.classification){case"navigation":if(e.navigation!=null)e.navigation(a.action,a.destination,t.current.links);else if(e.automaticContext!==!1)switch(a.action){case"page_next":window.history.forward();break;case"page_previous":window.history.back();break;case"page_custom":if(a.destination!=null){const s=t.current.links[a.destination];if(s!=null)window.location.href=s;else try{new URL(a.destination),window.location.href=a.destination}catch{Jl('Custom page navigation action received, but no URL found for destination".',a.destination)}}break;case"page_unknown":Jl("Unknown page navigation action received, no automatic handling available.")}break;case"input":(e==null?void 0:e.input)!=null?e.input(a.fields,t.current.formElements):(e==null?void 0:e.automaticContext)!==!1&&a.fields.forEach(s=>{if(t.current.formElements[s.id]!=null){const l=t.current.formElements[s.id];typeof s.value=="string"?l.value=s.value:l instanceof HTMLInputElement&&l.type==="checkbox"&&(l.checked=s.value),l.classList.add("voice-updated"),l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0})),setTimeout(()=>{l.classList.remove("voice-updated")},2e3)}});break;case"custom":t.current.customCommands.has(a.action)&&t.current.customCommands.get(a.action)(a.payload),Jl(`No custom command handler was defined for the %o action.

%cTip: Set up a handler with 
setCustomBidirectionalCommands([{ action: "${a.action}", handler() { }}])`,a.action,"font-style: italic; font-size: 90%"),(e==null?void 0:e.custom)!=null&&(e.automaticContext!==!1&&console.warn("bidirectional.custom is deprecated in automatic context mode. Please use `setCustomBidirectionalCommands` instead."),e.custom(a.action,a.payload));break}};return n.addEventListener("voicePlusCommand",r),()=>{n.removeEventListener("voicePlusCommand",r)}};var ff={exports:{}},tR=ff.exports,my;function nR(){return my||(my=1,function(n,e){(function(t,r){n.exports=r()})(tR,()=>(()=>{var t=[,(l,u,h)=>{h.r(u),h.d(u,{default:()=>v});var f=(()=>{var C=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(x={}){var T=x,N,L;T.ready=new Promise((d,p)=>{N=d,L=p});function $(){function d(B){const G=k;g=p=0,k=new Map,G.forEach(se=>{try{se(B)}catch(ee){console.error(ee)}}),this.ob(),E&&E.Qb()}let p=0,g=0,k=new Map,E=null,I=null;this.requestAnimationFrame=function(B){p||(p=requestAnimationFrame(d.bind(this)));const G=++g;return k.set(G,B),G},this.cancelAnimationFrame=function(B){k.delete(B),p&&k.size==0&&(cancelAnimationFrame(p),p=0)},this.Ob=function(B){I&&(document.body.remove(I),I=null),B||(I=document.createElement("div"),I.style.backgroundColor="black",I.style.position="fixed",I.style.right=0,I.style.top=0,I.style.color="white",I.style.padding="4px",I.innerHTML="RIVE FPS",B=function(G){I.innerHTML="RIVE FPS "+G.toFixed(1)},document.body.appendChild(I)),E=new function(){let G=0,se=0;this.Qb=function(){var ee=performance.now();se?(++G,ee-=se,1e3<ee&&(B(1e3*G/ee),G=se=0)):(se=ee,G=0)}}},this.ob=function(){}}function V(){console.assert(!0);const d=new Map;let p=-1/0;this.push=function(g){return g=g+255>>8,d.has(g)&&clearTimeout(d.get(g)),d.set(g,setTimeout(function(){d.delete(g),d.length==0?p=-1/0:g==p&&(p=Math.max(...d.keys()),console.assert(p<g))},1e3)),p=Math.max(g,p),p<<8}}const K=T.onRuntimeInitialized;T.onRuntimeInitialized=function(){K&&K();let d=T.decodeAudio;T.decodeAudio=function(E,I){E=d(E),I(E)};let p=T.decodeFont;T.decodeFont=function(E,I){E=p(E),I(E)};const g=T.FileAssetLoader;T.ptrToAsset=E=>{let I=T.ptrToFileAsset(E);return I.isImage?T.ptrToImageAsset(E):I.isFont?T.ptrToFontAsset(E):I.isAudio?T.ptrToAudioAsset(E):I},T.CustomFileAssetLoader=g.extend("CustomFileAssetLoader",{__construct:function({loadContents:E}){this.__parent.__construct.call(this),this.Eb=E},loadContents:function(E,I){return E=T.ptrToAsset(E),this.Eb(E,I)}}),T.CDNFileAssetLoader=g.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(E){let I=T.ptrToAsset(E);return E=I.cdnUuid,E===""?!1:(function(B,G){var se=new XMLHttpRequest;se.responseType="arraybuffer",se.onreadystatechange=function(){se.readyState==4&&se.status==200&&G(se)},se.open("GET",B,!0),se.send(null)}(I.cdnBaseUrl+"/"+E,B=>{I.decode(new Uint8Array(B.response))}),!0)}}),T.FallbackFileAssetLoader=g.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.kb=[]},addLoader:function(E){this.kb.push(E)},loadContents:function(E,I){for(let B of this.kb)if(B.loadContents(E,I))return!0;return!1}});let k=T.computeAlignment;T.computeAlignment=function(E,I,B,G,se=1){return k.call(this,E,I,B,G,se)}};const F=T.onRuntimeInitialized;T.onRuntimeInitialized=function(){function d(fe){this.F=fe,this.Db=fe.getContext("2d"),this.Gb=k,this.S=[],this.la=0,this.clear=function(){console.assert(this.la==0),this.S=[],E.delete(this)},this.save=function(){++this.la,this.S.push(k.save.bind(k))},this.restore=function(){0<this.la&&(this.S.push(k.restore.bind(k)),--this.la)},this.transform=function(Pe){this.S.push(k.transform.bind(k,Pe))},this.align=function(Pe,He,Je,et,vt=1){this.S.push(k.align.bind(k,Pe,He,Je,et,vt))},this.flush=function(){console.assert(this.la==0),E.add(this),k.$a||g()},this.delete=function(){}}function p(fe,Pe=!1){var He={alpha:!0,depth:Pe,stencil:Pe,antialias:Pe,premultipliedAlpha:!0,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:!1,explicitSwapControl:0,renderViaOffscreenBackBuffer:0};if(Pe=fe.getContext("webgl2",He),!Pe)return null;He=Gd(Pe,He),os(He);const Je=I(fe.width,fe.height);Je.Na=He,Je.F=fe,Je.Oa=fe.width,Je.ab=fe.height,Je.T=Pe;var et=Je.delete;return Je.delete=function(){et.call(this);var vt=this.Na;br===Zt[vt]&&(br=null),typeof JSEvents=="object"&&JSEvents.Oc(Zt[vt].C.canvas),Zt[vt]&&Zt[vt].C.canvas&&(Zt[vt].C.canvas.Cb=void 0),this.Na=this.F=this.Oa=this.T=Zt[vt]=null},Je}function g(){if(k){var fe=k.Fb,Pe=0,He=0,Je=0,et=Array(E.size),vt=0;for(var It of E)It.ga=Math.min(It.F.width,fe),It.fa=Math.min(It.F.height,fe),It.La=It.fa*It.ga,Pe=Math.max(Pe,It.ga),He=Math.max(He,It.fa),Je+=It.La,et[vt++]=It;if(E.clear(),!(0>=Je)){for(Pe=1<<(0>=Pe?0:32-Math.clz32(Pe-1)),He=1<<(0>=He?0:32-Math.clz32(He-1));He*Pe<Je;)Pe<=He?Pe*=2:He*=2;for(Pe=Math.min(Pe,fe),Pe=Math.min(He,fe),et.sort((Yr,Wi)=>Wi.La-Yr.La),Je=new T.DynamicRectanizer(fe),It=0;It<et.length;){for(Je.reset(Pe,He),vt=It;vt<et.length;++vt){var Mt=et[vt],Pt=Je.addRect(Mt.ga,Mt.fa);if(0>Pt){console.assert(vt>It);break}Mt.ra=Pt&65535,Mt.sa=Pt>>16}for(Mt=se.push(Je.drawWidth()),Pt=ee.push(Je.drawHeight()),console.assert(Mt>=Je.drawWidth()),console.assert(Pt>=Je.drawHeight()),console.assert(Mt<=fe),console.assert(Pt<=fe),k.F.width!=Mt&&(k.F.width=Mt),k.F.height!=Pt&&(k.F.height=Pt),k.clear(),Mt=It;Mt<vt;++Mt){Pt=et[Mt],k.saveClipRect(Pt.ra,Pt.sa,Pt.ra+Pt.ga,Pt.sa+Pt.fa);let Yr=new T.Mat2D;Yr.xx=Pt.ga/Pt.F.width,Yr.yy=Pt.fa/Pt.F.height,Yr.xy=Yr.yx=0,Yr.tx=Pt.ra,Yr.ty=Pt.sa,k.transform(Yr);for(const Wi of Pt.S)Wi();k.restoreClipRect(),Pt.S=[]}for(k.flush();It<vt;++It)Mt=et[It],Pt=Mt.Db,Pt.globalCompositeOperation="copy",Pt.drawImage(k.F,Mt.ra,Mt.sa,Mt.ga,Mt.fa,0,0,Mt.F.width,Mt.F.height);It=vt}}}}F&&F();let k=null;const E=new Set,I=T.makeRenderer;T.makeRenderer=function(fe,Pe){if(!k){let He=function(Je){var et=document.createElement("canvas");return et.width=1,et.height=1,k=p(et,Je),k.$a=!!k.T.getExtension("WEBGL_shader_pixel_local_storage"),k.Fb=Math.min(k.T.getParameter(k.T.MAX_RENDERBUFFER_SIZE),k.T.getParameter(k.T.MAX_TEXTURE_SIZE)),k.Ma=!k.$a,(Je=k.T.getExtension("WEBGL_debug_renderer_info"))&&(et=k.T.getParameter(Je.UNMASKED_RENDERER_WEBGL),k.T.getParameter(Je.UNMASKED_VENDOR_WEBGL).includes("Google")&&et.includes("ANGLE Metal Renderer")&&(k.Ma=!1)),k};k=He(!0),k.Ma||(k=He(!1))}return Pe?new d(fe):p(fe,k.Ma)};const B=T.Artboard.prototype.delete;T.Artboard.prototype.delete=function(){this.Hb=!0,B.call(this)};const G=T.Artboard.prototype.draw;T.Artboard.prototype.draw=function(fe){fe.S?fe.S.push(()=>{this.Hb||G.call(this,fe.Gb)}):G.call(this,fe)};const se=new V,ee=new V,Te=new $;T.requestAnimationFrame=Te.requestAnimationFrame.bind(Te),T.cancelAnimationFrame=Te.cancelAnimationFrame.bind(Te),T.enableFPSCounter=Te.Ob.bind(Te),Te.ob=g,T.resolveAnimationFrame=g;let _e=T.load;T.load=function(fe,Pe,He=!0){const Je=new T.FallbackFileAssetLoader;return Pe!==void 0&&Je.addLoader(Pe),He&&(Pe=new T.CDNFileAssetLoader,Je.addLoader(Pe)),Promise.resolve(_e(fe,Je))};const De=T.WebGL2Renderer.prototype.clear;T.WebGL2Renderer.prototype.clear=function(){os(this.Na);const fe=this.F;(this.Oa!=fe.width||this.ab!=fe.height)&&(this.resize(fe.width,fe.height),this.Oa=fe.width,this.ab=fe.height),De.call(this)},T.decodeImage=function(fe,Pe){fe=T.decodeWebGL2Image(fe),Pe(fe)};let ne=T.Renderer.prototype.align;T.Renderer.prototype.align=function(fe,Pe,He,Je,et=1){ne.call(this,fe,Pe,He,Je,et)}};var A=Object.assign({},T),U="./this.program",Z=typeof window=="object",oe=typeof importScripts=="function",X="",H,J;(Z||oe)&&(oe?X=self.location.href:typeof document<"u"&&document.currentScript&&(X=document.currentScript.src),C&&(X=C),X.indexOf("blob:")!==0?X=X.substr(0,X.replace(/[?#].*/,"").lastIndexOf("/")+1):X="",oe&&(J=d=>{var p=new XMLHttpRequest;return p.open("GET",d,!1),p.responseType="arraybuffer",p.send(null),new Uint8Array(p.response)}),H=(d,p,g)=>{var k=new XMLHttpRequest;k.open("GET",d,!0),k.responseType="arraybuffer",k.onload=()=>{k.status==200||k.status==0&&k.response?p(k.response):g()},k.onerror=g,k.send(null)});var Y=T.print||console.log.bind(console),he=T.printErr||console.error.bind(console);Object.assign(T,A),A=null,T.thisProgram&&(U=T.thisProgram);var Ae;T.wasmBinary&&(Ae=T.wasmBinary),T.noExitRuntime,typeof WebAssembly!="object"&&bn("no native wasm support detected");var qe,Ue,ot=!1,Fe,z,ce,ue,M,ae,Ve,ke;function Me(){var d=qe.buffer;T.HEAP8=Fe=new Int8Array(d),T.HEAP16=ce=new Int16Array(d),T.HEAP32=M=new Int32Array(d),T.HEAPU8=z=new Uint8Array(d),T.HEAPU16=ue=new Uint16Array(d),T.HEAPU32=ae=new Uint32Array(d),T.HEAPF32=Ve=new Float32Array(d),T.HEAPF64=ke=new Float64Array(d)}var Oe,Ye=[],$e=[],dt=[];function At(){var d=T.preRun.shift();Ye.unshift(d)}var qt=0,er=null;function bn(d){throw T.onAbort&&T.onAbort(d),d="Aborted("+d+")",he(d),ot=!0,d=new WebAssembly.RuntimeError(d+". Build with -sASSERTIONS for more info."),L(d),d}function Sr(d){return d.startsWith("data:application/octet-stream;base64,")}var Tr;if(Tr="webgl2_advanced.wasm",!Sr(Tr)){var sa=Tr;Tr=T.locateFile?T.locateFile(sa,X):X+sa}function Li(d){if(d==Tr&&Ae)return new Uint8Array(Ae);if(J)return J(d);throw"both async and sync fetching of the wasm failed"}function Bo(d){if(!Ae&&(Z||oe)){if(typeof fetch=="function"&&!d.startsWith("file://"))return fetch(d,{credentials:"same-origin"}).then(p=>{if(!p.ok)throw"failed to load wasm binary file at '"+d+"'";return p.arrayBuffer()}).catch(()=>Li(d));if(H)return new Promise((p,g)=>{H(d,k=>p(new Uint8Array(k)),g)})}return Promise.resolve().then(()=>Li(d))}function yn(d,p,g){return Bo(d).then(k=>WebAssembly.instantiate(k,p)).then(k=>k).then(g,k=>{he("failed to asynchronously prepare wasm: "+k),bn(k)})}function Ni(d,p){var g=Tr;return Ae||typeof WebAssembly.instantiateStreaming!="function"||Sr(g)||g.startsWith("file://")||typeof fetch!="function"?yn(g,d,p):fetch(g,{credentials:"same-origin"}).then(k=>WebAssembly.instantiateStreaming(k,d).then(p,function(E){return he("wasm streaming compile failed: "+E),he("falling back to ArrayBuffer instantiation"),yn(g,d,p)}))}var Fn,ji,Vo={534231:(d,p,g,k,E)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Ga:0},window.h.I={},window.h.I.Ea=d,window.h.I.capture=p,window.h.I.Ra=g,window.h.ja={},window.h.ja.stopped=k,window.h.ja.xb=E;let I=window.h;I.D=[],I.rc=function(B){for(var G=0;G<I.D.length;++G)if(I.D[G]==null)return I.D[G]=B,G;return I.D.push(B),I.D.length-1},I.Bb=function(B){for(I.D[B]=null;0<I.D.length&&I.D[I.D.length-1]==null;)I.D.pop()},I.Qc=function(B){for(var G=0;G<I.D.length;++G)if(I.D[G]==B)return I.Bb(G)},I.va=function(B){return I.D[B]},I.Za=["touchend","click"],I.unlock=function(){for(var B=0;B<I.D.length;++B){var G=I.D[B];G!=null&&G.J!=null&&G.state===I.ja.xb&&G.J.resume().then(()=>{rr(G.pb)},se=>{console.error("Failed to resume audiocontext",se)})}I.Za.map(function(se){document.removeEventListener(se,I.unlock,!0)})},I.Za.map(function(B){document.addEventListener(B,I.unlock,!0)})}return window.h.Ga+=1,1},536409:()=>{typeof window.h<"u"&&(window.h.Za.map(function(d){document.removeEventListener(d,window.h.unlock,!0)}),--window.h.Ga,window.h.Ga===0&&delete window.h)},536713:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,536817:()=>{try{var d=new(window.AudioContext||window.webkitAudioContext),p=d.sampleRate;return d.close(),p}catch{return 0}},536988:(d,p,g,k,E,I)=>{if(typeof window.h>"u")return-1;var B={},G={};return d==window.h.I.Ea&&g!=0&&(G.sampleRate=g),B.J=new(window.AudioContext||window.webkitAudioContext)(G),B.J.suspend(),B.state=window.h.ja.stopped,g=0,d!=window.h.I.Ea&&(g=p),B.Z=B.J.createScriptProcessor(k,g,p),B.Z.onaudioprocess=function(se){if((B.wa==null||B.wa.length==0)&&(B.wa=new Float32Array(Ve.buffer,E,k*p)),d==window.h.I.capture||d==window.h.I.Ra){for(var ee=0;ee<p;ee+=1)for(var Te=se.inputBuffer.getChannelData(ee),_e=B.wa,De=0;De<k;De+=1)_e[De*p+ee]=Te[De];ga(I,k,E)}if(d==window.h.I.Ea||d==window.h.I.Ra)for(ml(I,k,E),ee=0;ee<se.outputBuffer.numberOfChannels;++ee)for(Te=se.outputBuffer.getChannelData(ee),_e=B.wa,De=0;De<k;De+=1)Te[De]=_e[De*p+ee];else for(ee=0;ee<se.outputBuffer.numberOfChannels;++ee)se.outputBuffer.getChannelData(ee).fill(0)},d!=window.h.I.capture&&d!=window.h.I.Ra||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(se){B.Ha=B.J.createMediaStreamSource(se),B.Ha.connect(B.Z),B.Z.connect(B.J.destination)}).catch(function(se){console.log("Failed to get user media: "+se)}),d==window.h.I.Ea&&B.Z.connect(B.J.destination),B.pb=I,window.h.rc(B)},539865:d=>window.h.va(d).J.sampleRate,539938:d=>{d=window.h.va(d),d.Z!==void 0&&(d.Z.onaudioprocess=function(){},d.Z.disconnect(),d.Z=void 0),d.Ha!==void 0&&(d.Ha.disconnect(),d.Ha=void 0),d.J.close(),d.J=void 0,d.pb=void 0},540338:d=>{window.h.Bb(d)},540388:d=>{d=window.h.va(d),d.J.resume(),d.state=window.h.ja.xb},540527:d=>{d=window.h.va(d),d.J.suspend(),d.state=window.h.ja.stopped}},_=d=>{for(;0<d.length;)d.shift()(T)},y=(d,p)=>{for(var g=0,k=d.length-1;0<=k;k--){var E=d[k];E==="."?d.splice(k,1):E===".."?(d.splice(k,1),g++):g&&(d.splice(k,1),g--)}if(p)for(;g;g--)d.unshift("..");return d},S=d=>{var p=d.charAt(0)==="/",g=d.substr(-1)==="/";return(d=y(d.split("/").filter(k=>!!k),!p).join("/"))||p||(d="."),d&&g&&(d+="/"),(p?"/":"")+d},O=d=>{var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(d).slice(1);return d=p[0],p=p[1],!d&&!p?".":(p&&(p=p.substr(0,p.length-1)),d+p)},Q=d=>{if(d==="/")return"/";d=S(d),d=d.replace(/\/$/,"");var p=d.lastIndexOf("/");return p===-1?d:d.substr(p+1)},de=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return d=>crypto.getRandomValues(d);bn("initRandomDevice")},be=d=>(be=de())(d);function Ke(){for(var d="",p=!1,g=arguments.length-1;-1<=g&&!p;g--){if(p=0<=g?arguments[g]:"/",typeof p!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!p)return"";d=p+"/"+d,p=p.charAt(0)==="/"}return d=y(d.split("/").filter(k=>!!k),!p).join("/"),(p?"/":"")+d||"."}var it=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Le=(d,p,g)=>{var k=p+g;for(g=p;d[g]&&!(g>=k);)++g;if(16<g-p&&d.buffer&&it)return it.decode(d.subarray(p,g));for(k="";p<g;){var E=d[p++];if(E&128){var I=d[p++]&63;if((E&224)==192)k+=String.fromCharCode((E&31)<<6|I);else{var B=d[p++]&63;E=(E&240)==224?(E&15)<<12|I<<6|B:(E&7)<<18|I<<12|B<<6|d[p++]&63,65536>E?k+=String.fromCharCode(E):(E-=65536,k+=String.fromCharCode(55296|E>>10,56320|E&1023))}}else k+=String.fromCharCode(E)}return k},st=[],Tt=d=>{for(var p=0,g=0;g<d.length;++g){var k=d.charCodeAt(g);127>=k?p++:2047>=k?p+=2:55296<=k&&57343>=k?(p+=4,++g):p+=3}return p},$t=(d,p,g,k)=>{if(!(0<k))return 0;var E=g;k=g+k-1;for(var I=0;I<d.length;++I){var B=d.charCodeAt(I);if(55296<=B&&57343>=B){var G=d.charCodeAt(++I);B=65536+((B&1023)<<10)|G&1023}if(127>=B){if(g>=k)break;p[g++]=B}else{if(2047>=B){if(g+1>=k)break;p[g++]=192|B>>6}else{if(65535>=B){if(g+2>=k)break;p[g++]=224|B>>12}else{if(g+3>=k)break;p[g++]=240|B>>18,p[g++]=128|B>>12&63}p[g++]=128|B>>6&63}p[g++]=128|B&63}}return p[g]=0,g-E};function xt(d,p){var g=Array(Tt(d)+1);return d=$t(d,g,0,g.length),p&&(g.length=d),g}var Bn=[];function _n(d,p){Bn[d]={input:[],G:[],V:p},qo(d,wn)}var wn={open:function(d){var p=Bn[d.node.Fa];if(!p)throw new Ne(43);d.s=p,d.seekable=!1},close:function(d){d.s.V.ua(d.s)},ua:function(d){d.s.V.ua(d.s)},read:function(d,p,g,k){if(!d.s||!d.s.V.jb)throw new Ne(60);for(var E=0,I=0;I<k;I++){try{var B=d.s.V.jb(d.s)}catch{throw new Ne(29)}if(B===void 0&&E===0)throw new Ne(6);if(B==null)break;E++,p[g+I]=B}return E&&(d.node.timestamp=Date.now()),E},write:function(d,p,g,k){if(!d.s||!d.s.V.Ua)throw new Ne(60);try{for(var E=0;E<k;E++)d.s.V.Ua(d.s,p[g+E])}catch{throw new Ne(29)}return k&&(d.node.timestamp=Date.now()),E}},en={jb:function(){e:{if(!st.length){var d=null;if(typeof window<"u"&&typeof window.prompt=="function"?(d=window.prompt("Input: "),d!==null&&(d+=`
`)):typeof readline=="function"&&(d=readline(),d!==null&&(d+=`
`)),!d){d=null;break e}st=xt(d,!0)}d=st.shift()}return d},Ua:function(d,p){p===null||p===10?(Y(Le(d.G,0)),d.G=[]):p!=0&&d.G.push(p)},ua:function(d){d.G&&0<d.G.length&&(Y(Le(d.G,0)),d.G=[])},$b:function(){return{xc:25856,zc:5,wc:191,yc:35387,vc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ac:function(){return 0},bc:function(){return[24,80]}},rn={Ua:function(d,p){p===null||p===10?(he(Le(d.G,0)),d.G=[]):p!=0&&d.G.push(p)},ua:function(d){d.G&&0<d.G.length&&(he(Le(d.G,0)),d.G=[])}};function xr(d,p){var g=d.j?d.j.length:0;g>=p||(p=Math.max(p,g*(1048576>g?2:1.125)>>>0),g!=0&&(p=Math.max(p,256)),g=d.j,d.j=new Uint8Array(p),0<d.v&&d.j.set(g.subarray(0,d.v),0))}var Xe={O:null,U(){return Xe.createNode(null,"/",16895,0)},createNode(d,p,g,k){if((g&61440)===24576||(g&61440)===4096)throw new Ne(63);return Xe.O||(Xe.O={dir:{node:{Y:Xe.l.Y,P:Xe.l.P,ma:Xe.l.ma,Ca:Xe.l.Ca,vb:Xe.l.vb,Ab:Xe.l.Ab,wb:Xe.l.wb,tb:Xe.l.tb,Ia:Xe.l.Ia},stream:{ba:Xe.m.ba}},file:{node:{Y:Xe.l.Y,P:Xe.l.P},stream:{ba:Xe.m.ba,read:Xe.m.read,write:Xe.m.write,ta:Xe.m.ta,lb:Xe.m.lb,nb:Xe.m.nb}},link:{node:{Y:Xe.l.Y,P:Xe.l.P,na:Xe.l.na},stream:{}},bb:{node:{Y:Xe.l.Y,P:Xe.l.P},stream:Rc}}),g=xc(d,p,g,k),(g.mode&61440)===16384?(g.l=Xe.O.dir.node,g.m=Xe.O.dir.stream,g.j={}):(g.mode&61440)===32768?(g.l=Xe.O.file.node,g.m=Xe.O.file.stream,g.v=0,g.j=null):(g.mode&61440)===40960?(g.l=Xe.O.link.node,g.m=Xe.O.link.stream):(g.mode&61440)===8192&&(g.l=Xe.O.bb.node,g.m=Xe.O.bb.stream),g.timestamp=Date.now(),d&&(d.j[p]=g,d.timestamp=g.timestamp),g},Ec(d){return d.j?d.j.subarray?d.j.subarray(0,d.v):new Uint8Array(d.j):new Uint8Array(0)},l:{Y(d){var p={};return p.Cc=(d.mode&61440)===8192?d.id:1,p.Gc=d.id,p.mode=d.mode,p.Lc=1,p.uid=0,p.Fc=0,p.Fa=d.Fa,(d.mode&61440)===16384?p.size=4096:(d.mode&61440)===32768?p.size=d.v:(d.mode&61440)===40960?p.size=d.link.length:p.size=0,p.tc=new Date(d.timestamp),p.Jc=new Date(d.timestamp),p.Ac=new Date(d.timestamp),p.Ib=4096,p.uc=Math.ceil(p.size/p.Ib),p},P(d,p){if(p.mode!==void 0&&(d.mode=p.mode),p.timestamp!==void 0&&(d.timestamp=p.timestamp),p.size!==void 0&&(p=p.size,d.v!=p))if(p==0)d.j=null,d.v=0;else{var g=d.j;d.j=new Uint8Array(p),g&&d.j.set(g.subarray(0,Math.min(p,d.v))),d.v=p}},ma(){throw Ks[44]},Ca(d,p,g,k){return Xe.createNode(d,p,g,k)},vb(d,p,g){if((d.mode&61440)===16384){try{var k=la(p,g)}catch{}if(k)for(var E in k.j)throw new Ne(55)}delete d.parent.j[d.name],d.parent.timestamp=Date.now(),d.name=g,p.j[g]=d,p.timestamp=d.parent.timestamp,d.parent=p},Ab(d,p){delete d.j[p],d.timestamp=Date.now()},wb(d,p){var g=la(d,p),k;for(k in g.j)throw new Ne(55);delete d.j[p],d.timestamp=Date.now()},tb(d){var p=[".",".."],g;for(g in d.j)d.j.hasOwnProperty(g)&&p.push(g);return p},Ia(d,p,g){return d=Xe.createNode(d,p,41471,0),d.link=g,d},na(d){if((d.mode&61440)!==40960)throw new Ne(28);return d.link}},m:{read(d,p,g,k,E){var I=d.node.j;if(E>=d.node.v)return 0;if(d=Math.min(d.node.v-E,k),8<d&&I.subarray)p.set(I.subarray(E,E+d),g);else for(k=0;k<d;k++)p[g+k]=I[E+k];return d},write(d,p,g,k,E,I){if(p.buffer===Fe.buffer&&(I=!1),!k)return 0;if(d=d.node,d.timestamp=Date.now(),p.subarray&&(!d.j||d.j.subarray)){if(I)return d.j=p.subarray(g,g+k),d.v=k;if(d.v===0&&E===0)return d.j=p.slice(g,g+k),d.v=k;if(E+k<=d.v)return d.j.set(p.subarray(g,g+k),E),k}if(xr(d,E+k),d.j.subarray&&p.subarray)d.j.set(p.subarray(g,g+k),E);else for(I=0;I<k;I++)d.j[E+I]=p[g+I];return d.v=Math.max(d.v,E+k),k},ba(d,p,g){if(g===1?p+=d.position:g===2&&(d.node.mode&61440)===32768&&(p+=d.node.v),0>p)throw new Ne(28);return p},ta(d,p,g){xr(d.node,p+g),d.node.v=Math.max(d.node.v,p+g)},lb(d,p,g,k,E){if((d.node.mode&61440)!==32768)throw new Ne(43);if(d=d.node.j,E&2||d.buffer!==Fe.buffer){if((0<g||g+p<d.length)&&(d.subarray?d=d.subarray(g,g+p):d=Array.prototype.slice.call(d,g,g+p)),g=!0,bn(),p=void 0,!p)throw new Ne(48);Fe.set(d,p)}else g=!1,p=d.byteOffset;return{o:p,M:g}},nb(d,p,g,k){return Xe.m.write(d,p,0,k,g,!1),0}}};function Er(d,p){var g=0;return d&&(g|=365),p&&(g|=146),g}var Vn=null,ht={},Wn=[],Tc=1,qr=null,Wo=!0,Ne=null,Ks={},pr=(d,p={})=>{if(d=Ke(d),!d)return{path:"",node:null};if(p=Object.assign({hb:!0,Wa:0},p),8<p.Wa)throw new Ne(32);d=d.split("/").filter(B=>!!B);for(var g=Vn,k="/",E=0;E<d.length;E++){var I=E===d.length-1;if(I&&p.parent)break;if(g=la(g,d[E]),k=S(k+"/"+d[E]),g.Da&&(!I||I&&p.hb)&&(g=g.Da.root),!I||p.gb){for(I=0;(g.mode&61440)===40960;)if(g=Ft(k),k=Ke(O(k),g),g=pr(k,{Wa:p.Wa+1}).node,40<I++)throw new Ne(32)}}return{path:k,node:g}},qa=d=>{for(var p;;){if(d===d.parent)return d=d.U.mb,p?d[d.length-1]!=="/"?`${d}/${p}`:d+p:d;p=p?`${d.name}/${p}`:d.name,d=d.parent}},$a=(d,p)=>{for(var g=0,k=0;k<p.length;k++)g=(g<<5)-g+p.charCodeAt(k)|0;return(d+g>>>0)%qr.length},la=(d,p)=>{var g;if(g=(g=zo(d,"x"))?g:d.l.ma?0:2)throw new Ne(g,d);for(g=qr[$a(d.id,p)];g;g=g.ec){var k=g.name;if(g.parent.id===d.id&&k===p)return g}return d.l.ma(d,p)},xc=(d,p,g,k)=>(d=new ss(d,p,g,k),p=$a(d.parent.id,d.name),d.ec=qr[p],qr[p]=d),Ec=d=>{var p=["r","w","rw"][d&3];return d&512&&(p+="w"),p},zo=(d,p)=>{if(Wo)return 0;if(!p.includes("r")||d.mode&292){if(p.includes("w")&&!(d.mode&146)||p.includes("x")&&!(d.mode&73))return 2}else return 2;return 0},hi=(d,p)=>{try{return la(d,p),20}catch{}return zo(d,"wx")},Pc=()=>{for(var d=0;4096>=d;d++)if(!Wn[d])return d;throw new Ne(33)},$r=d=>{if(d=Wn[d],!d)throw new Ne(8);return d},_c=(d,p=-1)=>(Rn||(Rn=function(){this.h={}},Rn.prototype={},Object.defineProperties(Rn.prototype,{object:{get(){return this.node},set(g){this.node=g}},flags:{get(){return this.h.flags},set(g){this.h.flags=g}},position:{get(){return this.h.position},set(g){this.h.position=g}}})),d=Object.assign(new Rn,d),p==-1&&(p=Pc()),d.X=p,Wn[p]=d),Rc={open:d=>{d.m=ht[d.node.Fa].m,d.m.open&&d.m.open(d)},ba:()=>{throw new Ne(70)}},qo=(d,p)=>{ht[d]={m:p}},Js=(d,p)=>{var g=p==="/",k=!p;if(g&&Vn)throw new Ne(10);if(!g&&!k){var E=pr(p,{hb:!1});if(p=E.path,E=E.node,E.Da)throw new Ne(10);if((E.mode&61440)!==16384)throw new Ne(54)}p={type:d,Nc:{},mb:p,dc:[]},d=d.U(p),d.U=p,p.root=d,g?Vn=d:E&&(E.Da=p,E.U&&E.U.dc.push(p))},tr=(d,p,g)=>{var k=pr(d,{parent:!0}).node;if(d=Q(d),!d||d==="."||d==="..")throw new Ne(28);var E=hi(k,d);if(E)throw new Ne(E);if(!k.l.Ca)throw new Ne(63);return k.l.Ca(k,d,p,g)},$o=(d,p,g)=>{typeof g>"u"&&(g=p,p=438),tr(d,p|8192,g)},Zs=(d,p)=>{if(!Ke(d))throw new Ne(44);var g=pr(p,{parent:!0}).node;if(!g)throw new Ne(44);p=Q(p);var k=hi(g,p);if(k)throw new Ne(k);if(!g.l.Ia)throw new Ne(63);g.l.Ia(g,p,d)},Ft=d=>{if(d=pr(d).node,!d)throw new Ne(44);if(!d.l.na)throw new Ne(28);return Ke(qa(d.parent),d.l.na(d))},Ho=(d,p,g)=>{if(d==="")throw new Ne(44);if(typeof p=="string"){var k={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[p];if(typeof k>"u")throw Error(`Unknown file open mode: ${p}`);p=k}if(g=p&64?(typeof g>"u"?438:g)&4095|32768:0,typeof d=="object")var E=d;else{d=S(d);try{E=pr(d,{gb:!(p&131072)}).node}catch{}}if(k=!1,p&64)if(E){if(p&128)throw new Ne(20)}else E=tr(d,g,0),k=!0;if(!E)throw new Ne(44);if((E.mode&61440)===8192&&(p&=-513),p&65536&&(E.mode&61440)!==16384)throw new Ne(54);if(!k&&(g=E?(E.mode&61440)===40960?32:(E.mode&61440)===16384&&(Ec(p)!=="r"||p&512)?31:zo(E,Ec(p)):44))throw new Ne(g);if(p&512&&!k){if(g=E,g=typeof g=="string"?pr(g,{gb:!0}).node:g,!g.l.P)throw new Ne(63);if((g.mode&61440)===16384)throw new Ne(31);if((g.mode&61440)!==32768)throw new Ne(28);if(k=zo(g,"w"))throw new Ne(k);g.l.P(g,{size:0,timestamp:Date.now()})}return p&=-131713,E=_c({node:E,path:qa(E),flags:p,seekable:!0,position:0,m:E.m,sc:[],error:!1}),E.m.open&&E.m.open(E),!T.logReadFiles||p&1||(Jo||(Jo={}),d in Jo||(Jo[d]=1)),E},Go=(d,p,g)=>{if(d.X===null)throw new Ne(8);if(!d.seekable||!d.m.ba)throw new Ne(70);if(g!=0&&g!=1&&g!=2)throw new Ne(28);d.position=d.m.ba(d,p,g),d.sc=[]},Qs=()=>{Ne||(Ne=function(d,p){this.name="ErrnoError",this.node=p,this.ic=function(g){this.aa=g},this.ic(d),this.message="FS error"},Ne.prototype=Error(),Ne.prototype.constructor=Ne,[44].forEach(d=>{Ks[d]=new Ne(d),Ks[d].stack="<generic error, no stack>"}))},Ha,Ga=(d,p,g)=>{d=S("/dev/"+d);var k=Er(!!p,!!g);Ko||(Ko=64);var E=Ko++<<8|0;qo(E,{open:I=>{I.seekable=!1},close:()=>{g&&g.buffer&&g.buffer.length&&g(10)},read:(I,B,G,se)=>{for(var ee=0,Te=0;Te<se;Te++){try{var _e=p()}catch{throw new Ne(29)}if(_e===void 0&&ee===0)throw new Ne(6);if(_e==null)break;ee++,B[G+Te]=_e}return ee&&(I.node.timestamp=Date.now()),ee},write:(I,B,G,se)=>{for(var ee=0;ee<se;ee++)try{g(B[G+ee])}catch{throw new Ne(29)}return se&&(I.node.timestamp=Date.now()),ee}}),$o(d,k,E)},Ko,Pr={},Rn,Jo,kn=void 0;function Hr(){return kn+=4,M[kn-4>>2]}function Ic(d){if(d===void 0)return"_unknown";d=d.replace(/[^a-zA-Z0-9_]/g,"$");var p=d.charCodeAt(0);return 48<=p&&57>=p?`_${d}`:d}function Zo(d,p){return d=Ic(d),{[d]:function(){return p.apply(this,arguments)}}[d]}function Ka(){this.M=[void 0],this.ib=[]}var Cn=new Ka,_r=void 0;function nt(d){throw new _r(d)}var fr=d=>(d||nt("Cannot use deleted val. handle = "+d),Cn.get(d).value),Rr=d=>{switch(d){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Cn.ta({ub:1,value:d})}};function Qo(d){var p=Error,g=Zo(d,function(k){this.name=d,this.message=k,k=Error(k).stack,k!==void 0&&(this.stack=this.toString()+`
`+k.replace(/^Error(:[^\n]*)?\n/,""))});return g.prototype=Object.create(p.prototype),g.prototype.constructor=g,g.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},g}var Ys=void 0,Yo=void 0;function Et(d){for(var p="";z[d];)p+=Yo[z[d++]];return p}var Ja=[];function Za(){for(;Ja.length;){var d=Ja.pop();d.g.ia=!1,d.delete()}}var gt=void 0,Ir={};function Xo(d,p){for(p===void 0&&nt("ptr should not be undefined");d.A;)p=d.pa(p),d=d.A;return p}var Gr={};function Xs(d){d=gl(d);var p=Et(d);return Qr(d),p}function ca(d,p){var g=Gr[d];return g===void 0&&nt(p+" has unknown type "+Xs(d)),g}function Qa(){}var Ya=!1;function Xa(d){--d.count.value,d.count.value===0&&(d.H?d.L.W(d.H):d.u.i.W(d.o))}function Kr(d,p,g){return p===g?d:g.A===void 0?null:(d=Kr(d,p,g.A),d===null?null:g.Mb(d))}var Jr={};function pi(d,p){return p=Xo(d,p),Ir[p]}var ua=void 0;function fi(d){throw new ua(d)}function mr(d,p){return p.u&&p.o||fi("makeClassHandle requires ptr and ptrType"),!!p.L!=!!p.H&&fi("Both smartPtrType and smartPtr must be specified"),p.count={value:1},da(Object.create(d,{g:{value:p}}))}function da(d){return typeof FinalizationRegistry>"u"?(da=p=>p,d):(Ya=new FinalizationRegistry(p=>{Xa(p.g)}),da=p=>{var g=p.g;return g.H&&Ya.register(p,{g},p),p},Qa=p=>{Ya.unregister(p)},da(d))}var eo={};function Zr(d){for(;d.length;){var p=d.pop();d.pop()(p)}}function to(d){return this.fromWireType(M[d>>2])}var Di={},Ui={};function In(d,p,g){function k(G){G=g(G),G.length!==d.length&&fi("Mismatched type converter count");for(var se=0;se<d.length;++se)On(d[se],G[se])}d.forEach(function(G){Ui[G]=p});var E=Array(p.length),I=[],B=0;p.forEach((G,se)=>{Gr.hasOwnProperty(G)?E[se]=Gr[G]:(I.push(G),Di.hasOwnProperty(G)||(Di[G]=[]),Di[G].push(()=>{E[se]=Gr[G],++B,B===I.length&&k(E)}))}),I.length===0&&k(E)}function es(d){switch(d){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${d}`)}}function no(d,p,g={}){var k=p.name;if(d||nt(`type "${k}" must have a positive integer typeid pointer`),Gr.hasOwnProperty(d)){if(g.Xb)return;nt(`Cannot register type '${k}' twice`)}Gr[d]=p,delete Ui[d],Di.hasOwnProperty(d)&&(p=Di[d],delete Di[d],p.forEach(E=>E()))}function On(d,p,g={}){if(!("argPackAdvance"in p))throw new TypeError("registerType registeredInstance requires argPackAdvance");no(d,p,g)}function mi(d){nt(d.g.u.i.name+" instance already deleted")}function gr(){}function el(d,p,g){if(d[p].B===void 0){var k=d[p];d[p]=function(){return d[p].B.hasOwnProperty(arguments.length)||nt(`Function '${g}' called with an invalid number of arguments (${arguments.length}) - expects one of (${d[p].B})!`),d[p].B[arguments.length].apply(this,arguments)},d[p].B=[],d[p].B[k.ha]=k}}function tl(d,p,g){T.hasOwnProperty(d)?((g===void 0||T[d].B!==void 0&&T[d].B[g]!==void 0)&&nt(`Cannot register public name '${d}' twice`),el(T,d,d),T.hasOwnProperty(g)&&nt(`Cannot register multiple overloads of a function with the same number of arguments (${g})!`),T[d].B[g]=p):(T[d]=p,g!==void 0&&(T[d].Mc=g))}function nl(d,p,g,k,E,I,B,G){this.name=d,this.constructor=p,this.N=g,this.W=k,this.A=E,this.Rb=I,this.pa=B,this.Mb=G,this.qb=[]}function Fi(d,p,g){for(;p!==g;)p.pa||nt(`Expected null or instance of ${g.name}, got an instance of ${p.name}`),d=p.pa(d),p=p.A;return d}function rl(d,p){return p===null?(this.Ta&&nt(`null is not a valid ${this.name}`),0):(p.g||nt(`Cannot pass "${Bi(p)}" as a ${this.name}`),p.g.o||nt(`Cannot pass deleted object as a pointer of type ${this.name}`),Fi(p.g.o,p.g.u.i,this.i))}function Oc(d,p){if(p===null){if(this.Ta&&nt(`null is not a valid ${this.name}`),this.ya){var g=this.Va();return d!==null&&d.push(this.W,g),g}return 0}if(p.g||nt(`Cannot pass "${Bi(p)}" as a ${this.name}`),p.g.o||nt(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.xa&&p.g.u.xa&&nt(`Cannot convert argument of type ${p.g.L?p.g.L.name:p.g.u.name} to parameter type ${this.name}`),g=Fi(p.g.o,p.g.u.i,this.i),this.ya)switch(p.g.H===void 0&&nt("Passing raw pointer to smart pointer is illegal"),this.mc){case 0:p.g.L===this?g=p.g.H:nt(`Cannot convert argument of type ${p.g.L?p.g.L.name:p.g.u.name} to parameter type ${this.name}`);break;case 1:g=p.g.H;break;case 2:if(p.g.L===this)g=p.g.H;else{var k=p.clone();g=this.hc(g,Rr(function(){k.delete()})),d!==null&&d.push(this.W,g)}break;default:nt("Unsupporting sharing policy")}return g}function gi(d,p){return p===null?(this.Ta&&nt(`null is not a valid ${this.name}`),0):(p.g||nt(`Cannot pass "${Bi(p)}" as a ${this.name}`),p.g.o||nt(`Cannot pass deleted object as a pointer of type ${this.name}`),p.g.u.xa&&nt(`Cannot convert argument of type ${p.g.u.name} to parameter type ${this.name}`),Fi(p.g.o,p.g.u.i,this.i))}function vr(d,p,g,k){this.name=d,this.i=p,this.Ta=g,this.xa=k,this.ya=!1,this.W=this.hc=this.Va=this.sb=this.mc=this.fc=void 0,p.A!==void 0?this.toWireType=Oc:(this.toWireType=k?rl:gi,this.K=null)}function ro(d,p,g){T.hasOwnProperty(d)||fi("Replacing nonexistant public symbol"),T[d].B!==void 0&&g!==void 0?T[d].B[g]=p:(T[d]=p,T[d].ha=g)}var io=[],ao=d=>{var p=io[d];return p||(d>=io.length&&(io.length=d+1),io[d]=p=Oe.get(d)),p},ts=(d,p)=>{var g=[];return function(){if(g.length=0,Object.assign(g,arguments),d.includes("j")){var k=T["dynCall_"+d];k=g&&g.length?k.apply(null,[p].concat(g)):k.call(null,p)}else k=ao(p).apply(null,g);return k}};function an(d,p){d=Et(d);var g=d.includes("j")?ts(d,p):ao(p);return typeof g!="function"&&nt(`unknown function pointer with signature ${d}: ${p}`),g}var An=void 0;function Mn(d,p){function g(I){E[I]||Gr[I]||(Ui[I]?Ui[I].forEach(g):(k.push(I),E[I]=!0))}var k=[],E={};throw p.forEach(g),new An(`${d}: `+k.map(Xs).join([", "]))}function ha(d,p,g,k,E){var I=p.length;2>I&&nt("argTypes array size mismatch! Must at least get return value and 'this' types!");var B=p[1]!==null&&g!==null,G=!1;for(g=1;g<p.length;++g)if(p[g]!==null&&p[g].K===void 0){G=!0;break}var se=p[0].name!=="void",ee=I-2,Te=Array(ee),_e=[],De=[];return function(){if(arguments.length!==ee&&nt(`function ${d} called with ${arguments.length} arguments, expected ${ee} args!`),De.length=0,_e.length=B?2:1,_e[0]=E,B){var ne=p[1].toWireType(De,this);_e[1]=ne}for(var fe=0;fe<ee;++fe)Te[fe]=p[fe+2].toWireType(De,arguments[fe]),_e.push(Te[fe]);if(fe=k.apply(null,_e),G)Zr(De);else for(var Pe=B?1:2;Pe<p.length;Pe++){var He=Pe===1?ne:Te[Pe-2];p[Pe].K!==null&&p[Pe].K(He)}return ne=se?p[0].fromWireType(fe):void 0,ne}}function vi(d,p){for(var g=[],k=0;k<d;k++)g.push(ae[p+4*k>>2]);return g}function Ac(d,p,g){return d instanceof Object||nt(`${g} with invalid "this": ${d}`),d instanceof p.i.constructor||nt(`${g} incompatible with "this" of type ${d.constructor.name}`),d.g.o||nt(`cannot call emscripten binding method ${g} on deleted object`),Fi(d.g.o,d.g.u.i,p.i)}function oo(d){d>=Cn.h&&--Cn.get(d).ub===0&&Cn.Wb(d)}function il(d,p,g){switch(p){case 0:return function(k){return this.fromWireType((g?Fe:z)[k])};case 1:return function(k){return this.fromWireType((g?ce:ue)[k>>1])};case 2:return function(k){return this.fromWireType((g?M:ae)[k>>2])};default:throw new TypeError("Unknown integer type: "+d)}}function Bi(d){if(d===null)return"null";var p=typeof d;return p==="object"||p==="array"||p==="function"?d.toString():""+d}function ns(d,p){switch(p){case 2:return function(g){return this.fromWireType(Ve[g>>2])};case 3:return function(g){return this.fromWireType(ke[g>>3])};default:throw new TypeError("Unknown float type: "+d)}}function Mc(d,p,g){switch(p){case 0:return g?function(k){return Fe[k]}:function(k){return z[k]};case 1:return g?function(k){return ce[k>>1]}:function(k){return ue[k>>1]};case 2:return g?function(k){return M[k>>2]}:function(k){return ae[k>>2]};default:throw new TypeError("Unknown integer type: "+d)}}var Lc=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Fd=(d,p)=>{for(var g=d>>1,k=g+p/2;!(g>=k)&&ue[g];)++g;if(g<<=1,32<g-d&&Lc)return Lc.decode(z.subarray(d,g));for(g="",k=0;!(k>=p/2);++k){var E=ce[d+2*k>>1];if(E==0)break;g+=String.fromCharCode(E)}return g},Bd=(d,p,g)=>{if(g===void 0&&(g=2147483647),2>g)return 0;g-=2;var k=p;g=g<2*d.length?g/2:d.length;for(var E=0;E<g;++E)ce[p>>1]=d.charCodeAt(E),p+=2;return ce[p>>1]=0,p-k},al=d=>2*d.length,Vd=(d,p)=>{for(var g=0,k="";!(g>=p/4);){var E=M[d+4*g>>2];if(E==0)break;++g,65536<=E?(E-=65536,k+=String.fromCharCode(55296|E>>10,56320|E&1023)):k+=String.fromCharCode(E)}return k},Wd=(d,p,g)=>{if(g===void 0&&(g=2147483647),4>g)return 0;var k=p;g=k+g-4;for(var E=0;E<d.length;++E){var I=d.charCodeAt(E);if(55296<=I&&57343>=I){var B=d.charCodeAt(++E);I=65536+((I&1023)<<10)|B&1023}if(M[p>>2]=I,p+=4,p+4>g)break}return M[p>>2]=0,p-k},zd=d=>{for(var p=0,g=0;g<d.length;++g){var k=d.charCodeAt(g);55296<=k&&57343>=k&&++g,p+=4}return p},qd={};function ol(d){var p=qd[d];return p===void 0?Et(d):p}var so=[];function $d(d){var p=so.length;return so.push(d),p}function Hd(d,p){for(var g=Array(d),k=0;k<d;++k)g[k]=ca(ae[p+4*k>>2],"parameter "+k);return g}var Nc=[],sl=[];function rs(d){d.Dc=d.getExtension("WEBGL_draw_instanced_base_vertex_base_instance")}function jc(d){d.Ic=d.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance")}var Dc=1,lo=[],nr=[],is=[],co=[],pa=[],Or=[],as=[],Zt=[],Uc={};function Qt(d){uo||(uo=d)}function bi(d){for(var p=Dc++,g=d.length;g<p;g++)d[g]=null;return p}function Gd(d,p){var g=bi(Zt),k={handle:g,attributes:p,version:p.Hc,C:d};return d.canvas&&(d.canvas.Cb=k),Zt[g]=k,(typeof p.Nb>"u"||p.Nb)&&Fc(k),g}function os(d){return br=Zt[d],T.Bc=pe=br&&br.C,!(d&&!pe)}function Fc(d){if(d||(d=br),!d.Yb){d.Yb=!0;var p=d.C;rs(p),jc(p),2<=d.version&&(p.eb=p.getExtension("EXT_disjoint_timer_query_webgl2")),(2>d.version||!p.eb)&&(p.eb=p.getExtension("EXT_disjoint_timer_query")),ll(p),(p.getSupportedExtensions()||[]).forEach(function(g){g.includes("lose_context")||g.includes("debug")||p.getExtension(g)})}}var uo,br;function ll(d){d.Kc=d.getExtension("WEBGL_multi_draw")}var yi={},Bc=()=>{if(!cl){var d={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:U||"./this.program"},p;for(p in yi)yi[p]===void 0?delete d[p]:d[p]=yi[p];var g=[];for(p in d)g.push(`${p}=${d[p]}`);cl=g}return cl},cl,ul=[];function fa(d,p,g,k){for(var E=0;E<d;E++){var I=pe[g](),B=I&&bi(k);I?(I.name=B,k[B]=I):Qt(1282),M[p+4*E>>2]=B}}function Vc(d,p){if(p){var g=void 0;switch(d){case 36346:g=1;break;case 36344:return;case 34814:case 36345:g=0;break;case 34466:var k=pe.getParameter(34467);g=k?k.length:0;break;case 33309:if(2>br.version){Qt(1282);return}g=2*(pe.getSupportedExtensions()||[]).length;break;case 33307:case 33308:if(2>br.version){Qt(1280);return}g=d==33307?3:0}if(g===void 0)switch(k=pe.getParameter(d),typeof k){case"number":g=k;break;case"boolean":g=k?1:0;break;case"string":Qt(1280);return;case"object":if(k===null)switch(d){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:g=0;break;default:Qt(1280);return}else{if(k instanceof Float32Array||k instanceof Uint32Array||k instanceof Int32Array||k instanceof Array){for(d=0;d<k.length;++d)M[p+4*d>>2]=k[d];return}try{g=k.name|0}catch(E){Qt(1280),he("GL_INVALID_ENUM in glGet0v: Unknown object returned from WebGL getParameter("+d+")! (error: "+E+")");return}}break;default:Qt(1280),he("GL_INVALID_ENUM in glGet0v: Native code calling glGet0v("+d+") and it returns "+k+" of type "+typeof k+"!");return}M[p>>2]=g}else Qt(1281)}var wi=d=>{var p=Tt(d)+1,g=ls(p);return g&&$t(d,z,g,p),g};function ma(d){return d.slice(-1)=="]"&&d.lastIndexOf("[")}function Wc(d){return d-=5120,d==0?Fe:d==1?z:d==2?ce:d==4?M:d==6?Ve:d==5||d==28922||d==28520||d==30779||d==30782?ae:ue}var Vi=d=>d%4===0&&(d%100!==0||d%400===0),zc=[31,29,31,30,31,30,31,31,30,31,30,31],dl=[31,28,31,30,31,30,31,31,30,31,30,31],hl=(d,p,g,k)=>{function E(ne,fe,Pe){for(ne=typeof ne=="number"?ne.toString():ne||"";ne.length<fe;)ne=Pe[0]+ne;return ne}function I(ne,fe){return E(ne,fe,"0")}function B(ne,fe){function Pe(Je){return 0>Je?-1:0<Je?1:0}var He;return(He=Pe(ne.getFullYear()-fe.getFullYear()))===0&&(He=Pe(ne.getMonth()-fe.getMonth()))===0&&(He=Pe(ne.getDate()-fe.getDate())),He}function G(ne){switch(ne.getDay()){case 0:return new Date(ne.getFullYear()-1,11,29);case 1:return ne;case 2:return new Date(ne.getFullYear(),0,3);case 3:return new Date(ne.getFullYear(),0,2);case 4:return new Date(ne.getFullYear(),0,1);case 5:return new Date(ne.getFullYear()-1,11,31);case 6:return new Date(ne.getFullYear()-1,11,30)}}function se(ne){var fe=ne.da;for(ne=new Date(new Date(ne.ea+1900,0,1).getTime());0<fe;){var Pe=ne.getMonth(),He=(Vi(ne.getFullYear())?zc:dl)[Pe];if(fe>He-ne.getDate())fe-=He-ne.getDate()+1,ne.setDate(1),11>Pe?ne.setMonth(Pe+1):(ne.setMonth(0),ne.setFullYear(ne.getFullYear()+1));else{ne.setDate(ne.getDate()+fe);break}}return Pe=new Date(ne.getFullYear()+1,0,4),fe=G(new Date(ne.getFullYear(),0,4)),Pe=G(Pe),0>=B(fe,ne)?0>=B(Pe,ne)?ne.getFullYear()+1:ne.getFullYear():ne.getFullYear()-1}var ee=M[k+40>>2];k={pc:M[k>>2],oc:M[k+4>>2],Ja:M[k+8>>2],Xa:M[k+12>>2],Ka:M[k+16>>2],ea:M[k+20>>2],R:M[k+24>>2],da:M[k+28>>2],Pc:M[k+32>>2],nc:M[k+36>>2],qc:ee&&ee?Le(z,ee):""},g=g?Le(z,g):"",ee={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var Te in ee)g=g.replace(new RegExp(Te,"g"),ee[Te]);var _e="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),De="January February March April May June July August September October November December".split(" ");ee={"%a":ne=>_e[ne.R].substring(0,3),"%A":ne=>_e[ne.R],"%b":ne=>De[ne.Ka].substring(0,3),"%B":ne=>De[ne.Ka],"%C":ne=>I((ne.ea+1900)/100|0,2),"%d":ne=>I(ne.Xa,2),"%e":ne=>E(ne.Xa,2," "),"%g":ne=>se(ne).toString().substring(2),"%G":ne=>se(ne),"%H":ne=>I(ne.Ja,2),"%I":ne=>(ne=ne.Ja,ne==0?ne=12:12<ne&&(ne-=12),I(ne,2)),"%j":ne=>{for(var fe=0,Pe=0;Pe<=ne.Ka-1;fe+=(Vi(ne.ea+1900)?zc:dl)[Pe++]);return I(ne.Xa+fe,3)},"%m":ne=>I(ne.Ka+1,2),"%M":ne=>I(ne.oc,2),"%n":()=>`
`,"%p":ne=>0<=ne.Ja&&12>ne.Ja?"AM":"PM","%S":ne=>I(ne.pc,2),"%t":()=>"	","%u":ne=>ne.R||7,"%U":ne=>I(Math.floor((ne.da+7-ne.R)/7),2),"%V":ne=>{var fe=Math.floor((ne.da+7-(ne.R+6)%7)/7);if(2>=(ne.R+371-ne.da-2)%7&&fe++,fe)fe==53&&(Pe=(ne.R+371-ne.da)%7,Pe==4||Pe==3&&Vi(ne.ea)||(fe=1));else{fe=52;var Pe=(ne.R+7-ne.da-1)%7;(Pe==4||Pe==5&&Vi(ne.ea%400-1))&&fe++}return I(fe,2)},"%w":ne=>ne.R,"%W":ne=>I(Math.floor((ne.da+7-(ne.R+6)%7)/7),2),"%y":ne=>(ne.ea+1900).toString().substring(2),"%Y":ne=>ne.ea+1900,"%z":ne=>{ne=ne.nc;var fe=0<=ne;return ne=Math.abs(ne)/60,(fe?"+":"-")+("0000"+(ne/60*100+ne%60)).slice(-4)},"%Z":ne=>ne.qc,"%%":()=>"%"},g=g.replace(/%%/g,"\0\0");for(Te in ee)g.includes(Te)&&(g=g.replace(new RegExp(Te,"g"),ee[Te](k)));return g=g.replace(/\0\0/g,"%"),Te=xt(g,!1),Te.length>p?0:(Fe.set(Te,d),Te.length-1)};function ss(d,p,g,k){d||(d=this),this.parent=d,this.U=d.U,this.Da=null,this.id=Tc++,this.name=p,this.mode=g,this.l={},this.m={},this.Fa=k}Object.defineProperties(ss.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(d){d?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(d){d?this.mode|=146:this.mode&=-147}}}),Qs(),qr=Array(4096),Js(Xe,"/"),tr("/tmp",16895,0),tr("/home",16895,0),tr("/home/web_user",16895,0),(()=>{tr("/dev",16895,0),qo(259,{read:()=>0,write:(k,E,I,B)=>B}),$o("/dev/null",259),_n(1280,en),_n(1536,rn),$o("/dev/tty",1280),$o("/dev/tty1",1536);var d=new Uint8Array(1024),p=0,g=()=>(p===0&&(p=be(d).byteLength),d[--p]);Ga("random",g),Ga("urandom",g),tr("/dev/shm",16895,0),tr("/dev/shm/tmp",16895,0)})(),(()=>{tr("/proc",16895,0);var d=tr("/proc/self",16895,0);tr("/proc/self/fd",16895,0),Js({U:()=>{var p=xc(d,"fd",16895,73);return p.l={ma:(g,k)=>{var E=$r(+k);return g={parent:null,U:{mb:"fake"},l:{na:()=>E.path}},g.parent=g}},p}},"/proc/self/fd")})(),Object.assign(Ka.prototype,{get(d){return this.M[d]},has(d){return this.M[d]!==void 0},ta(d){var p=this.ib.pop()||this.M.length;return this.M[p]=d,p},Wb(d){this.M[d]=void 0,this.ib.push(d)}}),_r=T.BindingError=class extends Error{constructor(d){super(d),this.name="BindingError"}},Cn.M.push({value:void 0},{value:null},{value:!0},{value:!1}),Cn.h=Cn.M.length,T.count_emval_handles=function(){for(var d=0,p=Cn.h;p<Cn.M.length;++p)Cn.M[p]!==void 0&&++d;return d},Ys=T.PureVirtualError=Qo("PureVirtualError");for(var pl=Array(256),ho=0;256>ho;++ho)pl[ho]=String.fromCharCode(ho);Yo=pl,T.getInheritedInstanceCount=function(){return Object.keys(Ir).length},T.getLiveInheritedInstances=function(){var d=[],p;for(p in Ir)Ir.hasOwnProperty(p)&&d.push(Ir[p]);return d},T.flushPendingDeletes=Za,T.setDelayFunction=function(d){gt=d,Ja.length&&gt&&gt(Za)},ua=T.InternalError=class extends Error{constructor(d){super(d),this.name="InternalError"}},gr.prototype.isAliasOf=function(d){if(!(this instanceof gr&&d instanceof gr))return!1;var p=this.g.u.i,g=this.g.o,k=d.g.u.i;for(d=d.g.o;p.A;)g=p.pa(g),p=p.A;for(;k.A;)d=k.pa(d),k=k.A;return p===k&&g===d},gr.prototype.clone=function(){if(this.g.o||mi(this),this.g.ka)return this.g.count.value+=1,this;var d=da,p=Object,g=p.create,k=Object.getPrototypeOf(this),E=this.g;return d=d(g.call(p,k,{g:{value:{count:E.count,ia:E.ia,ka:E.ka,o:E.o,u:E.u,H:E.H,L:E.L}}})),d.g.count.value+=1,d.g.ia=!1,d},gr.prototype.delete=function(){this.g.o||mi(this),this.g.ia&&!this.g.ka&&nt("Object already scheduled for deletion"),Qa(this),Xa(this.g),this.g.ka||(this.g.H=void 0,this.g.o=void 0)},gr.prototype.isDeleted=function(){return!this.g.o},gr.prototype.deleteLater=function(){return this.g.o||mi(this),this.g.ia&&!this.g.ka&&nt("Object already scheduled for deletion"),Ja.push(this),Ja.length===1&&gt&&gt(Za),this.g.ia=!0,this},vr.prototype.Sb=function(d){return this.sb&&(d=this.sb(d)),d},vr.prototype.cb=function(d){this.W&&this.W(d)},vr.prototype.argPackAdvance=8,vr.prototype.readValueFromPointer=to,vr.prototype.deleteObject=function(d){d!==null&&d.delete()},vr.prototype.fromWireType=function(d){function p(){return this.ya?mr(this.i.N,{u:this.fc,o:g,L:this,H:d}):mr(this.i.N,{u:this,o:d})}var g=this.Sb(d);if(!g)return this.cb(d),null;var k=pi(this.i,g);if(k!==void 0)return k.g.count.value===0?(k.g.o=g,k.g.H=d,k.clone()):(k=k.clone(),this.cb(d),k);if(k=this.i.Rb(g),k=Jr[k],!k)return p.call(this);k=this.xa?k.Jb:k.pointerType;var E=Kr(g,this.i,k.i);return E===null?p.call(this):this.ya?mr(k.i.N,{u:k,o:E,L:this,H:d}):mr(k.i.N,{u:k,o:E})},An=T.UnboundTypeError=Qo("UnboundTypeError");for(var pe,fl=0;32>fl;++fl)ul.push(Array(fl));var qc={__syscall_fcntl64:function(d,p,g){kn=g;try{var k=$r(d);switch(p){case 0:var E=Hr();return 0>E?-28:_c(k,E).X;case 1:case 2:return 0;case 3:return k.flags;case 4:return E=Hr(),k.flags|=E,0;case 5:return E=Hr(),ce[E+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return M[$c()>>2]=28,-1;default:return-28}}catch(I){if(typeof Pr>"u"||I.name!=="ErrnoError")throw I;return-I.aa}},__syscall_ioctl:function(d,p,g){kn=g;try{var k=$r(d);switch(p){case 21509:return k.s?0:-59;case 21505:if(!k.s)return-59;if(k.s.V.$b){p=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var E=Hr();M[E>>2]=25856,M[E+4>>2]=5,M[E+8>>2]=191,M[E+12>>2]=35387;for(var I=0;32>I;I++)Fe[E+I+17>>0]=p[I]||0}return 0;case 21510:case 21511:case 21512:return k.s?0:-59;case 21506:case 21507:case 21508:if(!k.s)return-59;if(k.s.V.ac)for(E=Hr(),p=[],I=0;32>I;I++)p.push(Fe[E+I+17>>0]);return 0;case 21519:return k.s?(E=Hr(),M[E>>2]=0):-59;case 21520:return k.s?-28:-59;case 21531:if(E=Hr(),!k.m.Zb)throw new Ne(59);return k.m.Zb(k,p,E);case 21523:return k.s?(k.s.V.bc&&(I=[24,80],E=Hr(),ce[E>>1]=I[0],ce[E+2>>1]=I[1]),0):-59;case 21524:return k.s?0:-59;case 21515:return k.s?0:-59;default:return-28}}catch(B){if(typeof Pr>"u"||B.name!=="ErrnoError")throw B;return-B.aa}},__syscall_openat:function(d,p,g,k){kn=k;try{p=p?Le(z,p):"";var E=p;if(E.charAt(0)==="/")p=E;else{var I=d===-100?"/":$r(d).path;if(E.length==0)throw new Ne(44);p=S(I+"/"+E)}var B=k?Hr():0;return Ho(p,g,B).X}catch(G){if(typeof Pr>"u"||G.name!=="ErrnoError")throw G;return-G.aa}},_embind_create_inheriting_constructor:function(d,p,g){d=Et(d),p=ca(p,"wrapper"),g=fr(g);var k=[].slice,E=p.i,I=E.N,B=E.A.N,G=E.A.constructor;d=Zo(d,function(){E.A.qb.forEach((function(ee){if(this[ee]===B[ee])throw new Ys(`Pure virtual function ${ee} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:I}),this.__construct.apply(this,k.call(arguments))}),I.__construct=function(){this===I&&nt("Pass correct 'this' to __construct");var ee=G.implement.apply(void 0,[this].concat(k.call(arguments)));Qa(ee);var Te=ee.g;ee.notifyOnDestruction(),Te.ka=!0,Object.defineProperties(this,{g:{value:Te}}),da(this),ee=Te.o,ee=Xo(E,ee),Ir.hasOwnProperty(ee)?nt(`Tried to register registered instance: ${ee}`):Ir[ee]=this},I.__destruct=function(){this===I&&nt("Pass correct 'this' to __destruct"),Qa(this);var ee=this.g.o;ee=Xo(E,ee),Ir.hasOwnProperty(ee)?delete Ir[ee]:nt(`Tried to unregister unregistered instance: ${ee}`)},d.prototype=Object.create(I);for(var se in g)d.prototype[se]=g[se];return Rr(d)},_embind_finalize_value_object:function(d){var p=eo[d];delete eo[d];var g=p.Va,k=p.W,E=p.fb,I=E.map(B=>B.Vb).concat(E.map(B=>B.kc));In([d],I,B=>{var G={};return E.forEach((se,ee)=>{var Te=B[ee],_e=se.Tb,De=se.Ub,ne=B[ee+E.length],fe=se.jc,Pe=se.lc;G[se.Pb]={read:He=>Te.fromWireType(_e(De,He)),write:(He,Je)=>{var et=[];fe(Pe,He,ne.toWireType(et,Je)),Zr(et)}}}),[{name:p.name,fromWireType:function(se){var ee={},Te;for(Te in G)ee[Te]=G[Te].read(se);return k(se),ee},toWireType:function(se,ee){for(var Te in G)if(!(Te in ee))throw new TypeError(`Missing field: "${Te}"`);var _e=g();for(Te in G)G[Te].write(_e,ee[Te]);return se!==null&&se.push(k,_e),_e},argPackAdvance:8,readValueFromPointer:to,K:k}]})},_embind_register_bigint:function(){},_embind_register_bool:function(d,p,g,k,E){var I=es(g);p=Et(p),On(d,{name:p,fromWireType:function(B){return!!B},toWireType:function(B,G){return G?k:E},argPackAdvance:8,readValueFromPointer:function(B){if(g===1)var G=Fe;else if(g===2)G=ce;else if(g===4)G=M;else throw new TypeError("Unknown boolean type size: "+p);return this.fromWireType(G[B>>I])},K:null})},_embind_register_class:function(d,p,g,k,E,I,B,G,se,ee,Te,_e,De){Te=Et(Te),I=an(E,I),G&&(G=an(B,G)),ee&&(ee=an(se,ee)),De=an(_e,De);var ne=Ic(Te);tl(ne,function(){Mn(`Cannot construct ${Te} due to unbound types`,[k])}),In([d,p,g],k?[k]:[],function(fe){if(fe=fe[0],k)var Pe=fe.i,He=Pe.N;else He=gr.prototype;fe=Zo(ne,function(){if(Object.getPrototypeOf(this)!==Je)throw new _r("Use 'new' to construct "+Te);if(et.$===void 0)throw new _r(Te+" has no accessible constructor");var It=et.$[arguments.length];if(It===void 0)throw new _r(`Tried to invoke ctor of ${Te} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(et.$).toString()}) parameters instead!`);return It.apply(this,arguments)});var Je=Object.create(He,{constructor:{value:fe}});fe.prototype=Je;var et=new nl(Te,fe,Je,De,Pe,I,G,ee);et.A&&(et.A.qa===void 0&&(et.A.qa=[]),et.A.qa.push(et)),Pe=new vr(Te,et,!0,!1),He=new vr(Te+"*",et,!1,!1);var vt=new vr(Te+" const*",et,!1,!0);return Jr[d]={pointerType:He,Jb:vt},ro(ne,fe),[Pe,He,vt]})},_embind_register_class_class_function:function(d,p,g,k,E,I,B){var G=vi(g,k);p=Et(p),I=an(E,I),In([],[d],function(se){function ee(){Mn(`Cannot call ${Te} due to unbound types`,G)}se=se[0];var Te=`${se.name}.${p}`;p.startsWith("@@")&&(p=Symbol[p.substring(2)]);var _e=se.i.constructor;return _e[p]===void 0?(ee.ha=g-1,_e[p]=ee):(el(_e,p,Te),_e[p].B[g-1]=ee),In([],G,function(De){if(De=ha(Te,[De[0],null].concat(De.slice(1)),null,I,B),_e[p].B===void 0?(De.ha=g-1,_e[p]=De):_e[p].B[g-1]=De,se.i.qa)for(const ne of se.i.qa)ne.constructor.hasOwnProperty(p)||(ne.constructor[p]=De);return[]}),[]})},_embind_register_class_class_property:function(d,p,g,k,E,I,B,G){p=Et(p),I=an(E,I),In([],[d],function(se){se=se[0];var ee=`${se.name}.${p}`,Te={get(){Mn(`Cannot access ${ee} due to unbound types`,[g])},enumerable:!0,configurable:!0};return Te.set=G?()=>{Mn(`Cannot access ${ee} due to unbound types`,[g])}:()=>{nt(`${ee} is a read-only property`)},Object.defineProperty(se.i.constructor,p,Te),In([],[g],function(_e){_e=_e[0];var De={get(){return _e.fromWireType(I(k))},enumerable:!0};return G&&(G=an(B,G),De.set=ne=>{var fe=[];G(k,_e.toWireType(fe,ne)),Zr(fe)}),Object.defineProperty(se.i.constructor,p,De),[]}),[]})},_embind_register_class_constructor:function(d,p,g,k,E,I){var B=vi(p,g);E=an(k,E),In([],[d],function(G){G=G[0];var se=`constructor ${G.name}`;if(G.i.$===void 0&&(G.i.$=[]),G.i.$[p-1]!==void 0)throw new _r(`Cannot register multiple constructors with identical number of parameters (${p-1}) for class '${G.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return G.i.$[p-1]=()=>{Mn(`Cannot construct ${G.name} due to unbound types`,B)},In([],B,function(ee){return ee.splice(1,0,null),G.i.$[p-1]=ha(se,ee,null,E,I),[]}),[]})},_embind_register_class_function:function(d,p,g,k,E,I,B,G){var se=vi(g,k);p=Et(p),I=an(E,I),In([],[d],function(ee){function Te(){Mn(`Cannot call ${_e} due to unbound types`,se)}ee=ee[0];var _e=`${ee.name}.${p}`;p.startsWith("@@")&&(p=Symbol[p.substring(2)]),G&&ee.i.qb.push(p);var De=ee.i.N,ne=De[p];return ne===void 0||ne.B===void 0&&ne.className!==ee.name&&ne.ha===g-2?(Te.ha=g-2,Te.className=ee.name,De[p]=Te):(el(De,p,_e),De[p].B[g-2]=Te),In([],se,function(fe){return fe=ha(_e,fe,ee,I,B),De[p].B===void 0?(fe.ha=g-2,De[p]=fe):De[p].B[g-2]=fe,[]}),[]})},_embind_register_class_property:function(d,p,g,k,E,I,B,G,se,ee){p=Et(p),E=an(k,E),In([],[d],function(Te){Te=Te[0];var _e=`${Te.name}.${p}`,De={get(){Mn(`Cannot access ${_e} due to unbound types`,[g,B])},enumerable:!0,configurable:!0};return De.set=se?()=>{Mn(`Cannot access ${_e} due to unbound types`,[g,B])}:()=>{nt(_e+" is a read-only property")},Object.defineProperty(Te.i.N,p,De),In([],se?[g,B]:[g],function(ne){var fe=ne[0],Pe={get(){var Je=Ac(this,Te,_e+" getter");return fe.fromWireType(E(I,Je))},enumerable:!0};if(se){se=an(G,se);var He=ne[1];Pe.set=function(Je){var et=Ac(this,Te,_e+" setter"),vt=[];se(ee,et,He.toWireType(vt,Je)),Zr(vt)}}return Object.defineProperty(Te.i.N,p,Pe),[]}),[]})},_embind_register_emval:function(d,p){p=Et(p),On(d,{name:p,fromWireType:function(g){var k=fr(g);return oo(g),k},toWireType:function(g,k){return Rr(k)},argPackAdvance:8,readValueFromPointer:to,K:null})},_embind_register_enum:function(d,p,g,k){function E(){}g=es(g),p=Et(p),E.values={},On(d,{name:p,constructor:E,fromWireType:function(I){return this.constructor.values[I]},toWireType:function(I,B){return B.value},argPackAdvance:8,readValueFromPointer:il(p,g,k),K:null}),tl(p,E)},_embind_register_enum_value:function(d,p,g){var k=ca(d,"enum");p=Et(p),d=k.constructor,k=Object.create(k.constructor.prototype,{value:{value:g},constructor:{value:Zo(`${k.name}_${p}`,function(){})}}),d.values[g]=k,d[p]=k},_embind_register_float:function(d,p,g){g=es(g),p=Et(p),On(d,{name:p,fromWireType:function(k){return k},toWireType:function(k,E){return E},argPackAdvance:8,readValueFromPointer:ns(p,g),K:null})},_embind_register_function:function(d,p,g,k,E,I){var B=vi(p,g);d=Et(d),E=an(k,E),tl(d,function(){Mn(`Cannot call ${d} due to unbound types`,B)},p-1),In([],B,function(G){return ro(d,ha(d,[G[0],null].concat(G.slice(1)),null,E,I),p-1),[]})},_embind_register_integer:function(d,p,g,k,E){p=Et(p),E===-1&&(E=4294967295),E=es(g);var I=G=>G;if(k===0){var B=32-8*g;I=G=>G<<B>>>B}g=p.includes("unsigned")?function(G,se){return se>>>0}:function(G,se){return se},On(d,{name:p,fromWireType:I,toWireType:g,argPackAdvance:8,readValueFromPointer:Mc(p,E,k!==0),K:null})},_embind_register_memory_view:function(d,p,g){function k(I){I>>=2;var B=ae;return new E(B.buffer,B[I+1],B[I])}var E=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][p];g=Et(g),On(d,{name:g,fromWireType:k,argPackAdvance:8,readValueFromPointer:k},{Xb:!0})},_embind_register_std_string:function(d,p){p=Et(p);var g=p==="std::string";On(d,{name:p,fromWireType:function(k){var E=ae[k>>2],I=k+4;if(g)for(var B=I,G=0;G<=E;++G){var se=I+G;if(G==E||z[se]==0){if(B=B?Le(z,B,se-B):"",ee===void 0)var ee=B;else ee+="\0",ee+=B;B=se+1}}else{for(ee=Array(E),G=0;G<E;++G)ee[G]=String.fromCharCode(z[I+G]);ee=ee.join("")}return Qr(k),ee},toWireType:function(k,E){E instanceof ArrayBuffer&&(E=new Uint8Array(E));var I=typeof E=="string";I||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int8Array||nt("Cannot pass non-string to std::string");var B=g&&I?Tt(E):E.length,G=ls(4+B+1),se=G+4;if(ae[G>>2]=B,g&&I)$t(E,z,se,B+1);else if(I)for(I=0;I<B;++I){var ee=E.charCodeAt(I);255<ee&&(Qr(se),nt("String has UTF-16 code units that do not fit in 8 bits")),z[se+I]=ee}else for(I=0;I<B;++I)z[se+I]=E[I];return k!==null&&k.push(Qr,G),G},argPackAdvance:8,readValueFromPointer:to,K:function(k){Qr(k)}})},_embind_register_std_wstring:function(d,p,g){if(g=Et(g),p===2)var k=Fd,E=Bd,I=al,B=()=>ue,G=1;else p===4&&(k=Vd,E=Wd,I=zd,B=()=>ae,G=2);On(d,{name:g,fromWireType:function(se){for(var ee=ae[se>>2],Te=B(),_e,De=se+4,ne=0;ne<=ee;++ne){var fe=se+4+ne*p;(ne==ee||Te[fe>>G]==0)&&(De=k(De,fe-De),_e===void 0?_e=De:(_e+="\0",_e+=De),De=fe+p)}return Qr(se),_e},toWireType:function(se,ee){typeof ee!="string"&&nt(`Cannot pass non-string to C++ string type ${g}`);var Te=I(ee),_e=ls(4+Te+p);return ae[_e>>2]=Te>>G,E(ee,_e+4,Te+p),se!==null&&se.push(Qr,_e),_e},argPackAdvance:8,readValueFromPointer:to,K:function(se){Qr(se)}})},_embind_register_value_object:function(d,p,g,k,E,I){eo[d]={name:Et(p),Va:an(g,k),W:an(E,I),fb:[]}},_embind_register_value_object_field:function(d,p,g,k,E,I,B,G,se,ee){eo[d].fb.push({Pb:Et(p),Vb:g,Tb:an(k,E),Ub:I,kc:B,jc:an(G,se),lc:ee})},_embind_register_void:function(d,p){p=Et(p),On(d,{cc:!0,name:p,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(d,p,g){d=fr(d),p=ca(p,"emval::as");var k=[],E=Rr(k);return ae[g>>2]=E,p.toWireType(k,d)},_emval_call_method:function(d,p,g,k,E){d=so[d],p=fr(p),g=ol(g);var I=[];return ae[k>>2]=Rr(I),d(p,g,I,E)},_emval_call_void_method:function(d,p,g,k){d=so[d],p=fr(p),g=ol(g),d(p,g,null,k)},_emval_decref:oo,_emval_get_method_caller:function(d,p){var g=Hd(d,p),k=g[0];p=k.name+"_$"+g.slice(1).map(function(B){return B.name}).join("_")+"$";var E=Nc[p];if(E!==void 0)return E;var I=Array(d-1);return E=$d((B,G,se,ee)=>{for(var Te=0,_e=0;_e<d-1;++_e)I[_e]=g[_e+1].readValueFromPointer(ee+Te),Te+=g[_e+1].argPackAdvance;for(B=B[G].apply(B,I),_e=0;_e<d-1;++_e)g[_e+1].Lb&&g[_e+1].Lb(I[_e]);if(!k.cc)return k.toWireType(se,B)}),Nc[p]=E},_emval_get_property:function(d,p){return d=fr(d),p=fr(p),Rr(d[p])},_emval_incref:function(d){4<d&&(Cn.get(d).ub+=1)},_emval_new_array:function(){return Rr([])},_emval_new_cstring:function(d){return Rr(ol(d))},_emval_new_object:function(){return Rr({})},_emval_run_destructors:function(d){var p=fr(d);Zr(p),oo(d)},_emval_set_property:function(d,p,g){d=fr(d),p=fr(p),g=fr(g),d[p]=g},_emval_take_value:function(d,p){return d=ca(d,"_emval_take_value"),d=d.readValueFromPointer(p),Rr(d)},abort:()=>{bn("")},beginPixelLocalStorageWEBGL:function(d,p,g){(d=Zt[d].C.ca)&&d.beginPixelLocalStorageWEBGL(T.HEAPU32.subarray(g,g+p))},decode_image:function(d,p,g){var k=T.images;k||(k=new Map,T.images=k);var E=new Image;k.set(d,E),p=T.HEAP8.subarray(p,p+g),g=new Uint8Array(g),g.set(p),E.src=URL.createObjectURL(new Blob([g],{type:"image/png"})),E.onload=function(){T._setWebImage(d,E.width,E.height)}},delete_image:function(d){var p=T.images;p&&p.get(d)&&p.delete(d)},emscripten_asm_const_int:(d,p,g)=>{sl.length=0;var k;for(g>>=2;k=z[p++];)g+=k!=105&g,sl.push(k==105?M[g]:ke[g++>>1]),++g;return Vo[d].apply(null,sl)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(d,p,g)=>z.copyWithin(d,p,p+g),emscripten_resize_heap:d=>{var p=z.length;if(d>>>=0,2147483648<d)return!1;for(var g=1;4>=g;g*=2){var k=p*(1+.2/g);k=Math.min(k,d+100663296);var E=Math;k=Math.max(d,k);e:{E=E.min.call(E,2147483648,k+(65536-k%65536)%65536)-qe.buffer.byteLength+65535>>>16;try{qe.grow(E),Me();var I=1;break e}catch{}I=void 0}if(I)return!0}return!1},emscripten_webgl_enable_extension:function(d,p){return d=Zt[d],p=p?Le(z,p):"",p.startsWith("GL_")&&(p=p.substr(3)),p=="WEBGL_draw_instanced_base_vertex_base_instance"&&rs(pe),p=="WEBGL_multi_draw_instanced_base_vertex_base_instance"&&jc(pe),p=="WEBGL_multi_draw"&&ll(pe),!!d.C.getExtension(p)},emscripten_webgl_get_current_context:function(){return br?br.handle:0},emscripten_webgl_make_context_current:function(d){return os(d)?0:-5},enable_WEBGL_provoking_vertex:function(d){return d=Zt[d].C,d.rb=d.getExtension("WEBGL_provoking_vertex"),!!d.rb},enable_WEBGL_shader_pixel_local_storage_coherent:function(d){return d=Zt[d].C,d.ca=d.getExtension("WEBGL_shader_pixel_local_storage"),!(!d.ca||!d.ca.isCoherent())},endPixelLocalStorageWEBGL:function(d,p,g){(d=Zt[d].C.ca)&&d.endPixelLocalStorageWEBGL(T.HEAPU32.subarray(g,g+p))},environ_get:(d,p)=>{var g=0;return Bc().forEach(function(k,E){var I=p+g;for(E=ae[d+4*E>>2]=I,I=0;I<k.length;++I)Fe[E++>>0]=k.charCodeAt(I);Fe[E>>0]=0,g+=k.length+1}),0},environ_sizes_get:(d,p)=>{var g=Bc();ae[d>>2]=g.length;var k=0;return g.forEach(function(E){k+=E.length+1}),ae[p>>2]=k,0},fd_close:function(d){try{var p=$r(d);if(p.X===null)throw new Ne(8);p.Sa&&(p.Sa=null);try{p.m.close&&p.m.close(p)}catch(g){throw g}finally{Wn[p.X]=null}return p.X=null,0}catch(g){if(typeof Pr>"u"||g.name!=="ErrnoError")throw g;return g.aa}},fd_read:function(d,p,g,k){try{e:{var E=$r(d);d=p;for(var I,B=p=0;B<g;B++){var G=ae[d>>2],se=ae[d+4>>2];d+=8;var ee=E,Te=G,_e=se,De=I,ne=Fe;if(0>_e||0>De)throw new Ne(28);if(ee.X===null)throw new Ne(8);if((ee.flags&2097155)===1)throw new Ne(8);if((ee.node.mode&61440)===16384)throw new Ne(31);if(!ee.m.read)throw new Ne(28);var fe=typeof De<"u";if(!fe)De=ee.position;else if(!ee.seekable)throw new Ne(70);var Pe=ee.m.read(ee,ne,Te,_e,De);fe||(ee.position+=Pe);var He=Pe;if(0>He){var Je=-1;break e}if(p+=He,He<se)break;typeof I<"u"&&(I+=He)}Je=p}return ae[k>>2]=Je,0}catch(et){if(typeof Pr>"u"||et.name!=="ErrnoError")throw et;return et.aa}},fd_seek:function(d,p,g,k,E){p=g+2097152>>>0<4194305-!!p?(p>>>0)+4294967296*g:NaN;try{if(isNaN(p))return 61;var I=$r(d);return Go(I,p,k),ji=[I.position>>>0,(Fn=I.position,1<=+Math.abs(Fn)?0<Fn?+Math.floor(Fn/4294967296)>>>0:~~+Math.ceil((Fn-+(~~Fn>>>0))/4294967296)>>>0:0)],M[E>>2]=ji[0],M[E+4>>2]=ji[1],I.Sa&&p===0&&k===0&&(I.Sa=null),0}catch(B){if(typeof Pr>"u"||B.name!=="ErrnoError")throw B;return B.aa}},fd_write:function(d,p,g,k){try{e:{var E=$r(d);d=p;for(var I,B=p=0;B<g;B++){var G=ae[d>>2],se=ae[d+4>>2];d+=8;var ee=E,Te=G,_e=se,De=I,ne=Fe;if(0>_e||0>De)throw new Ne(28);if(ee.X===null)throw new Ne(8);if((ee.flags&2097155)===0)throw new Ne(8);if((ee.node.mode&61440)===16384)throw new Ne(31);if(!ee.m.write)throw new Ne(28);ee.seekable&&ee.flags&1024&&Go(ee,0,2);var fe=typeof De<"u";if(!fe)De=ee.position;else if(!ee.seekable)throw new Ne(70);var Pe=ee.m.write(ee,ne,Te,_e,De,void 0);fe||(ee.position+=Pe);var He=Pe;if(0>He){var Je=-1;break e}p+=He,typeof I<"u"&&(I+=He)}Je=p}return ae[k>>2]=Je,0}catch(et){if(typeof Pr>"u"||et.name!=="ErrnoError")throw et;return et.aa}},framebufferPixelLocalClearValuefvWEBGL:function(d,p,g,k,E,I){(d=Zt[d].C.ca)&&d.framebufferPixelLocalClearValuefvWEBGL(p,[g,k,E,I])},framebufferTexturePixelLocalStorageWEBGL:function(d,p,g,k,E){(d=Zt[d].C.ca)&&d.framebufferTexturePixelLocalStorageWEBGL(p,pa[g],k,E)},getFramebufferPixelLocalStorageParameterivWEBGL:function(d,p,g){return(d=Zt[d].C.ca)?d.getFramebufferPixelLocalStorageParameterWEBGL(p,g):0},glActiveTexture:function(d){pe.activeTexture(d)},glAttachShader:function(d,p){pe.attachShader(nr[d],Or[p])},glBindBuffer:function(d,p){d==35051?pe.Pa=p:d==35052&&(pe.Qa=p),pe.bindBuffer(d,lo[p])},glBindBufferRange:function(d,p,g,k,E){pe.bindBufferRange(d,p,lo[g],k,E)},glBindFramebuffer:function(d,p){pe.bindFramebuffer(d,is[p])},glBindRenderbuffer:function(d,p){pe.bindRenderbuffer(d,co[p])},glBindTexture:function(d,p){pe.bindTexture(d,pa[p])},glBindVertexArray:function(d){pe.bindVertexArray(as[d])},glBlendEquation:function(d){pe.blendEquation(d)},glBlendFunc:function(d,p){pe.blendFunc(d,p)},glBlitFramebuffer:function(d,p,g,k,E,I,B,G,se,ee){pe.blitFramebuffer(d,p,g,k,E,I,B,G,se,ee)},glBufferData:function(d,p,g,k){g&&p?pe.bufferData(d,z,k,g,p):pe.bufferData(d,p,k)},glBufferSubData:function(d,p,g,k){g&&pe.bufferSubData(d,p,z,k,g)},glClear:function(d){pe.clear(d)},glClearBufferfv:function(d,p,g){pe.clearBufferfv(d,p,Ve,g>>2)},glClearBufferuiv:function(d,p,g){pe.clearBufferuiv(d,p,ae,g>>2)},glClearColor:function(d,p,g,k){pe.clearColor(d,p,g,k)},glClearDepthf:function(d){pe.clearDepth(d)},glClearStencil:function(d){pe.clearStencil(d)},glColorMask:function(d,p,g,k){pe.colorMask(!!d,!!p,!!g,!!k)},glCompileShader:function(d){pe.compileShader(Or[d])},glCreateProgram:function(){var d=bi(nr),p=pe.createProgram();return p.name=d,p.Ba=p.za=p.Aa=0,p.Ya=1,nr[d]=p,d},glCreateShader:function(d){var p=bi(Or);return Or[p]=pe.createShader(d),p},glCullFace:function(d){pe.cullFace(d)},glDeleteBuffers:function(d,p){for(var g=0;g<d;g++){var k=M[p+4*g>>2],E=lo[k];E&&(pe.deleteBuffer(E),E.name=0,lo[k]=null,k==pe.Pa&&(pe.Pa=0),k==pe.Qa&&(pe.Qa=0))}},glDeleteFramebuffers:function(d,p){for(var g=0;g<d;++g){var k=M[p+4*g>>2],E=is[k];E&&(pe.deleteFramebuffer(E),E.name=0,is[k]=null)}},glDeleteProgram:function(d){if(d){var p=nr[d];p?(pe.deleteProgram(p),p.name=0,nr[d]=null):Qt(1281)}},glDeleteRenderbuffers:function(d,p){for(var g=0;g<d;g++){var k=M[p+4*g>>2],E=co[k];E&&(pe.deleteRenderbuffer(E),E.name=0,co[k]=null)}},glDeleteShader:function(d){if(d){var p=Or[d];p?(pe.deleteShader(p),Or[d]=null):Qt(1281)}},glDeleteTextures:function(d,p){for(var g=0;g<d;g++){var k=M[p+4*g>>2],E=pa[k];E&&(pe.deleteTexture(E),E.name=0,pa[k]=null)}},glDeleteVertexArrays:function(d,p){for(var g=0;g<d;g++){var k=M[p+4*g>>2];pe.deleteVertexArray(as[k]),as[k]=null}},glDepthFunc:function(d){pe.depthFunc(d)},glDepthMask:function(d){pe.depthMask(!!d)},glDepthRangef:function(d,p){pe.depthRange(d,p)},glDisable:function(d){pe.disable(d)},glDrawArrays:function(d,p,g){pe.drawArrays(d,p,g)},glDrawArraysInstanced:function(d,p,g,k){pe.drawArraysInstanced(d,p,g,k)},glDrawBuffers:function(d,p){for(var g=ul[d],k=0;k<d;k++)g[k]=M[p+4*k>>2];pe.drawBuffers(g)},glDrawElements:function(d,p,g,k){pe.drawElements(d,p,g,k)},glDrawElementsInstanced:function(d,p,g,k,E){pe.drawElementsInstanced(d,p,g,k,E)},glEnable:function(d){pe.enable(d)},glEnableVertexAttribArray:function(d){pe.enableVertexAttribArray(d)},glFlush:function(){pe.flush()},glFramebufferRenderbuffer:function(d,p,g,k){pe.framebufferRenderbuffer(d,p,g,co[k])},glFramebufferTexture2D:function(d,p,g,k,E){pe.framebufferTexture2D(d,p,g,pa[k],E)},glFrontFace:function(d){pe.frontFace(d)},glGenBuffers:function(d,p){fa(d,p,"createBuffer",lo)},glGenFramebuffers:function(d,p){fa(d,p,"createFramebuffer",is)},glGenRenderbuffers:function(d,p){fa(d,p,"createRenderbuffer",co)},glGenTextures:function(d,p){fa(d,p,"createTexture",pa)},glGenVertexArrays:function(d,p){fa(d,p,"createVertexArray",as)},glGenerateMipmap:function(d){pe.generateMipmap(d)},glGetError:function(){var d=pe.getError()||uo;return uo=0,d},glGetIntegerv:function(d,p){Vc(d,p)},glGetProgramiv:function(d,p,g){if(g)if(d>=Dc)Qt(1281);else if(d=nr[d],p==35716)d=pe.getProgramInfoLog(d),d===null&&(d="(unknown error)"),M[g>>2]=d.length+1;else if(p==35719){if(!d.Ba)for(p=0;p<pe.getProgramParameter(d,35718);++p)d.Ba=Math.max(d.Ba,pe.getActiveUniform(d,p).name.length+1);M[g>>2]=d.Ba}else if(p==35722){if(!d.za)for(p=0;p<pe.getProgramParameter(d,35721);++p)d.za=Math.max(d.za,pe.getActiveAttrib(d,p).name.length+1);M[g>>2]=d.za}else if(p==35381){if(!d.Aa)for(p=0;p<pe.getProgramParameter(d,35382);++p)d.Aa=Math.max(d.Aa,pe.getActiveUniformBlockName(d,p).length+1);M[g>>2]=d.Aa}else M[g>>2]=pe.getProgramParameter(d,p);else Qt(1281)},glGetShaderiv:function(d,p,g){g?p==35716?(d=pe.getShaderInfoLog(Or[d]),d===null&&(d="(unknown error)"),M[g>>2]=d?d.length+1:0):p==35720?(d=pe.getShaderSource(Or[d]),M[g>>2]=d?d.length+1:0):M[g>>2]=pe.getShaderParameter(Or[d],p):Qt(1281)},glGetString:function(d){var p=Uc[d];if(!p){switch(d){case 7939:p=pe.getSupportedExtensions()||[],p=p.concat(p.map(function(k){return"GL_"+k})),p=wi(p.join(" "));break;case 7936:case 7937:case 37445:case 37446:(p=pe.getParameter(d))||Qt(1280),p=p&&wi(p);break;case 7938:p=wi("OpenGL ES 3.0 ("+pe.getParameter(7938)+")");break;case 35724:p=pe.getParameter(35724);var g=p.match(/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/);g!==null&&(g[1].length==3&&(g[1]+="0"),p="OpenGL ES GLSL ES "+g[1]+" ("+p+")"),p=wi(p);break;default:Qt(1280)}Uc[d]=p}return p},glGetUniformBlockIndex:function(d,p){return pe.getUniformBlockIndex(nr[d],p?Le(z,p):"")},glGetUniformLocation:function(d,p){if(p=p?Le(z,p):"",d=nr[d]){var g=d,k=g.oa,E=g.zb,I;if(!k)for(g.oa=k={},g.yb={},I=0;I<pe.getProgramParameter(g,35718);++I){var B=pe.getActiveUniform(g,I),G=B.name;B=B.size;var se=ma(G);se=0<se?G.slice(0,se):G;var ee=g.Ya;for(g.Ya+=B,E[se]=[B,ee],G=0;G<B;++G)k[ee]=G,g.yb[ee++]=se}if(g=d.oa,k=0,E=p,I=ma(p),0<I&&(k=parseInt(p.slice(I+1))>>>0,E=p.slice(0,I)),(E=d.zb[E])&&k<E[0]&&(k+=E[1],g[k]=g[k]||pe.getUniformLocation(d,p)))return k}else Qt(1281);return-1},glInvalidateFramebuffer:function(d,p,g){for(var k=ul[p],E=0;E<p;E++)k[E]=M[g+4*E>>2];pe.invalidateFramebuffer(d,k)},glLinkProgram:function(d){d=nr[d],pe.linkProgram(d),d.oa=0,d.zb={}},glPixelStorei:function(d,p){pe.pixelStorei(d,p)},glReadPixels:function(d,p,g,k,E,I,B){if(pe.Pa)pe.readPixels(d,p,g,k,E,I,B);else{var G=Wc(I);pe.readPixels(d,p,g,k,E,I,G,B>>31-Math.clz32(G.BYTES_PER_ELEMENT))}},glRenderbufferStorageMultisample:function(d,p,g,k,E){pe.renderbufferStorageMultisample(d,p,g,k,E)},glScissor:function(d,p,g,k){pe.scissor(d,p,g,k)},glShaderSource:function(d,p,g,k){for(var E="",I=0;I<p;++I){var B=k?M[k+4*I>>2]:-1,G=M[g+4*I>>2];B=G?Le(z,G,0>B?void 0:B):"",E+=B}pe.shaderSource(Or[d],E)},glStencilFunc:function(d,p,g){pe.stencilFunc(d,p,g)},glStencilFuncSeparate:function(d,p,g,k){pe.stencilFuncSeparate(d,p,g,k)},glStencilMask:function(d){pe.stencilMask(d)},glStencilOp:function(d,p,g){pe.stencilOp(d,p,g)},glStencilOpSeparate:function(d,p,g,k){pe.stencilOpSeparate(d,p,g,k)},glTexParameteri:function(d,p,g){pe.texParameteri(d,p,g)},glTexStorage2D:function(d,p,g,k,E){pe.texStorage2D(d,p,g,k,E)},glTexSubImage2D:function(d,p,g,k,E,I,B,G,se){if(pe.Qa)pe.texSubImage2D(d,p,g,k,E,I,B,G,se);else if(se){var ee=Wc(G);pe.texSubImage2D(d,p,g,k,E,I,B,G,ee,se>>31-Math.clz32(ee.BYTES_PER_ELEMENT))}else pe.texSubImage2D(d,p,g,k,E,I,B,G,null)},glUniform1i:function(d,p){var g=pe,k=g.uniform1i,E=pe.Kb;if(E){var I=E.oa[d];typeof I=="number"&&(E.oa[d]=I=pe.getUniformLocation(E,E.yb[d]+(0<I?"["+I+"]":""))),d=I}else Qt(1282),d=void 0;k.call(g,d,p)},glUniformBlockBinding:function(d,p,g){d=nr[d],pe.uniformBlockBinding(d,p,g)},glUseProgram:function(d){d=nr[d],pe.useProgram(d),pe.Kb=d},glVertexAttribDivisor:function(d,p){pe.vertexAttribDivisor(d,p)},glVertexAttribIPointer:function(d,p,g,k,E){pe.vertexAttribIPointer(d,p,g,k,E)},glVertexAttribPointer:function(d,p,g,k,E,I){pe.vertexAttribPointer(d,p,g,!!k,E,I)},glViewport:function(d,p,g,k){pe.viewport(d,p,g,k)},provokingVertexWEBGL:function(d,p){(d=Zt[d].C.rb)&&d.provokingVertexWEBGL(p)},strftime_l:(d,p,g,k)=>hl(d,p,g,k),upload_image:function(d,p){var g=T.images;g&&(p=g.get(p))&&(d=Zt[d].C,d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,p),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1))}};(function(){function d(g){if(Ue=g=g.exports,qe=Ue.memory,Me(),Oe=Ue.__indirect_function_table,$e.unshift(Ue.__wasm_call_ctors),qt--,T.monitorRunDependencies&&T.monitorRunDependencies(qt),qt==0&&er){var k=er;er=null,k()}return g}var p={env:qc,wasi_snapshot_preview1:qc};if(qt++,T.monitorRunDependencies&&T.monitorRunDependencies(qt),T.instantiateWasm)try{return T.instantiateWasm(p,d)}catch(g){he("Module.instantiateWasm callback failed with error: "+g),L(g)}return Ni(p,function(g){d(g.instance)}).catch(L),{}})();var Qr=d=>(Qr=Ue.free)(d),ls=d=>(ls=Ue.malloc)(d);T._setWebImage=(d,p,g)=>(T._setWebImage=Ue.setWebImage)(d,p,g);var $c=()=>($c=Ue.__errno_location)(),rr=T._ma_device__on_notification_unlocked=d=>(rr=T._ma_device__on_notification_unlocked=Ue.ma_device__on_notification_unlocked)(d);T._ma_malloc_emscripten=(d,p)=>(T._ma_malloc_emscripten=Ue.ma_malloc_emscripten)(d,p),T._ma_free_emscripten=(d,p)=>(T._ma_free_emscripten=Ue.ma_free_emscripten)(d,p);var ga=T._ma_device_process_pcm_frames_capture__webaudio=(d,p,g)=>(ga=T._ma_device_process_pcm_frames_capture__webaudio=Ue.ma_device_process_pcm_frames_capture__webaudio)(d,p,g),ml=T._ma_device_process_pcm_frames_playback__webaudio=(d,p,g)=>(ml=T._ma_device_process_pcm_frames_playback__webaudio=Ue.ma_device_process_pcm_frames_playback__webaudio)(d,p,g),gl=d=>(gl=Ue.__getTypeName)(d);T.__embind_initialize_bindings=()=>(T.__embind_initialize_bindings=Ue._embind_initialize_bindings)(),T.dynCall_iiiji=(d,p,g,k,E,I)=>(T.dynCall_iiiji=Ue.dynCall_iiiji)(d,p,g,k,E,I),T.dynCall_iij=(d,p,g,k)=>(T.dynCall_iij=Ue.dynCall_iij)(d,p,g,k),T.dynCall_iiji=(d,p,g,k,E)=>(T.dynCall_iiji=Ue.dynCall_iiji)(d,p,g,k,E),T.dynCall_jii=(d,p,g)=>(T.dynCall_jii=Ue.dynCall_jii)(d,p,g),T.dynCall_vijj=(d,p,g,k,E,I)=>(T.dynCall_vijj=Ue.dynCall_vijj)(d,p,g,k,E,I),T.dynCall_jiji=(d,p,g,k,E)=>(T.dynCall_jiji=Ue.dynCall_jiji)(d,p,g,k,E),T.dynCall_viijii=(d,p,g,k,E,I,B)=>(T.dynCall_viijii=Ue.dynCall_viijii)(d,p,g,k,E,I,B),T.dynCall_iiiiij=(d,p,g,k,E,I,B)=>(T.dynCall_iiiiij=Ue.dynCall_iiiiij)(d,p,g,k,E,I,B),T.dynCall_iiiiijj=(d,p,g,k,E,I,B,G,se)=>(T.dynCall_iiiiijj=Ue.dynCall_iiiiijj)(d,p,g,k,E,I,B,G,se),T.dynCall_iiiiiijj=(d,p,g,k,E,I,B,G,se,ee)=>(T.dynCall_iiiiiijj=Ue.dynCall_iiiiiijj)(d,p,g,k,E,I,B,G,se,ee),T.___start_em_js=531476,T.___stop_em_js=534231;var po;er=function d(){po||vl(),po||(er=d)};function vl(){function d(){if(!po&&(po=!0,T.calledRun=!0,!ot)){if(T.noFSInit||Ha||(Ha=!0,Qs(),T.stdin=T.stdin,T.stdout=T.stdout,T.stderr=T.stderr,T.stdin?Ga("stdin",T.stdin):Zs("/dev/tty","/dev/stdin"),T.stdout?Ga("stdout",null,T.stdout):Zs("/dev/tty","/dev/stdout"),T.stderr?Ga("stderr",null,T.stderr):Zs("/dev/tty1","/dev/stderr"),Ho("/dev/stdin",0),Ho("/dev/stdout",1),Ho("/dev/stderr",1)),Wo=!1,_($e),N(T),T.onRuntimeInitialized&&T.onRuntimeInitialized(),T.postRun)for(typeof T.postRun=="function"&&(T.postRun=[T.postRun]);T.postRun.length;){var p=T.postRun.shift();dt.unshift(p)}_(dt)}}if(!(0<qt)){if(T.preRun)for(typeof T.preRun=="function"&&(T.preRun=[T.preRun]);T.preRun.length;)At();_(Ye),0<qt||(T.setStatus?(T.setStatus("Running..."),setTimeout(function(){setTimeout(function(){T.setStatus("")},1),d()},1)):d())}}if(T.preInit)for(typeof T.preInit=="function"&&(T.preInit=[T.preInit]);0<T.preInit.length;)T.preInit.pop()();return vl(),x.ready}})();const v=f},l=>{l.exports=JSON.parse(`{"name":"@rive-app/webgl2","version":"2.31.5","description":"Rive's webgl2 based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)","Chris Dalton <chris@rive.app> (https://rive.app)"],"license":"MIT","files":["rive.js","rive.wasm","rive.js.map","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)},(l,u,h)=>{h.r(u),h.d(u,{Animation:()=>f.Animation});var f=h(4)},(l,u,h)=>{h.r(u),h.d(u,{Animation:()=>f});var f=function(){function v(C,x,T,N){this.animation=C,this.artboard=x,this.playing=N,this.loopCount=0,this.scrubTo=null,this.instance=new T.LinearAnimationInstance(C,x)}return Object.defineProperty(v.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"time",{get:function(){return this.instance.time},set:function(C){this.instance.time=C},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),v.prototype.advance=function(C){this.scrubTo===null?this.instance.advance(C):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},v.prototype.apply=function(C){this.instance.apply(C)},v.prototype.cleanup=function(){this.instance.delete()},v}()},(l,u,h)=>{h.r(u),h.d(u,{AudioAssetWrapper:()=>C.AudioAssetWrapper,AudioWrapper:()=>C.AudioWrapper,BLANK_URL:()=>v.BLANK_URL,CustomFileAssetLoaderWrapper:()=>C.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>C.FileAssetWrapper,FileFinalizer:()=>C.FileFinalizer,FontAssetWrapper:()=>C.FontAssetWrapper,FontWrapper:()=>C.FontWrapper,ImageAssetWrapper:()=>C.ImageAssetWrapper,ImageWrapper:()=>C.ImageWrapper,createFinalization:()=>C.createFinalization,finalizationRegistry:()=>C.finalizationRegistry,registerTouchInteractions:()=>f.registerTouchInteractions,sanitizeUrl:()=>v.sanitizeUrl});var f=h(6),v=h(7),C=h(8)},(l,u,h)=>{h.r(u),h.d(u,{registerTouchInteractions:()=>C});var f=void 0,v=function(x,T){var N,L;return["touchstart","touchmove"].indexOf(x.type)>-1&&!((N=x.touches)===null||N===void 0)&&N.length?(T||x.preventDefault(),{clientX:x.touches[0].clientX,clientY:x.touches[0].clientY}):x.type==="touchend"&&!((L=x.changedTouches)===null||L===void 0)&&L.length?{clientX:x.changedTouches[0].clientX,clientY:x.changedTouches[0].clientY}:{clientX:x.clientX,clientY:x.clientY}},C=function(x){var T=x.canvas,N=x.artboard,L=x.stateMachines,$=L===void 0?[]:L,V=x.renderer,K=x.rive,F=x.fit,A=x.alignment,U=x.isTouchScrollEnabled,Z=U===void 0?!1:U,oe=x.layoutScaleFactor,X=oe===void 0?1:oe;if(!T||!$.length||!V||!K||!N||typeof window>"u")return null;var H=null,J=!1,Y=function(Ae){if(J&&Ae instanceof MouseEvent){Ae.type=="mouseup"&&(J=!1);return}J=Z&&Ae.type==="touchend"&&H==="touchstart",H=Ae.type;var qe=Ae.currentTarget.getBoundingClientRect(),Ue=v(Ae,Z),ot=Ue.clientX,Fe=Ue.clientY;if(!(!ot&&!Fe)){var z=ot-qe.left,ce=Fe-qe.top,ue=K.computeAlignment(F,A,{minX:0,minY:0,maxX:qe.width,maxY:qe.height},N.bounds,X),M=new K.Mat2D;ue.invert(M);var ae=new K.Vec2D(z,ce),Ve=K.mapXY(M,ae),ke=Ve.x(),Me=Ve.y();switch(Ve.delete(),M.delete(),ae.delete(),ue.delete(),Ae.type){case"mouseout":for(var Oe=0,Ye=$;Oe<Ye.length;Oe++){var $e=Ye[Oe];$e.pointerMove(ke,Me)}break;case"touchmove":case"mouseover":case"mousemove":{for(var dt=0,At=$;dt<At.length;dt++){var $e=At[dt];$e.pointerMove(ke,Me)}break}case"touchstart":case"mousedown":{for(var qt=0,er=$;qt<er.length;qt++){var $e=er[qt];$e.pointerDown(ke,Me)}break}case"touchend":case"mouseup":{for(var bn=0,Sr=$;bn<Sr.length;bn++){var $e=Sr[bn];$e.pointerUp(ke,Me)}break}}}},he=Y.bind(f);return T.addEventListener("mouseover",he),T.addEventListener("mouseout",he),T.addEventListener("mousemove",he),T.addEventListener("mousedown",he),T.addEventListener("mouseup",he),T.addEventListener("touchmove",he,{passive:Z}),T.addEventListener("touchstart",he,{passive:Z}),T.addEventListener("touchend",he),function(){T.removeEventListener("mouseover",he),T.removeEventListener("mouseout",he),T.removeEventListener("mousemove",he),T.removeEventListener("mousedown",he),T.removeEventListener("mouseup",he),T.removeEventListener("touchmove",he),T.removeEventListener("touchstart",he),T.removeEventListener("touchend",he)}}},(l,u,h)=>{h.r(u),h.d(u,{BLANK_URL:()=>L,sanitizeUrl:()=>K});var f=/^([^\w]*)(javascript|data|vbscript)/im,v=/&#(\w+)(^\w|;)?/g,C=/&(newline|tab);/gi,x=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,T=/^.+(:|&colon;)/gim,N=[".","/"],L="about:blank";function $(F){return N.indexOf(F[0])>-1}function V(F){var A=F.replace(x,"");return A.replace(v,function(U,Z){return String.fromCharCode(Z)})}function K(F){if(!F)return L;var A=V(F).replace(C,"").replace(x,"").trim();if(!A)return L;if($(A))return A;var U=A.match(T);if(!U)return A;var Z=U[0];return f.test(Z)?L:A}},(l,u,h)=>{h.r(u),h.d(u,{AudioAssetWrapper:()=>F,AudioWrapper:()=>N,CustomFileAssetLoaderWrapper:()=>$,FileAssetWrapper:()=>V,FileFinalizer:()=>v,FontAssetWrapper:()=>A,FontWrapper:()=>L,ImageAssetWrapper:()=>K,ImageWrapper:()=>T,createFinalization:()=>X,finalizationRegistry:()=>oe});var f=function(){var H=function(J,Y){return H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(he,Ae){he.__proto__=Ae}||function(he,Ae){for(var qe in Ae)Object.prototype.hasOwnProperty.call(Ae,qe)&&(he[qe]=Ae[qe])},H(J,Y)};return function(J,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Class extends value "+String(Y)+" is not a constructor or null");H(J,Y);function he(){this.constructor=J}J.prototype=Y===null?Object.create(Y):(he.prototype=Y.prototype,new he)}}(),v=function(){function H(J){this.selfUnref=!1,this._file=J}return H.prototype.unref=function(){this._file&&this._file.unref()},H}(),C=function(){function H(J){this._finalizableObject=J}return H.prototype.unref=function(){this._finalizableObject.unref()},H}(),x=function(){function H(){this.selfUnref=!1}return H.prototype.unref=function(){},H}(),T=function(H){f(J,H);function J(Y){var he=H.call(this)||this;return he._nativeImage=Y,he}return Object.defineProperty(J.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),J.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},J}(x),N=function(H){f(J,H);function J(Y){var he=H.call(this)||this;return he._nativeAudio=Y,he}return Object.defineProperty(J.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),J.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},J}(x),L=function(H){f(J,H);function J(Y){var he=H.call(this)||this;return he._nativeFont=Y,he}return Object.defineProperty(J.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),J.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},J}(x),$=function(){function H(J,Y){this._assetLoaderCallback=Y,this.assetLoader=new J.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return H.prototype.loadContents=function(J,Y){var he;return J.isImage?he=new K(J):J.isAudio?he=new F(J):J.isFont&&(he=new A(J)),this._assetLoaderCallback(he,Y)},H}(),V=function(){function H(J){this._nativeFileAsset=J}return H.prototype.decode=function(J){this._nativeFileAsset.decode(J)},Object.defineProperty(H.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),H}(),K=function(H){f(J,H);function J(){return H!==null&&H.apply(this,arguments)||this}return J.prototype.setRenderImage=function(Y){this._nativeFileAsset.setRenderImage(Y.nativeImage)},J}(V),F=function(H){f(J,H);function J(){return H!==null&&H.apply(this,arguments)||this}return J.prototype.setAudioSource=function(Y){this._nativeFileAsset.setAudioSource(Y.nativeAudio)},J}(V),A=function(H){f(J,H);function J(){return H!==null&&H.apply(this,arguments)||this}return J.prototype.setFont=function(Y){this._nativeFileAsset.setFont(Y.nativeFont)},J}(V),U=function(){function H(J){}return H.prototype.register=function(J){J.selfUnref=!0},H.prototype.unregister=function(J){},H}(),Z=typeof FinalizationRegistry<"u"?FinalizationRegistry:U,oe=new Z(function(H){H==null||H.unref()}),X=function(H,J){var Y=new C(J);oe.register(H,Y)}}],r={};function a(l){var u=r[l];if(u!==void 0)return u.exports;var h=r[l]={exports:{}};return t[l](h,h.exports,a),h.exports}a.d=(l,u)=>{for(var h in u)a.o(u,h)&&!a.o(l,h)&&Object.defineProperty(l,h,{enumerable:!0,get:u[h]})},a.o=(l,u)=>Object.prototype.hasOwnProperty.call(l,u),a.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var s={};return(()=>{a.r(s),a.d(s,{Alignment:()=>K,DataEnum:()=>Me,EventType:()=>Y,Fit:()=>V,Layout:()=>F,LoopType:()=>he,Rive:()=>Ve,RiveEventType:()=>oe,RiveFile:()=>ae,RuntimeLoader:()=>A,StateMachineInput:()=>Z,StateMachineInputType:()=>U,Testing:()=>Ni,ViewModel:()=>ke,ViewModelInstance:()=>Ye,ViewModelInstanceArtboard:()=>Li,ViewModelInstanceAssetImage:()=>sa,ViewModelInstanceBoolean:()=>qt,ViewModelInstanceColor:()=>Tr,ViewModelInstanceEnum:()=>bn,ViewModelInstanceList:()=>Sr,ViewModelInstanceNumber:()=>At,ViewModelInstanceString:()=>dt,ViewModelInstanceTrigger:()=>er,ViewModelInstanceValue:()=>$e,decodeAudio:()=>Fn,decodeFont:()=>Vo,decodeImage:()=>ji});var l=a(1),u=a(2),h=a(3),f=a(5),v=function(){var _=function(y,S){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,Q){O.__proto__=Q}||function(O,Q){for(var de in Q)Object.prototype.hasOwnProperty.call(Q,de)&&(O[de]=Q[de])},_(y,S)};return function(y,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");_(y,S);function O(){this.constructor=y}y.prototype=S===null?Object.create(S):(O.prototype=S.prototype,new O)}}(),C=function(){return C=Object.assign||function(_){for(var y,S=1,O=arguments.length;S<O;S++){y=arguments[S];for(var Q in y)Object.prototype.hasOwnProperty.call(y,Q)&&(_[Q]=y[Q])}return _},C.apply(this,arguments)},x=function(_,y,S,O){function Q(de){return de instanceof S?de:new S(function(be){be(de)})}return new(S||(S=Promise))(function(de,be){function Ke(st){try{Le(O.next(st))}catch(Tt){be(Tt)}}function it(st){try{Le(O.throw(st))}catch(Tt){be(Tt)}}function Le(st){st.done?de(st.value):Q(st.value).then(Ke,it)}Le((O=O.apply(_,[])).next())})},T=function(_,y){var S={label:0,sent:function(){if(de[0]&1)throw de[1];return de[1]},trys:[],ops:[]},O,Q,de,be=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return be.next=Ke(0),be.throw=Ke(1),be.return=Ke(2),typeof Symbol=="function"&&(be[Symbol.iterator]=function(){return this}),be;function Ke(Le){return function(st){return it([Le,st])}}function it(Le){if(O)throw new TypeError("Generator is already executing.");for(;be&&(be=0,Le[0]&&(S=0)),S;)try{if(O=1,Q&&(de=Le[0]&2?Q.return:Le[0]?Q.throw||((de=Q.return)&&de.call(Q),0):Q.next)&&!(de=de.call(Q,Le[1])).done)return de;switch(Q=0,de&&(Le=[Le[0]&2,de.value]),Le[0]){case 0:case 1:de=Le;break;case 4:return S.label++,{value:Le[1],done:!1};case 5:S.label++,Q=Le[1],Le=[0];continue;case 7:Le=S.ops.pop(),S.trys.pop();continue;default:if(de=S.trys,!(de=de.length>0&&de[de.length-1])&&(Le[0]===6||Le[0]===2)){S=0;continue}if(Le[0]===3&&(!de||Le[1]>de[0]&&Le[1]<de[3])){S.label=Le[1];break}if(Le[0]===6&&S.label<de[1]){S.label=de[1],de=Le;break}if(de&&S.label<de[2]){S.label=de[2],S.ops.push(Le);break}de[2]&&S.ops.pop(),S.trys.pop();continue}Le=y.call(_,S)}catch(st){Le=[6,st],Q=0}finally{O=de=0}if(Le[0]&5)throw Le[1];return{value:Le[0]?Le[1]:void 0,done:!0}}},N=function(_,y,S){for(var O=0,Q=y.length,de;O<Q;O++)(de||!(O in y))&&(de||(de=Array.prototype.slice.call(y,0,O)),de[O]=y[O]);return _.concat(de||Array.prototype.slice.call(y))},L=function(_){v(y,_);function y(){var S=_!==null&&_.apply(this,arguments)||this;return S.isHandledError=!0,S}return y}(Error),$=function(_){return _&&_.isHandledError?_.message:"Problem loading file; may be corrupt!"},V;(function(_){_.Cover="cover",_.Contain="contain",_.Fill="fill",_.FitWidth="fitWidth",_.FitHeight="fitHeight",_.None="none",_.ScaleDown="scaleDown",_.Layout="layout"})(V||(V={}));var K;(function(_){_.Center="center",_.TopLeft="topLeft",_.TopCenter="topCenter",_.TopRight="topRight",_.CenterLeft="centerLeft",_.CenterRight="centerRight",_.BottomLeft="bottomLeft",_.BottomCenter="bottomCenter",_.BottomRight="bottomRight"})(K||(K={}));var F=function(){function _(y){var S,O,Q,de,be,Ke,it;this.fit=(S=y==null?void 0:y.fit)!==null&&S!==void 0?S:V.Contain,this.alignment=(O=y==null?void 0:y.alignment)!==null&&O!==void 0?O:K.Center,this.layoutScaleFactor=(Q=y==null?void 0:y.layoutScaleFactor)!==null&&Q!==void 0?Q:1,this.minX=(de=y==null?void 0:y.minX)!==null&&de!==void 0?de:0,this.minY=(be=y==null?void 0:y.minY)!==null&&be!==void 0?be:0,this.maxX=(Ke=y==null?void 0:y.maxX)!==null&&Ke!==void 0?Ke:0,this.maxY=(it=y==null?void 0:y.maxY)!==null&&it!==void 0?it:0}return _.new=function(y){var S=y.fit,O=y.alignment,Q=y.minX,de=y.minY,be=y.maxX,Ke=y.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new _({fit:S,alignment:O,minX:Q,minY:de,maxX:be,maxY:Ke})},_.prototype.copyWith=function(y){var S=y.fit,O=y.alignment,Q=y.layoutScaleFactor,de=y.minX,be=y.minY,Ke=y.maxX,it=y.maxY;return new _({fit:S??this.fit,alignment:O??this.alignment,layoutScaleFactor:Q??this.layoutScaleFactor,minX:de??this.minX,minY:be??this.minY,maxX:Ke??this.maxX,maxY:it??this.maxY})},_.prototype.runtimeFit=function(y){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var S;return this.fit===V.Cover?S=y.Fit.cover:this.fit===V.Contain?S=y.Fit.contain:this.fit===V.Fill?S=y.Fit.fill:this.fit===V.FitWidth?S=y.Fit.fitWidth:this.fit===V.FitHeight?S=y.Fit.fitHeight:this.fit===V.ScaleDown?S=y.Fit.scaleDown:this.fit===V.Layout?S=y.Fit.layout:S=y.Fit.none,this.cachedRuntimeFit=S,S},_.prototype.runtimeAlignment=function(y){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var S;return this.alignment===K.TopLeft?S=y.Alignment.topLeft:this.alignment===K.TopCenter?S=y.Alignment.topCenter:this.alignment===K.TopRight?S=y.Alignment.topRight:this.alignment===K.CenterLeft?S=y.Alignment.centerLeft:this.alignment===K.CenterRight?S=y.Alignment.centerRight:this.alignment===K.BottomLeft?S=y.Alignment.bottomLeft:this.alignment===K.BottomCenter?S=y.Alignment.bottomCenter:this.alignment===K.BottomRight?S=y.Alignment.bottomRight:S=y.Alignment.center,this.cachedRuntimeAlignment=S,S},_}(),A=function(){function _(){}return _.loadRuntime=function(){l.default({locateFile:function(){return _.wasmURL}}).then(function(y){var S;for(_.runtime=y;_.callBackQueue.length>0;)(S=_.callBackQueue.shift())===null||S===void 0||S(_.runtime)}).catch(function(y){var S={message:(y==null?void 0:y.message)||"Unknown error",type:(y==null?void 0:y.name)||"Error",wasmError:y instanceof WebAssembly.CompileError||y instanceof WebAssembly.RuntimeError,originalError:y};console.debug("Rive WASM load error details:",S);var O="https://cdn.jsdelivr.net/npm/".concat(u.name,"@").concat(u.version,"/rive_fallback.wasm");if(_.wasmURL.toLowerCase()!==O)console.warn("Failed to load WASM from ".concat(_.wasmURL," (").concat(S.message,"), trying jsdelivr as a backup")),_.setWasmUrl(O),_.loadRuntime();else{var Q=["Could not load Rive WASM file from ".concat(_.wasmURL," or ").concat(O,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(S.type),"- Message: ".concat(S.message),"- WebAssembly-specific error: ".concat(S.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(Q)}})},_.getInstance=function(y){_.isLoading||(_.isLoading=!0,_.loadRuntime()),_.runtime?y(_.runtime):_.callBackQueue.push(y)},_.awaitInstance=function(){return new Promise(function(y){return _.getInstance(function(S){return y(S)})})},_.setWasmUrl=function(y){_.wasmURL=y},_.getWasmUrl=function(){return _.wasmURL},_.isLoading=!1,_.callBackQueue=[],_.wasmURL="https://unpkg.com/".concat(u.name,"@").concat(u.version,"/rive.wasm"),_}(),U;(function(_){_[_.Number=56]="Number",_[_.Trigger=58]="Trigger",_[_.Boolean=59]="Boolean"})(U||(U={}));var Z=function(){function _(y,S){this.type=y,this.runtimeInput=S}return Object.defineProperty(_.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(y){this.runtimeInput.value=y},enumerable:!1,configurable:!0}),_.prototype.fire=function(){this.type===U.Trigger&&this.runtimeInput.fire()},_.prototype.delete=function(){this.runtimeInput=null},_}(),oe;(function(_){_[_.General=128]="General",_[_.OpenUrl=131]="OpenUrl"})(oe||(oe={}));var X=function(){function _(y){this.nativeArtboard=y}return _}(),H=function(){function _(y,S,O,Q){this.stateMachine=y,this.playing=O,this.artboard=Q,this.inputs=[],this.instance=new S.StateMachineInstance(y,Q),this.initInputs(S)}return Object.defineProperty(_.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"statesChanged",{get:function(){for(var y=[],S=0;S<this.instance.stateChangedCount();S++)y.push(this.instance.stateChangedNameByIndex(S));return y},enumerable:!1,configurable:!0}),_.prototype.advance=function(y){this.instance.advance(y)},_.prototype.advanceAndApply=function(y){this.instance.advanceAndApply(y)},_.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},_.prototype.reportedEventAt=function(y){return this.instance.reportedEventAt(y)},_.prototype.initInputs=function(y){for(var S=0;S<this.instance.inputCount();S++){var O=this.instance.input(S);this.inputs.push(this.mapRuntimeInput(O,y))}},_.prototype.mapRuntimeInput=function(y,S){if(y.type===S.SMIInput.bool)return new Z(U.Boolean,y.asBool());if(y.type===S.SMIInput.number)return new Z(U.Number,y.asNumber());if(y.type===S.SMIInput.trigger)return new Z(U.Trigger,y.asTrigger())},_.prototype.cleanup=function(){this.inputs.forEach(function(y){y.delete()}),this.inputs.length=0,this.instance.delete()},_.prototype.bindViewModelInstance=function(y){y.runtimeInstance!=null&&this.instance.bindViewModelInstance(y.runtimeInstance)},_}(),J=function(){function _(y,S,O,Q,de){Q===void 0&&(Q=[]),de===void 0&&(de=[]),this.runtime=y,this.artboard=S,this.eventManager=O,this.animations=Q,this.stateMachines=de}return _.prototype.add=function(y,S,O){if(O===void 0&&(O=!0),y=yn(y),y.length===0)this.animations.forEach(function(xt){return xt.playing=S}),this.stateMachines.forEach(function(xt){return xt.playing=S});else for(var Q=this.animations.map(function(xt){return xt.name}),de=this.stateMachines.map(function(xt){return xt.name}),be=0;be<y.length;be++){var Ke=Q.indexOf(y[be]),it=de.indexOf(y[be]);if(Ke>=0||it>=0)Ke>=0?this.animations[Ke].playing=S:this.stateMachines[it].playing=S;else{var Le=this.artboard.animationByName(y[be]);if(Le){var st=new h.Animation(Le,this.artboard,this.runtime,S);st.advance(0),st.apply(1),this.animations.push(st)}else{var Tt=this.artboard.stateMachineByName(y[be]);if(Tt){var $t=new H(Tt,this.runtime,S,this.artboard);this.stateMachines.push($t)}}}}return O&&(S?this.eventManager.fire({type:Y.Play,data:this.playing}):this.eventManager.fire({type:Y.Pause,data:this.paused})),S?this.playing:this.paused},_.prototype.initLinearAnimations=function(y,S){for(var O=this.animations.map(function(it){return it.name}),Q=0;Q<y.length;Q++){var de=O.indexOf(y[Q]);if(de>=0)this.animations[de].playing=S;else{var be=this.artboard.animationByName(y[Q]);if(be){var Ke=new h.Animation(be,this.artboard,this.runtime,S);Ke.advance(0),Ke.apply(1),this.animations.push(Ke)}else console.error("Animation with name ".concat(y[Q]," not found."))}}},_.prototype.initStateMachines=function(y,S){for(var O=this.stateMachines.map(function(it){return it.name}),Q=0;Q<y.length;Q++){var de=O.indexOf(y[Q]);if(de>=0)this.stateMachines[de].playing=S;else{var be=this.artboard.stateMachineByName(y[Q]);if(be){var Ke=new H(be,this.runtime,S,this.artboard);this.stateMachines.push(Ke)}else console.warn("State Machine with name ".concat(y[Q]," not found.")),this.initLinearAnimations([y[Q]],S)}}},_.prototype.play=function(y){return this.add(y,!0)},_.prototype.advanceIfPaused=function(){this.stateMachines.forEach(function(y){y.playing||y.advanceAndApply(0)})},_.prototype.pause=function(y){return this.add(y,!1)},_.prototype.scrub=function(y,S){var O=this.animations.filter(function(Q){return y.includes(Q.name)});return O.forEach(function(Q){return Q.scrubTo=S}),O.map(function(Q){return Q.name})},Object.defineProperty(_.prototype,"playing",{get:function(){return this.animations.filter(function(y){return y.playing}).map(function(y){return y.name}).concat(this.stateMachines.filter(function(y){return y.playing}).map(function(y){return y.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"paused",{get:function(){return this.animations.filter(function(y){return!y.playing}).map(function(y){return y.name}).concat(this.stateMachines.filter(function(y){return!y.playing}).map(function(y){return y.name}))},enumerable:!1,configurable:!0}),_.prototype.stop=function(y){var S=this;y=yn(y);var O=[];if(y.length===0)O=this.animations.map(function(be){return be.name}).concat(this.stateMachines.map(function(be){return be.name})),this.animations.forEach(function(be){return be.cleanup()}),this.stateMachines.forEach(function(be){return be.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var Q=this.animations.filter(function(be){return y.includes(be.name)});Q.forEach(function(be){be.cleanup(),S.animations.splice(S.animations.indexOf(be),1)});var de=this.stateMachines.filter(function(be){return y.includes(be.name)});de.forEach(function(be){be.cleanup(),S.stateMachines.splice(S.stateMachines.indexOf(be),1)}),O=Q.map(function(be){return be.name}).concat(de.map(function(be){return be.name}))}return this.eventManager.fire({type:Y.Stop,data:O}),O},Object.defineProperty(_.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(y,S){return y||S.playing},!1)||this.stateMachines.reduce(function(y,S){return y||S.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),_.prototype.atLeastOne=function(y,S){S===void 0&&(S=!0);var O;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([O=this.artboard.animationByIndex(0).name],y,S):this.artboard.stateMachineCount()>0&&this.add([O=this.artboard.stateMachineByIndex(0).name],y,S)),O},_.prototype.handleLooping=function(){for(var y=0,S=this.animations.filter(function(Q){return Q.playing});y<S.length;y++){var O=S[y];O.loopValue===0&&O.loopCount?(O.loopCount=0,this.stop(O.name)):O.loopValue===1&&O.loopCount?(this.eventManager.fire({type:Y.Loop,data:{animation:O.name,type:he.Loop}}),O.loopCount=0):O.loopValue===2&&O.loopCount>1&&(this.eventManager.fire({type:Y.Loop,data:{animation:O.name,type:he.PingPong}}),O.loopCount=0)}},_.prototype.handleStateChanges=function(){for(var y=[],S=0,O=this.stateMachines.filter(function(de){return de.playing});S<O.length;S++){var Q=O[S];y.push.apply(y,Q.statesChanged)}y.length>0&&this.eventManager.fire({type:Y.StateChange,data:y})},_.prototype.handleAdvancing=function(y){this.eventManager.fire({type:Y.Advance,data:y})},_}(),Y;(function(_){_.Load="load",_.LoadError="loaderror",_.Play="play",_.Pause="pause",_.Stop="stop",_.Loop="loop",_.Draw="draw",_.Advance="advance",_.StateChange="statechange",_.RiveEvent="riveevent",_.AudioStatusChange="audiostatuschange"})(Y||(Y={}));var he;(function(_){_.OneShot="oneshot",_.Loop="loop",_.PingPong="pingpong"})(he||(he={}));var Ae=function(){function _(y){y===void 0&&(y=[]),this.listeners=y}return _.prototype.getListeners=function(y){return this.listeners.filter(function(S){return S.type===y})},_.prototype.add=function(y){this.listeners.includes(y)||this.listeners.push(y)},_.prototype.remove=function(y){for(var S=0;S<this.listeners.length;S++){var O=this.listeners[S];if(O.type===y.type&&O.callback===y.callback){this.listeners.splice(S,1);break}}},_.prototype.removeAll=function(y){var S=this;y?this.listeners.filter(function(O){return O.type===y}).forEach(function(O){return S.remove(O)}):this.listeners.splice(0,this.listeners.length)},_.prototype.fire=function(y){var S=this.getListeners(y.type);S.forEach(function(O){return O.callback(y)})},_}(),qe=function(){function _(y){this.eventManager=y,this.queue=[]}return _.prototype.add=function(y){this.queue.push(y)},_.prototype.process=function(){for(;this.queue.length>0;){var y=this.queue.shift();y!=null&&y.action&&y.action(),y!=null&&y.event&&this.eventManager.fire(y.event)}},_}(),Ue;(function(_){_[_.AVAILABLE=0]="AVAILABLE",_[_.UNAVAILABLE=1]="UNAVAILABLE"})(Ue||(Ue={}));var ot=function(_){v(y,_);function y(){var S=_!==null&&_.apply(this,arguments)||this;return S._started=!1,S._enabled=!1,S._status=Ue.UNAVAILABLE,S}return y.prototype.delay=function(S){return x(this,void 0,void 0,function(){return T(this,function(O){return[2,new Promise(function(Q){return setTimeout(Q,S)})]})})},y.prototype.timeout=function(){return x(this,void 0,void 0,function(){return T(this,function(S){return[2,new Promise(function(O,Q){return setTimeout(Q,50)})]})})},y.prototype.reportToListeners=function(){this.fire({type:Y.AudioStatusChange}),this.removeAll()},y.prototype.enableAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){return this._enabled||(this._enabled=!0,this._status=Ue.AVAILABLE,this.reportToListeners()),[2]})})},y.prototype.testAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){switch(S.label){case 0:if(!(this._status===Ue.UNAVAILABLE&&this._audioContext!==null))return[3,4];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return S.sent(),this.enableAudio(),[3,4];case 3:return S.sent(),[3,4];case 4:return[2]}})})},y.prototype._establishAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){switch(S.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),S.label=2;case 2:return this._status!==Ue.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return S.sent(),[4,this.delay(1e3)];case 4:return S.sent(),[3,2];case 5:return[2]}})})},y.prototype.listenForUserAction=function(){var S=this,O=function(){return x(S,void 0,void 0,function(){return T(this,function(Q){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",O,{once:!0})},y.prototype.establishAudio=function(){return x(this,void 0,void 0,function(){return T(this,function(S){return this._establishAudio(),[2]})})},Object.defineProperty(y.prototype,"systemVolume",{get:function(){return this._status===Ue.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),y}(Ae),Fe=new ot,z=function(){function _(){}return _.prototype.observe=function(){},_.prototype.unobserve=function(){},_.prototype.disconnect=function(){},_}(),ce=globalThis.ResizeObserver||z,ue=function(){function _(){var y=this;this._elementsMap=new Map,this._onObservedEntry=function(S){var O=y._elementsMap.get(S.target);O!==null?O.onResize(S.target.clientWidth==0||S.target.clientHeight==0):y._resizeObserver.unobserve(S.target)},this._onObserved=function(S){S.forEach(y._onObservedEntry)},this._resizeObserver=new ce(this._onObserved)}return _.prototype.add=function(y,S){var O={onResize:S,element:y};return this._elementsMap.set(y,O),this._resizeObserver.observe(y),O},_.prototype.remove=function(y){this._resizeObserver.unobserve(y.element),this._elementsMap.delete(y.element)},_}(),M=new ue,ae=function(){function _(y){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.selfUnref=!1,this.src=y.src,this.buffer=y.buffer,y.assetLoader&&(this.assetLoader=y.assetLoader),this.enableRiveAssetCDN=typeof y.enableRiveAssetCDN=="boolean"?y.enableRiveAssetCDN:!0,this.eventManager=new Ae,y.onLoad&&this.on(Y.Load,y.onLoad),y.onLoadError&&this.on(Y.LoadError,y.onLoadError)}return _.prototype.releaseFile=function(){var y;this.selfUnref&&((y=this.file)===null||y===void 0||y.unref()),this.file=null},_.prototype.initData=function(){return x(this,void 0,void 0,function(){var y,S,O,Q,de;return T(this,function(be){switch(be.label){case 0:return this.src?(y=this,[4,Bo(this.src)]):[3,2];case 1:y.buffer=be.sent(),be.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(O=new f.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),S=O.assetLoader),Q=this,[4,this.runtime.load(new Uint8Array(this.buffer),S,this.enableRiveAssetCDN)]);case 3:return Q.file=be.sent(),de=new f.FileFinalizer(this.file),f.finalizationRegistry.register(this,de),this.destroyed?(this.releaseFile(),[2]):(this.file!==null?this.eventManager.fire({type:Y.Load,data:this}):this.fireLoadError(_.fileLoadErrorMessage),[2])}})})},_.prototype.init=function(){return x(this,void 0,void 0,function(){var y,S;return T(this,function(O){switch(O.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(_.missingErrorMessage),[2];O.label=1;case 1:return O.trys.push([1,4,,5]),y=this,[4,A.awaitInstance()];case 2:return y.runtime=O.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return O.sent(),[3,5];case 4:return S=O.sent(),this.fireLoadError(S instanceof Error?S.message:_.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},_.prototype.fireLoadError=function(y){throw this.eventManager.fire({type:Y.LoadError,data:y}),new Error(y)},_.prototype.on=function(y,S){this.eventManager.add({type:y,callback:S})},_.prototype.off=function(y,S){this.eventManager.remove({type:y,callback:S})},_.prototype.cleanup=function(){this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),this.releaseFile(),this.destroyed=!0)},_.prototype.removeAllRiveEventListeners=function(y){this.eventManager.removeAll(y)},_.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},_.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},_.prototype.getArtboard=function(y){var S=this.file.artboardByName(y);return S!=null?new X(S):null},_.missingErrorMessage="Rive source file or data buffer required",_.fileLoadErrorMessage="The file failed to load",_}(),Ve=function(){function _(y){var S=this,O;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(Q){var de=S._hasZeroSize!==Q;S._hasZeroSize=Q,Q?(!S._layout.maxX||!S._layout.maxY)&&S.resizeToCanvas():de&&S.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=y.canvas,y.canvas.constructor===HTMLCanvasElement&&(this._observed=M.add(this.canvas,this.onCanvasResize)),this.src=y.src,this.buffer=y.buffer,this.riveFile=y.riveFile,this.layout=(O=y.layout)!==null&&O!==void 0?O:new F,this.shouldDisableRiveListeners=!!y.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!y.isTouchScrollEnabled,this.automaticallyHandleEvents=!!y.automaticallyHandleEvents,this.enableRiveAssetCDN=y.enableRiveAssetCDN===void 0?!0:y.enableRiveAssetCDN,this.eventManager=new Ae,y.onLoad&&this.on(Y.Load,y.onLoad),y.onLoadError&&this.on(Y.LoadError,y.onLoadError),y.onPlay&&this.on(Y.Play,y.onPlay),y.onPause&&this.on(Y.Pause,y.onPause),y.onStop&&this.on(Y.Stop,y.onStop),y.onLoop&&this.on(Y.Loop,y.onLoop),y.onStateChange&&this.on(Y.StateChange,y.onStateChange),y.onAdvance&&this.on(Y.Advance,y.onAdvance),y.onload&&!y.onLoad&&this.on(Y.Load,y.onload),y.onloaderror&&!y.onLoadError&&this.on(Y.LoadError,y.onloaderror),y.onplay&&!y.onPlay&&this.on(Y.Play,y.onplay),y.onpause&&!y.onPause&&this.on(Y.Pause,y.onpause),y.onstop&&!y.onStop&&this.on(Y.Stop,y.onstop),y.onloop&&!y.onLoop&&this.on(Y.Loop,y.onloop),y.onstatechange&&!y.onStateChange&&this.on(Y.StateChange,y.onstatechange),y.assetLoader&&(this.assetLoader=y.assetLoader),this.taskQueue=new qe(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:y.autoplay,autoBind:y.autoBind,animations:y.animations,stateMachines:y.stateMachines,artboard:y.artboard,useOffscreenRenderer:y.useOffscreenRenderer})}return Object.defineProperty(_.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),_.new=function(y){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new _(y)},_.prototype.onSystemAudioChanged=function(){this.volume=this._volume},_.prototype.init=function(y){var S=this,O=y.src,Q=y.buffer,de=y.riveFile,be=y.animations,Ke=y.stateMachines,it=y.artboard,Le=y.autoplay,st=Le===void 0?!1:Le,Tt=y.useOffscreenRenderer,$t=Tt===void 0?!1:Tt,xt=y.autoBind,Bn=xt===void 0?!1:xt;if(!this.destroyed){if(this.src=O,this.buffer=Q,this.riveFile=de,!this.src&&!this.buffer&&!this.riveFile)throw new L(_.missingErrorMessage);var _n=yn(be),wn=yn(Ke);this.loaded=!1,this.readyForPlaying=!1,A.awaitInstance().then(function(en){S.destroyed||(S.runtime=en,S.removeRiveListeners(),S.deleteRiveRenderer(),S.renderer=S.runtime.makeRenderer(S.canvas,$t),S.canvas.width||S.canvas.height||S.resizeDrawingSurfaceToCanvas(),S.initData(it,_n,wn,st,Bn).then(function(rn){if(rn)return S.setupRiveListeners()}).catch(function(rn){console.error(rn)}))}).catch(function(en){console.error(en)})}},_.prototype.setupRiveListeners=function(y){var S=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var O=(this.animator.stateMachines||[]).filter(function(de){return de.playing&&S.runtime.hasListeners(de.instance)}).map(function(de){return de.instance}),Q=this.isTouchScrollEnabled;y&&"isTouchScrollEnabled"in y&&(Q=y.isTouchScrollEnabled),this.eventCleanup=(0,f.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:O,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:Q,layoutScaleFactor:this._layout.layoutScaleFactor})}},_.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},_.prototype.initializeAudio=function(){var y=this,S;Fe.status==Ue.UNAVAILABLE&&!((S=this.artboard)===null||S===void 0)&&S.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:Y.AudioStatusChange,callback:function(){return y.onSystemAudioChanged()}},Fe.add(this._audioEventListener),Fe.establishAudio())},_.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},_.prototype.initData=function(y,S,O,Q,de){return x(this,void 0,void 0,function(){var be,Ke,it,Le;return T(this,function(st){switch(st.label){case 0:return st.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(be=new ae({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=be,[4,be.init()]);case 1:if(st.sent(),this.destroyed)return be.destroyIfUnused(),[2,!1];st.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(y,S,O,Q,de),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:Y.Load,data:(Le=this.src)!==null&&Le!==void 0?Le:"buffer"}),this.animator.advanceIfPaused(),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return Ke=st.sent(),it=$(Ke),console.warn(it),this.eventManager.fire({type:Y.LoadError,data:it}),[2,Promise.reject(it)];case 4:return[2]}})})},_.prototype.initArtboard=function(y,S,O,Q,de){if(this.file){var be=y?this.file.artboardByName(y):this.file.defaultArtboard();if(!be){var Ke="Invalid artboard name or no default artboard";console.warn(Ke),this.eventManager.fire({type:Y.LoadError,data:Ke});return}this.artboard=be,be.volume=this._volume*Fe.systemVolume,this.animator=new J(this.runtime,this.artboard,this.eventManager);var it;if(S.length>0||O.length>0?(it=S.concat(O),this.animator.initLinearAnimations(S,Q),this.animator.initStateMachines(O,Q)):it=[this.animator.atLeastOne(Q,!1)],this.taskQueue.add({event:{type:Q?Y.Play:Y.Pause,data:it}}),de){var Le=this.file.defaultArtboardViewModel(be);if(Le!==null){var st=Le.defaultInstance();if(st!==null){var Tt=new Ye(st,null);this.bindViewModelInstance(Tt)}}}}},_.prototype.drawFrame=function(){var y,S;!((y=document==null?void 0:document.timeline)===null||y===void 0)&&y.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(S=this.runtime)===null||S===void 0||S.resolveAnimationFrame()):this.startRendering()},_.prototype.draw=function(y,S){var O;this.frameRequestId=null;var Q=performance.now();this.lastRenderTime||(this.lastRenderTime=y),this.renderSecondTimer+=y-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,S==null||S());var de=(y-this.lastRenderTime)/1e3;this.lastRenderTime=y;for(var be=this.animator.animations.filter(function(Wn){return Wn.playing||Wn.needsScrub}).sort(function(Wn){return Wn.needsScrub?-1:1}),Ke=0,it=be;Ke<it.length;Ke++){var Le=it[Ke];Le.advance(de),Le.instance.didLoop&&(Le.loopCount+=1),Le.apply(1)}for(var st=this.animator.stateMachines.filter(function(Wn){return Wn.playing}),Tt=0,$t=st;Tt<$t.length;Tt++){var xt=$t[Tt],Bn=xt.reportedEventCount();if(Bn)for(var _n=0;_n<Bn;_n++){var wn=xt.reportedEventAt(_n);if(wn)if(wn.type===oe.OpenUrl){if(this.eventManager.fire({type:Y.RiveEvent,data:wn}),this.automaticallyHandleEvents){var en=document.createElement("a"),rn=wn,xr=rn.url,Xe=rn.target,Er=(0,f.sanitizeUrl)(xr);xr&&en.setAttribute("href",Er),Xe&&en.setAttribute("target",Xe),Er&&Er!==f.BLANK_URL&&en.click()}}else this.eventManager.fire({type:Y.RiveEvent,data:wn})}xt.advanceAndApply(de)}this.animator.stateMachines.length==0&&this.artboard.advance(de);var Vn=this.renderer;Vn.clear(),Vn.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(Vn),Vn.restore(),Vn.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(de),this.frameCount++;var ht=performance.now();for(this.frameTimes.push(ht),this.durations.push(ht-Q);this.frameTimes[0]<=ht-1e3;)this.frameTimes.shift(),this.durations.shift();(O=this._viewModelInstance)===null||O===void 0||O.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},_.prototype.alignRenderer=function(){var y=this,S=y.renderer,O=y.runtime,Q=y._layout,de=y.artboard;S.align(Q.runtimeFit(O),Q.runtimeAlignment(O),{minX:Q.minX,minY:Q.minY,maxX:Q.maxX,maxY:Q.maxY},de.bounds,this._devicePixelRatioUsed*Q.layoutScaleFactor)},Object.defineProperty(_.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(y,S){return y+S},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),_.prototype.cleanup=function(){var y,S;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&M.remove(this._observed),this.removeRiveListeners(),this.file&&((y=this.riveFile)===null||y===void 0||y.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(Fe.remove(this._audioEventListener),this._audioEventListener=null),(S=this._viewModelInstance)===null||S===void 0||S.cleanup(),this._viewModelInstance=null,this._dataEnums=null},_.prototype.deleteRiveRenderer=function(){var y;(y=this.renderer)===null||y===void 0||y.delete(),this.renderer=null},_.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},_.prototype.retrieveTextRun=function(y){var S;if(!y){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var O=this.artboard.textRun(y);if(!O){console.warn("Could not access a text run with name '".concat(y,"' in the '").concat((S=this.artboard)===null||S===void 0?void 0:S.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return O},_.prototype.getTextRunValue=function(y){var S=this.retrieveTextRun(y);return S?S.text:void 0},_.prototype.setTextRunValue=function(y,S){var O=this.retrieveTextRun(y);O&&(O.text=S)},_.prototype.play=function(y,S){var O=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return O.play(y,S)}});return}this.animator.play(y),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},_.prototype.pause=function(y){var S=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return S.pause(y)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(y)},_.prototype.scrub=function(y,S){var O=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return O.scrub(y,S)}});return}this.animator.scrub(y,S||0),this.drawFrame()},_.prototype.stop=function(y){var S=this;if(y=yn(y),!this.readyForPlaying){this.taskQueue.add({action:function(){return S.stop(y)}});return}this.animator&&this.animator.stop(y),this.eventCleanup&&this.eventCleanup()},_.prototype.reset=function(y){var S,O,Q=y==null?void 0:y.artboard,de=yn(y==null?void 0:y.animations),be=yn(y==null?void 0:y.stateMachines),Ke=(S=y==null?void 0:y.autoplay)!==null&&S!==void 0?S:!1,it=(O=y==null?void 0:y.autoBind)!==null&&O!==void 0?O:!1;this.cleanupInstances(),this.initArtboard(Q,de,be,Ke,it),this.taskQueue.process()},_.prototype.load=function(y){this.file=null,this.stop(),this.init(y)},Object.defineProperty(_.prototype,"layout",{get:function(){return this._layout},set:function(y){this._layout=y,(!y.maxX||!y.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),_.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},_.prototype.resizeDrawingSurfaceToCanvas=function(y){if(this.canvas instanceof HTMLCanvasElement&&window){var S=this.canvas.getBoundingClientRect(),O=S.width,Q=S.height,de=y||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=de,this.canvas.width=de*O,this.canvas.height=de*Q,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===V.Layout){var be=this._layout.layoutScaleFactor;this.artboard.width=O/be,this.artboard.height=Q/be}}},Object.defineProperty(_.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var y=[],S=0;S<this.artboard.animationCount();S++)y.push(this.artboard.animationByIndex(S).name);return y},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var y=[],S=0;S<this.artboard.stateMachineCount();S++)y.push(this.artboard.stateMachineByIndex(S).name);return y},enumerable:!1,configurable:!0}),_.prototype.stateMachineInputs=function(y){if(this.loaded){var S=this.animator.stateMachines.find(function(O){return O.name===y});return S==null?void 0:S.inputs}},_.prototype.retrieveInputAtPath=function(y,S){if(!y){console.warn("No input name provided for path '".concat(S,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(y,"', at path: '").concat(S,"', but the Artboard is null"));return}var O=this.artboard.inputByPath(y,S);if(!O){console.warn("Could not access an input with name: '".concat(y,"', at path:'").concat(S,"'"));return}return O},_.prototype.setBooleanStateAtPath=function(y,S,O){var Q=this.retrieveInputAtPath(y,O);Q&&(Q.type===U.Boolean?Q.asBool().value=S:console.warn("Input with name: '".concat(y,"', at path:'").concat(O,"' is not a boolean")))},_.prototype.setNumberStateAtPath=function(y,S,O){var Q=this.retrieveInputAtPath(y,O);Q&&(Q.type===U.Number?Q.asNumber().value=S:console.warn("Input with name: '".concat(y,"', at path:'").concat(O,"' is not a number")))},_.prototype.fireStateAtPath=function(y,S){var O=this.retrieveInputAtPath(y,S);O&&(O.type===U.Trigger?O.asTrigger().fire():console.warn("Input with name: '".concat(y,"', at path:'").concat(S,"' is not a trigger")))},_.prototype.retrieveTextAtPath=function(y,S){if(!y){console.warn("No text name provided for path '".concat(S,"'"));return}if(!S){console.warn("No path provided for text '".concat(y,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(y,"', at path: '").concat(S,"', but the Artboard is null"));return}var O=this.artboard.textByPath(y,S);if(!O){console.warn("Could not access text with name: '".concat(y,"', at path:'").concat(S,"'"));return}return O},_.prototype.getTextRunValueAtPath=function(y,S){var O=this.retrieveTextAtPath(y,S);if(!O){console.warn("Could not get text with name: '".concat(y,"', at path:'").concat(S,"'"));return}return O.text},_.prototype.setTextRunValueAtPath=function(y,S,O){var Q=this.retrieveTextAtPath(y,O);if(!Q){console.warn("Could not set text with name: '".concat(y,"', at path:'").concat(O,"'"));return}Q.text=S},Object.defineProperty(_.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(y){return y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(y){return y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(y){return!y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(y){return!y.playing}).map(function(y){return y.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),_.prototype.on=function(y,S){this.eventManager.add({type:y,callback:S})},_.prototype.off=function(y,S){this.eventManager.remove({type:y,callback:S})},_.prototype.unsubscribe=function(y,S){console.warn("This function is deprecated: please use `off()` instead."),this.off(y,S)},_.prototype.removeAllRiveEventListeners=function(y){this.eventManager.removeAll(y)},_.prototype.unsubscribeAll=function(y){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(y)},_.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},_.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},_.prototype.enableFPSCounter=function(y){this.runtime.enableFPSCounter(y)},_.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(_.prototype,"contents",{get:function(){if(this.loaded){for(var y={artboards:[]},S=0;S<this.file.artboardCount();S++){for(var O=this.file.artboardByIndex(S),Q={name:O.name,animations:[],stateMachines:[]},de=0;de<O.animationCount();de++){var be=O.animationByIndex(de);Q.animations.push(be.name)}for(var Ke=0;Ke<O.stateMachineCount();Ke++){for(var it=O.stateMachineByIndex(Ke),Le=it.name,st=new this.runtime.StateMachineInstance(it,O),Tt=[],$t=0;$t<st.inputCount();$t++){var xt=st.input($t);Tt.push({name:xt.name,type:xt.type})}Q.stateMachines.push({name:Le,inputs:Tt})}y.artboards.push(Q)}return y}},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(y){this._volume=y,this.artboard&&(this.artboard.volume=y*Fe.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"artboardWidth",{get:function(){var y;return this.artboard?this.artboard.width:(y=this._artboardWidth)!==null&&y!==void 0?y:0},set:function(y){this._artboardWidth=y,this.artboard&&(this.artboard.width=y)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"artboardHeight",{get:function(){var y;return this.artboard?this.artboard.height:(y=this._artboardHeight)!==null&&y!==void 0?y:0},set:function(y){this._artboardHeight=y,this.artboard&&(this.artboard.height=y)},enumerable:!1,configurable:!0}),_.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(_.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(y){this._devicePixelRatioUsed=y},enumerable:!1,configurable:!0}),_.prototype.bindViewModelInstance=function(y){var S;this.artboard&&!this.destroyed&&y&&y.runtimeInstance&&(y.internalIncrementReferenceCount(),(S=this._viewModelInstance)===null||S===void 0||S.cleanup(),this._viewModelInstance=y,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(O){return O.bindViewModelInstance(y)}):this.artboard.bindViewModelInstance(y.runtimeInstance))},Object.defineProperty(_.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),_.prototype.viewModelByIndex=function(y){var S=this.file.viewModelByIndex(y);return S!==null?new ke(S):null},_.prototype.viewModelByName=function(y){var S=this.file.viewModelByName(y);return S!==null?new ke(S):null},_.prototype.enums=function(){if(this._dataEnums===null){var y=this.file.enums();this._dataEnums=y.map(function(S){return new Me(S)})}return this._dataEnums},_.prototype.defaultViewModel=function(){if(this.artboard){var y=this.file.defaultArtboardViewModel(this.artboard);if(y)return new ke(y)}return null},_.prototype.getArtboard=function(y){var S,O;return(O=(S=this.riveFile)===null||S===void 0?void 0:S.getArtboard(y))!==null&&O!==void 0?O:null},_.missingErrorMessage="Rive source file or data buffer required",_.cleanupErrorMessage="Attempt to use file after calling cleanup.",_}(),ke=function(){function _(y){this._viewModel=y}return Object.defineProperty(_.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),_.prototype.instanceByIndex=function(y){var S=this._viewModel.instanceByIndex(y);return S!==null?new Ye(S,null):null},_.prototype.instanceByName=function(y){var S=this._viewModel.instanceByName(y);return S!==null?new Ye(S,null):null},_.prototype.defaultInstance=function(){var y=this._viewModel.defaultInstance();return y!==null?new Ye(y,null):null},_.prototype.instance=function(){var y=this._viewModel.instance();return y!==null?new Ye(y,null):null},Object.defineProperty(_.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),_}(),Me=function(){function _(y){this._dataEnum=y}return Object.defineProperty(_.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),_}(),Oe;(function(_){_.Number="number",_.String="string",_.Boolean="boolean",_.Color="color",_.Trigger="trigger",_.Enum="enum",_.List="list",_.Image="image",_.Artboard="artboard"})(Oe||(Oe={}));var Ye=function(){function _(y,S){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=y,S!==null&&this._parents.push(S)}return Object.defineProperty(_.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),_.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(y){y.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(y){y.clearChanges()})),this._children.forEach(function(y){return y.handleCallbacks()})},_.prototype.addParent=function(y){this._parents.includes(y)||(this._parents.push(y),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&y.addToViewModelCallbacks(this))},_.prototype.removeParent=function(y){var S=this._parents.indexOf(y);if(S!==-1){var O=this._parents[S];O.removeFromViewModelCallbacks(this),this._parents.splice(S,1)}},_.prototype.addToPropertyCallbacks=function(y){var S=this;this._propertiesWithCallbacks.includes(y)||(this._propertiesWithCallbacks.push(y),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(O){O.addToViewModelCallbacks(S)}))},_.prototype.removeFromPropertyCallbacks=function(y){var S=this;this._propertiesWithCallbacks.includes(y)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(O){return O!==y}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(O){O.removeFromViewModelCallbacks(S)}))},_.prototype.addToViewModelCallbacks=function(y){var S=this;this._children.includes(y)||(this._children.push(y),this._parents.forEach(function(O){O.addToViewModelCallbacks(S)}))},_.prototype.removeFromViewModelCallbacks=function(y){var S=this;this._children.includes(y)&&(this._children=this._children.filter(function(O){return O!==y}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(O){O.removeFromViewModelCallbacks(S)}))},_.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(y){y.clearCallbacks()})},_.prototype.propertyFromPath=function(y,S){var O=y.split("/");return this.propertyFromPathSegments(O,0,S)},_.prototype.viewModelFromPathSegments=function(y,S){var O=this.internalViewModelInstance(y[S]);return O!==null?S==y.length-1?O:O.viewModelFromPathSegments(y,S++):null},_.prototype.propertyFromPathSegments=function(y,S,O){var Q,de,be,Ke,it,Le,st,Tt,$t,xt,Bn,_n,wn,en,rn,xr,Xe,Er;if(S<y.length-1){var Vn=this.internalViewModelInstance(y[S]);return Vn!==null?Vn.propertyFromPathSegments(y,S+1,O):null}var ht=null;switch(O){case Oe.Number:if(ht=(de=(Q=this._runtimeInstance)===null||Q===void 0?void 0:Q.number(y[S]))!==null&&de!==void 0?de:null,ht!==null)return new At(ht,this);break;case Oe.String:if(ht=(Ke=(be=this._runtimeInstance)===null||be===void 0?void 0:be.string(y[S]))!==null&&Ke!==void 0?Ke:null,ht!==null)return new dt(ht,this);break;case Oe.Boolean:if(ht=(Le=(it=this._runtimeInstance)===null||it===void 0?void 0:it.boolean(y[S]))!==null&&Le!==void 0?Le:null,ht!==null)return new qt(ht,this);break;case Oe.Color:if(ht=(Tt=(st=this._runtimeInstance)===null||st===void 0?void 0:st.color(y[S]))!==null&&Tt!==void 0?Tt:null,ht!==null)return new Tr(ht,this);break;case Oe.Trigger:if(ht=(xt=($t=this._runtimeInstance)===null||$t===void 0?void 0:$t.trigger(y[S]))!==null&&xt!==void 0?xt:null,ht!==null)return new er(ht,this);break;case Oe.Enum:if(ht=(_n=(Bn=this._runtimeInstance)===null||Bn===void 0?void 0:Bn.enum(y[S]))!==null&&_n!==void 0?_n:null,ht!==null)return new bn(ht,this);break;case Oe.List:if(ht=(en=(wn=this._runtimeInstance)===null||wn===void 0?void 0:wn.list(y[S]))!==null&&en!==void 0?en:null,ht!==null)return new Sr(ht,this);break;case Oe.Image:if(ht=(xr=(rn=this._runtimeInstance)===null||rn===void 0?void 0:rn.image(y[S]))!==null&&xr!==void 0?xr:null,ht!==null)return new sa(ht,this);break;case Oe.Artboard:if(ht=(Er=(Xe=this._runtimeInstance)===null||Xe===void 0?void 0:Xe.artboard(y[S]))!==null&&Er!==void 0?Er:null,ht!==null)return new Li(ht,this);break}return null},_.prototype.internalViewModelInstance=function(y){var S;if(this._viewModelInstances.has(y))return this._viewModelInstances.get(y);var O=(S=this._runtimeInstance)===null||S===void 0?void 0:S.viewModel(y);if(O!==null){var Q=new _(O,this);return Q.internalIncrementReferenceCount(),this._viewModelInstances.set(y,Q),Q}return null},_.prototype.number=function(y){var S=this.propertyFromPath(y,Oe.Number);return S},_.prototype.string=function(y){var S=this.propertyFromPath(y,Oe.String);return S},_.prototype.boolean=function(y){var S=this.propertyFromPath(y,Oe.Boolean);return S},_.prototype.color=function(y){var S=this.propertyFromPath(y,Oe.Color);return S},_.prototype.trigger=function(y){var S=this.propertyFromPath(y,Oe.Trigger);return S},_.prototype.enum=function(y){var S=this.propertyFromPath(y,Oe.Enum);return S},_.prototype.list=function(y){var S=this.propertyFromPath(y,Oe.List);return S},_.prototype.image=function(y){var S=this.propertyFromPath(y,Oe.Image);return S},_.prototype.artboard=function(y){var S=this.propertyFromPath(y,Oe.Artboard);return S},_.prototype.viewModel=function(y){var S=y.split("/"),O=S.length>1?this.viewModelFromPathSegments(S.slice(0,S.length-1),0):this;return O!=null?O.internalViewModelInstance(S[S.length-1]):null},_.prototype.internalReplaceViewModel=function(y,S){var O;if(S.runtimeInstance!==null){var Q=((O=this._runtimeInstance)===null||O===void 0?void 0:O.replaceViewModel(y,S.runtimeInstance))||!1;if(Q){S.internalIncrementReferenceCount();var de=this.internalViewModelInstance(y);de!==null&&(de.removeParent(this),this._children.includes(de)&&(this._children=this._children.filter(function(be){return be!==de})),de.cleanup()),this._viewModelInstances.set(y,S),S.addParent(this)}return Q}return!1},_.prototype.replaceViewModel=function(y,S){var O,Q=y.split("/"),de=Q.length>1?this.viewModelFromPathSegments(Q.slice(0,Q.length-1),0):this;return(O=de==null?void 0:de.internalReplaceViewModel(Q[Q.length-1],S))!==null&&O!==void 0?O:!1},_.prototype.incrementReferenceCount=function(){var y;this._referenceCount++,(y=this._runtimeInstance)===null||y===void 0||y.incrementReferenceCount()},_.prototype.decrementReferenceCount=function(){var y;this._referenceCount--,(y=this._runtimeInstance)===null||y===void 0||y.decrementReferenceCount()},Object.defineProperty(_.prototype,"properties",{get:function(){var y;return((y=this._runtimeInstance)===null||y===void 0?void 0:y.getProperties().map(function(S){return C({},S)}))||[]},enumerable:!1,configurable:!0}),_.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},_.prototype.cleanup=function(){var y=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(Q){Q.cleanup()}),this._viewModelInstances.clear();var S=N([],this._children);this._children.length=0;var O=N([],this._parents);this._parents.length=0,S.forEach(function(Q){Q.removeParent(y)}),O.forEach(function(Q){Q.removeFromViewModelCallbacks(y)})}},_}(),$e=function(){function _(y,S){this.callbacks=[],this._viewModelInstanceValue=y,this._parentViewModel=S}return _.prototype.on=function(y){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(y)||(this.callbacks.push(y),this._parentViewModel.addToPropertyCallbacks(this))},_.prototype.off=function(y){y?this.callbacks=this.callbacks.filter(function(S){return S!==y}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},_.prototype.internalHandleCallback=function(y){},_.prototype.handleCallbacks=function(){var y=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(S){y.internalHandleCallback(S)})},_.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},_.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(_.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),_}(),dt=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}($e),At=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}($e),qt=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}($e),er=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return y.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},y.prototype.internalHandleCallback=function(S){S()},y}($e),bn=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(S){this._viewModelInstanceValue.valueIndex=S},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S(this.value)},y}($e),Sr=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),y.prototype.addInstance=function(S){S.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(S.runtimeInstance),S.addParent(this._parentViewModel))},y.prototype.addInstanceAt=function(S,O){return S.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(S.runtimeInstance,O)?(S.addParent(this._parentViewModel),!0):!1},y.prototype.removeInstance=function(S){S.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(S.runtimeInstance),S.removeParent(this._parentViewModel))},y.prototype.removeInstanceAt=function(S){this._viewModelInstanceValue.removeInstanceAt(S)},y.prototype.instanceAt=function(S){var O=this._viewModelInstanceValue.instanceAt(S);if(O!=null){var Q=new Ye(O,this._parentViewModel);return Q}return null},y.prototype.swap=function(S,O){this._viewModelInstanceValue.swap(S,O)},y.prototype.internalHandleCallback=function(S){S()},y}($e),Tr=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(S){this._viewModelInstanceValue.value=S},enumerable:!1,configurable:!0}),y.prototype.rgb=function(S,O,Q){this._viewModelInstanceValue.rgb(S,O,Q)},y.prototype.rgba=function(S,O,Q,de){this._viewModelInstanceValue.argb(de,S,O,Q)},y.prototype.argb=function(S,O,Q,de){this._viewModelInstanceValue.argb(S,O,Q,de)},y.prototype.alpha=function(S){this._viewModelInstanceValue.alpha(S)},y.prototype.opacity=function(S){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,S))*255))},y.prototype.internalHandleCallback=function(S){S(this.value)},y}($e),sa=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"value",{set:function(S){var O;this._viewModelInstanceValue.value((O=S==null?void 0:S.nativeImage)!==null&&O!==void 0?O:null)},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S()},y}($e),Li=function(_){v(y,_);function y(S,O){return _.call(this,S,O)||this}return Object.defineProperty(y.prototype,"value",{set:function(S){var O;this._viewModelInstanceValue.value((O=S==null?void 0:S.nativeArtboard)!==null&&O!==void 0?O:null)},enumerable:!1,configurable:!0}),y.prototype.internalHandleCallback=function(S){S()},y}($e),Bo=function(_){return x(void 0,void 0,void 0,function(){var y,S,O;return T(this,function(Q){switch(Q.label){case 0:return y=new Request(_),[4,fetch(y)];case 1:return S=Q.sent(),[4,S.arrayBuffer()];case 2:return O=Q.sent(),[2,O]}})})},yn=function(_){return typeof _=="string"?[_]:_ instanceof Array?_:[]},Ni={EventManager:Ae,TaskQueueManager:qe},Fn=function(_){return x(void 0,void 0,void 0,function(){var y,S,O;return T(this,function(Q){switch(Q.label){case 0:return y=new Promise(function(de){return A.getInstance(function(be){be.decodeAudio(_,de)})}),[4,y];case 1:return S=Q.sent(),O=new f.AudioWrapper(S),f.finalizationRegistry.register(O,S),[2,O]}})})},ji=function(_){return x(void 0,void 0,void 0,function(){var y,S,O;return T(this,function(Q){switch(Q.label){case 0:return y=new Promise(function(de){return A.getInstance(function(be){be.decodeImage(_,de)})}),[4,y];case 1:return S=Q.sent(),O=new f.ImageWrapper(S),f.finalizationRegistry.register(O,S),[2,O]}})})},Vo=function(_){return x(void 0,void 0,void 0,function(){var y,S,O;return T(this,function(Q){switch(Q.label){case 0:return y=new Promise(function(de){return A.getInstance(function(be){be.decodeFont(_,de)})}),[4,y];case 1:return S=Q.sent(),O=new f.FontWrapper(S),f.finalizationRegistry.register(O,S),[2,O]}})})}})(),s})())}(ff)),ff.exports}var Ep=nR();function rR(n,e){e.style.borderColor=n;const t=getComputedStyle(e).getPropertyValue("border-color"),r=e.getContext("2d");return r?(r.fillStyle=t,r.fillRect(0,0,1,1),e.style.display="none",[...r.getImageData(0,0,1,1).data]):[0,0,0,255]}const iR=({restored:n})=>{const e=ve.useRef(null),t=ve.useRef(null);return ve.useEffect(()=>{const r=t.current,a=e.current;if(r==null||a==null)return;const s=new Ep.Rive({src:"https://assets.nlx.ai/touchpoint/voice-plus-animation.riv",canvas:r,autoBind:!0,autoplay:!0,stateMachines:"State Machine 1",layout:new Ep.Layout({fit:Ep.Fit.Fill}),onLoad:()=>{s.resizeDrawingSurfaceToCanvas();const u=s.viewModelInstance;if(u!=null){const h=u.trigger("run"),f=u.trigger("runNoWave"),v=u.color("color"),C=u.number("voiceInput");C!=null&&(C.value=100),v==null||v.rgba(...rR("var(--color-accent)",a)),n?f==null||f.trigger():h==null||h.trigger()}}}),l=()=>{s.resizeDrawingSurfaceToCanvas()};return window.addEventListener("resize",l,!1),()=>{s.cleanup(),window.removeEventListener("resize",l,!1)}},[n]),R.jsxs(R.Fragment,{children:[R.jsx("canvas",{ref:e,width:"1",height:"1"}),R.jsx("canvas",{className:"pointer-events-none fixed inset-0",ref:t,style:{width:"100%",height:"100%"}})]})},gy="flex flex-col grow p-2 md:p-3 gap-2.5 w-full md:max-w-content md:mx-auto md:pb-3",aR=({feedbackState:n,feedbackActions:e})=>n.comment.state==="idle"?null:n.comment.state==="submitted"?R.jsxs("div",{className:gy,children:[R.jsxs("div",{className:"flex items-center gap-2.5",children:[R.jsx(un,{type:"ghost",Icon:Ip,label:"Back",onClick:t=>{t.preventDefault(),t.stopPropagation(),e.cancelComment()}}),R.jsx("h2",{className:"",children:"Feedback submitted"})]}),R.jsx("p",{className:"grow border border-solid border-primary-10 rounded-2xl p-4",children:n.comment.text}),R.jsx(ia,{type:"ghost",label:"Edit",Icon:Wy,onClick:()=>{e.clickCommentEdit()}})]}):R.jsxs("form",{className:gy,onSubmit:t=>{t.preventDefault(),e.submitComment()},children:[R.jsxs("div",{className:"flex items-center gap-2.5",children:[R.jsx(un,{type:"ghost",Icon:Ip,label:"Back",onClick:t=>{t.preventDefault(),t.stopPropagation(),e.cancelComment()}}),R.jsx("label",{htmlFor:"feedback-form",children:"Provide feedback"})]}),R.jsx("textarea",{id:"feedback-form",className:"grow bg-primary-5 rounded-2xl p-2",placeholder:"Enter your feedback...",value:n.comment.text,onChange:t=>{e.editCommentText(t.target.value)}}),R.jsx(ia,{type:"main",label:"Submit",Icon:Rf,onClick:n.comment.state==="submitting"?void 0:()=>{}})]}),vw=ve.forwardRef((n,e)=>{var t;const r=sessionStorage.getItem("nlxActiveVoiceConversationId")===n.config.conversationId,a=ve.useMemo(()=>{const ke=sessionStorage.getItem("nlxActiveConversationResponses")??"{}";try{const Me=JSON.parse(ke);if(Array.isArray(Me[n.config.conversationId]))return Me[n.config.conversationId]}catch{return null}},[n.config.conversationId]),[s,l]=ve.useState(void 0),u=ve.useMemo(()=>AC({responses:a,...n.config}),[n.config,a]);ve.useEffect(()=>(u.addEventListener("interimMessage",l),()=>{u.removeEventListener("interimMessage",l)}),[u,l]);const[h,f]=ve.useState([]),v=((t=h[h.length-1])==null?void 0:t.type)===Kn.User,C=n.colorMode??"dark",[x,T]=ve.useState(n.embedded||n.input==="external"||r),N=MC(n.config),[L,$]=ve.useState(!1),V=ve.useRef(n.embedded||n.input==="external"||r),K=n.input??"text",F=ve.useCallback(()=>{sessionStorage.removeItem("nlxActiveVoiceConversationId"),(K==="voice"||K==="voiceMini")&&(Z.current=!1,u.reset({clearResponses:!0}),sessionStorage.removeItem("nlxConversationId"))},[u,K]),A=n.onClose,U=ve.useCallback(ke=>{A!=null&&(A(ke),F(),ke.defaultPrevented||T(!1))},[A,T,F]);ve.useEffect(()=>{V.current=x},[x]),ve.useImperativeHandle(e,()=>({setExpanded(ke){ke?T(!0):(F(),T(!1))},getExpanded(){return V.current},getConversationHandler(){return u},setCustomBidirectionalCommands:ke=>{H.current(ke)}}),[u,T,F]),ve.useEffect(()=>{const ke=Me=>{f(Me);const Oe=u.currentConversationId();K==="text"&&Oe!=null&&sessionStorage.setItem("nlxActiveConversationResponses",JSON.stringify({[Oe]:Me}))};return u.subscribe(ke),()=>{u.unsubscribe(ke)}},[u,f,K]);const Z=ve.useRef(r);ve.useEffect(()=>{if(!x||Z.current)return;Z.current=!0,(K!=="text"||a==null||a.length===0)&&n.initializeConversation(u,n.initialContext);const ke=u.currentConversationId();ke!=null&&sessionStorage.setItem("nlxActiveVoiceConversationId",ke)},[u,x,F,K,n,a]);const oe=ve.useRef({formElements:{},links:{},customCommands:new Map}),X=ve.useRef([]),H=ve.useRef(ke=>{var Me;if(((Me=n.bidirectional)==null?void 0:Me.automaticContext)!==!1)X.current=ke;else throw new Error("Custom commands can only be set when automatic context is enabled.")});ve.useEffect(()=>{if(x&&n.bidirectional!=null&&n.bidirectional.automaticContext!==!1){const{teardown:ke,onCustomCommandsChange:Me}=Q_(u,X.current,n.bidirectional.customizeAutomaticContext??(Oe=>Oe),Oe=>{oe.current=Oe});return H.current=Me,ke}},[x,u,n.bidirectional]),ve.useEffect(()=>{if(n.bidirectional!=null&&(n.bidirectional.navigation!=null||n.bidirectional.input!=null||n.bidirectional.custom!=null||n.bidirectional.automaticContext!==!1))return eR(u,n.bidirectional,oe)},[n.bidirectional,u]);const J=n.windowSize??(n.embedded?"full":"half"),Y=ve.useMemo(()=>{const ke=Pv(Oe=>Oe.type===Kn.Application,h);if(ke===-1)return null;const Me=h[ke];return(Me==null?void 0:Me.type)!==Kn.Application?null:{index:ke,response:Me}},[h]),he=ve.useMemo(()=>{if(Y==null)return;const ke=Pv(Oe=>Oe.choices.length>0,Y.response.payload.messages);if(ke===-1)return;const Me=Y.response.payload.messages[ke];if(Me!=null)return{message:Me,messageIndex:ke,responseIndex:Y.index}},[Y]),[Ae,qe]=ve.useState({}),Ue=ve.useMemo(()=>n.modalityComponents??n.customModalities??{},[n.modalityComponents,n.customModalities]),[ot,Fe]=ve.useState(!0),[z,ce]=ve.useState(0),ue=()=>{u.reset({clearResponses:!0}),F(),K!=="voice"&&n.initializeConversation(u,n.initialContext);const ke=u.currentConversationId();sessionStorage.getItem("nlxConversationId")!==null&&(ke==null?sessionStorage.removeItem("nlxConversationId"):sessionStorage.setItem("nlxConversationId",ke)),ke!=null&&sessionStorage.setItem("nlxActiveVoiceConversationId",ke),ce(Me=>Me+1)},[M,ae]=RP(u);if(u==null||K==="external")return null;if(!x)return n.launchIcon!==!1?R.jsx(rd,{className:"fixed z-launch-button bottom-2 right-2 w-fit",theme:n.theme,colorMode:C,children:R.jsx(XC,{className:"backdrop-blur-sm",iconUrl:typeof n.launchIcon=="string"?n.launchIcon:void 0,Custom:typeof n.launchIcon=="function"?n.launchIcon:void 0,onClick:()=>{T(!0)},label:"Expand chat"})}):null;if(K==="voiceMini")return R.jsx(R.Fragment,{children:R.jsxs(rd,{theme:n.theme,colorMode:C,className:rt("w-fit",n.embedded?"":"fixed z-touchpoint bottom-2 right-2"),children:[n.animate?R.jsx(iR,{restored:r}):null,R.jsx(t_,{handler:u,context:n.initialContext,brandIcon:n.brandIcon,onClose:()=>{U(new Event("close"))},renderCollapse:n.onClose!=null,modalityComponents:Ue},z)]})});const Ve=()=>{var ke,Me;return L?R.jsx(Kb,{reset:()=>{ue(),$(!1)},className:rt("flex-none",J==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{$(!1)},handler:u}):N?R.jsxs(R.Fragment,{children:[R.jsx(LP,{enabled:n.enabled,userMessageBubble:n.userMessageBubble??!1,agentMessageBubble:n.agentMessageBubble??!1,chatMode:n.chatMode??!0,isWaiting:v,interimMessage:s,lastApplicationResponseIndex:Y==null?void 0:Y.index,responses:h,colorMode:C,handler:u,uploadedFiles:Ae,modalityComponents:Ue,feedbackState:M,feedbackActions:ae,className:rt("grow",J==="full"?"w-full md:max-w-content md:mx-auto":"")}),R.jsxs("div",{className:rt("p-2 md:p-3 flex flex-col flex-none gap-2",J==="full"?"w-full md:max-w-content md:mx-auto":""),children:[he!=null?R.jsx(IP,{...he,handler:u}):null,(he==null?void 0:he.message.selectedChoiceId)!=null?null:R.jsx(QP,{enabled:n.enabled,handler:u,uploadUrl:(Me=(ke=Y==null?void 0:Y.response.payload.metadata)==null?void 0:ke.uploadUrls)==null?void 0:Me[0],onFileUpload:({uploadId:Oe,file:Ye})=>{qe($e=>({...$e,[Oe]:Ye}))}})]})]}):R.jsx(a0,{})};return R.jsxs(rd,{theme:n.theme,colorMode:C,className:rt("grid grid-cols-2 xl:grid-cols-[1fr_632px]",n.embedded?"w-full h-full":"fixed inset-0 z-touchpoint"),children:[J==="half"?R.jsx("div",{className:"hidden md:block bg-overlay"}):null,R.jsx("div",{className:rt("@container/main","w-full bg-background text-primary-80 flex relative flex-col h-full backdrop-blur-overlay",{"col-span-2 md:col-span-1":J==="half","col-span-2":J==="full"}),children:M.comment.state!=="idle"?R.jsx(aR,{feedbackActions:ae,feedbackState:M}):R.jsxs(R.Fragment,{children:[R.jsx(lS,{windowSize:n.embedded?"embedded":J,errorThemedCloseButton:K==="voice",speakerControls:K==="voice"?{enabled:ot,setEnabled:Fe}:void 0,colorMode:C,brandIcon:K==="text"?n.brandIcon:void 0,isSettingsOpen:L,enabled:n.enabled,toggleSettings:n.enableSettings?()=>{$(ke=>!ke)}:void 0,renderCollapse:n.onClose!=null,collapse:U,reset:ue}),K==="text"?Ve():R.jsxs(R.Fragment,{children:[L?R.jsx(Kb,{className:rt("flex-none",J==="full"?"w-full md:max-w-content md:mx-auto":""),onClose:()=>{$(!1)},reset:()=>{ue(),$(!1)},handler:u}):null,R.jsx(NE,{brandIcon:n.brandIcon,handler:u,speakersEnabled:ot,colorMode:C,className:L?"hidden":"grow",context:n.initialContext,modalityComponents:Ue},z)]})]})})]})});vw.displayName="App";const bw=`/*! tailwindcss v4.1.16 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-rotate-x:initial;--tw-rotate-y:initial;--tw-rotate-z:initial;--tw-skew-x:initial;--tw-skew-y:initial;--tw-space-y-reverse:0;--tw-border-style:solid;--tw-font-weight:initial;--tw-outline-style:solid;--tw-blur:initial;--tw-brightness:initial;--tw-contrast:initial;--tw-grayscale:initial;--tw-hue-rotate:initial;--tw-invert:initial;--tw-opacity:initial;--tw-saturate:initial;--tw-sepia:initial;--tw-drop-shadow:initial;--tw-drop-shadow-color:initial;--tw-drop-shadow-alpha:100%;--tw-drop-shadow-size:initial;--tw-backdrop-blur:initial;--tw-backdrop-brightness:initial;--tw-backdrop-contrast:initial;--tw-backdrop-grayscale:initial;--tw-backdrop-hue-rotate:initial;--tw-backdrop-invert:initial;--tw-backdrop-opacity:initial;--tw-backdrop-saturate:initial;--tw-backdrop-sepia:initial;--tw-duration:initial;--tw-content:"";--glow-opacity:0%}}}@layer theme{:root,:host{--color-gray-200:oklch(92.8% .006 264.531);--color-black:#000;--spacing:.25rem;--container-sm:24rem;--text-xs:.75rem;--text-xs--line-height:calc(1/.75);--text-sm:.875rem;--text-sm--line-height:calc(1.25/.875);--text-base:1rem;--text-base--line-height: 1.5 ;--text-xl:1.25rem;--text-xl--line-height:calc(1.75/1.25);--font-weight-normal:400;--font-weight-bold:700;--radius-2xl:1rem;--animate-ping:ping 1s cubic-bezier(0,0,.2,1)infinite;--blur-sm:8px;--blur-md:12px;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--font-sans:inherit;--backdrop-blur-overlay:48px;--container-content:640px;--radius-inner:inherit;--radius-outer:inherit;--z-index-touchpoint:1000;--z-index-launch-button:100;--color-primary-80:inherit;--color-primary-60:inherit;--color-primary-40:inherit;--color-primary-20:inherit;--color-primary-10:inherit;--color-primary-5:inherit;--color-primary-1:inherit;--color-secondary-80:inherit;--color-secondary-60:inherit;--color-secondary-40:inherit;--color-secondary-20:inherit;--color-secondary-10:inherit;--color-secondary-5:inherit;--color-secondary-1:inherit;--color-accent:inherit;--color-accent-20:inherit;--color-background:inherit;--color-overlay:inherit;--color-warning-primary:inherit;--color-warning-secondary:inherit;--color-error-primary:inherit;--color-error-secondary:inherit;--animate-shimmer:shimmer 1.5s linear infinite}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:currentColor}@supports (color:color-mix(in lab,red,red)){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}::-webkit-calendar-picker-indicator{line-height:1}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}*,:after,:before,::backdrop{border-color:var(--color-gray-200,currentcolor)}::file-selector-button{border-color:var(--color-gray-200,currentcolor)}button:not(:disabled),[role=button]:not(:disabled){cursor:pointer}*{font-family:var(--font-family)!important}}@layer components;@layer utilities{.\\@container\\/main{container:main/inline-size}.pointer-events-none{pointer-events:none}.collapse{visibility:collapse}.invisible{visibility:hidden}.visible{visibility:visible}.sr-only{clip-path:inset(50%);white-space:nowrap;border-width:0;width:1px;height:1px;margin:-1px;padding:0;position:absolute;overflow:hidden}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:calc(var(--spacing)*0)}.inset-x-0{inset-inline:calc(var(--spacing)*0)}.-top-2{top:calc(var(--spacing)*-2)}.top-0{top:calc(var(--spacing)*0)}.top-1\\/2{top:50%}.right-0{right:calc(var(--spacing)*0)}.right-2{right:calc(var(--spacing)*2)}.bottom-2{bottom:calc(var(--spacing)*2)}.bottom-4{bottom:calc(var(--spacing)*4)}.bottom-\\[72px\\]{bottom:72px}.left-0{left:calc(var(--spacing)*0)}.left-1\\/2{left:50%}.z-10{z-index:10}.z-launch-button{z-index:var(--z-index-launch-button)}.z-touchpoint{z-index:var(--z-index-touchpoint)}.col-span-2{grid-column:span 2/span 2}.container{width:100%}@media (min-width:40rem){.container{max-width:40rem}}@media (min-width:48rem){.container{max-width:48rem}}@media (min-width:64rem){.container{max-width:64rem}}@media (min-width:80rem){.container{max-width:80rem}}@media (min-width:96rem){.container{max-width:96rem}}.-mx-2{margin-inline:calc(var(--spacing)*-2)}.mx-2{margin-inline:calc(var(--spacing)*2)}.mx-auto{margin-inline:auto}.mt-4{margin-top:calc(var(--spacing)*4)}.mr-2{margin-right:calc(var(--spacing)*2)}.mr-10{margin-right:calc(var(--spacing)*10)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.ml-1{margin-left:calc(var(--spacing)*1)}.ml-2{margin-left:calc(var(--spacing)*2)}.ml-3{margin-left:calc(var(--spacing)*3)}.ml-auto{margin-left:auto}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.block{display:block}.contents{display:contents}.flex{display:flex}.grid{display:grid}.hidden{display:none}.inline{display:inline}.h-4{height:calc(var(--spacing)*4)}.h-6{height:calc(var(--spacing)*6)}.h-8{height:calc(var(--spacing)*8)}.h-10{height:calc(var(--spacing)*10)}.h-20{height:calc(var(--spacing)*20)}.h-24{height:calc(var(--spacing)*24)}.h-52{height:calc(var(--spacing)*52)}.h-64{height:calc(var(--spacing)*64)}.h-72{height:calc(var(--spacing)*72)}.h-\\[128px\\]{height:128px}.h-\\[360px\\]{height:360px}.h-full{height:100%}.h-px{height:1px}.max-h-\\[40vh\\]{max-height:40vh}.max-h-\\[360px\\]{max-height:360px}.max-h-full{max-height:100%}.min-h-full{min-height:100%}.w-4{width:calc(var(--spacing)*4)}.w-6{width:calc(var(--spacing)*6)}.w-8{width:calc(var(--spacing)*8)}.w-10{width:calc(var(--spacing)*10)}.w-20{width:calc(var(--spacing)*20)}.w-24{width:calc(var(--spacing)*24)}.w-72{width:calc(var(--spacing)*72)}.w-80{width:calc(var(--spacing)*80)}.w-\\[128px\\]{width:128px}.w-\\[calc\\(100vw-16px\\)\\]{width:calc(100vw - 16px)}.w-fit{width:fit-content}.w-full{width:100%}.max-w-\\[360px\\]{max-width:360px}.max-w-content{max-width:var(--container-content)}.max-w-sm{max-width:var(--container-sm)}.flex-none{flex:none}.shrink-0{flex-shrink:0}.grow{flex-grow:1}.-translate-x-1\\/2{--tw-translate-x: -50% ;translate:var(--tw-translate-x)var(--tw-translate-y)}.translate-x-0{--tw-translate-x:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-1\\/2{--tw-translate-y: -50% ;translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-full{--tw-translate-y:-100%;translate:var(--tw-translate-x)var(--tw-translate-y)}.translate-y-0{--tw-translate-y:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.transform{transform:var(--tw-rotate-x,)var(--tw-rotate-y,)var(--tw-rotate-z,)var(--tw-skew-x,)var(--tw-skew-y,)}.animate-ping{animation:var(--animate-ping)}.cursor-pointer{cursor:pointer}.resize{resize:both}.resize-none{resize:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-\\[320px_1fr\\]{grid-template-columns:320px 1fr}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.items-end{align-items:flex-end}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.gap-0\\.5{gap:calc(var(--spacing)*.5)}.gap-1{gap:calc(var(--spacing)*1)}.gap-2{gap:calc(var(--spacing)*2)}.gap-2\\.5{gap:calc(var(--spacing)*2.5)}.gap-3{gap:calc(var(--spacing)*3)}.gap-4{gap:calc(var(--spacing)*4)}.gap-6{gap:calc(var(--spacing)*6)}:where(.space-y-1>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*1)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*1)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-2>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*2)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-4>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*4)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*4)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-6>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*6)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*6)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-8>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*8)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*8)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-px>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(1px*var(--tw-space-y-reverse));margin-block-end:calc(1px*calc(1 - var(--tw-space-y-reverse)))}.gap-x-2{column-gap:calc(var(--spacing)*2)}.truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.rounded-2xl{border-radius:var(--radius-2xl)}.rounded-full{border-radius:3.40282e38px}.rounded-inner{border-radius:var(--radius-inner)}.rounded-outer{border-radius:var(--radius-outer)}.border{border-style:var(--tw-border-style);border-width:1px}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-solid{--tw-border-style:solid;border-style:solid}.border-background{border-color:var(--color-background)}.border-primary-10{border-color:var(--color-primary-10)}.bg-\\[rgb\\(40\\,41\\,47\\)\\]{background-color:#28292f}.bg-\\[rgb\\(175\\,175\\,175\\)\\]{background-color:#afafaf}.bg-accent{background-color:var(--color-accent)}.bg-background{background-color:var(--color-background)}.bg-black\\/50{background-color:#00000080}@supports (color:color-mix(in lab,red,red)){.bg-black\\/50{background-color:color-mix(in oklab,var(--color-black)50%,transparent)}}.bg-current{background-color:currentColor}.bg-error-primary{background-color:var(--color-error-primary)}.bg-error-secondary{background-color:var(--color-error-secondary)}.bg-overlay{background-color:var(--color-overlay)}.bg-primary-5{background-color:var(--color-primary-5)}.bg-primary-10{background-color:var(--color-primary-10)}.bg-primary-80{background-color:var(--color-primary-80)}.bg-secondary-40{background-color:var(--color-secondary-40)}.bg-secondary-60{background-color:var(--color-secondary-60)}.bg-transparent{background-color:#0000}.bg-cover{background-size:cover}.bg-center{background-position:50%}.object-contain{object-fit:contain}.object-cover{object-fit:cover}.object-center{object-position:center}.p-2{padding:calc(var(--spacing)*2)}.p-2\\.5{padding:calc(var(--spacing)*2.5)}.p-3{padding:calc(var(--spacing)*3)}.p-4{padding:calc(var(--spacing)*4)}.px-1\\.5{padding-inline:calc(var(--spacing)*1.5)}.px-2{padding-inline:calc(var(--spacing)*2)}.px-3{padding-inline:calc(var(--spacing)*3)}.px-5{padding-inline:calc(var(--spacing)*5)}.py-0\\.5{padding-block:calc(var(--spacing)*.5)}.py-1{padding-block:calc(var(--spacing)*1)}.py-2{padding-block:calc(var(--spacing)*2)}.py-2\\.5{padding-block:calc(var(--spacing)*2.5)}.py-4{padding-block:calc(var(--spacing)*4)}.pr-2{padding-right:calc(var(--spacing)*2)}.pl-4{padding-left:calc(var(--spacing)*4)}.pl-10{padding-left:calc(var(--spacing)*10)}.text-center{text-align:center}.text-left{text-align:left}.text-right{text-align:right}.font-sans{font-family:var(--font-sans)}.text-base{font-size:var(--text-base);line-height:var(--tw-leading,var(--text-base--line-height))}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-xl{font-size:var(--text-xl);line-height:var(--tw-leading,var(--text-xl--line-height))}.text-xs{font-size:var(--text-xs);line-height:var(--tw-leading,var(--text-xs--line-height))}.font-normal{--tw-font-weight:var(--font-weight-normal);font-weight:var(--font-weight-normal)}.whitespace-pre-wrap{white-space:pre-wrap}.text-accent{color:var(--color-accent)}.text-accent-20{color:var(--color-accent-20)}.text-error-primary{color:var(--color-error-primary)}.text-primary-20{color:var(--color-primary-20)}.text-primary-40{color:var(--color-primary-40)}.text-primary-60{color:var(--color-primary-60)}.text-primary-80{color:var(--color-primary-80)}.text-secondary-80{color:var(--color-secondary-80)}.placeholder-primary-20::placeholder{color:var(--color-primary-20)}.placeholder-primary-40::placeholder{color:var(--color-primary-40)}.caret-accent{caret-color:var(--color-accent)}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-\\[0\\.01\\]{opacity:.01}.outline-hidden{--tw-outline-style:none;outline-style:none}@media (forced-colors:active){.outline-hidden{outline-offset:2px;outline:2px solid #0000}}.outline-0{outline-style:var(--tw-outline-style);outline-width:0}.outline-2{outline-style:var(--tw-outline-style);outline-width:2px}.outline-accent{outline-color:var(--color-accent)}.filter{filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.backdrop-blur-md{--tw-backdrop-blur:blur(var(--blur-md));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.backdrop-blur-overlay{--tw-backdrop-blur:blur(var(--backdrop-blur-overlay));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.backdrop-blur-sm{--tw-backdrop-blur:blur(var(--blur-sm));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.transition-colors{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.duration-200{--tw-duration:.2s;transition-duration:.2s}.duration-500{--tw-duration:.5s;transition-duration:.5s}.outline-solid{--tw-outline-style:solid;outline-style:solid}.placeholder\\:text-primary-40::placeholder{color:var(--color-primary-40)}.before\\:absolute:before{content:var(--tw-content);position:absolute}.before\\:inset-0:before{content:var(--tw-content);inset:calc(var(--spacing)*0)}.before\\:-z-10:before{content:var(--tw-content);z-index:-10}.before\\:bg-transparent:before{content:var(--tw-content);background-color:#0000}.before\\:transition-colors:before{content:var(--tw-content);transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.before\\:content-\\[\\'\\'\\]:before{--tw-content:"";content:var(--tw-content)}.after\\:pointer-events-none:after{content:var(--tw-content);pointer-events:none}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:inset-0:after{content:var(--tw-content);inset:calc(var(--spacing)*0)}.after\\:rounded-outer:after{content:var(--tw-content);border-radius:var(--radius-outer)}.after\\:content-\\[\\'\\'\\]:after{--tw-content:"";content:var(--tw-content)}.last\\:h-full:last-child{height:100%}@media (hover:hover){.hover\\:bg-primary-5:hover{background-color:var(--color-primary-5)}.hover\\:bg-primary-10:hover{background-color:var(--color-primary-10)}.hover\\:bg-primary-80:hover{background-color:var(--color-primary-80)}.hover\\:bg-secondary-20:hover{background-color:var(--color-secondary-20)}.hover\\:text-primary-80:hover{color:var(--color-primary-80)}.hover\\:after\\:bg-primary-10:hover:after{content:var(--tw-content);background-color:var(--color-primary-10)}}.focus\\:bg-primary-10:focus{background-color:var(--color-primary-10)}.focus\\:outline-0:focus{outline-style:var(--tw-outline-style);outline-width:0}.focus\\:before\\:bg-primary-5:focus:before{content:var(--tw-content);background-color:var(--color-primary-5)}.focus\\:before\\:bg-primary-10:focus:before{content:var(--tw-content);background-color:var(--color-primary-10)}.focus\\:before\\:bg-primary-40:focus:before{content:var(--tw-content);background-color:var(--color-primary-40)}.focus\\:before\\:bg-primary-80:focus:before{content:var(--tw-content);background-color:var(--color-primary-80)}.active\\:bg-secondary-20:active{background-color:var(--color-secondary-20)}@media (hover:hover){.enabled\\:hover\\:before\\:bg-primary-5:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-5)}.enabled\\:hover\\:before\\:bg-primary-10:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-10)}.enabled\\:hover\\:before\\:bg-primary-40:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-40)}.enabled\\:hover\\:before\\:bg-primary-80:enabled:hover:before{content:var(--tw-content);background-color:var(--color-primary-80)}}.enabled\\:active\\:before\\:bg-secondary-10:enabled:active:before{content:var(--tw-content);background-color:var(--color-secondary-10)}.disabled\\:bg-accent-20:disabled{background-color:var(--color-accent-20)}.disabled\\:bg-primary-5:disabled{background-color:var(--color-primary-5)}.disabled\\:bg-primary-10:disabled{background-color:var(--color-primary-10)}.disabled\\:bg-secondary-20:disabled{background-color:var(--color-secondary-20)}.disabled\\:text-primary-20:disabled{color:var(--color-primary-20)}.disabled\\:text-primary-40:disabled{color:var(--color-primary-40)}.disabled\\:text-secondary-40:disabled{color:var(--color-secondary-40)}@media (min-width:48rem){.md\\:absolute{position:absolute}.md\\:left-0{left:calc(var(--spacing)*0)}.md\\:-order-1{order:-1}.md\\:col-span-1{grid-column:span 1/span 1}.md\\:mx-auto{margin-inline:auto}.md\\:block{display:block}.md\\:w-fit{width:fit-content}.md\\:max-w-content{max-width:var(--container-content)}.md\\:-translate-x-full{--tw-translate-x:-100%;translate:var(--tw-translate-x)var(--tw-translate-y)}.md\\:translate-y-0{--tw-translate-y:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.md\\:transform{transform:var(--tw-rotate-x,)var(--tw-rotate-y,)var(--tw-rotate-z,)var(--tw-skew-x,)var(--tw-skew-y,)}.md\\:flex-col{flex-direction:column}.md\\:p-3{padding:calc(var(--spacing)*3)}.md\\:pb-3{padding-bottom:calc(var(--spacing)*3)}}@media (min-width:80rem){.xl\\:grid-cols-\\[1fr_632px\\]{grid-template-columns:1fr 632px}}@container main (min-width:48rem){.\\@3xl\\/main\\:absolute{position:absolute}.\\@3xl\\/main\\:top-0{top:calc(var(--spacing)*0)}.\\@3xl\\/main\\:right-0{right:calc(var(--spacing)*0)}.\\@3xl\\/main\\:left-0{left:calc(var(--spacing)*0)}}}.shimmer{background-image:linear-gradient(90deg,var(--color-primary-1)0%,var(--color-primary-40)50%,var(--color-primary-1)100%);animation:var(--animate-shimmer);background-repeat:no-repeat;background-size:80px 100%;-webkit-background-clip:text;background-clip:text}@property --glow-opacity{syntax:"<percentage>";inherits:false;initial-value:0%}.fullscreen-error svg{--glow-opacity:0%;filter:drop-shadow(0 0 6px #0000);animation:3s infinite error-glow}@supports (color:color-mix(in lab,red,red)){.fullscreen-error svg{filter:drop-shadow(0 0 6px color-mix(in srgb,transparent,var(--accent)var(--glow-opacity)))}}@keyframes error-glow{0%{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}22%{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}35%{color:var(--accent);fill-opacity:.8;--glow-opacity:60%}45%{color:var(--accent);fill-opacity:.7;--glow-opacity:30%}55%{color:var(--accent);fill-opacity:.6;--glow-opacity:60%}60%{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}to{color:var(--primary);fill-opacity:.08;--glow-opacity:0%}}.markdown ul{list-style-type:disc;list-style-position:inside}.markdown ol{list-style-type:decimal;list-style-position:inside}.markdown hr{--tw-border-style:solid;border-style:solid;border-color:var(--color-primary-20)}.markdown a{text-decoration-line:underline}.markdown h1,.markdown h2,.markdown h3{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-rotate-x{syntax:"*";inherits:false}@property --tw-rotate-y{syntax:"*";inherits:false}@property --tw-rotate-z{syntax:"*";inherits:false}@property --tw-skew-x{syntax:"*";inherits:false}@property --tw-skew-y{syntax:"*";inherits:false}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-outline-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-drop-shadow-color{syntax:"*";inherits:false}@property --tw-drop-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-drop-shadow-size{syntax:"*";inherits:false}@property --tw-backdrop-blur{syntax:"*";inherits:false}@property --tw-backdrop-brightness{syntax:"*";inherits:false}@property --tw-backdrop-contrast{syntax:"*";inherits:false}@property --tw-backdrop-grayscale{syntax:"*";inherits:false}@property --tw-backdrop-hue-rotate{syntax:"*";inherits:false}@property --tw-backdrop-invert{syntax:"*";inherits:false}@property --tw-backdrop-opacity{syntax:"*";inherits:false}@property --tw-backdrop-saturate{syntax:"*";inherits:false}@property --tw-backdrop-sepia{syntax:"*";inherits:false}@property --tw-duration{syntax:"*";inherits:false}@property --tw-content{syntax:"*";inherits:false;initial-value:""}@keyframes ping{75%,to{opacity:0;transform:scale(2)}}@keyframes shimmer{0%{background-position:-80px 0}to{background-position:calc(100% + 80px) 0}}`,yc=({children:n,className:e,faded:t})=>R.jsx("p",{className:rt("text-base",t?"text-primary-60":"text-primary-80",e),children:n}),oR=({children:n,className:e})=>R.jsx("p",{className:rt("text-sm text-primary-60",e),children:n});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yw=function(n,e){return(yw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])})(n,e)},sR,zu,lR=(function(n){/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function t(){for(var r=[],a=0;a<arguments.length;a++){var s=arguments[a];if(s){var l=typeof s;if(l==="string"||l==="number")r.push(s);else if(Array.isArray(s)&&s.length){var u=t.apply(null,s);u&&r.push(u)}else if(l==="object")for(var h in s)e.call(s,h)&&s[h]&&r.push(h)}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()}(zu={path:sR,exports:{},require:function(n,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e==null&&zu.path)}},zu.exports),zu.exports);function mf(n,e,t){var r,a,s,l,u;function h(){var v=Date.now()-l;v<e&&v>=0?r=setTimeout(h,e-v):(r=null,t||(u=n.apply(s,a),s=a=null))}e==null&&(e=100);var f=function(){s=this,a=arguments,l=Date.now();var v=t&&!r;return r||(r=setTimeout(h,e)),v&&(u=n.apply(s,a),s=a=null),u};return f.clear=function(){r&&(clearTimeout(r),r=null)},f.flush=function(){r&&(u=n.apply(s,a),s=a=null,clearTimeout(r),r=null)},f}mf.debounce=mf;var cR=mf;(function(n,e){e===void 0&&(e={});var t=e.insertAt;if(typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t==="top"&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=n:a.appendChild(document.createTextNode(n))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var Pp,uR=(Pp="indiana-scroll-container",function(n,e){if(!n)return Pp;var t;typeof n=="string"?t=n:e=n;var r=Pp;return t&&(r+="__"+t),r+(e?Object.keys(e).reduce(function(a,s){var l=e[s];return l&&(a+=" "+(typeof l=="boolean"?r+"--"+s:r+"--"+s+"_"+l)),a},""):"")}),dR=function(n){function e(t){var r=n.call(this,t)||this;return r.onEndScroll=function(){r.scrolling=!1,!r.pressed&&r.started&&r.processEnd()},r.onScroll=function(a){var s=r.container.current;s.scrollLeft===r.scrollLeft&&s.scrollTop===r.scrollTop||(r.scrolling=!0,r.processScroll(a),r.onEndScroll())},r.onTouchStart=function(a){var s=r.props.nativeMobileScroll;if(r.isDraggable(a.target))if(r.internal=!0,s&&r.scrolling)r.pressed=!0;else{var l=a.touches[0];r.processClick(a,l.clientX,l.clientY),!s&&r.props.stopPropagation&&a.stopPropagation()}},r.onTouchEnd=function(a){var s=r.props.nativeMobileScroll;r.pressed&&(!r.started||r.scrolling&&s?r.pressed=!1:r.processEnd(),r.forceUpdate())},r.onTouchMove=function(a){var s=r.props.nativeMobileScroll;if(r.pressed&&(!s||!r.isMobile)){var l=a.touches[0];l&&r.processMove(a,l.clientX,l.clientY),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation()}},r.onMouseDown=function(a){r.isDraggable(a.target)&&r.isScrollable()&&(r.internal=!0,r.props.buttons.indexOf(a.button)!==-1&&(r.processClick(a,a.clientX,a.clientY),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation()))},r.onMouseMove=function(a){r.pressed&&(r.processMove(a,a.clientX,a.clientY),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation())},r.onMouseUp=function(a){r.pressed&&(r.started?r.processEnd():(r.internal=!1,r.pressed=!1,r.forceUpdate(),r.props.onClick&&r.props.onClick(a)),a.preventDefault(),r.props.stopPropagation&&a.stopPropagation())},r.container=Ao.createRef(),r.onEndScroll=cR(r.onEndScroll,300),r.scrolling=!1,r.started=!1,r.pressed=!1,r.internal=!1,r.getRef=r.getRef.bind(r),r}return function(t,r){function a(){this.constructor=t}yw(t,r),t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}(e,n),e.prototype.componentDidMount=function(){var t=this.props.nativeMobileScroll,r=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),r.addEventListener("touchstart",this.onTouchStart,{passive:!1}),r.addEventListener("mousedown",this.onMouseDown,{passive:!1}),t&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},e.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},e.prototype.getElement=function(){return this.container.current},e.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},e.prototype.isDraggable=function(t){var r=this.props.ignoreElements;if(r){var a=t.closest(r);return a===null||a.contains(this.getElement())}return!0},e.prototype.isScrollable=function(){var t=this.container.current;return t&&(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)},e.prototype.processClick=function(t,r,a){var s=this.container.current;this.scrollLeft=s.scrollLeft,this.scrollTop=s.scrollTop,this.clientX=r,this.clientY=a,this.pressed=!0},e.prototype.processStart=function(t){t===void 0&&(t=!0);var r=this.props.onStartScroll;this.started=!0,t&&document.body.classList.add("indiana-dragging"),r&&r({external:!this.internal}),this.forceUpdate()},e.prototype.processScroll=function(t){if(this.started){var r=this.props.onScroll;r&&r({external:!this.internal})}else this.processStart(!1)},e.prototype.processMove=function(t,r,a){var s=this.props,l=s.horizontal,u=s.vertical,h=s.activationDistance,f=s.onScroll,v=this.container.current;this.started?(l&&(v.scrollLeft-=r-this.clientX),u&&(v.scrollTop-=a-this.clientY),f&&f({external:!this.internal}),this.clientX=r,this.clientY=a,this.scrollLeft=v.scrollLeft,this.scrollTop=v.scrollTop):(l&&Math.abs(r-this.clientX)>h||u&&Math.abs(a-this.clientY)>h)&&(this.clientX=r,this.clientY=a,this.processStart())},e.prototype.processEnd=function(){var t=this.props.onEndScroll;this.container.current&&t&&t({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},e.prototype.getRef=function(t){[this.container,this.props.innerRef].forEach(function(r){r&&(typeof r=="function"?r(t):r.current=t)})},e.prototype.render=function(){var t=this.props,r=t.children,a=t.draggingClassName,s=t.className,l=t.style,u=t.hideScrollbars,h=t.component;return Ao.createElement(h,{className:lR(s,this.pressed&&a,uR({dragging:this.pressed,"hide-scrollbars":u,"native-scroll":this.isMobile})),style:l,ref:this.getRef,onScroll:this.onScroll},r)},e.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},e}(ve.PureComponent);const ww=ve.createContext({recentlyEndedScrolling:!1}),kw=n=>{const[e,t]=ve.useState(!1);return ve.useEffect(()=>{if(!e)return;const r=setTimeout(()=>{t(!1)},100);return()=>{clearTimeout(r)}},[e,t]),R.jsx(ww.Provider,{value:{recentlyEndedScrolling:e},children:R.jsx(dR,{className:rt("flex gap-x-2 overflow-x-auto no-scrollbar px-2 -mx-2",n.className),onEndScroll:()=>{t(!0)},children:n.children})})},dm=({children:n,className:e,selected:t,onClick:r,href:a,newTab:s})=>{const l=rt("block shrink-0 rounded-inner overflow-hidden","w-80 space-y-px",t?"outline-solid outline-2 outline-accent":"",r!=null||a!=null?"hover:bg-primary-5":"",e),u=ve.useContext(ww);if(ve.useEffect(()=>{a==null&&s!=null&&console.warn("Setting the `newTab` prop on the `<CustomCard/>` has no effect if the `href` is not also set.")},[a,s]),a!=null)return R.jsx("a",{className:l,href:a,onClick:r,...s?{target:"_blank",rel:"noreferrer"}:{},children:n});const h=r==null?r:()=>{u.recentlyEndedScrolling||r()};return r!=null?R.jsx("button",{className:l,onClick:h,children:n}):R.jsx("div",{className:l,children:n})},hm=({src:n,alt:e})=>R.jsx("img",{src:n,alt:e,className:"w-full h-52 object-cover"}),pm=({left:n,right:e,className:t,icon:r})=>R.jsxs("div",{className:rt(t,"flex items-center relative justify-between gap-2 bg-primary-5 px-3 py-4"),children:[R.jsx("div",{className:"space-y-1 text-left",children:n}),R.jsx("div",{className:"space-y-1 text-right",children:e}),r!=null?R.jsx(r,{className:"text-primary-60 w-4 h-4 absolute top-1/2 left-1/2 transform -translate-y-1/2 -translate-x-1/2"}):null]});function vy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function hR(n,e,t){return e=Ed(e),function(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(r)}(n,Tw()?Reflect.construct(e,t||[],Ed(n).constructor):e.apply(n,t))}function pR(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function fR(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function Cw(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(h,f){if(h){if(typeof h=="string")return vy(h,f);var v={}.toString.call(h).slice(8,-1);return v==="Object"&&h.constructor&&(v=h.constructor.name),v==="Map"||v==="Set"?Array.from(h):v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?vy(h,f):void 0}}(n))||e){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(h){throw h},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,l=!0,u=!1;return{s:function(){t=t.call(n)},n:function(){var h=t.next();return l=h.done,h},e:function(h){u=!0,s=h},f:function(){try{l||t.return==null||t.return()}finally{if(u)throw s}}}}function Sw(n,e,t){return(e=function(r){var a=function(s,l){if(typeof s!="object"||!s)return s;var u=s[Symbol.toPrimitive];if(u!==void 0){var h=u.call(s,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return typeof a=="symbol"?a:a+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xd(){return xd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},xd.apply(null,arguments)}function Ed(n){return Ed=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ed(n)}function mR(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&gf(n,e)}function Tw(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tw=function(){return!!n})()}function by(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function qu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?by(Object(t),!0).forEach(function(r){Sw(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):by(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function xw(n,e){if(n==null)return{};var t,r,a=function(l,u){if(l==null)return{};var h={};for(var f in l)if({}.hasOwnProperty.call(l,f)){if(u.includes(f))continue;h[f]=l[f]}return h}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}function gf(n,e){return gf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},gf(n,e)}function ic(n,e){var t,r=e.replacementChars,a=e.replacement,s=e.separate,l=r,u="",h=Cw(n);try{for(h.s();!(t=h.n()).done;){var f,v=t.value,C=!Object.prototype.hasOwnProperty.call(a,v)&&((f=a[l[0]])===null||f===void 0?void 0:f.test(v));(s&&v===l[0]||C)&&(l=l.slice(1),u+=v)}}catch(x){h.e(x)}finally{h.f()}return u}function Ew(n,e){var t,r=e.mask,a=e.replacement,s=e.separate,l=e.showMask,u=0,h="",f=Cw(r);try{for(f.s();!(t=f.n()).done;){var v=t.value;if(!l&&n[u]===void 0)break;Object.prototype.hasOwnProperty.call(a,v)&&n[u]!==void 0?h+=n[u++]:h+=v}}catch(x){f.e(x)}finally{f.f()}if(s&&!l){for(var C=r.length-1;C>=0&&h[C]===r[C];C--);h=h.slice(0,C+1)}return h}function Pw(n,e){for(var t=e.mask,r=e.replacement,a=[],s=0;s<t.length;s++){var l,u=(l=n[s])!==null&&l!==void 0?l:t[s],h=Object.prototype.hasOwnProperty.call(r,u)?"replacement":n[s]!==void 0&&n[s]!==t[s]?"input":"mask";a.push({type:h,value:u,index:s})}return a}function Gs(n){return n.length>0?Sw({},n,/./):{}}function vf(n,e){for(var t=e.start,r=t===void 0?0:t,a=e.end,s=e.mask,l=e.replacement,u=e.separate,h=n.slice(r,a),f=s.slice(r,a),v="",C=0;C<f.length;C++){var x=Object.prototype.hasOwnProperty.call(l,f[C]);x&&h[C]!==void 0&&h[C]!==f[C]?v+=h[C]:x&&u&&(v+=f[C])}return v}function _w(n,e){var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r,s=RegExp("[^".concat(Object.keys(a).join(""),"]"),"g");return Ew(ic(n,{replacementChars:t.replace(s,""),replacement:a,separate:!1}),{mask:t,replacement:a,separate:!1,showMask:!1})}function gR(n,e){var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r,s=vf(n,{mask:t,replacement:a,separate:!1}),l=RegExp("[^".concat(Object.keys(a).join(""),"]"),"g");return ic(s,{replacementChars:t.replace(l,""),replacement:a,separate:!1})}function vR(n,e){var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r;return Pw(_w(n,{mask:t,replacement:a}),{mask:t,replacement:a})}var bR=["[","]","\\","/","^","$",".","|","?","*","+","(",")","{","}"];function yy(n){return bR.includes(n)?"\\".concat(n):n}function yR(n,e){for(var t=e.mask,r=e.replacement,a=typeof r=="string"?Gs(r):r,s=n==="partial"||n==="partial-inexact",l=n==="full"||n==="partial",u="",h=0;h<t.length;h++){var f=t[h];h===0&&(u="^"),s&&(u+="("),u+=Object.prototype.hasOwnProperty.call(a,f)?"".concat(l?"(?!".concat(yy(f),")"):"","(").concat(a[f].source,")"):yy(f),h===t.length-1&&(s&&(u+=")?".repeat(t.length)),u+="$")}return u}function wR(n,e){return new Proxy(n,{set:function(t,r,a){return r==="current"&&(a!==n.current&&(n.current!==null&&e.unregister(n.current),a!==null&&e.register(a)),t[r]=a,!0)}})}function kR(n,e,t){return e=wc(e),function(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(r)}(n,fm()?Reflect.construct(e,t||[],wc(n).constructor):e.apply(n,t))}function Rw(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Iw(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function CR(n,e,t){return(e=function(r){var a=function(s,l){if(typeof s!="object"||!s)return s;var u=s[Symbol.toPrimitive];if(u!==void 0){var h=u.call(s,l);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}(r,"string");return typeof a=="symbol"?a:a+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wc(n){return wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wc(n)}function SR(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&kc(n,e)}function fm(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fm=function(){return!!n})()}function wy(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ky(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wy(Object(t),!0).forEach(function(r){CR(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wy(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function TR(n,e){if(n==null)return{};var t,r,a=function(l,u){if(l==null)return{};var h={};for(var f in l)if({}.hasOwnProperty.call(l,f)){if(u.includes(f))continue;h[f]=l[f]}return h}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}function kc(n,e){return kc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},kc(n,e)}function bf(n){return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bf(n)}function yf(n){var e=typeof Map=="function"?new Map:void 0;return yf=function(t){if(t===null||!function(a){try{return Function.toString.call(a).indexOf("[native code]")!==-1}catch{return typeof a=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(a,s,l){if(fm())return Reflect.construct.apply(null,arguments);var u=[null];u.push.apply(u,s);var h=new(a.bind.apply(a,u));return l&&kc(h,l.prototype),h}(t,arguments,wc(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),kc(r,t)},yf(n)}var ac=function(n){function e(t){var r;return Rw(this,e),(r=kR(this,e,[t])).name="SyntheticChangeError",r}return SR(e,n),Iw(e)}(yf(Error)),Cy,xR=["options"],ER=["text","email","tel","search","url"],Ow=Iw(function n(e){var t=e.init,r=e.tracking;Rw(this,n);var a=new WeakMap;this.register=function(s){var l;if(ER.includes(s.type)){var u=(l=s._wrapperState)!==null&&l!==void 0?l:{},h=u.initialValue,f=h===void 0?"":h,v=u.controlled,C=v!==void 0&&v,x=t({initialValue:s.value||f,controlled:C}),T=x.value,N=x.options,L={value:T,options:N,fallbackOptions:N},$={id:-1,cachedId:-1},V={value:"",selectionStart:0,selectionEnd:0},K=Object.getOwnPropertyDescriptor("_valueTracker"in s?s:HTMLInputElement.prototype,"value");Object.defineProperty(s,"value",ky(ky({},K),{},{set:function(Z){var oe;V.value=Z,K==null||(oe=K.set)===null||oe===void 0||oe.call(s,Z)}})),s.value=T;var F=function(){var Z=function(){var oe,X;V.selectionStart=(oe=s.selectionStart)!==null&&oe!==void 0?oe:0,V.selectionEnd=(X=s.selectionEnd)!==null&&X!==void 0?X:0,$.id=window.setTimeout(Z)};$.id=window.setTimeout(Z)},A=function(){window.clearTimeout($.id),$.id=-1,$.cachedId=-1},U=function(Z){try{var oe,X;if($.cachedId===$.id)throw new ac("The input selection has not been updated.");$.cachedId=$.id;var H=s.value,J=s.selectionStart,Y=s.selectionEnd;if(J===null||Y===null)throw new ac("The selection attributes have not been initialized.");var he,Ae=V.value;if(Z.inputType===void 0&&(V.selectionStart=0,V.selectionEnd=Ae.length),J>V.selectionStart?he="insert":J<=V.selectionStart&&J<V.selectionEnd?he="deleteBackward":J===V.selectionEnd&&H.length<Ae.length&&(he="deleteForward"),he===void 0||(he==="deleteBackward"||he==="deleteForward")&&H.length>Ae.length)throw new ac("Input type detection error.");var qe="",Ue=V.selectionStart,ot=V.selectionEnd;if(he==="insert")qe=H.slice(V.selectionStart,J);else{var Fe=Ae.length-H.length;Ue=J,ot=J+Fe}L.value!==Ae?L.options=L.fallbackOptions:L.fallbackOptions=L.options;var z=L.options,ce=r({inputType:he,previousValue:Ae,previousOptions:z,value:H,addedValue:qe,changeStart:Ue,changeEnd:ot,selectionStart:J,selectionEnd:Y}),ue=ce.options,M=TR(ce,xR);s.value=M.value,s.setSelectionRange(M.selectionStart,M.selectionEnd),L.value=M.value,L.options=ue,V.selectionStart=M.selectionStart,V.selectionEnd=M.selectionEnd,(oe=s._valueTracker)===null||oe===void 0||(X=oe.setValue)===null||X===void 0||X.call(oe,Ae)}catch(ae){if(s.value=V.value,s.setSelectionRange(V.selectionStart,V.selectionEnd),Z.preventDefault(),Z.stopPropagation(),ae.name!=="SyntheticChangeError")throw ae}};document.activeElement===s&&F(),s.addEventListener("focus",F),s.addEventListener("blur",A),s.addEventListener("input",U),a.set(s,{onFocus:F,onBlur:A,onInput:U})}},this.unregister=function(s){var l=a.get(s);l!==void 0&&(s.removeEventListener("focus",l.onFocus),s.removeEventListener("blur",l.onBlur),s.removeEventListener("input",l.onInput),a.delete(s))}});Cy=Ow,Object.defineProperty(Cy.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Input"});function PR(n,e){return ve.useCallback(function(t){n.current=t,typeof e=="function"?e(t):bf(e)==="object"&&e!==null&&(e.current=t)},[n,e])}var Sy,_R=["track","modify"];function Rs(n){var e,t,r,a;return{mask:(e=n.mask)!==null&&e!==void 0?e:"",replacement:typeof n.replacement=="string"?Gs(n.replacement):(t=n.replacement)!==null&&t!==void 0?t:{},showMask:(r=n.showMask)!==null&&r!==void 0&&r,separate:(a=n.separate)!==null&&a!==void 0&&a,track:n.track,modify:n.modify}}var Aw=function(n){function e(){var t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return pR(this,e),(t=hR(this,e,[{init:function(a){var s=a.initialValue,l=a.controlled,u=Rs(r),h=u.mask,f=u.replacement,v=u.separate,C=u.showMask;return s=l||s?s:C?h:"",{value:s,options:{mask:h,replacement:f,separate:v}}},tracking:function(a){var s=a.inputType,l=a.previousValue,u=a.previousOptions,h=a.addedValue,f=a.changeStart,v=a.changeEnd,C=Rs(r),x=C.track,T=C.modify,N=xw(C,_R),L=N.mask,$=N.replacement,V=N.showMask,K=N.separate,F=qu(qu({},s==="insert"?{inputType:s,data:h}:{inputType:s,data:null}),{},{value:l,selectionStart:f,selectionEnd:v}),A=x==null?void 0:x(F);if(A===!1)throw new ac("Custom tracking stop.");A===null?h="":A!==!0&&A!==void 0&&(h=A);var U=T==null?void 0:T(F);(U==null?void 0:U.mask)!==void 0&&(L=U.mask),(U==null?void 0:U.replacement)!==void 0&&($=typeof(U==null?void 0:U.replacement)=="string"?Gs(U==null?void 0:U.replacement):U.replacement),(U==null?void 0:U.showMask)!==void 0&&(V=U.showMask),(U==null?void 0:U.separate)!==void 0&&(K=U.separate);var Z=vf(l,qu({end:f},u)),oe=vf(l,qu({start:v},u)),X=RegExp("[^".concat(Object.keys($).join(""),"]"),"g"),H=L.replace(X,"");if(Z&&(Z=ic(Z,{replacementChars:H,replacement:$,separate:K}),H=H.slice(Z.length)),h&&(h=ic(h,{replacementChars:H,replacement:$,separate:!1}),H=H.slice(h.length)),s==="insert"&&h==="")throw new ac("The character does not match the key value of the `replacement` object.");if(K){var J=L.slice(f,v).replace(X,""),Y=J.length-h.length;Y<0?oe=oe.slice(-Y):Y>0&&(oe=J.slice(-Y)+oe)}oe&&(oe=ic(oe,{replacementChars:H,replacement:$,separate:K}));var he=Ew(Z+h+oe,{mask:L,replacement:$,separate:K,showMask:V}),Ae=function(qe){var Ue,ot,Fe,z=qe.inputType,ce=qe.value,ue=qe.addedValue,M=qe.beforeChangeValue,ae=qe.mask,Ve=qe.replacement,ke=qe.separate,Me=Pw(ce,{mask:ae,replacement:Ve}).filter(function(At){var qt=At.type;return qt==="input"||ke&&qt==="replacement"}),Oe=(Ue=Me[M.length+ue.length-1])===null||Ue===void 0?void 0:Ue.index,Ye=(ot=Me[M.length-1])===null||ot===void 0?void 0:ot.index,$e=(Fe=Me[M.length+ue.length])===null||Fe===void 0?void 0:Fe.index;if(z==="insert"){if(Oe!==void 0)return Oe+1;if($e!==void 0)return $e;if(Ye!==void 0)return Ye+1}if(z==="deleteForward"){if($e!==void 0)return $e;if(Ye!==void 0)return Ye+1}if(z==="deleteBackward"){if(Ye!==void 0)return Ye+1;if($e!==void 0)return $e}var dt=ce.split("").findIndex(function(At){return Object.prototype.hasOwnProperty.call(Ve,At)});return dt!==-1?dt:ce.length}({inputType:s,value:he,addedValue:h,beforeChangeValue:Z,mask:L,replacement:$,separate:K});return{value:he,selectionStart:Ae,selectionEnd:Ae,options:{mask:L,replacement:$,separate:K}}}}])).format=function(a){return _w(a,Rs(r))},t.formatToParts=function(a){return vR(a,Rs(r))},t.unformat=function(a){return gR(a,Rs(r))},t.generatePattern=function(a){return yR(a,Rs(r))},t}return mR(e,Ow),fR(e)}();Sy=Aw,Object.defineProperty(Sy.prototype,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:"Mask"});function RR(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.mask,t=n.replacement,r=n.showMask,a=n.separate,s=n.track,l=n.modify,u=ve.useRef(null),h=ve.useRef({mask:e,replacement:t,showMask:r,separate:a,track:s,modify:l});return h.current.mask=e,h.current.replacement=t,h.current.showMask=r,h.current.separate=a,h.current.track=s,h.current.modify=l,ve.useMemo(function(){return wR(u,new Aw(h.current))},[])}var IR=["component","mask","replacement","showMask","separate","track","modify"];function OR(n,e){var t=n.component,r=n.mask,a=n.replacement,s=n.showMask,l=n.separate,u=n.track,h=n.modify,f=xw(n,IR),v=RR({mask:r,replacement:a,showMask:s,separate:l,track:u,modify:h}),C=PR(v,e);return t?Ao.createElement(t,xd({ref:C},f)):Ao.createElement("input",xd({ref:C},f))}var AR=ve.forwardRef(OR);const MR={mask:"MM / DD / YYYY",replacement:{D:/\d/,M:/\d/,Y:/\d/},showMask:!0},Mw=({onSubmit:n,className:e})=>{const t=n==null,[r,a]=ve.useState(null);return R.jsxs("div",{className:rt("relative bg-primary-5 flex items-center justify-between pl-4 py-2 pr-2 rounded-outer transition-colors duration-500 before:content-[''] before:absolute before:transition-colors before:-z-10 before:inset-0 before:bg-transparent",t?"":"hover:bg-secondary-20",e),children:[R.jsxs("div",{className:"flex items-center",children:[R.jsx(By,{className:"w-4 h-4 text-primary-60"}),R.jsx(AR,{...MR,className:rt("bg-transparent text-primary-80 outline-0 ml-2 py-2.5",t?"placeholder-primary-20 pointer-events-none":"placeholder-primary-40"),placeholder:"MM / DD / YYYY",onChange:s=>{const l=s.target.value,[u,h,f]=l.split(" / ");u!=null&&u.length===2&&h!=null&&h.length===2&&f!=null&&f.length===4?a(`${f}-${u}-${h}`):a(null)}})]}),R.jsx(un,{className:"flex-none",label:"Send message",onClick:r==null||n==null?void 0:()=>{n(r)},type:"main",Icon:Pd})]})},Lw=(n,e)=>t=>{n!=null&&(n.type==="slot"&&e.sendSlots({[n.id]:t}),n.type==="context"&&e.sendContext({[n.id]:t}),n.type==="choiceId"&&e.sendChoice(typeof t=="string"?t:JSON.stringify(t)))},LR=({data:n,className:e,conversationHandler:t})=>{const r=ve.useMemo(()=>Lw(n.$saveAs,t),[n.$saveAs,t]);return R.jsx(Mw,{className:e,onSubmit:r})},NR=({data:n,className:e,renderedAsOverlay:t})=>R.jsxs(dm,{className:rt(e),children:[n.thumbnail!=null?R.jsx(hm,{src:n.thumbnail,alt:n.thumbnailAlt}):null,n.rows!=null?n.rows.map((r,a)=>R.jsx(pm,{className:t?"backdrop-blur-overlay":"",left:R.jsx(yc,{faded:!0,children:r.label}),right:R.jsx(yc,{children:r.value})},a)):null]}),jR=({data:n,className:e,conversationHandler:t,renderedAsOverlay:r})=>{const[a,s]=ve.useState(null),l=ve.useMemo(()=>Lw(n.$saveAs,t),[n.$saveAs,t]),u=h=>{s(h),l(h)};return R.jsx(kw,{className:e,children:n.cards.map((h,f)=>R.jsxs(dm,{className:r?"backdrop-blur-overlay":"",selected:h.id===a,onClick:h.id!=null&&n.$saveAs!=null?()=>{h.id!=null&&u(h.id)}:void 0,children:[h.thumbnail!=null?R.jsx(hm,{src:h.thumbnail,alt:h.thumbnailAlt}):null,h.rows!=null?h.rows.map((v,C)=>R.jsx(pm,{left:R.jsx(yc,{faded:!0,children:v.label}),right:R.jsx(yc,{children:v.value})},C)):null]},h.id??f))})},HR=({children:n,mode:e,theme:t})=>R.jsxs(R.Fragment,{children:[R.jsx("style",{children:bw}),R.jsx(rd,{className:"bg-background p-4 rounded-outer space-y-4",theme:t,colorMode:e,children:n})]}),DR=eC.version,UR=n=>jk.bind((e,...t)=>ve.createElement(n[e]??e,...t)),GR=UR({TextButton:ia,IconButton:un,BaseText:yc,SmallText:oR,DateInput:Mw,Carousel:kw,CustomCard:dm,CustomCardRow:pm,CustomCardImageRow:hm,Ripple:uc,...YC}),FR=()=>{const n=crypto.randomUUID();return sessionStorage.setItem("nlxConversationId",n),n},BR=()=>{const n=crypto.randomUUID();return localStorage.setItem("nlxUserId",n),n},VR=n=>{const e=n.config.applicationUrl??("botUrl"in n.config?n.config.botUrl:void 0);"botUrl"in n.config&&console.warn("The 'botUrl' configuration option is deprecated. Use 'applicationUrl' instead."),"customModalities"in n&&console.warn("The 'customModalities' configuration option is deprecated. Use 'modalityComponents' instead.");const t={...n.modalityComponents??n.customModalities??{},DefaultDateInput:LR,DefaultCard:NR,DefaultCarousel:jR};return{...n,config:{...n.config,headers:{...n.config.headers,"nlx-touchpoint-ui-version":DR},applicationUrl:e,conversationId:n.config.conversationId??sessionStorage.getItem("nlxConversationId")??FR(),userId:n.config.userId??localStorage.getItem("nlxUserId")??BR(),bidirectional:n.bidirectional==null?n.config.bidirectional??!1:!0},input:n.input??"text",modalityComponents:t,initializeConversation:n.initializeConversation??((r,a)=>{((n==null?void 0:n.input)??"text")==="text"&&r.sendWelcomeFlow(a)})}};let Nw=()=>{const n=document.createElement("style");n.textContent=`:where(nlx-touchpoint.nlx-text, nlx-touchpoint.nlx-voice) {
    display: block;
    height: 350px;
  }
  :where(nlx-touchpoint.nlx-voiceMini) {
   display: inline-block;

  }`,document.head.appendChild(n),Nw=()=>{}};var Ls,Zl,La,oc,ad,wf;class WR extends HTMLElement{constructor(){super(...arguments),jl(this,ad),jl(this,Ls,null),jl(this,Zl,null),jl(this,La,null),Ct(this,"onRef",null),Ct(this,"embedded",!0),Ct(this,"onClose",null),Ct(this,"enableSettings",!1),jl(this,oc,!0)}set enabled(e){Br(this,oc)!==e&&(od(this,oc,e),nv(this,ad,wf).call(this))}set touchpointConfiguration(e){xf(Br(this,La),e)||(od(this,La,e),nv(this,ad,wf).call(this))}connectedCallback(){var e;if(Br(this,La)==null&&this.getAttribute("configuration")!=null)try{this.touchpointConfiguration=JSON.parse(this.getAttribute("configuration")??"")}catch(t){throw new Error("Failed to parse touchpoint configuration: "+(t instanceof Error?t.message:String(t)))}this.embedded&&(Nw(),this.classList.add(`nlx-${((e=Br(this,La))==null?void 0:e.input)??"text"}`))}disconnectedCallback(){var e;(e=Br(this,Ls))==null||e.unmount()}}Ls=new WeakMap,Zl=new WeakMap,La=new WeakMap,oc=new WeakMap,ad=new WeakSet,wf=function(){if(Br(this,Zl)??od(this,Zl,this.attachShadow({mode:"closed"})),Br(this,Ls)??od(this,Ls,Nk.createRoot(Br(this,Zl))),Br(this,La)!=null){const n=VR(Br(this,La));Br(this,Ls).render(R.jsxs(R.Fragment,{children:[R.jsx("style",{children:bw}),R.jsx(vw,{...n,embedded:this.embedded,onClose:this.onClose,enableSettings:this.enableSettings,enabled:Br(this,oc),ref:e=>{var t;e!=null&&((t=this.onRef)==null||t.call(this,e))}})]}))}};const zR=(n,e)=>{customElements.get(n)==null&&customElements.define(n,e)};zR("nlx-touchpoint",WR);const KR=n=>new Promise(e=>{const t=document.createElement("nlx-touchpoint");t.embedded=!1,t.onRef=r=>{e({set expanded(a){r.setExpanded(a)},get expanded(){return r.getExpanded()},get conversationHandler(){return r.getConversationHandler()},teardown:()=>{document.body.removeChild(t)},setCustomBidirectionalCommands(a){r.setCustomBidirectionalCommands(a)}})},t.onClose=()=>{},t.enableSettings=!0,t.touchpointConfiguration=n,document.body.appendChild(t)});export{yc as BaseText,kw as Carousel,dm as CustomCard,hm as CustomCardImageRow,pm as CustomCardRow,Mw as DateInput,un as IconButton,YC as Icons,HR as PreviewContainer,Ao as React,uc as Ripple,oR as SmallText,ia as TextButton,J_ as analyzePageForms,KR as create,GR as html,DR as version};
